<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v9.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Indoor Movement Time Series Classification with Machine Learning Algorithms</title>
<link href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="Indoor Movement Time Series Classification with Machine Learning Algorithms" property="og:title"/>
<meta content="Indoor movement prediction involves using wireless sensor strength data to predict the location and motion of subjects within a building. It is a challenging problem as there is no direct analytical model to translate the variable length traces of signal strength data from multiple sensors into user behavior. The ‘indoor user movement‘ dataset is a …" property="og:description"/>
<meta content="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="https://www.facebook.com/jason.brownlee.39" property="article:author"/>
<meta content="Deep Learning for Time Series" property="article:section"/>
<meta content="2018-09-09T19:00:53+00:00" property="article:published_time"/>
<meta content="2018-09-18T20:36:20+00:00" property="article:modified_time"/>
<meta content="2018-09-18T20:36:20+00:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Line-plots-for-the-time-series-in-a-single-trace-with-trend-lines.png" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Line-plots-for-the-time-series-in-a-single-trace-with-trend-lines.png" property="og:image:secure_url"/>
<meta content="1280" property="og:image:width"/>
<meta content="960" property="og:image:height"/>
<meta content="Line plots for the time series in a single trace with trend lines" property="og:image:alt"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"https:\/\/machinelearningmastery.com\/#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/feed/" rel="alternate" title="Machine Learning Mastery » Indoor Movement Time Series Classification with Machine Learning Algorithms Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<style media="all" type="text/css">
.wpautoterms-footer{background-color:#ffffff;text-align:center;}
.wpautoterms-footer a{color:#000000;font-family:Arial, sans-serif;font-size:14px;}
.wpautoterms-footer .separator{color:#cccccc;font-family:Arial, sans-serif;font-size:14px;}</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/auto-terms-of-service-and-privacy-policy/css/wpautoterms.css?ver=4.9.8" id="wpautoterms_css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.0.5" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/css/front.css?ver=2.0.20" id="ssb-front-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/ewd-ufaq-styles.css?ver=4.9.8" id="ewd-ufaq-style-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/rrssb-min.css?ver=4.9.8" id="ewd-ufaq-rrssb-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.8" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=2.0.20" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.8" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.8" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=6121" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Findoor-movement-time-series-classification-with-machine-learning-algorithms%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Findoor-movement-time-series-classification-with-machine-learning-algorithms%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<style media="screen">

        .simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
      margin: ;
    }
         /*inline margin*/
    
  
  
  
  
  
          .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
         margin: ;
     }

          /*margin-digbar*/

  
  
  
  
 
   
   

</style>
<script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#4c89bf; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#4c89bf;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#4c89bf!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#ffffff;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-6121 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/icon-100x100.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-53"> <div class="textwidget"><p>Want help with deep learning for time series? <a href="https://machinelearningmastery.lpages.co/deep-learning-for-time-series-forecasting-mini-course/">Take the FREE Mini-Course</a></p>
</div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<input name="post_type" type="hidden" value="post"/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Main Menu</h3><ul class="nav fl" id="main-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503" id="menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Start Here</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501" id="menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506" id="menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508" id="menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (Keras)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511" id="menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6509" id="menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515" id="menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">Deep Learning for NLP</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512" id="menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Understand Algorithms</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507" id="menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms (Python)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6513" id="menu-item-6513"><a href="https://machinelearningmastery.com/category/machine-learning-process/">Machine Learning Process</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516" id="menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517" id="menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522" id="menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6518" id="menu-item-6518"><a href="https://machinelearningmastery.com/category/start-machine-learning/">Getting Started</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510" id="menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519" id="menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistical Methods</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520" id="menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Time Series (introductory)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523" id="menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6514" id="menu-item-6514"><a href="https://machinelearningmastery.com/category/machine-learning-resources/">Resources</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502" id="menu-item-6502"><a href="https://machinelearningmastery.com/products/">Ebooks</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500" id="menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504" id="menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505" id="menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-6121 post type-post status-publish format-standard has-post-thumbnail hentry category-deep-learning-time-series">
<header>
<h1 class="title entry-title">Indoor Movement Time Series Classification with Machine Learning Algorithms</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2018-09-10T05:00:53+1100">September 10, 2018</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/" title="View all items in Deep Learning for Time Series">Deep Learning for Time Series</a></span> </div>
<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-6121 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=Indoor+Movement+Time+Series+Classification+with+Machine+Learning+Algorithms&amp;url=https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
<p>Indoor movement prediction involves using wireless sensor strength data to predict the location and motion of subjects within a building.</p>
<p>It is a challenging problem as there is no direct analytical model to translate the variable length traces of signal strength data from multiple sensors into user behavior.</p>
<p>The ‘<em>indoor user movement</em>‘ dataset is a standard and freely available time series classification problem.</p>
<p>In this tutorial, you will discover the indoor movement prediction time series classification problem and how to engineer features and evaluate machine learning algorithms for the problem.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>The time series classification problem of predicting the movement between rooms based on sensor strength.</li>
<li>How to investigate the data in order to better understand the problem and how to engineer features from the raw data for predictive modeling.</li>
<li>How to spot check a suite of classification algorithms and tune one algorithm to further lift performance on the problem.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Sept/2018</strong>: Added a link to a mirror of the dataset.</li>
</ul>
<div class="wp-caption aligncenter" id="attachment_6141" style="width: 650px"><img alt="Indoor Movement Time Series Classification with Machine Learning Algorithms" class="size-full wp-image-6141" height="428" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/Indoor-Movement-Time-Series-Classification-with-Machine-Learning-Algorithms.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/Indoor-Movement-Time-Series-Classification-with-Machine-Learning-Algorithms.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/Indoor-Movement-Time-Series-Classification-with-Machine-Learning-Algorithms-300x201.jpg 300w" width="640"/><p class="wp-caption-text">Indoor Movement Time Series Classification with Machine Learning Algorithms<br/>Photo by <a href="https://www.flickr.com/photos/nolatularosa/3238977118/">Nola Tularosa</a>, some rights reserved.</p></div>
<h2>Tutorial Overview</h2>
<p>This tutorial is divided into five parts; they are:</p>
<ol>
<li>Indoor User Movement Prediction</li>
<li>Indoor Movement Prediction Dataset</li>
<li>Model Evaluation</li>
<li>Data Preparation</li>
<li>Algorithm Spot-Check</li>
</ol>
<h2>Indoor User Movement Prediction</h2>
<p>The ‘<em>indoor user movement</em>‘ prediction problem involves determining whether an individual has moved between rooms based on the change in signal strength measured by wireless detectors in the environment.</p>
<p>The dataset was collected and made available by Davide Bacciu, et al. from the University of Pisa in Italy and first described in their 2011 paper “<a href="https://pdfs.semanticscholar.org/40c2/393e1874c3fd961fdfff02402c24ccf1c3d7.pdf#page=13">Predicting User Movements in Heterogeneous Indoor Environments by Reservoir Computing</a>” as a dataset for exploring a methodology that seems like recurrent neural networks called ‘reservoir computing.’</p>
<p>The problem is a special case of the more generic problem of predicting indoor user localization and movement patterns.</p>
<p>Data was collected by positioning four wireless sensors in the environment and one on the subject. The subject moved through the environment while the four wireless sensors detected and recorded a time series of sensor strength.</p>
<p>The result is a dataset comprised of variable length time series with four variates describing trajectory through a well-defined static environment, and the classification of whether the movement led to the subject changing rooms in the environment.</p>
<p>It is a challenging problem because there is no obvious and generic way to relate signal strength data to subject location in an environment.</p>
<blockquote><p>The relationship between the RSS and the location of the tracked object cannot be easily formulated into an analytical model, as it strongly depends on the characteristics of the environment as well as on the wireless devices involved. I</p></blockquote>
<p>— <a href="https://pdfs.semanticscholar.org/40c2/393e1874c3fd961fdfff02402c24ccf1c3d7.pdf#page=13">Predicting User Movements in Heterogeneous Indoor Environments by Reservoir Computing</a>, 2011.</p>
<p>The data was collected under controlled experimental conditions.</p>
<p>Sensors were placed in three pairs of two connected rooms containing typical office furniture. Two sensors were placed in the corners of each of the two rooms and the subject walked one of six predefined paths through the rooms. Predictions are made at a point along each path that may or may not lead to a change of room.</p>
<p>The cartoon below makes this clear, showing the sensor locations (A1-A4), the six possible paths that may be walked, and the two points (M) where a prediction will be made.</p>
<div class="wp-caption aligncenter" id="attachment_6131" style="width: 802px"><img alt="Overview of two rooms, sensor locations and the 6 pre-defined paths" class="size-full wp-image-6131" height="458" sizes="(max-width: 792px) 100vw, 792px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Overview-of-two-rooms-sensor-locations-and-the-6-pre-defined-paths.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Overview-of-two-rooms-sensor-locations-and-the-6-pre-defined-paths.png 792w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Overview-of-two-rooms-sensor-locations-and-the-6-pre-defined-paths-300x173.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Overview-of-two-rooms-sensor-locations-and-the-6-pre-defined-paths-768x444.png 768w" width="792"/><p class="wp-caption-text">Overview of two rooms, sensor locations and the 6 pre-defined paths.<br/>Taken from “Predicting User Movements in Heterogeneous Indoor Environments by Reservoir Computing.”</p></div>
<p>Three datasets were collected from the three pairs of two rooms in which the paths were walked and sensor measurements taken, referred to as Dataset 1, Dataset 2, and Dataset 3.</p>
<p>The table below, taken from the paper, summarizes the number of paths walked in each of the three datasets, the total number of room changes and non-room-changes (class label), and the lengths of the time series inputs.</p>
<div class="wp-caption aligncenter" id="attachment_6132" style="width: 848px"><img alt="Summary of sensor data collected from the three pairs of two rooms" class="size-full wp-image-6132" height="466" sizes="(max-width: 838px) 100vw, 838px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Summary-of-sensor-data-collected-from-the-three-pairs-of-two-rooms.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Summary-of-sensor-data-collected-from-the-three-pairs-of-two-rooms.png 838w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Summary-of-sensor-data-collected-from-the-three-pairs-of-two-rooms-300x167.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Summary-of-sensor-data-collected-from-the-three-pairs-of-two-rooms-768x427.png 768w" width="838"/><p class="wp-caption-text">Summary of sensor data collected from the three pairs of two rooms.<br/>Taken from “Predicting User Movements in Heterogeneous Indoor Environments by Reservoir Computing.”</p></div>
<p>Technically, the data is comprised of multivariate time series inputs and a classification output and may be described as a time series classification problem.</p>
<blockquote><p>The RSS values from the four anchors are organized into sequences of varying length corresponding to trajectory measurements from the starting point until marker M. A target classification label is associated to each input sequence to indicate whether the user is about to change its location (room) or not.</p></blockquote>
<p>— <a href="https://pdfs.semanticscholar.org/40c2/393e1874c3fd961fdfff02402c24ccf1c3d7.pdf#page=13">Predicting User Movements in Heterogeneous Indoor Environments by Reservoir Computing</a>, 2011.</p>
<p></p><div class="woo-sc-hr"></div>
<center>
<h3>Need help with Deep Learning for Time Series?</h3>
<p>Take my free 7-day email crash course now (with sample code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.lpages.co/leadbox/14531ee73f72a2%3A164f8be4f346dc/5630742793027584/" style="background: rgb(255, 206, 10); color: rgb(255, 255, 255); text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.25) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.5) 0px 1px 3px inset, rgba(0, 0, 0, 0.5) 0px 1px 3px;" target="_blank">Download Your FREE Mini-Course</a><script data-config="%7B%7D" data-leadbox="14531ee73f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.lpages.co/leadbox/14531ee73f72a2%3A164f8be4f346dc/5630742793027584/" src="https://machinelearningmastery.lpages.co/leadbox-1534880695.js" type="text/javascript"></script></p>
</center>
<p></p><div class="woo-sc-hr"></div>
<h2>Indoor Movement Prediction Dataset</h2>
<p>The dataset is freely available from the UCI Machine Learning Repository:</p>
<ul>
<li><a href="https://archive.ics.uci.edu/ml/datasets/Indoor+User+Movement+Prediction+from+RSS+data">Indoor User Movement Prediction from RSS data Data Set, UCI Machine Learning Repository</a></li>
</ul>
<p>In case the above site goes down (which can happen), here is a direct link to a mirror of the dataset:</p>
<ul>
<li><a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/IndoorMovement.zip">IndoorMovement.zip</a></li>
</ul>
<p>The data can be downloaded as a .zip file that contains the following salient files:</p>
<ul>
<li><strong>dataset/MovementAAL_RSS_???.csv</strong> The RSS traces for each movement, where ‘???’ in the filename marks the trace number from 1 to 311.</li>
<li><strong>dataset/MovementAAL_target.csv</strong> The mapping of trace number to the output class value or target.</li>
<li><strong>groups/MovementAAL_DatasetGroup.csv</strong> The mapping of trace number to the dataset group 1, 2, or 3 marking the pair of rooms from which the trace was recorded.</li>
<li><strong>groups/MovementAAL_Paths.csv</strong> The mapping of trace number to the path type, 1-6, marked in the cartoon diagram above.</li>
</ul>
<p>The provided data is already normalized.</p>
<p>Specifically, each input variable is normalized into the range [-1,1] per dataset (pair of rooms), and the output class variable is marked -1 for no transition between rooms and +1 for a transition through the rooms.</p>
<blockquote><p>[…] put data comprises time series of 4 dimensional RSS measurements (NU = 4) corresponding to the 4 anchors […] normalized in the range [−1, 1] independently for each dataset</p></blockquote>
<p>— <a href="https://pdfs.semanticscholar.org/40c2/393e1874c3fd961fdfff02402c24ccf1c3d7.pdf#page=13">Predicting User Movements in Heterogeneous Indoor Environments by Reservoir Computing</a>, 2011.</p>
<p>The scaling of data by dataset may (or may not) introduce additional challenges when combining observations across datasets if the pre-normalized distributions differ greatly.</p>
<p>The time series for one trace in a given trace file are provided in temporal order, where one row records the observations for a single time step. The data is recorded at 8Hz, meaning that one second of clock time elapses for eight time steps in the data.</p>
<p>Below is an example of a trace, taken from ‘<em>dataset/MovementAAL_RSS_1.csv</em>‘, which has the output target ‘1’ (a room transition occurred), from group 1 (the first pair of rooms) and is the path 1 (a straight shot from left to right between the rooms).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab33ca273349924" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
#RSS_anchor1, RSS_anchor2, RSS_anchor3, RSS_anchor4
-0.90476,-0.48,0.28571,0.3
-0.57143,-0.32,0.14286,0.3
-0.38095,-0.28,-0.14286,0.35
-0.28571,-0.2,-0.47619,0.35
-0.14286,-0.2,0.14286,-0.2
-0.14286,-0.2,0.047619,0
-0.14286,-0.16,-0.38095,0.2
-0.14286,-0.04,-0.61905,-0.2
-0.095238,-0.08,0.14286,-0.55
-0.047619,0.04,-0.095238,0.05
-0.19048,-0.04,0.095238,0.4
-0.095238,-0.04,-0.14286,0.35
-0.33333,-0.08,-0.28571,-0.2
-0.2381,0.04,0.14286,0.35
0,0.08,0.14286,0.05
-0.095238,0.04,0.095238,0.1
-0.14286,-0.2,0.14286,0.5
-0.19048,0.04,-0.42857,0.3
-0.14286,-0.08,-0.2381,0.15
-0.33333,0.16,-0.14286,-0.8
-0.42857,0.16,-0.28571,-0.1
-0.71429,0.16,-0.28571,0.2
-0.095238,-0.08,0.095238,0.35
-0.28571,0.04,0.14286,0.2
0,0.04,0.14286,0.1
0,0.04,-0.047619,-0.05
-0.14286,-0.6,-0.28571,-0.1</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab33ca273349924-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ca273349924-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab33ca273349924-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ca273349924-4">4</div><div class="crayon-num" data-line="crayon-5c0c9abab33ca273349924-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ca273349924-6">6</div><div class="crayon-num" data-line="crayon-5c0c9abab33ca273349924-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ca273349924-8">8</div><div class="crayon-num" data-line="crayon-5c0c9abab33ca273349924-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ca273349924-10">10</div><div class="crayon-num" data-line="crayon-5c0c9abab33ca273349924-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ca273349924-12">12</div><div class="crayon-num" data-line="crayon-5c0c9abab33ca273349924-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ca273349924-14">14</div><div class="crayon-num" data-line="crayon-5c0c9abab33ca273349924-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ca273349924-16">16</div><div class="crayon-num" data-line="crayon-5c0c9abab33ca273349924-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ca273349924-18">18</div><div class="crayon-num" data-line="crayon-5c0c9abab33ca273349924-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ca273349924-20">20</div><div class="crayon-num" data-line="crayon-5c0c9abab33ca273349924-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ca273349924-22">22</div><div class="crayon-num" data-line="crayon-5c0c9abab33ca273349924-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ca273349924-24">24</div><div class="crayon-num" data-line="crayon-5c0c9abab33ca273349924-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ca273349924-26">26</div><div class="crayon-num" data-line="crayon-5c0c9abab33ca273349924-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ca273349924-28">28</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab33ca273349924-1">#RSS_anchor1, RSS_anchor2, RSS_anchor3, RSS_anchor4</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ca273349924-2">-0.90476,-0.48,0.28571,0.3</div><div class="crayon-line" id="crayon-5c0c9abab33ca273349924-3">-0.57143,-0.32,0.14286,0.3</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ca273349924-4">-0.38095,-0.28,-0.14286,0.35</div><div class="crayon-line" id="crayon-5c0c9abab33ca273349924-5">-0.28571,-0.2,-0.47619,0.35</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ca273349924-6">-0.14286,-0.2,0.14286,-0.2</div><div class="crayon-line" id="crayon-5c0c9abab33ca273349924-7">-0.14286,-0.2,0.047619,0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ca273349924-8">-0.14286,-0.16,-0.38095,0.2</div><div class="crayon-line" id="crayon-5c0c9abab33ca273349924-9">-0.14286,-0.04,-0.61905,-0.2</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ca273349924-10">-0.095238,-0.08,0.14286,-0.55</div><div class="crayon-line" id="crayon-5c0c9abab33ca273349924-11">-0.047619,0.04,-0.095238,0.05</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ca273349924-12">-0.19048,-0.04,0.095238,0.4</div><div class="crayon-line" id="crayon-5c0c9abab33ca273349924-13">-0.095238,-0.04,-0.14286,0.35</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ca273349924-14">-0.33333,-0.08,-0.28571,-0.2</div><div class="crayon-line" id="crayon-5c0c9abab33ca273349924-15">-0.2381,0.04,0.14286,0.35</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ca273349924-16">0,0.08,0.14286,0.05</div><div class="crayon-line" id="crayon-5c0c9abab33ca273349924-17">-0.095238,0.04,0.095238,0.1</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ca273349924-18">-0.14286,-0.2,0.14286,0.5</div><div class="crayon-line" id="crayon-5c0c9abab33ca273349924-19">-0.19048,0.04,-0.42857,0.3</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ca273349924-20">-0.14286,-0.08,-0.2381,0.15</div><div class="crayon-line" id="crayon-5c0c9abab33ca273349924-21">-0.33333,0.16,-0.14286,-0.8</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ca273349924-22">-0.42857,0.16,-0.28571,-0.1</div><div class="crayon-line" id="crayon-5c0c9abab33ca273349924-23">-0.71429,0.16,-0.28571,0.2</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ca273349924-24">-0.095238,-0.08,0.095238,0.35</div><div class="crayon-line" id="crayon-5c0c9abab33ca273349924-25">-0.28571,0.04,0.14286,0.2</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ca273349924-26">0,0.04,0.14286,0.1</div><div class="crayon-line" id="crayon-5c0c9abab33ca273349924-27">0,0.04,-0.047619,-0.05</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ca273349924-28">-0.14286,-0.6,-0.28571,-0.1</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The datasets were used in two specific ways (experimental settings or ES) to evaluate predictive models on the problem, designated ES1 and ES2, as described in the first paper.</p>
<ul>
<li><strong>ES1</strong>: Combines datasets 1 and 2, which is split into train (80%) and test (20%) sets to evaluate a model.</li>
<li><strong>ES2</strong>: Combines datasets 1 and 2 which are used as a training set (66%) and dataset 3 is used as a test set (34%) to evaluate a model.</li>
</ul>
<p>The ES1 case evaluates a model to generalize movement within two pairs of known rooms, that is, rooms with known geometry. The ES2 case attempts to generalize movement from two rooms to a third unseen room: a harder problem.</p>
<p>The 2011 paper, reports performance of about 95% classification accuracy on ES1 and about 89% on ES2, which after some testing of a suite of algorithms myself is very impressive.</p>
<h2>Load and Explore Dataset</h2>
<p>In this section, we will load the data into memory and explore it with summarization and visualization to help better understand how the problem might be modeled.</p>
<p>First, download the dataset and unzip the downloaded archive into your current working directory.</p>
<h3>Load Dataset</h3>
<p>The targets, groups, and path files can be loaded directly as Pandas DataFrames.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab33d5580509491" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load mapping files
from pandas import read_csv
target_mapping = read_csv('dataset/MovementAAL_target.csv', header=0)
group_mapping = read_csv('groups/MovementAAL_DatasetGroup.csv', header=0)
paths_mapping = read_csv('groups/MovementAAL_Paths.csv', header=0)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab33d5580509491-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33d5580509491-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab33d5580509491-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33d5580509491-4">4</div><div class="crayon-num" data-line="crayon-5c0c9abab33d5580509491-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab33d5580509491-1"><span class="crayon-p"># load mapping files</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33d5580509491-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line" id="crayon-5c0c9abab33d5580509491-3"><span class="crayon-v">target_mapping</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'dataset/MovementAAL_target.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33d5580509491-4"><span class="crayon-v">group_mapping</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'groups/MovementAAL_DatasetGroup.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33d5580509491-5"><span class="crayon-v">paths_mapping</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'groups/MovementAAL_Paths.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>The signal strength traces are stored in separate files in the <em>dataset/</em> directory.</p>
<p>These can be loaded by iterating over all files in the directory and loading the sequences as directly. Because each sequence has a variable length (variable number of rows), we can store the NumPy array for each trace in a list.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab33d8589149561" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load sequences and targets into memory
from pandas import read_csv
from os import listdir
sequences = list()
directory = 'dataset'
target_mapping = None
for name in listdir(directory):
	filename = directory + '/' + name
	if filename.endswith('_target.csv'):
		continue
	df = read_csv(filename, header=0)
	values = df.values
	sequences.append(values)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab33d8589149561-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33d8589149561-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab33d8589149561-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33d8589149561-4">4</div><div class="crayon-num" data-line="crayon-5c0c9abab33d8589149561-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33d8589149561-6">6</div><div class="crayon-num" data-line="crayon-5c0c9abab33d8589149561-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33d8589149561-8">8</div><div class="crayon-num" data-line="crayon-5c0c9abab33d8589149561-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33d8589149561-10">10</div><div class="crayon-num" data-line="crayon-5c0c9abab33d8589149561-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33d8589149561-12">12</div><div class="crayon-num" data-line="crayon-5c0c9abab33d8589149561-13">13</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab33d8589149561-1"><span class="crayon-p"># load sequences and targets into memory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33d8589149561-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line" id="crayon-5c0c9abab33d8589149561-3"><span class="crayon-e">from </span><span class="crayon-e">os </span><span class="crayon-e">import </span><span class="crayon-e">listdir</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33d8589149561-4"><span class="crayon-v">sequences</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33d8589149561-5"><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'dataset'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33d8589149561-6"><span class="crayon-v">target_mapping</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5c0c9abab33d8589149561-7"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">name </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33d8589149561-8"><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'/'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">name</span></div><div class="crayon-line" id="crayon-5c0c9abab33d8589149561-9"><span class="crayon-e"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">endswith</span><span class="crayon-sy">(</span><span class="crayon-s">'_target.csv'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33d8589149561-10"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5c0c9abab33d8589149561-11"><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33d8589149561-12"><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line" id="crayon-5c0c9abab33d8589149561-13"><span class="crayon-e"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>We can tie all of this together into a function named <em>load_dataset()</em> and load the data into memory.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab33da849627164" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load user movement dataset into memory
from pandas import read_csv
from os import listdir

# return list of traces, and arrays for targets, groups and paths
def load_dataset(prefix=''):
	grps_dir, data_dir = prefix+'groups/', prefix+'dataset/'
	# load mapping files
	targets = read_csv(data_dir + 'MovementAAL_target.csv', header=0)
	groups = read_csv(grps_dir + 'MovementAAL_DatasetGroup.csv', header=0)
	paths = read_csv(grps_dir + 'MovementAAL_Paths.csv', header=0)
	# load traces
	sequences = list()
	target_mapping = None
	for name in listdir(data_dir):
		filename = data_dir + name
		if filename.endswith('_target.csv'):
			continue
		df = read_csv(filename, header=0)
		values = df.values
		sequences.append(values)
	return sequences, targets.values[:,1], groups.values[:,1], paths.values[:,1]

# load dataset
sequences, targets, groups, paths = load_dataset()
# summarize shape of the loaded data
print(len(sequences), targets.shape, groups.shape, paths.shape)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab33da849627164-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33da849627164-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab33da849627164-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33da849627164-4">4</div><div class="crayon-num" data-line="crayon-5c0c9abab33da849627164-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33da849627164-6">6</div><div class="crayon-num" data-line="crayon-5c0c9abab33da849627164-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33da849627164-8">8</div><div class="crayon-num" data-line="crayon-5c0c9abab33da849627164-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33da849627164-10">10</div><div class="crayon-num" data-line="crayon-5c0c9abab33da849627164-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33da849627164-12">12</div><div class="crayon-num" data-line="crayon-5c0c9abab33da849627164-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33da849627164-14">14</div><div class="crayon-num" data-line="crayon-5c0c9abab33da849627164-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33da849627164-16">16</div><div class="crayon-num" data-line="crayon-5c0c9abab33da849627164-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33da849627164-18">18</div><div class="crayon-num" data-line="crayon-5c0c9abab33da849627164-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33da849627164-20">20</div><div class="crayon-num" data-line="crayon-5c0c9abab33da849627164-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33da849627164-22">22</div><div class="crayon-num" data-line="crayon-5c0c9abab33da849627164-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33da849627164-24">24</div><div class="crayon-num" data-line="crayon-5c0c9abab33da849627164-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33da849627164-26">26</div><div class="crayon-num" data-line="crayon-5c0c9abab33da849627164-27">27</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab33da849627164-1"><span class="crayon-p"># load user movement dataset into memory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33da849627164-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line" id="crayon-5c0c9abab33da849627164-3"><span class="crayon-e">from </span><span class="crayon-e">os </span><span class="crayon-e">import </span><span class="crayon-v">listdir</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33da849627164-4"> </div><div class="crayon-line" id="crayon-5c0c9abab33da849627164-5"><span class="crayon-p"># return list of traces, and arrays for targets, groups and paths</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33da849627164-6"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">prefix</span><span class="crayon-o">=</span><span class="crayon-s">''</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9abab33da849627164-7"><span class="crayon-h"> </span><span class="crayon-v">grps_dir</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data_dir</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">prefix</span><span class="crayon-o">+</span><span class="crayon-s">'groups/'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">prefix</span><span class="crayon-o">+</span><span class="crayon-s">'dataset/'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33da849627164-8"><span class="crayon-h"> </span><span class="crayon-p"># load mapping files</span></div><div class="crayon-line" id="crayon-5c0c9abab33da849627164-9"><span class="crayon-h"> </span><span class="crayon-v">targets</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">data_dir</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'MovementAAL_target.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33da849627164-10"><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">grps_dir</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'MovementAAL_DatasetGroup.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33da849627164-11"><span class="crayon-h"> </span><span class="crayon-v">paths</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">grps_dir</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'MovementAAL_Paths.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33da849627164-12"><span class="crayon-h"> </span><span class="crayon-p"># load traces</span></div><div class="crayon-line" id="crayon-5c0c9abab33da849627164-13"><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33da849627164-14"><span class="crayon-h"> </span><span class="crayon-v">target_mapping</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5c0c9abab33da849627164-15"><span class="crayon-e"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">name </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">data_dir</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33da849627164-16"><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data_dir</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">name</span></div><div class="crayon-line" id="crayon-5c0c9abab33da849627164-17"><span class="crayon-e"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">endswith</span><span class="crayon-sy">(</span><span class="crayon-s">'_target.csv'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33da849627164-18"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5c0c9abab33da849627164-19"><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33da849627164-20"><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line" id="crayon-5c0c9abab33da849627164-21"><span class="crayon-e"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33da849627164-22"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">targets</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">paths</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9abab33da849627164-23"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33da849627164-24"><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="crayon-5c0c9abab33da849627164-25"><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">targets</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">paths</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33da849627164-26"><span class="crayon-p"># summarize shape of the loaded data</span></div><div class="crayon-line" id="crayon-5c0c9abab33da849627164-27"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">targets</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">paths</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0015 seconds] -->
<p>Running the example loads the data and shows that 314 traces were correctly loaded from disk along with their associated outputs (targets as -1 or +1), dataset number, (group as 1, 2 or 3) and path number (path as 1-6).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab33dc501692547" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
314 (314,) (314,) (314,)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab33dc501692547-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab33dc501692547-1">314 (314,) (314,) (314,)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p></p>
<h3>Basic Information</h3>
<p>We can now take a closer look at the loaded data to better understand or confirm our understanding of the problem.</p>
<p>We know from the paper that the dataset is reasonably balanced in terms of the two classes. We can confirm this by summarizing the class breakdown of all observations.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab33de008519857" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# summarize class breakdown
class1,class2 = len(targets[targets==-1]), len(targets[targets==1])
print('Class=-1: %d %.3f%%' % (class1, class1/len(targets)*100))
print('Class=+1: %d %.3f%%' % (class2, class2/len(targets)*100))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab33de008519857-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33de008519857-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab33de008519857-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33de008519857-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab33de008519857-1"><span class="crayon-p"># summarize class breakdown</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33de008519857-2"><span class="crayon-v">class1</span><span class="crayon-sy">,</span><span class="crayon-v">class2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">targets</span><span class="crayon-sy">[</span><span class="crayon-v">targets</span><span class="crayon-o">==</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">targets</span><span class="crayon-sy">[</span><span class="crayon-v">targets</span><span class="crayon-o">==</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33de008519857-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Class=-1: %d %.3f%%'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">class1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">class1</span><span class="crayon-o">/</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">targets</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33de008519857-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Class=+1: %d %.3f%%'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">class2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">class2</span><span class="crayon-o">/</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">targets</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Next, we can review the distribution of the sensor strength values for each of the four anchor points by plotting a histogram of the raw values.</p>
<p>This requires that we create one array with all rows of observations so that we can plot the distribution of each column. The <em>vstack()</em> NumPy function will do this job for us.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab33df067115504" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# histogram for each anchor point
all_rows = vstack(sequences)
pyplot.figure()
variables = [0, 1, 2, 3]
for v in variables:
	pyplot.subplot(len(variables), 1, v+1)
	pyplot.hist(all_rows[:, v], bins=20)
pyplot.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab33df067115504-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33df067115504-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab33df067115504-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33df067115504-4">4</div><div class="crayon-num" data-line="crayon-5c0c9abab33df067115504-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33df067115504-6">6</div><div class="crayon-num" data-line="crayon-5c0c9abab33df067115504-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33df067115504-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab33df067115504-1"><span class="crayon-p"># histogram for each anchor point</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33df067115504-2"><span class="crayon-v">all_rows</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">vstack</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33df067115504-3"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33df067115504-4"><span class="crayon-v">variables</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9abab33df067115504-5"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">variables</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33df067115504-6"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">variables</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">v</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33df067115504-7"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">hist</span><span class="crayon-sy">(</span><span class="crayon-v">all_rows</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">v</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">bins</span><span class="crayon-o">=</span><span class="crayon-cn">20</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33df067115504-8"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Finally, another interesting aspect to look at is the distribution of the length of the traces.</p>
<p>We can summarize this distribution using a histogram.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab33e1178701430" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# histogram for trace lengths
trace_lengths = [len(x) for x in sequences]
pyplot.hist(trace_lengths, bins=50)
pyplot.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab33e1178701430-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e1178701430-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab33e1178701430-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e1178701430-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab33e1178701430-1"><span class="crayon-p"># histogram for trace lengths</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e1178701430-2"><span class="crayon-v">trace_lengths</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9abab33e1178701430-3"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">hist</span><span class="crayon-sy">(</span><span class="crayon-v">trace_lengths</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">bins</span><span class="crayon-o">=</span><span class="crayon-cn">50</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e1178701430-4"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Putting this all together, the complete example of loading and summarizing the data is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab33e3082807717" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# summarize simple information about user movement data
from os import listdir
from numpy import array
from numpy import vstack
from pandas import read_csv
from matplotlib import pyplot

# return list of traces, and arrays for targets, groups and paths
def load_dataset(prefix=''):
	grps_dir, data_dir = prefix+'groups/', prefix+'dataset/'
	# load mapping files
	targets = read_csv(data_dir + 'MovementAAL_target.csv', header=0)
	groups = read_csv(grps_dir + 'MovementAAL_DatasetGroup.csv', header=0)
	paths = read_csv(grps_dir + 'MovementAAL_Paths.csv', header=0)
	# load traces
	sequences = list()
	target_mapping = None
	for name in listdir(data_dir):
		filename = data_dir + name
		if filename.endswith('_target.csv'):
			continue
		df = read_csv(filename, header=0)
		values = df.values
		sequences.append(values)
	return sequences, targets.values[:,1], groups.values[:,1], paths.values[:,1]

# load dataset
sequences, targets, groups, paths = load_dataset()
# summarize class breakdown
class1,class2 = len(targets[targets==-1]), len(targets[targets==1])
print('Class=-1: %d %.3f%%' % (class1, class1/len(targets)*100))
print('Class=+1: %d %.3f%%' % (class2, class2/len(targets)*100))
# histogram for each anchor point
all_rows = vstack(sequences)
pyplot.figure()
variables = [0, 1, 2, 3]
for v in variables:
	pyplot.subplot(len(variables), 1, v+1)
	pyplot.hist(all_rows[:, v], bins=20)
pyplot.show()
# histogram for trace lengths
trace_lengths = [len(x) for x in sequences]
pyplot.hist(trace_lengths, bins=50)
pyplot.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab33e3082807717-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e3082807717-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab33e3082807717-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e3082807717-4">4</div><div class="crayon-num" data-line="crayon-5c0c9abab33e3082807717-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e3082807717-6">6</div><div class="crayon-num" data-line="crayon-5c0c9abab33e3082807717-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e3082807717-8">8</div><div class="crayon-num" data-line="crayon-5c0c9abab33e3082807717-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e3082807717-10">10</div><div class="crayon-num" data-line="crayon-5c0c9abab33e3082807717-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e3082807717-12">12</div><div class="crayon-num" data-line="crayon-5c0c9abab33e3082807717-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e3082807717-14">14</div><div class="crayon-num" data-line="crayon-5c0c9abab33e3082807717-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e3082807717-16">16</div><div class="crayon-num" data-line="crayon-5c0c9abab33e3082807717-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e3082807717-18">18</div><div class="crayon-num" data-line="crayon-5c0c9abab33e3082807717-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e3082807717-20">20</div><div class="crayon-num" data-line="crayon-5c0c9abab33e3082807717-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e3082807717-22">22</div><div class="crayon-num" data-line="crayon-5c0c9abab33e3082807717-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e3082807717-24">24</div><div class="crayon-num" data-line="crayon-5c0c9abab33e3082807717-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e3082807717-26">26</div><div class="crayon-num" data-line="crayon-5c0c9abab33e3082807717-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e3082807717-28">28</div><div class="crayon-num" data-line="crayon-5c0c9abab33e3082807717-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e3082807717-30">30</div><div class="crayon-num" data-line="crayon-5c0c9abab33e3082807717-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e3082807717-32">32</div><div class="crayon-num" data-line="crayon-5c0c9abab33e3082807717-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e3082807717-34">34</div><div class="crayon-num" data-line="crayon-5c0c9abab33e3082807717-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e3082807717-36">36</div><div class="crayon-num" data-line="crayon-5c0c9abab33e3082807717-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e3082807717-38">38</div><div class="crayon-num" data-line="crayon-5c0c9abab33e3082807717-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e3082807717-40">40</div><div class="crayon-num" data-line="crayon-5c0c9abab33e3082807717-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e3082807717-42">42</div><div class="crayon-num" data-line="crayon-5c0c9abab33e3082807717-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e3082807717-44">44</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab33e3082807717-1"><span class="crayon-p"># summarize simple information about user movement data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e3082807717-2"><span class="crayon-e">from </span><span class="crayon-e">os </span><span class="crayon-e">import </span><span class="crayon-e">listdir</span></div><div class="crayon-line" id="crayon-5c0c9abab33e3082807717-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e3082807717-4"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">vstack</span></div><div class="crayon-line" id="crayon-5c0c9abab33e3082807717-5"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e3082807717-6"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-v">pyplot</span></div><div class="crayon-line" id="crayon-5c0c9abab33e3082807717-7"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e3082807717-8"><span class="crayon-p"># return list of traces, and arrays for targets, groups and paths</span></div><div class="crayon-line" id="crayon-5c0c9abab33e3082807717-9"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">prefix</span><span class="crayon-o">=</span><span class="crayon-s">''</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e3082807717-10"><span class="crayon-h"> </span><span class="crayon-v">grps_dir</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data_dir</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">prefix</span><span class="crayon-o">+</span><span class="crayon-s">'groups/'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">prefix</span><span class="crayon-o">+</span><span class="crayon-s">'dataset/'</span></div><div class="crayon-line" id="crayon-5c0c9abab33e3082807717-11"><span class="crayon-h"> </span><span class="crayon-p"># load mapping files</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e3082807717-12"><span class="crayon-h"> </span><span class="crayon-v">targets</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">data_dir</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'MovementAAL_target.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33e3082807717-13"><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">grps_dir</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'MovementAAL_DatasetGroup.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e3082807717-14"><span class="crayon-h"> </span><span class="crayon-v">paths</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">grps_dir</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'MovementAAL_Paths.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33e3082807717-15"><span class="crayon-h"> </span><span class="crayon-p"># load traces</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e3082807717-16"><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33e3082807717-17"><span class="crayon-h"> </span><span class="crayon-v">target_mapping</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e3082807717-18"><span class="crayon-e"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">name </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">data_dir</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9abab33e3082807717-19"><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data_dir</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">name</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e3082807717-20"><span class="crayon-e"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">endswith</span><span class="crayon-sy">(</span><span class="crayon-s">'_target.csv'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9abab33e3082807717-21"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e3082807717-22"><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33e3082807717-23"><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e3082807717-24"><span class="crayon-e"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33e3082807717-25"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">targets</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">paths</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e3082807717-26"> </div><div class="crayon-line" id="crayon-5c0c9abab33e3082807717-27"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e3082807717-28"><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">targets</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">paths</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33e3082807717-29"><span class="crayon-p"># summarize class breakdown</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e3082807717-30"><span class="crayon-v">class1</span><span class="crayon-sy">,</span><span class="crayon-v">class2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">targets</span><span class="crayon-sy">[</span><span class="crayon-v">targets</span><span class="crayon-o">==</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">targets</span><span class="crayon-sy">[</span><span class="crayon-v">targets</span><span class="crayon-o">==</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33e3082807717-31"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Class=-1: %d %.3f%%'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">class1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">class1</span><span class="crayon-o">/</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">targets</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e3082807717-32"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Class=+1: %d %.3f%%'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">class2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">class2</span><span class="crayon-o">/</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">targets</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33e3082807717-33"><span class="crayon-p"># histogram for each anchor point</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e3082807717-34"><span class="crayon-v">all_rows</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">vstack</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33e3082807717-35"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e3082807717-36"><span class="crayon-v">variables</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9abab33e3082807717-37"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">variables</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e3082807717-38"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">variables</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">v</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33e3082807717-39"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">hist</span><span class="crayon-sy">(</span><span class="crayon-v">all_rows</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">v</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">bins</span><span class="crayon-o">=</span><span class="crayon-cn">20</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e3082807717-40"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33e3082807717-41"><span class="crayon-p"># histogram for trace lengths</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e3082807717-42"><span class="crayon-v">trace_lengths</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9abab33e3082807717-43"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">hist</span><span class="crayon-sy">(</span><span class="crayon-v">trace_lengths</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">bins</span><span class="crayon-o">=</span><span class="crayon-cn">50</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e3082807717-44"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0025 seconds] -->
<p>Running the example first summarizes the class distribution for the observations.</p>
<p>The results confirm our expectations of the full dataset being nearly perfectly balanced in terms of observations of both class outcomes.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab33e5095002010" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Class=-1: 156 49.682%
Class=+1: 158 50.318%</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab33e5095002010-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e5095002010-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab33e5095002010-1">Class=-1: 156 49.682%</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e5095002010-2">Class=+1: 158 50.318%</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Next, a histogram of the sensor strength for each anchor point is created, summarizing the data distributions.</p>
<p>We can see that the distributions for each variable are close to normal showing Gaussian-like shapes. We can also see perhaps too many observations around -1. This might indicate a generic “no strength” observation that could be marked or even filtered out from the sequences.</p>
<p>It might be interesting to investigate whether the distributions change by path type or even dataset number.</p>
<div class="wp-caption aligncenter" id="attachment_6133" style="width: 1290px"><img alt="Histograms for the sensor strength values for each anchor point" class="size-full wp-image-6133" height="960" sizes="(max-width: 1280px) 100vw, 1280px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Histograms-for-the-sensor-strength-values-for-each-anchor-point.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Histograms-for-the-sensor-strength-values-for-each-anchor-point.png 1280w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Histograms-for-the-sensor-strength-values-for-each-anchor-point-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Histograms-for-the-sensor-strength-values-for-each-anchor-point-768x576.png 768w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Histograms-for-the-sensor-strength-values-for-each-anchor-point-1024x768.png 1024w" width="1280"/><p class="wp-caption-text">Histograms for the sensor strength values for each anchor point</p></div>
<p>Finally, a histogram of the sequence lengths is created.</p>
<p>We can see clusters of sequences with lengths around 25, 40, and 60. We can also see that if we wanted to trim long sequences that a maximum length of around 70 time steps might be appropriate. The smallest length appears to be 19.</p>
<div class="wp-caption aligncenter" id="attachment_6134" style="width: 1290px"><img alt="Histogram of sensor strength sequence lengths" class="size-full wp-image-6134" height="960" sizes="(max-width: 1280px) 100vw, 1280px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Histogram-of-sensor-strength-sequence-lengths.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Histogram-of-sensor-strength-sequence-lengths.png 1280w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Histogram-of-sensor-strength-sequence-lengths-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Histogram-of-sensor-strength-sequence-lengths-768x576.png 768w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Histogram-of-sensor-strength-sequence-lengths-1024x768.png 1024w" width="1280"/><p class="wp-caption-text">Histogram of sensor strength sequence lengths</p></div>
<h3>Time Series Plots</h3>
<p>We are working with time series data, so it is important that we actually review some examples of the sequences.</p>
<p>We can group traces by their path and plot an example of one trace for each path. The expectation is that traces for different paths may look different in some way.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab33e7897461013" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# group sequences by paths
paths = [1,2,3,4,5,6]
seq_paths = dict()
for path in paths:
	seq_paths[path] = [sequences[j] for j in range(len(paths)) if paths[j]==path]
# plot one example of a trace for each path
pyplot.figure()
for i in paths:
	pyplot.subplot(len(paths), 1, i)
	# line plot each variable
	for j in [0, 1, 2, 3]:
		pyplot.plot(seq_paths[i][0][:, j], label='Anchor ' + str(j+1))
	pyplot.title('Path ' + str(i), y=0, loc='left')
pyplot.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab33e7897461013-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e7897461013-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab33e7897461013-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e7897461013-4">4</div><div class="crayon-num" data-line="crayon-5c0c9abab33e7897461013-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e7897461013-6">6</div><div class="crayon-num" data-line="crayon-5c0c9abab33e7897461013-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e7897461013-8">8</div><div class="crayon-num" data-line="crayon-5c0c9abab33e7897461013-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e7897461013-10">10</div><div class="crayon-num" data-line="crayon-5c0c9abab33e7897461013-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e7897461013-12">12</div><div class="crayon-num" data-line="crayon-5c0c9abab33e7897461013-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33e7897461013-14">14</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab33e7897461013-1"><span class="crayon-p"># group sequences by paths</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e7897461013-2"><span class="crayon-v">paths</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9abab33e7897461013-3"><span class="crayon-v">seq_paths</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e7897461013-4"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">path </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">paths</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9abab33e7897461013-5"><span class="crayon-h"> </span><span class="crayon-v">seq_paths</span><span class="crayon-sy">[</span><span class="crayon-v">path</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">paths</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">paths</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-o">==</span><span class="crayon-v">path</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e7897461013-6"><span class="crayon-p"># plot one example of a trace for each path</span></div><div class="crayon-line" id="crayon-5c0c9abab33e7897461013-7"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e7897461013-8"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">paths</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9abab33e7897461013-9"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">paths</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e7897461013-10"><span class="crayon-h"> </span><span class="crayon-p"># line plot each variable</span></div><div class="crayon-line" id="crayon-5c0c9abab33e7897461013-11"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e7897461013-12"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">seq_paths</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'Anchor '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33e7897461013-13"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Path '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loc</span><span class="crayon-o">=</span><span class="crayon-s">'left'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33e7897461013-14"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>We can also plot each series from one trace along with the trend predicted by a linear regression model. This will make any trends in the series obvious.</p>
<p>We can fit a linear regression for a given series using the <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.lstsq.html">lstsq() NumPy Function</a>.</p>
<p>The function <em>regress()</em> below takes a series as a single variable, fits a linear regression model via least squares, and predicts the output for each time step returning a sequence that captures the trend in the data.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab33ea830374202" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# fit a linear regression function and return the predicted values for the series
def regress(y):
	# define input as the time step
	X = array([i for i in range(len(y))]).reshape(len(y), 1)
	# fit linear regression via least squares
	b = lstsq(X, y)[0][0]
	# predict trend on time step
	yhat = b * X[:,0]
	return yhat</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab33ea830374202-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ea830374202-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab33ea830374202-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ea830374202-4">4</div><div class="crayon-num" data-line="crayon-5c0c9abab33ea830374202-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ea830374202-6">6</div><div class="crayon-num" data-line="crayon-5c0c9abab33ea830374202-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ea830374202-8">8</div><div class="crayon-num" data-line="crayon-5c0c9abab33ea830374202-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab33ea830374202-1"><span class="crayon-p"># fit a linear regression function and return the predicted values for the series</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ea830374202-2"><span class="crayon-e">def </span><span class="crayon-e">regress</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9abab33ea830374202-3"><span class="crayon-h"> </span><span class="crayon-p"># define input as the time step</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ea830374202-4"><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33ea830374202-5"><span class="crayon-h"> </span><span class="crayon-p"># fit linear regression via least squares</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ea830374202-6"><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">lstsq</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9abab33ea830374202-7"><span class="crayon-h"> </span><span class="crayon-p"># predict trend on time step</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ea830374202-8"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e ">b *</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9abab33ea830374202-9"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>We can use the function to plot the trend for the time series for each variable in a single trace.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab33ec842831192" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# plot series for a single trace with trend
seq = sequences[0]
variables = [0, 1, 2, 3]
pyplot.figure()
for i in variables:
	pyplot.subplot(len(variables), 1, i+1)
	# plot the series
	pyplot.plot(seq[:,i])
	# plot the trend
	pyplot.plot(regress(seq[:,i]))
pyplot.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab33ec842831192-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ec842831192-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab33ec842831192-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ec842831192-4">4</div><div class="crayon-num" data-line="crayon-5c0c9abab33ec842831192-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ec842831192-6">6</div><div class="crayon-num" data-line="crayon-5c0c9abab33ec842831192-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ec842831192-8">8</div><div class="crayon-num" data-line="crayon-5c0c9abab33ec842831192-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ec842831192-10">10</div><div class="crayon-num" data-line="crayon-5c0c9abab33ec842831192-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab33ec842831192-1"><span class="crayon-p"># plot series for a single trace with trend</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ec842831192-2"><span class="crayon-v">seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9abab33ec842831192-3"><span class="crayon-v">variables</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ec842831192-4"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33ec842831192-5"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">variables</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ec842831192-6"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">variables</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33ec842831192-7"><span class="crayon-h"> </span><span class="crayon-p"># plot the series</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ec842831192-8"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">seq</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33ec842831192-9"><span class="crayon-h"> </span><span class="crayon-p"># plot the trend</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ec842831192-10"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-e">regress</span><span class="crayon-sy">(</span><span class="crayon-v">seq</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33ec842831192-11"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>Tying all of this together, the complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab33ee618528635" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# plot series data
from os import listdir
from numpy import array
from numpy import vstack
from numpy.linalg import lstsq
from pandas import read_csv
from matplotlib import pyplot

# return list of traces, and arrays for targets, groups and paths
def load_dataset(prefix=''):
	grps_dir, data_dir = prefix+'groups/', prefix+'dataset/'
	# load mapping files
	targets = read_csv(data_dir + 'MovementAAL_target.csv', header=0)
	groups = read_csv(grps_dir + 'MovementAAL_DatasetGroup.csv', header=0)
	paths = read_csv(grps_dir + 'MovementAAL_Paths.csv', header=0)
	# load traces
	sequences = list()
	target_mapping = None
	for name in listdir(data_dir):
		filename = data_dir + name
		if filename.endswith('_target.csv'):
			continue
		df = read_csv(filename, header=0)
		values = df.values
		sequences.append(values)
	return sequences, targets.values[:,1], groups.values[:,1], paths.values[:,1]

# fit a linear regression function and return the predicted values for the series
def regress(y):
	# define input as the time step
	X = array([i for i in range(len(y))]).reshape(len(y), 1)
	# fit linear regression via least squares
	b = lstsq(X, y)[0][0]
	# predict trend on time step
	yhat = b * X[:,0]
	return yhat

# load dataset
sequences, targets, groups, paths = load_dataset()
# group sequences by paths
paths = [1,2,3,4,5,6]
seq_paths = dict()
for path in paths:
	seq_paths[path] = [sequences[j] for j in range(len(paths)) if paths[j]==path]
# plot one example of a trace for each path
pyplot.figure()
for i in paths:
	pyplot.subplot(len(paths), 1, i)
	# line plot each variable
	for j in [0, 1, 2, 3]:
		pyplot.plot(seq_paths[i][0][:, j], label='Anchor ' + str(j+1))
	pyplot.title('Path ' + str(i), y=0, loc='left')
pyplot.show()
# plot series for a single trace with trend
seq = sequences[0]
variables = [0, 1, 2, 3]
pyplot.figure()
for i in variables:
	pyplot.subplot(len(variables), 1, i+1)
	# plot the series
	pyplot.plot(seq[:,i])
	# plot the trend
	pyplot.plot(regress(seq[:,i]))
pyplot.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-4">4</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-6">6</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-8">8</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-10">10</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-12">12</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-14">14</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-16">16</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-18">18</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-20">20</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-22">22</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-24">24</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-26">26</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-28">28</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-30">30</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-32">32</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-34">34</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-36">36</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-38">38</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-40">40</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-42">42</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-44">44</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-46">46</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-48">48</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-50">50</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-52">52</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-54">54</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-56">56</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-58">58</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-60">60</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-62">62</div><div class="crayon-num" data-line="crayon-5c0c9abab33ee618528635-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33ee618528635-64">64</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-1"><span class="crayon-p"># plot series data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-2"><span class="crayon-e">from </span><span class="crayon-e">os </span><span class="crayon-e">import </span><span class="crayon-e">listdir</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-4"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">vstack</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-5"><span class="crayon-e">from </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">linalg </span><span class="crayon-e">import </span><span class="crayon-e">lstsq</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-6"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-7"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-v">pyplot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-8"> </div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-9"><span class="crayon-p"># return list of traces, and arrays for targets, groups and paths</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-10"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">prefix</span><span class="crayon-o">=</span><span class="crayon-s">''</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-11"><span class="crayon-h"> </span><span class="crayon-v">grps_dir</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data_dir</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">prefix</span><span class="crayon-o">+</span><span class="crayon-s">'groups/'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">prefix</span><span class="crayon-o">+</span><span class="crayon-s">'dataset/'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-12"><span class="crayon-h"> </span><span class="crayon-p"># load mapping files</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-13"><span class="crayon-h"> </span><span class="crayon-v">targets</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">data_dir</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'MovementAAL_target.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-14"><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">grps_dir</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'MovementAAL_DatasetGroup.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-15"><span class="crayon-h"> </span><span class="crayon-v">paths</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">grps_dir</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'MovementAAL_Paths.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-16"><span class="crayon-h"> </span><span class="crayon-p"># load traces</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-17"><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-18"><span class="crayon-h"> </span><span class="crayon-v">target_mapping</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-19"><span class="crayon-e"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">name </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">data_dir</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-20"><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data_dir</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">name</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-21"><span class="crayon-e"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">endswith</span><span class="crayon-sy">(</span><span class="crayon-s">'_target.csv'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-22"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-23"><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-24"><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-25"><span class="crayon-e"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-26"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">targets</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">paths</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-27"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-28"><span class="crayon-p"># fit a linear regression function and return the predicted values for the series</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-29"><span class="crayon-e">def </span><span class="crayon-e">regress</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-30"><span class="crayon-h"> </span><span class="crayon-p"># define input as the time step</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-31"><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-32"><span class="crayon-h"> </span><span class="crayon-p"># fit linear regression via least squares</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-33"><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">lstsq</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-34"><span class="crayon-h"> </span><span class="crayon-p"># predict trend on time step</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-35"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e ">b *</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-36"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-37"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-38"><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-39"><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">targets</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">paths</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-40"><span class="crayon-p"># group sequences by paths</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-41"><span class="crayon-v">paths</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-42"><span class="crayon-v">seq_paths</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-43"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">path </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">paths</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-44"><span class="crayon-h"> </span><span class="crayon-v">seq_paths</span><span class="crayon-sy">[</span><span class="crayon-v">path</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">paths</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">paths</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-o">==</span><span class="crayon-v">path</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-45"><span class="crayon-p"># plot one example of a trace for each path</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-46"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-47"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">paths</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-48"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">paths</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-49"><span class="crayon-h"> </span><span class="crayon-p"># line plot each variable</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-50"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-51"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">seq_paths</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'Anchor '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-52"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Path '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loc</span><span class="crayon-o">=</span><span class="crayon-s">'left'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-53"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-54"><span class="crayon-p"># plot series for a single trace with trend</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-55"><span class="crayon-v">seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-56"><span class="crayon-v">variables</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-57"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-58"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">variables</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-59"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">variables</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-60"><span class="crayon-h"> </span><span class="crayon-p"># plot the series</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-61"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">seq</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-62"><span class="crayon-h"> </span><span class="crayon-p"># plot the trend</span></div><div class="crayon-line" id="crayon-5c0c9abab33ee618528635-63"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-e">regress</span><span class="crayon-sy">(</span><span class="crayon-v">seq</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33ee618528635-64"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0037 seconds] -->
<p>Running the example creates a plot containing six figures, one for each of the six paths. A given figure shows the line plots of a single trace with the four variables of the trace, one for each anchor point.</p>
<p>Perhaps the chosen traces are representative of each path, perhaps not.</p>
<p>We can see some clear differences with regards to:</p>
<ul>
<li><strong>The grouping of variables over time</strong>. Pairs of variables may be grouped together or all variables may be grouped together at a given time.</li>
<li><strong>The trend of variables over time</strong>. Variables bunch together towards the middle or spread apart towards the extremes.</li>
</ul>
<p>Ideally, if these changes in behavior are predictive, a predictive model must extract these features, or be presented with a summary of these features as input.</p>
<div class="wp-caption aligncenter" id="attachment_6135" style="width: 1290px"><img alt="Line plots of one trace (4 variables) for each of the six paths" class="size-full wp-image-6135" height="960" sizes="(max-width: 1280px) 100vw, 1280px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Line-plots-of-one-trace-4-variables-for-each-of-the-six-paths.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Line-plots-of-one-trace-4-variables-for-each-of-the-six-paths.png 1280w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Line-plots-of-one-trace-4-variables-for-each-of-the-six-paths-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Line-plots-of-one-trace-4-variables-for-each-of-the-six-paths-768x576.png 768w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Line-plots-of-one-trace-4-variables-for-each-of-the-six-paths-1024x768.png 1024w" width="1280"/><p class="wp-caption-text">Line plots of one trace (4 variables) for each of the six paths.</p></div>
<p>A second plot is created showing the line plots for the four series in a single trace along with the trend lines.</p>
<p>We can see that, at least for this trace, there is a clear trend in the sensor strength data as the user moves around the environment. This may suggest the opportunity to make the data stationary prior to modeling or using the trend for each series in a trace (observations or coefficients) as inputs to a predictive model.</p>
<div class="wp-caption aligncenter" id="attachment_6136" style="width: 1290px"><img alt="Line plots for the time series in a single trace with trend lines" class="size-full wp-image-6136" height="960" sizes="(max-width: 1280px) 100vw, 1280px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Line-plots-for-the-time-series-in-a-single-trace-with-trend-lines.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Line-plots-for-the-time-series-in-a-single-trace-with-trend-lines.png 1280w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Line-plots-for-the-time-series-in-a-single-trace-with-trend-lines-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Line-plots-for-the-time-series-in-a-single-trace-with-trend-lines-768x576.png 768w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Line-plots-for-the-time-series-in-a-single-trace-with-trend-lines-1024x768.png 1024w" width="1280"/><p class="wp-caption-text">Line plots for the time series in a single trace with trend lines</p></div>
<h2>Model Evaluation</h2>
<p>There are many ways to fit and evaluate a model on this data.</p>
<p>Classification accuracy seems like a good first-cut evaluation metric given the balance of the classes. More nuance can be sought in the future by predicting probabilities and exploring thresholds on an ROC curve.</p>
<p>I see two main themes in using this data:</p>
<ul>
<li><strong>Same Room</strong>: Can a model trained on traces in a room predict the outcome of new traces in that room?</li>
<li><strong>Different Room</strong>: Can a model trained on traces in one or two rooms predict the outcome of new traces in a different room?</li>
</ul>
<p>The ES1 and ES2 cases described in the paper and summarized above explore these questions and provide a useful starting point.</p>
<p>First, we must partition the loaded traces and targets into the three groups.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab33f0991705443" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# separate traces
seq1 = [sequences[i] for i in range(len(groups)) if groups[i]==1]
seq2 = [sequences[i] for i in range(len(groups)) if groups[i]==2]
seq3 = [sequences[i] for i in range(len(groups)) if groups[i]==3]
print(len(seq1),len(seq2),len(seq3))
# separate target
targets1 = [targets[i] for i in range(len(groups)) if groups[i]==1]
targets2 = [targets[i] for i in range(len(groups)) if groups[i]==2]
targets3 = [targets[i] for i in range(len(groups)) if groups[i]==3]
print(len(targets1),len(targets2),len(targets3))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab33f0991705443-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f0991705443-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab33f0991705443-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f0991705443-4">4</div><div class="crayon-num" data-line="crayon-5c0c9abab33f0991705443-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f0991705443-6">6</div><div class="crayon-num" data-line="crayon-5c0c9abab33f0991705443-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f0991705443-8">8</div><div class="crayon-num" data-line="crayon-5c0c9abab33f0991705443-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f0991705443-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab33f0991705443-1"><span class="crayon-p"># separate traces</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f0991705443-2"><span class="crayon-v">seq1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">==</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9abab33f0991705443-3"><span class="crayon-v">seq2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">==</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f0991705443-4"><span class="crayon-v">seq3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">==</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9abab33f0991705443-5"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">seq1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">seq2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">seq3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f0991705443-6"><span class="crayon-p"># separate target</span></div><div class="crayon-line" id="crayon-5c0c9abab33f0991705443-7"><span class="crayon-v">targets1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">targets</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">==</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f0991705443-8"><span class="crayon-v">targets2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">targets</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">==</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9abab33f0991705443-9"><span class="crayon-v">targets3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">targets</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">==</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f0991705443-10"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">targets1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">targets2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">targets3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0016 seconds] -->
<p>In the case of ES1, we can use k-fold cross-validation where k=5 to use the same ratio from the paper and the repeated evaluation provides some robustness to the evaluation.</p>
<p>We can use the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_score.html">cross_val_score() function</a> from scikit-learn to evaluate a model and then calculate the mean and standard deviation of the scores.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab33f4372311293" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# evaluate model for ES1
from numpy import mean
from numpy import std
from sklearn.model_selection import cross_val_score
...
scores = cross_val_score(model, X, y, scoring='accuracy', cv=5, n_jobs=-1)
m, s = mean(scores), std(scores)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab33f4372311293-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f4372311293-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab33f4372311293-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f4372311293-4">4</div><div class="crayon-num" data-line="crayon-5c0c9abab33f4372311293-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f4372311293-6">6</div><div class="crayon-num" data-line="crayon-5c0c9abab33f4372311293-7">7</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab33f4372311293-1"><span class="crayon-p"># evaluate model for ES1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f4372311293-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">mean</span></div><div class="crayon-line" id="crayon-5c0c9abab33f4372311293-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">std</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f4372311293-4"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-v">cross_val</span><span class="crayon-sy">_</span>score</div><div class="crayon-line" id="crayon-5c0c9abab33f4372311293-5"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f4372311293-6"><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">scoring</span><span class="crayon-o">=</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33f4372311293-7"><span class="crayon-v">m</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>In the case of ES2, we can fit the model on datasets 1 and 2 and test model skill on dataset 3 directly.</p>
<h2>Data Preparation</h2>
<p>There is flexibility in how the input data is framed for the prediction problem.</p>
<p>Two approaches come to mind:</p>
<ul>
<li><strong>Automatic Feature Learning</strong>. Deep neural networks are capable of automatic feature learning and recurrent neural networks can directly support multivariate multi-step input data. A recurrent neural network could be used, such as an LSTM or 1D CNN. The sequences could be padded to be the same length, such as 70 time steps, and a Masking layer could be used to ignore the padded time steps.</li>
<li><strong>Feature Engineering</strong>. Alternately, the variable length sequences could be summarized as a single fixed length vector and provided to standard machine learning models for prediction. This would require careful feature engineering in order to provide a sufficient description of the trace for the model to learn a mapping to the output class.</li>
</ul>
<p>Both are interesting approaches.</p>
<p>As a first pass, we will prepare the more traditional fixed-length vector input via manual feature engineering.</p>
<p>Below are some ideas on features that could be included in the vector:</p>
<ul>
<li>First, middle, or last n observations for a variable.</li>
<li>Mean or standard deviation for the first, middle, or last n observations for a variable.</li>
<li>Difference between the last and first n’th observations</li>
<li>Differenced first, middle, or last n observations for a variable.</li>
<li>Linear regression coefficients of all, first, middle, or last n observations for a variable.</li>
<li>Linear regression predicted trend of first, middle, or last n observations for a variable.</li>
</ul>
<p>Additionally, data scaling is probably not required of the raw values as the data has already been scaled to the range -1 to 1. Scaling may be required if new features are added with different units.</p>
<p>Some of the variables do show some trend, suggesting that perhaps a differencing of the variables may help in teasing out a signal.</p>
<p>The distribution of each variable is nearly Gaussian, so some algorithms may benefit from standardization, or perhaps even a Box-Cox transform.</p>
<h2>Algorithm Spot-Check</h2>
<p>In this section, we will spot-check the default configuration for a suite of standard machine learning algorithms with different sets of engineered features.</p>
<p>Spot-checking is a useful technique to flush out quickly whether there is any signal to be learned in the mapping between inputs and outputs with engineered features as most of the tested methods will pick something up. The method can also suggest methods that might be worth further investigating.</p>
<p>A downside is that each method is not given its best chance (configuration) to show what it can do on the problem, meaning any methods that are further investigated will be biased by the first results.</p>
<p>In these tests, we will look at a suite of six different types of algorithms, specifically:</p>
<ul>
<li>Logistic Regression.</li>
<li>k-Nearest Neighbors.</li>
<li>Decision Tree.</li>
<li>Support Vector Machine.</li>
<li>Random Forest.</li>
<li>Gradient Boosting Machine.</li>
</ul>
<p>We will test the default configurations of these methods on features that focus on the end of the time series variables as they are likely the most predictive of whether a room transition will occur or not.</p>
<h3>Last <em>n</em> Observations</h3>
<p>The last <em>n</em> observations are likely to be predictive of whether the movement leads to a transition in rooms.</p>
<p>The smallest number of time steps in the trace data is 19, therefore, we will use <em>n=19</em> as a starting point.</p>
<p>The function below named <em>create_dataset()</em> will create a fixed-length vector using the last <em>n</em> observations from each trace in a flat one-dimensional vector, then add the target as the last element of the vector.</p>
<p>This flattening of the trace data is required for simple machine learning algorithms.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab33f6228667776" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# create a fixed 1d vector for each trace with output variable
def create_dataset(sequences, targets):
	# create the transformed dataset
	transformed = list()
	n_vars = 4
	n_steps = 19
	# process each trace in turn
	for i in range(len(sequences)):
		seq = sequences[i]
		vector = list()
		# last n observations
		for row in range(1, n_steps+1):
			for col in range(n_vars):
				vector.append(seq[-row, col])
		# add output
		vector.append(targets[i])
		# store
		transformed.append(vector)
	# prepare array
	transformed = array(transformed)
	transformed = transformed.astype('float32')
	return transformed</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab33f6228667776-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f6228667776-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab33f6228667776-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f6228667776-4">4</div><div class="crayon-num" data-line="crayon-5c0c9abab33f6228667776-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f6228667776-6">6</div><div class="crayon-num" data-line="crayon-5c0c9abab33f6228667776-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f6228667776-8">8</div><div class="crayon-num" data-line="crayon-5c0c9abab33f6228667776-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f6228667776-10">10</div><div class="crayon-num" data-line="crayon-5c0c9abab33f6228667776-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f6228667776-12">12</div><div class="crayon-num" data-line="crayon-5c0c9abab33f6228667776-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f6228667776-14">14</div><div class="crayon-num" data-line="crayon-5c0c9abab33f6228667776-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f6228667776-16">16</div><div class="crayon-num" data-line="crayon-5c0c9abab33f6228667776-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f6228667776-18">18</div><div class="crayon-num" data-line="crayon-5c0c9abab33f6228667776-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f6228667776-20">20</div><div class="crayon-num" data-line="crayon-5c0c9abab33f6228667776-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f6228667776-22">22</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab33f6228667776-1"><span class="crayon-p"># create a fixed 1d vector for each trace with output variable</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f6228667776-2"><span class="crayon-e">def </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">targets</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9abab33f6228667776-3"><span class="crayon-h"> </span><span class="crayon-p"># create the transformed dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f6228667776-4"><span class="crayon-h"> </span><span class="crayon-v">transformed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33f6228667776-5"><span class="crayon-h"> </span><span class="crayon-v">n_vars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">4</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f6228667776-6"><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">19</span></div><div class="crayon-line" id="crayon-5c0c9abab33f6228667776-7"><span class="crayon-h"> </span><span class="crayon-p"># process each trace in turn</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f6228667776-8"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9abab33f6228667776-9"><span class="crayon-h"> </span><span class="crayon-v">seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f6228667776-10"><span class="crayon-h"> </span><span class="crayon-v">vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33f6228667776-11"><span class="crayon-h"> </span><span class="crayon-p"># last n observations</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f6228667776-12"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9abab33f6228667776-13"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">col </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f6228667776-14"><span class="crayon-h"> </span><span class="crayon-v">vector</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">col</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33f6228667776-15"><span class="crayon-h"> </span><span class="crayon-p"># add output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f6228667776-16"><span class="crayon-h"> </span><span class="crayon-v">vector</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">targets</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33f6228667776-17"><span class="crayon-h"> </span><span class="crayon-p"># store</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f6228667776-18"><span class="crayon-h"> </span><span class="crayon-v">transformed</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">vector</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33f6228667776-19"><span class="crayon-h"> </span><span class="crayon-p"># prepare array</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f6228667776-20"><span class="crayon-h"> </span><span class="crayon-v">transformed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">transformed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33f6228667776-21"><span class="crayon-h"> </span><span class="crayon-v">transformed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">transformed</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f6228667776-22"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">transformed</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0010 seconds] -->
<p>We can load the dataset as before and sort it into the datasets 1, 2, and 3 as described in the “<em>Model Evaluation</em>” section.</p>
<p>We can then call the <em>create_dataset()</em> function to create the datasets required for the ES1 and ES2 cases, specifically ES1 combines datasets 1 and 2, whereas ES2 uses datasets 1 and 2 as a training set and dataset 3 as a test set.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab33f9662670299" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# prepare fixed length vector dataset
from os import listdir
from numpy import array
from numpy import savetxt
from pandas import read_csv

# return list of traces, and arrays for targets, groups and paths
def load_dataset(prefix=''):
	grps_dir, data_dir = prefix+'groups/', prefix+'dataset/'
	# load mapping files
	targets = read_csv(data_dir + 'MovementAAL_target.csv', header=0)
	groups = read_csv(grps_dir + 'MovementAAL_DatasetGroup.csv', header=0)
	paths = read_csv(grps_dir + 'MovementAAL_Paths.csv', header=0)
	# load traces
	sequences = list()
	target_mapping = None
	for name in listdir(data_dir):
		filename = data_dir + name
		if filename.endswith('_target.csv'):
			continue
		df = read_csv(filename, header=0)
		values = df.values
		sequences.append(values)
	return sequences, targets.values[:,1], groups.values[:,1], paths.values[:,1]

# create a fixed 1d vector for each trace with output variable
def create_dataset(sequences, targets):
	# create the transformed dataset
	transformed = list()
	n_vars = 4
	n_steps = 19
	# process each trace in turn
	for i in range(len(sequences)):
		seq = sequences[i]
		vector = list()
		# last n observations
		for row in range(1, n_steps+1):
			for col in range(n_vars):
				vector.append(seq[-row, col])
		# add output
		vector.append(targets[i])
		# store
		transformed.append(vector)
	# prepare array
	transformed = array(transformed)
	transformed = transformed.astype('float32')
	return transformed

# load dataset
sequences, targets, groups, paths = load_dataset()
# separate traces
seq1 = [sequences[i] for i in range(len(groups)) if groups[i]==1]
seq2 = [sequences[i] for i in range(len(groups)) if groups[i]==2]
seq3 = [sequences[i] for i in range(len(groups)) if groups[i]==3]
# separate target
targets1 = [targets[i] for i in range(len(groups)) if groups[i]==1]
targets2 = [targets[i] for i in range(len(groups)) if groups[i]==2]
targets3 = [targets[i] for i in range(len(groups)) if groups[i]==3]
# create ES1 dataset
es1 = create_dataset(seq1+seq2, targets1+targets2)
print('ES1: %s' % str(es1.shape))
savetxt('es1.csv', es1, delimiter=',')
# create ES2 dataset
es2_train = create_dataset(seq1+seq2, targets1+targets2)
es2_test = create_dataset(seq3, targets3)
print('ES2 Train: %s' % str(es2_train.shape))
print('ES2 Test: %s' % str(es2_test.shape))
savetxt('es2_train.csv', es2_train, delimiter=',')
savetxt('es2_test.csv', es2_test, delimiter=',')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-4">4</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-6">6</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-8">8</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-10">10</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-12">12</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-14">14</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-16">16</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-18">18</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-20">20</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-22">22</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-24">24</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-26">26</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-28">28</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-30">30</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-32">32</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-34">34</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-36">36</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-38">38</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-40">40</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-42">42</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-44">44</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-46">46</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-48">48</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-50">50</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-52">52</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-54">54</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-56">56</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-58">58</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-60">60</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-62">62</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-64">64</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-66">66</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33f9662670299-68">68</div><div class="crayon-num" data-line="crayon-5c0c9abab33f9662670299-69">69</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-1"><span class="crayon-p"># prepare fixed length vector dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-2"><span class="crayon-e">from </span><span class="crayon-e">os </span><span class="crayon-e">import </span><span class="crayon-e">listdir</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-4"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">savetxt</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-5"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-v">read_csv</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-6"> </div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-7"><span class="crayon-p"># return list of traces, and arrays for targets, groups and paths</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-8"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">prefix</span><span class="crayon-o">=</span><span class="crayon-s">''</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-9"><span class="crayon-h"> </span><span class="crayon-v">grps_dir</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data_dir</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">prefix</span><span class="crayon-o">+</span><span class="crayon-s">'groups/'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">prefix</span><span class="crayon-o">+</span><span class="crayon-s">'dataset/'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-10"><span class="crayon-h"> </span><span class="crayon-p"># load mapping files</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-11"><span class="crayon-h"> </span><span class="crayon-v">targets</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">data_dir</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'MovementAAL_target.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-12"><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">grps_dir</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'MovementAAL_DatasetGroup.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-13"><span class="crayon-h"> </span><span class="crayon-v">paths</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">grps_dir</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'MovementAAL_Paths.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-14"><span class="crayon-h"> </span><span class="crayon-p"># load traces</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-15"><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-16"><span class="crayon-h"> </span><span class="crayon-v">target_mapping</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-17"><span class="crayon-e"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">name </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">data_dir</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-18"><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data_dir</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">name</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-19"><span class="crayon-e"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">endswith</span><span class="crayon-sy">(</span><span class="crayon-s">'_target.csv'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-20"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-21"><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-22"><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-23"><span class="crayon-e"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-24"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">targets</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">paths</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-25"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-26"><span class="crayon-p"># create a fixed 1d vector for each trace with output variable</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-27"><span class="crayon-e">def </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">targets</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-28"><span class="crayon-h"> </span><span class="crayon-p"># create the transformed dataset</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-29"><span class="crayon-h"> </span><span class="crayon-v">transformed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-30"><span class="crayon-h"> </span><span class="crayon-v">n_vars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">4</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-31"><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">19</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-32"><span class="crayon-h"> </span><span class="crayon-p"># process each trace in turn</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-33"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-34"><span class="crayon-h"> </span><span class="crayon-v">seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-35"><span class="crayon-h"> </span><span class="crayon-v">vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-36"><span class="crayon-h"> </span><span class="crayon-p"># last n observations</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-37"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-38"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">col </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-39"><span class="crayon-h"> </span><span class="crayon-v">vector</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">col</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-40"><span class="crayon-h"> </span><span class="crayon-p"># add output</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-41"><span class="crayon-h"> </span><span class="crayon-v">vector</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">targets</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-42"><span class="crayon-h"> </span><span class="crayon-p"># store</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-43"><span class="crayon-h"> </span><span class="crayon-v">transformed</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">vector</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-44"><span class="crayon-h"> </span><span class="crayon-p"># prepare array</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-45"><span class="crayon-h"> </span><span class="crayon-v">transformed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">transformed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-46"><span class="crayon-h"> </span><span class="crayon-v">transformed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">transformed</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-47"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">transformed</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-48"> </div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-49"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-50"><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">targets</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">paths</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-51"><span class="crayon-p"># separate traces</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-52"><span class="crayon-v">seq1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">==</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-53"><span class="crayon-v">seq2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">==</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-54"><span class="crayon-v">seq3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">==</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-55"><span class="crayon-p"># separate target</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-56"><span class="crayon-v">targets1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">targets</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">==</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-57"><span class="crayon-v">targets2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">targets</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">==</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-58"><span class="crayon-v">targets3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">targets</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">==</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-59"><span class="crayon-p"># create ES1 dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-60"><span class="crayon-v">es1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">seq1</span><span class="crayon-o">+</span><span class="crayon-v">seq2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">targets1</span><span class="crayon-o">+</span><span class="crayon-v">targets2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-61"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'ES1: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">es1</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-62"><span class="crayon-e">savetxt</span><span class="crayon-sy">(</span><span class="crayon-s">'es1.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">es1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">','</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-63"><span class="crayon-p"># create ES2 dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-64"><span class="crayon-v">es2_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">seq1</span><span class="crayon-o">+</span><span class="crayon-v">seq2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">targets1</span><span class="crayon-o">+</span><span class="crayon-v">targets2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-65"><span class="crayon-v">es2_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">seq3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">targets3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-66"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'ES2 Train: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">es2_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-67"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'ES2 Test: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">es2_test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33f9662670299-68"><span class="crayon-e">savetxt</span><span class="crayon-sy">(</span><span class="crayon-s">'es2_train.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">es2_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">','</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33f9662670299-69"><span class="crayon-e">savetxt</span><span class="crayon-sy">(</span><span class="crayon-s">'es2_test.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">es2_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">','</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0043 seconds] -->
<p>Running the example creates three new CSV files, specifically ‘<em>es1.csv</em>‘, ‘<em>es2_train.csv</em>‘, and ‘<em>es2_test.csv</em>‘ for the ES1 and ES2 cases respectively.</p>
<p>The shapes of these datasets are also summarized.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab33fc850243148" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
ES1: (210, 77)
ES2 Train: (210, 77)
ES2 Test: (104, 77)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab33fc850243148-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fc850243148-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab33fc850243148-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab33fc850243148-1">ES1: (210, 77)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fc850243148-2">ES2 Train: (210, 77)</div><div class="crayon-line" id="crayon-5c0c9abab33fc850243148-3">ES2 Test: (104, 77)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Next, we can evaluate models on the ES1 dataset.</p>
<p>After some testing, it appears that standardizing the dataset results in better model skill for those methods that rely on distance values (KNN and SVM) and generally has no effect on other methods. Therefore a Pipeline is used to evaluate each algorithm that first standardizes the dataset.</p>
<p>The complete example of spot checking algorithms on the new dataset is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab33fe205351789" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# spot check for ES1
from numpy import mean
from numpy import std
from pandas import read_csv
from matplotlib import pyplot
from sklearn.model_selection import cross_val_score
from sklearn.pipeline import Pipeline
from sklearn.preprocessing import StandardScaler
from sklearn.linear_model import LogisticRegression
from sklearn.neighbors import KNeighborsClassifier
from sklearn.tree import DecisionTreeClassifier
from sklearn.svm import SVC
from sklearn.ensemble import RandomForestClassifier
from sklearn.ensemble import GradientBoostingClassifier
# load dataset
dataset = read_csv('es1.csv', header=None)
# split into inputs and outputs
values = dataset.values
X, y = values[:, :-1], values[:, -1]
# create a list of models to evaluate
models, names = list(), list()
# logistic
models.append(LogisticRegression())
names.append('LR')
# knn
models.append(KNeighborsClassifier())
names.append('KNN')
# cart
models.append(DecisionTreeClassifier())
names.append('CART')
# svm
models.append(SVC())
names.append('SVM')
# random forest
models.append(RandomForestClassifier())
names.append('RF')
# gbm
models.append(GradientBoostingClassifier())
names.append('GBM')
# evaluate models
all_scores = list()
for i in range(len(models)):
	# create a pipeline for the model
	s = StandardScaler()
	p = Pipeline(steps=[('s',s), ('m',models[i])])
	scores = cross_val_score(p, X, y, scoring='accuracy', cv=5, n_jobs=-1)
	all_scores.append(scores)
	# summarize
	m, s = mean(scores)*100, std(scores)*100
	print('%s %.3f%% +/-%.3f' % (names[i], m, s))
# plot
pyplot.boxplot(all_scores, labels=names)
pyplot.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-4">4</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-6">6</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-8">8</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-10">10</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-12">12</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-14">14</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-16">16</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-18">18</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-20">20</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-22">22</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-24">24</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-26">26</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-28">28</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-30">30</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-32">32</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-34">34</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-36">36</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-38">38</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-40">40</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-42">42</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-44">44</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-46">46</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-48">48</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-50">50</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab33fe205351789-52">52</div><div class="crayon-num" data-line="crayon-5c0c9abab33fe205351789-53">53</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-1"><span class="crayon-p"># spot check for ES1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">mean</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">std</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-4"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-5"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-6"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">cross_val_score</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-7"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">pipeline </span><span class="crayon-e">import </span><span class="crayon-e">Pipeline</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-8"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">StandardScaler</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-9"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">LogisticRegression</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-10"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">neighbors </span><span class="crayon-e">import </span><span class="crayon-e">KNeighborsClassifier</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-11"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">tree </span><span class="crayon-e">import </span><span class="crayon-e">DecisionTreeClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-12"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">svm </span><span class="crayon-e">import </span><span class="crayon-e">SVC</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-13"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">RandomForestClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-14"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-v">GradientBoostingClassifier</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-15"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-16"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'es1.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-v">None</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-17"><span class="crayon-p"># split into inputs and outputs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-18"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-i">values</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-19"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-20"><span class="crayon-p"># create a list of models to evaluate</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-21"><span class="crayon-v">models</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-22"><span class="crayon-p"># logistic</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-23"><span class="crayon-v">models</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e">LogisticRegression</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-24"><span class="crayon-v">names</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-s">'LR'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-25"><span class="crayon-p"># knn</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-26"><span class="crayon-v">models</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e">KNeighborsClassifier</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-27"><span class="crayon-v">names</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-s">'KNN'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-28"><span class="crayon-p"># cart</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-29"><span class="crayon-v">models</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e">DecisionTreeClassifier</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-30"><span class="crayon-v">names</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-s">'CART'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-31"><span class="crayon-p"># svm</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-32"><span class="crayon-v">models</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e">SVC</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-33"><span class="crayon-v">names</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-s">'SVM'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-34"><span class="crayon-p"># random forest</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-35"><span class="crayon-v">models</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e">RandomForestClassifier</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-36"><span class="crayon-v">names</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-s">'RF'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-37"><span class="crayon-p"># gbm</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-38"><span class="crayon-v">models</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e">GradientBoostingClassifier</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-39"><span class="crayon-v">names</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-s">'GBM'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-40"><span class="crayon-p"># evaluate models</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-41"><span class="crayon-v">all_scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-42"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-43"><span class="crayon-h"> </span><span class="crayon-p"># create a pipeline for the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-44"><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-45"><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">steps</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'s'</span><span class="crayon-sy">,</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">'m'</span><span class="crayon-sy">,</span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-46"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">scoring</span><span class="crayon-o">=</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-47"><span class="crayon-h"> </span><span class="crayon-v">all_scores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-48"><span class="crayon-h"> </span><span class="crayon-p"># summarize</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-49"><span class="crayon-h"> </span><span class="crayon-v">m</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-50"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'%s %.3f%% +/-%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">names</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">m</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-51"><span class="crayon-p"># plot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab33fe205351789-52"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">boxplot</span><span class="crayon-sy">(</span><span class="crayon-v">all_scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-o">=</span><span class="crayon-v">names</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab33fe205351789-53"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0024 seconds] -->
<p>Running the example prints the estimated performance of each algorithm, including the mean and standard deviation over 5-fold cross-validation.</p>
<p>The results suggest SVM might be worth looking at in more detail at 58% accuracy.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab3400278618722" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
LR 55.285% +/-5.518
KNN 50.897% +/-5.310
CART 50.501% +/-10.922
SVM 58.551% +/-7.707
RF 50.442% +/-6.355
GBM 55.749% +/-5.423</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab3400278618722-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab3400278618722-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab3400278618722-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab3400278618722-4">4</div><div class="crayon-num" data-line="crayon-5c0c9abab3400278618722-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab3400278618722-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab3400278618722-1">LR 55.285% +/-5.518</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab3400278618722-2">KNN 50.897% +/-5.310</div><div class="crayon-line" id="crayon-5c0c9abab3400278618722-3">CART 50.501% +/-10.922</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab3400278618722-4">SVM 58.551% +/-7.707</div><div class="crayon-line" id="crayon-5c0c9abab3400278618722-5">RF 50.442% +/-6.355</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab3400278618722-6">GBM 55.749% +/-5.423</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>The results are also presented as box-and-whisker plots showing the distribution of scores.</p>
<p>Again, SVM appears to have good average performance and tight variance.</p>
<div class="wp-caption aligncenter" id="attachment_6137" style="width: 1290px"><img alt="Spot-check Algorithms on ES1 with last 19 observations" class="size-full wp-image-6137" height="960" sizes="(max-width: 1280px) 100vw, 1280px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Spot-check-Algorithms-on-ES1-with-last-19-observations.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Spot-check-Algorithms-on-ES1-with-last-19-observations.png 1280w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Spot-check-Algorithms-on-ES1-with-last-19-observations-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Spot-check-Algorithms-on-ES1-with-last-19-observations-768x576.png 768w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Spot-check-Algorithms-on-ES1-with-last-19-observations-1024x768.png 1024w" width="1280"/><p class="wp-caption-text">Spot-check Algorithms on ES1 with last 19 observations</p></div>
<h3>Last <em>n</em> Observations With Padding</h3>
<p>We can pad each trace to a fixed length.</p>
<p>This will then provide the flexibility to include more of the prior <em>n</em> observations in each sequence. The choice of <em>n</em> must also be balanced with the increase in padded values added to shorter sequences that in turn may negatively impact the performance of the model on those sequences.</p>
<p>We can pad each sequence by adding the 0.0 value to the beginning of each variable sequence until a maximum length, e.g. 200 time steps, is reached. We can do this using the <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.pad.html">pad() NumPy function</a>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab3402575936308" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from numpy import pad
...
# pad sequences
max_length = 200
seq = pad(seq, ((max_length-len(seq),0),(0,0)), 'constant', constant_values=(0.0))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab3402575936308-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab3402575936308-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab3402575936308-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab3402575936308-4">4</div><div class="crayon-num" data-line="crayon-5c0c9abab3402575936308-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab3402575936308-1"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-i">pad</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab3402575936308-2"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5c0c9abab3402575936308-3"><span class="crayon-p"># pad sequences</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab3402575936308-4"><span class="crayon-v">max_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">200</span></div><div class="crayon-line" id="crayon-5c0c9abab3402575936308-5"><span class="crayon-v">seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pad</span><span class="crayon-sy">(</span><span class="crayon-v">seq</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">max_length</span><span class="crayon-o">-</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">seq</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'constant'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">constant_values</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">0.0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>The updated version of the <em>create_dataset()</em> function with padding support is below.</p>
<p>We will try <em>n=25</em> to include 25 of the last observations in each sequence in each vector. This value was found with a little trial and error, although you may want to explore whether other configurations result in better skill.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab3404487531143" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# create a fixed 1d vector for each trace with output variable
def create_dataset(sequences, targets):
	# create the transformed dataset
	transformed = list()
	n_vars, n_steps, max_length = 4, 25, 200
	# process each trace in turn
	for i in range(len(sequences)):
		seq = sequences[i]
		# pad sequences
		seq = pad(seq, ((max_length-len(seq),0),(0,0)), 'constant', constant_values=(0.0))
		vector = list()
		# last n observations
		for row in range(1, n_steps+1):
			for col in range(n_vars):
				vector.append(seq[-row, col])
		# add output
		vector.append(targets[i])
		# store
		transformed.append(vector)
	# prepare array
	transformed = array(transformed)
	transformed = transformed.astype('float32')
	return transformed</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab3404487531143-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab3404487531143-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab3404487531143-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab3404487531143-4">4</div><div class="crayon-num" data-line="crayon-5c0c9abab3404487531143-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab3404487531143-6">6</div><div class="crayon-num" data-line="crayon-5c0c9abab3404487531143-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab3404487531143-8">8</div><div class="crayon-num" data-line="crayon-5c0c9abab3404487531143-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab3404487531143-10">10</div><div class="crayon-num" data-line="crayon-5c0c9abab3404487531143-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab3404487531143-12">12</div><div class="crayon-num" data-line="crayon-5c0c9abab3404487531143-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab3404487531143-14">14</div><div class="crayon-num" data-line="crayon-5c0c9abab3404487531143-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab3404487531143-16">16</div><div class="crayon-num" data-line="crayon-5c0c9abab3404487531143-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab3404487531143-18">18</div><div class="crayon-num" data-line="crayon-5c0c9abab3404487531143-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab3404487531143-20">20</div><div class="crayon-num" data-line="crayon-5c0c9abab3404487531143-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab3404487531143-22">22</div><div class="crayon-num" data-line="crayon-5c0c9abab3404487531143-23">23</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab3404487531143-1"><span class="crayon-p"># create a fixed 1d vector for each trace with output variable</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab3404487531143-2"><span class="crayon-e">def </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">targets</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9abab3404487531143-3"><span class="crayon-h"> </span><span class="crayon-p"># create the transformed dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab3404487531143-4"><span class="crayon-h"> </span><span class="crayon-v">transformed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab3404487531143-5"><span class="crayon-h"> </span><span class="crayon-v">n_vars</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">200</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab3404487531143-6"><span class="crayon-h"> </span><span class="crayon-p"># process each trace in turn</span></div><div class="crayon-line" id="crayon-5c0c9abab3404487531143-7"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab3404487531143-8"><span class="crayon-h"> </span><span class="crayon-v">seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9abab3404487531143-9"><span class="crayon-h"> </span><span class="crayon-p"># pad sequences</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab3404487531143-10"><span class="crayon-h"> </span><span class="crayon-v">seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pad</span><span class="crayon-sy">(</span><span class="crayon-v">seq</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">max_length</span><span class="crayon-o">-</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">seq</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'constant'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">constant_values</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">0.0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab3404487531143-11"><span class="crayon-h"> </span><span class="crayon-v">vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab3404487531143-12"><span class="crayon-h"> </span><span class="crayon-p"># last n observations</span></div><div class="crayon-line" id="crayon-5c0c9abab3404487531143-13"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_steps</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab3404487531143-14"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">col </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9abab3404487531143-15"><span class="crayon-h"> </span><span class="crayon-v">vector</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">seq</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">col</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab3404487531143-16"><span class="crayon-h"> </span><span class="crayon-p"># add output</span></div><div class="crayon-line" id="crayon-5c0c9abab3404487531143-17"><span class="crayon-h"> </span><span class="crayon-v">vector</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">targets</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab3404487531143-18"><span class="crayon-h"> </span><span class="crayon-p"># store</span></div><div class="crayon-line" id="crayon-5c0c9abab3404487531143-19"><span class="crayon-h"> </span><span class="crayon-v">transformed</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">vector</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab3404487531143-20"><span class="crayon-h"> </span><span class="crayon-p"># prepare array</span></div><div class="crayon-line" id="crayon-5c0c9abab3404487531143-21"><span class="crayon-h"> </span><span class="crayon-v">transformed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">transformed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab3404487531143-22"><span class="crayon-h"> </span><span class="crayon-v">transformed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">transformed</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab3404487531143-23"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">transformed</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0013 seconds] -->
<p>Running the script again with the new function creates updated CSV files.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab3406481144691" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
ES1: (210, 101)
ES2 Train: (210, 101)
ES2 Test: (104, 101)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab3406481144691-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab3406481144691-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab3406481144691-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab3406481144691-1">ES1: (210, 101)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab3406481144691-2">ES2 Train: (210, 101)</div><div class="crayon-line" id="crayon-5c0c9abab3406481144691-3">ES2 Test: (104, 101)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Again, re-running the spot-check script on the data results in a small lift in model skill for SVM and also suggests that KNN might be worth investigating further.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab3408396327670" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
LR 54.344% +/-6.195
KNN 58.562% +/-4.456
CART 52.837% +/-7.650
SVM 59.515% +/-6.054
RF 50.396% +/-7.069
GBM 50.873% +/-5.416</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab3408396327670-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab3408396327670-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab3408396327670-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab3408396327670-4">4</div><div class="crayon-num" data-line="crayon-5c0c9abab3408396327670-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab3408396327670-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab3408396327670-1">LR 54.344% +/-6.195</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab3408396327670-2">KNN 58.562% +/-4.456</div><div class="crayon-line" id="crayon-5c0c9abab3408396327670-3">CART 52.837% +/-7.650</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab3408396327670-4">SVM 59.515% +/-6.054</div><div class="crayon-line" id="crayon-5c0c9abab3408396327670-5">RF 50.396% +/-7.069</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab3408396327670-6">GBM 50.873% +/-5.416</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>The box plots for KNN and SVM show good performance and relatively tight standard deviations.</p>
<div class="wp-caption aligncenter" id="attachment_6138" style="width: 1290px"><img alt="Spot-check Algorithms on ES1 with last 25 observations" class="size-full wp-image-6138" height="960" sizes="(max-width: 1280px) 100vw, 1280px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Spot-check-Algorithms-on-ES1-with-last-25-observations.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Spot-check-Algorithms-on-ES1-with-last-25-observations.png 1280w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Spot-check-Algorithms-on-ES1-with-last-25-observations-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Spot-check-Algorithms-on-ES1-with-last-25-observations-768x576.png 768w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Spot-check-Algorithms-on-ES1-with-last-25-observations-1024x768.png 1024w" width="1280"/><p class="wp-caption-text">Spot-check Algorithms on ES1 with last 25 observations</p></div>
<p>We can update the spot-check to grid search a suite of k values for the KNN algorithm to see if the skill of the model can be further improved with a little tuning.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab340a395419436" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# spot check for ES1
from numpy import mean
from numpy import std
from pandas import read_csv
from matplotlib import pyplot
from sklearn.model_selection import cross_val_score
from sklearn.neighbors import KNeighborsClassifier
from sklearn.pipeline import Pipeline
from sklearn.preprocessing import StandardScaler

# load dataset
dataset = read_csv('es1.csv', header=None)
# split into inputs and outputs
values = dataset.values
X, y = values[:, :-1], values[:, -1]
# try a range of k values
all_scores, names = list(), list()
for k in range(1,22):
	# evaluate
	scaler = StandardScaler()
	model = KNeighborsClassifier(n_neighbors=k)
	pipeline = Pipeline(steps=[('s',scaler), ('m',model)])
	names.append(str(k))
	scores = cross_val_score(pipeline, X, y, scoring='accuracy', cv=5, n_jobs=-1)
	all_scores.append(scores)
	# summarize
	m, s = mean(scores)*100, std(scores)*100
	print('k=%d %.3f%% +/-%.3f' % (k, m, s))
# plot
pyplot.boxplot(all_scores, labels=names)
pyplot.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab340a395419436-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340a395419436-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab340a395419436-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340a395419436-4">4</div><div class="crayon-num" data-line="crayon-5c0c9abab340a395419436-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340a395419436-6">6</div><div class="crayon-num" data-line="crayon-5c0c9abab340a395419436-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340a395419436-8">8</div><div class="crayon-num" data-line="crayon-5c0c9abab340a395419436-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340a395419436-10">10</div><div class="crayon-num" data-line="crayon-5c0c9abab340a395419436-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340a395419436-12">12</div><div class="crayon-num" data-line="crayon-5c0c9abab340a395419436-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340a395419436-14">14</div><div class="crayon-num" data-line="crayon-5c0c9abab340a395419436-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340a395419436-16">16</div><div class="crayon-num" data-line="crayon-5c0c9abab340a395419436-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340a395419436-18">18</div><div class="crayon-num" data-line="crayon-5c0c9abab340a395419436-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340a395419436-20">20</div><div class="crayon-num" data-line="crayon-5c0c9abab340a395419436-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340a395419436-22">22</div><div class="crayon-num" data-line="crayon-5c0c9abab340a395419436-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340a395419436-24">24</div><div class="crayon-num" data-line="crayon-5c0c9abab340a395419436-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340a395419436-26">26</div><div class="crayon-num" data-line="crayon-5c0c9abab340a395419436-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340a395419436-28">28</div><div class="crayon-num" data-line="crayon-5c0c9abab340a395419436-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340a395419436-30">30</div><div class="crayon-num" data-line="crayon-5c0c9abab340a395419436-31">31</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab340a395419436-1"><span class="crayon-p"># spot check for ES1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340a395419436-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">mean</span></div><div class="crayon-line" id="crayon-5c0c9abab340a395419436-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">std</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340a395419436-4"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line" id="crayon-5c0c9abab340a395419436-5"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340a395419436-6"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">cross_val_score</span></div><div class="crayon-line" id="crayon-5c0c9abab340a395419436-7"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">neighbors </span><span class="crayon-e">import </span><span class="crayon-e">KNeighborsClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340a395419436-8"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">pipeline </span><span class="crayon-e">import </span><span class="crayon-e">Pipeline</span></div><div class="crayon-line" id="crayon-5c0c9abab340a395419436-9"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-v">StandardScaler</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340a395419436-10"> </div><div class="crayon-line" id="crayon-5c0c9abab340a395419436-11"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340a395419436-12"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'es1.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-v">None</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab340a395419436-13"><span class="crayon-p"># split into inputs and outputs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340a395419436-14"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-i">values</span></div><div class="crayon-line" id="crayon-5c0c9abab340a395419436-15"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340a395419436-16"><span class="crayon-p"># try a range of k values</span></div><div class="crayon-line" id="crayon-5c0c9abab340a395419436-17"><span class="crayon-v">all_scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340a395419436-18"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">k</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">22</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9abab340a395419436-19"><span class="crayon-h"> </span><span class="crayon-p"># evaluate</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340a395419436-20"><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab340a395419436-21"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KNeighborsClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_neighbors</span><span class="crayon-o">=</span><span class="crayon-v">k</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340a395419436-22"><span class="crayon-h"> </span><span class="crayon-v">pipeline</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">steps</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'s'</span><span class="crayon-sy">,</span><span class="crayon-v">scaler</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">'m'</span><span class="crayon-sy">,</span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab340a395419436-23"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340a395419436-24"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">pipeline</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">scoring</span><span class="crayon-o">=</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab340a395419436-25"><span class="crayon-h"> </span><span class="crayon-v">all_scores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340a395419436-26"><span class="crayon-h"> </span><span class="crayon-p"># summarize</span></div><div class="crayon-line" id="crayon-5c0c9abab340a395419436-27"><span class="crayon-h"> </span><span class="crayon-v">m</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340a395419436-28"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'k=%d %.3f%% +/-%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">m</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab340a395419436-29"><span class="crayon-p"># plot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340a395419436-30"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">boxplot</span><span class="crayon-sy">(</span><span class="crayon-v">all_scores</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-o">=</span><span class="crayon-v">names</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab340a395419436-31"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0017 seconds] -->
<p>Running the example prints the mean and standard deviation of the accuracy with k values from 1 to 21.</p>
<p>We can see that a <em>k=7</em> results in the best skill of 62.872%.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab340c022539956" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
k=1 49.534% +/-4.407
k=2 49.489% +/-4.201
k=3 56.599% +/-6.923
k=4 55.660% +/-6.600
k=5 58.562% +/-4.456
k=6 59.991% +/-7.901
k=7 62.872% +/-8.261
k=8 59.538% +/-5.528
k=9 57.633% +/-4.723
k=10 59.074% +/-7.164
k=11 58.097% +/-7.583
k=12 58.097% +/-5.294
k=13 57.179% +/-5.101
k=14 57.644% +/-3.175
k=15 59.572% +/-5.481
k=16 59.038% +/-1.881
k=17 59.027% +/-2.981
k=18 60.490% +/-3.368
k=19 60.014% +/-2.497
k=20 58.562% +/-2.018
k=21 58.131% +/-3.084</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab340c022539956-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340c022539956-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab340c022539956-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340c022539956-4">4</div><div class="crayon-num" data-line="crayon-5c0c9abab340c022539956-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340c022539956-6">6</div><div class="crayon-num" data-line="crayon-5c0c9abab340c022539956-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340c022539956-8">8</div><div class="crayon-num" data-line="crayon-5c0c9abab340c022539956-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340c022539956-10">10</div><div class="crayon-num" data-line="crayon-5c0c9abab340c022539956-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340c022539956-12">12</div><div class="crayon-num" data-line="crayon-5c0c9abab340c022539956-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340c022539956-14">14</div><div class="crayon-num" data-line="crayon-5c0c9abab340c022539956-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340c022539956-16">16</div><div class="crayon-num" data-line="crayon-5c0c9abab340c022539956-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340c022539956-18">18</div><div class="crayon-num" data-line="crayon-5c0c9abab340c022539956-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340c022539956-20">20</div><div class="crayon-num" data-line="crayon-5c0c9abab340c022539956-21">21</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab340c022539956-1">k=1 49.534% +/-4.407</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340c022539956-2">k=2 49.489% +/-4.201</div><div class="crayon-line" id="crayon-5c0c9abab340c022539956-3">k=3 56.599% +/-6.923</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340c022539956-4">k=4 55.660% +/-6.600</div><div class="crayon-line" id="crayon-5c0c9abab340c022539956-5">k=5 58.562% +/-4.456</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340c022539956-6">k=6 59.991% +/-7.901</div><div class="crayon-line" id="crayon-5c0c9abab340c022539956-7">k=7 62.872% +/-8.261</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340c022539956-8">k=8 59.538% +/-5.528</div><div class="crayon-line" id="crayon-5c0c9abab340c022539956-9">k=9 57.633% +/-4.723</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340c022539956-10">k=10 59.074% +/-7.164</div><div class="crayon-line" id="crayon-5c0c9abab340c022539956-11">k=11 58.097% +/-7.583</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340c022539956-12">k=12 58.097% +/-5.294</div><div class="crayon-line" id="crayon-5c0c9abab340c022539956-13">k=13 57.179% +/-5.101</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340c022539956-14">k=14 57.644% +/-3.175</div><div class="crayon-line" id="crayon-5c0c9abab340c022539956-15">k=15 59.572% +/-5.481</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340c022539956-16">k=16 59.038% +/-1.881</div><div class="crayon-line" id="crayon-5c0c9abab340c022539956-17">k=17 59.027% +/-2.981</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340c022539956-18">k=18 60.490% +/-3.368</div><div class="crayon-line" id="crayon-5c0c9abab340c022539956-19">k=19 60.014% +/-2.497</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340c022539956-20">k=20 58.562% +/-2.018</div><div class="crayon-line" id="crayon-5c0c9abab340c022539956-21">k=21 58.131% +/-3.084</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>The box and whisker plots of accuracy scores for <em>k</em> values show that <em>k</em> values around seven, such as five and six, also produce stable and well-performing models on the dataset.</p>
<div class="wp-caption aligncenter" id="attachment_6139" style="width: 1290px"><img alt="Spot-check KNN neighbors on ES1 with last 25 observations" class="size-full wp-image-6139" height="960" sizes="(max-width: 1280px) 100vw, 1280px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Spot-check-KNN-neighbors-on-ES1-with-last-25-observations.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Spot-check-KNN-neighbors-on-ES1-with-last-25-observations.png 1280w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Spot-check-KNN-neighbors-on-ES1-with-last-25-observations-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Spot-check-KNN-neighbors-on-ES1-with-last-25-observations-768x576.png 768w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Spot-check-KNN-neighbors-on-ES1-with-last-25-observations-1024x768.png 1024w" width="1280"/><p class="wp-caption-text">Spot-check KNN neighbors on ES1 with last 25 observations</p></div>
<h3>Evaluate KNN on ES2</h3>
<p>Now that we have some idea of a representation (<em>n=25</em>) and a model (KNN, <em>k=7</em>) that have some skill over a random prediction, we can test the approach on the harder ES2 dataset.</p>
<p>Each model is trained on the combination of dataset 1 and 2, then evaluated on dataset 3. The k-fold cross-validation procedure is not used, so we would expect the scores to be noisy.</p>
<p>The complete spot checking of algorithms for ES2 is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab340e333174970" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# spot check for ES2
from pandas import read_csv
from matplotlib import pyplot
from sklearn.metrics import accuracy_score
from sklearn.linear_model import LogisticRegression
from sklearn.neighbors import KNeighborsClassifier
from sklearn.tree import DecisionTreeClassifier
from sklearn.svm import SVC
from sklearn.ensemble import RandomForestClassifier
from sklearn.ensemble import GradientBoostingClassifier
from sklearn.pipeline import Pipeline
from sklearn.preprocessing import StandardScaler
# load dataset
train = read_csv('es2_train.csv', header=None)
test = read_csv('es2_test.csv', header=None)
# split into inputs and outputs
trainX, trainy = train.values[:, :-1], train.values[:, -1]
testX, testy = test.values[:, :-1], test.values[:, -1]
# create a list of models to evaluate
models, names = list(), list()
# logistic
models.append(LogisticRegression())
names.append('LR')
# knn
models.append(KNeighborsClassifier())
names.append('KNN')
# knn
models.append(KNeighborsClassifier(n_neighbors=7))
names.append('KNN-7')
# cart
models.append(DecisionTreeClassifier())
names.append('CART')
# svm
models.append(SVC())
names.append('SVM')
# random forest
models.append(RandomForestClassifier())
names.append('RF')
# gbm
models.append(GradientBoostingClassifier())
names.append('GBM')
# evaluate models
all_scores = list()
for i in range(len(models)):
	# create a pipeline for the model
	scaler = StandardScaler()
	model = Pipeline(steps=[('s',scaler), ('m',models[i])])
	# fit
	# model = models[i]
	model.fit(trainX, trainy)
	# predict
	yhat = model.predict(testX)
	# evaluate
	score = accuracy_score(testy, yhat) * 100
	all_scores.append(score)
	# summarize
	print('%s %.3f%%' % (names[i], score))
# plot
pyplot.bar(names, all_scores)
pyplot.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-4">4</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-6">6</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-8">8</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-10">10</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-12">12</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-14">14</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-16">16</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-18">18</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-20">20</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-22">22</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-24">24</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-26">26</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-28">28</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-30">30</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-32">32</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-34">34</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-36">36</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-38">38</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-40">40</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-42">42</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-44">44</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-46">46</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-48">48</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-50">50</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-52">52</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-54">54</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-56">56</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-58">58</div><div class="crayon-num" data-line="crayon-5c0c9abab340e333174970-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab340e333174970-60">60</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab340e333174970-1"><span class="crayon-p"># spot check for ES2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-3"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-4"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-e">accuracy_score</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-5"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-e">import </span><span class="crayon-e">LogisticRegression</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-6"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">neighbors </span><span class="crayon-e">import </span><span class="crayon-e">KNeighborsClassifier</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-7"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">tree </span><span class="crayon-e">import </span><span class="crayon-e">DecisionTreeClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-8"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">svm </span><span class="crayon-e">import </span><span class="crayon-e">SVC</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-9"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">RandomForestClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-10"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-e">import </span><span class="crayon-e">GradientBoostingClassifier</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-11"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">pipeline </span><span class="crayon-e">import </span><span class="crayon-e">Pipeline</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-12"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-v">StandardScaler</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-13"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-14"><span class="crayon-v">train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'es2_train.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-v">None</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-15"><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'es2_test.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-v">None</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-16"><span class="crayon-p"># split into inputs and outputs</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-17"><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-18"><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-19"><span class="crayon-p"># create a list of models to evaluate</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-20"><span class="crayon-v">models</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-21"><span class="crayon-p"># logistic</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-22"><span class="crayon-v">models</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e">LogisticRegression</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-23"><span class="crayon-v">names</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-s">'LR'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-24"><span class="crayon-p"># knn</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-25"><span class="crayon-v">models</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e">KNeighborsClassifier</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-26"><span class="crayon-v">names</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-s">'KNN'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-27"><span class="crayon-p"># knn</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-28"><span class="crayon-v">models</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e">KNeighborsClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">n_neighbors</span><span class="crayon-o">=</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-29"><span class="crayon-v">names</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-s">'KNN-7'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-30"><span class="crayon-p"># cart</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-31"><span class="crayon-v">models</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e">DecisionTreeClassifier</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-32"><span class="crayon-v">names</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-s">'CART'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-33"><span class="crayon-p"># svm</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-34"><span class="crayon-v">models</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e">SVC</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-35"><span class="crayon-v">names</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-s">'SVM'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-36"><span class="crayon-p"># random forest</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-37"><span class="crayon-v">models</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e">RandomForestClassifier</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-38"><span class="crayon-v">names</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-s">'RF'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-39"><span class="crayon-p"># gbm</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-40"><span class="crayon-v">models</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e">GradientBoostingClassifier</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-41"><span class="crayon-v">names</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-s">'GBM'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-42"><span class="crayon-p"># evaluate models</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-43"><span class="crayon-v">all_scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-44"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">models</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-45"><span class="crayon-h"> </span><span class="crayon-p"># create a pipeline for the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-46"><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-47"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Pipeline</span><span class="crayon-sy">(</span><span class="crayon-v">steps</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'s'</span><span class="crayon-sy">,</span><span class="crayon-v">scaler</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">'m'</span><span class="crayon-sy">,</span><span class="crayon-v">models</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-48"><span class="crayon-h"> </span><span class="crayon-p"># fit</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-49"><span class="crayon-h"> </span><span class="crayon-p"># model = models[i]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-50"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-51"><span class="crayon-h"> </span><span class="crayon-p"># predict</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-52"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-53"><span class="crayon-h"> </span><span class="crayon-p"># evaluate</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-54"><span class="crayon-h"> </span><span class="crayon-v">score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">accuracy_score</span><span class="crayon-sy">(</span><span class="crayon-v">testy</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">100</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-55"><span class="crayon-h"> </span><span class="crayon-v">all_scores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">score</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-56"><span class="crayon-h"> </span><span class="crayon-p"># summarize</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-57"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'%s %.3f%%'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">names</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">score</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-58"><span class="crayon-p"># plot</span></div><div class="crayon-line" id="crayon-5c0c9abab340e333174970-59"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">bar</span><span class="crayon-sy">(</span><span class="crayon-v">names</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">all_scores</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab340e333174970-60"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0027 seconds] -->
<p>Running the example reports the model accuracy on the ES2 scenario.</p>
<p>We can see that KNN does well and that the KNN with seven neighbors found to perform well on ES1 also performs well on ES2.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9abab3410847930136" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
LR 45.192%
KNN 54.808%
KNN-7 57.692%
CART 53.846%
SVM 51.923%
RF 53.846%
GBM 52.885%</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9abab3410847930136-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab3410847930136-2">2</div><div class="crayon-num" data-line="crayon-5c0c9abab3410847930136-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab3410847930136-4">4</div><div class="crayon-num" data-line="crayon-5c0c9abab3410847930136-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9abab3410847930136-6">6</div><div class="crayon-num" data-line="crayon-5c0c9abab3410847930136-7">7</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9abab3410847930136-1">LR 45.192%</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab3410847930136-2">KNN 54.808%</div><div class="crayon-line" id="crayon-5c0c9abab3410847930136-3">KNN-7 57.692%</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab3410847930136-4">CART 53.846%</div><div class="crayon-line" id="crayon-5c0c9abab3410847930136-5">SVM 51.923%</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9abab3410847930136-6">RF 53.846%</div><div class="crayon-line" id="crayon-5c0c9abab3410847930136-7">GBM 52.885%</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>A bar chart of the accuracy scores helps to make the relative difference in performance between the methods clearer.</p>
<div class="wp-caption aligncenter" id="attachment_6140" style="width: 1290px"><img alt="Bar chart of model accuracy on ES2" class="size-full wp-image-6140" height="960" sizes="(max-width: 1280px) 100vw, 1280px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Bar-chart-of-model-accuracy-on-ES2.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Bar-chart-of-model-accuracy-on-ES2.png 1280w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Bar-chart-of-model-accuracy-on-ES2-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Bar-chart-of-model-accuracy-on-ES2-768x576.png 768w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Bar-chart-of-model-accuracy-on-ES2-1024x768.png 1024w" width="1280"/><p class="wp-caption-text">Bar chart of model accuracy on ES2</p></div>
<p>The chosen representation and model configurations do have skill over a naive prediction with 50% accuracy.</p>
<p>Further tuning may result in models with better skill, and we are a long way from the 95% and 89% accuracy reported in the paper on ES1 and ES2 respectively.</p>
<h3>Extensions</h3>
<p>This section lists some ideas for extending the tutorial that you may wish to explore.</p>
<ul>
<li><strong>Data Preparation</strong>. There is a lot of opportunity to explore further data preparation methods such as normalization, differencing, and power transforms.</li>
<li><strong>Feature Engineering</strong>. Further feature engineering may result in better performing models, such as statistics for both the start, middle, and end of each sequence as well as trend information.</li>
<li><strong>Tuning</strong>. Only the KNN algorithm was given the opportunity for tuning; other models such as gradient boosting may benefit from fine tuning of hyperparameters.</li>
<li><strong>RNNs</strong>. This sequence classification task seems well suited to recurrent neural networks such as LSTMs that support variable length multivariate inputs. Some preliminary testing on this dataset (by myself) showed highly unstable results, but more extensive investigation may give better and even superior results.</li>
</ul>
<p>If you explore any of these extensions, I’d love to know.</p>
<h2>Further Reading</h2>
<p>This section provides more resources on the topic if you are looking to go deeper.</p>
<h3>Papers</h3>
<ul>
<li><a href="https://pdfs.semanticscholar.org/40c2/393e1874c3fd961fdfff02402c24ccf1c3d7.pdf#page=13">Predicting user movements in heterogeneous indoor environments by reservoir computing</a>, 2011.</li>
<li><a href="https://link.springer.com/article/10.1007/s00521-013-1364-4">An experimental characterization of reservoir computing in ambient assisted living applications</a>, 2014.</li>
</ul>
<h3>API</h3>
<ul>
<li><a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_score.html">sklearn.model_selection.cross_val_score API</a></li>
<li><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.lstsq.html">numpy.linalg.lstsq API</a></li>
<li><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.pad.html">numpy.pad API</a></li>
</ul>
<h3>Articles</h3>
<ul>
<li><a href="https://archive.ics.uci.edu/ml/datasets/Indoor+User+Movement+Prediction+from+RSS+data">Indoor User Movement Prediction from RSS data Data Set, UCI Machine Learning Repository</a></li>
<li><a href="http://wnlab.isti.cnr.it/paolo/index.php/dataset/6rooms">Predicting User Movements in Heterogeneous Indoor Environments by Reservoir Computing, Paolo Barsocchi homepage</a>.</li>
<li><a href="https://github.com/Laurae2/Indoor_Prediction">Indoor User Movement Prediction from RSS data Data Set</a>, Laurae [French].</li>
</ul>
<h2>Summary</h2>
<p>In this tutorial, you discovered the indoor movement prediction time series classification problem and how to engineer features and evaluate machine learning algorithms for the problem.</p>
<p>Specifically, you learned:</p>
<ul>
<li>The time series classification problem of predicting the movement between rooms based on sensor strength.</li>
<li>How to investigate the data in order to better understand the problem and how to engineer features from the raw data for predictive modeling.</li>
<li>How to spot check a suite of classification algorithms and tune one algorithm to further lift performance on the problem.</li>
</ul>
<p>Do you have any questions?<br/>
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="awac-wrapper"><div class="awac widget text-52"> <div class="textwidget"><p></p><center><br/>
<div class="woo-sc-hr"></div>
<h2>Develop Deep Learning models for Time Series Today!</h2>
<p><a href="/deep-learning-for-time-series-forecasting/"><img align="left" alt="Deep Learning for Time Series Forecasting" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/Cover-220.png" style="border: 0;"/></a></p>
<h4>Develop Your Own Forecasting models in Minutes</h4>
<p>…with just a few lines of python code</p>
<p>Discover how in my new Ebook:<br/>
<a href="/deep-learning-for-time-series-forecasting/">Deep Learning for Time Series Forecasting</a></p>
<p>It provides <strong>self-study tutorials</strong> on topics like: <em>CNNs</em>, <em>LSTMs</em>,<br/>
<em>Multivariate Forecasting</em>, <em>Multi-Step Forecasting</em> and much more…</p>
<h4>Finally Bring Deep Learning to your Time Series Forecasting Projects</h4>
<p>Skip the Academics. Just Results.</p>
<p><a href="/deep-learning-for-time-series-forecasting/">Click to learn more</a>.<br/>
</p><div class="woo-sc-hr"></div><br/>
</center>
</div>
</div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-6121 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=Indoor+Movement+Time+Series+Classification+with+Machine+Learning+Algorithms&amp;url=https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
</section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/how-to-develop-a-probabilistic-forecasting-model-to-predict-air-pollution-days/" rel="prev"><i class="fa fa-angle-left"></i> How to Develop a Probabilistic Forecasting Model to Predict Air Pollution Days</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/how-to-load-and-explore-a-standard-human-activity-recognition-problem/" rel="next">A Gentle Introduction to a Standard Human Activity Recognition Problem <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">24 Responses to <em>Indoor Movement Time Series Classification with Machine Learning Algorithms</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-448553">
<div class="comment-container" id="li-comment-448553">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2246d6e7bbce46241e09ecbe2bc83b30?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2246d6e7bbce46241e09ecbe2bc83b30?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Remi</span>
<span class="date">September 11, 2018 at 11:09 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-448553" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason.<br/>
Many thanks for this great and helpful tutorial.<br/>
I went through the paper of Davide Bacciu, et al. (2011) “Predicting User Movements in Heterogeneous Indoor Environments by Reservoir Computing”. His approach consisting in Reservoir Computing and LI-ESN seems impressively efficient.<br/>
Do you see any opporunity to implement such approach in Python?<br/>
All the best,<br/>
Remi</p>
<div class="reply">
<a aria-label="Reply to Remi" class="comment-reply-link" href="#comment-448553" onclick='return addComment.moveForm( "comment-448553", "448553", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-448588">
<div class="comment-container" id="li-comment-448588">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 12, 2018 at 8:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-448588" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not at this stage. I’m skeptical of the ability to reproduce the results in most papers.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-448588" onclick='return addComment.moveForm( "comment-448588", "448588", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-448731">
<div class="comment-container" id="li-comment-448731">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/38e4a1d962fcd216ad8e1f94eb9c0b03?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/38e4a1d962fcd216ad8e1f94eb9c0b03?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ali</span>
<span class="date">September 14, 2018 at 5:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-448731" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>Great tutorials on Multivariate Time Series and LSTM; really enjoyed reading them and learned a lot. I am new to the field (still taking online deep learning courses) and have a general question (I better say I need a general suggestion). Suppose I have a multivariate time series data, and I want to build a classifier model (three-class classification with values 0, 1, or 2). What is the best approach to tackle this problem? LSTM or multi-channel CNN? And have you written any other tutorials?</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Ali" class="comment-reply-link" href="#comment-448731" onclick='return addComment.moveForm( "comment-448731", "448731", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-448748">
<div class="comment-container" id="li-comment-448748">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 14, 2018 at 6:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-448748" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I recommend testing a suite of methods in order to discover what works best for your specific dataset.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-448748" onclick='return addComment.moveForm( "comment-448748", "448748", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-449281">
<div class="comment-container" id="li-comment-449281">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4ebfd3add8986f63cb50f9ac7c20a5ed?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4ebfd3add8986f63cb50f9ac7c20a5ed?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">David P Bradway</span>
<span class="date">September 19, 2018 at 5:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-449281" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The links to the dataset do not seem to be working for me. Can anyone verify that the site is still up?</p>
<div class="reply">
<a aria-label="Reply to David P Bradway" class="comment-reply-link" href="#comment-449281" onclick='return addComment.moveForm( "comment-449281", "449281", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-449302">
<div class="comment-container" id="li-comment-449302">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 19, 2018 at 6:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-449302" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The site appears to be down, it does that some times. So sorry!</p>
<p>I have created a mirror of it here:<br/>
<a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/IndoorMovement.zip" rel="nofollow">https://raw.githubusercontent.com/jbrownlee/Datasets/master/IndoorMovement.zip</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-449302" onclick='return addComment.moveForm( "comment-449302", "449302", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-449341">
<div class="comment-container" id="li-comment-449341">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4ebfd3add8986f63cb50f9ac7c20a5ed?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4ebfd3add8986f63cb50f9ac7c20a5ed?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">David P Bradway</span>
<span class="date">September 19, 2018 at 11:51 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-449341" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you! Great work and thanks for sharing.</p>
<div class="reply">
<a aria-label="Reply to David P Bradway" class="comment-reply-link" href="#comment-449341" onclick='return addComment.moveForm( "comment-449341", "449341", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-449369">
<div class="comment-container" id="li-comment-449369">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 20, 2018 at 8:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-449369" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-449369" onclick='return addComment.moveForm( "comment-449369", "449369", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-450974">
<div class="comment-container" id="li-comment-450974">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ce3ef3829c222cea886c35521e99278d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ce3ef3829c222cea886c35521e99278d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Allen Hu</span>
<span class="date">October 8, 2018 at 10:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-450974" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>May I ask, is this a similar topic with Human Activity Recognition?</p>
<p>Best,</p>
<p>Allen</p>
<div class="reply">
<a aria-label="Reply to Allen Hu" class="comment-reply-link" href="#comment-450974" onclick='return addComment.moveForm( "comment-450974", "450974", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-451045">
<div class="comment-container" id="li-comment-451045">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 9, 2018 at 8:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-451045" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not really, HAR is about “what is the person doing based on sensor data”, indoor movement is about “where are people in the building based on sensor data”.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-451045" onclick='return addComment.moveForm( "comment-451045", "451045", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-453591">
<div class="comment-container" id="li-comment-453591">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alessandro</span>
<span class="date">November 4, 2018 at 4:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-453591" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi jason, very nice tutorial!</p>
<p>I don’t get why you use “-row” in vector.append(seq[-row, col]) when you prepare the dataset.</p>
<div class="reply">
<a aria-label="Reply to Alessandro" class="comment-reply-link" href="#comment-453591" onclick='return addComment.moveForm( "comment-453591", "453591", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-453609">
<div class="comment-container" id="li-comment-453609">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 4, 2018 at 6:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-453609" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>We are adding the last “n” observations, working backward from the end of the dataset.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453609" onclick='return addComment.moveForm( "comment-453609", "453609", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-453700">
<div class="comment-container" id="li-comment-453700">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alessandro</span>
<span class="date">November 5, 2018 at 7:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-453700" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ok but you are Reversing the order of the values. Why this choice?</p>
<div class="reply">
<a aria-label="Reply to Alessandro" class="comment-reply-link" href="#comment-453700" onclick='return addComment.moveForm( "comment-453700", "453700", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-453725">
<div class="comment-container" id="li-comment-453725">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 5, 2018 at 2:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-453725" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, the order does not matter for stateless machine learning algorithms – they are all seen as input variables.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453725" onclick='return addComment.moveForm( "comment-453725", "453725", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-453593">
<div class="comment-container" id="li-comment-453593">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex</span>
<span class="date">November 4, 2018 at 4:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-453593" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason , I don’t know why but when I use the function create_dataset I get the output</p>
<p>ES1: (1L, 77L)<br/>
ES2 Train: (1L, 77L)<br/>
ES2 Test: (1L, 77L)</p>
<p>instead of </p>
<p>ES1: (210, 77)<br/>
ES2 Train: (210, 77)<br/>
ES2 Test: (104, 77)</p>
<div class="reply">
<a aria-label="Reply to Alex" class="comment-reply-link" href="#comment-453593" onclick='return addComment.moveForm( "comment-453593", "453593", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-453610">
<div class="comment-container" id="li-comment-453610">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 4, 2018 at 6:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-453610" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Are you able to confirm that you’re using Python 3.5+ and that your libraries are up to date?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453610" onclick='return addComment.moveForm( "comment-453610", "453610", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-453646">
<div class="comment-container" id="li-comment-453646">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex</span>
<span class="date">November 4, 2018 at 7:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-453646" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>yes I tryed both with python 2.7 and 3.6. However the problem was in the conversion to float32 in </p>
<p>transformed = transformed.astype(‘float32′)</p>
<p>i solved by converting the data directly when i cast to a numpy array by doing</p>
<p>transformed = np.array(transformed,dtype=’float32’)</p>
<div class="reply">
<a aria-label="Reply to Alex" class="comment-reply-link" href="#comment-453646" onclick='return addComment.moveForm( "comment-453646", "453646", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-453685">
<div class="comment-container" id="li-comment-453685">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 5, 2018 at 6:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-453685" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice work!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453685" onclick='return addComment.moveForm( "comment-453685", "453685", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-453647">
<div class="comment-container" id="li-comment-453647">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex</span>
<span class="date">November 4, 2018 at 7:18 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-453647" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason<br/>
I got this error when I run cross_val_score() for the ES1 task.</p>
<p>TypeError(‘unbound method new_CreateProcess() must be called with _winapi instance as first argument (got str instance instead)’,)</p>
<div class="reply">
<a aria-label="Reply to Alex" class="comment-reply-link" href="#comment-453647" onclick='return addComment.moveForm( "comment-453647", "453647", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-453686">
<div class="comment-container" id="li-comment-453686">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 5, 2018 at 6:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-453686" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Something odd might be going on with your Python environment.</p>
<p>Are you sure you’re running from the command line and not some notebook or IDE that is introducing new problems?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453686" onclick='return addComment.moveForm( "comment-453686", "453686", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-453699">
<div class="comment-container" id="li-comment-453699">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex</span>
<span class="date">November 5, 2018 at 7:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-453699" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I m running with Visual Studio. The problem was the use of n_jobs=-1</p>
<div class="reply">
<a aria-label="Reply to Alex" class="comment-reply-link" href="#comment-453699" onclick='return addComment.moveForm( "comment-453699", "453699", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-453724">
<div class="comment-container" id="li-comment-453724">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 5, 2018 at 2:25 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-453724" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps try setting n_jobs to 1.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453724" onclick='return addComment.moveForm( "comment-453724", "453724", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-453758">
<div class="comment-container" id="li-comment-453758">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex</span>
<span class="date">November 6, 2018 at 12:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-453758" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason.<br/>
just FYI i obtained the best performance for ES1 with naive gauss</p>
<div class="reply">
<a aria-label="Reply to Alex" class="comment-reply-link" href="#comment-453758" onclick='return addComment.moveForm( "comment-453758", "453758", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-453796">
<div class="comment-container" id="li-comment-453796">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 6, 2018 at 6:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/#comment-453796" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice work!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453796" onclick='return addComment.moveForm( "comment-453796", "453796", "respond", "6121" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/indoor-movement-time-series-classification-with-machine-learning-algorithms/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="6121"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="1ccc4c71e1"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="59"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery!</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Jason Brownlee, PhD
<br/>
I write tutorials to help developers (<i>like you</i>) get results with machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-51"> <div class="textwidget"><p></p><center><br/>
<strong>Deep Learning for Time Series</strong><br/>
Forecast the future with MLPs, CNNs, and LSTMs.
<p><a href="/deep-learning-for-time-series-forecasting/">Click to Get Started Now!</a><br/>
<a href="/deep-learning-for-time-series-forecasting/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/Cover-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch"><img alt="How to Develop a Neural Machine Translation System in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/01/How-to-Develop-a-Neural-Machine-Translation-System-in-Keras-150x150.jpg" title="How to Develop a Neural Machine Translation System from Scratch" width="45"/></a> <a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch">How to Develop a Neural Machine Translation System from Scratch</a>
<span class="meta">January 10, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning"><img alt="Difference Between Classification and Regression in Machine Learning" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/Difference-Between-Classification-and-Regression-in-Machine-Learning-150x150.jpg" title="Difference Between Classification and Regression in Machine Learning" width="45"/></a> <a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning">Difference Between Classification and Regression in Machine Learning</a>
<span class="meta">December 11, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem..."><img alt="So, You are Working on a Machine Learning Problem..." class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/So-You-are-Working-on-a-Machine-Learning-Problem...-150x150.jpg" title="So, You are Working on a Machine Learning Problem..." width="45"/></a> <a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem…">So, You are Working on a Machine Learning Problem…</a>
<span class="meta">April 4, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis"><img alt="Plot of the Multichannel Convolutional Neural Network For Text" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-150x150.png" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis" width="45"/></a> <a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis">How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis</a>
<span class="meta">January 12, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras"><img alt="How to Make Classification and Regression Predictions for Deep Learning Models in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/How-to-Make-Classification-and-Regression-Predictions-for-Deep-Learning-Models-in-Keras-150x150.jpg" title="How to Make Predictions with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras">How to Make Predictions with Keras</a>
<span class="meta">April 9, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)"><img alt="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/11-Classical-Time-Series-Forecasting-Methods-in-Python-Cheat-Sheet-150x150.jpg" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)">11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)</a>
<span class="meta">August 6, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras"><img alt="How to Visualize a Deep Learning Neural Network Model in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/How-to-Visualize-a-Deep-Learning-Neural-Network-Model-in-Keras-150x150.jpg" title="How to Visualize a Deep Learning Neural Network Model in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras">How to Visualize a Deep Learning Neural Network Model in Keras</a>
<span class="meta">December 13, 2017</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> <div class="widget_text widget widget_custom_html" id="custom_html-2"><h3>You might also like…</h3><div class="textwidget custom-html-widget"><ul>
<li><a href="/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Install Python for Machine Learning</a></li>
<li><a href="/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python</a></li>
<li><a href="/tutorial-first-neural-network-python-keras/">Your First Neural Network in Python</a></li>
<li><a href="/how-to-run-your-first-classifier-in-weka/">Your First Classifier in Weka</a></li>
<li><a href="/arima-for-time-series-forecasting-with-python/">Your First Time Series Forecasting Project</a></li>
</ul></div></div></aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/disclaimer/">Disclaimer</a> | 
<a href="/terms-of-service/">Terms</a> | 
<a href="/contact/">Contact</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.8" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.0.5" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.8" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.1" type="text/javascript"></script>
<script type="text/javascript">		var ssb_admin_ajax = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
		var ssb_post_id = 6121 ;
		var ssb_post_url = 'https://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/';
		var ssb_alternate_post_url = 'http://machinelearningmastery.com/indoor-movement-time-series-classification-with-machine-learning-algorithms/';
		jQuery( document ).ready(function(){
		var is_ssb_used = jQuery('.simplesocialbuttons');
		if( is_ssb_used ) {

			var data = {
			'action': 'ssb_fetch_data',
			'postID': ssb_post_id
		};
			jQuery.post(ssb_admin_ajax, data, function(data, textStatus, xhr) {
				var array = JSON.parse(data);

				jQuery.each( array, function( index, value ){

					if( index == 'total' ){
						jQuery('.ssb_'+ index +'_counter').html(value + '<span>Shares</span>');
					}else{
						jQuery('.ssb_'+ index +'_counter').html(value);
					}
				});

			});
		}
		})

		document.addEventListener("DOMContentLoaded", function() {
			var if_ssb_exist = document.getElementsByClassName( "simplesocialbuttons" ).length > 0;
			if (if_ssb_exist) {
				ssbPlugin.fetchFacebookShares();
			}
		});;
		</script></body>
</html>