<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v9.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>How to Use Word Embedding Layers for Deep Learning with Keras</title>
<link href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="How to Use Word Embedding Layers for Deep Learning with Keras" property="og:title"/>
<meta content="Word embeddings provide a dense representation of words and their relative meanings. They are an improvement over sparse representations used in simpler bag of word model representations. Word embeddings can be learned from text data and reused among projects. They can also be learned as part of fitting a neural network on text data. In this …" property="og:description"/>
<meta content="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="https://www.facebook.com/jason.brownlee.39" property="article:author"/>
<meta content="Deep Learning for Natural Language Processing" property="article:section"/>
<meta content="2017-10-03T18:00:43+00:00" property="article:published_time"/>
<meta content="2018-05-30T20:26:09+00:00" property="article:modified_time"/>
<meta content="2018-05-30T20:26:09+00:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/How-to-Use-Word-Embedding-Layers-for-Deep-Learning-with-Keras.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/How-to-Use-Word-Embedding-Layers-for-Deep-Learning-with-Keras.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="427" property="og:image:height"/>
<meta content="How to Use Word Embedding Layers for Deep Learning with Keras" property="og:image:alt"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"https:\/\/machinelearningmastery.com\/#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/feed/" rel="alternate" title="Machine Learning Mastery » How to Use Word Embedding Layers for Deep Learning with Keras Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<style media="all" type="text/css">
.wpautoterms-footer{background-color:#ffffff;text-align:center;}
.wpautoterms-footer a{color:#000000;font-family:Arial, sans-serif;font-size:14px;}
.wpautoterms-footer .separator{color:#cccccc;font-family:Arial, sans-serif;font-size:14px;}</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/auto-terms-of-service-and-privacy-policy/css/wpautoterms.css?ver=4.9.8" id="wpautoterms_css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.0.5" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/css/front.css?ver=2.0.20" id="ssb-front-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/ewd-ufaq-styles.css?ver=4.9.8" id="ewd-ufaq-style-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/rrssb-min.css?ver=4.9.8" id="ewd-ufaq-rrssb-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.8" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=2.0.20" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.8" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.8" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=4346" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fuse-word-embedding-layers-deep-learning-keras%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fuse-word-embedding-layers-deep-learning-keras%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<style media="screen">

        .simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
      margin: ;
    }
         /*inline margin*/
    
  
  
  
  
  
          .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
         margin: ;
     }

          /*margin-digbar*/

  
  
  
  
 
   
   

</style>
<script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#4c89bf; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#4c89bf;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#4c89bf!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#ffffff;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-4346 single-format-standard gecko alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/icon-100x100.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-44"> <div class="textwidget"><p>Want help with deep learning for text? <a href="https://machinelearningmastery.lpages.co/dlfnlp-mini-course/">Take the FREE Mini-Course</a></p>
</div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<input name="post_type" type="hidden" value="post"/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Main Menu</h3><ul class="nav fl" id="main-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503" id="menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Start Here</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501" id="menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506" id="menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508" id="menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (Keras)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511" id="menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509" id="menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6515" id="menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">Deep Learning for NLP</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512" id="menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Understand Algorithms</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507" id="menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms (Python)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6513" id="menu-item-6513"><a href="https://machinelearningmastery.com/category/machine-learning-process/">Machine Learning Process</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516" id="menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517" id="menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522" id="menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6518" id="menu-item-6518"><a href="https://machinelearningmastery.com/category/start-machine-learning/">Getting Started</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510" id="menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519" id="menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistical Methods</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520" id="menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Time Series (introductory)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523" id="menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6514" id="menu-item-6514"><a href="https://machinelearningmastery.com/category/machine-learning-resources/">Resources</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502" id="menu-item-6502"><a href="https://machinelearningmastery.com/products/">Ebooks</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500" id="menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504" id="menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505" id="menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-4346 post type-post status-publish format-standard has-post-thumbnail hentry category-natural-language-processing">
<header>
<h1 class="title entry-title">How to Use Word Embedding Layers for Deep Learning with Keras</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2017-10-04T05:00:43+1100">October 4, 2017</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/natural-language-processing/" title="View all items in Deep Learning for Natural Language Processing">Deep Learning for Natural Language Processing</a></span> </div>
<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-4346 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Use+Word+Embedding+Layers+for+Deep+Learning+with+Keras&amp;url=https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
<p>Word embeddings provide a dense representation of words and their relative meanings.</p>
<p>They are an improvement over sparse representations used in simpler bag of word model representations.</p>
<p>Word embeddings can be learned from text data and reused among projects. They can also be learned as part of fitting a neural network on text data.</p>
<p>In this tutorial, you will discover how to use word embeddings for deep learning in Python with Keras.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>About word embeddings and that Keras supports word embeddings via the Embedding layer.</li>
<li>How to learn a word embedding while fitting a neural network.</li>
<li>How to use a pre-trained word embedding in a neural network.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Feb/2018</strong>: Fixed a bug due to a change in the underlying APIs.</li>
</ul>
<div class="wp-caption aligncenter" id="attachment_4347" style="width: 650px"><img alt="How to Use Word Embedding Layers for Deep Learning with Keras" class="size-full wp-image-4347" height="427" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/How-to-Use-Word-Embedding-Layers-for-Deep-Learning-with-Keras.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/How-to-Use-Word-Embedding-Layers-for-Deep-Learning-with-Keras.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/How-to-Use-Word-Embedding-Layers-for-Deep-Learning-with-Keras-300x200.jpg 300w" width="640"/><p class="wp-caption-text">How to Use Word Embedding Layers for Deep Learning with Keras<br/>Photo by <a href="https://www.flickr.com/photos/davebloggs007/36375879215/">thisguy</a>, some rights reserved.</p></div>
<h2>Tutorial Overview</h2>
<p>This tutorial is divided into 3 parts; they are:</p>
<ol>
<li>Word Embedding</li>
<li>Keras Embedding Layer</li>
<li>Example of Learning an Embedding</li>
<li>Example of Using Pre-Trained GloVe Embedding</li>
</ol>
<p></p><div class="woo-sc-hr"></div>
<center>
<h3>Need help with Deep Learning for Text Data?</h3>
<p>Take my free 7-day email crash course now (with code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.lpages.co/leadbox/144855173f72a2%3A164f8be4f346dc/5655638436741120/" rel="noopener" style="background: #ffce0a; color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.25) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.5) 0px 1px 3px inset, rgba(0, 0, 0, 0.5) 0px 1px 3px;" target="_blank">Start Your FREE Crash-Course Now</a><script data-config="%7B%7D" data-leadbox="144855173f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.lpages.co/leadbox/144855173f72a2%3A164f8be4f346dc/5655638436741120/" src="https://machinelearningmastery.lpages.co/leadbox-1509466860.js" type="text/javascript"></script></p>
</center>
<p></p><div class="woo-sc-hr"></div>
<h2>1. Word Embedding</h2>
<p>A word embedding is a class of approaches for representing words and documents using a dense vector representation.</p>
<p>It is an improvement over more the traditional bag-of-word model encoding schemes where large sparse vectors were used to represent each word or to score each word within a vector to represent an entire vocabulary. These representations were sparse because the vocabularies were vast and a given word or document would be represented by a large vector comprised mostly of zero values.</p>
<p>Instead, in an embedding, words are represented by dense vectors where a vector represents the projection of the word into a continuous vector space.</p>
<p>The position of a word within the vector space is learned from text and is based on the words that surround the word when it is used.</p>
<p>The position of a word in the learned vector space is referred to as its embedding.</p>
<p>Two popular examples of methods of learning word embeddings from text include:</p>
<ul>
<li>Word2Vec.</li>
<li>GloVe.</li>
</ul>
<p>In addition to these carefully designed methods, a word embedding can be learned as part of a deep learning model. This can be a slower approach, but tailors the model to a specific training dataset.</p>
<h2>2. Keras Embedding Layer</h2>
<p>Keras offers an <a href="https://keras.io/layers/embeddings/#embedding">Embedding</a> layer that can be used for neural networks on text data.</p>
<p>It requires that the input data be integer encoded, so that each word is represented by a unique integer. This data preparation step can be performed using the <a href="https://keras.io/preprocessing/text/#tokenizer">Tokenizer API</a> also provided with Keras.</p>
<p>The Embedding layer is initialized with random weights and will learn an embedding for all of the words in the training dataset.</p>
<p>It is a flexible layer that can be used in a variety of ways, such as:</p>
<ul>
<li>It can be used alone to learn a word embedding that can be saved and used in another model later.</li>
<li>It can be used as part of a deep learning model where the embedding is learned along with the model itself.</li>
<li>It can be used to load a pre-trained word embedding model, a type of transfer learning.</li>
</ul>
<p>The Embedding layer is defined as the first hidden layer of a network. It must specify 3 arguments:</p>
<p>It must specify 3 arguments:</p>
<ul>
<li><strong>input_dim</strong>: This is the size of the vocabulary in the text data. For example, if your data is integer encoded to values between 0-10, then the size of the vocabulary would be 11 words.</li>
<li><strong>output_dim</strong>: This is the size of the vector space in which words will be embedded. It defines the size of the output vectors from this layer for each word. For example, it could be 32 or 100 or even larger. Test different values for your problem.</li>
<li><strong>input_length</strong>: This is the length of input sequences, as you would define for any input layer of a Keras model. For example, if all of your input documents are comprised of 1000 words, this would be 1000.</li>
</ul>
<p>For example, below we define an Embedding layer with a vocabulary of 200 (e.g. integer encoded words from 0 to 199, inclusive), a vector space of 32 dimensions in which words will be embedded, and input documents that have 50 words each.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca87ff0f07965541476" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
e = Embedding(200, 32, input_length=50)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca87ff0f07965541476-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca87ff0f07965541476-1"><span class="crayon-v">e</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-cn">200</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-cn">50</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>The Embedding layer has weights that are learned. If you save your model to file, this will include weights for the Embedding layer.</p>
<p>The output of the <em>Embedding</em> layer is a 2D vector with one embedding for each word in the input sequence of words (input document).</p>
<p>If you wish to connect a <em>Dense</em> layer directly to an Embedding layer, you must first flatten the 2D output matrix to a 1D vector using the <em>Flatten</em> layer.</p>
<p>Now, let’s see how we can use an Embedding layer in practice.</p>
<h2>3. Example of Learning an Embedding</h2>
<p>In this section, we will look at how we can learn a word embedding while fitting a neural network on a text classification problem.</p>
<p>We will define a small problem where we have 10 text documents, each with a comment about a piece of work a student submitted. Each text document is classified as positive “1” or negative “0”. This is a simple sentiment analysis problem.</p>
<p>First, we will define the documents and their class labels.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca87ff0f10071029397" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# define documents
docs = ['Well done!',
		'Good work',
		'Great effort',
		'nice work',
		'Excellent!',
		'Weak',
		'Poor effort!',
		'not good',
		'poor work',
		'Could have done better.']
# define class labels
labels = array([1,1,1,1,1,0,0,0,0,0])</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca87ff0f10071029397-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f10071029397-2">2</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f10071029397-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f10071029397-4">4</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f10071029397-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f10071029397-6">6</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f10071029397-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f10071029397-8">8</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f10071029397-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f10071029397-10">10</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f10071029397-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f10071029397-12">12</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f10071029397-13">13</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca87ff0f10071029397-1"><span class="crayon-p"># define documents</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f10071029397-2"><span class="crayon-v">docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'Well done!'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f10071029397-3"><span class="crayon-h"> </span><span class="crayon-s">'Good work'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f10071029397-4"><span class="crayon-h"> </span><span class="crayon-s">'Great effort'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f10071029397-5"><span class="crayon-h"> </span><span class="crayon-s">'nice work'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f10071029397-6"><span class="crayon-h"> </span><span class="crayon-s">'Excellent!'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f10071029397-7"><span class="crayon-h"> </span><span class="crayon-s">'Weak'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f10071029397-8"><span class="crayon-h"> </span><span class="crayon-s">'Poor effort!'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f10071029397-9"><span class="crayon-h"> </span><span class="crayon-s">'not good'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f10071029397-10"><span class="crayon-h"> </span><span class="crayon-s">'poor work'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f10071029397-11"><span class="crayon-h"> </span><span class="crayon-s">'Could have done better.'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f10071029397-12"><span class="crayon-p"># define class labels</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f10071029397-13"><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Next, we can integer encode each document. This means that as input the Embedding layer will have sequences of integers. We could experiment with other more sophisticated bag of word model encoding like counts or TF-IDF.</p>
<p>Keras provides the <a href="https://keras.io/preprocessing/text/#one_hot">one_hot() function</a> that creates a hash of each word as an efficient integer encoding. We will estimate the vocabulary size of 50, which is much larger than needed to reduce the probability of collisions from the hash function.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca87ff0f12567522862" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# integer encode the documents
vocab_size = 50
encoded_docs = [one_hot(d, vocab_size) for d in docs]
print(encoded_docs)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca87ff0f12567522862-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f12567522862-2">2</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f12567522862-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f12567522862-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca87ff0f12567522862-1"><span class="crayon-p"># integer encode the documents</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f12567522862-2"><span class="crayon-v">vocab_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">50</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f12567522862-3"><span class="crayon-v">encoded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">one_hot</span><span class="crayon-sy">(</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab_size</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">docs</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f12567522862-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>The sequences have different lengths and Keras prefers inputs to be vectorized and all inputs to have the same length. We will pad all input sequences to have the length of 4. Again, we can do this with a built in Keras function, in this case the <a href="https://keras.io/preprocessing/sequence/#pad_sequences">pad_sequences() function</a>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca87ff0f14605096013" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# pad documents to a max length of 4 words
max_length = 4
padded_docs = pad_sequences(encoded_docs, maxlen=max_length, padding='post')
print(padded_docs)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca87ff0f14605096013-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f14605096013-2">2</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f14605096013-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f14605096013-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca87ff0f14605096013-1"><span class="crayon-p"># pad documents to a max length of 4 words</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f14605096013-2"><span class="crayon-v">max_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">4</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f14605096013-3"><span class="crayon-v">padded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'post'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f14605096013-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">padded_docs</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>We are now ready to define our <em>Embedding</em> layer as part of our neural network model.</p>
<p>The <em>Embedding</em> has a vocabulary of 50 and an input length of 4. We will choose a small embedding space of 8 dimensions.</p>
<p>The model is a simple binary classification model. Importantly, the output from the <em>Embedding</em> layer will be 4 vectors of 8 dimensions each, one for each word. We flatten this to a one 32-element vector to pass on to the <em>Dense</em> output layer.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca87ff0f15016613353" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# define the model
model = Sequential()
model.add(Embedding(vocab_size, 8, input_length=max_length))
model.add(Flatten())
model.add(Dense(1, activation='sigmoid'))
# compile the model
model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['acc'])
# summarize the model
print(model.summary())</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca87ff0f15016613353-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f15016613353-2">2</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f15016613353-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f15016613353-4">4</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f15016613353-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f15016613353-6">6</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f15016613353-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f15016613353-8">8</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f15016613353-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca87ff0f15016613353-1"><span class="crayon-p"># define the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f15016613353-2"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f15016613353-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f15016613353-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f15016613353-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f15016613353-6"><span class="crayon-p"># compile the model</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f15016613353-7"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'acc'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f15016613353-8"><span class="crayon-p"># summarize the model</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f15016613353-9"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>Finally, we can fit and evaluate the classification model.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca87ff0f17253706192" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# fit the model
model.fit(padded_docs, labels, epochs=50, verbose=0)
# evaluate the model
loss, accuracy = model.evaluate(padded_docs, labels, verbose=0)
print('Accuracy: %f' % (accuracy*100))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca87ff0f17253706192-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f17253706192-2">2</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f17253706192-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f17253706192-4">4</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f17253706192-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca87ff0f17253706192-1"><span class="crayon-p"># fit the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f17253706192-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">padded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f17253706192-3"><span class="crayon-p"># evaluate the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f17253706192-4"><span class="crayon-v">loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">accuracy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">padded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f17253706192-5"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy: %f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">accuracy*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>The complete code listing is provided below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca87ff0f19426925272" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from numpy import array
from keras.preprocessing.text import one_hot
from keras.preprocessing.sequence import pad_sequences
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import Flatten
from keras.layers.embeddings import Embedding
# define documents
docs = ['Well done!',
		'Good work',
		'Great effort',
		'nice work',
		'Excellent!',
		'Weak',
		'Poor effort!',
		'not good',
		'poor work',
		'Could have done better.']
# define class labels
labels = array([1,1,1,1,1,0,0,0,0,0])
# integer encode the documents
vocab_size = 50
encoded_docs = [one_hot(d, vocab_size) for d in docs]
print(encoded_docs)
# pad documents to a max length of 4 words
max_length = 4
padded_docs = pad_sequences(encoded_docs, maxlen=max_length, padding='post')
print(padded_docs)
# define the model
model = Sequential()
model.add(Embedding(vocab_size, 8, input_length=max_length))
model.add(Flatten())
model.add(Dense(1, activation='sigmoid'))
# compile the model
model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['acc'])
# summarize the model
print(model.summary())
# fit the model
model.fit(padded_docs, labels, epochs=50, verbose=0)
# evaluate the model
loss, accuracy = model.evaluate(padded_docs, labels, verbose=0)
print('Accuracy: %f' % (accuracy*100))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca87ff0f19426925272-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f19426925272-2">2</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f19426925272-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f19426925272-4">4</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f19426925272-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f19426925272-6">6</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f19426925272-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f19426925272-8">8</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f19426925272-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f19426925272-10">10</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f19426925272-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f19426925272-12">12</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f19426925272-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f19426925272-14">14</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f19426925272-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f19426925272-16">16</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f19426925272-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f19426925272-18">18</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f19426925272-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f19426925272-20">20</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f19426925272-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f19426925272-22">22</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f19426925272-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f19426925272-24">24</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f19426925272-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f19426925272-26">26</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f19426925272-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f19426925272-28">28</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f19426925272-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f19426925272-30">30</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f19426925272-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f19426925272-32">32</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f19426925272-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f19426925272-34">34</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f19426925272-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f19426925272-36">36</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f19426925272-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f19426925272-38">38</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f19426925272-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f19426925272-40">40</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f19426925272-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f19426925272-42">42</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca87ff0f19426925272-1"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f19426925272-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">text </span><span class="crayon-e">import </span><span class="crayon-e">one_hot</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f19426925272-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">sequence </span><span class="crayon-e">import </span><span class="crayon-e">pad_sequences</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f19426925272-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f19426925272-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f19426925272-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f19426925272-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">embeddings </span><span class="crayon-e">import </span><span class="crayon-v">Embedding</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f19426925272-8"><span class="crayon-p"># define documents</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f19426925272-9"><span class="crayon-v">docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'Well done!'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f19426925272-10"><span class="crayon-h"> </span><span class="crayon-s">'Good work'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f19426925272-11"><span class="crayon-h"> </span><span class="crayon-s">'Great effort'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f19426925272-12"><span class="crayon-h"> </span><span class="crayon-s">'nice work'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f19426925272-13"><span class="crayon-h"> </span><span class="crayon-s">'Excellent!'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f19426925272-14"><span class="crayon-h"> </span><span class="crayon-s">'Weak'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f19426925272-15"><span class="crayon-h"> </span><span class="crayon-s">'Poor effort!'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f19426925272-16"><span class="crayon-h"> </span><span class="crayon-s">'not good'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f19426925272-17"><span class="crayon-h"> </span><span class="crayon-s">'poor work'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f19426925272-18"><span class="crayon-h"> </span><span class="crayon-s">'Could have done better.'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f19426925272-19"><span class="crayon-p"># define class labels</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f19426925272-20"><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f19426925272-21"><span class="crayon-p"># integer encode the documents</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f19426925272-22"><span class="crayon-v">vocab_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">50</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f19426925272-23"><span class="crayon-v">encoded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">one_hot</span><span class="crayon-sy">(</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab_size</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">docs</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f19426925272-24"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f19426925272-25"><span class="crayon-p"># pad documents to a max length of 4 words</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f19426925272-26"><span class="crayon-v">max_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">4</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f19426925272-27"><span class="crayon-v">padded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'post'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f19426925272-28"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">padded_docs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f19426925272-29"><span class="crayon-p"># define the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f19426925272-30"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f19426925272-31"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f19426925272-32"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f19426925272-33"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f19426925272-34"><span class="crayon-p"># compile the model</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f19426925272-35"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'acc'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f19426925272-36"><span class="crayon-p"># summarize the model</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f19426925272-37"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f19426925272-38"><span class="crayon-p"># fit the model</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f19426925272-39"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">padded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f19426925272-40"><span class="crayon-p"># evaluate the model</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f19426925272-41"><span class="crayon-v">loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">accuracy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">padded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f19426925272-42"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy: %f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">accuracy*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0020 seconds] -->
<p>Running the example first prints the integer encoded documents.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca87ff0f1a741916780" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
[[6, 16], [42, 24], [2, 17], [42, 24], [18], [17], [22, 17], [27, 42], [22, 24], [49, 46, 16, 34]]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca87ff0f1a741916780-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca87ff0f1a741916780-1">[[6, 16], [42, 24], [2, 17], [42, 24], [18], [17], [22, 17], [27, 42], [22, 24], [49, 46, 16, 34]]</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Then the padded versions of each document are printed, making them all uniform length.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca87ff0f20047793780" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
[[ 6 16  0  0]
 [42 24  0  0]
 [ 2 17  0  0]
 [42 24  0  0]
 [18  0  0  0]
 [17  0  0  0]
 [22 17  0  0]
 [27 42  0  0]
 [22 24  0  0]
 [49 46 16 34]]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca87ff0f20047793780-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f20047793780-2">2</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f20047793780-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f20047793780-4">4</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f20047793780-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f20047793780-6">6</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f20047793780-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f20047793780-8">8</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f20047793780-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f20047793780-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca87ff0f20047793780-1">[[ 6 16  0  0]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f20047793780-2"> [42 24  0  0]</div><div class="crayon-line" id="crayon-5c0ca87ff0f20047793780-3"> [ 2 17  0  0]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f20047793780-4"> [42 24  0  0]</div><div class="crayon-line" id="crayon-5c0ca87ff0f20047793780-5"> [18  0  0  0]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f20047793780-6"> [17  0  0  0]</div><div class="crayon-line" id="crayon-5c0ca87ff0f20047793780-7"> [22 17  0  0]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f20047793780-8"> [27 42  0  0]</div><div class="crayon-line" id="crayon-5c0ca87ff0f20047793780-9"> [22 24  0  0]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f20047793780-10"> [49 46 16 34]]</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>After the network is defined, a summary of the layers is printed. We can see that as expected, the output of the Embedding layer is a 4×8 matrix and this is squashed to a 32-element vector by the Flatten layer.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca87ff0f22343740867" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
embedding_1 (Embedding)      (None, 4, 8)              400
_________________________________________________________________
flatten_1 (Flatten)          (None, 32)                0
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 33
=================================================================
Total params: 433
Trainable params: 433
Non-trainable params: 0
_________________________________________________________________</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca87ff0f22343740867-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f22343740867-2">2</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f22343740867-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f22343740867-4">4</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f22343740867-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f22343740867-6">6</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f22343740867-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f22343740867-8">8</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f22343740867-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f22343740867-10">10</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f22343740867-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f22343740867-12">12</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f22343740867-13">13</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca87ff0f22343740867-1">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f22343740867-2">Layer (type)                 Output Shape              Param #</div><div class="crayon-line" id="crayon-5c0ca87ff0f22343740867-3">=================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f22343740867-4">embedding_1 (Embedding)      (None, 4, 8)              400</div><div class="crayon-line" id="crayon-5c0ca87ff0f22343740867-5">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f22343740867-6">flatten_1 (Flatten)          (None, 32)                0</div><div class="crayon-line" id="crayon-5c0ca87ff0f22343740867-7">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f22343740867-8">dense_1 (Dense)              (None, 1)                 33</div><div class="crayon-line" id="crayon-5c0ca87ff0f22343740867-9">=================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f22343740867-10">Total params: 433</div><div class="crayon-line" id="crayon-5c0ca87ff0f22343740867-11">Trainable params: 433</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f22343740867-12">Non-trainable params: 0</div><div class="crayon-line" id="crayon-5c0ca87ff0f22343740867-13">_________________________________________________________________</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Finally, the accuracy of the trained model is printed, showing that it learned the training dataset perfectly (which is not surprising).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca87ff0f23668805973" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Accuracy: 100.000000</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca87ff0f23668805973-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca87ff0f23668805973-1">Accuracy: 100.000000</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>You could save the learned weights from the Embedding layer to file for later use in other models.</p>
<p>You could also use this model generally to classify other documents that have the same kind vocabulary seen in the test dataset.</p>
<p>Next, let’s look at loading a pre-trained word embedding in Keras.</p>
<h2>4. Example of Using Pre-Trained GloVe Embedding</h2>
<p>The Keras Embedding layer can also use a word embedding learned elsewhere.</p>
<p>It is common in the field of Natural Language Processing to learn, save, and make freely available word embeddings.</p>
<p>For example, the researchers behind GloVe method provide a suite of pre-trained word embeddings on their website released under a public domain license. See:</p>
<ul>
<li><a href="https://nlp.stanford.edu/projects/glove/">GloVe: Global Vectors for Word Representation</a></li>
</ul>
<p>The smallest package of embeddings is 822Mb, called “<em>glove.6B.zip</em>“. It was trained on a dataset of one billion tokens (words) with a vocabulary of 400 thousand words. There are a few different embedding vector sizes, including 50, 100, 200 and 300 dimensions.</p>
<p>You can download this collection of embeddings and we can seed the Keras <em>Embedding</em> layer with weights from the pre-trained embedding for the words in your training dataset.</p>
<p>This example is inspired by an example in the Keras project: <a href="https://github.com/fchollet/keras/blob/master/examples/pretrained_word_embeddings.py">pretrained_word_embeddings.py</a>.</p>
<p>After downloading and unzipping, you will see a few files, one of which is “<em>glove.6B.100d.txt</em>“, which contains a 100-dimensional version of the embedding.</p>
<p>If you peek inside the file, you will see a token (word) followed by the weights (100 numbers) on each line. For example, below are the first line of the embedding ASCII text file showing the embedding for “<em>the</em>“.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca87ff0f25670110772" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
the -0.038194 -0.24487 0.72812 -0.39961 0.083172 0.043953 -0.39141 0.3344 -0.57545 0.087459 0.28787 -0.06731 0.30906 -0.26384 -0.13231 -0.20757 0.33395 -0.33848 -0.31743 -0.48336 0.1464 -0.37304 0.34577 0.052041 0.44946 -0.46971 0.02628 -0.54155 -0.15518 -0.14107 -0.039722 0.28277 0.14393 0.23464 -0.31021 0.086173 0.20397 0.52624 0.17164 -0.082378 -0.71787 -0.41531 0.20335 -0.12763 0.41367 0.55187 0.57908 -0.33477 -0.36559 -0.54857 -0.062892 0.26584 0.30205 0.99775 -0.80481 -3.0243 0.01254 -0.36942 2.2167 0.72201 -0.24978 0.92136 0.034514 0.46745 1.1079 -0.19358 -0.074575 0.23353 -0.052062 -0.22044 0.057162 -0.15806 -0.30798 -0.41625 0.37972 0.15006 -0.53212 -0.2055 -1.2526 0.071624 0.70565 0.49744 -0.42063 0.26148 -1.538 -0.30223 -0.073438 -0.28312 0.37104 -0.25217 0.016215 -0.017099 -0.38984 0.87424 -0.72569 -0.51058 -0.52028 -0.1459 0.8278 0.27062</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca87ff0f25670110772-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca87ff0f25670110772-1">the -0.038194 -0.24487 0.72812 -0.39961 0.083172 0.043953 -0.39141 0.3344 -0.57545 0.087459 0.28787 -0.06731 0.30906 -0.26384 -0.13231 -0.20757 0.33395 -0.33848 -0.31743 -0.48336 0.1464 -0.37304 0.34577 0.052041 0.44946 -0.46971 0.02628 -0.54155 -0.15518 -0.14107 -0.039722 0.28277 0.14393 0.23464 -0.31021 0.086173 0.20397 0.52624 0.17164 -0.082378 -0.71787 -0.41531 0.20335 -0.12763 0.41367 0.55187 0.57908 -0.33477 -0.36559 -0.54857 -0.062892 0.26584 0.30205 0.99775 -0.80481 -3.0243 0.01254 -0.36942 2.2167 0.72201 -0.24978 0.92136 0.034514 0.46745 1.1079 -0.19358 -0.074575 0.23353 -0.052062 -0.22044 0.057162 -0.15806 -0.30798 -0.41625 0.37972 0.15006 -0.53212 -0.2055 -1.2526 0.071624 0.70565 0.49744 -0.42063 0.26148 -1.538 -0.30223 -0.073438 -0.28312 0.37104 -0.25217 0.016215 -0.017099 -0.38984 0.87424 -0.72569 -0.51058 -0.52028 -0.1459 0.8278 0.27062</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>As in the previous section, the first step is to define the examples, encode them as integers, then pad the sequences to be the same length.</p>
<p>In this case, we need to be able to map words to integers as well as integers to words.</p>
<p>Keras provides a <a href="https://keras.io/preprocessing/text/#tokenizer">Tokenizer</a> class that can be fit on the training data, can convert text to sequences consistently by calling the <em>texts_to_sequences()</em> method on the <em>Tokenizer</em> class, and provides access to the dictionary mapping of words to integers in a <em>word_index</em> attribute.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca87ff0f27541547574" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# define documents
docs = ['Well done!',
		'Good work',
		'Great effort',
		'nice work',
		'Excellent!',
		'Weak',
		'Poor effort!',
		'not good',
		'poor work',
		'Could have done better.']
# define class labels
labels = array([1,1,1,1,1,0,0,0,0,0])
# prepare tokenizer
t = Tokenizer()
t.fit_on_texts(docs)
vocab_size = len(t.word_index) + 1
# integer encode the documents
encoded_docs = t.texts_to_sequences(docs)
print(encoded_docs)
# pad documents to a max length of 4 words
max_length = 4
padded_docs = pad_sequences(encoded_docs, maxlen=max_length, padding='post')
print(padded_docs)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca87ff0f27541547574-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f27541547574-2">2</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f27541547574-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f27541547574-4">4</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f27541547574-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f27541547574-6">6</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f27541547574-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f27541547574-8">8</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f27541547574-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f27541547574-10">10</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f27541547574-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f27541547574-12">12</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f27541547574-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f27541547574-14">14</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f27541547574-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f27541547574-16">16</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f27541547574-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f27541547574-18">18</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f27541547574-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f27541547574-20">20</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f27541547574-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f27541547574-22">22</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f27541547574-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f27541547574-24">24</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca87ff0f27541547574-1"><span class="crayon-p"># define documents</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f27541547574-2"><span class="crayon-v">docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'Well done!'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f27541547574-3"><span class="crayon-h"> </span><span class="crayon-s">'Good work'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f27541547574-4"><span class="crayon-h"> </span><span class="crayon-s">'Great effort'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f27541547574-5"><span class="crayon-h"> </span><span class="crayon-s">'nice work'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f27541547574-6"><span class="crayon-h"> </span><span class="crayon-s">'Excellent!'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f27541547574-7"><span class="crayon-h"> </span><span class="crayon-s">'Weak'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f27541547574-8"><span class="crayon-h"> </span><span class="crayon-s">'Poor effort!'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f27541547574-9"><span class="crayon-h"> </span><span class="crayon-s">'not good'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f27541547574-10"><span class="crayon-h"> </span><span class="crayon-s">'poor work'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f27541547574-11"><span class="crayon-h"> </span><span class="crayon-s">'Could have done better.'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f27541547574-12"><span class="crayon-p"># define class labels</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f27541547574-13"><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f27541547574-14"><span class="crayon-p"># prepare tokenizer</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f27541547574-15"><span class="crayon-v">t</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Tokenizer</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f27541547574-16"><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-e">fit_on_texts</span><span class="crayon-sy">(</span><span class="crayon-v">docs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f27541547574-17"><span class="crayon-v">vocab_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-v">word_index</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f27541547574-18"><span class="crayon-p"># integer encode the documents</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f27541547574-19"><span class="crayon-v">encoded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">docs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f27541547574-20"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f27541547574-21"><span class="crayon-p"># pad documents to a max length of 4 words</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f27541547574-22"><span class="crayon-v">max_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">4</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f27541547574-23"><span class="crayon-v">padded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'post'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f27541547574-24"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">padded_docs</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0010 seconds] -->
<p>Next, we need to load the entire GloVe word embedding file into memory as a dictionary of word to embedding array.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca87ff0f29387791640" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load the whole embedding into memory
embeddings_index = dict()
f = open('glove.6B.100d.txt')
for line in f:
	values = line.split()
	word = values[0]
	coefs = asarray(values[1:], dtype='float32')
	embeddings_index[word] = coefs
f.close()
print('Loaded %s word vectors.' % len(embeddings_index))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca87ff0f29387791640-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f29387791640-2">2</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f29387791640-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f29387791640-4">4</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f29387791640-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f29387791640-6">6</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f29387791640-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f29387791640-8">8</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f29387791640-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f29387791640-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca87ff0f29387791640-1"><span class="crayon-p"># load the whole embedding into memory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f29387791640-2"><span class="crayon-v">embeddings_index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f29387791640-3"><span class="crayon-v">f</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">'glove.6B.100d.txt'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f29387791640-4"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">line </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">f</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f29387791640-5"><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f29387791640-6"><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f29387791640-7"><span class="crayon-h"> </span><span class="crayon-v">coefs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f29387791640-8"><span class="crayon-h"> </span><span class="crayon-v">embeddings_index</span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">coefs</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f29387791640-9"><span class="crayon-v">f</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f29387791640-10"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Loaded %s word vectors.'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">embeddings_index</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>This is pretty slow. It might be better to filter the embedding for the unique words in your training data.</p>
<p>Next, we need to create a matrix of one embedding for each word in the training dataset. We can do that by enumerating all unique words in the <em>Tokenizer.word_index</em> and locating the embedding weight vector from the loaded GloVe embedding.</p>
<p>The result is a matrix of weights only for words we will see during training.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca87ff0f2b403715928" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# create a weight matrix for words in training docs
embedding_matrix = zeros((vocab_size, 100))
for word, i in t.word_index.items():
	embedding_vector = embeddings_index.get(word)
	if embedding_vector is not None:
		embedding_matrix[i] = embedding_vector</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca87ff0f2b403715928-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2b403715928-2">2</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2b403715928-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2b403715928-4">4</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2b403715928-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2b403715928-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca87ff0f2b403715928-1"><span class="crayon-p"># create a weight matrix for words in training docs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2b403715928-2"><span class="crayon-v">embedding_matrix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2b403715928-3"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-v">word_index</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2b403715928-4"><span class="crayon-h"> </span><span class="crayon-v">embedding_vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">embeddings_index</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-t">word</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2b403715928-5"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">embedding_vector </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2b403715928-6"><span class="crayon-h"> </span><span class="crayon-v">embedding_matrix</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">embedding_vector</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Now we can define our model, fit, and evaluate it as before.</p>
<p>The key difference is that the embedding layer can be seeded with the GloVe word embedding weights. We chose the 100-dimensional version, therefore the Embedding layer must be defined with <em>output_dim</em> set to 100. Finally, we do not want to update the learned word weights in this model, therefore we will set the <em>trainable</em> attribute for the model to be <em>False</em>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca87ff0f2d465578342" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
e = Embedding(vocab_size, 100, weights=[embedding_matrix], input_length=4, trainable=False)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca87ff0f2d465578342-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca87ff0f2d465578342-1"><span class="crayon-v">e</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">embedding_matrix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainable</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>The complete worked example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca87ff0f2f245802193" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from numpy import array
from numpy import asarray
from numpy import zeros
from keras.preprocessing.text import Tokenizer
from keras.preprocessing.sequence import pad_sequences
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import Flatten
from keras.layers import Embedding
# define documents
docs = ['Well done!',
		'Good work',
		'Great effort',
		'nice work',
		'Excellent!',
		'Weak',
		'Poor effort!',
		'not good',
		'poor work',
		'Could have done better.']
# define class labels
labels = array([1,1,1,1,1,0,0,0,0,0])
# prepare tokenizer
t = Tokenizer()
t.fit_on_texts(docs)
vocab_size = len(t.word_index) + 1
# integer encode the documents
encoded_docs = t.texts_to_sequences(docs)
print(encoded_docs)
# pad documents to a max length of 4 words
max_length = 4
padded_docs = pad_sequences(encoded_docs, maxlen=max_length, padding='post')
print(padded_docs)
# load the whole embedding into memory
embeddings_index = dict()
f = open('../glove_data/glove.6B/glove.6B.100d.txt')
for line in f:
	values = line.split()
	word = values[0]
	coefs = asarray(values[1:], dtype='float32')
	embeddings_index[word] = coefs
f.close()
print('Loaded %s word vectors.' % len(embeddings_index))
# create a weight matrix for words in training docs
embedding_matrix = zeros((vocab_size, 100))
for word, i in t.word_index.items():
	embedding_vector = embeddings_index.get(word)
	if embedding_vector is not None:
		embedding_matrix[i] = embedding_vector
# define model
model = Sequential()
e = Embedding(vocab_size, 100, weights=[embedding_matrix], input_length=4, trainable=False)
model.add(e)
model.add(Flatten())
model.add(Dense(1, activation='sigmoid'))
# compile the model
model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['acc'])
# summarize the model
print(model.summary())
# fit the model
model.fit(padded_docs, labels, epochs=50, verbose=0)
# evaluate the model
loss, accuracy = model.evaluate(padded_docs, labels, verbose=0)
print('Accuracy: %f' % (accuracy*100))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-2">2</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-4">4</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-6">6</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-8">8</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-10">10</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-12">12</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-14">14</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-16">16</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-18">18</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-20">20</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-22">22</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-24">24</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-26">26</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-28">28</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-30">30</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-32">32</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-34">34</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-36">36</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-38">38</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-40">40</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-42">42</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-44">44</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-46">46</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-48">48</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-50">50</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-52">52</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-54">54</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-56">56</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-58">58</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-60">60</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-62">62</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f2f245802193-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f2f245802193-64">64</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-1"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">asarray</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">zeros</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">text </span><span class="crayon-e">import </span><span class="crayon-e">Tokenizer</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">sequence </span><span class="crayon-e">import </span><span class="crayon-e">pad_sequences</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-v">Embedding</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-10"><span class="crayon-p"># define documents</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-11"><span class="crayon-v">docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'Well done!'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-12"><span class="crayon-h"> </span><span class="crayon-s">'Good work'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-13"><span class="crayon-h"> </span><span class="crayon-s">'Great effort'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-14"><span class="crayon-h"> </span><span class="crayon-s">'nice work'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-15"><span class="crayon-h"> </span><span class="crayon-s">'Excellent!'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-16"><span class="crayon-h"> </span><span class="crayon-s">'Weak'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-17"><span class="crayon-h"> </span><span class="crayon-s">'Poor effort!'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-18"><span class="crayon-h"> </span><span class="crayon-s">'not good'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-19"><span class="crayon-h"> </span><span class="crayon-s">'poor work'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-20"><span class="crayon-h"> </span><span class="crayon-s">'Could have done better.'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-21"><span class="crayon-p"># define class labels</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-22"><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-23"><span class="crayon-p"># prepare tokenizer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-24"><span class="crayon-v">t</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Tokenizer</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-25"><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-e">fit_on_texts</span><span class="crayon-sy">(</span><span class="crayon-v">docs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-26"><span class="crayon-v">vocab_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-v">word_index</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-27"><span class="crayon-p"># integer encode the documents</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-28"><span class="crayon-v">encoded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">docs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-29"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-30"><span class="crayon-p"># pad documents to a max length of 4 words</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-31"><span class="crayon-v">max_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">4</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-32"><span class="crayon-v">padded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'post'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-33"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">padded_docs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-34"><span class="crayon-p"># load the whole embedding into memory</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-35"><span class="crayon-v">embeddings_index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-36"><span class="crayon-v">f</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">'../glove_data/glove.6B/glove.6B.100d.txt'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-37"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">line </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">f</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-38"><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-39"><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-40"><span class="crayon-h"> </span><span class="crayon-v">coefs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-41"><span class="crayon-h"> </span><span class="crayon-v">embeddings_index</span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">coefs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-42"><span class="crayon-v">f</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-43"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Loaded %s word vectors.'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">embeddings_index</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-44"><span class="crayon-p"># create a weight matrix for words in training docs</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-45"><span class="crayon-v">embedding_matrix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-46"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-sy">.</span><span class="crayon-v">word_index</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-47"><span class="crayon-h"> </span><span class="crayon-v">embedding_vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">embeddings_index</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-t">word</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-48"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">embedding_vector </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-49"><span class="crayon-h"> </span><span class="crayon-v">embedding_matrix</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">embedding_vector</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-50"><span class="crayon-p"># define model</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-51"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-52"><span class="crayon-v">e</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">embedding_matrix</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainable</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-53"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-v">e</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-54"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-55"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-56"><span class="crayon-p"># compile the model</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-57"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'acc'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-58"><span class="crayon-p"># summarize the model</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-59"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-60"><span class="crayon-p"># fit the model</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-61"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">padded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-62"><span class="crayon-p"># evaluate the model</span></div><div class="crayon-line" id="crayon-5c0ca87ff0f2f245802193-63"><span class="crayon-v">loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">accuracy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">padded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f2f245802193-64"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy: %f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">accuracy*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0031 seconds] -->
<p>Running the example may take a bit longer, but then demonstrates that it is just as capable of fitting this simple problem.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca87ff0f31414287120" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
[[6, 2], [3, 1], [7, 4], [8, 1], [9], [10], [5, 4], [11, 3], [5, 1], [12, 13, 2, 14]]

[[ 6  2  0  0]
 [ 3  1  0  0]
 [ 7  4  0  0]
 [ 8  1  0  0]
 [ 9  0  0  0]
 [10  0  0  0]
 [ 5  4  0  0]
 [11  3  0  0]
 [ 5  1  0  0]
 [12 13  2 14]]

Loaded 400000 word vectors.

_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
embedding_1 (Embedding)      (None, 4, 100)            1500
_________________________________________________________________
flatten_1 (Flatten)          (None, 400)               0
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 401
=================================================================
Total params: 1,901
Trainable params: 401
Non-trainable params: 1,500
_________________________________________________________________


Accuracy: 100.000000</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca87ff0f31414287120-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f31414287120-2">2</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f31414287120-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f31414287120-4">4</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f31414287120-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f31414287120-6">6</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f31414287120-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f31414287120-8">8</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f31414287120-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f31414287120-10">10</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f31414287120-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f31414287120-12">12</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f31414287120-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f31414287120-14">14</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f31414287120-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f31414287120-16">16</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f31414287120-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f31414287120-18">18</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f31414287120-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f31414287120-20">20</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f31414287120-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f31414287120-22">22</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f31414287120-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f31414287120-24">24</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f31414287120-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f31414287120-26">26</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f31414287120-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f31414287120-28">28</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f31414287120-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca87ff0f31414287120-30">30</div><div class="crayon-num" data-line="crayon-5c0ca87ff0f31414287120-31">31</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca87ff0f31414287120-1">[[6, 2], [3, 1], [7, 4], [8, 1], [9], [10], [5, 4], [11, 3], [5, 1], [12, 13, 2, 14]]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f31414287120-2"> </div><div class="crayon-line" id="crayon-5c0ca87ff0f31414287120-3">[[ 6  2  0  0]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f31414287120-4"> [ 3  1  0  0]</div><div class="crayon-line" id="crayon-5c0ca87ff0f31414287120-5"> [ 7  4  0  0]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f31414287120-6"> [ 8  1  0  0]</div><div class="crayon-line" id="crayon-5c0ca87ff0f31414287120-7"> [ 9  0  0  0]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f31414287120-8"> [10  0  0  0]</div><div class="crayon-line" id="crayon-5c0ca87ff0f31414287120-9"> [ 5  4  0  0]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f31414287120-10"> [11  3  0  0]</div><div class="crayon-line" id="crayon-5c0ca87ff0f31414287120-11"> [ 5  1  0  0]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f31414287120-12"> [12 13  2 14]]</div><div class="crayon-line" id="crayon-5c0ca87ff0f31414287120-13"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f31414287120-14">Loaded 400000 word vectors.</div><div class="crayon-line" id="crayon-5c0ca87ff0f31414287120-15"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f31414287120-16">_________________________________________________________________</div><div class="crayon-line" id="crayon-5c0ca87ff0f31414287120-17">Layer (type)                 Output Shape              Param #</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f31414287120-18">=================================================================</div><div class="crayon-line" id="crayon-5c0ca87ff0f31414287120-19">embedding_1 (Embedding)      (None, 4, 100)            1500</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f31414287120-20">_________________________________________________________________</div><div class="crayon-line" id="crayon-5c0ca87ff0f31414287120-21">flatten_1 (Flatten)          (None, 400)               0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f31414287120-22">_________________________________________________________________</div><div class="crayon-line" id="crayon-5c0ca87ff0f31414287120-23">dense_1 (Dense)              (None, 1)                 401</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f31414287120-24">=================================================================</div><div class="crayon-line" id="crayon-5c0ca87ff0f31414287120-25">Total params: 1,901</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f31414287120-26">Trainable params: 401</div><div class="crayon-line" id="crayon-5c0ca87ff0f31414287120-27">Non-trainable params: 1,500</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f31414287120-28">_________________________________________________________________</div><div class="crayon-line" id="crayon-5c0ca87ff0f31414287120-29"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca87ff0f31414287120-30"> </div><div class="crayon-line" id="crayon-5c0ca87ff0f31414287120-31">Accuracy: 100.000000</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>In practice, I would encourage you to experiment with learning a word embedding using a pre-trained embedding that is fixed and trying to perform learning on top of a pre-trained embedding.</p>
<p>See what works best for your specific problem.</p>
<h2>Further Reading</h2>
<p>This section provides more resources on the topic if you are looking go deeper.</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Word_embedding">Word Embedding on Wikipedia</a></li>
<li><a href="https://keras.io/layers/embeddings/#embedding">Keras Embedding Layer API</a></li>
<li><a href="https://blog.keras.io/using-pre-trained-word-embeddings-in-a-keras-model.html">Using pre-trained word embeddings in a Keras model</a>, 2016</li>
<li><a href="https://github.com/fchollet/keras/blob/master/examples/pretrained_word_embeddings.py">Example of using a pre-trained GloVe Embedding in Keras</a></li>
<li><a href="https://nlp.stanford.edu/projects/glove/">GloVe Embedding</a></li>
<li><a href="http://blog.aylien.com/overview-word-embeddings-history-word2vec-cbow-glove/">An overview of word embeddings and their connection to distributional semantic models</a>, 2016</li>
<li><a href="http://colah.github.io/posts/2014-07-NLP-RNNs-Representations/">Deep Learning, NLP, and Representations</a>, 2014</li>
</ul>
<h2>Summary</h2>
<p>In this tutorial, you discovered how to use word embeddings for deep learning in Python with Keras.</p>
<p>Specifically, you learned:</p>
<ul>
<li>About word embeddings and that Keras supports word embeddings via the Embedding layer.</li>
<li>How to learn a word embedding while fitting a neural network.</li>
<li>How to use a pre-trained word embedding in a neural network.</li>
</ul>
<p>Do you have any questions?<br/>
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="awac-wrapper"><div class="awac widget text-42"> <div class="textwidget"><p></p><center><br/>
<div class="woo-sc-hr"></div>
<h2>Develop Deep Learning models for Text Data Today!</h2>
<p><a href="/deep-learning-for-nlp/"><img align="left" alt="Deep Learning for Natural Language Processing" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/11/DLFNLP-Cover-220.png" style="border: 0;"/></a></p>
<h4>Develop Your Own Text models in Minutes</h4>
<p>…with just a few lines of python code</p>
<p>Discover how in my new Ebook:<br/>
<a href="/deep-learning-for-nlp/">Deep Learning for Natural Language Processing</a></p>
<p>It provides <strong>self-study tutorials</strong> on topics like:<br/>
<em>Bag-of-Words, Word Embedding, Language Models, Caption Generation, Text Translation</em> and much more…</p>
<h4>Finally Bring Deep Learning to your Natural Language Processing Projects</h4>
<p>Skip the Academics. Just Results.</p>
<p><a href="/deep-learning-for-nlp/">Click to learn more</a>.<br/>
</p><div class="woo-sc-hr"></div><br/>
</center>
</div>
</div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-4346 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Use+Word+Embedding+Layers+for+Deep+Learning+with+Keras&amp;url=https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
</section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/prepare-text-data-deep-learning-keras/" rel="prev"><i class="fa fa-angle-left"></i> How to Prepare Text Data for Deep Learning with Keras</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/develop-word-embeddings-python-gensim/" rel="next">How to Develop Word Embeddings in Python with Gensim <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">239 Responses to <em>How to Use Word Embedding Layers for Deep Learning with Keras</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-415535">
<div class="comment-container" id="li-comment-415535">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/039d8252526c3344cd360dcd347be76c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/039d8252526c3344cd360dcd347be76c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mohammad</span>
<span class="date">October 4, 2017 at 7:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415535" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Jason,<br/>
I am excited to read more NLP posts.</p>
<div class="reply">
<a aria-label="Reply to Mohammad" class="comment-reply-link" href="#comment-415535" onclick='return addComment.moveForm( "comment-415535", "415535", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415537">
<div class="comment-container" id="li-comment-415537">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 4, 2017 at 8:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415537" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-415537" onclick='return addComment.moveForm( "comment-415537", "415537", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-415679">
<div class="comment-container" id="li-comment-415679">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0a624f04322a55dfb78ad84152fa3a20?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0a624f04322a55dfb78ad84152fa3a20?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">shiv</span>
<span class="date">October 5, 2017 at 10:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415679" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I split my data into 80-20 test-train and I’m still getting 100% accuracy. Any idea why? It is ~99% on epoch 1 and the rest its 100%.</p>
<div class="reply">
<a aria-label="Reply to shiv" class="comment-reply-link" href="#comment-415679" onclick='return addComment.moveForm( "comment-415679", "415679", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415715">
<div class="comment-container" id="li-comment-415715">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 5, 2017 at 5:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415715" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Consider using the procedure in this post to evaluate your model:<br/>
<a href="https://machinelearningmastery.com/evaluate-skill-deep-learning-models/" rel="nofollow">https://machinelearningmastery.com/evaluate-skill-deep-learning-models/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-415715" onclick='return addComment.moveForm( "comment-415715", "415715", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-415819">
<div class="comment-container" id="li-comment-415819">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d6e53cd310d401852858089d556ce04a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d6e53cd310d401852858089d556ce04a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">trulia</span>
<span class="date">October 6, 2017 at 12:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415819" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Use drop-out 20%, your model is overfit!!</p>
<div class="reply">
<a aria-label="Reply to trulia" class="comment-reply-link" href="#comment-415819" onclick='return addComment.moveForm( "comment-415819", "415819", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-415825">
<div class="comment-container" id="li-comment-415825">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e58ca745207210800e43f915a4cbc85a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e58ca745207210800e43f915a4cbc85a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sandy</span>
<span class="date">October 6, 2017 at 2:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415825" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Jason. I always find things easier when reading your post.<br/>
I have a question about the vector of each word after training. For example, the word “done” in sentence “Well done!” will be represented in different vector from that word in sentence “Could have done better!”. Is that right? I mean the presentation of each word will depend on the context of each sentence?</p>
<div class="reply">
<a aria-label="Reply to Sandy" class="comment-reply-link" href="#comment-415825" onclick='return addComment.moveForm( "comment-415825", "415825", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-415881">
<div class="comment-container" id="li-comment-415881">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 7, 2017 at 5:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415881" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, each word in the dictionary is represented differently, but the same word in different contexts will have the same representation.</p>
<p>It is the word in its different contexts that is used to define the representation of the word.</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-415881" onclick='return addComment.moveForm( "comment-415881", "415881", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-415935">
<div class="comment-container" id="li-comment-415935">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e58ca745207210800e43f915a4cbc85a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e58ca745207210800e43f915a4cbc85a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sandy</span>
<span class="date">October 7, 2017 at 5:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415935" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, thank you. But I still have a question. We will train each context separately, then after training the first context, in this case is “Well done!”, we will have a vector representation of the word “done”. After training the second context, “Could have done better”, we have another vector representation of the word “done”. So, which vector will we choose to be the representation of the word “done”?<br/>
I might misunderstand the procedure of training. Thank you for clarifying it for me.</p>
<div class="reply">
<a aria-label="Reply to Sandy" class="comment-reply-link" href="#comment-415935" onclick='return addComment.moveForm( "comment-415935", "415935", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-415971">
<div class="comment-container" id="li-comment-415971">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 8, 2017 at 8:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415971" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No. All examples where a word is used are used as part of the training of the representation of the word. There is only one representation for each word during and after training.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-415971" onclick='return addComment.moveForm( "comment-415971", "415971", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-416009">
<div class="comment-container" id="li-comment-416009">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e58ca745207210800e43f915a4cbc85a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e58ca745207210800e43f915a4cbc85a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sandy</span>
<span class="date">October 8, 2017 at 2:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-416009" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I got it. Thank you, Jason.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-415934">
<div class="comment-container" id="li-comment-415934">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d2ee8e847f73af202b1d1880edffc276?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d2ee8e847f73af202b1d1880edffc276?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chiedu</span>
<span class="date">October 7, 2017 at 5:36 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415934" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
any ideas on how to “filter the embedding for the unique words in your training data” as mentioned in the tutorial?</p>
<div class="reply">
<a aria-label="Reply to Chiedu" class="comment-reply-link" href="#comment-415934" onclick='return addComment.moveForm( "comment-415934", "415934", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415970">
<div class="comment-container" id="li-comment-415970">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 8, 2017 at 8:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415970" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The mapping of word to vector dictionary is built into Gensim, you can access it directly to retrieve the representations for the words you want: model.wv.vocab</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-415970" onclick='return addComment.moveForm( "comment-415970", "415970", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-436136">
<div class="comment-container" id="li-comment-436136">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/37dc265632c5d360be81988b137f8c18?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/37dc265632c5d360be81988b137f8c18?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">mahna</span>
<span class="date">April 28, 2018 at 2:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-436136" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>HI Jason,<br/>
I am really appreciated the time U spend to write this tutorial and also replying.<br/>
My question is about “model.wv.vocab” you wrote. is it an address site?<br/>
It does not work actually.</p>
<div class="reply">
<a aria-label="Reply to mahna" class="comment-reply-link" href="#comment-436136" onclick='return addComment.moveForm( "comment-436136", "436136", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-436160">
<div class="comment-container" id="li-comment-436160">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 28, 2018 at 5:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-436160" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, it is an attribute on the model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436160" onclick='return addComment.moveForm( "comment-436160", "436160", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-415952">
<div class="comment-container" id="li-comment-415952">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/87393ac8db44b4f93393d51de251374d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/87393ac8db44b4f93393d51de251374d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Abbey</span>
<span class="date">October 8, 2017 at 2:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415952" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason</p>
<p>Good day.</p>
<p>I just need your suggestion and example. I have two different dataset, where one is structured and the other is unstructured.  The goal is to use the structured to construct a representation for the unstructured, so apply use word embedding on the two input data but how can I find the average of the two embedding and flatten it to one before feeding the layer into CNN and LSTM.</p>
<p>Looking forward to your response.<br/>
Regards<br/>
Abbey</p>
<div class="reply">
<a aria-label="Reply to Abbey" class="comment-reply-link" href="#comment-415952" onclick='return addComment.moveForm( "comment-415952", "415952", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415975">
<div class="comment-container" id="li-comment-415975">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 8, 2017 at 8:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-415975" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, what was your question?</p>
<p>If your question was if this is a good approach, my advice is to try it and see.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-415975" onclick='return addComment.moveForm( "comment-415975", "415975", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-416110">
<div class="comment-container" id="li-comment-416110">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/87393ac8db44b4f93393d51de251374d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/87393ac8db44b4f93393d51de251374d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Abiodun Modupe</span>
<span class="date">October 9, 2017 at 7:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-416110" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason<br/>
How can I find the average of the word embedding from the two input?<br/>
Regards<br/>
Abbey</p>
<div class="reply">
<a aria-label="Reply to Abiodun Modupe" class="comment-reply-link" href="#comment-416110" onclick='return addComment.moveForm( "comment-416110", "416110", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-416174">
<div class="comment-container" id="li-comment-416174">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 10, 2017 at 7:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-416174" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps you could retrieve the vectors for each word and take their average?</p>
<p>Perhaps you can use the Gensim API to achieve this result?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-416174" onclick='return addComment.moveForm( "comment-416174", "416174", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-416104">
<div class="comment-container" id="li-comment-416104">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d0950d83c9034d59e31b486bdcaf443a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d0950d83c9034d59e31b486bdcaf443a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vinu</span>
<span class="date">October 9, 2017 at 5:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-416104" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason…Could you also help us with R codes for using Pre-Trained GloVe Embedding</p>
<div class="reply">
<a aria-label="Reply to Vinu" class="comment-reply-link" href="#comment-416104" onclick='return addComment.moveForm( "comment-416104", "416104", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-416173">
<div class="comment-container" id="li-comment-416173">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 10, 2017 at 7:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-416173" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have R code for word embeddings.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-416173" onclick='return addComment.moveForm( "comment-416173", "416173", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-416423">
<div class="comment-container" id="li-comment-416423">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1e08f731cef24b3e368ac1325e46f655?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1e08f731cef24b3e368ac1325e46f655?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hao</span>
<span class="date">October 12, 2017 at 5:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-416423" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, really appreciate that you answered all the replies! I am planning to try both CNN and RNN (maybe LSTM &amp; GRU) on text classification. Most of my documents are less than 100 words long, but about 5 % are longer than 500 words. How do you suggest to set the max length when using RNN?If I set it to be 1000, will it degrade the learning result? Should I just use 100? Will it be different in the case of CNN?<br/>
Thank you!</p>
<div class="reply">
<a aria-label="Reply to Hao" class="comment-reply-link" href="#comment-416423" onclick='return addComment.moveForm( "comment-416423", "416423", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-416480">
<div class="comment-container" id="li-comment-416480">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 13, 2017 at 5:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-416480" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend experimenting with different configurations and see how the impact model skill.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-416480" onclick='return addComment.moveForm( "comment-416480", "416480", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-437064">
<div class="comment-container" id="li-comment-437064">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b547d669b07df1f296903da2752d0adb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b547d669b07df1f296903da2752d0adb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ammara</span>
<span class="date">May 10, 2018 at 2:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-437064" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Hao,<br/>
    Did you try RNN(LSTM or GRU) on text classification?If yes then can you plz provide me the code??</p>
<div class="reply">
<a aria-label="Reply to ammara" class="comment-reply-link" href="#comment-437064" onclick='return addComment.moveForm( "comment-437064", "437064", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-437090">
<div class="comment-container" id="li-comment-437090">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 10, 2018 at 6:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-437090" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Here is an example:<br/>
<a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" rel="nofollow">https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437090" onclick='return addComment.moveForm( "comment-437090", "437090", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-416516">
<div class="comment-container" id="li-comment-416516">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/09626c924d61713b6422f4ccb87286e2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/09626c924d61713b6422f4ccb87286e2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Michael</span>
<span class="date">October 13, 2017 at 10:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-416516" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’d like to thank you for this post. I’ve been struggling to understand this precise way of using keras for a week now and this is the only post I’ve found that actually explains what each step in the process is doing – and provides code that self-documents what the data looks like as the model is constructed and trained. This makes it so much easier to adapt to my particular requirements.</p>
<div class="reply">
<a aria-label="Reply to Michael" class="comment-reply-link" href="#comment-416516" onclick='return addComment.moveForm( "comment-416516", "416516", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-416531">
<div class="comment-container" id="li-comment-416531">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 13, 2017 at 2:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-416531" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, I’m glad it helped.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-416531" onclick='return addComment.moveForm( "comment-416531", "416531", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-417023">
<div class="comment-container" id="li-comment-417023">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/126ecbb70db4b332f2ffe5f4f82bfeac?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/126ecbb70db4b332f2ffe5f4f82bfeac?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Azim</span>
<span class="date">October 17, 2017 at 5:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-417023" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In the above Keras example, how can we predict a list of context words given a word? Lets say i have a word named ‘sudoku’ and want to predict the sourrounding words. how can we use word2vec from keras to do that?</p>
<div class="reply">
<a aria-label="Reply to Azim" class="comment-reply-link" href="#comment-417023" onclick='return addComment.moveForm( "comment-417023", "417023", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417055">
<div class="comment-container" id="li-comment-417055">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 18, 2017 at 5:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-417055" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It sounds like you are describing a language model. We can use LSTMs to learn these relationships.</p>
<p>Here is an example:<br/>
<a href="https://machinelearningmastery.com/text-generation-lstm-recurrent-neural-networks-python-keras/" rel="nofollow">https://machinelearningmastery.com/text-generation-lstm-recurrent-neural-networks-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-417055" onclick='return addComment.moveForm( "comment-417055", "417055", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-417429">
<div class="comment-container" id="li-comment-417429">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/126ecbb70db4b332f2ffe5f4f82bfeac?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/126ecbb70db4b332f2ffe5f4f82bfeac?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Azim</span>
<span class="date">October 21, 2017 at 9:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-417429" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, what i meant was for word2vec skip-gram model predicts a context word given the center word. So if i train a word2vec skip-gram model, how can i predict the list of context words if my center word is ‘sudoku’?</p>
<p>Regards,</p>
<p>Azim</p>
<div class="reply">
<a aria-label="Reply to Azim" class="comment-reply-link" href="#comment-417429" onclick='return addComment.moveForm( "comment-417429", "417429", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-417475">
<div class="comment-container" id="li-comment-417475">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 22, 2017 at 5:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-417475" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t know Azim.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-417475" onclick='return addComment.moveForm( "comment-417475", "417475", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-4" id="comment-455009">
<div class="comment-container" id="li-comment-455009">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0828ac78665461fb867fba5b60d3bdac?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0828ac78665461fb867fba5b60d3bdac?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kevin Toms</span>
<span class="date">November 16, 2018 at 7:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-455009" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can get the cosine distance between the words, and the one that is having the least distance would surround it.. here is the link:<br/>
<a href="https://github.com/Hvass-Labs/TensorFlow-Tutorials" rel="nofollow">https://github.com/Hvass-Labs/TensorFlow-Tutorials</a> </p>
<p>Go to Natural Language Processing and you can find a cosine function there, use them to find yours..</p>
<div class="reply">
<a aria-label="Reply to Kevin Toms" class="comment-reply-link" href="#comment-455009" onclick='return addComment.moveForm( "comment-455009", "455009", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-417408">
<div class="comment-container" id="li-comment-417408">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/33678441574c2601ae06506edc85ec8f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/33678441574c2601ae06506edc85ec8f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Willie</span>
<span class="date">October 21, 2017 at 5:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-417408" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for your useful blog I have learned a lots.</p>
<p>I am wondering if I already have pretrained word embedding, is that possible to set keras embedding layer trainable to be true? If it is workable, will I get a better result, when I only use small size of data to pretrain the word embedding model. Many thanks!</p>
<div class="reply">
<a aria-label="Reply to Willie" class="comment-reply-link" href="#comment-417408" onclick='return addComment.moveForm( "comment-417408", "417408", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-417471">
<div class="comment-container" id="li-comment-417471">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 22, 2017 at 5:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-417471" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can. It is hard to know whether it will give better results. Try it.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-417471" onclick='return addComment.moveForm( "comment-417471", "417471", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-418179">
<div class="comment-container" id="li-comment-418179">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f685391ab3f38f9cdd38036280aed136?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f685391ab3f38f9cdd38036280aed136?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">cam</span>
<span class="date">October 28, 2017 at 5:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-418179" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,</p>
<p>Is it possible to perform probability calculations on the label? I am looking at a case where it is not simply +/- but that a given data entry could be both but more likely one and not the other.</p>
<div class="reply">
<a aria-label="Reply to cam" class="comment-reply-link" href="#comment-418179" onclick='return addComment.moveForm( "comment-418179", "418179", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-418280">
<div class="comment-container" id="li-comment-418280">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 29, 2017 at 5:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-418280" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, a neural network with a sigmoid or softmax output can predict a probability-like score for each class.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-418280" onclick='return addComment.moveForm( "comment-418280", "418280", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-418852">
<div class="comment-container" id="li-comment-418852">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/905f07649c7cf267b83ab7b8788e052b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/905f07649c7cf267b83ab7b8788e052b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://ait.nyc" rel="external nofollow">David Stancu</a></span>
<span class="date">November 3, 2017 at 6:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-418852" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m doing something like this except with my own feature vectors — but to the point of the labels — I do ternary classification using categorical_crossentropy and a softmax output. I get back an answer of the probability of each label.</p>
<div class="reply">
<a aria-label="Reply to David Stancu" class="comment-reply-link" href="#comment-418852" onclick='return addComment.moveForm( "comment-418852", "418852", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-418877">
<div class="comment-container" id="li-comment-418877">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 3, 2017 at 2:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-418877" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-418877" onclick='return addComment.moveForm( "comment-418877", "418877", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-418850">
<div class="comment-container" id="li-comment-418850">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/181122206967395d411a88f1a25019b4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/181122206967395d411a88f1a25019b4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ravil</span>
<span class="date">November 3, 2017 at 5:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-418850" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason!</p>
<p>Thanks for a wonderful and detailed explanation of the post. It helped me a lot.</p>
<p>However, I’m struggling to understand how the model predicts a sentence as positive or negative.<br/>
i understand that each word in the document is converted into a word embedding, so how does our model evaluate the entire sentence as positive or negative? Does it take the sum of all the word vectors? Perhaps average of them?  I’ve not been able to figure this part out.</p>
<div class="reply">
<a aria-label="Reply to Ravil" class="comment-reply-link" href="#comment-418850" onclick='return addComment.moveForm( "comment-418850", "418850", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-418875">
<div class="comment-container" id="li-comment-418875">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 3, 2017 at 2:13 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-418875" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question!</p>
<p>The model interprets all of the words in the sequence and learns to associate specific patterns (of encoded words) with positive or negative sentiment</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-418875" onclick='return addComment.moveForm( "comment-418875", "418875", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-433890">
<div class="comment-container" id="li-comment-433890">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7bcd32ab03cd7a271451898498094f9b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7bcd32ab03cd7a271451898498094f9b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ken</span>
<span class="date">April 2, 2018 at 8:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-433890" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks a lot for your amazing posts. I have the same question as Ravil. Can you elaborate a bit more on “learns to associate specific patterns?”</p>
<div class="reply">
<a aria-label="Reply to Ken" class="comment-reply-link" href="#comment-433890" onclick='return addComment.moveForm( "comment-433890", "433890", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-433906">
<div class="comment-container" id="li-comment-433906">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 2, 2018 at 2:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-433906" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good question Ken, perhaps this post will make it clearer how ml algorithms work (a functional mapping):<br/>
<a href="http://machinelearningmastery.com/how-machine-learning-algorithms-work/" rel="nofollow">http://machinelearningmastery.com/how-machine-learning-algorithms-work/</a></p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-433906" onclick='return addComment.moveForm( "comment-433906", "433906", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-433930">
<div class="comment-container" id="li-comment-433930">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7bcd32ab03cd7a271451898498094f9b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7bcd32ab03cd7a271451898498094f9b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ken</span>
<span class="date">April 2, 2018 at 10:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-433930" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for your reply. But I was trying to ask is that how does keras manage to produce a document level representation by having the vectors of each word? I don’t seem to find how was this being done in the code. </p>
<p>Cheers.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-433962">
<div class="comment-container" id="li-comment-433962">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 3, 2018 at 6:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-433962" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The model such as the LSTM or CNN will put this together.</p>
<p>In the case of LSTMs, you can learn more here:<br/>
<a href="https://machinelearningmastery.com/start-here/#lstm" rel="nofollow">https://machinelearningmastery.com/start-here/#lstm</a></p>
<p>Does that help?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-5" id="comment-449875">
<div class="comment-container" id="li-comment-449875">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f65ae86c1c0869b2e1e2691cc17aadd9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f65ae86c1c0869b2e1e2691cc17aadd9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alexi</span>
<span class="date">September 27, 2018 at 1:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-449875" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>First, thanks for all your really useful posts.</p>
<p>If I understand well your post and answers to Ken and Ravil, the neural network you build in fact reduces the sequence of embedding vectors corresponding to all the words of a document to a one-dimensional vector with the Flatten layer, and you just train this flattening, as well as the embedding, to get the best classification on your training set, isn’t it?</p>
<p>Thank you in advance for your answer.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-449896">
<div class="comment-container" id="li-comment-449896">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 27, 2018 at 6:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-449896" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sort of.</p>
<p>words =&gt; integers =&gt; embedding</p>
<p>The embedding has a vector per word which the network will use as a representation for the word. </p>
<p>We have a sequence of vectors for the words, so we flatten this sequence to one long vector for the Dense model to read. Alternately, we could wrap the dense in a timedistributed layer.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-5" id="comment-449946">
<div class="comment-container" id="li-comment-449946">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f65ae86c1c0869b2e1e2691cc17aadd9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f65ae86c1c0869b2e1e2691cc17aadd9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alexi</span>
<span class="date">September 27, 2018 at 5:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-449946" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Aaah! So nothing tricky is done when flattening, more or less just concatenating the fixed number of embedding vectors that is the output of the embedding layer, and this is why the number of words per document has to be fixed as a setting of this layer. If this is correct, I think I’m finally understanding how all this works. </p>
<p>I’m sorry to bother you more, but how does the network works if a document much shorter than the longest document (the number of its words being set as the number of words per document to the embedding layer) is given to the network as training or testing? It just fills the embedding vectors of this non-appearing words as 0? I’ve been looking for ways to convert all the word embeddings of a text to some sort of document embedding, and this just seems a solution too simple to work, or that may work but for short documents (as well as other options like averaging the word vectors or taking the element-wise maximum of minimum).</p>
<p>I’m trying to do sentiment analysis for spanish news, and I have news with like 1000 or more words, and wanted to use pre-trained word embeddings of 300 dimensions each. Wouldn’t it be a size way too huge per document for the network to train properly, or fast enough? I imagine you do not have a precise answer, but I’d like to know if you have tried the above method with long documents, or know that someone has. </p>
<p>Thank you again, I’m sorry for such a long question.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-449989">
<div class="comment-container" id="li-comment-449989">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 28, 2018 at 6:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-449989" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes.</p>
<p>We can use padding for small documents and a Masking input layer to ignore padded values. More here:<br/>
<a href="https://machinelearningmastery.com/handle-missing-timesteps-sequence-prediction-problems-python/" rel="nofollow">https://machinelearningmastery.com/handle-missing-timesteps-sequence-prediction-problems-python/</a></p>
<p>Try different sized embeddings and use results to guide the configuration.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-5" id="comment-450409">
<div class="comment-container" id="li-comment-450409">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f65ae86c1c0869b2e1e2691cc17aadd9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f65ae86c1c0869b2e1e2691cc17aadd9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alexi</span>
<span class="date">October 1, 2018 at 5:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-450409" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Okay, thank you very much! I will give it a try.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-419457">
<div class="comment-container" id="li-comment-419457">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b01ebad197d596e925b43dc4116d8f72?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b01ebad197d596e925b43dc4116d8f72?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">chengcheng</span>
<span class="date">November 9, 2017 at 2:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-419457" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>the chinese word how to vector sequence</p>
<div class="reply">
<a aria-label="Reply to chengcheng" class="comment-reply-link" href="#comment-419457" onclick='return addComment.moveForm( "comment-419457", "419457", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-419497">
<div class="comment-container" id="li-comment-419497">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 9, 2017 at 10:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-419497" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-419497" onclick='return addComment.moveForm( "comment-419497", "419497", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-423494">
<div class="comment-container" id="li-comment-423494">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/107d08aa220d5c73bfab33ce1be1857b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/107d08aa220d5c73bfab33ce1be1857b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">lstmbot</span>
<span class="date">December 16, 2017 at 10:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-423494" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>me bot trying interact comments born with lstm</p>
<div class="reply">
<a aria-label="Reply to lstmbot" class="comment-reply-link" href="#comment-423494" onclick='return addComment.moveForm( "comment-423494", "423494", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-420209">
<div class="comment-container" id="li-comment-420209">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6ee5b9be3dbc5ad785e8dcbf7d38aee8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6ee5b9be3dbc5ad785e8dcbf7d38aee8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hilmi Jauffer</span>
<span class="date">November 16, 2017 at 4:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-420209" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I have successfully trained a model using the word embedding and Keras. The accuracy was at 100%. </p>
<p>I saved the trained model and the word tokens for predictions.<br/>
MODEL.save(‘model.h5’, True)</p>
<p>TOKENIZER = Tokenizer(num_words=MAX_NB_WORDS)<br/>
TOKENIZER.fit_on_texts(TEXT_SAMPLES)<br/>
pickle.dump(TOKENIZER, open(‘tokens’, ‘wb’))</p>
<p>When predicting:<br/>
 – Load the saved model.<br/>
 – Setup the tokenizer, by loading the saved word tokens.<br/>
 – Then predict the category of the new data.</p>
<p>I am not sure the prediction logic is correct, since I am not seeing the expected category from the prediction.</p>
<p>The source code is in Github: <a href="https://github.com/hilmij/keras-test/blob/master/predict.py" rel="nofollow">https://github.com/hilmij/keras-test/blob/master/predict.py</a></p>
<p>Appreciate if you can have a look and let me know what I am missing.</p>
<p>Best regards,<br/>
Hilmi.</p>
<div class="reply">
<a aria-label="Reply to Hilmi Jauffer" class="comment-reply-link" href="#comment-420209" onclick='return addComment.moveForm( "comment-420209", "420209", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-420281">
<div class="comment-container" id="li-comment-420281">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 17, 2017 at 9:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-420281" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Your process sounds correct. I cannot review your code sorry.</p>
<p>What was the problem exactly?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-420281" onclick='return addComment.moveForm( "comment-420281", "420281", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-443191">
<div class="comment-container" id="li-comment-443191">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/52d8a8b7b2b3f10c51a6c66694b624e7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/52d8a8b7b2b3f10c51a6c66694b624e7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tony</span>
<span class="date">July 11, 2018 at 8:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-443191" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you, Jason! Your examples are very helpful. I hope to get your attention with my question. At training, you prepare the tokenizer by doing:</p>
<p>t = text.Tokenizer();<br/>
t.fit_on_texts(docs) </p>
<p>Which creates a dictionary of words:numbers. What do we do if we have a new doc with lost of new words at prediction time? Will all these words go the unknown token? If so, is there a solution for this, like can we fit the tokenizer on all the words in the English vocab?</p>
<div class="reply">
<a aria-label="Reply to Tony" class="comment-reply-link" href="#comment-443191" onclick='return addComment.moveForm( "comment-443191", "443191", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-443211">
<div class="comment-container" id="li-comment-443211">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 11, 2018 at 2:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-443211" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You must know the words you want to support at training time. Even if you have to guess.</p>
<p>To support new words, you will need a new model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443211" onclick='return addComment.moveForm( "comment-443211", "443211", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-420276">
<div class="comment-container" id="li-comment-420276">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c560b2c066be1516e0b06a1a1c086dc7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c560b2c066be1516e0b06a1a1c086dc7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://Brazil" rel="external nofollow">Fabrício Melo</a></span>
<span class="date">November 17, 2017 at 7:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-420276" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason!</p>
<p>In Example of Using Pre-Trained GloVe Embedding, do you use the word embedding vectors as weights of the embedding layer?</p>
<div class="reply">
<a aria-label="Reply to Fabrício Melo" class="comment-reply-link" href="#comment-420276" onclick='return addComment.moveForm( "comment-420276", "420276", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-420298">
<div class="comment-container" id="li-comment-420298">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 17, 2017 at 9:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-420298" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-420298" onclick='return addComment.moveForm( "comment-420298", "420298", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-420761">
<div class="comment-container" id="li-comment-420761">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/97a84c9ca9568092fff5281644ecc4b6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/97a84c9ca9568092fff5281644ecc4b6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex</span>
<span class="date">November 21, 2017 at 11:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-420761" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Very nice set of Blogs of NLP and Keras – thanks for writing them.</p>
<p>As a quick note for others</p>
<p>When I tried to load the glove file with the line:<br/>
f = open(‘../glove_data/glove.6B/glove.6B.100d.txt’)</p>
<p>I got the error<br/>
UnicodeDecodeError: ‘charmap’ codec can’t decode byte 0x9d in position 2776: character maps to </p>
<p>To fix I added:<br/>
f = open(‘../glove_data/glove.6B/glove.6B.100d.txt’,encoding=”utf8″)</p>
<p>This issue may have been caused by using Windows.</p>
<div class="reply">
<a aria-label="Reply to Alex" class="comment-reply-link" href="#comment-420761" onclick='return addComment.moveForm( "comment-420761", "420761", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-420819">
<div class="comment-container" id="li-comment-420819">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 22, 2017 at 11:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-420819" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the tip Alex.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-420819" onclick='return addComment.moveForm( "comment-420819", "420819", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-421219">
<div class="comment-container" id="li-comment-421219">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/44fb04d97bd89b23a7ac691c99fd75ec?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/44fb04d97bd89b23a7ac691c99fd75ec?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Liliana</span>
<span class="date">November 26, 2017 at 12:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-421219" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Wonderful tutorials!</p>
<p>I have a question.  Why do we have to one-hot vectorize the labels? Also, if I have a pad sequence of ex. [2,4,0] what the one hot will be? I’m trying to understand better one hot vectorzer. </p>
<p>I appreciate your response!</p>
<div class="reply">
<a aria-label="Reply to Liliana" class="comment-reply-link" href="#comment-421219" onclick='return addComment.moveForm( "comment-421219", "421219", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-421282">
<div class="comment-container" id="li-comment-421282">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 27, 2017 at 5:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-421282" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>We don’t one hot encode the labels, we one hot encode the words.</p>
<p>Perhaps this post will help you better understand one hot encoding:<br/>
<a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/" rel="nofollow">https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-421282" onclick='return addComment.moveForm( "comment-421282", "421282", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-421381">
<div class="comment-container" id="li-comment-421381">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/02f4b7952cea65f2a642794295e7f079?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/02f4b7952cea65f2a642794295e7f079?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Wassim</span>
<span class="date">November 28, 2017 at 1:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-421381" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thank you for your excellent tutorial. Do you know if there is a way to build a network for a classification using both text embedded data and categorical data ?<br/>
Thank you</p>
<div class="reply">
<a aria-label="Reply to Wassim" class="comment-reply-link" href="#comment-421381" onclick='return addComment.moveForm( "comment-421381", "421381", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-421425">
<div class="comment-container" id="li-comment-421425">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 28, 2017 at 8:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-421425" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure, you could have a network with two inputs:<br/>
<a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/" rel="nofollow">https://machinelearningmastery.com/keras-functional-api-deep-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-421425" onclick='return addComment.moveForm( "comment-421425", "421425", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-421497">
<div class="comment-container" id="li-comment-421497">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/02f4b7952cea65f2a642794295e7f079?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/02f4b7952cea65f2a642794295e7f079?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Wassim</span>
<span class="date">November 28, 2017 at 10:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-421497" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Jason</p>
<div class="reply">
<a aria-label="Reply to Wassim" class="comment-reply-link" href="#comment-421497" onclick='return addComment.moveForm( "comment-421497", "421497", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-421955">
<div class="comment-container" id="li-comment-421955">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/676ee322ca9169a53ff21c96a9da10ea?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/676ee322ca9169a53ff21c96a9da10ea?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ashish</span>
<span class="date">December 2, 2017 at 8:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-421955" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How to do sentence classification using CNN in keras ? please help</p>
<div class="reply">
<a aria-label="Reply to ashish" class="comment-reply-link" href="#comment-421955" onclick='return addComment.moveForm( "comment-421955", "421955", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-421992">
<div class="comment-container" id="li-comment-421992">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 3, 2017 at 5:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-421992" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>See this tutorial:<br/>
<a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/" rel="nofollow">https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-421992" onclick='return addComment.moveForm( "comment-421992", "421992", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-422306">
<div class="comment-container" id="li-comment-422306">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b4f7c3962f7f48d0dd4659e18c317b8a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b4f7c3962f7f48d0dd4659e18c317b8a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Stuart</span>
<span class="date">December 7, 2017 at 12:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-422306" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Fantastic explanation, thanks so much. I’m just amazed at how much easier this has become since the last time I looked at it.</p>
<div class="reply">
<a aria-label="Reply to Stuart" class="comment-reply-link" href="#comment-422306" onclick='return addComment.moveForm( "comment-422306", "422306", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-422353">
<div class="comment-container" id="li-comment-422353">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 7, 2017 at 7:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-422353" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad the post helped Stuart!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-422353" onclick='return addComment.moveForm( "comment-422353", "422353", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-422756">
<div class="comment-container" id="li-comment-422756">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4fd4729ede523084c4988f110082a1e9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4fd4729ede523084c4988f110082a1e9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Stuart</span>
<span class="date">December 11, 2017 at 3:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-422756" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason …the 14 word vocab from your docs is “well done good work great effort nice excellent weak poor not could have better” For a vocab_size of 14, this one_shot encodes to [13  8  7  6  10 13  3  6 10  4  9  2 10 12]. Why does 10 appear 3 times, for “great”, “weak” and “have”?</p>
<div class="reply">
<a aria-label="Reply to Stuart" class="comment-reply-link" href="#comment-422756" onclick='return addComment.moveForm( "comment-422756", "422756", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-422771">
<div class="comment-container" id="li-comment-422771">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 11, 2017 at 4:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-422771" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t follow Stuart. Could you please restate the question?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-422771" onclick='return addComment.moveForm( "comment-422771", "422771", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-422788">
<div class="comment-container" id="li-comment-422788">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4fd4729ede523084c4988f110082a1e9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4fd4729ede523084c4988f110082a1e9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Stuart</span>
<span class="date">December 11, 2017 at 9:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-422788" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, the encodings that I provided in the example above came from kerasR with a vocab_size of 14. So let me ask the same question about the uniqueness of encodings using your Part 3 one_hot example above with a vocab_size of 50.<br/>
Here different encodings are produced for different new kernels (using Spyder3/Python 3.4):<br/>
[[31, 33], [27, 33], [48, 41], [34, 33], [32], [5], [14, 41], [43, 27], [14, 33], [22, 26, 33, 26]]<br/>
[[6, 21], [48, 44], [7, 26], [46, 44], [45], [45], [10, 26], [45, 48], [10, 44], [47, 3, 21, 27]]<br/>
[[7, 8], [16, 42], [24, 13], [45, 42], [23], [17], [34, 13], [13, 16], [34, 42], [17, 31, 8, 19]]</p>
<p>Pleas note that in the first line, “33” encodes for the words “done”, “work”, “work”, “work” &amp; “done”. In the second line “45” encodes for the words “excellent” &amp; “weak” &amp; “not”. In the third line, “13” encodes “effort”, “effort” &amp; “not”.</p>
<p>So I’m wondering why the encodings are not unique? Secondly, if vocab_size must be much larger then the actual size of the vocabulary?</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Stuart" class="comment-reply-link" href="#comment-422788" onclick='return addComment.moveForm( "comment-422788", "422788", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-422827">
<div class="comment-container" id="li-comment-422827">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 12, 2017 at 5:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-422827" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The one_hot() function does not map words to unique integers, it uses a hash function that can have collisions, learn more here<br/>
<a href="https://keras.io/preprocessing/text/#one_hot" rel="nofollow">https://keras.io/preprocessing/text/#one_hot</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-422827" onclick='return addComment.moveForm( "comment-422827", "422827", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-422840">
<div class="comment-container" id="li-comment-422840">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4fd4729ede523084c4988f110082a1e9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4fd4729ede523084c4988f110082a1e9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Stuart</span>
<span class="date">December 12, 2017 at 7:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-422840" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason, In your Part 4 example, the Tokenizer approach always gives the same encodings and these appear to be unique.</p>
<div class="reply">
<a aria-label="Reply to Stuart" class="comment-reply-link" href="#comment-422840" onclick='return addComment.moveForm( "comment-422840", "422840", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-422871">
<div class="comment-container" id="li-comment-422871">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 12, 2017 at 4:03 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-422871" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, I recommend using Tokenizer, see this post for more:<br/>
<a href="https://machinelearningmastery.com/prepare-text-data-deep-learning-keras/" rel="nofollow">https://machinelearningmastery.com/prepare-text-data-deep-learning-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-422871" onclick='return addComment.moveForm( "comment-422871", "422871", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-424718">
<div class="comment-container" id="li-comment-424718">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4e3f2ce8688757df67390f03cb7b5bf2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4e3f2ce8688757df67390f03cb7b5bf2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nadav</span>
<span class="date">December 25, 2017 at 8:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-424718" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great article Jason.<br/>
How do you convert back from an embedding to a one-hot? For example if you have a seq2seq model, and you feed the inputs as word embeddings, in your decoder you need to convert back from the embedding to a one-hot representing the dictionary. If you do it by using matrix multiplication that can be quite a large matrix (e.g embedding size 300, and vocab of 400k).</p>
<div class="reply">
<a aria-label="Reply to Nadav" class="comment-reply-link" href="#comment-424718" onclick='return addComment.moveForm( "comment-424718", "424718", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-424760">
<div class="comment-container" id="li-comment-424760">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 26, 2017 at 5:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-424760" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The output layer can predict integers directly that you can map to words in your vocabulary. There would be no embedding layer on the output.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-424760" onclick='return addComment.moveForm( "comment-424760", "424760", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-425991">
<div class="comment-container" id="li-comment-425991">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b9b1cfed1408b16d19c2e4f1a8c29a8a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b9b1cfed1408b16d19c2e4f1a8c29a8a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hitkul</span>
<span class="date">January 9, 2018 at 9:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-425991" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
Very helpful article.<br/>
I have created word2vec matrix of a sentence using gensim and pre-trained Google News vector. Can I just flatten this matrix to a vector and use that as a input to my neural network.<br/>
For example:<br/>
each sentence is of length 140 and I am using a pre-trained model of 100 dimensions, therefore:- I have a 140*100 matrix representing the sentence, can i just flatten it to a 14000 length vector and feed it to my input layer?</p>
<div class="reply">
<a aria-label="Reply to Hitkul" class="comment-reply-link" href="#comment-425991" onclick='return addComment.moveForm( "comment-425991", "425991", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-426058">
<div class="comment-container" id="li-comment-426058">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 10, 2018 at 5:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426058" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It depends on what you’re trying to model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426058" onclick='return addComment.moveForm( "comment-426058", "426058", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-426319">
<div class="comment-container" id="li-comment-426319">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d99d114becde1f53ba40cff094dd3ef4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d99d114becde1f53ba40cff094dd3ef4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Paul</span>
<span class="date">January 12, 2018 at 6:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426319" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great article, could you shed some light on how do Param # of 400 and 1500 in two neural networks come from? Thanks</p>
<div class="reply">
<a aria-label="Reply to Paul" class="comment-reply-link" href="#comment-426319" onclick='return addComment.moveForm( "comment-426319", "426319", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-426324">
<div class="comment-container" id="li-comment-426324">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d99d114becde1f53ba40cff094dd3ef4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d99d114becde1f53ba40cff094dd3ef4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Paul Lo</span>
<span class="date">January 12, 2018 at 9:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426324" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Oh! Is it just vocab_size * # of dimension of embedding space?<br/>
1.  50 * 8 = 400<br/>
2.  15* 100 = 1500</p>
<div class="reply">
<a aria-label="Reply to Paul Lo" class="comment-reply-link" href="#comment-426324" onclick='return addComment.moveForm( "comment-426324", "426324", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426363">
<div class="comment-container" id="li-comment-426363">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 13, 2018 at 5:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426363" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What do you mean exactly?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426363" onclick='return addComment.moveForm( "comment-426363", "426363", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-426530">
<div class="comment-container" id="li-comment-426530">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d84bd4e6951b12dd358bfef0d23aba04?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d84bd4e6951b12dd358bfef0d23aba04?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Andy Brown</span>
<span class="date">January 14, 2018 at 2:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426530" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great post! I’m working with my own corpus. How would I save the weight vector of the embedding layer in a text file like the glove data set?</p>
<p>My thinking is it would be easier for me to apply the vector representations to new data sets and/or machine learning platforms (mxnet etc) and make the output human readable (since the word is associated with the vector).</p>
<div class="reply">
<a aria-label="Reply to Andy Brown" class="comment-reply-link" href="#comment-426530" onclick='return addComment.moveForm( "comment-426530", "426530", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426583">
<div class="comment-container" id="li-comment-426583">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 15, 2018 at 6:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426583" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You could use get_weights() in the Keras API to retrieve the vectors and save directly as a CSV file.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426583" onclick='return addComment.moveForm( "comment-426583", "426583", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-426707">
<div class="comment-container" id="li-comment-426707">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fd689991ae81222c938880a365cb0a63?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fd689991ae81222c938880a365cb0a63?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://jaedukseo.me/" rel="external nofollow">jae</a></span>
<span class="date">January 17, 2018 at 8:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426707" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Clear Short Good reading, always thank you for your work!</p>
<div class="reply">
<a aria-label="Reply to jae" class="comment-reply-link" href="#comment-426707" onclick='return addComment.moveForm( "comment-426707", "426707", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426729">
<div class="comment-container" id="li-comment-426729">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 17, 2018 at 10:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426729" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426729" onclick='return addComment.moveForm( "comment-426729", "426729", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-426743">
<div class="comment-container" id="li-comment-426743">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3062a979b2735f8e46d13900965638d8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3062a979b2735f8e46d13900965638d8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Murali Manohar</span>
<span class="date">January 17, 2018 at 4:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426743" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,<br/>
                     I have a dataset with which I’ve attained 0.87 fscore by 5 fold cross validation using SVM.Maximum context window is 20 and one hot encoded.</p>
<p>Now, I’ve done whatever has been mentioned and getting an accuracy of 13-15 percent for RNN models where each one has one LSTM cell with 3,20,150,300 hidden units. Dimensions of my pre-trained embeddings is 300.</p>
<p>Loss is decreasing and even reaching negative values, but no change in accuracy.</p>
<p>I’ve tried the same with your CNN,basic ANN models you’ve mentioned for text classification .</p>
<p>Would you please suggest some solution. Thanks in advance.</p>
<div class="reply">
<a aria-label="Reply to Murali Manohar" class="comment-reply-link" href="#comment-426743" onclick='return addComment.moveForm( "comment-426743", "426743", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426792">
<div class="comment-container" id="li-comment-426792">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 18, 2018 at 10:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426792" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have some ideas here:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426792" onclick='return addComment.moveForm( "comment-426792", "426792", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-426751">
<div class="comment-container" id="li-comment-426751">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/97ebc4f3e4d828a5204631108989324a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/97ebc4f3e4d828a5204631108989324a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Carsten</span>
<span class="date">January 17, 2018 at 8:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426751" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>When I copy the code of the first box I get the error:</p>
<p>  AttributeError: ‘int’ object has no attribute ‘ndim’</p>
<p>in the line :</p>
<p>  model.fit(padded_docs, labels, epochs=50, verbose=0)</p>
<p>Where is the problem?</p>
<div class="reply">
<a aria-label="Reply to Carsten" class="comment-reply-link" href="#comment-426751" onclick='return addComment.moveForm( "comment-426751", "426751", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426795">
<div class="comment-container" id="li-comment-426795">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 18, 2018 at 10:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426795" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Copy the the code from the “complete example”.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426795" onclick='return addComment.moveForm( "comment-426795", "426795", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-428710">
<div class="comment-container" id="li-comment-428710">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a3027bf02f180917b71c94c5385cbc9f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a3027bf02f180917b71c94c5385cbc9f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Thiziri</span>
<span class="date">February 8, 2018 at 12:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-428710" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I’ve got the same error, also will running the “compete example”.<br/>
What can be the cause?</p>
<div class="reply">
<a aria-label="Reply to Thiziri" class="comment-reply-link" href="#comment-428710" onclick='return addComment.moveForm( "comment-428710", "428710", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-4" id="comment-428797">
<div class="comment-container" id="li-comment-428797">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3479a027fbb26b64a3ae0098d1d1208e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3479a027fbb26b64a3ae0098d1d1208e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Gokul</span>
<span class="date">February 8, 2018 at 6:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-428797" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Try casting the labels to numpy arrays.</p>
<div class="reply">
<a aria-label="Reply to Gokul" class="comment-reply-link" href="#comment-428797" onclick='return addComment.moveForm( "comment-428797", "428797", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-4" id="comment-428830">
<div class="comment-container" id="li-comment-428830">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/88c55d7f99dea3a870fa495dfbe480f5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/88c55d7f99dea3a870fa495dfbe480f5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">soren</span>
<span class="date">February 9, 2018 at 6:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-428830" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>i get the same!</p>
<div class="reply">
<a aria-label="Reply to soren" class="comment-reply-link" href="#comment-428830" onclick='return addComment.moveForm( "comment-428830", "428830", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-428855">
<div class="comment-container" id="li-comment-428855">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 9, 2018 at 9:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-428855" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have fixed and updated the examples.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-428778">
<div class="comment-container" id="li-comment-428778">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/606970dbdfded66087d698d66823863d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/606970dbdfded66087d698d66823863d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ademyanchuk</span>
<span class="date">February 8, 2018 at 3:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-428778" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Carsten, you need labels to be numpy.array not just list.</p>
<div class="reply">
<a aria-label="Reply to ademyanchuk" class="comment-reply-link" href="#comment-428778" onclick='return addComment.moveForm( "comment-428778", "428778", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-426755">
<div class="comment-container" id="li-comment-426755">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/33678441574c2601ae06506edc85ec8f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/33678441574c2601ae06506edc85ec8f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Willie</span>
<span class="date">January 17, 2018 at 9:18 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426755" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>If I have unkown words in training set, how can I assign the same  random initialize vector to all of the unkown words when using pretrained vector model like glove or w2v. thanks!!!</p>
<div class="reply">
<a aria-label="Reply to Willie" class="comment-reply-link" href="#comment-426755" onclick='return addComment.moveForm( "comment-426755", "426755", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-426799">
<div class="comment-container" id="li-comment-426799">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 18, 2018 at 10:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426799" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Why would you want to do that?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426799" onclick='return addComment.moveForm( "comment-426799", "426799", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-426824">
<div class="comment-container" id="li-comment-426824">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/33678441574c2601ae06506edc85ec8f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/33678441574c2601ae06506edc85ec8f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Willie</span>
<span class="date">January 18, 2018 at 1:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426824" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If my data is in specific domain and I still want to leverage general word embedding model(e.g. glove.6b.100d trained from wiki), then it must has some OOV in domain data, so. no no mather in training time or inference time it propably may appear some unkown words.</p>
<div class="reply">
<a aria-label="Reply to Willie" class="comment-reply-link" href="#comment-426824" onclick='return addComment.moveForm( "comment-426824", "426824", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-426871">
<div class="comment-container" id="li-comment-426871">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 19, 2018 at 6:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-426871" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It may. </p>
<p>You could ignore these words.</p>
<p>You could create a new embedding, set vectors from existing embedding and learn the new words.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426871" onclick='return addComment.moveForm( "comment-426871", "426871", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-427067">
<div class="comment-container" id="li-comment-427067">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/04d1e6feb86036ca3bc8d606febe70af?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/04d1e6feb86036ca3bc8d606febe70af?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://silversurfer0.github.io" rel="external nofollow">Vladimir</a></span>
<span class="date">January 21, 2018 at 1:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-427067" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Amazing Dr. Jason!<br/>
Thanks for a great walkthrough.</p>
<p>Kindly advice on the following.<br/>
On the step of encoding each word to integer you said: “We could experiment with other more sophisticated bag of word model encoding like counts or TF-IDF”. Could you kindly elaborate on how can it be implemented, as tfidf encodes tokens with floats. And how to tie it with Keras, passing it to an Embedding layer please? I’m keen to experiment with it, hope it could yield better results.</p>
<p>Another question is about input docs. Suppose I’ve preprocessed text by the means of nltk up to lemmatization, thus, each sample is a list of tokens. What is the best approach to pass it to Keras embedding layer in this case then?</p>
<div class="reply">
<a aria-label="Reply to Vladimir" class="comment-reply-link" href="#comment-427067" onclick='return addComment.moveForm( "comment-427067", "427067", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-427086">
<div class="comment-container" id="li-comment-427086">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 22, 2018 at 4:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-427086" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have most posts on BoW, learn more here:<br/>
<a href="https://machinelearningmastery.com/?s=bag+of+words&amp;submit=Search" rel="nofollow">https://machinelearningmastery.com/?s=bag+of+words&amp;submit=Search</a></p>
<p>You can encode your tokens as integers manually or use the Keras Tokenizer.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-427086" onclick='return addComment.moveForm( "comment-427086", "427086", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-427182">
<div class="comment-container" id="li-comment-427182">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/04d1e6feb86036ca3bc8d606febe70af?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/04d1e6feb86036ca3bc8d606febe70af?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://silversurfer0.github.io" rel="external nofollow">Vladimir</a></span>
<span class="date">January 22, 2018 at 11:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-427182" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Well, Keras Tokenizer can accept only texts or sequences. Seems the only way is to glue tokens together using ‘ ‘.join(token_list) and then pass onto the Tokenizer.</p>
<p>As for the BOW articles, I’ve walked through it theys are so very valuable. Thank you!</p>
<p>Using BOW differs so much from using Embeddings. As BOW would introduce huge sparse array of features for each sample, while Embeddings aim to represent those features (tokens) very densely up to a few hundreds items.</p>
<p>So, BOW in the other article gives incredibly good results with just very simple NN architecture (1 layer of 50 or 100 neurons). While I struggled to get good results using Embeddings along with convolutional layers…<br/>
From your experience, would you please advice on that please? Are Embeddings actually viable and it is just a matter of finding a correct architecture?</p>
<div class="reply">
<a aria-label="Reply to Vladimir" class="comment-reply-link" href="#comment-427182" onclick='return addComment.moveForm( "comment-427182", "427182", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-427247">
<div class="comment-container" id="li-comment-427247">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 23, 2018 at 8:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-427247" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice! And well done for working through the tutorials. I love to see that and few people actually “do the work”.</p>
<p>Embeddings make more sense on larger/hard problems generally – e.g. big vocab, complex language model on the front end, etc.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-427247" onclick='return addComment.moveForm( "comment-427247", "427247", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-427274">
<div class="comment-container" id="li-comment-427274">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/04d1e6feb86036ca3bc8d606febe70af?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/04d1e6feb86036ca3bc8d606febe70af?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vladimir</span>
<span class="date">January 23, 2018 at 10:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-427274" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I see, thank you.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-428053">
<div class="comment-container" id="li-comment-428053">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3b564181619e0a2c9f85df7ee98b699e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3b564181619e0a2c9f85df7ee98b699e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">joseph</span>
<span class="date">January 31, 2018 at 9:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-428053" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks jason for another great tutorial.</p>
<p>I have some questions : </p>
<p>Isn’t one hot definition is binary one, vector of 0’s and 1?<br/>
so [[1,2]] would be encoded to [[0,1,0],[0,0,1]]</p>
<p>how embedding  algorithm is done on keras word2vec/globe or simply  dense layer(or something else)<br/>
thanks<br/>
joseph</p>
<div class="reply">
<a aria-label="Reply to joseph" class="comment-reply-link" href="#comment-428053" onclick='return addComment.moveForm( "comment-428053", "428053", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-428088">
<div class="comment-container" id="li-comment-428088">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 1, 2018 at 7:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-428088" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t follow your question. Perhaps you could rephrase it?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-428088" onclick='return addComment.moveForm( "comment-428088", "428088", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-428369">
<div class="comment-container" id="li-comment-428369">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c832d2f7abbed01b9385ff6e28cd676e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c832d2f7abbed01b9385ff6e28cd676e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anna</span>
<span class="date">February 4, 2018 at 9:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-428369" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Amazing Dr. Jason!<br/>
Thanks for a great walkthrough.</p>
<p>The dimension for each word vector like above example e.g. 8, is set randomly? </p>
<p>Thank you</p>
<div class="reply">
<a aria-label="Reply to Anna" class="comment-reply-link" href="#comment-428369" onclick='return addComment.moveForm( "comment-428369", "428369", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-428406">
<div class="comment-container" id="li-comment-428406">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 5, 2018 at 7:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-428406" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The dimensionality is fixed and specified.</p>
<p>In the first example it is 8, in the second it is 100.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-428406" onclick='return addComment.moveForm( "comment-428406", "428406", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-428433">
<div class="comment-container" id="li-comment-428433">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c832d2f7abbed01b9385ff6e28cd676e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c832d2f7abbed01b9385ff6e28cd676e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anna</span>
<span class="date">February 5, 2018 at 2:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-428433" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Dr. Jason for your quick feedback!</p>
<p>Ok, I see that the pre-trained word embedding is set to 100 dimensionality because the original file “glove.6B.100d.txt” contained a fixed number of 100 weights for each line of ASCII.</p>
<p>However, the first example as you mentioned in here, “The Embedding has a vocabulary of 50 and an input length of 4. We will choose a small embedding space of 8 dimensions.”</p>
<p>You choose 8 dimensions for the first example. Does it means it can be set to any numbers other than 8? I’ve tried to change the dimension to 12. It doesn’t appeared any errors but the accuracy drops from 100% to 89%</p>
<p>_________________________________________________________________<br/>
Layer (type)                 Output Shape              Param #<br/>
=================================================================<br/>
embedding_1 (Embedding)      (None, 4, 12)             600<br/>
_________________________________________________________________<br/>
flatten_1 (Flatten)          (None, 48)                0<br/>
_________________________________________________________________<br/>
dense_1 (Dense)              (None, 1)                 49<br/>
=================================================================<br/>
Total params: 649<br/>
Trainable params: 649<br/>
Non-trainable params: 0</p>
<p>Accuracy: 89.999998</p>
<p>So, how dimensionality is set? Does the dimensions effects the accuracy performance?</p>
<p>Sorry I am trying to grasp the basic concept in understanding NLP stuff. Much appreciated for your help Dr. Jason.</p>
<p>Thank you</p>
<div class="reply">
<a aria-label="Reply to Anna" class="comment-reply-link" href="#comment-428433" onclick='return addComment.moveForm( "comment-428433", "428433", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-428440">
<div class="comment-container" id="li-comment-428440">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 5, 2018 at 2:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-428440" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No problem, please ask more questions.</p>
<p>Yes, you can choose any dimensionality you like. Larger means more expressive, required for larger vocabs.</p>
<p>Does that help Anna?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-428440" onclick='return addComment.moveForm( "comment-428440", "428440", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-428445">
<div class="comment-container" id="li-comment-428445">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c832d2f7abbed01b9385ff6e28cd676e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c832d2f7abbed01b9385ff6e28cd676e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anna</span>
<span class="date">February 5, 2018 at 4:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-428445" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes indeed Dr. Now I can see that the dimensionality is set depends on the number of vocabs. </p>
<p>Thank you again Dr Jason for enlighten me! 🙂</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-428541">
<div class="comment-container" id="li-comment-428541">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 6, 2018 at 9:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-428541" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You asked good questions.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-428397">
<div class="comment-container" id="li-comment-428397">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3e985ce8e31760b3fc187ab2d4d85ae2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3e985ce8e31760b3fc187ab2d4d85ae2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Miroslav</span>
<span class="date">February 5, 2018 at 7:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-428397" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
thanks for amazing tutorial.</p>
<p>I have a question. I am trying to do semantic role labeling with context window in Keras. How can I implement context window with embedding layer?</p>
<p>Thank you</p>
<div class="reply">
<a aria-label="Reply to Miroslav" class="comment-reply-link" href="#comment-428397" onclick='return addComment.moveForm( "comment-428397", "428397", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-428415">
<div class="comment-container" id="li-comment-428415">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 5, 2018 at 7:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-428415" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t know, sorry.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-428415" onclick='return addComment.moveForm( "comment-428415", "428415", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-428512">
<div class="comment-container" id="li-comment-428512">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6ec6e95fc7c6ce9bcf63c1bb1eb5020f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6ec6e95fc7c6ce9bcf63c1bb1eb5020f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Gabriel</span>
<span class="date">February 6, 2018 at 4:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-428512" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, great website! I’ve been learning a lot from all the tutorials. Thank you for providing all these easy to understand information.</p>
<p>How would I go about using other data for the CNN model? At the moment, I am using just textual data for my model using the word embeddings. From what I understand, the first layer of the model has to be the Embeddings, so how would I use other input data such as integers along with the Embeddings?</p>
<p>Thank you!</p>
<div class="reply">
<a aria-label="Reply to Gabriel" class="comment-reply-link" href="#comment-428512" onclick='return addComment.moveForm( "comment-428512", "428512", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-428559">
<div class="comment-container" id="li-comment-428559">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 6, 2018 at 9:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-428559" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question!</p>
<p>You can use a multiple-input model, see examples here:<br/>
<a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/" rel="nofollow">https://machinelearningmastery.com/keras-functional-api-deep-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-428559" onclick='return addComment.moveForm( "comment-428559", "428559", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-428588">
<div class="comment-container" id="li-comment-428588">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6ec6e95fc7c6ce9bcf63c1bb1eb5020f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6ec6e95fc7c6ce9bcf63c1bb1eb5020f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Gabriel</span>
<span class="date">February 6, 2018 at 4:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-428588" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for the fast reply!</p>
<div class="reply">
<a aria-label="Reply to Gabriel" class="comment-reply-link" href="#comment-428588" onclick='return addComment.moveForm( "comment-428588", "428588", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-428517">
<div class="comment-container" id="li-comment-428517">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a10d38d52339f9c4dc151bb98c65d415?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a10d38d52339f9c4dc151bb98c65d415?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aditya</span>
<span class="date">February 6, 2018 at 4:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-428517" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, this tutorial is simple and easy to understand. Thanks.</p>
<p>However, I have a question. While using the pre-trained embedding weights such as Glove or word2vec, what if there exists few words in my dataset, which weren’t present in the dataset on which word2vec or Glove  was trained. How does the model represent such words?</p>
<p>My understanding is that in your second section (Using Pre-Trained Glove Embeddin), you are mapping the words from the  loaded weights to the words present in your dataset, hence the question above.</p>
<p>Correct me, if it’s not the way I think it is.</p>
<div class="reply">
<a aria-label="Reply to Aditya" class="comment-reply-link" href="#comment-428517" onclick='return addComment.moveForm( "comment-428517", "428517", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-428560">
<div class="comment-container" id="li-comment-428560">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 6, 2018 at 9:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-428560" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can ignore them, or assign them to zero vector, or train a new model that includes them.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-428560" onclick='return addComment.moveForm( "comment-428560", "428560", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-430008">
<div class="comment-container" id="li-comment-430008">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0e37b1a74a30846b9759fcf5539ee5ac?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0e37b1a74a30846b9759fcf5539ee5ac?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Han</span>
<span class="date">February 20, 2018 at 4:03 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-430008" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I am trying to train a Keras LSTM model on some text sentiment data. I am also using GridSearchCV in sklearn to find the best parameters. I am not quite sure what went wrong but the classification report from sklearn says:</p>
<p>UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples.</p>
<p>Below is what the classification report looks like:</p>
<p>              precision    recall  f1-score   support</p>
<p>   negative       0.00      0.00      0.00        98<br/>
   positive       0.70      1.00      0.83       232</p>
<p>avg / total       0.49      0.70      0.58       330</p>
<p>Do you know what the problem is?</p>
<div class="reply">
<a aria-label="Reply to Han" class="comment-reply-link" href="#comment-430008" onclick='return addComment.moveForm( "comment-430008", "430008", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-430096">
<div class="comment-container" id="li-comment-430096">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 21, 2018 at 6:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-430096" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps you are trying to use keras metrics with sklearn? Watch the keywords you use when specifying the keras model vs the sklearn evaluation (CV).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430096" onclick='return addComment.moveForm( "comment-430096", "430096", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-430838">
<div class="comment-container" id="li-comment-430838">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1a9ee27f60f247cf3fd5e9d769ba7295?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1a9ee27f60f247cf3fd5e9d769ba7295?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alberto Nogales Moyano</span>
<span class="date">March 2, 2018 at 2:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-430838" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
your blog is really really interesting. I have a question: Which is the diffrence between using word2vec and texts_to_sequences from Tokenizer in keras? I mean in the way the texts are represented.<br/>
Is any of the two options better than the other?<br/>
Thanks a lot.<br/>
Kind regards.</p>
<div class="reply">
<a aria-label="Reply to Alberto Nogales Moyano" class="comment-reply-link" href="#comment-430838" onclick='return addComment.moveForm( "comment-430838", "430838", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-430857">
<div class="comment-container" id="li-comment-430857">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 2, 2018 at 5:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-430857" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>word2vec encodes words (integers) to vectors. texts_to_seqences encodes words to integers. It is a step before word2vec or a step before bag of words.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430857" onclick='return addComment.moveForm( "comment-430857", "430857", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-430902">
<div class="comment-container" id="li-comment-430902">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d96d8798900de8e326b3faf2cc98085c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d96d8798900de8e326b3faf2cc98085c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Souraj Adhikary</span>
<span class="date">March 2, 2018 at 5:39 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-430902" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I have a dataframe which contains texts and corresponding labels. I have used gensim module and used word2vec to make a model from the text. Now I want to use that model for input into Conv1D layers. Can you please tell me how to load the word2vec model in Keras Embedding layer? Do I need to pre-process the model in some way before loading?  Thanks in advance.</p>
<div class="reply">
<a aria-label="Reply to Souraj Adhikary" class="comment-reply-link" href="#comment-430902" onclick='return addComment.moveForm( "comment-430902", "430902", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-430955">
<div class="comment-container" id="li-comment-430955">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 3, 2018 at 8:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-430955" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, load the weights into an Embedding layer, then define the rest of your network.</p>
<p>The tutorial above will help a lot.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430955" onclick='return addComment.moveForm( "comment-430955", "430955", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-431957">
<div class="comment-container" id="li-comment-431957">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1351607249af95158182593c8344cccf?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1351607249af95158182593c8344cccf?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ankush Chandna</span>
<span class="date">March 13, 2018 at 1:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-431957" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is really helpful. You make us awesome at what we do. Thanks!!</p>
<div class="reply">
<a aria-label="Reply to Ankush Chandna" class="comment-reply-link" href="#comment-431957" onclick='return addComment.moveForm( "comment-431957", "431957", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-431980">
<div class="comment-container" id="li-comment-431980">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 13, 2018 at 6:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-431980" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad to hear that.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-431980" onclick='return addComment.moveForm( "comment-431980", "431980", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-432710">
<div class="comment-container" id="li-comment-432710">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/077d8f46f6cd6f9124695c8704358916?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/077d8f46f6cd6f9124695c8704358916?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">R.L.</span>
<span class="date">March 20, 2018 at 4:13 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-432710" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for this extremely helpful blog post. I have a question regarding to interpreting the model. Is there a way to know / visualize the word importance after the model is trained? I am looking for a way to do so. For instance, is there a way to find like the top 10 words that would trigger the model to classify a text as negative and vice versa? Thanks a lot for your help in advance</p>
<div class="reply">
<a aria-label="Reply to R.L." class="comment-reply-link" href="#comment-432710" onclick='return addComment.moveForm( "comment-432710", "432710", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-432756">
<div class="comment-container" id="li-comment-432756">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 21, 2018 at 6:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-432756" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>There may be methods, but I am not across them. Generally, neural nets are opaque, and even weight activations in the first/last layers might be misleading if used as importance scores.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-432756" onclick='return addComment.moveForm( "comment-432756", "432756", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-447447">
<div class="comment-container" id="li-comment-447447">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/97a84c9ca9568092fff5281644ecc4b6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/97a84c9ca9568092fff5281644ecc4b6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex</span>
<span class="date">September 1, 2018 at 12:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-447447" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Maybe look at Lime<br/>
<a href="https://github.com/marcotcr/lime" rel="nofollow">https://github.com/marcotcr/lime</a></p>
<div class="reply">
<a aria-label="Reply to Alex" class="comment-reply-link" href="#comment-447447" onclick='return addComment.moveForm( "comment-447447", "447447", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-447474">
<div class="comment-container" id="li-comment-447474">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 1, 2018 at 6:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-447474" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-447474" onclick='return addComment.moveForm( "comment-447474", "447474", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-433701">
<div class="comment-container" id="li-comment-433701">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a2431aae716f3dea6f21b83a6ba48d63?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a2431aae716f3dea6f21b83a6ba48d63?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mohit</span>
<span class="date">March 30, 2018 at 9:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-433701" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason ,</p>
<p>Can you please tell me the logic behind this:</p>
<p>vocab_size = len(t.word_index) + 1</p>
<p>Why we added 1 here??</p>
<div class="reply">
<a aria-label="Reply to Mohit" class="comment-reply-link" href="#comment-433701" onclick='return addComment.moveForm( "comment-433701", "433701", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-433741">
<div class="comment-container" id="li-comment-433741">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 31, 2018 at 6:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-433741" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>So that the word indexes are 1-offset, and 0 is reserved for padding / no data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-433741" onclick='return addComment.moveForm( "comment-433741", "433741", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-433774">
<div class="comment-container" id="li-comment-433774">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b00022d1bdaf856d3f2f8894e44c7d31?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b00022d1bdaf856d3f2f8894e44c7d31?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ryan</span>
<span class="date">March 31, 2018 at 9:59 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-433774" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>If I want to use this model to predict next word, can I just change the output layer to Dense(100, activation = ‘linear’) and change the loss function to MSE?</p>
<p>Many thanks,</p>
<p>Ray</p>
<div class="reply">
<a aria-label="Reply to Ryan" class="comment-reply-link" href="#comment-433774" onclick='return addComment.moveForm( "comment-433774", "433774", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-433803">
<div class="comment-container" id="li-comment-433803">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 1, 2018 at 5:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-433803" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps look at some of the posts on training a language model for word generation:<br/>
<a href="https://machinelearningmastery.com/?s=language+model&amp;submit=Search" rel="nofollow">https://machinelearningmastery.com/?s=language+model&amp;submit=Search</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-433803" onclick='return addComment.moveForm( "comment-433803", "433803", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-435261">
<div class="comment-container" id="li-comment-435261">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6ce50d0c51851fab1ccbe93b57148f09?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6ce50d0c51851fab1ccbe93b57148f09?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Coach</span>
<span class="date">April 17, 2018 at 10:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-435261" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for this tutoriel ! Really clear and usefull !</p>
<div class="reply">
<a aria-label="Reply to Coach" class="comment-reply-link" href="#comment-435261" onclick='return addComment.moveForm( "comment-435261", "435261", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-435304">
<div class="comment-container" id="li-comment-435304">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 18, 2018 at 8:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-435304" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435304" onclick='return addComment.moveForm( "comment-435304", "435304", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-436138">
<div class="comment-container" id="li-comment-436138">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d95cc0796f07e552a88f0c616c8a59aa?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d95cc0796f07e552a88f0c616c8a59aa?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Maryam</span>
<span class="date">April 28, 2018 at 4:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-436138" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
U R the best in keras tutorials and also replying the questions. I am really grateful.<br/>
Although I have understood the content of the context and codes U have written above, I am not able to understand what you mean about this sentence:[It might be better to filter the embedding for the unique words in your training data.].<br/>
what does “to filter the embedding” mean??<br/>
Thank you for replying.</p>
<div class="reply">
<a aria-label="Reply to Maryam" class="comment-reply-link" href="#comment-436138" onclick='return addComment.moveForm( "comment-436138", "436138", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-436162">
<div class="comment-container" id="li-comment-436162">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 28, 2018 at 5:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-436162" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It means, only have the words in the embedding that you know exist in your dataset.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436162" onclick='return addComment.moveForm( "comment-436162", "436162", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-436200">
<div class="comment-container" id="li-comment-436200">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d95cc0796f07e552a88f0c616c8a59aa?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d95cc0796f07e552a88f0c616c8a59aa?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Maryam</span>
<span class="date">April 28, 2018 at 11:45 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-436200" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thank U 4 replying but as I am not a native English speaker, I am not sure whether I got it or not. You mean to remove all the words which exist in the glove but do not exist in my own dataset?? in order to raise the speed of implementation?<br/>
I am sorry to ask it again as I did not understand clearly.<br/>
Thank U in advance Jason</p>
<div class="reply">
<a aria-label="Reply to Maryam" class="comment-reply-link" href="#comment-436200" onclick='return addComment.moveForm( "comment-436200", "436200", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-436227">
<div class="comment-container" id="li-comment-436227">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 29, 2018 at 6:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-436227" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Exactly.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436227" onclick='return addComment.moveForm( "comment-436227", "436227", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-436979">
<div class="comment-container" id="li-comment-436979">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5fbecd15a9914622c78cbacff7ab61e9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5fbecd15a9914622c78cbacff7ab61e9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aiza</span>
<span class="date">May 9, 2018 at 6:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-436979" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
This post is great. I am new to machine learning so i have a question which might be basic so i am not sure.As from what i understand, the model takes the embedding matrix and text along with labels at once.What i am trying to do is concatenate POS tag embedding with each pre-trained word embedding but POS tag can be different for the same word depending upon the context.It essentially means that i cant alter the embedding matrix at add to the network embedding layer.I want to take each sentence,find its embedding and concatenate with POS tag embedding and then feed into neural network.Is there a way to do the training sentence by sentence or something? Thanks</p>
<div class="reply">
<a aria-label="Reply to Aiza" class="comment-reply-link" href="#comment-436979" onclick='return addComment.moveForm( "comment-436979", "436979", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-437001">
<div class="comment-container" id="li-comment-437001">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 9, 2018 at 6:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-437001" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You might be able to use the embedding and pre-calculate the vector representations for each sentence.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437001" onclick='return addComment.moveForm( "comment-437001", "437001", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-437004">
<div class="comment-container" id="li-comment-437004">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5fbecd15a9914622c78cbacff7ab61e9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5fbecd15a9914622c78cbacff7ab61e9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aiza</span>
<span class="date">May 9, 2018 at 7:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-437004" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry but i didn’t quite understand.Can you  please elaborate a little?</p>
<div class="reply">
<a aria-label="Reply to Aiza" class="comment-reply-link" href="#comment-437004" onclick='return addComment.moveForm( "comment-437004", "437004", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-437019">
<div class="comment-container" id="li-comment-437019">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 9, 2018 at 2:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-437019" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I mean that you can prepare an word2vec model standalone. Then pass each sentence through it to build up a list of vectors. Concat the vectors together and you have a distributed sentence representation.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437019" onclick='return addComment.moveForm( "comment-437019", "437019", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-437054">
<div class="comment-container" id="li-comment-437054">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5fbecd15a9914622c78cbacff7ab61e9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5fbecd15a9914622c78cbacff7ab61e9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aiza</span>
<span class="date">May 9, 2018 at 10:16 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-437054" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks alot! One more thing, is it possible to pass other information to the embedding layer than just weights?For example i was thinking that what if i dont change the embedding matrix at all and create a separate matrix of POS tags for whole training data which is also passed to the embedding layer which concatenates these both sequentially?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-437086">
<div class="comment-container" id="li-comment-437086">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 10, 2018 at 6:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-437086" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You could develop a model that has multiple inputs, for example see this post for examples:<br/>
<a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/" rel="nofollow">https://machinelearningmastery.com/keras-functional-api-deep-learning/</a></p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-437545">
<div class="comment-container" id="li-comment-437545">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5fbecd15a9914622c78cbacff7ab61e9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5fbecd15a9914622c78cbacff7ab61e9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aiza</span>
<span class="date">May 15, 2018 at 8:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-437545" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.I saw this post.Your model has separate inputs but they get merged after flattening.In my case i want to pass the embeddings to first convolutional layer,only after they are concatenated. Uptil now what i did was that i have created another integerized sequence of my data according to POS_tags(embedding_pos) to pass as another input and another embedding matrix that contains the embeddings of all the POS tags.<br/>
e=(Embedding(vocab_size, 50, input_length=23, weights=[embedding_matrix], trainable=False))<br/>
e1=(Embedding(38, 38, input_length=23, weights=[embedding_matrix_pos], trainable=False))<br/>
merged_input = concatenate([e,e1], axis=0)<br/>
model_embed = Sequential()<br/>
model_embed.add(merged_input)<br/>
model_embed.fit(data,embedding_pos, final_labels, epochs=50, verbose=0)</p>
<p>I know this is wrong but i am not sure how to concat those both sequences and if you can direct me in right direction,it would be great.The error is<br/>
‘Layer concatenate_6 was called with an input that isn’t a symbolic tensor. Received type: . Full input: [, ]. All inputs to the layer should be tensors.’</p>
<div class="reply">
<a aria-label="Reply to Aiza" class="comment-reply-link" href="#comment-437545" onclick='return addComment.moveForm( "comment-437545", "437545", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-437555">
<div class="comment-container" id="li-comment-437555">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 15, 2018 at 2:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-437555" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps you could experiment and compare the performance of models with different merge layers for combining the inputs.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437555" onclick='return addComment.moveForm( "comment-437555", "437555", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-437679">
<div class="comment-container" id="li-comment-437679">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1b3b04ffee3cfc4f6395f3127d36304b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1b3b04ffee3cfc4f6395f3127d36304b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Franco</span>
<span class="date">May 16, 2018 at 6:51 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-437679" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, awesome post as usual!</p>
<p>Your last sentence is tricky though. You write:</p>
<p>“In practice, I would encourage you to experiment with learning a word embedding using a pre-trained embedding that is fixed and trying to perform learning on top of a pre-trained embedding.”</p>
<p>Without the original corpus, I would argue, that’s impossible.</p>
<p>In Google’s case, the original corpus of around 100 billion words is not publicly available. Solution? I believe you’re suggesting “Transfer Learning for NLP.” In this case, the only solution I see is to add manually words. </p>
<p>E.g. you need ‘dolares’ which is not in Google’s Word2Vec. You want to have similar vectors as ‘money’. In this case, you add ‘dolares’ + 300 vectors from money. Very painful, I know. But it’s the only way I see to do “Transfer Learning with NLP”. </p>
<p>If you have a better solution, I’d love your input.</p>
<p>Cheerio, a big fan</p>
<div class="reply">
<a aria-label="Reply to Franco" class="comment-reply-link" href="#comment-437679" onclick='return addComment.moveForm( "comment-437679", "437679", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-437723">
<div class="comment-container" id="li-comment-437723">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 17, 2018 at 6:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-437723" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not impossible, you can use an embedding trained on a other corpus and ignore the difference or fine tune the embedding while fitting your model.</p>
<p>You can also add missing words to the embedding and learn those.</p>
<p>Remember, we want a vector for each word that best captures their usage, some inconsistencies does not result in a useless model, it is not binary useful/useless case.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437723" onclick='return addComment.moveForm( "comment-437723", "437723", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-437778">
<div class="comment-container" id="li-comment-437778">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1b3b04ffee3cfc4f6395f3127d36304b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1b3b04ffee3cfc4f6395f3127d36304b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Franco</span>
<span class="date">May 17, 2018 at 4:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-437778" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you very much for the detailed answer!</p>
<div class="reply">
<a aria-label="Reply to Franco" class="comment-reply-link" href="#comment-437778" onclick='return addComment.moveForm( "comment-437778", "437778", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-439179">
<div class="comment-container" id="li-comment-439179">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/50e0de9847b98956b01a162c9de16984?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/50e0de9847b98956b01a162c9de16984?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ashar</span>
<span class="date">May 31, 2018 at 6:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-439179" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The link for the Tokenizer API is this same webpage. Can you update it please?</p>
<div class="reply">
<a aria-label="Reply to Ashar" class="comment-reply-link" href="#comment-439179" onclick='return addComment.moveForm( "comment-439179", "439179", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-439200">
<div class="comment-container" id="li-comment-439200">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 31, 2018 at 6:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-439200" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Fixed, thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-439200" onclick='return addComment.moveForm( "comment-439200", "439200", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-439212">
<div class="comment-container" id="li-comment-439212">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c341302cba508cb8085b2c3167eda9e4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c341302cba508cb8085b2c3167eda9e4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Andreas Papandreou</span>
<span class="date">May 31, 2018 at 10:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-439212" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, great post!<br/>
I have successfully trained my model using the word embedding and Keras. I saved the trained model and the word tokens.Now in order to make some predictions, do i have to use the same tokenizer with one that i used in the training?</p>
<div class="reply">
<a aria-label="Reply to Andreas Papandreou" class="comment-reply-link" href="#comment-439212" onclick='return addComment.moveForm( "comment-439212", "439212", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-439227">
<div class="comment-container" id="li-comment-439227">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 31, 2018 at 2:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-439227" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Correct.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-439227" onclick='return addComment.moveForm( "comment-439227", "439227", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-439237">
<div class="comment-container" id="li-comment-439237">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c341302cba508cb8085b2c3167eda9e4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c341302cba508cb8085b2c3167eda9e4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Andreas Papandreou</span>
<span class="date">May 31, 2018 at 4:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-439237" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you very much!</p>
<div class="reply">
<a aria-label="Reply to Andreas Papandreou" class="comment-reply-link" href="#comment-439237" onclick='return addComment.moveForm( "comment-439237", "439237", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-439518">
<div class="comment-container" id="li-comment-439518">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/499161db384cbf14d020e716affb5859?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/499161db384cbf14d020e716affb5859?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">zedom</span>
<span class="date">June 2, 2018 at 5:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-439518" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, when i was looking for how to use pre-trained word embedding,<br/>
I found your article along with this one:<br/>
<a href="https://jovianlin.io/embeddings-in-keras/" rel="nofollow">https://jovianlin.io/embeddings-in-keras/</a><br/>
They have many similarities.</p>
<div class="reply">
<a aria-label="Reply to zedom" class="comment-reply-link" href="#comment-439518" onclick='return addComment.moveForm( "comment-439518", "439518", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-439586">
<div class="comment-container" id="li-comment-439586">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 3, 2018 at 6:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-439586" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear it.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-439586" onclick='return addComment.moveForm( "comment-439586", "439586", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-440733">
<div class="comment-container" id="li-comment-440733">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f178e8fc27ec436024477cfa78f5ce39?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f178e8fc27ec436024477cfa78f5ce39?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jack</span>
<span class="date">June 13, 2018 at 10:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-440733" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey jason,</p>
<p>I am trying to do this but sometime keras gives the same integer to different words. Would it be better to use scikit encoder that converts words to integers?</p>
<div class="reply">
<a aria-label="Reply to Jack" class="comment-reply-link" href="#comment-440733" onclick='return addComment.moveForm( "comment-440733", "440733", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-440776">
<div class="comment-container" id="li-comment-440776">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 14, 2018 at 6:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-440776" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This might happen if you are using a hash encoder, as Keras does, but calls it a one hot encoder.</p>
<p>Perhaps try a different encoding scheme of words to integers</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-440776" onclick='return addComment.moveForm( "comment-440776", "440776", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-441105">
<div class="comment-container" id="li-comment-441105">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c97f9c525a5ec93057e79b511d34f11d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c97f9c525a5ec93057e79b511d34f11d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Meysam</span>
<span class="date">June 18, 2018 at 5:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-441105" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I have implemented the above tutorial and the code works fine with GloVe. I am so grateful abot the tutorial Jason.<br/>
but when I download GoogleNews-vectors-negative300.bin which is a pre-trained embedding word2vec it gave me this error: </p>
<p>  File “/home/mary/anaconda3/envs/virenv/lib/python3.5/site-packages/gensim/models/keyedvectors.py”, line 171, in __getitem__<br/>
    return vstack([self.get_vector(entity) for entity in entities])</p>
<p>TypeError: ‘int’ object is not iterable.</p>
<p>I wrote the code as the same as your code which you wrote for loading glove but with a little change.</p>
<p>‘model = gensim.models.KeyedVectors.load_word2vec_format(‘./GoogleNews-vectors-negative300.bin’, binary=True) </p>
<p>for line in model:<br/>
	values = line.split()<br/>
	word = values[0]<br/>
	coefs = asarray(values[1:], dtype=’float32′)<br/>
	embeddings_index[word] = coefs<br/>
model.close()<br/>
print(‘Loaded %s word vectors.’ % len(embeddings_index))</p>
<p>embedding_matrix = zeros((vocab_dic_size, 300))<br/>
for  word in vocab_dic.keys():<br/>
	embedding_vector = embeddings_index.get(word)<br/>
	if embedding_vector is not None:<br/>
		embedding_matrix[vocab_dic[word]] = embedding_vector</p>
<p>I saw you wrote a tutorial about creating word2vec by yourself in this link “https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/”,<br/>
but I have not seen a tutorial about aplying pre-trained word2vec like GloVe.<br/>
please guide me to solve the error and how to apply the GoogleNews-vectors-negative300.bin pretrained wor2vec?<br/>
I am so sorry to write a lot as I wanted to explain in detail to be clear.<br/>
any guidance will be appreciated.<br/>
Best<br/>
Meysam</p>
<div class="reply">
<a aria-label="Reply to Meysam" class="comment-reply-link" href="#comment-441105" onclick='return addComment.moveForm( "comment-441105", "441105", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-441130">
<div class="comment-container" id="li-comment-441130">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 18, 2018 at 6:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-441130" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps try the text version as in the above tutorial?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-441130" onclick='return addComment.moveForm( "comment-441130", "441130", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-441193">
<div class="comment-container" id="li-comment-441193">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c97f9c525a5ec93057e79b511d34f11d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c97f9c525a5ec93057e79b511d34f11d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Meysam</span>
<span class="date">June 19, 2018 at 12:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-441193" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason<br/>
thank you very much for replying, but as I am weak at the English language, the meaning of this sentence is not clear. what do you mean by “try the text version”??<br/>
in fact, GloVe contains txt files and I implement it correctly but when I wanna run a program by GoogleNews-vectors-negative300.bin which is a pre-trained embedding word2vec it gave me the error and also this file is a binary one and there is no pre-trained embedding word2vec file by txt prefix.<br/>
can you help me though I know you are busy?<br/>
Best<br/>
Meysam</p>
<div class="reply">
<a aria-label="Reply to Meysam" class="comment-reply-link" href="#comment-441193" onclick='return addComment.moveForm( "comment-441193", "441193", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-441223">
<div class="comment-container" id="li-comment-441223">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 19, 2018 at 6:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-441223" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You are using the binary version of the glove file (.bin). Try downloading and using the text version instead.</p>
<p>You can get .txt versions here:<br/>
<a href="https://nlp.stanford.edu/projects/glove/" rel="nofollow">https://nlp.stanford.edu/projects/glove/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-441223" onclick='return addComment.moveForm( "comment-441223", "441223", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-441174">
<div class="comment-container" id="li-comment-441174">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/99936df4b99b08411c4fc0fcbe34230f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/99936df4b99b08411c4fc0fcbe34230f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kavit Gangar</span>
<span class="date">June 18, 2018 at 7:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-441174" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How can we use pre-trained word embedding on mobile?</p>
<div class="reply">
<a aria-label="Reply to Kavit Gangar" class="comment-reply-link" href="#comment-441174" onclick='return addComment.moveForm( "comment-441174", "441174", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-441214">
<div class="comment-container" id="li-comment-441214">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 19, 2018 at 6:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-441214" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t see why not, other than disk/ram size issues.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-441214" onclick='return addComment.moveForm( "comment-441214", "441214", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-442228">
<div class="comment-container" id="li-comment-442228">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4e7687090278d32912ea8126691dac9f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4e7687090278d32912ea8126691dac9f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">NewToDeepNLP</span>
<span class="date">June 28, 2018 at 12:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-442228" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great post! What changes are necessary if the labels are more than binary such as with 4 classes:<br/>
labels = array([2,1,1,1,2,0,-1,0,-1,0])<br/>
?<br/>
E.g. instead of ‘binary_crossentropy’ perhaps ‘categorical_crossentropy’?<br/>
And how shold the Dense layer change?<br/>
If I use: model.add(Dense(4, activation=’sigmoid’)), I get an error:</p>
<p>ValueError: Error when checking target: expected dense_1 to have shape (None, 4) but got array with shape (10, 1)</p>
<p>thanks for your work!</p>
<div class="reply">
<a aria-label="Reply to NewToDeepNLP" class="comment-reply-link" href="#comment-442228" onclick='return addComment.moveForm( "comment-442228", "442228", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-442237">
<div class="comment-container" id="li-comment-442237">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 28, 2018 at 2:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-442237" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I believe this will help:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/how-can-i-change-a-neural-network-from-regression-to-classification" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-can-i-change-a-neural-network-from-regression-to-classification</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442237" onclick='return addComment.moveForm( "comment-442237", "442237", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-442243">
<div class="comment-container" id="li-comment-442243">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4e7687090278d32912ea8126691dac9f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4e7687090278d32912ea8126691dac9f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">NewToDeepNLP</span>
<span class="date">June 28, 2018 at 3:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-442243" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thanks! also using keras’s to_categorical to discretize the labels was necessary.</p>
<div class="reply">
<a aria-label="Reply to NewToDeepNLP" class="comment-reply-link" href="#comment-442243" onclick='return addComment.moveForm( "comment-442243", "442243", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-4" id="comment-442257">
<div class="comment-container" id="li-comment-442257">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4e7687090278d32912ea8126691dac9f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4e7687090278d32912ea8126691dac9f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">NewToDeepNLP</span>
<span class="date">June 28, 2018 at 7:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-442257" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>one more question: is there a simply way to create the Tokenizer() instance, fit it, save it, and then extend it on new documents? Specifically, so that t.fit_on_texts( ) can be updated on new data.</p>
<div class="reply">
<a aria-label="Reply to NewToDeepNLP" class="comment-reply-link" href="#comment-442257" onclick='return addComment.moveForm( "comment-442257", "442257", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-442289">
<div class="comment-container" id="li-comment-442289">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 29, 2018 at 5:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-442289" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m not so sure that you can.</p>
<p>It might be easier to manage the encoding/mapping yourself so that you can extend it at will.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-442283">
<div class="comment-container" id="li-comment-442283">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 29, 2018 at 5:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-442283" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442283" onclick='return addComment.moveForm( "comment-442283", "442283", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-442268">
<div class="comment-container" id="li-comment-442268">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/430a8dfebbd96217e956de8fdfad8ce4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/430a8dfebbd96217e956de8fdfad8ce4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">James</span>
<span class="date">June 28, 2018 at 9:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-442268" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>For starters, thanks for this post.  Ideal to get things going quickly.  I have a couple of questions if you don’t mind:</p>
<p>1)  I don’t think that one-hot encoding the string vectors is ideal.  Even with the recommended vocab size (50), I still got collisions which defeats the purpose even in a toy example such as this.  Even the documentation states that uniqueness is not guaranteed.  Keras’ Tokenizer(), which you used in the pre-trained example is a more reliable choice in that no two words will share the same integer mapping.  How come you proposed one-hot encoding when Tokenizer() does the same job better?</p>
<p>2) Getting Tokenizer()’s word_index property, returns the full dictionary.  I expected the vocab_size to be equal to len(t.word_index) but you increment that value by one.  This is in fact necessary because otherwise fitting the model fails.  But I cannot get the intuition of that.  Why is the input dimension size equal to vocab_size + 1?</p>
<p>3) I created a model that expects a BoW vector representation of each “document”.  Naturally, the vectors were larger and sparser [ (10,14) ] which means more parameters to learn, no.  However, in your document you refer to this encoding or tf-idf as “more sophisticated”.  Why do you believe so?  With that encoding don’t you lose the word order which is important to learn word embeddings?  For the record, this encoding worked well too but it’s probably due to the nature of this little experiment.</p>
<p>Thank you in advance.</p>
<div class="reply">
<a aria-label="Reply to James" class="comment-reply-link" href="#comment-442268" onclick='return addComment.moveForm( "comment-442268", "442268", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-442298">
<div class="comment-container" id="li-comment-442298">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 29, 2018 at 6:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-442298" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The keras one hot encoding method really just takes a hash. It is better to use a true one hot encoding when needed.</p>
<p>I do prefer the Tokenizer class in practice.</p>
<p>The words are 1-offset, leaving room for 0 for “unknown” word.</p>
<p>tf-idf gives some idea of the frequency over the simple presence/absence of a word in BoW.</p>
<p>How that helps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442298" onclick='return addComment.moveForm( "comment-442298", "442298", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-443245">
<div class="comment-container" id="li-comment-443245">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/264d3607dd0afa0f79b6aec593044f9d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/264d3607dd0afa0f79b6aec593044f9d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">abbas</span>
<span class="date">July 12, 2018 at 3:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-443245" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>where can i find the file “../glove_data/glove.6B/glove.6B.100d.txt”??because i come up with the following error.<br/>
File “”, line 36<br/>
    f = open(‘../glove_data/glove.6B/glove.6B.100d.txt’)<br/>
             ^<br/>
SyntaxError: invalid character in identifier</p>
<div class="reply">
<a aria-label="Reply to abbas" class="comment-reply-link" href="#comment-443245" onclick='return addComment.moveForm( "comment-443245", "443245", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-443264">
<div class="comment-container" id="li-comment-443264">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 12, 2018 at 6:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-443264" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You must download it and place it in your current working directory.</p>
<p>Perhaps re-read section 4.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443264" onclick='return addComment.moveForm( "comment-443264", "443264", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-443462">
<div class="comment-container" id="li-comment-443462">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/264d3607dd0afa0f79b6aec593044f9d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/264d3607dd0afa0f79b6aec593044f9d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">abbas</span>
<span class="date">July 14, 2018 at 3:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-443462" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have placed the code and dataset in same directory.what’s wrong with the code??<br/>
f = open(‘glove.6B/glove.6B.100d.txt’)<br/>
I am facing the following error.<br/>
File “”, line 36<br/>
    f = open(‘glove.6B/glove.6B.100d.txt’)<br/>
                  ^<br/>
SyntaxError: invalid character in identifier</p>
<div class="reply">
<a aria-label="Reply to abbas" class="comment-reply-link" href="#comment-443462" onclick='return addComment.moveForm( "comment-443462", "443462", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-443509">
<div class="comment-container" id="li-comment-443509">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 15, 2018 at 6:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-443509" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps this will help you when copying code from the tutorial:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-copy-code-from-a-tutorial" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-copy-code-from-a-tutorial</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443509" onclick='return addComment.moveForm( "comment-443509", "443509", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-443681">
<div class="comment-container" id="li-comment-443681">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/07568cb5d64aa17fd38de891ff0f7110?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/07568cb5d64aa17fd38de891ff0f7110?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Harry</span>
<span class="date">July 17, 2018 at 1:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-443681" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Excellent work! This is quite helpful to novice.<br/>
And I wonder is this useful to other language apart from English? Since I am a Chinese, and I wonder whether I can apply this to Chinese language and vocabulary.<br/>
Thanks again for your time devoted!</p>
<div class="reply">
<a aria-label="Reply to Harry" class="comment-reply-link" href="#comment-443681" onclick='return addComment.moveForm( "comment-443681", "443681", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-443689">
<div class="comment-container" id="li-comment-443689">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 17, 2018 at 2:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-443689" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t see why not.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443689" onclick='return addComment.moveForm( "comment-443689", "443689", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-443736">
<div class="comment-container" id="li-comment-443736">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f2dbfa92106944c76c2f5a8f7b7276ba?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f2dbfa92106944c76c2f5a8f7b7276ba?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sree harsha</span>
<span class="date">July 18, 2018 at 6:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-443736" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>can you explain how can the word embeddings be given as hidden state input to LSTM?</p>
<p>thanks in advance</p>
<div class="reply">
<a aria-label="Reply to sree harsha" class="comment-reply-link" href="#comment-443736" onclick='return addComment.moveForm( "comment-443736", "443736", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-443761">
<div class="comment-container" id="li-comment-443761">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 18, 2018 at 6:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-443761" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Word embeddings don’t have hidden state. They don’t have any state.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443761" onclick='return addComment.moveForm( "comment-443761", "443761", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-443808">
<div class="comment-container" id="li-comment-443808">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f2dbfa92106944c76c2f5a8f7b7276ba?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f2dbfa92106944c76c2f5a8f7b7276ba?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sree harsha</span>
<span class="date">July 18, 2018 at 6:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-443808" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>for example, I have a word and its 50 (dimensional) embeddings. How can I give these embeddings as hidden state input to an LSTM layer?</p>
<div class="reply">
<a aria-label="Reply to sree harsha" class="comment-reply-link" href="#comment-443808" onclick='return addComment.moveForm( "comment-443808", "443808", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-443852">
<div class="comment-container" id="li-comment-443852">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 19, 2018 at 7:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-443852" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Why would you want to give them as the hidden state instead of using them as input to the LSTM?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443852" onclick='return addComment.moveForm( "comment-443852", "443852", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-443958">
<div class="comment-container" id="li-comment-443958">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e4c2ff2d31259562ad38cd98864c06c9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e4c2ff2d31259562ad38cd98864c06c9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">zbk</span>
<span class="date">July 20, 2018 at 8:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-443958" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi, what a practical post!<br/>
I have a question, I work in a sentiment analysis project with word2vec as an embedding model with keras. my problem is when I want to predict a new sentence as an input I face this error:</p>
<p>ValueError: Error when checking input: expected conv1d_1_input to have shape (15, 512) but got array with shape (3, 512)</p>
<p>consider that I want to enter a simple sentence like:”I’m really sad” with the length 3- and my input shape has the length of 15- I don’t know how can I reshape it or doing what to get rid of this error. </p>
<p>and this is the related part of my code:</p>
<p>model = Sequential()<br/>
model.add(Conv1D(32, kernel_size=3, activation=’elu’, padding=’same’, input_shape=(15, 512)))<br/>
model.add(Conv1D(32, kernel_size=3, activation=’elu’, padding=’same’))<br/>
model.add(Conv1D(32, kernel_size=3, activation=’elu’, padding=’same’))<br/>
model.add(Conv1D(32, kernel_size=3, activation=’elu’, padding=’same’))<br/>
model.add(Dropout(0.25))</p>
<p>model.add(Conv1D(32, kernel_size=2, activation=’elu’, padding=’same’))<br/>
model.add(Conv1D(32, kernel_size=2, activation=’elu’, padding=’same’))<br/>
model.add(Conv1D(32, kernel_size=2, activation=’elu’, padding=’same’))<br/>
model.add(Conv1D(32, kernel_size=2, activation=’elu’, padding=’same’))<br/>
model.add(Dropout(0.25))</p>
<p>model.add(Dense(256, activation=’relu’))<br/>
model.add(Dense(256, activation=’relu’))<br/>
model.add(Dropout(0.5))<br/>
model.add(Flatten())<br/>
model.add(Dense(2, activation=’softmax’))</p>
<p>would you please help me to solve this problem?</p>
<div class="reply">
<a aria-label="Reply to zbk" class="comment-reply-link" href="#comment-443958" onclick='return addComment.moveForm( "comment-443958", "443958", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-444012">
<div class="comment-container" id="li-comment-444012">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 21, 2018 at 6:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-444012" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You must prepare the new sentence in exactly the same way as the training data, including length and integer encoding.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444012" onclick='return addComment.moveForm( "comment-444012", "444012", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-443977">
<div class="comment-container" id="li-comment-443977">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e4c2ff2d31259562ad38cd98864c06c9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e4c2ff2d31259562ad38cd98864c06c9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">zbk</span>
<span class="date">July 20, 2018 at 6:09 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-443977" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>At least would you mind sharing some suitable source for me to solve this problem please?<br/>
I hope you answer my question as what you done all the time. Thanks</p>
<div class="reply">
<a aria-label="Reply to zbk" class="comment-reply-link" href="#comment-443977" onclick='return addComment.moveForm( "comment-443977", "443977", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-444021">
<div class="comment-container" id="li-comment-444021">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 21, 2018 at 6:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-444021" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m eager to help and answer specific questions, but I don’t have the capacity to write code for you sorry.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444021" onclick='return addComment.moveForm( "comment-444021", "444021", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-444575">
<div class="comment-container" id="li-comment-444575">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/872880040d17db429ccb2ffd6809c4c3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/872880040d17db429ccb2ffd6809c4c3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alalehrz</span>
<span class="date">July 28, 2018 at 5:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-444575" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I have two questions. First, for new instances if the length is greater than this model input shall we truncate the sentence?<br/>
Also, since the embedding input is just for the seen training set words, what happens to the predictions-to-word process? I assume it just returns some words similar to the training words not considering all the dictionary words. Of course I am talking about a language model with Glove.</p>
<div class="reply">
<a aria-label="Reply to Alalehrz" class="comment-reply-link" href="#comment-444575" onclick='return addComment.moveForm( "comment-444575", "444575", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-444605">
<div class="comment-container" id="li-comment-444605">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 28, 2018 at 6:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-444605" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, truncate.</p>
<p>Unseen words are mapped to nothing or 0.</p>
<p>The training dataset MUST be representative of the problem you are solving.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444605" onclick='return addComment.moveForm( "comment-444605", "444605", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-444822">
<div class="comment-container" id="li-comment-444822">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5fbecd15a9914622c78cbacff7ab61e9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5fbecd15a9914622c78cbacff7ab61e9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">az</span>
<span class="date">July 31, 2018 at 3:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-444822" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>From what i understood from this comment,it is about prediction on test data. Lets assume that there are 50 words in vocabulary which means sentences will have unique integers uptil 50. Now since test data must be tokenized with same instance of tokenizer and if it has some new words, it would have integers with 51 ,52 oand so on..In this case,would the model automatically use 0 for word embeddings or can it raise out of bound type exception?Thanks</p>
<div class="reply">
<a aria-label="Reply to az" class="comment-reply-link" href="#comment-444822" onclick='return addComment.moveForm( "comment-444822", "444822", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-444845">
<div class="comment-container" id="li-comment-444845">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 31, 2018 at 6:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-444845" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You would encode unseen words as 0.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444845" onclick='return addComment.moveForm( "comment-444845", "444845", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-444707">
<div class="comment-container" id="li-comment-444707">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b2098fa48745f7167e56689a84716de5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b2098fa48745f7167e56689a84716de5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jaskaran</span>
<span class="date">July 29, 2018 at 11:21 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-444707" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>can this be described as transfer learning?</p>
<div class="reply">
<a aria-label="Reply to Jaskaran" class="comment-reply-link" href="#comment-444707" onclick='return addComment.moveForm( "comment-444707", "444707", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-444742">
<div class="comment-container" id="li-comment-444742">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 30, 2018 at 5:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-444742" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444742" onclick='return addComment.moveForm( "comment-444742", "444742", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-444814">
<div class="comment-container" id="li-comment-444814">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5fbecd15a9914622c78cbacff7ab61e9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5fbecd15a9914622c78cbacff7ab61e9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">eden</span>
<span class="date">July 31, 2018 at 1:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-444814" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
i have trained and tested my own network. During my work,when i integerized the sentences and created a corresponding word embedding matrix ,it included embeddings for train,validation and test data as well.<br/>
 Now if i want to reload my model to test for some other similar data, i am confused that how the words from this new data would relate to embedding matrix?<br/>
You should have embeddings for test data as well right? or when you create embedding matrix you exclude test data?Thanks</p>
<div class="reply">
<a aria-label="Reply to eden" class="comment-reply-link" href="#comment-444814" onclick='return addComment.moveForm( "comment-444814", "444814", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-444837">
<div class="comment-container" id="li-comment-444837">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 31, 2018 at 6:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-444837" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The embedding is created from the training dataset.</p>
<p>It should be sufficiently rich/representative enough to cover all data you expect to in the future.</p>
<p>New data must have the same integer encoding as the training data prior to being mapped onto the embedding when making a prediction.</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444837" onclick='return addComment.moveForm( "comment-444837", "444837", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-444856">
<div class="comment-container" id="li-comment-444856">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5fbecd15a9914622c78cbacff7ab61e9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5fbecd15a9914622c78cbacff7ab61e9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">eden</span>
<span class="date">July 31, 2018 at 8:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-444856" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>yes,i understand that i should be using the same tokenizer object for encoding both train and test data, but i am not sure how the embedding layer would behave for the word or index which isnt part of embedding matrix. Obviously test data would have similar words but there must be some words that are bound to be new. Would you say this approach is right to include test data too while creating embedding matrix for model? If you want to predict using some pre trained model,how can i deal with this issue? A small example can be really helpful. Thanks alot for all the help and time!</p>
<div class="reply">
<a aria-label="Reply to eden" class="comment-reply-link" href="#comment-444856" onclick='return addComment.moveForm( "comment-444856", "444856", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-444885">
<div class="comment-container" id="li-comment-444885">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 31, 2018 at 2:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-444885" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It won’t. The encoding will set unknown words to 0.</p>
<p>It really depends on the goal of what you want to evaluate.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444885" onclick='return addComment.moveForm( "comment-444885", "444885", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-444991">
<div class="comment-container" id="li-comment-444991">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b2098fa48745f7167e56689a84716de5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b2098fa48745f7167e56689a84716de5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jaskaran</span>
<span class="date">August 1, 2018 at 5:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-444991" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>i want to train my model to predict the target word given to a 5 word sequence . how can i represent my target word ?</p>
<div class="reply">
<a aria-label="Reply to Jaskaran" class="comment-reply-link" href="#comment-444991" onclick='return addComment.moveForm( "comment-444991", "444991", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-445023">
<div class="comment-container" id="li-comment-445023">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 2, 2018 at 5:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-445023" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Probably using a one hot encoding.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-445023" onclick='return addComment.moveForm( "comment-445023", "445023", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-445132">
<div class="comment-container" id="li-comment-445132">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/789be956b0b02c477d090c5898b24cbf?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/789be956b0b02c477d090c5898b24cbf?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bharath</span>
<span class="date">August 3, 2018 at 12:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-445132" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>This is regarding the output shape of the first embedding layer : (None,4,8).<br/>
Am I correct in understanding that the 4 represents the input size which is 4 words and the 8 is the number of features it has generated using those words?</p>
<div class="reply">
<a aria-label="Reply to Bharath" class="comment-reply-link" href="#comment-445132" onclick='return addComment.moveForm( "comment-445132", "445132", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-445141">
<div class="comment-container" id="li-comment-445141">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 3, 2018 at 2:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-445141" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I believe so.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-445141" onclick='return addComment.moveForm( "comment-445141", "445141", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-445774">
<div class="comment-container" id="li-comment-445774">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c67906672c033a225879944eacddab39?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c67906672c033a225879944eacddab39?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sreenivasa</span>
<span class="date">August 10, 2018 at 7:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-445774" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thanks for sharing your knowledge.<br/>
My task is to classify set of documents into different categories.( I have a training set of 100 documents and say 10 categories).<br/>
The idea is to extract top  M words ( say 20) from the first few lines of each doc, convert words to word embeddings and use it as feature vectors for the neural network.</p>
<p>Question : Since i take top M words from the document, it may not be in the “right” order each time, meaning the there can be different words at a given position in the input layer ( unlike bag of words model). Wont this approach impact the Neural network from converging?</p>
<p>Regards,<br/>
Srini</p>
<div class="reply">
<a aria-label="Reply to Sreenivasa" class="comment-reply-link" href="#comment-445774" onclick='return addComment.moveForm( "comment-445774", "445774", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-445812">
<div class="comment-container" id="li-comment-445812">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 11, 2018 at 6:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-445812" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The key is to assign the same integer value to each word prior to feeding the data into the embedding.</p>
<p>You must use the same text tokenizer for all documents.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-445812" onclick='return addComment.moveForm( "comment-445812", "445812", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-446299">
<div class="comment-container" id="li-comment-446299">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cdc08769d1fd11b353aa9ea0d5f1bea5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cdc08769d1fd11b353aa9ea0d5f1bea5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Fatemeh</span>
<span class="date">August 17, 2018 at 7:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-446299" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thank you for your great explanation. I have used the pre-trained google embedding matrix in my seqtoseq project by using encoder-decoder. but in my test, I have a problem. I don’t know how to make a reverse for my embedding matrix. Do you have a sample project? My solution is: when my decoder predicts a vector, I should search for that in my pre-trained embedding matrix, and then find its index and then understand its related word. Am I right?</p>
<div class="reply">
<a aria-label="Reply to Fatemeh" class="comment-reply-link" href="#comment-446299" onclick='return addComment.moveForm( "comment-446299", "446299", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-446302">
<div class="comment-container" id="li-comment-446302">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 17, 2018 at 7:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-446302" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Why would you need to reverse it?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-446302" onclick='return addComment.moveForm( "comment-446302", "446302", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-450212">
<div class="comment-container" id="li-comment-450212">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b6994d8d3fcd9ab4599383743c916c39?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b6994d8d3fcd9ab4599383743c916c39?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vivien</span>
<span class="date">September 29, 2018 at 1:45 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-450212" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason</p>
<p>Thanks for an excellent tutorial. Using your methods, I’ve converted text into word index and applied word embeddings.</p>
<p>Like Fatemeh, I’m wondering if it’s possible to reverse the process, and convert embedding vectors back into text? This could be useful for applications such as text summarising. </p>
<p>Thank you.</p>
<div class="reply">
<a aria-label="Reply to Vivien" class="comment-reply-link" href="#comment-450212" onclick='return addComment.moveForm( "comment-450212", "450212", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-450285">
<div class="comment-container" id="li-comment-450285">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 30, 2018 at 6:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-450285" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, each vector has an int value known by the embedding and each int has a mapping to a word via the tokenizer.</p>
<p>Random vectors in the space do not, you will have to find the closest vector in the embedding using euclidean distance.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-450285" onclick='return addComment.moveForm( "comment-450285", "450285", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-446396">
<div class="comment-container" id="li-comment-446396">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c58bebf0b133ac8817949ace4735c425?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c58bebf0b133ac8817949ace4735c425?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">fatma</span>
<span class="date">August 18, 2018 at 10:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-446396" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Dr. Jason,</p>
<p>Accuracy: 89.999998 on my Laptop, result different from computer to other?</p>
<div class="reply">
<a aria-label="Reply to fatma" class="comment-reply-link" href="#comment-446396" onclick='return addComment.moveForm( "comment-446396", "446396", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-446445">
<div class="comment-container" id="li-comment-446445">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 19, 2018 at 6:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-446445" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Well done!</p>
<p>Results are different each run, learn more here:<br/>
<a href="https://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">https://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-446445" onclick='return addComment.moveForm( "comment-446445", "446445", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-447493">
<div class="comment-container" id="li-comment-447493">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5eb349a18a8230422729a867ee1a4a33?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5eb349a18a8230422729a867ee1a4a33?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ivan</span>
<span class="date">September 1, 2018 at 2:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-447493" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>So many thanks for this tutorial!</p>
<p>I’ve been trying to train a network that consists of an Embedding layer, an LSTM and a softmax as the output layer. However, it seems that the loss and accuracy get stuck at some point.</p>
<p>Do you have any advice?</p>
<p>Thanks in advance.</p>
<div class="reply">
<a aria-label="Reply to Ivan" class="comment-reply-link" href="#comment-447493" onclick='return addComment.moveForm( "comment-447493", "447493", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-447538">
<div class="comment-container" id="li-comment-447538">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 2, 2018 at 5:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-447538" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, I have a ton of advice right here:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-447538" onclick='return addComment.moveForm( "comment-447538", "447538", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-450033">
<div class="comment-container" id="li-comment-450033">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/34942a3e31fad4c8780d1a18403ca33a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/34942a3e31fad4c8780d1a18403ca33a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aramis</span>
<span class="date">September 28, 2018 at 10:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-450033" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you so much,<br/>
It helped me alot in learning how to use pre trained embbeding in neural nets</p>
<div class="reply">
<a aria-label="Reply to Aramis" class="comment-reply-link" href="#comment-450033" onclick='return addComment.moveForm( "comment-450033", "450033", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-450061">
<div class="comment-container" id="li-comment-450061">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 28, 2018 at 3:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-450061" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m happy to hear that.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-450061" onclick='return addComment.moveForm( "comment-450061", "450061", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-452507">
<div class="comment-container" id="li-comment-452507">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ca49054278358c603ae036e1c2c305dd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ca49054278358c603ae036e1c2c305dd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rafael sa</span>
<span class="date">October 24, 2018 at 5:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-452507" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thank uou for the great materiAl. </p>
<p>I have one doubt, want to make the embedding of a list of 1200 documents to use it as input to a classification model to predict moviebox office based on the moviescript text…<br/>
My question is… if i want to train the embedding with the vocabulary of the real dataset, how can i after classify the rest of the dataset that was not trained ? Can a use the embeddings learned on the training as input to the classification model ?</p>
<div class="reply">
<a aria-label="Reply to Rafael sa" class="comment-reply-link" href="#comment-452507" onclick='return addComment.moveForm( "comment-452507", "452507", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-452527">
<div class="comment-container" id="li-comment-452527">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 24, 2018 at 6:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-452527" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good question.</p>
<p>You must ensure that the training dataset is representative of the broader problem. Any words unseen during training will be marked zero (unknown) by the tokenizer unless you update your model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-452527" onclick='return addComment.moveForm( "comment-452527", "452527", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-453356">
<div class="comment-container" id="li-comment-453356">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ca49054278358c603ae036e1c2c305dd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ca49054278358c603ae036e1c2c305dd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rafael SA</span>
<span class="date">November 1, 2018 at 9:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-453356" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank You Jason. As soon as I get the results I’ll try to share it here.<br/>
I’d like to thank you too about your great platform, it is being very helpful to me.</p>
<div class="reply">
<a aria-label="Reply to Rafael SA" class="comment-reply-link" href="#comment-453356" onclick='return addComment.moveForm( "comment-453356", "453356", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-453394">
<div class="comment-container" id="li-comment-453394">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 2, 2018 at 5:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-453394" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453394" onclick='return addComment.moveForm( "comment-453394", "453394", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-452734">
<div class="comment-container" id="li-comment-452734">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2bd5482dad80a4aa9f356fae623cc4f8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2bd5482dad80a4aa9f356fae623cc4f8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Dimitris</span>
<span class="date">October 26, 2018 at 2:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-452734" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice post once again! It seems that in each batch all embedding are updated which I think it should not happen. You got any idea how to update only the one that are passed each time? That is for computational reasons or others problem definitions related reasons.</p>
<div class="reply">
<a aria-label="Reply to Dimitris" class="comment-reply-link" href="#comment-452734" onclick='return addComment.moveForm( "comment-452734", "452734", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-452762">
<div class="comment-container" id="li-comment-452762">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 26, 2018 at 5:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-452762" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m not sure what you mean exactly, can you elaborate?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-452762" onclick='return addComment.moveForm( "comment-452762", "452762", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-455175">
<div class="comment-container" id="li-comment-455175">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/254cacd7b8f196a8d6951710dd5e748c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/254cacd7b8f196a8d6951710dd5e748c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mahdi</span>
<span class="date">November 18, 2018 at 1:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-455175" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason, i would like to think you for this post, it’s really interresting and understandable.</p>
<p>I’ve reused the script but instead of using “docs” and “labels” lists, i used the IMDB movie reviews dataset. The problem is that i can’t reach more than 50% accuracy and the loss is stable in all epochs to value 0.6932. </p>
<p>What do you think about that ?</p>
<div class="reply">
<a aria-label="Reply to Mahdi" class="comment-reply-link" href="#comment-455175" onclick='return addComment.moveForm( "comment-455175", "455175", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-455235">
<div class="comment-container" id="li-comment-455235">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 18, 2018 at 6:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-455235" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have some suggestions here:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-455235" onclick='return addComment.moveForm( "comment-455235", "455235", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-455256">
<div class="comment-container" id="li-comment-455256">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/254cacd7b8f196a8d6951710dd5e748c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/254cacd7b8f196a8d6951710dd5e748c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mahdi</span>
<span class="date">November 18, 2018 at 9:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-455256" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Okay I’ll check it out, thank you Jason</p>
<div class="reply">
<a aria-label="Reply to Mahdi" class="comment-reply-link" href="#comment-455256" onclick='return addComment.moveForm( "comment-455256", "455256", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-455274">
<div class="comment-container" id="li-comment-455274">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3fccb87b616a0173f2636c59feb950e1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3fccb87b616a0173f2636c59feb950e1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mehran</span>
<span class="date">November 18, 2018 at 12:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-455274" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the article. Could you also provide an example of how to train a model with only one Embedding layer? I’m trying to do the same with Keras but the problem is that the fit method asks for labels which I don’t have. I mean I only have a bunch of text files that I’m trying to come up with the mapping for.</p>
<div class="reply">
<a aria-label="Reply to Mehran" class="comment-reply-link" href="#comment-455274" onclick='return addComment.moveForm( "comment-455274", "455274", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-455429">
<div class="comment-container" id="li-comment-455429">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 19, 2018 at 6:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-455429" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Models typically only have one embedding layer. What do you mean exactly?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-455429" onclick='return addComment.moveForm( "comment-455429", "455429", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-455836">
<div class="comment-container" id="li-comment-455836">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/feaed368ab0bf464445cea186bb873f4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/feaed368ab0bf464445cea186bb873f4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vishal</span>
<span class="date">November 22, 2018 at 4:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-455836" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello,</p>
<p>Thank you for the excellent explanation!</p>
<p>I have a few questions related to unknown words.</p>
<p>Some pretrained word embeddings like the GoogleNews embeddings have an embedding vector for a token called ‘UNKNOWN’ as well.</p>
<p>1. Can I use this vector to represent words that are not present in the training set instead of the vector of all zeros? If so, how should I go about loading this vector into the Keras Embedding layer? Should it be loaded at the 0th index in the embedding matrix?</p>
<p>2. Also, can I use the Tokenizer API to help me convert all unknown words (words not in the training set) to ‘UNKNOWN’?</p>
<p>Thank you.</p>
<div class="reply">
<a aria-label="Reply to Vishal" class="comment-reply-link" href="#comment-455836" onclick='return addComment.moveForm( "comment-455836", "455836", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-455882">
<div class="comment-container" id="li-comment-455882">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 23, 2018 at 7:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-455882" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, find the integer value for the unknown word and use that to assign to all words not in the vocab.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-455882" onclick='return addComment.moveForm( "comment-455882", "455882", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-456333">
<div class="comment-container" id="li-comment-456333">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/241e235aafd0c9e68ebae34436cf0776?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/241e235aafd0c9e68ebae34436cf0776?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Saurabh</span>
<span class="date">November 27, 2018 at 4:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-456333" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
If word embedding doesn’t contain a word we input to a model , How to address this issue?<br/>
1) Is it possible  to load additional words (besides those in our vocabulary) in embedding matrix.<br/>
Or may be any other elegant way you would like to suggest?</p>
<div class="reply">
<a aria-label="Reply to Saurabh" class="comment-reply-link" href="#comment-456333" onclick='return addComment.moveForm( "comment-456333", "456333", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-456409">
<div class="comment-container" id="li-comment-456409">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 28, 2018 at 7:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-456409" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It is marked as “unknown”.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-456409" onclick='return addComment.moveForm( "comment-456409", "456409", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-456481">
<div class="comment-container" id="li-comment-456481">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5fd0835f6fe760e6835baf13d9ddae89?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5fd0835f6fe760e6835baf13d9ddae89?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">mohammad</span>
<span class="date">November 28, 2018 at 11:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-456481" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi .thanks a lot for your post . i’m new in python and deep learning !</p>
<p>i have 240,000 tweet train set “50 % male and 50% female” class . and 120,000 tweet test set   ” 50 % male and 50% female”. i want use lstm in python bud i have following error at ” fit ” method : </p>
<p>  ValueError: Error when checking input: expected lstm_16_input to have 3 dimensions, but got array with shape (120000, 400)</p>
<p>can you help me?</p>
<div class="reply">
<a aria-label="Reply to mohammad" class="comment-reply-link" href="#comment-456481" onclick='return addComment.moveForm( "comment-456481", "456481", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-456534">
<div class="comment-container" id="li-comment-456534">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 29, 2018 at 7:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-456534" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It looks like a mismatch between your data and the model, you can change the data or change the model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-456534" onclick='return addComment.moveForm( "comment-456534", "456534", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-457288">
<div class="comment-container" id="li-comment-457288">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e3207065792942ab56a561ddd3497030?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e3207065792942ab56a561ddd3497030?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mohamed</span>
<span class="date">December 5, 2018 at 3:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-457288" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, Thanks for this article.</p>
<p>I am getting this error </p>
<p>TypeError: ‘OneHotEncoder’ object is not callable</p>
<p>How oto overcome?</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Mohamed" class="comment-reply-link" href="#comment-457288" onclick='return addComment.moveForm( "comment-457288", "457288", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-457319">
<div class="comment-container" id="li-comment-457319">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 5, 2018 at 6:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-457319" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have some suggestions here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-457319" onclick='return addComment.moveForm( "comment-457319", "457319", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-457576">
<div class="comment-container" id="li-comment-457576">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/269807fdbc7a5137ec2ed4e524e914c3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/269807fdbc7a5137ec2ed4e524e914c3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://-" rel="external nofollow">Rushi</a></span>
<span class="date">December 6, 2018 at 5:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-457576" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi , i have 2 models with this embedding layers , how do i merge those model ?</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Rushi" class="comment-reply-link" href="#comment-457576" onclick='return addComment.moveForm( "comment-457576", "457576", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-457695">
<div class="comment-container" id="li-comment-457695">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 7, 2018 at 5:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-457695" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What do you mean exactly? An ensemble model?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-457695" onclick='return addComment.moveForm( "comment-457695", "457695", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-457649">
<div class="comment-container" id="li-comment-457649">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/880b49abc4799b547159bb8ce4cb5242?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/880b49abc4799b547159bb8ce4cb5242?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Utkarsh Rai</span>
<span class="date">December 7, 2018 at 12:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-457649" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi Jason, greate tutorial, i am very new to all this. I have a query, u r using glove for the embedding layer but during fitting u are directly  using padded_docs. The vectors  in padded_docs have no co-relation to glove. I am sure that i am missing something plz enlighten.</p>
<div class="reply">
<a aria-label="Reply to Utkarsh Rai" class="comment-reply-link" href="#comment-457649" onclick='return addComment.moveForm( "comment-457649", "457649", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-457703">
<div class="comment-container" id="li-comment-457703">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 7, 2018 at 5:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-457703" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The padding just adds ‘0’ to ensure the sequences are the same length. It does not effect the encoding.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-457703" onclick='return addComment.moveForm( "comment-457703", "457703", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-457786">
<div class="comment-container" id="li-comment-457786">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5598a7d1ae0bb9003bed9dc9b1e99325?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5598a7d1ae0bb9003bed9dc9b1e99325?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Eduardo Andrade</span>
<span class="date">December 7, 2018 at 3:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-457786" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason. Considering the “3. Example of Learning an Embedding”, I’m adding “model.add(LSTM(32, return_sequences=True))” after the embedding layer and I would like to understand what happens. The number of parameters returned for this LSTM layer is “5248” and I don’t know how to calculate it. Thank you.</p>
<div class="reply">
<a aria-label="Reply to Eduardo Andrade" class="comment-reply-link" href="#comment-457786" onclick='return addComment.moveForm( "comment-457786", "457786", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-457858">
<div class="comment-container" id="li-comment-457858">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 8, 2018 at 6:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/#comment-457858" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Each unit in the LSTM will take the entire embedding as input, therefore must have one weight for each dimension in the embedding.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-457858" onclick='return addComment.moveForm( "comment-457858", "457858", "respond", "4346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/use-word-embedding-layers-deep-learning-keras/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="4346"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="722e5ea1d0"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="123"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery!</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Jason Brownlee, PhD
<br/>
I write tutorials to help developers (<i>like you</i>) get results with machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-43"> <div class="textwidget"><p></p><center><br/>
<strong>Deep Learning for NLP</strong><br/>
Develop deep learning models for text data.
<p><a href="/deep-learning-for-nlp/">Click to Get Started Now!</a><br/>
<a href="/deep-learning-for-nlp/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/11/DLFNLP-Cover-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch"><img alt="How to Develop a Neural Machine Translation System in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/01/How-to-Develop-a-Neural-Machine-Translation-System-in-Keras-150x150.jpg" title="How to Develop a Neural Machine Translation System from Scratch" width="45"/></a> <a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch">How to Develop a Neural Machine Translation System from Scratch</a>
<span class="meta">January 10, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning"><img alt="Difference Between Classification and Regression in Machine Learning" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/Difference-Between-Classification-and-Regression-in-Machine-Learning-150x150.jpg" title="Difference Between Classification and Regression in Machine Learning" width="45"/></a> <a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning">Difference Between Classification and Regression in Machine Learning</a>
<span class="meta">December 11, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem..."><img alt="So, You are Working on a Machine Learning Problem..." class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/So-You-are-Working-on-a-Machine-Learning-Problem...-150x150.jpg" title="So, You are Working on a Machine Learning Problem..." width="45"/></a> <a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem…">So, You are Working on a Machine Learning Problem…</a>
<span class="meta">April 4, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis"><img alt="Plot of the Multichannel Convolutional Neural Network For Text" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-150x150.png" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis" width="45"/></a> <a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis">How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis</a>
<span class="meta">January 12, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras"><img alt="How to Make Classification and Regression Predictions for Deep Learning Models in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/How-to-Make-Classification-and-Regression-Predictions-for-Deep-Learning-Models-in-Keras-150x150.jpg" title="How to Make Predictions with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras">How to Make Predictions with Keras</a>
<span class="meta">April 9, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)"><img alt="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/11-Classical-Time-Series-Forecasting-Methods-in-Python-Cheat-Sheet-150x150.jpg" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)">11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)</a>
<span class="meta">August 6, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras"><img alt="How to Visualize a Deep Learning Neural Network Model in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/How-to-Visualize-a-Deep-Learning-Neural-Network-Model-in-Keras-150x150.jpg" title="How to Visualize a Deep Learning Neural Network Model in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras">How to Visualize a Deep Learning Neural Network Model in Keras</a>
<span class="meta">December 13, 2017</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> <div class="widget_text widget widget_custom_html" id="custom_html-2"><h3>You might also like…</h3><div class="textwidget custom-html-widget"><ul>
<li><a href="/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Install Python for Machine Learning</a></li>
<li><a href="/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python</a></li>
<li><a href="/tutorial-first-neural-network-python-keras/">Your First Neural Network in Python</a></li>
<li><a href="/how-to-run-your-first-classifier-in-weka/">Your First Classifier in Weka</a></li>
<li><a href="/arima-for-time-series-forecasting-with-python/">Your First Time Series Forecasting Project</a></li>
</ul></div></div></aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/disclaimer/">Disclaimer</a> | 
<a href="/terms-of-service/">Terms</a> | 
<a href="/contact/">Contact</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.8" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.0.5" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.8" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.1" type="text/javascript"></script>
</body>
</html>