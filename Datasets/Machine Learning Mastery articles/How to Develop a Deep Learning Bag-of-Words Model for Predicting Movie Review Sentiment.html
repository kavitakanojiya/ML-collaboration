<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v9.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>How to Develop a Deep Learning Bag-of-Words Model for Predicting Movie Review Sentiment</title>
<link href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="How to Develop a Deep Learning Bag-of-Words Model for Predicting Movie Review Sentiment" property="og:title"/>
<meta content="Movie reviews can be classified as either favorable or not. The evaluation of movie review text is a classification problem often called sentiment analysis. A popular technique for developing sentiment analysis models is to use a bag-of-words model that transforms documents into vectors where each word in the document is assigned a score. In this …" property="og:description"/>
<meta content="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="https://www.facebook.com/jason.brownlee.39" property="article:author"/>
<meta content="Deep Learning for Natural Language Processing" property="article:section"/>
<meta content="2017-10-19T18:00:01+00:00" property="article:published_time"/>
<meta content="2018-02-13T23:56:06+00:00" property="article:modified_time"/>
<meta content="2018-02-13T23:56:06+00:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/How-to-Develop-a-Deep-Learning-Bag-of-Words-Model-for-Predicting-Sentiment-in-Movie-Reviews.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/How-to-Develop-a-Deep-Learning-Bag-of-Words-Model-for-Predicting-Sentiment-in-Movie-Reviews.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="425" property="og:image:height"/>
<meta content="How to Develop a Deep Learning Bag-of-Words Model for Predicting Sentiment in Movie Reviews" property="og:image:alt"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"https:\/\/machinelearningmastery.com\/#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/feed/" rel="alternate" title="Machine Learning Mastery » How to Develop a Deep Learning Bag-of-Words Model for Predicting Movie Review Sentiment Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<style media="all" type="text/css">
.wpautoterms-footer{background-color:#ffffff;text-align:center;}
.wpautoterms-footer a{color:#000000;font-family:Arial, sans-serif;font-size:14px;}
.wpautoterms-footer .separator{color:#cccccc;font-family:Arial, sans-serif;font-size:14px;}</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/auto-terms-of-service-and-privacy-policy/css/wpautoterms.css?ver=4.9.8" id="wpautoterms_css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.0.5" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/css/front.css?ver=2.0.20" id="ssb-front-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/ewd-ufaq-styles.css?ver=4.9.8" id="ewd-ufaq-style-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/rrssb-min.css?ver=4.9.8" id="ewd-ufaq-rrssb-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.8" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=2.0.20" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.8" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.8" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=4375" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fdeep-learning-bag-of-words-model-sentiment-analysis%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fdeep-learning-bag-of-words-model-sentiment-analysis%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<style media="screen">

        .simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
      margin: ;
    }
         /*inline margin*/
    
  
  
  
  
  
          .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
         margin: ;
     }

          /*margin-digbar*/

  
  
  
  
 
   
   

</style>
<script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#4c89bf; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#4c89bf;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#4c89bf!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#ffffff;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-4375 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/icon-100x100.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-44"> <div class="textwidget"><p>Want help with deep learning for text? <a href="https://machinelearningmastery.lpages.co/dlfnlp-mini-course/">Take the FREE Mini-Course</a></p>
</div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<input name="post_type" type="hidden" value="post"/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Main Menu</h3><ul class="nav fl" id="main-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503" id="menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Start Here</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501" id="menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506" id="menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508" id="menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (Keras)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511" id="menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509" id="menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6515" id="menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">Deep Learning for NLP</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512" id="menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Understand Algorithms</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507" id="menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms (Python)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6513" id="menu-item-6513"><a href="https://machinelearningmastery.com/category/machine-learning-process/">Machine Learning Process</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516" id="menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517" id="menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522" id="menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6518" id="menu-item-6518"><a href="https://machinelearningmastery.com/category/start-machine-learning/">Getting Started</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510" id="menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519" id="menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistical Methods</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520" id="menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Time Series (introductory)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523" id="menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6514" id="menu-item-6514"><a href="https://machinelearningmastery.com/category/machine-learning-resources/">Resources</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502" id="menu-item-6502"><a href="https://machinelearningmastery.com/products/">Ebooks</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500" id="menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504" id="menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505" id="menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-4375 post type-post status-publish format-standard has-post-thumbnail hentry category-natural-language-processing">
<header>
<h1 class="title entry-title">How to Develop a Deep Learning Bag-of-Words Model for Predicting Movie Review Sentiment</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2017-10-20T05:00:01+1100">October 20, 2017</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/natural-language-processing/" title="View all items in Deep Learning for Natural Language Processing">Deep Learning for Natural Language Processing</a></span> </div>
<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-4375 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Develop+a+Deep+Learning+Bag-of-Words+Model+for+Predicting+Movie+Review+Sentiment&amp;url=https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
<p>Movie reviews can be classified as either favorable or not.</p>
<p>The evaluation of movie review text is a classification problem often called sentiment analysis. A popular technique for developing sentiment analysis models is to use a bag-of-words model that transforms documents into vectors where each word in the document is assigned a score.</p>
<p>In this tutorial, you will discover how you can develop a deep learning predictive model using the bag-of-words representation for movie review sentiment classification.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>How to prepare the review text data for modeling with a restricted vocabulary.</li>
<li>How to use the bag-of-words model to prepare train and test data.</li>
<li>How to develop a multilayer Perceptron bag-of-words model and use it to make predictions on new review text data.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Oct/2017</strong>: Fixed a minor typo when loading and naming positive and negative reviews (thanks Arthur).</li>
</ul>
<div class="wp-caption aligncenter" id="attachment_4377" style="width: 650px"><img alt="How to Develop a Deep Learning Bag-of-Words Model for Predicting Sentiment in Movie Reviews" class="size-full wp-image-4377" height="425" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/How-to-Develop-a-Deep-Learning-Bag-of-Words-Model-for-Predicting-Sentiment-in-Movie-Reviews.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/How-to-Develop-a-Deep-Learning-Bag-of-Words-Model-for-Predicting-Sentiment-in-Movie-Reviews.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/How-to-Develop-a-Deep-Learning-Bag-of-Words-Model-for-Predicting-Sentiment-in-Movie-Reviews-300x199.jpg 300w" width="640"/><p class="wp-caption-text">How to Develop a Deep Learning Bag-of-Words Model for Predicting Sentiment in Movie Reviews<br/>Photo by <a href="https://www.flickr.com/photos/75348994@N00/302260108/">jai Mansson</a>, some rights reserved.</p></div>
<h2>Tutorial Overview</h2>
<p>This tutorial is divided into 4 parts; they are:</p>
<ol>
<li>Movie Review Dataset</li>
<li>Data Preparation</li>
<li>Bag-of-Words Representation</li>
<li>Sentiment Analysis Models</li>
</ol>
<p></p><div class="woo-sc-hr"></div>
<center>
<h3>Need help with Deep Learning for Text Data?</h3>
<p>Take my free 7-day email crash course now (with code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.lpages.co/leadbox/144855173f72a2%3A164f8be4f346dc/5655638436741120/" rel="noopener" style="background: #ffce0a; color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.25) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.5) 0px 1px 3px inset, rgba(0, 0, 0, 0.5) 0px 1px 3px;" target="_blank">Start Your FREE Crash-Course Now</a><script data-config="%7B%7D" data-leadbox="144855173f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.lpages.co/leadbox/144855173f72a2%3A164f8be4f346dc/5655638436741120/" src="https://machinelearningmastery.lpages.co/leadbox-1509466860.js" type="text/javascript"></script></p>
</center>
<p></p><div class="woo-sc-hr"></div>
<h2>Movie Review Dataset</h2>
<p>The Movie Review Data is a collection of movie reviews retrieved from the imdb.com website in the early 2000s by Bo Pang and Lillian Lee. The reviews were collected and made available as part of their research on natural language processing.</p>
<p>The reviews were originally released in 2002, but an updated and cleaned up version were released in 2004, referred to as “v2.0”.</p>
<p>The dataset is comprised of 1,000 positive and 1,000 negative movie reviews drawn from an archive of the rec.arts.movies.reviews newsgroup hosted at <a href="http://reviews.imdb.com/Reviews">imdb.com</a>. The authors refer to this dataset as the “polarity dataset”.</p>
<blockquote><p>Our data contains 1000 positive and 1000 negative reviews all written before 2002, with a cap of 20 reviews per author (312 authors total) per category. We refer to this corpus as the polarity dataset.</p></blockquote>
<p>— <a href="http://xxx.lanl.gov/abs/cs/0409058">A Sentimental Education: Sentiment Analysis Using Subjectivity Summarization Based on Minimum Cuts</a>, 2004.</p>
<p>The data has been cleaned up somewhat, for example:</p>
<ul>
<li>The dataset is comprised of only English reviews.</li>
<li>All text has been converted to lowercase.</li>
<li>There is white space around punctuation like periods, commas, and brackets.</li>
<li>Text has been split into one sentence per line.</li>
</ul>
<p>The data has been used for a few related natural language processing tasks. For classification, the performance of classical models (such as Support Vector Machines) on the data is in the range of high 70% to low 80% (e.g. 78%-82%).</p>
<p>More sophisticated data preparation may see results as high as 86% with 10-fold cross validation. This gives us a ballpark of low-to-mid 80s if we were looking to use this dataset in experiments on modern methods.</p>
<blockquote><p>… depending on choice of downstream polarity classifier, we can achieve highly statistically significant improvement (from 82.8% to 86.4%)</p></blockquote>
<p>— <a href="http://xxx.lanl.gov/abs/cs/0409058">A Sentimental Education: Sentiment Analysis Using Subjectivity Summarization Based on Minimum Cuts</a>, 2004.</p>
<p>You can download the dataset from here:</p>
<ul>
<li><a href="http://www.cs.cornell.edu/people/pabo/movie-review-data/review_polarity.tar.gz">Movie Review Polarity Dataset</a> (review_polarity.tar.gz, 3MB)</li>
</ul>
<p>After unzipping the file, you will have a directory called “txt_sen<em>t</em>oken” with two sub-directories containing the text “<em>neg</em>” and “<em>pos</em>” for negative and positive reviews. Reviews are stored one per file with a naming convention <em>cv000</em> to <em>cv999</em> for each neg and pos.</p>
<p>Next, let’s look at loading and preparing the text data.</p>
<h2>Data Preparation</h2>
<p>In this section, we will look at 3 things:</p>
<ol>
<li>Separation of data into training and test sets.</li>
<li>Loading and cleaning the data to remove punctuation and numbers.</li>
<li>Defining a vocabulary of preferred words.</li>
</ol>
<h3>Split into Train and Test Sets</h3>
<p>We are pretending that we are developing a system that can predict the sentiment of a textual movie review as either positive or negative.</p>
<p>This means that after the model is developed, we will need to make predictions on new textual reviews. This will require all of the same data preparation to be performed on those new reviews as is performed on the training data for the model.</p>
<p>We will ensure that this constraint is built into the evaluation of our models by splitting the training and test datasets prior to any data preparation. This means that any knowledge in the test set that could help us better prepare the data (e.g. the words used) is unavailable during the preparation of data and the training of the model.</p>
<p>That being said, we will use the last 100 positive reviews and the last 100 negative reviews as a test set (100 reviews) and the remaining 1,800 reviews as the training dataset.</p>
<p>This is a 90% train, 10% split of the data.</p>
<p>The split can be imposed easily by using the filenames of the reviews where reviews named 000 to 899 are for training data and reviews named 900 onwards are for testing the model.</p>
<h3>Loading and Cleaning Reviews</h3>
<p>The text data is already pretty clean, so not much preparation is required.</p>
<p>Without getting too much into the details, we will prepare the data using the following method:</p>
<ul>
<li>Split tokens on white space.</li>
<li>Remove all punctuation from words.</li>
<li>Remove all words that are not purely comprised of alphabetical characters.</li>
<li>Remove all words that are known stop words.</li>
<li>Remove all words that have a length &lt;= 1 character.</li>
</ul>
<p>We can put all of these steps into a function called clean_doc() that takes as an argument the raw text loaded from a file and returns a list of cleaned tokens. We can also define a function load_doc() that loads a document from file ready for use with the clean_doc() function.</p>
<p>An example of cleaning the first positive review is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf325754746532" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from nltk.corpus import stopwords
import string

# load doc into memory
def load_doc(filename):
	# open the file as read only
	file = open(filename, 'r')
	# read all text
	text = file.read()
	# close the file
	file.close()
	return text

# turn a doc into clean tokens
def clean_doc(doc):
	# split into tokens by white space
	tokens = doc.split()
	# remove punctuation from each token
	table = str.maketrans('', '', string.punctuation)
	tokens = [w.translate(table) for w in tokens]
	# remove remaining tokens that are not alphabetic
	tokens = [word for word in tokens if word.isalpha()]
	# filter out stop words
	stop_words = set(stopwords.words('english'))
	tokens = [w for w in tokens if not w in stop_words]
	# filter out short tokens
	tokens = [word for word in tokens if len(word) &gt; 1]
	return tokens

# load the document
filename = 'txt_sentoken/pos/cv000_29590.txt'
text = load_doc(filename)
tokens = clean_doc(text)
print(tokens)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf325754746532-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf325754746532-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf325754746532-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf325754746532-4">4</div><div class="crayon-num" data-line="crayon-5c0caa5cbf325754746532-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf325754746532-6">6</div><div class="crayon-num" data-line="crayon-5c0caa5cbf325754746532-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf325754746532-8">8</div><div class="crayon-num" data-line="crayon-5c0caa5cbf325754746532-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf325754746532-10">10</div><div class="crayon-num" data-line="crayon-5c0caa5cbf325754746532-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf325754746532-12">12</div><div class="crayon-num" data-line="crayon-5c0caa5cbf325754746532-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf325754746532-14">14</div><div class="crayon-num" data-line="crayon-5c0caa5cbf325754746532-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf325754746532-16">16</div><div class="crayon-num" data-line="crayon-5c0caa5cbf325754746532-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf325754746532-18">18</div><div class="crayon-num" data-line="crayon-5c0caa5cbf325754746532-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf325754746532-20">20</div><div class="crayon-num" data-line="crayon-5c0caa5cbf325754746532-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf325754746532-22">22</div><div class="crayon-num" data-line="crayon-5c0caa5cbf325754746532-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf325754746532-24">24</div><div class="crayon-num" data-line="crayon-5c0caa5cbf325754746532-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf325754746532-26">26</div><div class="crayon-num" data-line="crayon-5c0caa5cbf325754746532-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf325754746532-28">28</div><div class="crayon-num" data-line="crayon-5c0caa5cbf325754746532-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf325754746532-30">30</div><div class="crayon-num" data-line="crayon-5c0caa5cbf325754746532-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf325754746532-32">32</div><div class="crayon-num" data-line="crayon-5c0caa5cbf325754746532-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf325754746532-34">34</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf325754746532-1"><span class="crayon-e">from </span><span class="crayon-v">nltk</span><span class="crayon-sy">.</span><span class="crayon-e">corpus </span><span class="crayon-e">import </span><span class="crayon-e">stopwords</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf325754746532-2"><span class="crayon-e">import </span><span class="crayon-t">string</span></div><div class="crayon-line" id="crayon-5c0caa5cbf325754746532-3"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf325754746532-4"><span class="crayon-p"># load doc into memory</span></div><div class="crayon-line" id="crayon-5c0caa5cbf325754746532-5"><span class="crayon-e">def </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf325754746532-6"><span class="crayon-h"> </span><span class="crayon-p"># open the file as read only</span></div><div class="crayon-line" id="crayon-5c0caa5cbf325754746532-7"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf325754746532-8"><span class="crayon-h"> </span><span class="crayon-p"># read all text</span></div><div class="crayon-line" id="crayon-5c0caa5cbf325754746532-9"><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf325754746532-10"><span class="crayon-h"> </span><span class="crayon-p"># close the file</span></div><div class="crayon-line" id="crayon-5c0caa5cbf325754746532-11"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf325754746532-12"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">text</span></div><div class="crayon-line" id="crayon-5c0caa5cbf325754746532-13"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf325754746532-14"><span class="crayon-p"># turn a doc into clean tokens</span></div><div class="crayon-line" id="crayon-5c0caa5cbf325754746532-15"><span class="crayon-e">def </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf325754746532-16"><span class="crayon-h"> </span><span class="crayon-p"># split into tokens by white space</span></div><div class="crayon-line" id="crayon-5c0caa5cbf325754746532-17"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf325754746532-18"><span class="crayon-h"> </span><span class="crayon-p"># remove punctuation from each token</span></div><div class="crayon-line" id="crayon-5c0caa5cbf325754746532-19"><span class="crayon-h"> </span><span class="crayon-v">table</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">str</span><span class="crayon-sy">.</span><span class="crayon-e">maketrans</span><span class="crayon-sy">(</span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">string</span><span class="crayon-sy">.</span><span class="crayon-v">punctuation</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf325754746532-20"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">w</span><span class="crayon-sy">.</span><span class="crayon-e">translate</span><span class="crayon-sy">(</span><span class="crayon-v">table</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa5cbf325754746532-21"><span class="crayon-h"> </span><span class="crayon-p"># remove remaining tokens that are not alphabetic</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf325754746532-22"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-sy">.</span><span class="crayon-e">isalpha</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa5cbf325754746532-23"><span class="crayon-h"> </span><span class="crayon-p"># filter out stop words</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf325754746532-24"><span class="crayon-h"> </span><span class="crayon-v">stop_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">stopwords</span><span class="crayon-sy">.</span><span class="crayon-e">words</span><span class="crayon-sy">(</span><span class="crayon-s">'english'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf325754746532-25"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">stop_words</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf325754746532-26"><span class="crayon-h"> </span><span class="crayon-p"># filter out short tokens</span></div><div class="crayon-line" id="crayon-5c0caa5cbf325754746532-27"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-t">word</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf325754746532-28"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span></div><div class="crayon-line" id="crayon-5c0caa5cbf325754746532-29"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf325754746532-30"><span class="crayon-p"># load the document</span></div><div class="crayon-line" id="crayon-5c0caa5cbf325754746532-31"><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'txt_sentoken/pos/cv000_29590.txt'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf325754746532-32"><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf325754746532-33"><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">text</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf325754746532-34"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0017 seconds] -->
<p>Running the example prints a long list of clean tokens.</p>
<p>There are many more cleaning steps we may want to explore, and I leave them as further exercises. I’d love to see what you can come up with.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf32d026965453" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
...
'creepy', 'place', 'even', 'acting', 'hell', 'solid', 'dreamy', 'depp', 'turning', 'typically', 'strong', 'performance', 'deftly', 'handling', 'british', 'accent', 'ians', 'holm', 'joe', 'goulds', 'secret', 'richardson', 'dalmatians', 'log', 'great', 'supporting', 'roles', 'big', 'surprise', 'graham', 'cringed', 'first', 'time', 'opened', 'mouth', 'imagining', 'attempt', 'irish', 'accent', 'actually', 'wasnt', 'half', 'bad', 'film', 'however', 'good', 'strong', 'violencegore', 'sexuality', 'language', 'drug', 'content']</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf32d026965453-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf32d026965453-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf32d026965453-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf32d026965453-2">'creepy', 'place', 'even', 'acting', 'hell', 'solid', 'dreamy', 'depp', 'turning', 'typically', 'strong', 'performance', 'deftly', 'handling', 'british', 'accent', 'ians', 'holm', 'joe', 'goulds', 'secret', 'richardson', 'dalmatians', 'log', 'great', 'supporting', 'roles', 'big', 'surprise', 'graham', 'cringed', 'first', 'time', 'opened', 'mouth', 'imagining', 'attempt', 'irish', 'accent', 'actually', 'wasnt', 'half', 'bad', 'film', 'however', 'good', 'strong', 'violencegore', 'sexuality', 'language', 'drug', 'content']</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h3>Define a Vocabulary</h3>
<p>It is important to define a vocabulary of known words when using a bag-of-words model.</p>
<p>The more words, the larger the representation of documents, therefore it is important to constrain the words to only those believed to be predictive. This is difficult to know beforehand and often it is important to test different hypotheses about how to construct a useful vocabulary.</p>
<p>We have already seen how we can remove punctuation and numbers from the vocabulary in the previous section. We can repeat this for all documents and build a set of all known words.</p>
<p>We can develop a vocabulary as a <em>Counter</em>, which is a dictionary mapping of words and their count that allows us to easily update and query.</p>
<p>Each document can be added to the counter (a new function called <em>add_doc_to_vocab()</em>) and we can step over all of the reviews in the negative directory and then the positive directory (a new function called <em>process_docs()</em>).</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf330084965504" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from string import punctuation
from os import listdir
from collections import Counter
from nltk.corpus import stopwords

# load doc into memory
def load_doc(filename):
	# open the file as read only
	file = open(filename, 'r')
	# read all text
	text = file.read()
	# close the file
	file.close()
	return text

# turn a doc into clean tokens
def clean_doc(doc):
	# split into tokens by white space
	tokens = doc.split()
	# remove punctuation from each token
	table = str.maketrans('', '', punctuation)
	tokens = [w.translate(table) for w in tokens]
	# remove remaining tokens that are not alphabetic
	tokens = [word for word in tokens if word.isalpha()]
	# filter out stop words
	stop_words = set(stopwords.words('english'))
	tokens = [w for w in tokens if not w in stop_words]
	# filter out short tokens
	tokens = [word for word in tokens if len(word) &gt; 1]
	return tokens

# load doc and add to vocab
def add_doc_to_vocab(filename, vocab):
	# load doc
	doc = load_doc(filename)
	# clean doc
	tokens = clean_doc(doc)
	# update counts
	vocab.update(tokens)

# load all docs in a directory
def process_docs(directory, vocab):
	# walk through all files in the folder
	for filename in listdir(directory):
		# skip any reviews in the test set
		if filename.startswith('cv9'):
			continue
		# create the full path of the file to open
		path = directory + '/' + filename
		# add doc to vocab
		add_doc_to_vocab(path, vocab)

# define vocab
vocab = Counter()
# add all docs to vocab
process_docs('txt_sentoken/pos', vocab)
process_docs('txt_sentoken/neg', vocab)
# print the size of the vocab
print(len(vocab))
# print the top words in the vocab
print(vocab.most_common(50))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-4">4</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-6">6</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-8">8</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-10">10</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-12">12</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-14">14</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-16">16</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-18">18</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-20">20</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-22">22</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-24">24</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-26">26</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-28">28</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-30">30</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-32">32</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-34">34</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-36">36</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-38">38</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-40">40</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-42">42</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-44">44</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-46">46</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-48">48</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-50">50</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-52">52</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-54">54</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-56">56</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-58">58</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf330084965504-60">60</div><div class="crayon-num" data-line="crayon-5c0caa5cbf330084965504-61">61</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-1"><span class="crayon-e">from </span><span class="crayon-t">string</span><span class="crayon-h"> </span><span class="crayon-e">import </span><span class="crayon-e">punctuation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-2"><span class="crayon-e">from </span><span class="crayon-e">os </span><span class="crayon-e">import </span><span class="crayon-e">listdir</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-3"><span class="crayon-e">from </span><span class="crayon-e">collections </span><span class="crayon-e">import </span><span class="crayon-e">Counter</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-4"><span class="crayon-e">from </span><span class="crayon-v">nltk</span><span class="crayon-sy">.</span><span class="crayon-e">corpus </span><span class="crayon-e">import </span><span class="crayon-v">stopwords</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-5"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-6"><span class="crayon-p"># load doc into memory</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-7"><span class="crayon-e">def </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-8"><span class="crayon-h"> </span><span class="crayon-p"># open the file as read only</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-9"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-10"><span class="crayon-h"> </span><span class="crayon-p"># read all text</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-11"><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-12"><span class="crayon-h"> </span><span class="crayon-p"># close the file</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-13"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-14"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">text</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-15"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-16"><span class="crayon-p"># turn a doc into clean tokens</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-17"><span class="crayon-e">def </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-18"><span class="crayon-h"> </span><span class="crayon-p"># split into tokens by white space</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-19"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-20"><span class="crayon-h"> </span><span class="crayon-p"># remove punctuation from each token</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-21"><span class="crayon-h"> </span><span class="crayon-v">table</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">str</span><span class="crayon-sy">.</span><span class="crayon-e">maketrans</span><span class="crayon-sy">(</span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">punctuation</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-22"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">w</span><span class="crayon-sy">.</span><span class="crayon-e">translate</span><span class="crayon-sy">(</span><span class="crayon-v">table</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-23"><span class="crayon-h"> </span><span class="crayon-p"># remove remaining tokens that are not alphabetic</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-24"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-sy">.</span><span class="crayon-e">isalpha</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-25"><span class="crayon-h"> </span><span class="crayon-p"># filter out stop words</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-26"><span class="crayon-h"> </span><span class="crayon-v">stop_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">stopwords</span><span class="crayon-sy">.</span><span class="crayon-e">words</span><span class="crayon-sy">(</span><span class="crayon-s">'english'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-27"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">stop_words</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-28"><span class="crayon-h"> </span><span class="crayon-p"># filter out short tokens</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-29"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-t">word</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-30"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-31"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-32"><span class="crayon-p"># load doc and add to vocab</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-33"><span class="crayon-e">def </span><span class="crayon-e">add_doc_to_vocab</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-34"><span class="crayon-h"> </span><span class="crayon-p"># load doc</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-35"><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-36"><span class="crayon-h"> </span><span class="crayon-p"># clean doc</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-37"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-38"><span class="crayon-h"> </span><span class="crayon-p"># update counts</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-39"><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">.</span><span class="crayon-e">update</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-40"> </div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-41"><span class="crayon-p"># load all docs in a directory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-42"><span class="crayon-e">def </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-43"><span class="crayon-h"> </span><span class="crayon-p"># walk through all files in the folder</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-44"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">filename </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-45"><span class="crayon-h"> </span><span class="crayon-p"># skip any reviews in the test set</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-46"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-47"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-48"><span class="crayon-h"> </span><span class="crayon-p"># create the full path of the file to open</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-49"><span class="crayon-h"> </span><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'/'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">filename</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-50"><span class="crayon-h"> </span><span class="crayon-p"># add doc to vocab</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-51"><span class="crayon-h"> </span><span class="crayon-e">add_doc_to_vocab</span><span class="crayon-sy">(</span><span class="crayon-v">path</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-52"> </div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-53"><span class="crayon-p"># define vocab</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-54"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Counter</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-55"><span class="crayon-p"># add all docs to vocab</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-56"><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/pos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-57"><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/neg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-58"><span class="crayon-p"># print the size of the vocab</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-59"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf330084965504-60"><span class="crayon-p"># print the top words in the vocab</span></div><div class="crayon-line" id="crayon-5c0caa5cbf330084965504-61"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">vocab</span><span class="crayon-sy">.</span><span class="crayon-e">most_common</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0023 seconds] -->
<p>Running the example shows that we have a vocabulary of 44,276 words.</p>
<p>We also can see a sample of the top 50 most used words in the movie reviews.</p>
<p>Note that this vocabulary was constructed based on only those reviews in the training dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf332663444447" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
44276
[('film', 7983), ('one', 4946), ('movie', 4826), ('like', 3201), ('even', 2262), ('good', 2080), ('time', 2041), ('story', 1907), ('films', 1873), ('would', 1844), ('much', 1824), ('also', 1757), ('characters', 1735), ('get', 1724), ('character', 1703), ('two', 1643), ('first', 1588), ('see', 1557), ('way', 1515), ('well', 1511), ('make', 1418), ('really', 1407), ('little', 1351), ('life', 1334), ('plot', 1288), ('people', 1269), ('could', 1248), ('bad', 1248), ('scene', 1241), ('movies', 1238), ('never', 1201), ('best', 1179), ('new', 1140), ('scenes', 1135), ('man', 1131), ('many', 1130), ('doesnt', 1118), ('know', 1092), ('dont', 1086), ('hes', 1024), ('great', 1014), ('another', 992), ('action', 985), ('love', 977), ('us', 967), ('go', 952), ('director', 948), ('end', 946), ('something', 945), ('still', 936)]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf332663444447-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf332663444447-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf332663444447-1">44276</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf332663444447-2">[('film', 7983), ('one', 4946), ('movie', 4826), ('like', 3201), ('even', 2262), ('good', 2080), ('time', 2041), ('story', 1907), ('films', 1873), ('would', 1844), ('much', 1824), ('also', 1757), ('characters', 1735), ('get', 1724), ('character', 1703), ('two', 1643), ('first', 1588), ('see', 1557), ('way', 1515), ('well', 1511), ('make', 1418), ('really', 1407), ('little', 1351), ('life', 1334), ('plot', 1288), ('people', 1269), ('could', 1248), ('bad', 1248), ('scene', 1241), ('movies', 1238), ('never', 1201), ('best', 1179), ('new', 1140), ('scenes', 1135), ('man', 1131), ('many', 1130), ('doesnt', 1118), ('know', 1092), ('dont', 1086), ('hes', 1024), ('great', 1014), ('another', 992), ('action', 985), ('love', 977), ('us', 967), ('go', 952), ('director', 948), ('end', 946), ('something', 945), ('still', 936)]</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can step through the vocabulary and remove all words that have a low occurrence, such as only being used once or twice in all reviews.</p>
<p>For example, the following snippet will retrieve only the tokens that appear 2 or more times in all reviews.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf333584700751" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# keep tokens with a min occurrence
min_occurane = 2
tokens = [k for k,c in vocab.items() if c &gt;= min_occurane]
print(len(tokens))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf333584700751-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf333584700751-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf333584700751-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf333584700751-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf333584700751-1"><span class="crayon-p"># keep tokens with a min occurrence</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf333584700751-2"><span class="crayon-v">min_occurane</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line" id="crayon-5c0caa5cbf333584700751-3"><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">k</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-sy">,</span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">min_occurane</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf333584700751-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Running the above example with this addition shows that the vocabulary size drops by a little more than half its size, from 44,276 to 25,767 words.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf335044957557" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
25767</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf335044957557-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf335044957557-1">25767</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Finally, the vocabulary can be saved to a new file called vocab.txt that we can later load and use to filter movie reviews prior to encoding them for modeling. We define a new function called save_list() that saves the vocabulary to file, with one word per file.</p>
<p>For example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf336780499833" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# save list to file
def save_list(lines, filename):
	# convert lines to a single blob of text
	data = '\n'.join(lines)
	# open file
	file = open(filename, 'w')
	# write text
	file.write(data)
	# close file
	file.close()

# save tokens to a vocabulary file
save_list(tokens, 'vocab.txt')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf336780499833-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf336780499833-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf336780499833-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf336780499833-4">4</div><div class="crayon-num" data-line="crayon-5c0caa5cbf336780499833-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf336780499833-6">6</div><div class="crayon-num" data-line="crayon-5c0caa5cbf336780499833-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf336780499833-8">8</div><div class="crayon-num" data-line="crayon-5c0caa5cbf336780499833-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf336780499833-10">10</div><div class="crayon-num" data-line="crayon-5c0caa5cbf336780499833-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf336780499833-12">12</div><div class="crayon-num" data-line="crayon-5c0caa5cbf336780499833-13">13</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf336780499833-1"><span class="crayon-p"># save list to file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf336780499833-2"><span class="crayon-e">def </span><span class="crayon-e">save_list</span><span class="crayon-sy">(</span><span class="crayon-v">lines</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf336780499833-3"><span class="crayon-h"> </span><span class="crayon-p"># convert lines to a single blob of text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf336780499833-4"><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'\n'</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">lines</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf336780499833-5"><span class="crayon-h"> </span><span class="crayon-p"># open file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf336780499833-6"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'w'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf336780499833-7"><span class="crayon-h"> </span><span class="crayon-p"># write text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf336780499833-8"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf336780499833-9"><span class="crayon-h"> </span><span class="crayon-p"># close file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf336780499833-10"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf336780499833-11"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf336780499833-12"><span class="crayon-p"># save tokens to a vocabulary file</span></div><div class="crayon-line" id="crayon-5c0caa5cbf336780499833-13"><span class="crayon-e">save_list</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'vocab.txt'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>Running the min occurrence filter on the vocabulary and saving it to file, you should now have a new file called <em>vocab.txt</em> with only the words we are interested in.</p>
<p>The order of words in your file will differ, but should look something like the following:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf338269043111" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
aberdeen
dupe
burt
libido
hamlet
arlene
available
corners
web
columbia
...</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf338269043111-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf338269043111-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf338269043111-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf338269043111-4">4</div><div class="crayon-num" data-line="crayon-5c0caa5cbf338269043111-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf338269043111-6">6</div><div class="crayon-num" data-line="crayon-5c0caa5cbf338269043111-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf338269043111-8">8</div><div class="crayon-num" data-line="crayon-5c0caa5cbf338269043111-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf338269043111-10">10</div><div class="crayon-num" data-line="crayon-5c0caa5cbf338269043111-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf338269043111-1">aberdeen</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf338269043111-2">dupe</div><div class="crayon-line" id="crayon-5c0caa5cbf338269043111-3">burt</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf338269043111-4">libido</div><div class="crayon-line" id="crayon-5c0caa5cbf338269043111-5">hamlet</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf338269043111-6">arlene</div><div class="crayon-line" id="crayon-5c0caa5cbf338269043111-7">available</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf338269043111-8">corners</div><div class="crayon-line" id="crayon-5c0caa5cbf338269043111-9">web</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf338269043111-10">columbia</div><div class="crayon-line" id="crayon-5c0caa5cbf338269043111-11">...</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We are now ready to look at extracting features from the reviews ready for modeling.</p>
<h2>Bag-of-Words Representation</h2>
<p>In this section, we will look at how we can convert each review into a representation that we can provide to a Multilayer Perceptron model.</p>
<p>A bag-of-words model is a way of extracting features from text so the text input can be used with machine learning algorithms like neural networks.</p>
<p>Each document, in this case a review, is converted into a vector representation. The number of items in the vector representing a document corresponds to the number of words in the vocabulary. The larger the vocabulary, the longer the vector representation, hence the preference for smaller vocabularies in the previous section.</p>
<p>Words in a document are scored and the scores are placed in the corresponding location in the representation. We will look at different word scoring methods in the next section.</p>
<p>In this section, we are concerned with converting reviews into vectors ready for training a first neural network model.</p>
<p>This section is divided into 2 steps:</p>
<ol>
<li>Converting reviews to lines of tokens.</li>
<li>Encoding reviews with a bag-of-words model representation.</li>
</ol>
<h3>Reviews to Lines of Tokens</h3>
<p>Before we can convert reviews to vectors for modeling, we must first clean them up.</p>
<p>This involves loading them, performing the cleaning operation developed above, filtering out words not in the chosen vocabulary, and converting the remaining tokens into a single string or line ready for encoding.</p>
<p>First, we need a function to prepare one document. Below lists the function <em>doc_to_line()</em> that will load a document, clean it, filter out tokens not in the vocabulary, then return the document as a string of white space separated tokens.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf33d683060130" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load doc, clean and return line of tokens
def doc_to_line(filename, vocab):
	# load the doc
	doc = load_doc(filename)
	# clean doc
	tokens = clean_doc(doc)
	# filter by vocab
	tokens = [w for w in tokens if w in vocab]
	return ' '.join(tokens)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf33d683060130-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf33d683060130-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf33d683060130-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf33d683060130-4">4</div><div class="crayon-num" data-line="crayon-5c0caa5cbf33d683060130-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf33d683060130-6">6</div><div class="crayon-num" data-line="crayon-5c0caa5cbf33d683060130-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf33d683060130-8">8</div><div class="crayon-num" data-line="crayon-5c0caa5cbf33d683060130-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf33d683060130-1"><span class="crayon-p"># load doc, clean and return line of tokens</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf33d683060130-2"><span class="crayon-e">def </span><span class="crayon-e">doc_to_line</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf33d683060130-3"><span class="crayon-h"> </span><span class="crayon-p"># load the doc</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf33d683060130-4"><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf33d683060130-5"><span class="crayon-h"> </span><span class="crayon-p"># clean doc</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf33d683060130-6"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf33d683060130-7"><span class="crayon-h"> </span><span class="crayon-p"># filter by vocab</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf33d683060130-8"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa5cbf33d683060130-9"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">' '</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Next, we need a function to work through all documents in a directory (such as ‘<em>pos</em>‘ and ‘<em>neg</em>‘) to convert the documents into lines.</p>
<p>Below lists the <em>process_docs()</em> function that does just this, expecting a directory name and a vocabulary set as input arguments and returning a list of processed documents.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf33e423277723" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load all docs in a directory
def process_docs(directory, vocab):
	lines = list()
	# walk through all files in the folder
	for filename in listdir(directory):
		# skip any reviews in the test set
		if filename.startswith('cv9'):
			continue
		# create the full path of the file to open
		path = directory + '/' + filename
		# load and clean the doc
		line = doc_to_line(path, vocab)
		# add to list
		lines.append(line)
	return lines</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf33e423277723-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf33e423277723-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf33e423277723-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf33e423277723-4">4</div><div class="crayon-num" data-line="crayon-5c0caa5cbf33e423277723-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf33e423277723-6">6</div><div class="crayon-num" data-line="crayon-5c0caa5cbf33e423277723-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf33e423277723-8">8</div><div class="crayon-num" data-line="crayon-5c0caa5cbf33e423277723-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf33e423277723-10">10</div><div class="crayon-num" data-line="crayon-5c0caa5cbf33e423277723-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf33e423277723-12">12</div><div class="crayon-num" data-line="crayon-5c0caa5cbf33e423277723-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf33e423277723-14">14</div><div class="crayon-num" data-line="crayon-5c0caa5cbf33e423277723-15">15</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf33e423277723-1"><span class="crayon-p"># load all docs in a directory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf33e423277723-2"><span class="crayon-e">def </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf33e423277723-3"><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf33e423277723-4"><span class="crayon-h"> </span><span class="crayon-p"># walk through all files in the folder</span></div><div class="crayon-line" id="crayon-5c0caa5cbf33e423277723-5"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">filename </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf33e423277723-6"><span class="crayon-h"> </span><span class="crayon-p"># skip any reviews in the test set</span></div><div class="crayon-line" id="crayon-5c0caa5cbf33e423277723-7"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf33e423277723-8"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5c0caa5cbf33e423277723-9"><span class="crayon-h"> </span><span class="crayon-p"># create the full path of the file to open</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf33e423277723-10"><span class="crayon-h"> </span><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'/'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">filename</span></div><div class="crayon-line" id="crayon-5c0caa5cbf33e423277723-11"><span class="crayon-h"> </span><span class="crayon-p"># load and clean the doc</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf33e423277723-12"><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">doc_to_line</span><span class="crayon-sy">(</span><span class="crayon-v">path</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf33e423277723-13"><span class="crayon-h"> </span><span class="crayon-p"># add to list</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf33e423277723-14"><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">line</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf33e423277723-15"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">lines</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>Finally, we need to load the vocabulary and turn it into a set for use in cleaning reviews.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf340213340152" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load the vocabulary
vocab_filename = 'vocab.txt'
vocab = load_doc(vocab_filename)
vocab = vocab.split()
vocab = set(vocab)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf340213340152-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf340213340152-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf340213340152-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf340213340152-4">4</div><div class="crayon-num" data-line="crayon-5c0caa5cbf340213340152-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf340213340152-1"><span class="crayon-p"># load the vocabulary</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf340213340152-2"><span class="crayon-v">vocab_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'vocab.txt'</span></div><div class="crayon-line" id="crayon-5c0caa5cbf340213340152-3"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf340213340152-4"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf340213340152-5"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>We can put all of this together, reusing the loading and cleaning functions developed in previous sections.</p>
<p>The complete example is listed below, demonstrating how to prepare the positive and negative reviews from the training dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf342616216258" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from string import punctuation
from os import listdir
from collections import Counter
from nltk.corpus import stopwords

# load doc into memory
def load_doc(filename):
	# open the file as read only
	file = open(filename, 'r')
	# read all text
	text = file.read()
	# close the file
	file.close()
	return text

# turn a doc into clean tokens
def clean_doc(doc):
	# split into tokens by white space
	tokens = doc.split()
	# remove punctuation from each token
	table = str.maketrans('', '', punctuation)
	tokens = [w.translate(table) for w in tokens]
	# remove remaining tokens that are not alphabetic
	tokens = [word for word in tokens if word.isalpha()]
	# filter out stop words
	stop_words = set(stopwords.words('english'))
	tokens = [w for w in tokens if not w in stop_words]
	# filter out short tokens
	tokens = [word for word in tokens if len(word) &gt; 1]
	return tokens

# load doc, clean and return line of tokens
def doc_to_line(filename, vocab):
	# load the doc
	doc = load_doc(filename)
	# clean doc
	tokens = clean_doc(doc)
	# filter by vocab
	tokens = [w for w in tokens if w in vocab]
	return ' '.join(tokens)

# load all docs in a directory
def process_docs(directory, vocab):
	lines = list()
	# walk through all files in the folder
	for filename in listdir(directory):
		# skip any reviews in the test set
		if filename.startswith('cv9'):
			continue
		# create the full path of the file to open
		path = directory + '/' + filename
		# load and clean the doc
		line = doc_to_line(path, vocab)
		# add to list
		lines.append(line)
	return lines

# load the vocabulary
vocab_filename = 'vocab.txt'
vocab = load_doc(vocab_filename)
vocab = vocab.split()
vocab = set(vocab)
# load all training reviews
positive_lines = process_docs('txt_sentoken/pos', vocab)
negative_lines = process_docs('txt_sentoken/neg', vocab)
# summarize what we have
print(len(positive_lines), len(negative_lines))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-4">4</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-6">6</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-8">8</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-10">10</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-12">12</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-14">14</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-16">16</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-18">18</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-20">20</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-22">22</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-24">24</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-26">26</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-28">28</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-30">30</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-32">32</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-34">34</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-36">36</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-38">38</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-40">40</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-42">42</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-44">44</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-46">46</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-48">48</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-50">50</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-52">52</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-54">54</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-56">56</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-58">58</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-60">60</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-62">62</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-64">64</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf342616216258-66">66</div><div class="crayon-num" data-line="crayon-5c0caa5cbf342616216258-67">67</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-1"><span class="crayon-e">from </span><span class="crayon-t">string</span><span class="crayon-h"> </span><span class="crayon-e">import </span><span class="crayon-e">punctuation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-2"><span class="crayon-e">from </span><span class="crayon-e">os </span><span class="crayon-e">import </span><span class="crayon-e">listdir</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-3"><span class="crayon-e">from </span><span class="crayon-e">collections </span><span class="crayon-e">import </span><span class="crayon-e">Counter</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-4"><span class="crayon-e">from </span><span class="crayon-v">nltk</span><span class="crayon-sy">.</span><span class="crayon-e">corpus </span><span class="crayon-e">import </span><span class="crayon-v">stopwords</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-5"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-6"><span class="crayon-p"># load doc into memory</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-7"><span class="crayon-e">def </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-8"><span class="crayon-h"> </span><span class="crayon-p"># open the file as read only</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-9"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-10"><span class="crayon-h"> </span><span class="crayon-p"># read all text</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-11"><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-12"><span class="crayon-h"> </span><span class="crayon-p"># close the file</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-13"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-14"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">text</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-15"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-16"><span class="crayon-p"># turn a doc into clean tokens</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-17"><span class="crayon-e">def </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-18"><span class="crayon-h"> </span><span class="crayon-p"># split into tokens by white space</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-19"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-20"><span class="crayon-h"> </span><span class="crayon-p"># remove punctuation from each token</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-21"><span class="crayon-h"> </span><span class="crayon-v">table</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">str</span><span class="crayon-sy">.</span><span class="crayon-e">maketrans</span><span class="crayon-sy">(</span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">punctuation</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-22"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">w</span><span class="crayon-sy">.</span><span class="crayon-e">translate</span><span class="crayon-sy">(</span><span class="crayon-v">table</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-23"><span class="crayon-h"> </span><span class="crayon-p"># remove remaining tokens that are not alphabetic</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-24"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-sy">.</span><span class="crayon-e">isalpha</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-25"><span class="crayon-h"> </span><span class="crayon-p"># filter out stop words</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-26"><span class="crayon-h"> </span><span class="crayon-v">stop_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">stopwords</span><span class="crayon-sy">.</span><span class="crayon-e">words</span><span class="crayon-sy">(</span><span class="crayon-s">'english'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-27"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">stop_words</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-28"><span class="crayon-h"> </span><span class="crayon-p"># filter out short tokens</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-29"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-t">word</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-30"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-31"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-32"><span class="crayon-p"># load doc, clean and return line of tokens</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-33"><span class="crayon-e">def </span><span class="crayon-e">doc_to_line</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-34"><span class="crayon-h"> </span><span class="crayon-p"># load the doc</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-35"><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-36"><span class="crayon-h"> </span><span class="crayon-p"># clean doc</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-37"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-38"><span class="crayon-h"> </span><span class="crayon-p"># filter by vocab</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-39"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-40"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">' '</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-41"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-42"><span class="crayon-p"># load all docs in a directory</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-43"><span class="crayon-e">def </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-44"><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-45"><span class="crayon-h"> </span><span class="crayon-p"># walk through all files in the folder</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-46"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">filename </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-47"><span class="crayon-h"> </span><span class="crayon-p"># skip any reviews in the test set</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-48"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-49"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-50"><span class="crayon-h"> </span><span class="crayon-p"># create the full path of the file to open</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-51"><span class="crayon-h"> </span><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'/'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">filename</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-52"><span class="crayon-h"> </span><span class="crayon-p"># load and clean the doc</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-53"><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">doc_to_line</span><span class="crayon-sy">(</span><span class="crayon-v">path</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-54"><span class="crayon-h"> </span><span class="crayon-p"># add to list</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-55"><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">line</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-56"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">lines</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-57"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-58"><span class="crayon-p"># load the vocabulary</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-59"><span class="crayon-v">vocab_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'vocab.txt'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-60"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-61"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-62"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-63"><span class="crayon-p"># load all training reviews</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-64"><span class="crayon-v">positive_lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/pos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-65"><span class="crayon-v">negative_lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/neg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf342616216258-66"><span class="crayon-p"># summarize what we have</span></div><div class="crayon-line" id="crayon-5c0caa5cbf342616216258-67"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">positive_lines</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">negative_lines</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0028 seconds] -->
<p></p>
<h3>Movie Reviews to Bag-of-Words Vectors</h3>
<p>We will use the Keras API to convert reviews to encoded document vectors.</p>
<p>Keras provides the <a href="https://keras.io/preprocessing/text/#tokenizer">Tokenize class</a> that can do some of the cleaning and vocab definition tasks that we took care of in the previous section.</p>
<p>It is better to do this ourselves to know exactly what was done and why. Nevertheless, the Tokenizer class is convenient and will easily transform documents into encoded vectors.</p>
<p>First, the Tokenizer must be created, then fit on the text documents in the training dataset.</p>
<p>In this case, these are the aggregation of the <em>positive_lines</em> and <em>negative_lines</em> arrays developed in the previous section.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf344663025036" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# create the tokenizer
tokenizer = Tokenizer()
# fit the tokenizer on the documents
docs = positive_lines + negative_lines
tokenizer.fit_on_texts(docs)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf344663025036-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf344663025036-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf344663025036-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf344663025036-4">4</div><div class="crayon-num" data-line="crayon-5c0caa5cbf344663025036-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf344663025036-1"><span class="crayon-p"># create the tokenizer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf344663025036-2"><span class="crayon-v">tokenizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Tokenizer</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf344663025036-3"><span class="crayon-p"># fit the tokenizer on the documents</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf344663025036-4"><span class="crayon-v">docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">positive_lines</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">negative_lines</span></div><div class="crayon-line" id="crayon-5c0caa5cbf344663025036-5"><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">fit_on_texts</span><span class="crayon-sy">(</span><span class="crayon-v">docs</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>This process determines a consistent way to convert the vocabulary to a fixed-length vector with 25,768 elements, which is the total number of words in the vocabulary file <em>vocab.txt</em>.</p>
<p>Next, documents can then be encoded using the Tokenizer by calling <em>texts_to_matrix()</em>. The function takes both a list of documents to encode and an encoding mode, which is the method used to score words in the document. Here we specify ‘<em>freq</em>‘ to score words based on their frequency in the document.</p>
<p>This can be used to encode the training data, for example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf346992483391" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# encode training data set
Xtrain = tokenizer.texts_to_matrix(docs, mode='freq')
print(Xtrain.shape)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf346992483391-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf346992483391-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf346992483391-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf346992483391-1"><span class="crayon-p"># encode training data set</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf346992483391-2"><span class="crayon-v">Xtrain</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_matrix</span><span class="crayon-sy">(</span><span class="crayon-v">docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mode</span><span class="crayon-o">=</span><span class="crayon-s">'freq'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf346992483391-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">Xtrain</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>This encodes all of the positive and negative reviews in the training dataset and prints the shape of the resulting matrix as 1,800 documents each with the length of 25,768 elements. It is ready to use as training data for a model.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf348629030711" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
(1800, 25768)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf348629030711-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf348629030711-1">(1800, 25768)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can encode the test data in a similar way.</p>
<p>First, the <em>process_docs()</em> function from the previous section needs to be modified to only process reviews in the test dataset, not the training dataset.</p>
<p>We support the loading of both the training and test datasets by adding an <em>is_trian</em> argument and using that to decide what review file names to skip.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf349526065306" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load all docs in a directory
def process_docs(directory, vocab, is_trian):
	lines = list()
	# walk through all files in the folder
	for filename in listdir(directory):
		# skip any reviews in the test set
		if is_trian and filename.startswith('cv9'):
			continue
		if not is_trian and not filename.startswith('cv9'):
			continue
		# create the full path of the file to open
		path = directory + '/' + filename
		# load and clean the doc
		line = doc_to_line(path, vocab)
		# add to list
		lines.append(line)
	return lines</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf349526065306-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf349526065306-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf349526065306-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf349526065306-4">4</div><div class="crayon-num" data-line="crayon-5c0caa5cbf349526065306-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf349526065306-6">6</div><div class="crayon-num" data-line="crayon-5c0caa5cbf349526065306-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf349526065306-8">8</div><div class="crayon-num" data-line="crayon-5c0caa5cbf349526065306-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf349526065306-10">10</div><div class="crayon-num" data-line="crayon-5c0caa5cbf349526065306-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf349526065306-12">12</div><div class="crayon-num" data-line="crayon-5c0caa5cbf349526065306-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf349526065306-14">14</div><div class="crayon-num" data-line="crayon-5c0caa5cbf349526065306-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf349526065306-16">16</div><div class="crayon-num" data-line="crayon-5c0caa5cbf349526065306-17">17</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf349526065306-1"><span class="crayon-p"># load all docs in a directory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf349526065306-2"><span class="crayon-e">def </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">is_trian</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf349526065306-3"><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf349526065306-4"><span class="crayon-h"> </span><span class="crayon-p"># walk through all files in the folder</span></div><div class="crayon-line" id="crayon-5c0caa5cbf349526065306-5"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">filename </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf349526065306-6"><span class="crayon-h"> </span><span class="crayon-p"># skip any reviews in the test set</span></div><div class="crayon-line" id="crayon-5c0caa5cbf349526065306-7"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">is_trian </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf349526065306-8"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5c0caa5cbf349526065306-9"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">is_trian </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf349526065306-10"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5c0caa5cbf349526065306-11"><span class="crayon-h"> </span><span class="crayon-p"># create the full path of the file to open</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf349526065306-12"><span class="crayon-h"> </span><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'/'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">filename</span></div><div class="crayon-line" id="crayon-5c0caa5cbf349526065306-13"><span class="crayon-h"> </span><span class="crayon-p"># load and clean the doc</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf349526065306-14"><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">doc_to_line</span><span class="crayon-sy">(</span><span class="crayon-v">path</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf349526065306-15"><span class="crayon-h"> </span><span class="crayon-p"># add to list</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf349526065306-16"><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">line</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf349526065306-17"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">lines</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>Next, we can load and encode positive and negative reviews in the test set in the same way as we did for the training set.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf34b543855498" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
...
# load all test reviews
positive_lines = process_docs('txt_sentoken/pos', vocab, False)
negative_lines = process_docs('txt_sentoken/neg', vocab, False)
docs = negative_lines + positive_lines
# encode training data set
Xtest = tokenizer.texts_to_matrix(docs, mode='freq')
print(Xtest.shape)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf34b543855498-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34b543855498-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34b543855498-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34b543855498-4">4</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34b543855498-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34b543855498-6">6</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34b543855498-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34b543855498-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf34b543855498-1"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34b543855498-2"><span class="crayon-p"># load all test reviews</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34b543855498-3"><span class="crayon-v">positive_lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/pos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34b543855498-4"><span class="crayon-v">negative_lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/neg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34b543855498-5"><span class="crayon-v">docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">negative_lines</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">positive_lines</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34b543855498-6"><span class="crayon-p"># encode training data set</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34b543855498-7"><span class="crayon-v">Xtest</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_matrix</span><span class="crayon-sy">(</span><span class="crayon-v">docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mode</span><span class="crayon-o">=</span><span class="crayon-s">'freq'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34b543855498-8"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">Xtest</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>We can put all of this together in a single example.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf34c315124953" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from string import punctuation
from os import listdir
from collections import Counter
from nltk.corpus import stopwords
from keras.preprocessing.text import Tokenizer

# load doc into memory
def load_doc(filename):
	# open the file as read only
	file = open(filename, 'r')
	# read all text
	text = file.read()
	# close the file
	file.close()
	return text

# turn a doc into clean tokens
def clean_doc(doc):
	# split into tokens by white space
	tokens = doc.split()
	# remove punctuation from each token
	table = str.maketrans('', '', punctuation)
	tokens = [w.translate(table) for w in tokens]
	# remove remaining tokens that are not alphabetic
	tokens = [word for word in tokens if word.isalpha()]
	# filter out stop words
	stop_words = set(stopwords.words('english'))
	tokens = [w for w in tokens if not w in stop_words]
	# filter out short tokens
	tokens = [word for word in tokens if len(word) &gt; 1]
	return tokens

# load doc, clean and return line of tokens
def doc_to_line(filename, vocab):
	# load the doc
	doc = load_doc(filename)
	# clean doc
	tokens = clean_doc(doc)
	# filter by vocab
	tokens = [w for w in tokens if w in vocab]
	return ' '.join(tokens)

# load all docs in a directory
def process_docs(directory, vocab, is_trian):
	lines = list()
	# walk through all files in the folder
	for filename in listdir(directory):
		# skip any reviews in the test set
		if is_trian and filename.startswith('cv9'):
			continue
		if not is_trian and not filename.startswith('cv9'):
			continue
		# create the full path of the file to open
		path = directory + '/' + filename
		# load and clean the doc
		line = doc_to_line(path, vocab)
		# add to list
		lines.append(line)
	return lines

# load the vocabulary
vocab_filename = 'vocab.txt'
vocab = load_doc(vocab_filename)
vocab = vocab.split()
vocab = set(vocab)

# load all training reviews
positive_lines = process_docs('txt_sentoken/pos', vocab, True)
negative_lines = process_docs('txt_sentoken/neg', vocab, True)

# create the tokenizer
tokenizer = Tokenizer()
# fit the tokenizer on the documents
docs = negative_lines + positive_lines
tokenizer.fit_on_texts(docs)

# encode training data set
Xtrain = tokenizer.texts_to_matrix(docs, mode='freq')
print(Xtrain.shape)

# load all test reviews
positive_lines = process_docs('txt_sentoken/pos', vocab, False)
negative_lines = process_docs('txt_sentoken/neg', vocab, False)
docs = negative_lines + positive_lines
# encode training data set
Xtest = tokenizer.texts_to_matrix(docs, mode='freq')
print(Xtest.shape)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-4">4</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-6">6</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-8">8</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-10">10</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-12">12</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-14">14</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-16">16</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-18">18</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-20">20</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-22">22</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-24">24</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-26">26</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-28">28</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-30">30</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-32">32</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-34">34</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-36">36</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-38">38</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-40">40</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-42">42</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-44">44</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-46">46</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-48">48</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-50">50</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-52">52</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-54">54</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-56">56</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-58">58</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-60">60</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-62">62</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-64">64</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-66">66</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-68">68</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-70">70</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-72">72</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-74">74</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-76">76</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-78">78</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-80">80</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-82">82</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-84">84</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34c315124953-86">86</div><div class="crayon-num" data-line="crayon-5c0caa5cbf34c315124953-87">87</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-1"><span class="crayon-e">from </span><span class="crayon-t">string</span><span class="crayon-h"> </span><span class="crayon-e">import </span><span class="crayon-e">punctuation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-2"><span class="crayon-e">from </span><span class="crayon-e">os </span><span class="crayon-e">import </span><span class="crayon-e">listdir</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-3"><span class="crayon-e">from </span><span class="crayon-e">collections </span><span class="crayon-e">import </span><span class="crayon-e">Counter</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-4"><span class="crayon-e">from </span><span class="crayon-v">nltk</span><span class="crayon-sy">.</span><span class="crayon-e">corpus </span><span class="crayon-e">import </span><span class="crayon-e">stopwords</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">text </span><span class="crayon-e">import </span><span class="crayon-v">Tokenizer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-6"> </div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-7"><span class="crayon-p"># load doc into memory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-8"><span class="crayon-e">def </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-9"><span class="crayon-h"> </span><span class="crayon-p"># open the file as read only</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-10"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-11"><span class="crayon-h"> </span><span class="crayon-p"># read all text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-12"><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-13"><span class="crayon-h"> </span><span class="crayon-p"># close the file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-14"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-15"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-16"> </div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-17"><span class="crayon-p"># turn a doc into clean tokens</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-18"><span class="crayon-e">def </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-19"><span class="crayon-h"> </span><span class="crayon-p"># split into tokens by white space</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-20"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-21"><span class="crayon-h"> </span><span class="crayon-p"># remove punctuation from each token</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-22"><span class="crayon-h"> </span><span class="crayon-v">table</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">str</span><span class="crayon-sy">.</span><span class="crayon-e">maketrans</span><span class="crayon-sy">(</span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">punctuation</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-23"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">w</span><span class="crayon-sy">.</span><span class="crayon-e">translate</span><span class="crayon-sy">(</span><span class="crayon-v">table</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-24"><span class="crayon-h"> </span><span class="crayon-p"># remove remaining tokens that are not alphabetic</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-25"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-sy">.</span><span class="crayon-e">isalpha</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-26"><span class="crayon-h"> </span><span class="crayon-p"># filter out stop words</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-27"><span class="crayon-h"> </span><span class="crayon-v">stop_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">stopwords</span><span class="crayon-sy">.</span><span class="crayon-e">words</span><span class="crayon-sy">(</span><span class="crayon-s">'english'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-28"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">stop_words</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-29"><span class="crayon-h"> </span><span class="crayon-p"># filter out short tokens</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-30"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-t">word</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-31"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-32"> </div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-33"><span class="crayon-p"># load doc, clean and return line of tokens</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-34"><span class="crayon-e">def </span><span class="crayon-e">doc_to_line</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-35"><span class="crayon-h"> </span><span class="crayon-p"># load the doc</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-36"><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-37"><span class="crayon-h"> </span><span class="crayon-p"># clean doc</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-38"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-39"><span class="crayon-h"> </span><span class="crayon-p"># filter by vocab</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-40"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-41"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">' '</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-42"> </div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-43"><span class="crayon-p"># load all docs in a directory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-44"><span class="crayon-e">def </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">is_trian</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-45"><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-46"><span class="crayon-h"> </span><span class="crayon-p"># walk through all files in the folder</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-47"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">filename </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-48"><span class="crayon-h"> </span><span class="crayon-p"># skip any reviews in the test set</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-49"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">is_trian </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-50"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-51"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">is_trian </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-52"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-53"><span class="crayon-h"> </span><span class="crayon-p"># create the full path of the file to open</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-54"><span class="crayon-h"> </span><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'/'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">filename</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-55"><span class="crayon-h"> </span><span class="crayon-p"># load and clean the doc</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-56"><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">doc_to_line</span><span class="crayon-sy">(</span><span class="crayon-v">path</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-57"><span class="crayon-h"> </span><span class="crayon-p"># add to list</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-58"><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">line</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-59"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">lines</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-60"> </div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-61"><span class="crayon-p"># load the vocabulary</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-62"><span class="crayon-v">vocab_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'vocab.txt'</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-63"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-64"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-65"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-66"> </div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-67"><span class="crayon-p"># load all training reviews</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-68"><span class="crayon-v">positive_lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/pos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-69"><span class="crayon-v">negative_lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/neg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-70"> </div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-71"><span class="crayon-p"># create the tokenizer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-72"><span class="crayon-v">tokenizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Tokenizer</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-73"><span class="crayon-p"># fit the tokenizer on the documents</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-74"><span class="crayon-v">docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">negative_lines</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">positive_lines</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-75"><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">fit_on_texts</span><span class="crayon-sy">(</span><span class="crayon-v">docs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-76"> </div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-77"><span class="crayon-p"># encode training data set</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-78"><span class="crayon-v">Xtrain</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_matrix</span><span class="crayon-sy">(</span><span class="crayon-v">docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mode</span><span class="crayon-o">=</span><span class="crayon-s">'freq'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-79"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">Xtrain</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-80"> </div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-81"><span class="crayon-p"># load all test reviews</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-82"><span class="crayon-v">positive_lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/pos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-83"><span class="crayon-v">negative_lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/neg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-84"><span class="crayon-v">docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">negative_lines</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">positive_lines</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-85"><span class="crayon-p"># encode training data set</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34c315124953-86"><span class="crayon-v">Xtest</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_matrix</span><span class="crayon-sy">(</span><span class="crayon-v">docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mode</span><span class="crayon-o">=</span><span class="crayon-s">'freq'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf34c315124953-87"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">Xtest</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0037 seconds] -->
<p>Running the example prints both the shape of the encoded training dataset and test dataset with 1,800 and 200 documents respectively, each with the same sized encoding vocabulary (vector length).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf34e618630245" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
(1800, 25768)
(200, 25768)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf34e618630245-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf34e618630245-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf34e618630245-1">(1800, 25768)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf34e618630245-2">(200, 25768)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p></p>
<h2>Sentiment Analysis Models</h2>
<p>In this section, we will develop Multilayer Perceptron (MLP) models to classify encoded documents as either positive or negative.</p>
<p>The models will be simple feedforward network models with fully connected layers called <em>Dense</em> in the Keras deep learning library.</p>
<p>This section is divided into 3 sections:</p>
<ol>
<li>First sentiment analysis model</li>
<li>Comparing word scoring modes</li>
<li>Making a prediction for new reviews</li>
</ol>
<h3>First Sentiment Analysis Model</h3>
<p>We can develop a simple MLP model to predict the sentiment of encoded reviews.</p>
<p>The model will have an input layer that equals the number of words in the vocabulary, and in turn the length of the input documents.</p>
<p>We can store this in a new variable called <em>n_words</em>, as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf350623674261" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
n_words = Xtest.shape[1]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf350623674261-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf350623674261-1"><span class="crayon-v">n_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Xtest</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We also need class labels for all of the training and test review data. We loaded and encoded these the reviews deterministically (negative, then positive), so we can specify the labels directly, as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf352344791611" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
ytrain = array([0 for _ in range(900)] + [1 for _ in range(900)])
ytest = array([0 for _ in range(100)] + [1 for _ in range(100)])</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf352344791611-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf352344791611-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf352344791611-1"><span class="crayon-v">ytrain</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">900</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">900</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf352344791611-2"><span class="crayon-v">ytest</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>We can now define the network.</p>
<p>All model configuration was found with very little trial and error and should not be considered tuned for this problem.</p>
<p>We will use a single hidden layer with 50 neurons and a rectified linear activation function. The output layer is a single neuron with a sigmoid activation function for predicting 0 for negative and 1 for positive reviews.</p>
<p>The network will be trained using the efficient <a href="http://machinelearningmastery.com/adam-optimization-algorithm-for-deep-learning/">Adam implementation</a> of gradient descent and the binary cross entropy loss function, suited to binary classification problems. We will keep track of accuracy when training and evaluating the model.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf354387064360" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# define network
model = Sequential()
model.add(Dense(50, input_shape=(n_words,), activation='relu'))
model.add(Dense(1, activation='sigmoid'))
# compile network
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf354387064360-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf354387064360-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf354387064360-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf354387064360-4">4</div><div class="crayon-num" data-line="crayon-5c0caa5cbf354387064360-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf354387064360-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf354387064360-1"><span class="crayon-p"># define network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf354387064360-2"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf354387064360-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_words</span><span class="crayon-sy">,</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf354387064360-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf354387064360-5"><span class="crayon-p"># compile network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf354387064360-6"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Next, we can fit the model on the training data; in this case, the model is small and is easily fit in 50 epochs.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf355208160868" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# fit network
model.fit(Xtrain, ytrain, epochs=50, verbose=2)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf355208160868-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf355208160868-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf355208160868-1"><span class="crayon-p"># fit network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf355208160868-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">Xtrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ytrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Finally, once the model is trained, we can evaluate its performance by making predictions in the test dataset and printing the accuracy.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf357900944901" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# evaluate
loss, acc = model.evaluate(Xtest, ytest, verbose=0)
print('Test Accuracy: %f' % (acc*100))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf357900944901-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf357900944901-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf357900944901-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf357900944901-1"><span class="crayon-p"># evaluate</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf357900944901-2"><span class="crayon-v">loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">Xtest</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ytest</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf357900944901-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test Accuracy: %f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">acc*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf359653523245" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from numpy import array
from string import punctuation
from os import listdir
from collections import Counter
from nltk.corpus import stopwords
from keras.preprocessing.text import Tokenizer
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import Dropout

# load doc into memory
def load_doc(filename):
	# open the file as read only
	file = open(filename, 'r')
	# read all text
	text = file.read()
	# close the file
	file.close()
	return text

# turn a doc into clean tokens
def clean_doc(doc):
	# split into tokens by white space
	tokens = doc.split()
	# remove punctuation from each token
	table = str.maketrans('', '', punctuation)
	tokens = [w.translate(table) for w in tokens]
	# remove remaining tokens that are not alphabetic
	tokens = [word for word in tokens if word.isalpha()]
	# filter out stop words
	stop_words = set(stopwords.words('english'))
	tokens = [w for w in tokens if not w in stop_words]
	# filter out short tokens
	tokens = [word for word in tokens if len(word) &gt; 1]
	return tokens

# load doc, clean and return line of tokens
def doc_to_line(filename, vocab):
	# load the doc
	doc = load_doc(filename)
	# clean doc
	tokens = clean_doc(doc)
	# filter by vocab
	tokens = [w for w in tokens if w in vocab]
	return ' '.join(tokens)

# load all docs in a directory
def process_docs(directory, vocab, is_trian):
	lines = list()
	# walk through all files in the folder
	for filename in listdir(directory):
		# skip any reviews in the test set
		if is_trian and filename.startswith('cv9'):
			continue
		if not is_trian and not filename.startswith('cv9'):
			continue
		# create the full path of the file to open
		path = directory + '/' + filename
		# load and clean the doc
		line = doc_to_line(path, vocab)
		# add to list
		lines.append(line)
	return lines

# load the vocabulary
vocab_filename = 'vocab.txt'
vocab = load_doc(vocab_filename)
vocab = vocab.split()
vocab = set(vocab)
# load all training reviews
positive_lines = process_docs('txt_sentoken/pos', vocab, True)
negative_lines = process_docs('txt_sentoken/neg', vocab, True)
# create the tokenizer
tokenizer = Tokenizer()
# fit the tokenizer on the documents
docs = negative_lines + positive_lines
tokenizer.fit_on_texts(docs)
# encode training data set
Xtrain = tokenizer.texts_to_matrix(docs, mode='freq')
ytrain = array([0 for _ in range(900)] + [1 for _ in range(900)])

# load all test reviews
positive_lines = process_docs('txt_sentoken/pos', vocab, False)
negative_lines = process_docs('txt_sentoken/neg', vocab, False)
docs = negative_lines + positive_lines
# encode training data set
Xtest = tokenizer.texts_to_matrix(docs, mode='freq')
ytest = array([0 for _ in range(100)] + [1 for _ in range(100)])

n_words = Xtest.shape[1]
# define network
model = Sequential()
model.add(Dense(50, input_shape=(n_words,), activation='relu'))
model.add(Dense(1, activation='sigmoid'))
# compile network
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
# fit network
model.fit(Xtrain, ytrain, epochs=50, verbose=2)
# evaluate
loss, acc = model.evaluate(Xtest, ytest, verbose=0)
print('Test Accuracy: %f' % (acc*100))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-4">4</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-6">6</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-8">8</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-10">10</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-12">12</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-14">14</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-16">16</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-18">18</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-20">20</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-22">22</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-24">24</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-26">26</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-28">28</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-30">30</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-32">32</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-34">34</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-36">36</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-38">38</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-40">40</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-42">42</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-44">44</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-46">46</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-48">48</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-50">50</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-52">52</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-54">54</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-56">56</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-58">58</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-60">60</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-62">62</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-64">64</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-66">66</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-68">68</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-70">70</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-72">72</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-74">74</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-76">76</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-78">78</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-80">80</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-82">82</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-84">84</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-86">86</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-88">88</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-90">90</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-92">92</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-94">94</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-96">96</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-98">98</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf359653523245-100">100</div><div class="crayon-num" data-line="crayon-5c0caa5cbf359653523245-101">101</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-1"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-2"><span class="crayon-e">from </span><span class="crayon-t">string</span><span class="crayon-h"> </span><span class="crayon-e">import </span><span class="crayon-e">punctuation</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-3"><span class="crayon-e">from </span><span class="crayon-e">os </span><span class="crayon-e">import </span><span class="crayon-e">listdir</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-4"><span class="crayon-e">from </span><span class="crayon-e">collections </span><span class="crayon-e">import </span><span class="crayon-e">Counter</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-5"><span class="crayon-e">from </span><span class="crayon-v">nltk</span><span class="crayon-sy">.</span><span class="crayon-e">corpus </span><span class="crayon-e">import </span><span class="crayon-e">stopwords</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">text </span><span class="crayon-e">import </span><span class="crayon-e">Tokenizer</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-v">Dropout</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-10"> </div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-11"><span class="crayon-p"># load doc into memory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-12"><span class="crayon-e">def </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-13"><span class="crayon-h"> </span><span class="crayon-p"># open the file as read only</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-14"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-15"><span class="crayon-h"> </span><span class="crayon-p"># read all text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-16"><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-17"><span class="crayon-h"> </span><span class="crayon-p"># close the file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-18"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-19"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-20"> </div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-21"><span class="crayon-p"># turn a doc into clean tokens</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-22"><span class="crayon-e">def </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-23"><span class="crayon-h"> </span><span class="crayon-p"># split into tokens by white space</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-24"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-25"><span class="crayon-h"> </span><span class="crayon-p"># remove punctuation from each token</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-26"><span class="crayon-h"> </span><span class="crayon-v">table</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">str</span><span class="crayon-sy">.</span><span class="crayon-e">maketrans</span><span class="crayon-sy">(</span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">punctuation</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-27"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">w</span><span class="crayon-sy">.</span><span class="crayon-e">translate</span><span class="crayon-sy">(</span><span class="crayon-v">table</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-28"><span class="crayon-h"> </span><span class="crayon-p"># remove remaining tokens that are not alphabetic</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-29"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-sy">.</span><span class="crayon-e">isalpha</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-30"><span class="crayon-h"> </span><span class="crayon-p"># filter out stop words</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-31"><span class="crayon-h"> </span><span class="crayon-v">stop_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">stopwords</span><span class="crayon-sy">.</span><span class="crayon-e">words</span><span class="crayon-sy">(</span><span class="crayon-s">'english'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-32"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">stop_words</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-33"><span class="crayon-h"> </span><span class="crayon-p"># filter out short tokens</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-34"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-t">word</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-35"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-36"> </div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-37"><span class="crayon-p"># load doc, clean and return line of tokens</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-38"><span class="crayon-e">def </span><span class="crayon-e">doc_to_line</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-39"><span class="crayon-h"> </span><span class="crayon-p"># load the doc</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-40"><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-41"><span class="crayon-h"> </span><span class="crayon-p"># clean doc</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-42"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-43"><span class="crayon-h"> </span><span class="crayon-p"># filter by vocab</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-44"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-45"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">' '</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-46"> </div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-47"><span class="crayon-p"># load all docs in a directory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-48"><span class="crayon-e">def </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">is_trian</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-49"><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-50"><span class="crayon-h"> </span><span class="crayon-p"># walk through all files in the folder</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-51"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">filename </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-52"><span class="crayon-h"> </span><span class="crayon-p"># skip any reviews in the test set</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-53"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">is_trian </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-54"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-55"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">is_trian </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-56"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-57"><span class="crayon-h"> </span><span class="crayon-p"># create the full path of the file to open</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-58"><span class="crayon-h"> </span><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'/'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">filename</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-59"><span class="crayon-h"> </span><span class="crayon-p"># load and clean the doc</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-60"><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">doc_to_line</span><span class="crayon-sy">(</span><span class="crayon-v">path</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-61"><span class="crayon-h"> </span><span class="crayon-p"># add to list</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-62"><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">line</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-63"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">lines</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-64"> </div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-65"><span class="crayon-p"># load the vocabulary</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-66"><span class="crayon-v">vocab_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'vocab.txt'</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-67"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-68"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-69"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-70"><span class="crayon-p"># load all training reviews</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-71"><span class="crayon-v">positive_lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/pos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-72"><span class="crayon-v">negative_lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/neg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-73"><span class="crayon-p"># create the tokenizer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-74"><span class="crayon-v">tokenizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Tokenizer</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-75"><span class="crayon-p"># fit the tokenizer on the documents</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-76"><span class="crayon-v">docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">negative_lines</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">positive_lines</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-77"><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">fit_on_texts</span><span class="crayon-sy">(</span><span class="crayon-v">docs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-78"><span class="crayon-p"># encode training data set</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-79"><span class="crayon-v">Xtrain</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_matrix</span><span class="crayon-sy">(</span><span class="crayon-v">docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mode</span><span class="crayon-o">=</span><span class="crayon-s">'freq'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-80"><span class="crayon-v">ytrain</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">900</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">900</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-81"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-82"><span class="crayon-p"># load all test reviews</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-83"><span class="crayon-v">positive_lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/pos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-84"><span class="crayon-v">negative_lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/neg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-85"><span class="crayon-v">docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">negative_lines</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">positive_lines</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-86"><span class="crayon-p"># encode training data set</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-87"><span class="crayon-v">Xtest</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_matrix</span><span class="crayon-sy">(</span><span class="crayon-v">docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mode</span><span class="crayon-o">=</span><span class="crayon-s">'freq'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-88"><span class="crayon-v">ytest</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-89"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-90"><span class="crayon-v">n_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Xtest</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-91"><span class="crayon-p"># define network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-92"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-93"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_words</span><span class="crayon-sy">,</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-94"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-95"><span class="crayon-p"># compile network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-96"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-97"><span class="crayon-p"># fit network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-98"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">Xtrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ytrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-99"><span class="crayon-p"># evaluate</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf359653523245-100"><span class="crayon-v">loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">Xtest</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ytest</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf359653523245-101"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test Accuracy: %f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">acc*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0049 seconds] -->
<p>Running the example, we can see that the model easily fits the training data within the 50 epochs, achieving 100% accuracy.</p>
<p>Evaluating the model on the test dataset, we can see that model does well, achieving an accuracy of above 90%, well within the ballpark of low-to-mid 80s seen in the original paper.</p>
<p>Although, it is important to note that this is not an apples-to-apples comparison, as the original paper used 10-fold cross-validation to estimate model skill instead of a single train/test split.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf35b551969509" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
...
Epoch 46/50
0s - loss: 0.0167 - acc: 1.0000
Epoch 47/50
0s - loss: 0.0157 - acc: 1.0000
Epoch 48/50
0s - loss: 0.0148 - acc: 1.0000
Epoch 49/50
0s - loss: 0.0140 - acc: 1.0000
Epoch 50/50
0s - loss: 0.0132 - acc: 1.0000

Test Accuracy: 91.000000</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf35b551969509-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf35b551969509-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf35b551969509-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf35b551969509-4">4</div><div class="crayon-num" data-line="crayon-5c0caa5cbf35b551969509-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf35b551969509-6">6</div><div class="crayon-num" data-line="crayon-5c0caa5cbf35b551969509-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf35b551969509-8">8</div><div class="crayon-num" data-line="crayon-5c0caa5cbf35b551969509-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf35b551969509-10">10</div><div class="crayon-num" data-line="crayon-5c0caa5cbf35b551969509-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf35b551969509-12">12</div><div class="crayon-num" data-line="crayon-5c0caa5cbf35b551969509-13">13</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf35b551969509-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf35b551969509-2">Epoch 46/50</div><div class="crayon-line" id="crayon-5c0caa5cbf35b551969509-3">0s - loss: 0.0167 - acc: 1.0000</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf35b551969509-4">Epoch 47/50</div><div class="crayon-line" id="crayon-5c0caa5cbf35b551969509-5">0s - loss: 0.0157 - acc: 1.0000</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf35b551969509-6">Epoch 48/50</div><div class="crayon-line" id="crayon-5c0caa5cbf35b551969509-7">0s - loss: 0.0148 - acc: 1.0000</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf35b551969509-8">Epoch 49/50</div><div class="crayon-line" id="crayon-5c0caa5cbf35b551969509-9">0s - loss: 0.0140 - acc: 1.0000</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf35b551969509-10">Epoch 50/50</div><div class="crayon-line" id="crayon-5c0caa5cbf35b551969509-11">0s - loss: 0.0132 - acc: 1.0000</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf35b551969509-12"> </div><div class="crayon-line" id="crayon-5c0caa5cbf35b551969509-13">Test Accuracy: 91.000000</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Next, let’s look at testing different word scoring methods for the bag-of-words model.</p>
<h3>Comparing Word Scoring Methods</h3>
<p>The <em>texts_to_matrix()</em> function for the Tokenizer in the Keras API provides 4 different methods for scoring words; they are:</p>
<ul>
<li>“<em>binary</em>” Where words are marked as present (1) or absent (0).</li>
<li>“<em>count</em>” Where the occurrence count for each word is marked as an integer.</li>
<li>“<em>tfidf</em>” Where each word is scored based on their frequency, where words that are common across all documents are penalized.</li>
<li>“<em>freq</em>” Where words are scored based on their frequency of occurrence within the document.</li>
</ul>
<p>We can evaluate the skill of the model developed in the previous section fit using each of the 4 supported word scoring modes.</p>
<p>This first involves the development of a function to create an encoding of the loaded documents based on a chosen scoring model. The function creates the tokenizer, fits it on the training documents, then creates the train and test encodings using the chosen model. The function <em>prepare_data()</em> implements this behavior given lists of train and test documents.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf35e372740326" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# prepare bag of words encoding of docs
def prepare_data(train_docs, test_docs, mode):
	# create the tokenizer
	tokenizer = Tokenizer()
	# fit the tokenizer on the documents
	tokenizer.fit_on_texts(train_docs)
	# encode training data set
	Xtrain = tokenizer.texts_to_matrix(train_docs, mode=mode)
	# encode training data set
	Xtest = tokenizer.texts_to_matrix(test_docs, mode=mode)
	return Xtrain, Xtest</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf35e372740326-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf35e372740326-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf35e372740326-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf35e372740326-4">4</div><div class="crayon-num" data-line="crayon-5c0caa5cbf35e372740326-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf35e372740326-6">6</div><div class="crayon-num" data-line="crayon-5c0caa5cbf35e372740326-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf35e372740326-8">8</div><div class="crayon-num" data-line="crayon-5c0caa5cbf35e372740326-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf35e372740326-10">10</div><div class="crayon-num" data-line="crayon-5c0caa5cbf35e372740326-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf35e372740326-1"><span class="crayon-p"># prepare bag of words encoding of docs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf35e372740326-2"><span class="crayon-e">def </span><span class="crayon-e">prepare_data</span><span class="crayon-sy">(</span><span class="crayon-v">train_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mode</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf35e372740326-3"><span class="crayon-h"> </span><span class="crayon-p"># create the tokenizer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf35e372740326-4"><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Tokenizer</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf35e372740326-5"><span class="crayon-h"> </span><span class="crayon-p"># fit the tokenizer on the documents</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf35e372740326-6"><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">fit_on_texts</span><span class="crayon-sy">(</span><span class="crayon-v">train_docs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf35e372740326-7"><span class="crayon-h"> </span><span class="crayon-p"># encode training data set</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf35e372740326-8"><span class="crayon-h"> </span><span class="crayon-v">Xtrain</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_matrix</span><span class="crayon-sy">(</span><span class="crayon-v">train_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mode</span><span class="crayon-o">=</span><span class="crayon-v">mode</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf35e372740326-9"><span class="crayon-h"> </span><span class="crayon-p"># encode training data set</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf35e372740326-10"><span class="crayon-h"> </span><span class="crayon-v">Xtest</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_matrix</span><span class="crayon-sy">(</span><span class="crayon-v">test_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mode</span><span class="crayon-o">=</span><span class="crayon-v">mode</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf35e372740326-11"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">Xtrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Xtest</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>We also need a function to evaluate the MLP given a specific encoding of the data.</p>
<p>Because neural networks are stochastic, they can produce different results when the same model is fit on the same data. This is mainly because of the random initial weights and the shuffling of patterns during mini-batch gradient descent. This means that any one scoring of a model is unreliable and we should estimate model skill based on an average of multiple runs.</p>
<p>The function below, named <em>evaluate_mode()</em>, takes encoded documents and evaluates the MLP by training it on the train set and estimating skill on the test set 30 times and returns a list of the accuracy scores across all of these runs.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf360391849812" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# evaluate a neural network model
def evaluate_mode(Xtrain, ytrain, Xtest, ytest):
	scores = list()
	n_repeats = 30
	n_words = Xtest.shape[1]
	for i in range(n_repeats):
		# define network
		model = Sequential()
		model.add(Dense(50, input_shape=(n_words,), activation='relu'))
		model.add(Dense(1, activation='sigmoid'))
		# compile network
		model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
		# fit network
		model.fit(Xtrain, ytrain, epochs=50, verbose=2)
		# evaluate
		loss, acc = model.evaluate(Xtest, ytest, verbose=0)
		scores.append(acc)
		print('%d accuracy: %s' % ((i+1), acc))
	return scores</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf360391849812-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf360391849812-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf360391849812-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf360391849812-4">4</div><div class="crayon-num" data-line="crayon-5c0caa5cbf360391849812-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf360391849812-6">6</div><div class="crayon-num" data-line="crayon-5c0caa5cbf360391849812-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf360391849812-8">8</div><div class="crayon-num" data-line="crayon-5c0caa5cbf360391849812-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf360391849812-10">10</div><div class="crayon-num" data-line="crayon-5c0caa5cbf360391849812-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf360391849812-12">12</div><div class="crayon-num" data-line="crayon-5c0caa5cbf360391849812-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf360391849812-14">14</div><div class="crayon-num" data-line="crayon-5c0caa5cbf360391849812-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf360391849812-16">16</div><div class="crayon-num" data-line="crayon-5c0caa5cbf360391849812-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf360391849812-18">18</div><div class="crayon-num" data-line="crayon-5c0caa5cbf360391849812-19">19</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf360391849812-1"><span class="crayon-p"># evaluate a neural network model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf360391849812-2"><span class="crayon-e">def </span><span class="crayon-e">evaluate_mode</span><span class="crayon-sy">(</span><span class="crayon-v">Xtrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ytrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Xtest</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ytest</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf360391849812-3"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf360391849812-4"><span class="crayon-h"> </span><span class="crayon-v">n_repeats</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">30</span></div><div class="crayon-line" id="crayon-5c0caa5cbf360391849812-5"><span class="crayon-h"> </span><span class="crayon-v">n_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Xtest</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf360391849812-6"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_repeats</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf360391849812-7"><span class="crayon-h"> </span><span class="crayon-p"># define network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf360391849812-8"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf360391849812-9"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_words</span><span class="crayon-sy">,</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf360391849812-10"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf360391849812-11"><span class="crayon-h"> </span><span class="crayon-p"># compile network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf360391849812-12"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf360391849812-13"><span class="crayon-h"> </span><span class="crayon-p"># fit network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf360391849812-14"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">Xtrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ytrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf360391849812-15"><span class="crayon-h"> </span><span class="crayon-p"># evaluate</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf360391849812-16"><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">Xtest</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ytest</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf360391849812-17"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">acc</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf360391849812-18"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'%d accuracy: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf360391849812-19"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0013 seconds] -->
<p>We are now ready to evaluate the performance of the 4 different word scoring methods.</p>
<p>Pulling all of this together, the complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf362323054226" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from numpy import array
from string import punctuation
from os import listdir
from collections import Counter
from nltk.corpus import stopwords
from keras.preprocessing.text import Tokenizer
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import Dropout
from pandas import DataFrame
from matplotlib import pyplot

# load doc into memory
def load_doc(filename):
	# open the file as read only
	file = open(filename, 'r')
	# read all text
	text = file.read()
	# close the file
	file.close()
	return text

# turn a doc into clean tokens
def clean_doc(doc):
	# split into tokens by white space
	tokens = doc.split()
	# remove punctuation from each token
	table = str.maketrans('', '', punctuation)
	tokens = [w.translate(table) for w in tokens]
	# remove remaining tokens that are not alphabetic
	tokens = [word for word in tokens if word.isalpha()]
	# filter out stop words
	stop_words = set(stopwords.words('english'))
	tokens = [w for w in tokens if not w in stop_words]
	# filter out short tokens
	tokens = [word for word in tokens if len(word) &gt; 1]
	return tokens

# load doc, clean and return line of tokens
def doc_to_line(filename, vocab):
	# load the doc
	doc = load_doc(filename)
	# clean doc
	tokens = clean_doc(doc)
	# filter by vocab
	tokens = [w for w in tokens if w in vocab]
	return ' '.join(tokens)

# load all docs in a directory
def process_docs(directory, vocab, is_trian):
	lines = list()
	# walk through all files in the folder
	for filename in listdir(directory):
		# skip any reviews in the test set
		if is_trian and filename.startswith('cv9'):
			continue
		if not is_trian and not filename.startswith('cv9'):
			continue
		# create the full path of the file to open
		path = directory + '/' + filename
		# load and clean the doc
		line = doc_to_line(path, vocab)
		# add to list
		lines.append(line)
	return lines

# evaluate a neural network model
def evaluate_mode(Xtrain, ytrain, Xtest, ytest):
	scores = list()
	n_repeats = 30
	n_words = Xtest.shape[1]
	for i in range(n_repeats):
		# define network
		model = Sequential()
		model.add(Dense(50, input_shape=(n_words,), activation='relu'))
		model.add(Dense(1, activation='sigmoid'))
		# compile network
		model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
		# fit network
		model.fit(Xtrain, ytrain, epochs=50, verbose=2)
		# evaluate
		loss, acc = model.evaluate(Xtest, ytest, verbose=0)
		scores.append(acc)
		print('%d accuracy: %s' % ((i+1), acc))
	return scores

# prepare bag of words encoding of docs
def prepare_data(train_docs, test_docs, mode):
	# create the tokenizer
	tokenizer = Tokenizer()
	# fit the tokenizer on the documents
	tokenizer.fit_on_texts(train_docs)
	# encode training data set
	Xtrain = tokenizer.texts_to_matrix(train_docs, mode=mode)
	# encode training data set
	Xtest = tokenizer.texts_to_matrix(test_docs, mode=mode)
	return Xtrain, Xtest

# load the vocabulary
vocab_filename = 'vocab.txt'
vocab = load_doc(vocab_filename)
vocab = vocab.split()
vocab = set(vocab)
# load all training reviews
positive_lines = process_docs('txt_sentoken/pos', vocab, True)
negative_lines = process_docs('txt_sentoken/neg', vocab, True)
train_docs = negative_lines + positive_lines
# load all test reviews
positive_lines = process_docs('txt_sentoken/pos', vocab, False)
negative_lines = process_docs('txt_sentoken/neg', vocab, False)
test_docs = negative_lines + positive_lines
# prepare labels
ytrain = array([0 for _ in range(900)] + [1 for _ in range(900)])
ytest = array([0 for _ in range(100)] + [1 for _ in range(100)])

modes = ['binary', 'count', 'tfidf', 'freq']
results = DataFrame()
for mode in modes:
	# prepare data for mode
	Xtrain, Xtest = prepare_data(train_docs, test_docs, mode)
	# evaluate model on data for mode
	results[mode] = evaluate_mode(Xtrain, ytrain, Xtest, ytest)
# summarize results
print(results.describe())
# plot results
results.boxplot()
pyplot.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-4">4</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-6">6</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-8">8</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-10">10</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-12">12</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-14">14</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-16">16</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-18">18</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-20">20</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-22">22</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-24">24</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-26">26</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-28">28</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-30">30</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-32">32</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-34">34</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-36">36</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-38">38</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-40">40</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-42">42</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-44">44</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-46">46</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-48">48</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-50">50</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-52">52</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-54">54</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-56">56</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-58">58</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-60">60</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-62">62</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-64">64</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-66">66</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-68">68</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-70">70</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-72">72</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-74">74</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-76">76</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-78">78</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-80">80</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-82">82</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-84">84</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-86">86</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-88">88</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-90">90</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-92">92</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-94">94</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-96">96</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-98">98</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-100">100</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-102">102</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-104">104</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-106">106</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-108">108</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-110">110</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-112">112</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-114">114</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-116">116</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-118">118</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-120">120</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-122">122</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-124">124</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf362323054226-126">126</div><div class="crayon-num" data-line="crayon-5c0caa5cbf362323054226-127">127</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-1"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-2"><span class="crayon-e">from </span><span class="crayon-t">string</span><span class="crayon-h"> </span><span class="crayon-e">import </span><span class="crayon-e">punctuation</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-3"><span class="crayon-e">from </span><span class="crayon-e">os </span><span class="crayon-e">import </span><span class="crayon-e">listdir</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-4"><span class="crayon-e">from </span><span class="crayon-e">collections </span><span class="crayon-e">import </span><span class="crayon-e">Counter</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-5"><span class="crayon-e">from </span><span class="crayon-v">nltk</span><span class="crayon-sy">.</span><span class="crayon-e">corpus </span><span class="crayon-e">import </span><span class="crayon-e">stopwords</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">text </span><span class="crayon-e">import </span><span class="crayon-e">Tokenizer</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dropout</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-10"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-11"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-v">pyplot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-12"> </div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-13"><span class="crayon-p"># load doc into memory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-14"><span class="crayon-e">def </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-15"><span class="crayon-h"> </span><span class="crayon-p"># open the file as read only</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-16"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-17"><span class="crayon-h"> </span><span class="crayon-p"># read all text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-18"><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-19"><span class="crayon-h"> </span><span class="crayon-p"># close the file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-20"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-21"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-22"> </div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-23"><span class="crayon-p"># turn a doc into clean tokens</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-24"><span class="crayon-e">def </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-25"><span class="crayon-h"> </span><span class="crayon-p"># split into tokens by white space</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-26"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-27"><span class="crayon-h"> </span><span class="crayon-p"># remove punctuation from each token</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-28"><span class="crayon-h"> </span><span class="crayon-v">table</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">str</span><span class="crayon-sy">.</span><span class="crayon-e">maketrans</span><span class="crayon-sy">(</span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">punctuation</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-29"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">w</span><span class="crayon-sy">.</span><span class="crayon-e">translate</span><span class="crayon-sy">(</span><span class="crayon-v">table</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-30"><span class="crayon-h"> </span><span class="crayon-p"># remove remaining tokens that are not alphabetic</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-31"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-sy">.</span><span class="crayon-e">isalpha</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-32"><span class="crayon-h"> </span><span class="crayon-p"># filter out stop words</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-33"><span class="crayon-h"> </span><span class="crayon-v">stop_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">stopwords</span><span class="crayon-sy">.</span><span class="crayon-e">words</span><span class="crayon-sy">(</span><span class="crayon-s">'english'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-34"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">stop_words</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-35"><span class="crayon-h"> </span><span class="crayon-p"># filter out short tokens</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-36"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-t">word</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-37"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-38"> </div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-39"><span class="crayon-p"># load doc, clean and return line of tokens</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-40"><span class="crayon-e">def </span><span class="crayon-e">doc_to_line</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-41"><span class="crayon-h"> </span><span class="crayon-p"># load the doc</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-42"><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-43"><span class="crayon-h"> </span><span class="crayon-p"># clean doc</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-44"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-45"><span class="crayon-h"> </span><span class="crayon-p"># filter by vocab</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-46"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-47"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">' '</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-48"> </div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-49"><span class="crayon-p"># load all docs in a directory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-50"><span class="crayon-e">def </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">is_trian</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-51"><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-52"><span class="crayon-h"> </span><span class="crayon-p"># walk through all files in the folder</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-53"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">filename </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-54"><span class="crayon-h"> </span><span class="crayon-p"># skip any reviews in the test set</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-55"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">is_trian </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-56"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-57"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">is_trian </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-58"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-59"><span class="crayon-h"> </span><span class="crayon-p"># create the full path of the file to open</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-60"><span class="crayon-h"> </span><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'/'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">filename</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-61"><span class="crayon-h"> </span><span class="crayon-p"># load and clean the doc</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-62"><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">doc_to_line</span><span class="crayon-sy">(</span><span class="crayon-v">path</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-63"><span class="crayon-h"> </span><span class="crayon-p"># add to list</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-64"><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">line</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-65"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">lines</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-66"> </div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-67"><span class="crayon-p"># evaluate a neural network model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-68"><span class="crayon-e">def </span><span class="crayon-e">evaluate_mode</span><span class="crayon-sy">(</span><span class="crayon-v">Xtrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ytrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Xtest</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ytest</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-69"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-70"><span class="crayon-h"> </span><span class="crayon-v">n_repeats</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">30</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-71"><span class="crayon-h"> </span><span class="crayon-v">n_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Xtest</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-72"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_repeats</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-73"><span class="crayon-h"> </span><span class="crayon-p"># define network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-74"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-75"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">n_words</span><span class="crayon-sy">,</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-76"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-77"><span class="crayon-h"> </span><span class="crayon-p"># compile network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-78"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-79"><span class="crayon-h"> </span><span class="crayon-p"># fit network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-80"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">Xtrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ytrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-81"><span class="crayon-h"> </span><span class="crayon-p"># evaluate</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-82"><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">Xtest</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ytest</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-83"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">acc</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-84"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'%d accuracy: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-85"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-86"> </div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-87"><span class="crayon-p"># prepare bag of words encoding of docs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-88"><span class="crayon-e">def </span><span class="crayon-e">prepare_data</span><span class="crayon-sy">(</span><span class="crayon-v">train_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mode</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-89"><span class="crayon-h"> </span><span class="crayon-p"># create the tokenizer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-90"><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Tokenizer</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-91"><span class="crayon-h"> </span><span class="crayon-p"># fit the tokenizer on the documents</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-92"><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">fit_on_texts</span><span class="crayon-sy">(</span><span class="crayon-v">train_docs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-93"><span class="crayon-h"> </span><span class="crayon-p"># encode training data set</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-94"><span class="crayon-h"> </span><span class="crayon-v">Xtrain</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_matrix</span><span class="crayon-sy">(</span><span class="crayon-v">train_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mode</span><span class="crayon-o">=</span><span class="crayon-v">mode</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-95"><span class="crayon-h"> </span><span class="crayon-p"># encode training data set</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-96"><span class="crayon-h"> </span><span class="crayon-v">Xtest</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_matrix</span><span class="crayon-sy">(</span><span class="crayon-v">test_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mode</span><span class="crayon-o">=</span><span class="crayon-v">mode</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-97"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">Xtrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Xtest</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-98"> </div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-99"><span class="crayon-p"># load the vocabulary</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-100"><span class="crayon-v">vocab_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'vocab.txt'</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-101"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-102"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-103"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-104"><span class="crayon-p"># load all training reviews</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-105"><span class="crayon-v">positive_lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/pos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-106"><span class="crayon-v">negative_lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/neg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-107"><span class="crayon-v">train_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">negative_lines</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">positive_lines</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-108"><span class="crayon-p"># load all test reviews</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-109"><span class="crayon-v">positive_lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/pos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-110"><span class="crayon-v">negative_lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/neg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-111"><span class="crayon-v">test_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">negative_lines</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">positive_lines</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-112"><span class="crayon-p"># prepare labels</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-113"><span class="crayon-v">ytrain</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">900</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">900</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-114"><span class="crayon-v">ytest</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-115"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-116"><span class="crayon-v">modes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'binary'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'count'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'tfidf'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'freq'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-117"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-118"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">mode </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">modes</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-119"><span class="crayon-h"> </span><span class="crayon-p"># prepare data for mode</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-120"><span class="crayon-h"> </span><span class="crayon-v">Xtrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Xtest</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">prepare_data</span><span class="crayon-sy">(</span><span class="crayon-v">train_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mode</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-121"><span class="crayon-h"> </span><span class="crayon-p"># evaluate model on data for mode</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-122"><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-v">mode</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_mode</span><span class="crayon-sy">(</span><span class="crayon-v">Xtrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ytrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Xtest</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ytest</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-123"><span class="crayon-p"># summarize results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-124"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">describe</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-125"><span class="crayon-p"># plot results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf362323054226-126"><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">boxplot</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf362323054226-127"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0062 seconds] -->
<p>Running the example may take a while (about an hour on modern hardware with CPUs, not GPUs).</p>
<p>At the end of the run, summary statistics for each word scoring method are provided, summarizing the distribution of model skill scores across each of the 30 runs per mode.</p>
<p>We can see that the mean score of both the ‘<em>freq</em>‘ and ‘<em>binary</em>‘ methods appear to be better than ‘<em>count</em>‘ and ‘<em>tfidf</em>‘.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf364971261101" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
          binary     count      tfidf       freq
count  30.000000  30.00000  30.000000  30.000000
mean    0.915833   0.88900   0.856333   0.908167
std     0.009010   0.01012   0.013126   0.002451
min     0.900000   0.86500   0.830000   0.905000
25%     0.906250   0.88500   0.850000   0.905000
50%     0.915000   0.89000   0.857500   0.910000
75%     0.920000   0.89500   0.865000   0.910000
max     0.935000   0.90500   0.885000   0.910000</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf364971261101-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf364971261101-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf364971261101-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf364971261101-4">4</div><div class="crayon-num" data-line="crayon-5c0caa5cbf364971261101-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf364971261101-6">6</div><div class="crayon-num" data-line="crayon-5c0caa5cbf364971261101-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf364971261101-8">8</div><div class="crayon-num" data-line="crayon-5c0caa5cbf364971261101-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf364971261101-1">          binary     count      tfidf       freq</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf364971261101-2">count  30.000000  30.00000  30.000000  30.000000</div><div class="crayon-line" id="crayon-5c0caa5cbf364971261101-3">mean    0.915833   0.88900   0.856333   0.908167</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf364971261101-4">std     0.009010   0.01012   0.013126   0.002451</div><div class="crayon-line" id="crayon-5c0caa5cbf364971261101-5">min     0.900000   0.86500   0.830000   0.905000</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf364971261101-6">25%     0.906250   0.88500   0.850000   0.905000</div><div class="crayon-line" id="crayon-5c0caa5cbf364971261101-7">50%     0.915000   0.89000   0.857500   0.910000</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf364971261101-8">75%     0.920000   0.89500   0.865000   0.910000</div><div class="crayon-line" id="crayon-5c0caa5cbf364971261101-9">max     0.935000   0.90500   0.885000   0.910000</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>A box and whisker plot of the results is also presented, summarizing the accuracy distributions per configuration.</p>
<p>We can see that the distribution for the ‘freq’ configuration is tight, which is encouraging given that it is also well performing. Additionally, we can see that ‘binary’ achieved the best results with a modest spread and might be the preferred approach for this dataset.</p>
<div class="wp-caption aligncenter" id="attachment_4376" style="width: 1290px"><img alt="Box and Whisker Plot for Model Accuracy with Different Word Scoring Methods" class="size-full wp-image-4376" height="960" sizes="(max-width: 1280px) 100vw, 1280px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/Box-and-Whisker-Plot-for-Model-Accuracy-with-Different-Word-Scoring-Methods.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/Box-and-Whisker-Plot-for-Model-Accuracy-with-Different-Word-Scoring-Methods.png 1280w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/Box-and-Whisker-Plot-for-Model-Accuracy-with-Different-Word-Scoring-Methods-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/Box-and-Whisker-Plot-for-Model-Accuracy-with-Different-Word-Scoring-Methods-768x576.png 768w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/Box-and-Whisker-Plot-for-Model-Accuracy-with-Different-Word-Scoring-Methods-1024x768.png 1024w" width="1280"/><p class="wp-caption-text">Box and Whisker Plot for Model Accuracy with Different Word Scoring Methods</p></div>
<h2>Making a Prediction for New Reviews</h2>
<p>Finally, we can use the final model to make predictions for new textual reviews.</p>
<p>This is why we wanted the model in the first place.</p>
<p>Predicting the sentiment of new reviews involves following the same steps used to prepare the test data. Specifically, loading the text, cleaning the document, filtering tokens by the chosen vocabulary, converting the remaining tokens to a line, encoding it using the Tokenizer, and making a prediction.</p>
<p>We can make a prediction of a class value directly with the fit model by calling <em>predict()</em> that will return a value that can be rounded to an integer of 0 for a negative review and 1 for a positive review.</p>
<p>All of these steps can be put into a new function called <em>predict_sentiment()</em> that requires the review text, the vocabulary, the tokenizer, and the fit model, as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf368082466963" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# classify a review as negative (0) or positive (1)
def predict_sentiment(review, vocab, tokenizer, model):
	# clean
	tokens = clean_doc(review)
	# filter by vocab
	tokens = [w for w in tokens if w in vocab]
	# convert to line
	line = ' '.join(tokens)
	# encode
	encoded = tokenizer.texts_to_matrix([line], mode='freq')
	# prediction
	yhat = model.predict(encoded, verbose=0)
	return round(yhat[0,0])</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf368082466963-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf368082466963-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf368082466963-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf368082466963-4">4</div><div class="crayon-num" data-line="crayon-5c0caa5cbf368082466963-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf368082466963-6">6</div><div class="crayon-num" data-line="crayon-5c0caa5cbf368082466963-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf368082466963-8">8</div><div class="crayon-num" data-line="crayon-5c0caa5cbf368082466963-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf368082466963-10">10</div><div class="crayon-num" data-line="crayon-5c0caa5cbf368082466963-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf368082466963-12">12</div><div class="crayon-num" data-line="crayon-5c0caa5cbf368082466963-13">13</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf368082466963-1"><span class="crayon-p"># classify a review as negative (0) or positive (1)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf368082466963-2"><span class="crayon-e">def </span><span class="crayon-e">predict_sentiment</span><span class="crayon-sy">(</span><span class="crayon-v">review</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa5cbf368082466963-3"><span class="crayon-h"> </span><span class="crayon-p"># clean</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf368082466963-4"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">review</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf368082466963-5"><span class="crayon-h"> </span><span class="crayon-p"># filter by vocab</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf368082466963-6"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa5cbf368082466963-7"><span class="crayon-h"> </span><span class="crayon-p"># convert to line</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf368082466963-8"><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">' '</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf368082466963-9"><span class="crayon-h"> </span><span class="crayon-p"># encode</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf368082466963-10"><span class="crayon-h"> </span><span class="crayon-v">encoded</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_matrix</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">line</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mode</span><span class="crayon-o">=</span><span class="crayon-s">'freq'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf368082466963-11"><span class="crayon-h"> </span><span class="crayon-p"># prediction</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf368082466963-12"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">encoded</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa5cbf368082466963-13"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">round</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>We can now make predictions for new review texts.</p>
<p>Below is an example with both a clearly positive and a clearly negative review using the simple MLP developed above with the frequency word scoring mode.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf36a383369186" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# test positive text
text = 'Best movie ever!'
print(predict_sentiment(text, vocab, tokenizer, model))
# test negative text
text = 'This is a bad movie.'
print(predict_sentiment(text, vocab, tokenizer, model))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf36a383369186-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf36a383369186-2">2</div><div class="crayon-num" data-line="crayon-5c0caa5cbf36a383369186-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf36a383369186-4">4</div><div class="crayon-num" data-line="crayon-5c0caa5cbf36a383369186-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf36a383369186-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf36a383369186-1"><span class="crayon-p"># test positive text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf36a383369186-2"><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Best movie ever!'</span></div><div class="crayon-line" id="crayon-5c0caa5cbf36a383369186-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">predict_sentiment</span><span class="crayon-sy">(</span><span class="crayon-v">text</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf36a383369186-4"><span class="crayon-p"># test negative text</span></div><div class="crayon-line" id="crayon-5c0caa5cbf36a383369186-5"><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'This is a bad movie.'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf36a383369186-6"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">predict_sentiment</span><span class="crayon-sy">(</span><span class="crayon-v">text</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Running the example correctly classifies these reviews.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa5cbf36c291020141" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
1
0</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa5cbf36c291020141-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa5cbf36c291020141-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa5cbf36c291020141-1">1</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa5cbf36c291020141-2">0</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Ideally, we would fit the model on all available data (train and test) to create a <a href="http://machinelearningmastery.com/train-final-machine-learning-model/">final model</a> and save the model and tokenizer to file so that they can be loaded and used in new software.</p>
<h2>Extensions</h2>
<p>This section lists some extensions if you are looking to get more out of this tutorial.</p>
<ul>
<li><strong>Manage Vocabulary</strong>. Explore using a larger or smaller vocabulary. Perhaps you can get better performance with a smaller set of words.</li>
<li><strong>Tune the Network Topology</strong>. Explore alternate network topologies such as deeper or wider networks. Perhaps you can get better performance with a more suited network.</li>
<li><strong>Use Regularization</strong>. Explore the use of regularization techniques, such as dropout. Perhaps you can delay the convergence of the model and achieve better test set performance.</li>
</ul>
<h2>Further Reading</h2>
<p>This section provides more resources on the topic if you are looking go deeper.</p>
<h3>Dataset</h3>
<ul>
<li><a href="http://www.cs.cornell.edu/people/pabo/movie-review-data/">Movie Review Data</a></li>
<li><a href="http://xxx.lanl.gov/abs/cs/0409058">A Sentimental Education: Sentiment Analysis Using Subjectivity Summarization Based on Minimum Cuts</a>, 2004.</li>
<li><a href="http://www.cs.cornell.edu/people/pabo/movie-review-data/review_polarity.tar.gz">Movie Review Polarity Dataset</a> (.tgz)</li>
<li>Dataset Readme <a href="http://www.cs.cornell.edu/people/pabo/movie-review-data/poldata.README.2.0.txt">v2.0</a> and <a href="http://www.cs.cornell.edu/people/pabo/movie-review-data/README.1.1">v1.1</a>.</li>
</ul>
<h3>APIs</h3>
<ul>
<li><a href="http://www.nltk.org/api/nltk.tokenize.html">nltk.tokenize package API</a></li>
<li><a href="http://www.nltk.org/book/ch02.html">Chapter 2, Accessing Text Corpora and Lexical Resources</a></li>
<li><a href="https://docs.python.org/3/library/os.html">os API Miscellaneous operating system interfaces</a></li>
<li><a href="https://docs.python.org/3/library/collections.html">collections API – Container datatypes</a></li>
<li><a href="https://keras.io/preprocessing/text/#tokenizer">Tokenizer Keras API</a></li>
</ul>
<h2>Summary</h2>
<p>In this tutorial, you discovered how to develop a bag-of-words model for predicting the sentiment of movie reviews.</p>
<p>Specifically, you learned:</p>
<ul>
<li>How to prepare the review text data for modeling with a restricted vocabulary.</li>
<li>How to use the bag-of-words model to prepare train and test data.</li>
<li>How to develop a multilayer Perceptron bag-of-words model and use it to make predictions on new review text data.</li>
</ul>
<p>Do you have any questions?<br/>
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="awac-wrapper"><div class="awac widget text-42"> <div class="textwidget"><p></p><center><br/>
<div class="woo-sc-hr"></div>
<h2>Develop Deep Learning models for Text Data Today!</h2>
<p><a href="/deep-learning-for-nlp/"><img align="left" alt="Deep Learning for Natural Language Processing" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/11/DLFNLP-Cover-220.png" style="border: 0;"/></a></p>
<h4>Develop Your Own Text models in Minutes</h4>
<p>…with just a few lines of python code</p>
<p>Discover how in my new Ebook:<br/>
<a href="/deep-learning-for-nlp/">Deep Learning for Natural Language Processing</a></p>
<p>It provides <strong>self-study tutorials</strong> on topics like:<br/>
<em>Bag-of-Words, Word Embedding, Language Models, Caption Generation, Text Translation</em> and much more…</p>
<h4>Finally Bring Deep Learning to your Natural Language Processing Projects</h4>
<p>Skip the Academics. Just Results.</p>
<p><a href="/deep-learning-for-nlp/">Click to learn more</a>.<br/>
</p><div class="woo-sc-hr"></div><br/>
</center>
</div>
</div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-4375 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Develop+a+Deep+Learning+Bag-of-Words+Model+for+Predicting+Movie+Review+Sentiment&amp;url=https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
</section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/implementation-patterns-encoder-decoder-rnn-architecture-attention/" rel="prev"><i class="fa fa-angle-left"></i> Implementation Patterns for the Encoder-Decoder RNN Architecture with Attention</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/best-practices-document-classification-deep-learning/" rel="next">Best Practices for Document Classification with Deep Learning <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">65 Responses to <em>How to Develop a Deep Learning Bag-of-Words Model for Predicting Movie Review Sentiment</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-417247">
<div class="comment-container" id="li-comment-417247">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8d110a9452232c54b5a690ed28ae763b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8d110a9452232c54b5a690ed28ae763b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">xrickliao</span>
<span class="date">October 20, 2017 at 2:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-417247" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Excellent sample codes and explanation.</p>
<div class="reply">
<a aria-label="Reply to xrickliao" class="comment-reply-link" href="#comment-417247" onclick='return addComment.moveForm( "comment-417247", "417247", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417316">
<div class="comment-container" id="li-comment-417316">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 21, 2017 at 5:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-417316" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-417316" onclick='return addComment.moveForm( "comment-417316", "417316", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-417266">
<div class="comment-container" id="li-comment-417266">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a8a404e3ddf6be55ef21c4f4a1b5f77c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a8a404e3ddf6be55ef21c4f4a1b5f77c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alexander</span>
<span class="date">October 20, 2017 at 6:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-417266" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you, Jason. Very interest work.</p>
<div class="reply">
<a aria-label="Reply to Alexander" class="comment-reply-link" href="#comment-417266" onclick='return addComment.moveForm( "comment-417266", "417266", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417324">
<div class="comment-container" id="li-comment-417324">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 21, 2017 at 5:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-417324" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-417324" onclick='return addComment.moveForm( "comment-417324", "417324", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-417367">
<div class="comment-container" id="li-comment-417367">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1a8acce9f0591c5e2d78de4c70bebf10?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1a8acce9f0591c5e2d78de4c70bebf10?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hirak</span>
<span class="date">October 21, 2017 at 10:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-417367" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Very nicely explained. Thanks</p>
<div class="reply">
<a aria-label="Reply to Hirak" class="comment-reply-link" href="#comment-417367" onclick='return addComment.moveForm( "comment-417367", "417367", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417467">
<div class="comment-container" id="li-comment-417467">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 22, 2017 at 5:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-417467" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Hirak.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-417467" onclick='return addComment.moveForm( "comment-417467", "417467", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-417369">
<div class="comment-container" id="li-comment-417369">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c53d45266820c9aa9c40b98e409bee3d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c53d45266820c9aa9c40b98e409bee3d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chetana</span>
<span class="date">October 21, 2017 at 11:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-417369" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Well explained</p>
<div class="reply">
<a aria-label="Reply to Chetana" class="comment-reply-link" href="#comment-417369" onclick='return addComment.moveForm( "comment-417369", "417369", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417468">
<div class="comment-container" id="li-comment-417468">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 22, 2017 at 5:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-417468" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Chetana.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-417468" onclick='return addComment.moveForm( "comment-417468", "417468", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-417487">
<div class="comment-container" id="li-comment-417487">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d2f32da397c017a33e327589159f7155?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d2f32da397c017a33e327589159f7155?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rajkumar J Bhojan</span>
<span class="date">October 22, 2017 at 7:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-417487" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you, Jason, well explained.</p>
<div class="reply">
<a aria-label="Reply to Rajkumar J Bhojan" class="comment-reply-link" href="#comment-417487" onclick='return addComment.moveForm( "comment-417487", "417487", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417488">
<div class="comment-container" id="li-comment-417488">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 22, 2017 at 7:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-417488" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-417488" onclick='return addComment.moveForm( "comment-417488", "417488", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-417502">
<div class="comment-container" id="li-comment-417502">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/46644c113f6118b4f8b15158ca502b23?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/46644c113f6118b4f8b15158ca502b23?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">wed</span>
<span class="date">October 22, 2017 at 1:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-417502" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,can you give me the  source code,thank you84!</p>
<div class="reply">
<a aria-label="Reply to wed" class="comment-reply-link" href="#comment-417502" onclick='return addComment.moveForm( "comment-417502", "417502", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417560">
<div class="comment-container" id="li-comment-417560">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 23, 2017 at 5:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-417560" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The source code is on the post. Use copy-paste.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-417560" onclick='return addComment.moveForm( "comment-417560", "417560", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-417503">
<div class="comment-container" id="li-comment-417503">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/35b7f04d094f636f3846d65a85d4e034?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/35b7f04d094f636f3846d65a85d4e034?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">SK</span>
<span class="date">October 22, 2017 at 2:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-417503" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Jason. You are playing a key role in my career growth.</p>
<div class="reply">
<a aria-label="Reply to SK" class="comment-reply-link" href="#comment-417503" onclick='return addComment.moveForm( "comment-417503", "417503", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417561">
<div class="comment-container" id="li-comment-417561">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 23, 2017 at 5:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-417561" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad to hear that!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-417561" onclick='return addComment.moveForm( "comment-417561", "417561", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-417611">
<div class="comment-container" id="li-comment-417611">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0a0b858dc2199c1a2d2f356d38fdf7d2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0a0b858dc2199c1a2d2f356d38fdf7d2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Arthur</span>
<span class="date">October 23, 2017 at 3:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-417611" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great article, Jason.<br/>
Actually, there was a small mistake in those line  below:<br/>
positive_lines = process_docs(‘txt_sentoken/neg’, vocab)<br/>
negative_lines = process_docs(‘txt_sentoken/pos’, vocab)</p>
<div class="reply">
<a aria-label="Reply to Arthur" class="comment-reply-link" href="#comment-417611" onclick='return addComment.moveForm( "comment-417611", "417611", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417618">
<div class="comment-container" id="li-comment-417618">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 23, 2017 at 4:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-417618" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Arthur, fixed!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-417618" onclick='return addComment.moveForm( "comment-417618", "417618", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-417859">
<div class="comment-container" id="li-comment-417859">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/eb0618ec9af91261b74f1a15addaf1d3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/eb0618ec9af91261b74f1a15addaf1d3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://lifeasweexplore.com" rel="external nofollow">Kapil</a></span>
<span class="date">October 25, 2017 at 9:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-417859" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Excellent articles Jason. My comment is not just for this specific article but in general on this website. This is really helpful.</p>
<div class="reply">
<a aria-label="Reply to Kapil" class="comment-reply-link" href="#comment-417859" onclick='return addComment.moveForm( "comment-417859", "417859", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417883">
<div class="comment-container" id="li-comment-417883">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 25, 2017 at 4:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-417883" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Kapil!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-417883" onclick='return addComment.moveForm( "comment-417883", "417883", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-419334">
<div class="comment-container" id="li-comment-419334">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5adf2501006ef064260b2f7b4b24d21d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5adf2501006ef064260b2f7b4b24d21d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Manish</span>
<span class="date">November 8, 2017 at 9:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-419334" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank for such a nice and concise article!</p>
<div class="reply">
<a aria-label="Reply to Manish" class="comment-reply-link" href="#comment-419334" onclick='return addComment.moveForm( "comment-419334", "419334", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-419350">
<div class="comment-container" id="li-comment-419350">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 8, 2017 at 9:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-419350" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-419350" onclick='return addComment.moveForm( "comment-419350", "419350", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-419765">
<div class="comment-container" id="li-comment-419765">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7257a96ef00750599cd14c1057f19de4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7257a96ef00750599cd14c1057f19de4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vijayaraghavan</span>
<span class="date">November 12, 2017 at 2:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-419765" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Sir,</p>
<p>Could you please also help us with the above kind of articles in R.</p>
<p>I am a R learner and looking for articles from people like you for my learning</p>
<p>Your help will be appreciated.</p>
<p>Thanks<br/>
Rgds<br/>
Vijay</p>
<div class="reply">
<a aria-label="Reply to Vijayaraghavan" class="comment-reply-link" href="#comment-419765" onclick='return addComment.moveForm( "comment-419765", "419765", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-419794">
<div class="comment-container" id="li-comment-419794">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 12, 2017 at 9:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-419794" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion Vijay.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-419794" onclick='return addComment.moveForm( "comment-419794", "419794", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-421761">
<div class="comment-container" id="li-comment-421761">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9d76e9ab88498f751cc973377518fbd0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9d76e9ab88498f751cc973377518fbd0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jacek</span>
<span class="date">December 1, 2017 at 1:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-421761" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Excellent work! Very clear presentation.<br/>
Best regards</p>
<div class="reply">
<a aria-label="Reply to Jacek" class="comment-reply-link" href="#comment-421761" onclick='return addComment.moveForm( "comment-421761", "421761", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-421810">
<div class="comment-container" id="li-comment-421810">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 1, 2017 at 7:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-421810" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jacek.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-421810" onclick='return addComment.moveForm( "comment-421810", "421810", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-425522">
<div class="comment-container" id="li-comment-425522">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cf1fd1a96468f9c165fe765cfd267404?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cf1fd1a96468f9c165fe765cfd267404?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://NA" rel="external nofollow">Sappy</a></span>
<span class="date">January 3, 2018 at 5:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-425522" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I created the model as instructed. But when I try to predict for a new text then I get an error saying the input shape is different.<br/>
When we fit a model, the input shape is fetched based on the training data. However, tokenizer.text_to_matrix gives a different shape for new text. Thereby, model cannot be used to predict new text.<br/>
Could you please suggest the solution for the same.</p>
<p>Thanks,<br/>
Sappy</p>
<div class="reply">
<a aria-label="Reply to Sappy" class="comment-reply-link" href="#comment-425522" onclick='return addComment.moveForm( "comment-425522", "425522", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-425572">
<div class="comment-container" id="li-comment-425572">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 4, 2018 at 8:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-425572" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You must prepare new text in exactly the same way as training data text.</p>
<p>I recommend using the same functions and even encoders used to prepare training data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425572" onclick='return addComment.moveForm( "comment-425572", "425572", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-453142">
<div class="comment-container" id="li-comment-453142">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f74bf81dc8109b536e144a22da86a3e6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f74bf81dc8109b536e144a22da86a3e6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Partha Shankar Nayak</span>
<span class="date">October 30, 2018 at 6:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-453142" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dr. Jason,</p>
<p>I have used the model and saved to the disk as .h5 file. Then I loaded it with the function load_model(). Now I tried prediction using the above code and getting this error: ‘Tokenizer’ object has no attribute ‘word_index’. The same functions have been used throughout. What is wrong I couldn’t find out. Please suggest for corrections.</p>
<div class="reply">
<a aria-label="Reply to Partha Shankar Nayak" class="comment-reply-link" href="#comment-453142" onclick='return addComment.moveForm( "comment-453142", "453142", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-453194">
<div class="comment-container" id="li-comment-453194">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 31, 2018 at 6:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-453194" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m sorry to hear that, I have not seen this error before.</p>
<p>I have some suggestions here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453194" onclick='return addComment.moveForm( "comment-453194", "453194", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-427179">
<div class="comment-container" id="li-comment-427179">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/04d1e6feb86036ca3bc8d606febe70af?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/04d1e6feb86036ca3bc8d606febe70af?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://silversurfer0.github.io" rel="external nofollow">Vladimir</a></span>
<span class="date">January 22, 2018 at 11:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-427179" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Dr. Jason! Such a very valuable tutorial!</p>
<p>While playing with the models I’ve noticed, that splitting data (at least in this case) at different points results to VERY different accuracy (up to 5% difference). Say, we get test data from the beginning/middle or from the last reviews – all would yield different results. So, furthermore, I’ve experimented with sklearn train_test_split with different random_state numbers to split the dataset at different points – and the results depend so much on. (That is because tokenizer fits on varying set of tokens each time.)<br/>
What would be the best approach to tackle such situation and get the best out of it?</p>
<div class="reply">
<a aria-label="Reply to Vladimir" class="comment-reply-link" href="#comment-427179" onclick='return addComment.moveForm( "comment-427179", "427179", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-427246">
<div class="comment-container" id="li-comment-427246">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 23, 2018 at 7:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-427246" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Excellent and an important observation Vladimir.</p>
<p>See this post for a more robust model evaluation strategy:<br/>
<a href="https://machinelearningmastery.com/evaluate-skill-deep-learning-models/" rel="nofollow">https://machinelearningmastery.com/evaluate-skill-deep-learning-models/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-427246" onclick='return addComment.moveForm( "comment-427246", "427246", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-427275">
<div class="comment-container" id="li-comment-427275">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/04d1e6feb86036ca3bc8d606febe70af?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/04d1e6feb86036ca3bc8d606febe70af?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vladimir</span>
<span class="date">January 23, 2018 at 10:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-427275" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice, I like that simple approach. Thanks for sharing.</p>
<div class="reply">
<a aria-label="Reply to Vladimir" class="comment-reply-link" href="#comment-427275" onclick='return addComment.moveForm( "comment-427275", "427275", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-427414">
<div class="comment-container" id="li-comment-427414">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 24, 2018 at 9:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-427414" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-427414" onclick='return addComment.moveForm( "comment-427414", "427414", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-427217">
<div class="comment-container" id="li-comment-427217">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/04d1e6feb86036ca3bc8d606febe70af?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/04d1e6feb86036ca3bc8d606febe70af?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://silversurfer0.github.io" rel="external nofollow">Vladimir</a></span>
<span class="date">January 23, 2018 at 5:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-427217" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason,</p>
<p>Please have a look at a more gracious approach to preprocess text, encode it as a term-matrix and convert to an array. I’ve created a tutorial in my blog, inspired by your awesome articles:<br/>
<a href="https://silversurfer0.github.io/tutorial/2018/01/22/NLP_with_Keras.html" rel="nofollow">https://silversurfer0.github.io/tutorial/2018/01/22/NLP_with_Keras.html</a></p>
<p>So, the idea is to use sklearn CountVectorizer! It accepts arguments and make all the necessary preprocessing: tokenize, define word size, filter stopwords, includes words with certain frequency occurence, and even more allows to make ngrams!</p>
<p>Grateful to you,<br/>
Cheers! –Vladimir</p>
<div class="reply">
<a aria-label="Reply to Vladimir" class="comment-reply-link" href="#comment-427217" onclick='return addComment.moveForm( "comment-427217", "427217", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-427258">
<div class="comment-container" id="li-comment-427258">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 23, 2018 at 8:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-427258" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice one!</p>
<p>Also, sometimes it is good to split out all the pieces for learning (e.g. for beginners) or for more control/fine tuning.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-427258" onclick='return addComment.moveForm( "comment-427258", "427258", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-434010">
<div class="comment-container" id="li-comment-434010">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cbde79b0c9160f999dea6a8fb683c28c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cbde79b0c9160f999dea6a8fb683c28c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">NITHIN K SAMSAN</span>
<span class="date">April 3, 2018 at 7:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-434010" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Really helpful!!!!!!!</p>
<div class="reply">
<a aria-label="Reply to NITHIN K SAMSAN" class="comment-reply-link" href="#comment-434010" onclick='return addComment.moveForm( "comment-434010", "434010", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-434062">
<div class="comment-container" id="li-comment-434062">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 4, 2018 at 6:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-434062" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, I’m glad to hear that.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-434062" onclick='return addComment.moveForm( "comment-434062", "434062", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-434145">
<div class="comment-container" id="li-comment-434145">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a35424ea8c35c4c0af7501648b4b8956?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a35424ea8c35c4c0af7501648b4b8956?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nishnat Preethan</span>
<span class="date">April 5, 2018 at 2:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-434145" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p> I created the model as instructed. But when I try to predict for a new text then when I always get result as 0.  Please help.</p>
<div class="reply">
<a aria-label="Reply to Nishnat Preethan" class="comment-reply-link" href="#comment-434145" onclick='return addComment.moveForm( "comment-434145", "434145", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-434185">
<div class="comment-container" id="li-comment-434185">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 5, 2018 at 6:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-434185" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps your model requires more tuning?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-434185" onclick='return addComment.moveForm( "comment-434185", "434185", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-439562">
<div class="comment-container" id="li-comment-439562">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7b1c2698616e67dad2a21d952f1c52db?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7b1c2698616e67dad2a21d952f1c52db?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Riad</span>
<span class="date">June 3, 2018 at 12:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-439562" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>when I run the prediction function it gives me this …!!! </p>
<p>print(predict_sentiment(text, vocab, tokenizer, model))<br/>
NameError: name ‘model’ is not defined</p>
<div class="reply">
<a aria-label="Reply to Riad" class="comment-reply-link" href="#comment-439562" onclick='return addComment.moveForm( "comment-439562", "439562", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-439595">
<div class="comment-container" id="li-comment-439595">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 3, 2018 at 6:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-439595" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Looks like you might have missed some of the code from the tutorial.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-439595" onclick='return addComment.moveForm( "comment-439595", "439595", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-439853">
<div class="comment-container" id="li-comment-439853">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7b1c2698616e67dad2a21d952f1c52db?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7b1c2698616e67dad2a21d952f1c52db?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Riad</span>
<span class="date">June 5, 2018 at 10:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-439853" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is the code I run it, please Mr jason help me and tell me where is the error that I made or what I missed</p>
<p>from numpy import array<br/>
from string import punctuation<br/>
from os import listdir<br/>
from collections import Counter<br/>
from nltk.corpus import stopwords<br/>
from keras.preprocessing.text import Tokenizer<br/>
from keras.models import Sequential<br/>
from keras.layers import Dense<br/>
from keras.layers import Dropout<br/>
from pandas import DataFrame<br/>
from matplotlib import pyplot</p>
<p># load doc into memory<br/>
def load_doc(filename):<br/>
	# open the file as read only<br/>
	file = open(filename, ‘r’)<br/>
	# read all text<br/>
	text = file.read()<br/>
	# close the file<br/>
	file.close()<br/>
	return text</p>
<p># turn a doc into clean tokens<br/>
def clean_doc(doc):<br/>
	# split into tokens by white space<br/>
	tokens = doc.split()<br/>
	# remove punctuation from each token<br/>
	table = str.maketrans(”, ”, punctuation)<br/>
	tokens = [w.translate(table) for w in tokens]<br/>
	# remove remaining tokens that are not alphabetic<br/>
	tokens = [word for word in tokens if word.isalpha()]<br/>
	# filter out stop words<br/>
	stop_words = set(stopwords.words(‘english’))<br/>
	tokens = [w for w in tokens if not w in stop_words]<br/>
	# filter out short tokens<br/>
	tokens = [word for word in tokens if len(word) &gt; 1]<br/>
	return tokens</p>
<p># load doc, clean and return line of tokens<br/>
def doc_to_line(filename, vocab):<br/>
	# load the doc<br/>
	doc = load_doc(filename)<br/>
	# clean doc<br/>
	tokens = clean_doc(doc)<br/>
	# filter by vocab<br/>
	tokens = [w for w in tokens if w in vocab]<br/>
	return ‘ ‘.join(tokens)</p>
<p># load all docs in a directory<br/>
def process_docs(directory, vocab, is_trian):<br/>
	lines = list()<br/>
	# walk through all files in the folder<br/>
	for filename in listdir(directory):<br/>
		# skip any reviews in the test set<br/>
		if is_trian and filename.startswith(‘cv9’):<br/>
			continue<br/>
		if not is_trian and not filename.startswith(‘cv9’):<br/>
			continue<br/>
		# create the full path of the file to open<br/>
		path = directory + ‘/’ + filename<br/>
		# load and clean the doc<br/>
		line = doc_to_line(path, vocab)<br/>
		# add to list<br/>
		lines.append(line)<br/>
	return lines</p>
<p># evaluate a neural network model<br/>
def evaluate_mode(Xtrain, ytrain, Xtest, ytest):<br/>
	scores = list()<br/>
	n_repeats = 2<br/>
	n_words = Xtest.shape[1]<br/>
	for i in range(n_repeats):<br/>
		# define network<br/>
		model = Sequential()<br/>
		model.add(Dense(50, input_shape=(n_words,), activation=’relu’))<br/>
		model.add(Dense(1, activation=’sigmoid’))<br/>
		# compile network<br/>
		model.compile(loss=’binary_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])<br/>
		# fit network<br/>
		model.fit(Xtrain, ytrain, epochs=50, verbose=2)<br/>
		# evaluate<br/>
		loss, acc = model.evaluate(Xtest, ytest, verbose=0)<br/>
		scores.append(acc)<br/>
		print(‘%d accuracy: %s’ % ((i+1), acc))<br/>
	return scores</p>
<p># prepare bag of words encoding of docs<br/>
def prepare_data(train_docs, test_docs, mode):<br/>
	# create the tokenizer<br/>
	tokenizer = Tokenizer()<br/>
	# fit the tokenizer on the documents<br/>
	tokenizer.fit_on_texts(train_docs)<br/>
	# encode training data set<br/>
	Xtrain = tokenizer.texts_to_matrix(train_docs, mode=mode)<br/>
	# encode training data set<br/>
	Xtest = tokenizer.texts_to_matrix(test_docs, mode=mode)<br/>
	return Xtrain, Xtest</p>
<p># load the vocabulary<br/>
vocab_filename = ‘vocab.txt’<br/>
vocab = load_doc(vocab_filename)<br/>
vocab = vocab.split()<br/>
vocab = set(vocab)<br/>
# load all training reviews<br/>
positive_lines = process_docs(‘txt_sentoken/pos’, vocab, True)<br/>
negative_lines = process_docs(‘txt_sentoken/neg’, vocab, True)<br/>
train_docs = negative_lines + positive_lines<br/>
# load all test reviews<br/>
positive_lines = process_docs(‘txt_sentoken/pos’, vocab, False)<br/>
negative_lines = process_docs(‘txt_sentoken/neg’, vocab, False)<br/>
test_docs = negative_lines + positive_lines<br/>
# prepare labels<br/>
ytrain = array([0 for _ in range(900)] + [1 for _ in range(900)])<br/>
ytest = array([0 for _ in range(100)] + [1 for _ in range(100)])</p>
<p>modes = [‘binary’, ‘count’, ‘tfidf’, ‘freq’]<br/>
results = DataFrame()<br/>
for mode in modes:<br/>
	# prepare data for mode<br/>
	Xtrain, Xtest = prepare_data(train_docs, test_docs, mode)<br/>
	# evaluate model on data for mode<br/>
	results[mode] = evaluate_mode(Xtrain, ytrain, Xtest, ytest)</p>
<p># summarize results<br/>
print(results.describe())<br/>
# plot results<br/>
#results.boxplot()<br/>
#pyplot.show()</p>
<p># classify a review as negative (0) or positive (1)<br/>
def predict_sentiment(review, vocab, tokenizer, model):<br/>
	# clean<br/>
	tokens = clean_doc(review)<br/>
	# filter by vocab<br/>
	tokens = [w for w in tokens if w in vocab]<br/>
	# convert to line<br/>
	line = ‘ ‘.join(tokens)<br/>
	# encode<br/>
	encoded = tokenizer.texts_to_matrix([line], mode=’freq’)<br/>
	# prediction<br/>
	yhat = model.predict(encoded, verbose=0)<br/>
	return round(yhat[0,0])</p>
<p># test positive text<br/>
text = ‘Best movie ever!’<br/>
print(predict_sentiment(text, vocab, tokenizer, model))<br/>
# test negative text<br/>
text = ‘This is a bad movie.’<br/>
print(predict_sentiment(text, vocab, tokenizer, model))</p>
<div class="reply">
<a aria-label="Reply to Riad" class="comment-reply-link" href="#comment-439853" onclick='return addComment.moveForm( "comment-439853", "439853", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-439869">
<div class="comment-container" id="li-comment-439869">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 5, 2018 at 3:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-439869" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have some ideas here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/can-you-read-review-or-debug-my-code" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/can-you-read-review-or-debug-my-code</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-439869" onclick='return addComment.moveForm( "comment-439869", "439869", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-439903">
<div class="comment-container" id="li-comment-439903">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7b1c2698616e67dad2a21d952f1c52db?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7b1c2698616e67dad2a21d952f1c52db?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Riad</span>
<span class="date">June 5, 2018 at 9:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-439903" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you so much Mr Jason</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-439751">
<div class="comment-container" id="li-comment-439751">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/40f082d9ffd63b343dd61a658d87efa7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/40f082d9ffd63b343dd61a658d87efa7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">adam</span>
<span class="date">June 4, 2018 at 6:24 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-439751" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>when I run the prediction function it gives me this …!!!</p>
<p>print(predict_sentiment(text, vocab, tokenizer, model))<br/>
NameError: name ‘model’ is not defined same problem , do i have to make a new file and import the other files or what ? (sorry newbie in python)</p>
<div class="reply">
<a aria-label="Reply to adam" class="comment-reply-link" href="#comment-439751" onclick='return addComment.moveForm( "comment-439751", "439751", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-3" id="comment-439827">
<div class="comment-container" id="li-comment-439827">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 5, 2018 at 6:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-439827" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Looks like you have not copied all of the code from the example.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-439827" onclick='return addComment.moveForm( "comment-439827", "439827", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-4" id="comment-439919">
<div class="comment-container" id="li-comment-439919">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/40f082d9ffd63b343dd61a658d87efa7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/40f082d9ffd63b343dd61a658d87efa7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">adam</span>
<span class="date">June 6, 2018 at 2:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-439919" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can you please write us a full code ? i dont get how to include the last part the function part to get result of one tense !</p>
<div class="reply">
<a aria-label="Reply to adam" class="comment-reply-link" href="#comment-439919" onclick='return addComment.moveForm( "comment-439919", "439919", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-439602">
<div class="comment-container" id="li-comment-439602">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0eb5aa8f4a920e2e538a00517ca4b0d5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0eb5aa8f4a920e2e538a00517ca4b0d5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aminu Abdulsalami</span>
<span class="date">June 3, 2018 at 7:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-439602" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great content.</p>
<div class="reply">
<a aria-label="Reply to Aminu Abdulsalami" class="comment-reply-link" href="#comment-439602" onclick='return addComment.moveForm( "comment-439602", "439602", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-439682">
<div class="comment-container" id="li-comment-439682">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 4, 2018 at 6:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-439682" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-439682" onclick='return addComment.moveForm( "comment-439682", "439682", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-439715">
<div class="comment-container" id="li-comment-439715">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a10cd3147ecfc44c8572cb90a0db81a2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a10cd3147ecfc44c8572cb90a0db81a2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Yu Ming</span>
<span class="date">June 4, 2018 at 1:03 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-439715" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>many thanks !</p>
<div class="reply">
<a aria-label="Reply to Yu Ming" class="comment-reply-link" href="#comment-439715" onclick='return addComment.moveForm( "comment-439715", "439715", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-439728">
<div class="comment-container" id="li-comment-439728">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 4, 2018 at 2:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-439728" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad it helped.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-439728" onclick='return addComment.moveForm( "comment-439728", "439728", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-439796">
<div class="comment-container" id="li-comment-439796">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/324f34377e2c600a951ef5ff9e1d461f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/324f34377e2c600a951ef5ff9e1d461f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Juan</span>
<span class="date">June 5, 2018 at 12:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-439796" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Do you think that stemming might improve the classification accuracy or do you think it might lead to overfitting?</p>
<div class="reply">
<a aria-label="Reply to Juan" class="comment-reply-link" href="#comment-439796" onclick='return addComment.moveForm( "comment-439796", "439796", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-439835">
<div class="comment-container" id="li-comment-439835">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 5, 2018 at 6:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-439835" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It will likely simplify the problem and in turn lift skill.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-439835" onclick='return addComment.moveForm( "comment-439835", "439835", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-440290">
<div class="comment-container" id="li-comment-440290">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/07a10432e07d40e254fe9e987a0e872c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/07a10432e07d40e254fe9e987a0e872c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Louly</span>
<span class="date">June 9, 2018 at 10:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-440290" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can you please clarify the predict function more please, and do i need to run the train snippet each time i want to test that on a new data  ? thank u</p>
<div class="reply">
<a aria-label="Reply to Louly" class="comment-reply-link" href="#comment-440290" onclick='return addComment.moveForm( "comment-440290", "440290", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-440342">
<div class="comment-container" id="li-comment-440342">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 10, 2018 at 5:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-440342" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I explain more how to make predictions with Keras models here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-make-predictions" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-make-predictions</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-440342" onclick='return addComment.moveForm( "comment-440342", "440342", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-445009">
<div class="comment-container" id="li-comment-445009">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b7d93b68858e06c3ddd8e40665260f03?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b7d93b68858e06c3ddd8e40665260f03?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nil</span>
<span class="date">August 2, 2018 at 12:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-445009" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi DR Jason,</p>
<p>It is a very good post, thank you it cleared me many points.<br/>
I have a question. I would like to know if instead of train test split it can be used k-fold cross validation? Or in the case of document classification it is not necessary k-fold cross validation? </p>
<p>Best regards.</p>
<div class="reply">
<a aria-label="Reply to Nil" class="comment-reply-link" href="#comment-445009" onclick='return addComment.moveForm( "comment-445009", "445009", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-445032">
<div class="comment-container" id="li-comment-445032">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 2, 2018 at 6:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-445032" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It is a good idea if you have the resources, we often do not when it comes to NLP models.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-445032" onclick='return addComment.moveForm( "comment-445032", "445032", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-445067">
<div class="comment-container" id="li-comment-445067">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b7d93b68858e06c3ddd8e40665260f03?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b7d93b68858e06c3ddd8e40665260f03?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nil</span>
<span class="date">August 2, 2018 at 6:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-445067" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you.</p>
<p>Best Regards.</p>
<div class="reply">
<a aria-label="Reply to Nil" class="comment-reply-link" href="#comment-445067" onclick='return addComment.moveForm( "comment-445067", "445067", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-448679">
<div class="comment-container" id="li-comment-448679">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cd006d441aaf38e38693ef5992c76360?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cd006d441aaf38e38693ef5992c76360?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://www.linkedin.com/in/eanunez/" rel="external nofollow">Emmanuel</a></span>
<span class="date">September 13, 2018 at 1:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-448679" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>You’re blog, like this one helps me a lot for my work.<br/>
I would like to see how ‘Embedding’ would perform as compared to Bag-of-Words.<br/>
Do you have a tutorial using embedding for sentiment analysis? </p>
<p>Kind Regards,<br/>
Emmanuel</p>
<div class="reply">
<a aria-label="Reply to Emmanuel" class="comment-reply-link" href="#comment-448679" onclick='return addComment.moveForm( "comment-448679", "448679", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-448684">
<div class="comment-container" id="li-comment-448684">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 13, 2018 at 2:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-448684" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Emmanuel!</p>
<p>Yes, I have many such tutorials, type embedding into the blog search.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-448684" onclick='return addComment.moveForm( "comment-448684", "448684", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-448699">
<div class="comment-container" id="li-comment-448699">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cd006d441aaf38e38693ef5992c76360?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cd006d441aaf38e38693ef5992c76360?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://www.linkedin.com/in/eanunez/" rel="external nofollow">Emmanuel</a></span>
<span class="date">September 13, 2018 at 5:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-448699" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you. My goal is to improve the performance of my existing ‘classical’ bag-of-words method using Multinominal Bayesian, for both sentiment analysis and document classification. It works well with document classification.<br/>
However, I am looking for a model with a better performance, especially for my sentiment analysis, given that comments are multiple languages. </p>
<p>Would you consider/think that using a multi-channel, N-gram in a CNN would improve the performance, in general?</p>
<p>Many thanks for the response :).</p>
<div class="reply">
<a aria-label="Reply to Emmanuel" class="comment-reply-link" href="#comment-448699" onclick='return addComment.moveForm( "comment-448699", "448699", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-448739">
<div class="comment-container" id="li-comment-448739">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 14, 2018 at 6:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-448739" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I wouldn’t guess, I would design experiments to discover.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-448739" onclick='return addComment.moveForm( "comment-448739", "448739", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-448782">
<div class="comment-container" id="li-comment-448782">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cd006d441aaf38e38693ef5992c76360?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cd006d441aaf38e38693ef5992c76360?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Emmanuel</span>
<span class="date">September 14, 2018 at 3:09 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-448782" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It actually improved the accuracy!</p>
<p>Thank you so much for the great tutorial! Your tutorials has greatly improved my skills and understanding in ML.</p>
<p>Cheers,<br/>
Emmanuel</p>
<div class="reply">
<a aria-label="Reply to Emmanuel" class="comment-reply-link" href="#comment-448782" onclick='return addComment.moveForm( "comment-448782", "448782", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-448849">
<div class="comment-container" id="li-comment-448849">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 15, 2018 at 6:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-448849" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, nice work!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-448849" onclick='return addComment.moveForm( "comment-448849", "448849", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-451772">
<div class="comment-container" id="li-comment-451772">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2b78834545c99099cc9c435e3d0a86d3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2b78834545c99099cc9c435e3d0a86d3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Marcus</span>
<span class="date">October 16, 2018 at 2:45 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-451772" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, I’m newer to Python … would love to set up what you provided guidance on above … I’ve downloaded the movie preview data set … how do I run the first set of code though? “An example of cleaning the first positive review is listed below.” … when I put this code into IDLE on Python it returns a syntax error. My apologies for such a newbie question … I imagine once I get how to apply your code I can get the rest working. </p>
<p>Thanks for such a wonderful write up! Hope I can get it running soon.</p>
<div class="reply">
<a aria-label="Reply to Marcus" class="comment-reply-link" href="#comment-451772" onclick='return addComment.moveForm( "comment-451772", "451772", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-451835">
<div class="comment-container" id="li-comment-451835">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 17, 2018 at 6:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/#comment-451835" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I recommend running code from the command line, I have an example here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-run-a-script-from-the-command-line" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-run-a-script-from-the-command-line</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-451835" onclick='return addComment.moveForm( "comment-451835", "451835", "respond", "4375" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/deep-learning-bag-of-words-model-sentiment-analysis/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="4375"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="fa8ddfe499"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="185"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery!</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Jason Brownlee, PhD
<br/>
I write tutorials to help developers (<i>like you</i>) get results with machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-43"> <div class="textwidget"><p></p><center><br/>
<strong>Deep Learning for NLP</strong><br/>
Develop deep learning models for text data.
<p><a href="/deep-learning-for-nlp/">Click to Get Started Now!</a><br/>
<a href="/deep-learning-for-nlp/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/11/DLFNLP-Cover-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch"><img alt="How to Develop a Neural Machine Translation System in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/01/How-to-Develop-a-Neural-Machine-Translation-System-in-Keras-150x150.jpg" title="How to Develop a Neural Machine Translation System from Scratch" width="45"/></a> <a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch">How to Develop a Neural Machine Translation System from Scratch</a>
<span class="meta">January 10, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning"><img alt="Difference Between Classification and Regression in Machine Learning" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/Difference-Between-Classification-and-Regression-in-Machine-Learning-150x150.jpg" title="Difference Between Classification and Regression in Machine Learning" width="45"/></a> <a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning">Difference Between Classification and Regression in Machine Learning</a>
<span class="meta">December 11, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem..."><img alt="So, You are Working on a Machine Learning Problem..." class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/So-You-are-Working-on-a-Machine-Learning-Problem...-150x150.jpg" title="So, You are Working on a Machine Learning Problem..." width="45"/></a> <a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem…">So, You are Working on a Machine Learning Problem…</a>
<span class="meta">April 4, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis"><img alt="Plot of the Multichannel Convolutional Neural Network For Text" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-150x150.png" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis" width="45"/></a> <a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis">How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis</a>
<span class="meta">January 12, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras"><img alt="How to Make Classification and Regression Predictions for Deep Learning Models in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/How-to-Make-Classification-and-Regression-Predictions-for-Deep-Learning-Models-in-Keras-150x150.jpg" title="How to Make Predictions with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras">How to Make Predictions with Keras</a>
<span class="meta">April 9, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)"><img alt="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/11-Classical-Time-Series-Forecasting-Methods-in-Python-Cheat-Sheet-150x150.jpg" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)">11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)</a>
<span class="meta">August 6, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras"><img alt="How to Visualize a Deep Learning Neural Network Model in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/How-to-Visualize-a-Deep-Learning-Neural-Network-Model-in-Keras-150x150.jpg" title="How to Visualize a Deep Learning Neural Network Model in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras">How to Visualize a Deep Learning Neural Network Model in Keras</a>
<span class="meta">December 13, 2017</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> <div class="widget_text widget widget_custom_html" id="custom_html-2"><h3>You might also like…</h3><div class="textwidget custom-html-widget"><ul>
<li><a href="/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Install Python for Machine Learning</a></li>
<li><a href="/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python</a></li>
<li><a href="/tutorial-first-neural-network-python-keras/">Your First Neural Network in Python</a></li>
<li><a href="/how-to-run-your-first-classifier-in-weka/">Your First Classifier in Weka</a></li>
<li><a href="/arima-for-time-series-forecasting-with-python/">Your First Time Series Forecasting Project</a></li>
</ul></div></div></aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/disclaimer/">Disclaimer</a> | 
<a href="/terms-of-service/">Terms</a> | 
<a href="/contact/">Contact</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.8" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.0.5" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.8" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.1" type="text/javascript"></script>
</body>
</html>