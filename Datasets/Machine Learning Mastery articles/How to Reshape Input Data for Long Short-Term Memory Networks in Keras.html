<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v9.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>How to Reshape Input Data for Long Short-Term Memory Networks in Keras</title>
<link href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="How to Reshape Input Data for Long Short-Term Memory Networks in Keras" property="og:title"/>
<meta content="It can be difficult to understand how to prepare your sequence data for input to an LSTM model. Often there is confusion around how to define the input layer for the LSTM model. There is also confusion about how to convert your sequence data that may be a 1D or 2D matrix of numbers to …" property="og:description"/>
<meta content="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="https://www.facebook.com/jason.brownlee.39" property="article:author"/>
<meta content="Long Short-Term Memory Networks" property="article:section"/>
<meta content="2017-08-29T19:00:03+00:00" property="article:published_time"/>
<meta content="2017-12-05T23:13:01+00:00" property="article:modified_time"/>
<meta content="2017-12-05T23:13:01+00:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/How-to-Reshape-Input-for-Long-Short-Term-Memory-Networks-in-Keras.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/How-to-Reshape-Input-for-Long-Short-Term-Memory-Networks-in-Keras.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="427" property="og:image:height"/>
<meta content="How to Reshape Input for Long Short-Term Memory Networks in Keras" property="og:image:alt"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"https:\/\/machinelearningmastery.com\/#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/feed/" rel="alternate" title="Machine Learning Mastery » How to Reshape Input Data for Long Short-Term Memory Networks in Keras Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<style media="all" type="text/css">
.wpautoterms-footer{background-color:#ffffff;text-align:center;}
.wpautoterms-footer a{color:#000000;font-family:Arial, sans-serif;font-size:14px;}
.wpautoterms-footer .separator{color:#cccccc;font-family:Arial, sans-serif;font-size:14px;}</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/auto-terms-of-service-and-privacy-policy/css/wpautoterms.css?ver=4.9.8" id="wpautoterms_css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.0.5" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/css/front.css?ver=2.0.20" id="ssb-front-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/ewd-ufaq-styles.css?ver=4.9.8" id="ewd-ufaq-style-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/rrssb-min.css?ver=4.9.8" id="ewd-ufaq-rrssb-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.8" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=2.0.20" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.8" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.8" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=4286" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Freshape-input-data-long-short-term-memory-networks-keras%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Freshape-input-data-long-short-term-memory-networks-keras%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<style media="screen">

        .simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
      margin: ;
    }
         /*inline margin*/
    
  
  
  
  
  
          .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
         margin: ;
     }

          /*margin-digbar*/

  
  
  
  
 
   
   

</style>
<script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#4c89bf; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#4c89bf;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#4c89bf!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#ffffff;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-4286 single-format-standard unknown alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/icon-100x100.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-31"> <div class="textwidget"><p>Want help with LSTMs? <a href="https://machinelearningmastery.lpages.co/lnwp-mini-course/">Take the FREE Mini-Course</a>.</p>
</div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<input name="post_type" type="hidden" value="post"/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Main Menu</h3><ul class="nav fl" id="main-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503" id="menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Start Here</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501" id="menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506" id="menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508" id="menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (Keras)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6511" id="menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509" id="menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515" id="menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">Deep Learning for NLP</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512" id="menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Understand Algorithms</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507" id="menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms (Python)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6513" id="menu-item-6513"><a href="https://machinelearningmastery.com/category/machine-learning-process/">Machine Learning Process</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516" id="menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517" id="menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522" id="menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6518" id="menu-item-6518"><a href="https://machinelearningmastery.com/category/start-machine-learning/">Getting Started</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510" id="menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519" id="menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistical Methods</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520" id="menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Time Series (introductory)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523" id="menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6514" id="menu-item-6514"><a href="https://machinelearningmastery.com/category/machine-learning-resources/">Resources</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502" id="menu-item-6502"><a href="https://machinelearningmastery.com/products/">Ebooks</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500" id="menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504" id="menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505" id="menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-4286 post type-post status-publish format-standard has-post-thumbnail hentry category-lstm">
<header>
<h1 class="title entry-title">How to Reshape Input Data for Long Short-Term Memory Networks in Keras</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2017-08-30T05:00:03+1100">August 30, 2017</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/lstm/" title="View all items in Long Short-Term Memory Networks">Long Short-Term Memory Networks</a></span> </div>
<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-4286 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Reshape+Input+Data+for+Long+Short-Term+Memory+Networks+in+Keras&amp;url=https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
<p>It can be difficult to understand how to prepare your sequence data for input to an LSTM model.</p>
<p>Often there is confusion around how to define the input layer for the LSTM model.</p>
<p>There is also confusion about how to convert your sequence data that may be a 1D or 2D matrix of numbers to the required 3D format of the LSTM input layer.</p>
<p>In this tutorial, you will discover how to define the input layer to LSTM models and how to reshape your loaded input data for LSTM models.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>How to define an LSTM input layer.</li>
<li>How to reshape a one-dimensional sequence data for an LSTM model and define the input layer.</li>
<li>How to reshape multiple parallel series data for an LSTM model and define the input layer.</li>
</ul>
<p>Let’s get started.</p>
<div class="wp-caption aligncenter" id="attachment_4287" style="width: 650px"><img alt="How to Reshape Input for Long Short-Term Memory Networks in Keras" class="size-full wp-image-4287" height="427" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/How-to-Reshape-Input-for-Long-Short-Term-Memory-Networks-in-Keras.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/How-to-Reshape-Input-for-Long-Short-Term-Memory-Networks-in-Keras.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/How-to-Reshape-Input-for-Long-Short-Term-Memory-Networks-in-Keras-300x200.jpg 300w" width="640"/><p class="wp-caption-text">How to Reshape Input for Long Short-Term Memory Networks in Keras<br/>Photo by <a href="https://www.flickr.com/photos/152793655@N07/33495968401/">Global Landscapes Forum</a>, some rights reserved.</p></div>
<h2>Tutorial Overview</h2>
<p>This tutorial is divided into 4 parts; they are:</p>
<ol>
<li>LSTM Input Layer</li>
<li>Example of LSTM with Single Input Sample</li>
<li>Example of LSTM with Multiple Input Features</li>
<li>Tips for LSTM Input</li>
</ol>
<h3>LSTM Input Layer</h3>
<p>The LSTM input layer is specified by the “<em>input_shape</em>” argument on the first hidden layer of the network.</p>
<p>This can make things confusing for beginners.</p>
<p>For example, below is an example of a network with one hidden LSTM layer and one Dense output layer.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca91d6b3cf462527087" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
model = Sequential()
model.add(LSTM(32))
model.add(Dense(1))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca91d6b3cf462527087-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6b3cf462527087-2">2</div><div class="crayon-num" data-line="crayon-5c0ca91d6b3cf462527087-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca91d6b3cf462527087-1"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6b3cf462527087-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca91d6b3cf462527087-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>In this example, the LSTM() layer must specify the shape of the input.</p>
<p>The input to every LSTM layer must be three-dimensional.</p>
<p>The three dimensions of this input are:</p>
<ul>
<li><strong>Samples</strong>. One sequence is one sample. A batch is comprised of one or more samples.</li>
<li><strong>Time Steps</strong>. One time step is one point of observation in the sample.</li>
<li><strong>Features</strong>. One feature is one observation at a time step.</li>
</ul>
<p>This means that the input layer expects a 3D array of data when fitting the model and when making predictions, even if specific dimensions of the array contain a single value, e.g. one sample or one feature.</p>
<p>When defining the input layer of your LSTM network, the network assumes you have 1 or more samples and requires that you specify the number of time steps and the number of features. You can do this by specifying a tuple to the “<em>input_shape</em>” argument.</p>
<p>For example, the model below defines an input layer that expects 1 or more samples, 50 time steps, and 2 features.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca91d6b3d9321406385" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
model = Sequential()
model.add(LSTM(32, input_shape=(50, 2)))
model.add(Dense(1))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca91d6b3d9321406385-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6b3d9321406385-2">2</div><div class="crayon-num" data-line="crayon-5c0ca91d6b3d9321406385-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca91d6b3d9321406385-1"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6b3d9321406385-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca91d6b3d9321406385-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Now that we know how to define an LSTM input layer and the expectations of 3D inputs, let’s look at some examples of how we can prepare our data for the LSTM.</p>
<h2>Example of LSTM With Single Input Sample</h2>
<p>Consider the case where you have one sequence of multiple time steps and one feature.</p>
<p>For example, this could be a sequence of 10 values:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca91d6b3db593574944" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca91d6b3db593574944-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca91d6b3db593574944-1">0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can define this sequence of numbers as a NumPy array.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca91d6b3dd273827123" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from numpy import array
data = array([0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0])</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca91d6b3dd273827123-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6b3dd273827123-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca91d6b3dd273827123-1"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6b3dd273827123-2"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>We can then use the <em>reshape()</em> function on the NumPy array to reshape this one-dimensional array into a three-dimensional array with 1 sample, 10 time steps, and 1 feature at each time step.</p>
<p>The <em>reshape()</em> function when called on an array takes one argument which is a tuple defining the new shape of the array. We cannot pass in any tuple of numbers; the reshape must evenly reorganize the data in the array.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca91d6b3df588246193" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
data = data.reshape((1, 10, 1))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca91d6b3df588246193-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca91d6b3df588246193-1"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Once reshaped, we can print the new shape of the array.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca91d6b3e2899369520" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
print(data.shape)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca91d6b3e2899369520-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca91d6b3e2899369520-1"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Putting all of this together, the complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca91d6b3e4854627746" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from numpy import array
data = array([0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0])
data = data.reshape((1, 10, 1))
print(data.shape)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca91d6b3e4854627746-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6b3e4854627746-2">2</div><div class="crayon-num" data-line="crayon-5c0ca91d6b3e4854627746-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6b3e4854627746-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca91d6b3e4854627746-1"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6b3e4854627746-2"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca91d6b3e4854627746-3"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6b3e4854627746-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>Running the example prints the new 3D shape of the single sample.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca91d6b3e6103860413" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
(1, 10, 1)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca91d6b3e6103860413-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca91d6b3e6103860413-1">(1, 10, 1)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>This data is now ready to be used as input (<em>X</em>) to the LSTM with an input_shape of (10, 1).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca91d6b3e7331022231" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
model = Sequential()
model.add(LSTM(32, input_shape=(10, 1)))
model.add(Dense(1))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca91d6b3e7331022231-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6b3e7331022231-2">2</div><div class="crayon-num" data-line="crayon-5c0ca91d6b3e7331022231-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca91d6b3e7331022231-1"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6b3e7331022231-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca91d6b3e7331022231-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<h2>Example of LSTM with Multiple Input Features</h2>
<p>Consider the case where you have multiple parallel series as input for your model.</p>
<p>For example, this could be two parallel series of 10 values:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca91d6b3e9108598166" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
series 1: 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0
series 2: 1.0, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca91d6b3e9108598166-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6b3e9108598166-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca91d6b3e9108598166-1">series 1: 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6b3e9108598166-2">series 2: 1.0, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can define these data as a matrix of 2 columns with 10 rows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca91d6b3ea646607481" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from numpy import array
data = array([
	[0.1, 1.0],
	[0.2, 0.9],
	[0.3, 0.8],
	[0.4, 0.7],
	[0.5, 0.6],
	[0.6, 0.5],
	[0.7, 0.4],
	[0.8, 0.3],
	[0.9, 0.2],
	[1.0, 0.1]])</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca91d6b3ea646607481-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6b3ea646607481-2">2</div><div class="crayon-num" data-line="crayon-5c0ca91d6b3ea646607481-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6b3ea646607481-4">4</div><div class="crayon-num" data-line="crayon-5c0ca91d6b3ea646607481-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6b3ea646607481-6">6</div><div class="crayon-num" data-line="crayon-5c0ca91d6b3ea646607481-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6b3ea646607481-8">8</div><div class="crayon-num" data-line="crayon-5c0ca91d6b3ea646607481-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6b3ea646607481-10">10</div><div class="crayon-num" data-line="crayon-5c0ca91d6b3ea646607481-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6b3ea646607481-12">12</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca91d6b3ea646607481-1"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6b3ea646607481-2"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span></div><div class="crayon-line" id="crayon-5c0ca91d6b3ea646607481-3"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6b3ea646607481-4"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca91d6b3ea646607481-5"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6b3ea646607481-6"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca91d6b3ea646607481-7"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6b3ea646607481-8"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca91d6b3ea646607481-9"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6b3ea646607481-10"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca91d6b3ea646607481-11"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6b3ea646607481-12"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>This data can be framed as 1 sample with 10 time steps and 2 features.</p>
<p>It can be reshaped as a 3D array as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca91d6b3ec495949660" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
data = data.reshape(1, 10, 2)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca91d6b3ec495949660-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca91d6b3ec495949660-1"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Putting all of this together, the complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca91d6b3ee247813986" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from numpy import array
data = array([
	[0.1, 1.0],
	[0.2, 0.9],
	[0.3, 0.8],
	[0.4, 0.7],
	[0.5, 0.6],
	[0.6, 0.5],
	[0.7, 0.4],
	[0.8, 0.3],
	[0.9, 0.2],
	[1.0, 0.1]])
data = data.reshape(1, 10, 2)
print(data.shape)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca91d6b3ee247813986-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6b3ee247813986-2">2</div><div class="crayon-num" data-line="crayon-5c0ca91d6b3ee247813986-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6b3ee247813986-4">4</div><div class="crayon-num" data-line="crayon-5c0ca91d6b3ee247813986-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6b3ee247813986-6">6</div><div class="crayon-num" data-line="crayon-5c0ca91d6b3ee247813986-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6b3ee247813986-8">8</div><div class="crayon-num" data-line="crayon-5c0ca91d6b3ee247813986-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6b3ee247813986-10">10</div><div class="crayon-num" data-line="crayon-5c0ca91d6b3ee247813986-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6b3ee247813986-12">12</div><div class="crayon-num" data-line="crayon-5c0ca91d6b3ee247813986-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6b3ee247813986-14">14</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca91d6b3ee247813986-1"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6b3ee247813986-2"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span></div><div class="crayon-line" id="crayon-5c0ca91d6b3ee247813986-3"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6b3ee247813986-4"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca91d6b3ee247813986-5"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6b3ee247813986-6"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca91d6b3ee247813986-7"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6b3ee247813986-8"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca91d6b3ee247813986-9"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6b3ee247813986-10"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca91d6b3ee247813986-11"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6b3ee247813986-12"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca91d6b3ee247813986-13"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6b3ee247813986-14"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>Running the example prints the new 3D shape of the single sample.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca91d6b3ef163644550" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
(1, 10, 2)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca91d6b3ef163644550-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca91d6b3ef163644550-1">(1, 10, 2)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>This data is now ready to be used as input (<em>X</em>) to the LSTM with an input_shape of (10, 2).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca91d6b3f1495155527" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
model = Sequential()
model.add(LSTM(32, input_shape=(10, 2)))
model.add(Dense(1))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca91d6b3f1495155527-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6b3f1495155527-2">2</div><div class="crayon-num" data-line="crayon-5c0ca91d6b3f1495155527-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca91d6b3f1495155527-1"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6b3f1495155527-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca91d6b3f1495155527-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<h2>Longer Worked Example</h2>
<p>For a complete end-to-end worked example of preparing data, see this post:</p>
<ul>
<li><a href="https://machinelearningmastery.com/prepare-univariate-time-series-data-long-short-term-memory-networks/">How to Prepare Univariate Time Series Data for Long Short-Term Memory Networks</a></li>
</ul>
<h2>Tips for LSTM Input</h2>
<p>This section lists some tips to help you when preparing your input data for LSTMs.</p>
<ul>
<li>The LSTM input layer must be 3D.</li>
<li>The meaning of the 3 input dimensions are: samples, time steps, and features.</li>
<li>The LSTM input layer is defined by the <em>input_shape</em> argument on the first hidden layer.</li>
<li>The <em>input_shape</em> argument takes a tuple of two values that define the number of time steps and features.</li>
<li>The number of samples is assumed to be 1 or more.</li>
<li>The <em>reshape()</em> function on NumPy arrays can be used to reshape your 1D or 2D data to be 3D.</li>
<li>The <em>reshape()</em> function takes a tuple as an argument that defines the new shape.</li>
</ul>
<h2>Further Reading</h2>
<p>This section provides more resources on the topic if you are looking go deeper.</p>
<ul>
<li><a href="https://keras.io/layers/recurrent/">Recurrent Layers Keras API</a></li>
<li><a href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.reshape.html">Numpy reshape() function API</a></li>
<li><a href="http://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/">How to Convert a Time Series to a Supervised Learning Problem in Python</a></li>
<li><a href="http://machinelearningmastery.com/time-series-forecasting-supervised-learning/">Time Series Forecasting as Supervised Learning</a></li>
</ul>
<h2>Summary</h2>
<p>In this tutorial, you discovered how to define the input layer for LSTMs and how to reshape your sequence data for input to LSTMs.</p>
<p>Specifically, you learned:</p>
<ul>
<li>How to define an LSTM input layer.</li>
<li>How to reshape a one-dimensional sequence data for an LSTM model and define the input layer.</li>
<li>How to reshape multiple parallel series data for an LSTM model and define the input layer.</li>
</ul>
<p>Do you have any questions?<br/>
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="awac-wrapper"><div class="awac widget text-30"> <div class="textwidget"><div class="woo-sc-hr"></div>
<p></p><center>
<h2>Develop LSTMs for Sequence Prediction Today!</h2>
<p><a href="/lstms-with-python/"><img align="left" alt="Long Short-Term Memory Networks with Python" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/07/Cover-220.png" style="border: 0;"/></a></p>
<h4>Develop Your Own LSTM models in Minutes</h4>
<p>…with just a few lines of python code</p>
<p>Discover how in my new Ebook:<br/>
<a href="/lstms-with-python/">Long Short-Term Memory Networks with Python</a></p>
<p>It provides <strong>self-study tutorials</strong> on topics like:<br/>
<em>CNN LSTMs, Encoder-Decoder LSTMs, generative models, data preparation, making predictions</em> and much more…</p>
<h4>Finally Bring LSTM Recurrent Neural Networks to<br/>
Your Sequence Predictions Projects</h4>
<p>Skip the Academics. Just Results.</p>
<p><a href="/lstms-with-python/">Click to learn more</a>.<br/>
</p></center><br/>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-4286 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Reshape+Input+Data+for+Long+Short-Term+Memory+Networks+in+Keras&amp;url=https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
</section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="prev"><i class="fa fa-angle-left"></i> How to Make Predictions with Long Short-Term Memory Models in Keras</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/diagnose-overfitting-underfitting-lstm-models/" rel="next">How to Diagnose Overfitting and Underfitting of LSTM Models <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">165 Responses to <em>How to Reshape Input Data for Long Short-Term Memory Networks in Keras</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-411817">
<div class="comment-container" id="li-comment-411817">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e36230cfbdf8ad48d2e2cc3a4f076a39?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e36230cfbdf8ad48d2e2cc3a4f076a39?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Steven</span>
<span class="date">August 31, 2017 at 2:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-411817" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great explanation of the dimensions! Just wanted to say this explanation also works for LSTM models in Tensorflow as well.</p>
<div class="reply">
<a aria-label="Reply to Steven" class="comment-reply-link" href="#comment-411817" onclick='return addComment.moveForm( "comment-411817", "411817", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-411850">
<div class="comment-container" id="li-comment-411850">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 31, 2017 at 6:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-411850" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Steven.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-411850" onclick='return addComment.moveForm( "comment-411850", "411850", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-412059">
<div class="comment-container" id="li-comment-412059">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fc423d19a8e0a42989f348cfbb6bb4a4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fc423d19a8e0a42989f348cfbb6bb4a4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">yuan</span>
<span class="date">September 1, 2017 at 6:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-412059" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks a lot for your explanations .<br/>
I have a confusion below:<br/>
Assuming that we have multiple parallel series as input for out model.The first step is to define these data as a matrix of M columns with N rows.To be 3D(samples, time steps, and features),is this means that,samples :1 sample ,time steps: row numbers of the matrix ,and features: column numbers of the matrix ?  Must it be like this?Looking forward to your reply.Thank you</p>
<div class="reply">
<a aria-label="Reply to yuan" class="comment-reply-link" href="#comment-412059" onclick='return addComment.moveForm( "comment-412059", "412059", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-412113">
<div class="comment-container" id="li-comment-412113">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 2, 2017 at 6:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-412113" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I’m not sure I follow your question.</p>
<p>If you have parallel time series, then each series would need the same number of time steps and be represented as a separate feature (e.g. observation at a time).</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-412113" onclick='return addComment.moveForm( "comment-412113", "412113", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even depth-3" id="comment-446224">
<div class="comment-container" id="li-comment-446224">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/46269dcb8f0324b02d902516a84e8416?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/46269dcb8f0324b02d902516a84e8416?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Md. Abul Kalam Azad</span>
<span class="date">August 16, 2018 at 12:21 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-446224" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Sir,<br/>
I have used your multivariates code for testing lstm model.Its working fine but I did not understand why lstm one row is hidden from train as well as test dataset. If I test two rows in test then got one prediction as a output. And datetime output this one prediction result?</p>
<p>Please help me.</p>
<p>Thanks in advance.</p>
<p>Azad</p>
<div class="reply">
<a aria-label="Reply to Md. Abul Kalam Azad" class="comment-reply-link" href="#comment-446224" onclick='return addComment.moveForm( "comment-446224", "446224", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-446234">
<div class="comment-container" id="li-comment-446234">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 16, 2018 at 1:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-446234" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t follow.</p>
<p>Perhaps you can elaborate on your question?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-446234" onclick='return addComment.moveForm( "comment-446234", "446234", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-411934">
<div class="comment-container" id="li-comment-411934">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a0b7467b0433ad29e7c3d2e9ba100dd0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a0b7467b0433ad29e7c3d2e9ba100dd0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Oliver</span>
<span class="date">August 31, 2017 at 9:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-411934" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>thanks a lot for all the explanations you gave!<br/>
I tried to understand the effect of the reshape parameters and the effect in the spyder/variable explorer. But I do not understand the result shown in the data window.<br/>
I used the code from a different tutorial:</p>
<p>data = array([<br/>
	[0.1, 1.0],<br/>
	[0.2, 0.9],<br/>
	[0.3, 0.8],<br/>
	[0.4, 0.7],<br/>
	[0.5, 0.6],<br/>
	[0.6, 0.5],<br/>
	[0.7, 0.4],<br/>
	[0.8, 0.3],<br/>
	[0.9, 0.2],<br/>
	[1.0, 0.1]])<br/>
data_re = data.reshape(1, 10, 2) </p>
<p>When checking the result in the variable explorer of spyder I see 3 dimensions of the array but can not connect it to the paramters sample, timestep, feature.</p>
<p>On axis 0 of data_re I see the complete dataset<br/>
On axis 1 of the data_re I get 0.1 and 1.0 in column 1<br/>
On axis 2 of the data_re I see the column 1 of axis 0 transposed to row 1</p>
<p>Would you give me a hint how to interpret it?</p>
<p>Regards,<br/>
Oliver.</p>
<div class="reply">
<a aria-label="Reply to Oliver" class="comment-reply-link" href="#comment-411934" onclick='return addComment.moveForm( "comment-411934", "411934", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-411993">
<div class="comment-container" id="li-comment-411993">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 1, 2017 at 6:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-411993" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>There are no named parameters, I am referring to the dimensions by those names because that is how the LSTM model uses the data.</p>
<p>Sorry for the confusion.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-411993" onclick='return addComment.moveForm( "comment-411993", "411993", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-412060">
<div class="comment-container" id="li-comment-412060">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cefc5b36895e1a7780c92bc30facf6ab?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cefc5b36895e1a7780c92bc30facf6ab?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Saga</span>
<span class="date">September 1, 2017 at 6:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-412060" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks so much for the article (and the whole series in fact!). The documentation in Keras is not very clear on many things on its own.</p>
<p>I have been trying to implement a model that receives multiple samples of multivariate timeseries as input. The twist is that the length of the series, i.e. the “time steps” dimension is different for different samples. I have tried to train a model on each sample individually and then merge, (but then each LSTM is going to be extremely prone to overfitting). Another idea was to scale the samples to have the same time steps but this comes with a scaling factor of time steps for each sample which is not ideal either.</p>
<p>Is there a way to provide the LSTM with samples of dynamic time steps? maybe using a lower-level API?</p>
<p>Regards,<br/>
Saga</p>
<div class="reply">
<a aria-label="Reply to Saga" class="comment-reply-link" href="#comment-412060" onclick='return addComment.moveForm( "comment-412060", "412060", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-412114">
<div class="comment-container" id="li-comment-412114">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 2, 2017 at 6:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-412114" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>A way I use often is to pad all sequences to the same length and use a masking layer on the front end to ignore masked time steps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-412114" onclick='return addComment.moveForm( "comment-412114", "412114", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-437411">
<div class="comment-container" id="li-comment-437411">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/114d0f442da47dfd24fb8b0b6df3ae01?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/114d0f442da47dfd24fb8b0b6df3ae01?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mohamad</span>
<span class="date">May 13, 2018 at 10:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-437411" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>HI Jason,<br/>
Thank you for this amazing article.<br/>
I have the same problem here. which is the samples have many different lengths.</p>
<p>I did not get the idea you said.<br/>
“A way I use often is to pad all sequences to the same length and use a masking layer on the front end to ignore masked time steps.”<br/>
can you please provide more details about that?<br/>
or maybe provide articles explain how to solve this problem.</p>
<p>Thank you in advance.</p>
<div class="reply">
<a aria-label="Reply to Mohamad" class="comment-reply-link" href="#comment-437411" onclick='return addComment.moveForm( "comment-437411", "437411", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-437452">
<div class="comment-container" id="li-comment-437452">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 14, 2018 at 6:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-437452" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>These examples will show you how to truncate and pad sequence data:<br/>
<a href="https://machinelearningmastery.com/data-preparation-variable-length-input-sequences-sequence-prediction/" rel="nofollow">https://machinelearningmastery.com/data-preparation-variable-length-input-sequences-sequence-prediction/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437452" onclick='return addComment.moveForm( "comment-437452", "437452", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-413720">
<div class="comment-container" id="li-comment-413720">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c53f2da299afb213a6a4a4b152b52204?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c53f2da299afb213a6a4a4b152b52204?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shrimanti</span>
<span class="date">September 14, 2017 at 2:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-413720" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks very much for your tutorials on LSTM. I am trying to predict one time series from 10 different parallel time series. All of them are different 1D series. So, the shape of my X_train is (50000,10) and Y_train is (50000,1). I couldn’t figure out how to reshape my dataset and the input shape of LSTM if I want to use let’s say 100 time steps or look back as 100. </p>
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Shrimanti" class="comment-reply-link" href="#comment-413720" onclick='return addComment.moveForm( "comment-413720", "413720", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-413886">
<div class="comment-container" id="li-comment-413886">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 15, 2017 at 12:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-413886" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This post will help you formulates your series as a supervised learning problem:<br/>
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-413886" onclick='return addComment.moveForm( "comment-413886", "413886", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-416629">
<div class="comment-container" id="li-comment-416629">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/58d8b54a2b0b85b919a3f2ea7a1c7f76?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/58d8b54a2b0b85b919a3f2ea7a1c7f76?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anil Pise</span>
<span class="date">October 14, 2017 at 6:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-416629" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Respected Sir<br/>
I want to use LSTM RNN GRU to check changes in facial expression of the person who is watching a movie. Want to check his mental state whether he is a boar or interested to continue this movie or at what time he is a boar. Can you please help me how can I start to work on same.</p>
<div class="reply">
<a aria-label="Reply to Anil Pise" class="comment-reply-link" href="#comment-416629" onclick='return addComment.moveForm( "comment-416629", "416629", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-416716">
<div class="comment-container" id="li-comment-416716">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 15, 2017 at 5:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-416716" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That sounds like a great problem. I would recommend starting by collecting a ton of training data. </p>
<p>Then think of using a CNN on the front end of your LSTM.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-416716" onclick='return addComment.moveForm( "comment-416716", "416716", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-417642">
<div class="comment-container" id="li-comment-417642">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/070d817f42f8615c4deaac4625413640?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/070d817f42f8615c4deaac4625413640?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rafiya</span>
<span class="date">October 23, 2017 at 9:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-417642" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
I have around 12,000 tweets for sentiment classification totally. Do you think 16GB CPU RAM will be enough?</p>
<div class="reply">
<a aria-label="Reply to Rafiya" class="comment-reply-link" href="#comment-417642" onclick='return addComment.moveForm( "comment-417642", "417642", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417684">
<div class="comment-container" id="li-comment-417684">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 24, 2017 at 5:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-417684" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-417684" onclick='return addComment.moveForm( "comment-417684", "417684", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-420590">
<div class="comment-container" id="li-comment-420590">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/181122206967395d411a88f1a25019b4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/181122206967395d411a88f1a25019b4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ravil</span>
<span class="date">November 19, 2017 at 10:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-420590" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason</p>
<p>Thanks for the simple explanation.</p>
<p>However, I have  a doubt. What if you don’t know the no of time steps? How do you proceed then?<br/>
Is that why we use the embedding layer?</p>
<p>I intend to use it for sentiment analysis of imDb movie review dataset.</p>
<div class="reply">
<a aria-label="Reply to Ravil" class="comment-reply-link" href="#comment-420590" onclick='return addComment.moveForm( "comment-420590", "420590", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-420640">
<div class="comment-container" id="li-comment-420640">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 20, 2017 at 10:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-420640" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can force all input sequences to be the same length by padding/truncating.</p>
<p>You could also use a model that does not specify the input length, for example:<br/>
<a href="https://machinelearningmastery.com/develop-encoder-decoder-model-sequence-sequence-prediction-keras/" rel="nofollow">https://machinelearningmastery.com/develop-encoder-decoder-model-sequence-sequence-prediction-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-420640" onclick='return addComment.moveForm( "comment-420640", "420640", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-420978">
<div class="comment-container" id="li-comment-420978">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/46ac59ca825fb00c62ef6dca7a287665?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/46ac59ca825fb00c62ef6dca7a287665?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mohammad</span>
<span class="date">November 23, 2017 at 5:21 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-420978" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I finally understood the input shape requirements.<br/>
Just a quick question: batch_size would be a certain number of samples inside a group e.g if we have 100 samples we can divide it into batches of 10. Batching helps with a faster training time right?</p>
<div class="reply">
<a aria-label="Reply to Mohammad" class="comment-reply-link" href="#comment-420978" onclick='return addComment.moveForm( "comment-420978", "420978", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-421034">
<div class="comment-container" id="li-comment-421034">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 24, 2017 at 9:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-421034" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Correct, and weight updates occur and state is reset at the end of each batch.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-421034" onclick='return addComment.moveForm( "comment-421034", "421034", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-421641">
<div class="comment-container" id="li-comment-421641">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5598a7d1ae0bb9003bed9dc9b1e99325?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5598a7d1ae0bb9003bed9dc9b1e99325?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Eduardo Andrade</span>
<span class="date">November 30, 2017 at 4:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-421641" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>About sample (the first argument in reshape): if I have two sequences with different number of values (let’s suppose one with 10 values and another with 8) and want them to be considered as two distinct samples (not 2 features), a zero-padding is necessary?</p>
<p>series 1: 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0<br/>
series 2: 1.0, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.0, 0.0</p>
<p>If I do:</p>
<p>data = data.reshape(2, 10, 1)</p>
<p>It is going to understand them as 2 different samples?</p>
<div class="reply">
<a aria-label="Reply to Eduardo Andrade" class="comment-reply-link" href="#comment-421641" onclick='return addComment.moveForm( "comment-421641", "421641", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-421669">
<div class="comment-container" id="li-comment-421669">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 30, 2017 at 8:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-421669" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, padding to 10 time steps.</p>
<p>Yes, your reshape looks good.</p>
<p>Explore pre and post padding to see if it makes a difference for your model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-421669" onclick='return addComment.moveForm( "comment-421669", "421669", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-422442">
<div class="comment-container" id="li-comment-422442">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f24c4f547a137f887f8b3c0d25310277?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f24c4f547a137f887f8b3c0d25310277?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tseo</span>
<span class="date">December 8, 2017 at 12:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-422442" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>With this input, the model is going to understand two different series?</p>
<p>Why to don’t use (1, 10,2) shape?</p>
<div class="reply">
<a aria-label="Reply to Tseo" class="comment-reply-link" href="#comment-422442" onclick='return addComment.moveForm( "comment-422442", "422442", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-422462">
<div class="comment-container" id="li-comment-422462">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 8, 2017 at 5:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-422462" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You could treat them as two features as you suggestion, I thought they were separate samples.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-422462" onclick='return addComment.moveForm( "comment-422462", "422462", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-421959">
<div class="comment-container" id="li-comment-421959">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e0672767311204ae9fa91957a02e1390?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e0672767311204ae9fa91957a02e1390?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://aliarsalankazmi.github.io/blog_DA" rel="external nofollow">Ali</a></span>
<span class="date">December 2, 2017 at 10:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-421959" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks a lot for the tutorial!<br/>
I am trying to understand the input shape for LSTM data (No. of timesteps &amp; no. of features). Could I ask what each will be in the context of the iris dataset, please?</p>
<p>Am I correct to say that in the iris dataset, the timesteps can be 2, 3, 5, 6 – as long as it neatly divides the dataset into equal number of rows (iris has 150 rows).<br/>
And the number of features will be the number of columns (apart from the target column/class)?</p>
<p>Thanks ever so much!</p>
<div class="reply">
<a aria-label="Reply to Ali" class="comment-reply-link" href="#comment-421959" onclick='return addComment.moveForm( "comment-421959", "421959", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-421993">
<div class="comment-container" id="li-comment-421993">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 3, 2017 at 5:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-421993" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The iris dataset is not a sequence classification problem. It does not have time steps, only samples and features.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-421993" onclick='return addComment.moveForm( "comment-421993", "421993", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-422381">
<div class="comment-container" id="li-comment-422381">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f24c4f547a137f887f8b3c0d25310277?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f24c4f547a137f887f8b3c0d25310277?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tsep</span>
<span class="date">December 7, 2017 at 11:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-422381" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello! </p>
<p>First of all, thank you very much for your posts, I have learned a lot. </p>
<p>My question is because I’m not sure how to focus the next type of problems:  multiples sequences of multiple features.</p>
<p>For example, predict the amount that a user could spend given the previous purchases (here I can consider different features such as the previous amounts, products, day of week, etc.). If I have a dataset with data of 1000 users and I want to predict the amount for each user, how should be addressed?<br/>
Can I use a lstm for all users or each user will have a  model/lstm? </p>
<p>I understand that a lstm for all users could see things more interesting.. But I don’t know how to organize the input of different users.. because the example of two sequences (1,10,2) I don’t know how to apply.. I want to include more features for each sequence..</p>
<p>I’m very lost..<br/>
Thank you in advance</p>
<div class="reply">
<a aria-label="Reply to Tsep" class="comment-reply-link" href="#comment-422381" onclick='return addComment.moveForm( "comment-422381", "422381", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-422396">
<div class="comment-container" id="li-comment-422396">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 7, 2017 at 3:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-422396" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps start off by modeling individual users?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-422396" onclick='return addComment.moveForm( "comment-422396", "422396", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-422428">
<div class="comment-container" id="li-comment-422428">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f24c4f547a137f887f8b3c0d25310277?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f24c4f547a137f887f8b3c0d25310277?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tseo</span>
<span class="date">December 7, 2017 at 9:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-422428" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks!<br/>
By modelling individual users do you mean a lstm per user? </p>
<p>I have users with 200 purchases but others only with only 10.. would be enough? </p>
<p>I will try!</p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Tseo" class="comment-reply-link" href="#comment-422428" onclick='return addComment.moveForm( "comment-422428", "422428", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-422457">
<div class="comment-container" id="li-comment-422457">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 8, 2017 at 5:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-422457" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Or a user per sample.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-422457" onclick='return addComment.moveForm( "comment-422457", "422457", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-423558">
<div class="comment-container" id="li-comment-423558">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0b7df686ab181a8100f4e44a15681a27?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0b7df686ab181a8100f4e44a15681a27?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Peter</span>
<span class="date">December 17, 2017 at 7:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-423558" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for your tutorial and for your book!<br/>
I am not sure how to design the input shape of the following table or dataframe:</p>
<p>date, product, store, hasPromotion, attrib1, attrib2, quantity (t)</p>
<p>The first three columns are the key. We have 50000 products in 20 stores and I would like to predict the quantity (per product per store) at least 14 days ahead with LSTM.</p>
<p>What is the good start for the 3D input?<br/>
I am wondering if creating new features from date (as there are repetition), like day of week, day of month, month of year, etc. + the existing features + quantity (t), quantity (t+1) would do…</p>
<p>Thank you for your help in advance!<br/>
Br,</p>
<div class="reply">
<a aria-label="Reply to Peter" class="comment-reply-link" href="#comment-423558" onclick='return addComment.moveForm( "comment-423558", "423558", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-423572">
<div class="comment-container" id="li-comment-423572">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 17, 2017 at 8:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-423572" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Drop date and you have 6 features, does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-423572" onclick='return addComment.moveForm( "comment-423572", "423572", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-423687">
<div class="comment-container" id="li-comment-423687">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0b7df686ab181a8100f4e44a15681a27?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0b7df686ab181a8100f4e44a15681a27?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Peter</span>
<span class="date">December 18, 2017 at 8:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-423687" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>OK, thanks. If there are seasonality and trend in sales, should I remove them before train the LSTM, too?</p>
<div class="reply">
<a aria-label="Reply to Peter" class="comment-reply-link" href="#comment-423687" onclick='return addComment.moveForm( "comment-423687", "423687", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-423716">
<div class="comment-container" id="li-comment-423716">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 18, 2017 at 3:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-423716" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, I would recommend that.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-423716" onclick='return addComment.moveForm( "comment-423716", "423716", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-425865">
<div class="comment-container" id="li-comment-425865">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/399b9e413056195cbebe1add3d5d1d63?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/399b9e413056195cbebe1add3d5d1d63?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vic</span>
<span class="date">January 8, 2018 at 11:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-425865" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Howdy!</p>
<p>Thank you so much for the great amount of tutorials on LSTMs<br/>
Im trying to build an LSTM in keras using your examples and keep running into shape issues.</p>
<p>I have time series data set with prices for different things, and am trying to predict the price of item4 for time t+1<br/>
Item4 is a lagged value so that you can use previous set of prices to predict the next.<br/>
The data set has 400 sequential observations.</p>
<p>variables: datetime price1 price2 price3 item4_price</p>
<p>since the data variable has uniform interval of observations and none are missing, i am dropping the datetime variable.<br/>
So now i have 4 variables and 400 observations.</p>
<p>trainX = train[:, 0:-1]  #use first 3 variables<br/>
trainY = train[:,-1] #use the last variable</p>
<p>so now the trainX data set has price1 price2 and price3 variables (its my undestanding that this means there are 3 “feautres” in keras)<br/>
trainY is the predictor data set and only cointains item4_price</p>
<p>trainX = numpy.reshape(trainX, (1, 400, 3))  #reshape, this means there is 1 sample, 400 timestamps, and 3 features</p>
<p>model = Sequential()<br/>
model.add(LSTM(5, input_shape=(1, 400, 3), return_sequences=True))<br/>
model.add(Dense(1))<br/>
model.compile(loss=’mean_squared_error’, optimizer=’adam’)<br/>
model.fit(trainX, trainY, epochs=100, batch_size=1, verbose=2)</p>
<p>Keep getting various shape errors all the time, no matter what i do. I tried switching it around, and even ommiting the first dimension.<br/>
I was wondering if you could point me in the right dirrection of what it is that i keep missing in my understnading of keras/lstm shapes.</p>
<p>I also dont know if the trainY set needs shaping? I tried to shape it too but python was also not happy with that.</p>
<p>Let me know what you think!</p>
<p>Thanks,<br/>
Vic</p>
<div class="reply">
<a aria-label="Reply to Vic" class="comment-reply-link" href="#comment-425865" onclick='return addComment.moveForm( "comment-425865", "425865", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-425872">
<div class="comment-container" id="li-comment-425872">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 8, 2018 at 3:53 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-425872" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps start with one series and really nail down what is required.</p>
<p>Did you try this tutorial:<br/>
<a href="https://machinelearningmastery.com/prepare-univariate-time-series-data-long-short-term-memory-networks/" rel="nofollow">https://machinelearningmastery.com/prepare-univariate-time-series-data-long-short-term-memory-networks/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425872" onclick='return addComment.moveForm( "comment-425872", "425872", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-425897">
<div class="comment-container" id="li-comment-425897">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/399b9e413056195cbebe1add3d5d1d63?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/399b9e413056195cbebe1add3d5d1d63?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vic</span>
<span class="date">January 9, 2018 at 1:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-425897" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Dr. Brownlee,</p>
<p>I have previously read that tutorial and feel as though i understand it fine.<br/>
But when applying what I learned to the problem in a way as described previously, find that Im running into some trouble. </p>
<p>So i was hoping I was just overlooking something, but at this point im not really sure what. Is what Im doing seem reasonable?</p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Vic" class="comment-reply-link" href="#comment-425897" onclick='return addComment.moveForm( "comment-425897", "425897", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-425921">
<div class="comment-container" id="li-comment-425921">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 9, 2018 at 5:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-425921" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps, but I don’t know your problem as well as you and there is no set way to solve any ml problem.</p>
<p>I would encourage you to brainstorm and try a suite of approaches to see what works best.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425921" onclick='return addComment.moveForm( "comment-425921", "425921", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-426094">
<div class="comment-container" id="li-comment-426094">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3391d1029ea572c10e7f2ea694ada809?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3391d1029ea572c10e7f2ea694ada809?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sujan Ghimire</span>
<span class="date">January 10, 2018 at 12:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-426094" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I have gone through this tutorial but i have a input size of 1762 X 4 and output size 1762X 1.</p>
<p>I did as follows but the shape of y train is giving as (1394, 4) , which should be 1394,1</p>
<p>Can you help me on this?</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca91d6e939967659642" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# function for min-max normalization of stock

def normalize_data(df):
    min_max_scaler = sklearn.preprocessing.MinMaxScaler()
    df['open'] = min_max_scaler.fit_transform(df.open.values.reshape(-1,1))
    df['high'] = min_max_scaler.fit_transform(df.high.values.reshape(-1,1))
    df['low'] = min_max_scaler.fit_transform(df.low.values.reshape(-1,1))
    #df['volume'] = min_max_scaler.fit_transform(df.volume.values.reshape(-1,1))
    df['close'] = min_max_scaler.fit_transform(df['close'].values.reshape(-1,1))
    return df

# function to create train, validation, test data given stock data and sequence length
def load_data(stock, seq_len):
    data_raw = stock.as_matrix() # convert to numpy array
    data = []
    
    # create all possible sequences of length seq_len
    for index in range(len(data_raw) - seq_len): 
        data.append(data_raw[index: index + seq_len])
    
    data = np.array(data);
    valid_set_size = int(np.round(valid_set_size_percentage/100*data.shape[0])); 
test_set_size = int(np.round(test_set_size_percentage/100*data.shape[0]));
    train_set_size = data.shape[0] - (valid_set_size + test_set_size);
    
    x_train = data[:train_set_size,:-1,:]
    y_train = data[:train_set_size,-1,:]
    
    x_valid = data[train_set_size:train_set_size+valid_set_size,:-1,:]
    y_valid = data[train_set_size:train_set_size+valid_set_size,-1,:]
    
    x_test = data[train_set_size+valid_set_size:,:-1,:]
    y_test = data[train_set_size+valid_set_size:,-1,:]
    
    return [x_train, y_train, x_valid, y_valid, x_test, y_test]

# choose one stock
df_stock = df[df.symbol == 'EQIX'].copy()
df_stock.drop(['symbol'],1,inplace=True)
df_stock.drop(['volume'],1,inplace=True)

cols = list(df_stock.columns.values)
#cols = [cols[i] for i in [0,2,3,1]] # move 'close' column to last place
print('df_stock.columns.values = ', cols)
#df_stock = df_stock[cols]

# normalize stock
df_stock_norm = df_stock.copy()
df_stock_norm = normalize_data(df_stock_norm)

# create train, test data
seq_len = 20 # choose sequence length
x_train, y_train, x_valid, y_valid, x_test, y_test = load_data(df_stock_norm, seq_len)

seq_len = 20 # choose sequence length
x_train, y_train, x_valid, y_valid, x_test, y_test = load_data(df_stock_norm, seq_len)
print('x_train.shape = ',x_train.shape)
print('y_train.shape = ', y_train.shape)
print('x_valid.shape = ',x_valid.shape)
print('y_valid.shape = ', y_valid.shape)
print('x_test.shape = ', x_test.shape)
print('y_test.shape = ',y_test.shape)

df_stock.columns.values =  ['open', 'close', 'low', 'high']
x_train.shape =  (1394, 19, 4)
y_train.shape =  (1394, 4)
x_valid.shape =  (174, 19, 4)
y_valid.shape =  (174, 4)
x_test.shape =  (174, 19, 4)
y_test.shape =  (174, 4)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-2">2</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-4">4</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-6">6</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-8">8</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-10">10</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-12">12</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-14">14</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-16">16</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-18">18</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-20">20</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-22">22</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-24">24</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-26">26</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-28">28</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-30">30</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-32">32</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-34">34</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-36">36</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-38">38</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-40">40</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-42">42</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-44">44</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-46">46</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-48">48</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-50">50</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-52">52</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-54">54</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-56">56</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-58">58</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-60">60</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-62">62</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-64">64</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-66">66</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-68">68</div><div class="crayon-num" data-line="crayon-5c0ca91d6e939967659642-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca91d6e939967659642-70">70</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-1"><span class="crayon-p"># function for min-max normalization of stock</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-2"> </div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-3"><span class="crayon-e">def </span><span class="crayon-e">normalize_data</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-4"><span class="crayon-h">    </span><span class="crayon-v">min_max_scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-5"><span class="crayon-h">    </span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-s">'open'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">min_max_scaler</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-v">open</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-6"><span class="crayon-h">    </span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-s">'high'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">min_max_scaler</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-v">high</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-7"><span class="crayon-h">    </span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-s">'low'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">min_max_scaler</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-v">low</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-8"><span class="crayon-h">    </span><span class="crayon-p">#df['volume'] = min_max_scaler.fit_transform(df.volume.values.reshape(-1,1))</span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-9"><span class="crayon-h">    </span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-s">'close'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">min_max_scaler</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-s">'close'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-10"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">df</span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-11"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-12"><span class="crayon-p"># function to create train, validation, test data given stock data and sequence length</span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-13"><span class="crayon-e">def </span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-v">stock</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_len</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-14"><span class="crayon-h">    </span><span class="crayon-v">data_raw</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">stock</span><span class="crayon-sy">.</span><span class="crayon-e">as_matrix</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-p"># convert to numpy array</span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-15"><span class="crayon-h">    </span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-16"><span class="crayon-h">    </span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-17"><span class="crayon-h">    </span><span class="crayon-p"># create all possible sequences of length seq_len</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-18"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">index </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">data_raw</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">seq_len</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-19"><span class="crayon-h">        </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">data_raw</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">seq_len</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-20"><span class="crayon-h">    </span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-21"><span class="crayon-h">    </span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-22"><span class="crayon-h">    </span><span class="crayon-v">valid_set_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">round</span><span class="crayon-sy">(</span><span class="crayon-v">valid_set_size_percentage</span><span class="crayon-o">/</span><span class="crayon-cn">100</span><span class="crayon-o">*</span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-23"><span class="crayon-v">test_set_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">round</span><span class="crayon-sy">(</span><span class="crayon-v">test_set_size_percentage</span><span class="crayon-o">/</span><span class="crayon-cn">100</span><span class="crayon-o">*</span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-24"><span class="crayon-h">    </span><span class="crayon-v">train_set_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">valid_set_size</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">test_set_size</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-25"><span class="crayon-h">    </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-26"><span class="crayon-h">    </span><span class="crayon-v">x_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">train_set_size</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-27"><span class="crayon-h">    </span><span class="crayon-v">y_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">train_set_size</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-28"><span class="crayon-h">    </span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-29"><span class="crayon-h">    </span><span class="crayon-v">x_valid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-v">train_set_size</span><span class="crayon-o">:</span><span class="crayon-v">train_set_size</span><span class="crayon-o">+</span><span class="crayon-v">valid_set_size</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-30"><span class="crayon-h">    </span><span class="crayon-v">y_valid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-v">train_set_size</span><span class="crayon-o">:</span><span class="crayon-v">train_set_size</span><span class="crayon-o">+</span><span class="crayon-v">valid_set_size</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-31"><span class="crayon-h">    </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-32"><span class="crayon-h">    </span><span class="crayon-v">x_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-v">train_set_size</span><span class="crayon-o">+</span><span class="crayon-v">valid_set_size</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-33"><span class="crayon-h">    </span><span class="crayon-v">y_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-v">train_set_size</span><span class="crayon-o">+</span><span class="crayon-v">valid_set_size</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-34"><span class="crayon-h">    </span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-35"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">x_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x_valid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_valid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-36"> </div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-37"><span class="crayon-p"># choose one stock</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-38"><span class="crayon-v">df_stock</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-v">symbol</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'EQIX'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-39"><span class="crayon-v">df_stock</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'symbol'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-40"><span class="crayon-v">df_stock</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'volume'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-41"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-42"><span class="crayon-v">cols</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">df_stock</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-43"><span class="crayon-p">#cols = [cols[i] for i in [0,2,3,1]] # move 'close' column to last place</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-44"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'df_stock.columns.values = '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-45"><span class="crayon-p">#df_stock = df_stock[cols]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-46"> </div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-47"><span class="crayon-p"># normalize stock</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-48"><span class="crayon-v">df_stock_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df_stock</span><span class="crayon-sy">.</span><span class="crayon-e">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-49"><span class="crayon-v">df_stock_norm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">normalize_data</span><span class="crayon-sy">(</span><span class="crayon-v">df_stock_norm</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-50"> </div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-51"><span class="crayon-p"># create train, test data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-52"><span class="crayon-v">seq_len</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-p"># choose sequence length</span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-53"><span class="crayon-v">x_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x_valid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_valid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-v">df_stock_norm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_len</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-54"> </div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-55"><span class="crayon-v">seq_len</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-p"># choose sequence length</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-56"><span class="crayon-v">x_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x_valid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_valid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-v">df_stock_norm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_len</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-57"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'x_train.shape = '</span><span class="crayon-sy">,</span><span class="crayon-v">x_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-58"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'y_train.shape = '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-59"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'x_valid.shape = '</span><span class="crayon-sy">,</span><span class="crayon-v">x_valid</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-60"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'y_valid.shape = '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_valid</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-61"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'x_test.shape = '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x_test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-62"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'y_test.shape = '</span><span class="crayon-sy">,</span><span class="crayon-v">y_test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-63"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-64"><span class="crayon-v">df_stock</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h">  </span><span class="crayon-sy">[</span><span class="crayon-s">'open'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'close'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'low'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'high'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-65"><span class="crayon-v">x_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h">  </span><span class="crayon-sy">(</span><span class="crayon-cn">1394</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">19</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-66"><span class="crayon-v">y_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h">  </span><span class="crayon-sy">(</span><span class="crayon-cn">1394</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-67"><span class="crayon-v">x_valid</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h">  </span><span class="crayon-sy">(</span><span class="crayon-cn">174</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">19</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-68"><span class="crayon-v">y_valid</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h">  </span><span class="crayon-sy">(</span><span class="crayon-cn">174</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca91d6e939967659642-69"><span class="crayon-v">x_test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h">  </span><span class="crayon-sy">(</span><span class="crayon-cn">174</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">19</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca91d6e939967659642-70"><span class="crayon-v">y_test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h">  </span><span class="crayon-sy">(</span><span class="crayon-cn">174</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0046 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to sujan Ghimire" class="comment-reply-link" href="#comment-426094" onclick='return addComment.moveForm( "comment-426094", "426094", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-426109">
<div class="comment-container" id="li-comment-426109">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 10, 2018 at 3:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-426109" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I cannot debug your code for you. I simply do not have the capacity, I’m sure you can understand.</p>
<p>Perhaps post your error to stackoverflow or cross validated?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426109" onclick='return addComment.moveForm( "comment-426109", "426109", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-426746">
<div class="comment-container" id="li-comment-426746">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/743b29eedc82277ab72d7f34c6c7bba9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/743b29eedc82277ab72d7f34c6c7bba9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Siji</span>
<span class="date">January 17, 2018 at 6:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-426746" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I got an exception “ValueError: Input arrays should have the same number of samples as target arrays. Found 1 input samples and 21 target samples”.</p>
<p>=&gt;print X_train</p>
<p>[[ 0.15699646 -1.59383227]<br/>
 [-0.31399291 -0.03680409]<br/>
 [ 0.15699646 -1.59383227]<br/>
 [-0.31399291  0.78456757]<br/>
 [ 0.15699646 -1.59383227]<br/>
 [ 4.39590078 -1.59383227]<br/>
 [-0.31399291  1.38764971]<br/>
 [-0.31399291 -0.03680409]<br/>
 [-0.31399291 -0.32252408]<br/>
 [-0.31399291  0.6081381 ]<br/>
 [-0.31399291 -0.32252408]<br/>
 [-0.31399291  1.38764971]<br/>
 [-0.31399291  0.78456757]<br/>
 [-0.31399291 -0.03680409]<br/>
 [-0.31399291  0.78456757]<br/>
 [ 0.15699646  1.24889926]<br/>
 [-0.31399291 -0.32252408]<br/>
 [-0.31399291  1.24889926]<br/>
 [-0.31399291 -0.69488163]<br/>
 [-0.31399291 -0.69488163]<br/>
 [-0.31399291  0.6081381 ]]</p>
<p>=&gt;print y_train</p>
<p>0     1<br/>
1     1<br/>
2     1<br/>
3     1<br/>
4     1<br/>
5     1<br/>
6     1<br/>
7     0<br/>
8     0<br/>
9     0<br/>
10    0<br/>
11    0<br/>
12    0<br/>
13    0<br/>
14    1<br/>
15    1<br/>
16    1<br/>
17    1<br/>
18    0<br/>
19    0<br/>
20    0<br/>
Name: out, dtype: int64</p>
<p>=&gt;print(y_train.shape)</p>
<p>(21,)</p>
<p>=&gt;print X_train.shape</p>
<p>(21, 2)</p>
<p>=&gt;print X_test.shape</p>
<p>(8, 2)</p>
<p>I have reshaped the inputs to 3dimensional input. I have followed you steps.<br/>
=&gt;X_train = X_train.reshape(1,21, 2)<br/>
print(X_train.shape)</p>
<p>(1, 21, 2)<br/>
=&gt;<br/>
model = Sequential()<br/>
model.add(LSTM(32, input_shape=(21, 2)))<br/>
model.add(Dense(1))</p>
<p>model.compile(optimizer=’rmsprop’,loss=’categorical_crossentropy’,metrics=[‘categorical_accuracy’])</p>
<p>history = model.fit(X_train,y_train,batch_size =13, epochs = 14)</p>
<p>—————————————————————————<br/>
ValueError                                Traceback (most recent call last)<br/>
 in ()<br/>
—-&gt; 1 history = model.fit(X_train,y_train,batch_size =13, epochs = 14)</p>
<p>/home/siji/anaconda2/lib/python2.7/site-packages/keras/models.pyc in fit(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, **kwargs)<br/>
    891                               class_weight=class_weight,<br/>
    892                               sample_weight=sample_weight,<br/>
–&gt; 893                               initial_epoch=initial_epoch)<br/>
    894<br/>
    895     def evaluate(self, x, y, batch_size=32, verbose=1,</p>
<p>/home/siji/anaconda2/lib/python2.7/site-packages/keras/engine/training.pyc in fit(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, **kwargs)<br/>
   1553             class_weight=class_weight,<br/>
   1554             check_batch_axis=False,<br/>
-&gt; 1555             batch_size=batch_size)<br/>
   1556         # Prepare validation data.<br/>
   1557         do_validation = False</p>
<p>/home/siji/anaconda2/lib/python2.7/site-packages/keras/engine/training.pyc in _standardize_user_data(self, x, y, sample_weight, class_weight, check_batch_axis, batch_size)<br/>
   1419                           for (ref, sw, cw, mode)<br/>
   1420                           in zip(y, sample_weights, class_weights, self._feed_sample_weight_modes)]<br/>
-&gt; 1421         _check_array_lengths(x, y, sample_weights)<br/>
   1422         _check_loss_and_target_compatibility(y,<br/>
   1423                                              self._feed_loss_fns,</p>
<p>/home/siji/anaconda2/lib/python2.7/site-packages/keras/engine/training.pyc in _check_array_lengths(inputs, targets, weights)<br/>
    249                          ‘the same number of samples as target arrays. ‘<br/>
    250                          ‘Found ‘ + str(list(set_x)[0]) + ‘ input samples ‘<br/>
–&gt; 251                          ‘and ‘ + str(list(set_y)[0]) + ‘ target samples.’)<br/>
    252     if len(set_w) &gt; 1:<br/>
    253         raise ValueError(‘All sample_weight arrays should have ‘</p>
<p>ValueError: Input arrays should have the same number of samples as target arrays. Found 1 input samples and 21 target samples.</p>
<p>Please solve my problem. I am new in this area. What is the mistake</p>
<div class="reply">
<a aria-label="Reply to Siji" class="comment-reply-link" href="#comment-426746" onclick='return addComment.moveForm( "comment-426746", "426746", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-426793">
<div class="comment-container" id="li-comment-426793">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 18, 2018 at 10:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-426793" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps cut the example back to a few lines to help expose the fault?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426793" onclick='return addComment.moveForm( "comment-426793", "426793", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-429503">
<div class="comment-container" id="li-comment-429503">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/41c3b002a61eb6cd8e29f7c19a2b0ebf?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/41c3b002a61eb6cd8e29f7c19a2b0ebf?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mikel</span>
<span class="date">February 15, 2018 at 2:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-429503" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I’m trying to understand the input_shape but I think I’m totally confused about the time step variable. I have a multivariate time series with 18,000 samples and 720 features. I created a 10 lagged observation dataset to forecast the next 5 time steps so my dataset goes from t-10 to t+5, being the feature dataset from t-10 to t and the label dataset from t+1 to t+5. </p>
<p>Assuming that I take 15,000 samples for training, what will be the values of the reshape function? I think it should be [15000, 1, 7200 (720 features * 10)]. Regarding the time step, is the value “1” correct or it should be the number of lagged observations, that is, 10?</p>
<p>Thank you in advance.</p>
<div class="reply">
<a aria-label="Reply to Mikel" class="comment-reply-link" href="#comment-429503" onclick='return addComment.moveForm( "comment-429503", "429503", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-429551">
<div class="comment-container" id="li-comment-429551">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 15, 2018 at 8:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-429551" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Generally, I would recommend about 200-400 time steps.</p>
<p>Here’s some more advice on how to handle a very long time series:<br/>
<a href="https://machinelearningmastery.com/handle-long-sequences-long-short-term-memory-recurrent-neural-networks/" rel="nofollow">https://machinelearningmastery.com/handle-long-sequences-long-short-term-memory-recurrent-neural-networks/</a></p>
<p>And here:<br/>
<a href="https://machinelearningmastery.com/prepare-univariate-time-series-data-long-short-term-memory-networks/" rel="nofollow">https://machinelearningmastery.com/prepare-univariate-time-series-data-long-short-term-memory-networks/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-429551" onclick='return addComment.moveForm( "comment-429551", "429551", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-434744">
<div class="comment-container" id="li-comment-434744">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0f80c797c4a4525d8c436e98338a7e47?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0f80c797c4a4525d8c436e98338a7e47?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Amim</span>
<span class="date">April 11, 2018 at 7:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-434744" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason!<br/>
Thank you so much for all the tutorials on LSTMs, I’ve learned a lot. </p>
<p>I’m trying to implement the LSTM Architecture from the paper “Dropout improves Recurrent Neural Networks for Handwriting Recognition” for resolving the handwritten recognition problem.<br/>
Basically I have to train the network giving in input variable-sized images (different W and H but always 3 channels) and to predict what is the word written in the image. What I can’t understand is how to deal with variable sized images? Can I consider images as some sequences (for ex. a 50×30 image considered as 50 sequences with 30 features?). The authors say I give in input a block of image of size 2×2 scaning in 4 different directions (multidirectional multidimensional LSTM).<br/>
What do I have to specify here : input_size(Samples,Time Steps,Features) ? The Samples refers to the number of all images I have in training set or the number of miniblocks 2×2 ? What about time steps and features? I don’t get it and its very confusing. Can you please help with any idea? I am new in this area and Im stacked in this problem.</p>
<p>Thanks a lot 🙂</p>
<div class="reply">
<a aria-label="Reply to Amim" class="comment-reply-link" href="#comment-434744" onclick='return addComment.moveForm( "comment-434744", "434744", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-434794">
<div class="comment-container" id="li-comment-434794">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 12, 2018 at 8:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-434794" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend padding the inputs to a fixed size.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-434794" onclick='return addComment.moveForm( "comment-434794", "434794", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-435440">
<div class="comment-container" id="li-comment-435440">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a71bcb4bfb51fae8639541cb78bc6313?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a71bcb4bfb51fae8639541cb78bc6313?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jeyel</span>
<span class="date">April 19, 2018 at 6:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-435440" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason!<br/>
Thanks so much for your tutorials on LSTM!<br/>
I’m trying to predict trajectory with LSTM and ARIMA now.  After reading this tutorial, I’ve got some questions.<br/>
(1) Do we must transfer time series to lag observations if we want to do forecast work with LSTM?<br/>
(2) After transfering time series to supervised learning problems, the forecast is only related to “order” or “lag” rather than “time”(like ARIMA do)? Why the input is not time/date? And the time interval of data must be even?<br/>
Thanks a lot in advance!</p>
<div class="reply">
<a aria-label="Reply to Jeyel" class="comment-reply-link" href="#comment-435440" onclick='return addComment.moveForm( "comment-435440", "435440", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-435476">
<div class="comment-container" id="li-comment-435476">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 20, 2018 at 5:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-435476" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, LSTMs can work with the time steps directly.</p>
<p>The order of the observations is sufficient for the model, if the time steps are consistently spaced it does not need the absolute date/time information.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435476" onclick='return addComment.moveForm( "comment-435476", "435476", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-435512">
<div class="comment-container" id="li-comment-435512">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f4b07a2358408de6fa3ae775dc6dec6c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f4b07a2358408de6fa3ae775dc6dec6c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Leonardo</span>
<span class="date">April 20, 2018 at 4:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-435512" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason! Congratulations on the LSTM input tutorial!<br/>
Could you please answer three questions?</p>
<p>I’m working with 500 samples that have varying sizes. My doubts are related to the organization of these 500 samples within this 3-dimensional input, mainly in relation to the Samples dimension.</p>
<p>The dimension “Features” has already defined that it will have size 26, the dimension “Time Steps” will have to have size 100 but the dimension “Samples” is that I still do not know what its value will be.</p>
<p>Doubt 1: In these cases of samples with different sizes to know the dimension “Samples” I have to be based on the larger sample and for the other samples I fill in the value 0 (zero) in the additional spaces?</p>
<p>Doubt 2: Can I have more than one line in the “Samples” dimension representing the same sample?</p>
<p>Doubt 3: How do samples have varying sizes, there are possibilities to work with 4 dimensions, for example: “Samples” x “Part of Samples” x “Time Steps” x “Features”?</p>
<p>Thank you for your attention!</p>
<div class="reply">
<a aria-label="Reply to Leonardo" class="comment-reply-link" href="#comment-435512" onclick='return addComment.moveForm( "comment-435512", "435512", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-435552">
<div class="comment-container" id="li-comment-435552">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 21, 2018 at 6:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-435552" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>One sample is one sequence. </p>
<p>Each sample must have the same length, you can use zero-padding to achieve this and use Masking to ignore the padded obs.</p>
<p>This tutorial will make it clearer I think:<br/>
<a href="https://machinelearningmastery.com/prepare-univariate-time-series-data-long-short-term-memory-networks/" rel="nofollow">https://machinelearningmastery.com/prepare-univariate-time-series-data-long-short-term-memory-networks/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435552" onclick='return addComment.moveForm( "comment-435552", "435552", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-435688">
<div class="comment-container" id="li-comment-435688">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/75f41d5fbcb6997680a271b7763a51e8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/75f41d5fbcb6997680a271b7763a51e8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kate</span>
<span class="date">April 23, 2018 at 9:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-435688" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thank you for such a good tutorial! This really helps!</p>
<p>I am not sure if I understand the model correctly:<br/>
The sequence of samples does matter in lstm because the state of current one is affected by last one in the sequence.</p>
<p>If this is the case, can you let me know how I should deal with the following scenarios?</p>
<p>I have non-equally spaced trajectory data. The interval varies from seconds to days. Solutions I come up with are interpolation or adding time feature. What do you think is a good way to prepare the data?</p>
<p>Assuming last problem is solved, how can I organize the input if my data contains trajectories of different people? For example, trajectory of one person is (100, 5, 2) and trajectory of another one is (200, 5, 2). How to train both sequence in one model?</p>
<p>Thank you very much!</p>
<div class="reply">
<a aria-label="Reply to Kate" class="comment-reply-link" href="#comment-435688" onclick='return addComment.moveForm( "comment-435688", "435688", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-435699">
<div class="comment-container" id="li-comment-435699">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 23, 2018 at 2:53 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-435699" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<p>Perhaps you can interpolate the data?<br/>
Perhaps you can use zero padding with a masking input layer to ignore the zeros?</p>
<p>I have more on preparing data for LSTMs here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm</a></p>
<p>If each trajectory is a sample, and samples are independent, then perhaps use a batch size of 1 or reset at the end of each sample. Compare the skill of this model to one that does not reset state so often.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435699" onclick='return addComment.moveForm( "comment-435699", "435699", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-436396">
<div class="comment-container" id="li-comment-436396">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ab7f5261df0efbd5e97c145fec073775?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ab7f5261df0efbd5e97c145fec073775?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">erik</span>
<span class="date">May 2, 2018 at 12:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-436396" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason, you are making a good job Dr.! I am a bit confused about my data shape for the network: I have 300 different samples, where the next one always is measured lets say in 1 min steps, so I have in total 300 timesteps, and each file is containing 1 column, 2.000 rows. When we say I want to reduce the ‘features’, rows  I am thinking that my inputshape must be therefore (1,300,2000) and than I can reduce to something e.g.200. with the lstm decoder ?</p>
<div class="reply">
<a aria-label="Reply to erik" class="comment-reply-link" href="#comment-436396" onclick='return addComment.moveForm( "comment-436396", "436396", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-436425">
<div class="comment-container" id="li-comment-436425">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 2, 2018 at 5:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-436425" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How can 1 sample have 300 time steps, 1 column and 2k rows? I do not understand sorry.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436425" onclick='return addComment.moveForm( "comment-436425", "436425", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-436432">
<div class="comment-container" id="li-comment-436432">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0301dd196c58a2f3cf5a06b9cae54ff0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0301dd196c58a2f3cf5a06b9cae54ff0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">erik</span>
<span class="date">May 2, 2018 at 7:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-436432" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorrry for the obscurity, 1 sample has 2000 rows all in one column so only one type of value temperature is measured. in total I have 300 samples and time distance between their recording is 1 min</p>
<div class="reply">
<a aria-label="Reply to erik" class="comment-reply-link" href="#comment-436432" onclick='return addComment.moveForm( "comment-436432", "436432", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-436496">
<div class="comment-container" id="li-comment-436496">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 3, 2018 at 6:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-436496" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I still don’t follow. </p>
<p>Are the 2000 rows related in time for one feature? Or are the 2000 rows separate features at one time?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436496" onclick='return addComment.moveForm( "comment-436496", "436496", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-436612">
<div class="comment-container" id="li-comment-436612">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0301dd196c58a2f3cf5a06b9cae54ff0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0301dd196c58a2f3cf5a06b9cae54ff0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">erik</span>
<span class="date">May 4, 2018 at 9:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-436612" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I think if I understood you right, the 2000 rows are related to one measurement (so I measure in 1 second 2000 times the temperature). But when you regard it with an lstm autoencoder I try to reduce the “features” to learn from them and make than the prediction.  I do not know the shape for the lstm encoder decoder either it should be (1, 300,2000) or (2000,300,1) but for the last one I got strange results, the first one is closer to the real data. Which one is right ?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-436620">
<div class="comment-container" id="li-comment-436620">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 4, 2018 at 1:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-436620" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The input to the encoder will be [300, ?, 2000] where ? represents the number of time steps you wish to model.</p>
<p>The encoder decoder is not appropriate for all sequence prediction problems, it is suited to sequence output that differs in length to the input. If you are doing straight sequence classification/regression it might not be appropriate.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-437428">
<div class="comment-container" id="li-comment-437428">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5be296371d6a7f0097bcf88e88949b91?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5be296371d6a7f0097bcf88e88949b91?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">paul</span>
<span class="date">May 14, 2018 at 3:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-437428" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>HI Jason, the example is really good. Besides this I have a question for my data. I have temperature values measured for a sampling rate of 1 second with a sampling frequency of 10.000. So I measure in 1 second 10.000 different values but same unit(lets say force). This I repeat with certain time intervals. Do I have than 10.000 different features or only one feature as input dimension ?</p>
<div class="reply">
<a aria-label="Reply to paul" class="comment-reply-link" href="#comment-437428" onclick='return addComment.moveForm( "comment-437428", "437428", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-437459">
<div class="comment-container" id="li-comment-437459">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 14, 2018 at 6:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-437459" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sounds like 10K features at each time step.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437459" onclick='return addComment.moveForm( "comment-437459", "437459", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-439154">
<div class="comment-container" id="li-comment-439154">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b261a01533afb3fc80c6d6d372488ea7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b261a01533afb3fc80c6d6d372488ea7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">catherine</span>
<span class="date">May 30, 2018 at 10:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-439154" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>this means that one time step can have 10k features?</p>
<div class="reply">
<a aria-label="Reply to catherine" class="comment-reply-link" href="#comment-439154" onclick='return addComment.moveForm( "comment-439154", "439154", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-439187">
<div class="comment-container" id="li-comment-439187">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 31, 2018 at 6:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-439187" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>An NLP problem may have 100K features or more.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-439187" onclick='return addComment.moveForm( "comment-439187", "439187", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-437840">
<div class="comment-container" id="li-comment-437840">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8826bf7b1514aa0b890036f659f588ad?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8826bf7b1514aa0b890036f659f588ad?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hadeer El-Zayat</span>
<span class="date">May 18, 2018 at 7:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-437840" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>great tutorial jason .. but i have a problem in the reshaping my RNN model,,<br/>
this my code</p>
<p>import numpy as np<br/>
from keras.datasets import imdb<br/>
from keras.models import Sequential<br/>
from keras.layers import Dense<br/>
from keras.layers import LSTM<br/>
from keras.layers import Bidirectional<br/>
from keras.preprocessing import sequence<br/>
# fix random seed for reproducibility<br/>
np.random.seed(7)</p>
<p>train = np.loadtxt(“featwithsignalsTRAIN.txt”, delimiter=”,”)<br/>
test = np.loadtxt(“featwithsignalsTEST.txt”, delimiter=”,”)</p>
<p>x_train = train[:,[2,3,4,5,6,7]]<br/>
x_test = test[:,[2,3,4,5,6,7]]<br/>
y_train = train[:,8]<br/>
y_test = test[:,8]</p>
<p># create the model<br/>
model = Sequential()<br/>
model.add(LSTM(20, input_shape=(10,6)))<br/>
model.add(Dense(1415684, activation = ‘sigmoid’))<br/>
model.compile(loss=’binary_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])<br/>
model.fit(x_train, y_train, epochs = 2)</p>
<div class="reply">
<a aria-label="Reply to Hadeer El-Zayat" class="comment-reply-link" href="#comment-437840" onclick='return addComment.moveForm( "comment-437840", "437840", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-437842">
<div class="comment-container" id="li-comment-437842">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 18, 2018 at 8:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-437842" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What problem?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437842" onclick='return addComment.moveForm( "comment-437842", "437842", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-437852">
<div class="comment-container" id="li-comment-437852">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8826bf7b1514aa0b890036f659f588ad?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8826bf7b1514aa0b890036f659f588ad?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hadeer El-Zayat</span>
<span class="date">May 18, 2018 at 11:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-437852" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>a problem of reshaping the dataset..</p>
<div class="reply">
<a aria-label="Reply to Hadeer El-Zayat" class="comment-reply-link" href="#comment-437852" onclick='return addComment.moveForm( "comment-437852", "437852", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-4" id="comment-437853">
<div class="comment-container" id="li-comment-437853">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8826bf7b1514aa0b890036f659f588ad?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8826bf7b1514aa0b890036f659f588ad?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hadeer El-Zayat</span>
<span class="date">May 18, 2018 at 11:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-437853" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>this is a sample of my dataset </p>
<p>a sample of my dataset (patient number, time in mill/sec., normalization of X Y and Z, kurtosis, skewness, pitch, roll and yaw, label) respectively.</p>
<p>1,15,-0.248010047716,0.00378335508419,-0.0152548459993,-86.3738760481,0.872322164158,-3.51314800063,0</p>
<p>1,31,-0.248010047716,0.00378335508419,-0.0152548459993,-86.3738760481,0.872322164158,-3.51314800063,0</p>
<p>1,46,-0.267422664673,0.0051143782875,-0.0191247001961,-85.7662354031,1.0928406847,-4.08015176908,0</p>
<p>1,62,-0.267422664673,0.0051143782875,-0.0191247001961,-85.7662354031,1.0928406847,-4.08015176908,0</p>
<div class="reply">
<a aria-label="Reply to Hadeer El-Zayat" class="comment-reply-link" href="#comment-437853" onclick='return addComment.moveForm( "comment-437853", "437853", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-437864">
<div class="comment-container" id="li-comment-437864">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 18, 2018 at 2:38 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-437864" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, what is the problem that you are having exactly?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-5" id="comment-438000">
<div class="comment-container" id="li-comment-438000">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8826bf7b1514aa0b890036f659f588ad?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8826bf7b1514aa0b890036f659f588ad?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hadeer El-Zayat</span>
<span class="date">May 20, 2018 at 5:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-438000" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>i didn’t even know how to reshape my dataset to fit the RNN model.<br/>
can you please help me?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-438015">
<div class="comment-container" id="li-comment-438015">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 20, 2018 at 6:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-438015" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Here is a ton more help on the topic:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm</a></p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-437997">
<div class="comment-container" id="li-comment-437997">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8826bf7b1514aa0b890036f659f588ad?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8826bf7b1514aa0b890036f659f588ad?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hadeer El-Zayat</span>
<span class="date">May 20, 2018 at 4:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-437997" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>i didn’t kow how td do it !</p>
<div class="reply">
<a aria-label="Reply to Hadeer El-Zayat" class="comment-reply-link" href="#comment-437997" onclick='return addComment.moveForm( "comment-437997", "437997", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-438014">
<div class="comment-container" id="li-comment-438014">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 20, 2018 at 6:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-438014" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Take it slow, one step at a time.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-438014" onclick='return addComment.moveForm( "comment-438014", "438014", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-438021">
<div class="comment-container" id="li-comment-438021">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8826bf7b1514aa0b890036f659f588ad?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8826bf7b1514aa0b890036f659f588ad?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hadeer El-Zayat</span>
<span class="date">May 20, 2018 at 7:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-438021" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>this is what i have accomplished </p>
<p>train = np.loadtxt(“featwithsignalsTRAIN.txt”, delimiter=”,”)<br/>
test = np.loadtxt(“featwithsignalsTEST.txt”, delimiter=”,”)</p>
<p>x_train = train[:,[2,3,4,5,6,7]]<br/>
x_test = test[:,[2,3,4,5,6,7]]<br/>
y_train = train[:,8]<br/>
y_test = test[:,8]</p>
<p>model = Sequential()<br/>
model.add(LSTM(64,activation=’relu’,batch_input_shape=(100, 10, 1),<br/>
                   stateful=True,<br/>
                   return_sequences=False))<br/>
model.add(Dense(1, activation=’linear’))<br/>
model.compile(loss=’mean_squared_error’, optimizer=’adam’)</p>
<p>is that true ??</p>
<div class="reply">
<a aria-label="Reply to Hadeer El-Zayat" class="comment-reply-link" href="#comment-438021" onclick='return addComment.moveForm( "comment-438021", "438021", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-438081">
<div class="comment-container" id="li-comment-438081">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 21, 2018 at 6:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-438081" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice work.</p>
<p>What do you mean by true?</p>
<p>Our job is to find a model that gives “good enough” results when making predictions. This requires careful experimentation.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-438081" onclick='return addComment.moveForm( "comment-438081", "438081", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="comment-438066">
<div class="comment-container" id="li-comment-438066">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8826bf7b1514aa0b890036f659f588ad?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8826bf7b1514aa0b890036f659f588ad?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hadeer El-Zayat</span>
<span class="date">May 21, 2018 at 2:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-438066" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thank you. i have tried the following code </p>
<p>np.random.seed(7)</p>
<p>train = np.loadtxt(“featwithsignalsTRAIN.txt”, delimiter=”,”)<br/>
test = np.loadtxt(“featwithsignalsTEST.txt”, delimiter=”,”)</p>
<p>x_train = train[:,[2,3,4,5,6,7]]<br/>
x_test = test[:,[2,3,4,5,6,7]]<br/>
y_train = train[:,8]<br/>
y_test = test[:,8]</p>
<p>x_train = x_train.reshape((-1,1,6))</p>
<p>model = Sequential()<br/>
model.add(LSTM(64,activation=’relu’,input_shape=(1, 6)))<br/>
model.add(Dense(1, activation=’softmax’))</p>
<p>model.compile(loss=’binary_crossentropy’,<br/>
              optimizer=’adam’,<br/>
              metrics=[‘accuracy’])</p>
<p>model.fit(x_train, y_train, batch_size = 128, epochs = 10, verbose = 2)</p>
<p>but it gets a very low accuracy with very high loss</p>
<p>Epoch 1/20 – 63s – loss: 15.0343 – acc: 0.0570<br/>
Epoch 2/20 – 60s – loss: 15.0343 – acc: 0.0570<br/>
Epoch 3/20 – 60s – loss: 15.0343 – acc: 0.0570<br/>
Epoch 4/20 – 60s – loss: 15.0343 – acc: 0.0570</p>
<div class="reply">
<a aria-label="Reply to Hadeer El-Zayat" class="comment-reply-link" href="#comment-438066" onclick='return addComment.moveForm( "comment-438066", "438066", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-438101">
<div class="comment-container" id="li-comment-438101">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 21, 2018 at 6:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-438101" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps try other configurations, here are some ideas:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-438101" onclick='return addComment.moveForm( "comment-438101", "438101", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-438029">
<div class="comment-container" id="li-comment-438029">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/422e71c809d5776f53ec243417ad03e1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/422e71c809d5776f53ec243417ad03e1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ryan</span>
<span class="date">May 20, 2018 at 10:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-438029" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What does 32 in model.add(LSTM(32)) mean?</p>
<div class="reply">
<a aria-label="Reply to Ryan" class="comment-reply-link" href="#comment-438029" onclick='return addComment.moveForm( "comment-438029", "438029", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-438086">
<div class="comment-container" id="li-comment-438086">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 21, 2018 at 6:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-438086" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It means 32 LSTM units in the layer.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-438086" onclick='return addComment.moveForm( "comment-438086", "438086", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-438526">
<div class="comment-container" id="li-comment-438526">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cd3fa460ab067eaa041a031a7f9d1472?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cd3fa460ab067eaa041a031a7f9d1472?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Godwin</span>
<span class="date">May 25, 2018 at 4:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-438526" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Would have been nice if you have added this info in your article.</p>
<div class="reply">
<a aria-label="Reply to Godwin" class="comment-reply-link" href="#comment-438526" onclick='return addComment.moveForm( "comment-438526", "438526", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-438568">
<div class="comment-container" id="li-comment-438568">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 25, 2018 at 9:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-438568" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion, you can get started with the basics of LSTMs here:<br/>
<a href="https://machinelearningmastery.com/start-here/#lstm" rel="nofollow">https://machinelearningmastery.com/start-here/#lstm</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-438568" onclick='return addComment.moveForm( "comment-438568", "438568", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-438936">
<div class="comment-container" id="li-comment-438936">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/51d27490ab76ea6a36ffee884d865ddd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/51d27490ab76ea6a36ffee884d865ddd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Suzi</span>
<span class="date">May 28, 2018 at 9:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-438936" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason,</p>
<p>Thank you for the great tutorial. It helps me to predict time series data sequences with the lstm model.</p>
<p>However, I have a question about how to determine the length of look_back time steps. </p>
<p>For example, there is a time series sequence X1, X2, X3, …, Xn. When I apply ARIMA for prediction Xn+1, I can use ACF and PCF to determine the parameter pi and qi. The number of pi indicates the look_back time steps. Then, the ARIMA equation can be used to predict Xn+1. </p>
<p>But for lstm, I do not know how to determine the look_back time steps, in other words, the reshape size for a time series sequence. Is there any way to get an appropriate look_back time steps in reshaping the time series sequence data for lstm? Could you pls give me some suggestions about it?</p>
<p>Thanks a lot.</p>
<p>Suzi</p>
<div class="reply">
<a aria-label="Reply to Suzi" class="comment-reply-link" href="#comment-438936" onclick='return addComment.moveForm( "comment-438936", "438936", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-438965">
<div class="comment-container" id="li-comment-438965">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 29, 2018 at 6:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-438965" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Looking at ACF/PACF plots might be a good start to get an idea of the number of lag obs that are significant.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-438965" onclick='return addComment.moveForm( "comment-438965", "438965", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-439009">
<div class="comment-container" id="li-comment-439009">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/51d27490ab76ea6a36ffee884d865ddd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/51d27490ab76ea6a36ffee884d865ddd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Suzi</span>
<span class="date">May 29, 2018 at 5:25 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-439009" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for your quick reply.</p>
<p>I am still confused about your suggestion. Do you mean that I need plot the ACF/PACF to find the number of time lag for applying lstm?</p>
<p>I do not think the the ACF/PACF can be used for determining the look_back time steps for lstm. These two criteria explain the linear correlation of time series.<br/>
For those nonlinear correlation time series sequences, the ACF/PACF is not truncating or tailing and ARIMA cannot be used to model them. </p>
<p>Then I use lstm to model the nonlinear correlation time series sequences and lstm is good at it. Unfortunately, the ACF/PACF is not able to find the time lag in applying lstm.</p>
<p>Before applying lstm for a time series prediction, I must decide the reshape size. However, I cannot find any information on the internet about how to determine it. Is there any book or tutorial can help me to solve this problem? </p>
<p>Thank you very much.</p>
<div class="reply">
<a aria-label="Reply to Suzi" class="comment-reply-link" href="#comment-439009" onclick='return addComment.moveForm( "comment-439009", "439009", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-439066">
<div class="comment-container" id="li-comment-439066">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 30, 2018 at 6:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-439066" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, it is a useful guide / starting point.</p>
<p>I have a ton of advice on preparing data for LSTMs here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-439066" onclick='return addComment.moveForm( "comment-439066", "439066", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-439014">
<div class="comment-container" id="li-comment-439014">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e4eb04ae3cf1166e65b3eb10b3f7331f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e4eb04ae3cf1166e65b3eb10b3f7331f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Eriz</span>
<span class="date">May 29, 2018 at 6:39 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-439014" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>Thanks for the article and clarifying the dimensions which some of us have trouble with them. </p>
<p>However, my question goes to something I didn’t find anybody asked in the Q&amp;A:</p>
<p>Why do you put 32 units in the input LSTM layer? </p>
<p>I mean, if you have 2 features in each of the 10 time steps and one sample example, why would we want to have more than 10 neurons in the first input layer?</p>
<p>As I understand LSTMs, each neuron gets feed with the features of one specific time step (in the cell images of colah’s blog it is stated as Xt, as you will surely know). </p>
<p>If you feed the first one with “t” and continue like “t+1,t+2,t+3…t+10”, what time step will we use in the case of t+17 for example which would be the 17th neuron? </p>
<p>In fully connected ANN the first input layer has the same number of neurons that of features. Is there anything I’m missing or is there any rule to select the number of neurons if we choose that our input layer is a LSTMs one?</p>
<p>Thanks for the attention and for correcting any error that I may be not understanding.</p>
<div class="reply">
<a aria-label="Reply to Eriz" class="comment-reply-link" href="#comment-439014" onclick='return addComment.moveForm( "comment-439014", "439014", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-439069">
<div class="comment-container" id="li-comment-439069">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 30, 2018 at 6:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-439069" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The number of units in the hidden layer is unrelated to the number of input or output time steps.</p>
<p>We configure neural nets by trial and error, more here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/how-many-layers-and-nodes-do-i-need-in-my-neural-network" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-many-layers-and-nodes-do-i-need-in-my-neural-network</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-439069" onclick='return addComment.moveForm( "comment-439069", "439069", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-439094">
<div class="comment-container" id="li-comment-439094">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e4eb04ae3cf1166e65b3eb10b3f7331f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e4eb04ae3cf1166e65b3eb10b3f7331f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Eriz</span>
<span class="date">May 30, 2018 at 9:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-439094" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi again Jason,</p>
<p>Thanks for the quick reply.</p>
<p>Let me please introduce some numbers:</p>
<p>Input_shape = (300, 10, 2)<br/>
Batch_size = 1<br/>
Num_units in input/first LSTM layer = 32</p>
<p>So, as you say, if the units in the input LSTM layer (I am supposing that it is the first layer we use) are not related to the time steps, each time we feed a batch of data into that layer through “Xt” we will feed one row (one sample) of those 300 with 10 columns and we will do it two times: one for the first feature and another for the second feature, and the important point, this feeding will be to every unit of those 32 that compose the LSTM layer. Am I getting the point?</p>
<p>I get confused because in normal feedforward ANN, the first layer (the input layer) has as many nodes as features we have, so that we can feed each feature in one node.</p>
<p>If you could clarify this for me, you would be doing me a big favour because there is not much insight about this details elsewhere.</p>
<p>Thanks in advance,</p>
<div class="reply">
<a aria-label="Reply to Eriz" class="comment-reply-link" href="#comment-439094" onclick='return addComment.moveForm( "comment-439094", "439094", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-439112">
<div class="comment-container" id="li-comment-439112">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 30, 2018 at 3:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-439112" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If your batch size is 1, then each batch will contain one sample (sequence).</p>
<p>Yes, the sequence will be exposed to each unit in the first hidden layer.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-439112" onclick='return addComment.moveForm( "comment-439112", "439112", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-439126">
<div class="comment-container" id="li-comment-439126">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e4eb04ae3cf1166e65b3eb10b3f7331f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e4eb04ae3cf1166e65b3eb10b3f7331f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Eriz</span>
<span class="date">May 30, 2018 at 5:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-439126" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Okey, perfect. Now I get almost all the points.</p>
<p>Thank you for your kindness,</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-440790">
<div class="comment-container" id="li-comment-440790">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/46f77a9c07a1f0127cdbb0d713cca781?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/46f77a9c07a1f0127cdbb0d713cca781?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Manuel Gonçalves</span>
<span class="date">June 14, 2018 at 8:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-440790" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thank you for the articles and books… I just have some open questions about shape. Since  I have a 2D multivariate data  ex: (samples = 1024, features = 6) , and make a supervised learning dataset with ten (10) lags, the shape will be (samples = 1024, features = 60).<br/>
The question is: The shape for  LSTM is (samples, timesteps, features) so it will be  data.reshape(1024, 10, 60) ? I dont, understand why some tutorials use something lile (1, 10, 1) and how to reshape/split train/test on the new shape. The  steps are:</p>
<p>1 – convert to supervised problem.<br/>
2 – reshape the entire 2D dataset or split here and reshape after?<br/>
3 – how about shape of Y to make predictions?</p>
<p>I just need a step with these key points… Thanks for the excelent posts.</p>
<div class="reply">
<a aria-label="Reply to Manuel Gonçalves" class="comment-reply-link" href="#comment-440790" onclick='return addComment.moveForm( "comment-440790", "440790", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-440812">
<div class="comment-container" id="li-comment-440812">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 14, 2018 at 4:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-440812" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>From your description, there is no need to worry about the lag, the time steps take care of that. </p>
<p>The shape would be (1024, 10, 6)</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-440812" onclick='return addComment.moveForm( "comment-440812", "440812", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-441575">
<div class="comment-container" id="li-comment-441575">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/46f77a9c07a1f0127cdbb0d713cca781?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/46f77a9c07a1f0127cdbb0d713cca781?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Manuel Gonçalves</span>
<span class="date">June 22, 2018 at 12:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-441575" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi again Jason, thanks for the reply.  On your example for one and multiple features, you say:<br/>
–  consider a matrix of 2 columns with 10 rows, This data can be framed as 1 sample with 10 timesteps and 2 features. </p>
<p>So,  this “1 sample” is  drive me crazy. When I have a 2D data like  lines vs columns (sample, features), I thought the number of samples will be the number of lines of a matrix 2D data; So it always be (sample, features) –&gt; (sample, timesteps, features). On your example, the rows turned into timesteps and I can’t realize this sample = 1 in this post. Why one sample?  Why rows become timesteps here and become samples on other examples?<br/>
Another question is: After rechape input data,  how to reshape X_train, y_train and new data for predictions.</p>
<div class="reply">
<a aria-label="Reply to Manuel Gonçalves" class="comment-reply-link" href="#comment-441575" onclick='return addComment.moveForm( "comment-441575", "441575", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-441608">
<div class="comment-container" id="li-comment-441608">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 22, 2018 at 6:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-441608" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It is challenging in the beginning.</p>
<p>Think about it like this: you are taking a 2D dataset and projecting it into a 3D space.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-441608" onclick='return addComment.moveForm( "comment-441608", "441608", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-441552">
<div class="comment-container" id="li-comment-441552">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fdf0453372d624a9c1b9774ecf4aad8c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fdf0453372d624a9c1b9774ecf4aad8c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hajar</span>
<span class="date">June 21, 2018 at 6:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-441552" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, </p>
<p>Why do we need to reshape data on 3 dimensions for the LSTM </p>
<p>Thank you</p>
<div class="reply">
<a aria-label="Reply to Hajar" class="comment-reply-link" href="#comment-441552" onclick='return addComment.moveForm( "comment-441552", "441552", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-441598">
<div class="comment-container" id="li-comment-441598">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 22, 2018 at 6:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-441598" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Because LSTMs expect data as input in 3 dimensions.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-441598" onclick='return addComment.moveForm( "comment-441598", "441598", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-442096">
<div class="comment-container" id="li-comment-442096">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/27324668dcf5b79c26452cf20e74d393?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/27324668dcf5b79c26452cf20e74d393?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">akbar</span>
<span class="date">June 26, 2018 at 7:51 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-442096" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Thank you so much for this article, it helped me understand Keras and Overall Input thing.<br/>
I am really confused how can I prepare the output data. Overall the output</p>
<p>at one point we use </p>
<p><code></code><code><br/>
model.fit(X_train, y_train, validation_data=(X_test, y_test), epochs=3, batch_size=64)</code></p>
<p><code></code><br/>
I have  (25000, 15) input shape, How can I prepare the overall output</p>
<div class="reply">
<a aria-label="Reply to akbar" class="comment-reply-link" href="#comment-442096" onclick='return addComment.moveForm( "comment-442096", "442096", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-442134">
<div class="comment-container" id="li-comment-442134">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 27, 2018 at 8:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-442134" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Why, what problem are you having exactly?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442134" onclick='return addComment.moveForm( "comment-442134", "442134", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-442573">
<div class="comment-container" id="li-comment-442573">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8456ba754cacb8d67fda383e7cf1db9f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8456ba754cacb8d67fda383e7cf1db9f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">koho</span>
<span class="date">July 3, 2018 at 5:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-442573" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for sharing. I am confused about the padding and “sliding window” method. Suppose the dataset contains two sequences s1,s2 and time_step is set to 3, then s1=(1,2,3,4,5) should have 2 subsequences: [(1,2,3), (2,3,4)], s2=(6,7,8,9,10,11,12) should have 4 subsequences: [(6,7,8), (7,8,9), (8,9,10), (9,10,11)]. Theses 6 subsequences have the same length equal to time_step, so it can be reshaped to 3D tensor (6, 3, 1) without padding s1 and s2 into same length. If all the sequences length are greater than the time_step, then we don’t need to pad the sequences into same length. Am I right?</p>
<div class="reply">
<a aria-label="Reply to koho" class="comment-reply-link" href="#comment-442573" onclick='return addComment.moveForm( "comment-442573", "442573", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-442608">
<div class="comment-container" id="li-comment-442608">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 4, 2018 at 8:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-442608" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Padding is only required if the number of time steps differ and/or if obs for a time step are missing.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442608" onclick='return addComment.moveForm( "comment-442608", "442608", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-443056">
<div class="comment-container" id="li-comment-443056">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e97fc82b05d91f971b158312732a3006?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e97fc82b05d91f971b158312732a3006?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anna</span>
<span class="date">July 10, 2018 at 4:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-443056" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, thanks for the great article!</p>
<p>Say I have a normalized 2D array data with a shape of (10,2)</p>
<p>but when I want to reshape the data to a 3D array of (10,3,2), I got an error saying:</p>
<p>“ValueError: cannot reshape array of size 20 into shape (10,3,2)”</p>
<p>It seems that the previous 2D array multiply the samples of data of 10 with the input dimensions of 2 before reshaping it to a 3D array, and perhaps that caused the error?</p>
<p>Thanks in advance,</p>
<div class="reply">
<a aria-label="Reply to Anna" class="comment-reply-link" href="#comment-443056" onclick='return addComment.moveForm( "comment-443056", "443056", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-443090">
<div class="comment-container" id="li-comment-443090">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 10, 2018 at 6:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-443090" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You need more data to go from (10,2) to (10,3,2), think about it, maybe even draw a pic of it. You are invention dimensions that don’t exist in your original data.</p>
<p>You would beed (10,6) to go to (10,3,2)</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443090" onclick='return addComment.moveForm( "comment-443090", "443090", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-443129">
<div class="comment-container" id="li-comment-443129">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e97fc82b05d91f971b158312732a3006?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e97fc82b05d91f971b158312732a3006?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anna</span>
<span class="date">July 10, 2018 at 3:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-443129" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ok I think I got it, I should actually divide the samples with the timesteps, because doing this finally solved my problem! Thanks Jason!</p>
<div class="reply">
<a aria-label="Reply to Anna" class="comment-reply-link" href="#comment-443129" onclick='return addComment.moveForm( "comment-443129", "443129", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-443126">
<div class="comment-container" id="li-comment-443126">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e97fc82b05d91f971b158312732a3006?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e97fc82b05d91f971b158312732a3006?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anna</span>
<span class="date">July 10, 2018 at 3:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-443126" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ok I see. So, does reframed first the data with lagged t-n solved the issue?</p>
<div class="reply">
<a aria-label="Reply to Anna" class="comment-reply-link" href="#comment-443126" onclick='return addComment.moveForm( "comment-443126", "443126", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-443319">
<div class="comment-container" id="li-comment-443319">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d7ef87f8181ca8910b2f244103f2c432?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d7ef87f8181ca8910b2f244103f2c432?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rana</span>
<span class="date">July 13, 2018 at 12:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-443319" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If you may I Have a Question : I Have 20 Topics (classes) each topic have 700 files each file is a represent a document but in word embedding representation (size of each file : number of words X 300 features ) I want to train a LSTM Network is it possible and how  ?﻿</p>
<div class="reply">
<a aria-label="Reply to Rana" class="comment-reply-link" href="#comment-443319" onclick='return addComment.moveForm( "comment-443319", "443319", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-443346">
<div class="comment-container" id="li-comment-443346">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 13, 2018 at 7:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-443346" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can get started with LSTMs and text data here:<br/>
<a href="https://machinelearningmastery.com/start-here/#nlp" rel="nofollow">https://machinelearningmastery.com/start-here/#nlp</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443346" onclick='return addComment.moveForm( "comment-443346", "443346", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-443631">
<div class="comment-container" id="li-comment-443631">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d7ef87f8181ca8910b2f244103f2c432?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d7ef87f8181ca8910b2f244103f2c432?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rana</span>
<span class="date">July 17, 2018 at 12:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-443631" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you so much I will look it up …</p>
<div class="reply">
<a aria-label="Reply to Rana" class="comment-reply-link" href="#comment-443631" onclick='return addComment.moveForm( "comment-443631", "443631", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-4" id="comment-443816">
<div class="comment-container" id="li-comment-443816">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d7ef87f8181ca8910b2f244103f2c432?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d7ef87f8181ca8910b2f244103f2c432?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rana</span>
<span class="date">July 18, 2018 at 8:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-443816" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have another question please, so for my problem does your book “Deep Learning for Natural Language Processing”  have LSTM in it because I don’t only want to take the word embedding only but I want to take word’s order in consideration .<br/>
or I’ll need your book “Long Short-Term Memory Networks With Python” also ?</p>
<p>Sorry for bothering you with my questions but I’m really stuck and I don’t have anyone who can help me in this matter.</p>
<p>Thanks in advance…</p>
<p>Best Regards,</p>
<div class="reply">
<a aria-label="Reply to Rana" class="comment-reply-link" href="#comment-443816" onclick='return addComment.moveForm( "comment-443816", "443816", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-443855">
<div class="comment-container" id="li-comment-443855">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 19, 2018 at 7:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-443855" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I give examples of addressing NLP problems with LSTMs as well as other networks like MLPs and CNNs in “deep learning for nlp”.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-443408">
<div class="comment-container" id="li-comment-443408">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/38ba6b99ef6ffc87c9394cb84d503a8c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/38ba6b99ef6ffc87c9394cb84d503a8c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Neda</span>
<span class="date">July 14, 2018 at 5:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-443408" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, Jason, for your wonderful blog posts!</p>
<p>I have a question regarding the input shape which I cannot find a solid answer to. I don’t know how much this question is related to this blog post, but would appreciate to hear your answer to my question:</p>
<p>I have a training set which contains sequences of images (say n is the number of the images in the sequence and c, h, w are channel , height, and width). I have trained a CNN-LSTM on that with the input shape of (n,c,h,w).</p>
<p>Now, for predicting through this network, it seems I have to feed sequences of data to it at each time (not a single frame). That is, with each new frame I need to update the sequence and feed it to the network to get the results.</p>
<p>However, I was under the impression that when dealing with RNN or LSTM, we can feed one frame at a time (because of recurrency), rather than feeding the whole sequence. Was this impression wrong? </p>
<p>So, briefly, when having an LSTM network for real time prediction, do we need to feed sequences to the network, or are  there cases that we may feed a single signal/frame/datapoint?</p>
<p>Thanks a lot in advance!</p>
<div class="reply">
<a aria-label="Reply to Neda" class="comment-reply-link" href="#comment-443408" onclick='return addComment.moveForm( "comment-443408", "443408", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-443437">
<div class="comment-container" id="li-comment-443437">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 14, 2018 at 6:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-443437" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, you can feed one frame of video at a time and have the CNN interpret the frames, then the LSTM put the sequence together and interpret them all.</p>
<p>I have an example of this in my LSTM book. I have a summary of how to do this in Keras here:<br/>
<a href="https://machinelearningmastery.com/cnn-long-short-term-memory-networks/" rel="nofollow">https://machinelearningmastery.com/cnn-long-short-term-memory-networks/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443437" onclick='return addComment.moveForm( "comment-443437", "443437", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-443442">
<div class="comment-container" id="li-comment-443442">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/38ba6b99ef6ffc87c9394cb84d503a8c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/38ba6b99ef6ffc87c9394cb84d503a8c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Neda</span>
<span class="date">July 14, 2018 at 7:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-443442" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks! I went through your other blog post before (and now again). But still I don’t see how I can feed one frame at a time. How about the input size? </p>
<p>Do you mean I can have a CNN and a seperate LSTM. Feed frames one at a time to CNN and then in a sequence to LSTM? This means, again, I have to create the sequence myself to feed to the network?</p>
<p>What I don’t understand is that the input-shape of the trained network is defined to be (n, c, h, w), how can I feed an input of shape (1,c,h,w) when n is not 1?</p>
<div class="reply">
<a aria-label="Reply to Neda" class="comment-reply-link" href="#comment-443442" onclick='return addComment.moveForm( "comment-443442", "443442", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-4" id="comment-443444">
<div class="comment-container" id="li-comment-443444">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/38ba6b99ef6ffc87c9394cb84d503a8c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/38ba6b99ef6ffc87c9394cb84d503a8c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Neda</span>
<span class="date">July 14, 2018 at 7:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-443444" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>By the way, I have already wrapped my CNN in TimeDistributed layer. my code is as below</p>
<p>model.add(TimeDistributed(Conv2D(24, (5, 5), padding=’same’, activation=’relu’, kernel_constraint = maxnorm(3), kernel_initializer=’he_normal’), input_shape=(5,1, 125, 150)))<br/>
model.add(TimeDistributed(MaxPooling2D(pool_size=(2, 2), strides = (2,2))))<br/>
model.add(TimeDistributed(Dropout(0.4)))</p>
<p>model.add(TimeDistributed(Conv2D(36, (5, 5), activation=’relu’, padding=’same’, kernel_constraint=maxnorm(3))))<br/>
model.add(TimeDistributed(MaxPooling2D(pool_size=(2, 2), strides = (2,2))))<br/>
model.add(TimeDistributed(Dropout(0.6)))</p>
<p>model.add(TimeDistributed(Conv2D(50, (5, 5), padding=’same’, activation=’relu’, kernel_constraint = maxnorm(3))))<br/>
model.add(TimeDistributed(MaxPooling2D(pool_size=(2, 2), strides = (2,2))))<br/>
model.add(TimeDistributed(Dropout(0.4)))</p>
<p>model.add(TimeDistributed(Conv2D(70, (5, 5), padding=’same’, activation=’relu’, kernel_constraint = maxnorm(3))))<br/>
model.add(TimeDistributed(MaxPooling2D(pool_size=(2, 2), strides = (2,2))))<br/>
model.add(TimeDistributed(Dropout(0.5)))</p>
<p>model.add(TimeDistributed(Flatten()))</p>
<p># define LSTM model<br/>
model.add(LSTM(128, return_sequences=True))<br/>
model.add(LSTM(32))<br/>
model.add(Dense(2, activation=’sigmoid’))</p>
<div class="reply">
<a aria-label="Reply to Neda" class="comment-reply-link" href="#comment-443444" onclick='return addComment.moveForm( "comment-443444", "443444", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-443503">
<div class="comment-container" id="li-comment-443503">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 15, 2018 at 6:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-443503" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, it is one model. The size to the CNN is the size of one image. Images are exposed to the model in a sequence, something like:<br/>
[samples, frames, width, height, channels]</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443503" onclick='return addComment.moveForm( "comment-443503", "443503", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-444228">
<div class="comment-container" id="li-comment-444228">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/de9acc5b73b3deeb7d6677573ffd59db?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/de9acc5b73b3deeb7d6677573ffd59db?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">WESIN RIBEIRO ALVES</span>
<span class="date">July 24, 2018 at 3:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-444228" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, Jason, for your wonderful post!</p>
<p>I created a model before to read your post, and I see that I made a mistake. I swapped time step by feature. How much this can impact in model performance?</p>
<p>Best regards!</p>
<div class="reply">
<a aria-label="Reply to WESIN RIBEIRO ALVES" class="comment-reply-link" href="#comment-444228" onclick='return addComment.moveForm( "comment-444228", "444228", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-444253">
<div class="comment-container" id="li-comment-444253">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 24, 2018 at 6:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-444253" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The model learns over time. Time is key to the models understanding of the sequence.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444253" onclick='return addComment.moveForm( "comment-444253", "444253", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-444454">
<div class="comment-container" id="li-comment-444454">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d65ef1f0d6de1adcd71afed1d0aa7727?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d65ef1f0d6de1adcd71afed1d0aa7727?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Guy Ben Mayor</span>
<span class="date">July 26, 2018 at 5:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-444454" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, thanks for the great article 🙂</p>
<p>One thing I did’t understand on LSTM network-<br/>
If the output of each time step suppose to predict the next input,<br/>
how come that the input vector dimension (witch related to the features number) not equal to output vector dimension (witch related to the number of units in the layer)</p>
<div class="reply">
<a aria-label="Reply to Guy Ben Mayor" class="comment-reply-link" href="#comment-444454" onclick='return addComment.moveForm( "comment-444454", "444454", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-444492">
<div class="comment-container" id="li-comment-444492">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 27, 2018 at 5:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-444492" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Other way around.</p>
<p>The output at one step may be used as input at the next step.</p>
<p>Perhaps this will help:<br/>
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444492" onclick='return addComment.moveForm( "comment-444492", "444492", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-444813">
<div class="comment-container" id="li-comment-444813">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c7a1c86062ccd3fd87d9ba527f166729?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c7a1c86062ccd3fd87d9ba527f166729?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">IM</span>
<span class="date">July 31, 2018 at 1:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-444813" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Many thanks for the post – it was really useful!</p>
<p>I would just like to run my problem through with you just to verify you feel the approach outlined in this tutorial is suitable for me:</p>
<p>I have two columns of data  – one is resonance energies and the other is corresponding neutron widths.  I want to feed 70% of this data to the network i.e  values of resonance energies and neutron neutrons.  Then ask the network to predict the neutron width values given the remaining 30% unseen resonance energies.</p>
<p>I wanted an LSTM layer as it may help use previous computations in its current prediction.</p>
<p>So I believe I have 2 inputs and one output.</p>
<p>If i have 300 values of [resonance energies, neutron widths] (i.e 300 rows of data) would my reshape be:<br/>
reshape(1, 300, 2) or reshape(1, 300, 1) ? I’m not sure if the second column is technically a feature as its meant to be the output.</p>
<p>Also would i need any explicit pairing given each resonance energy is related to the neutron width on the same row? Or should i use some key-value pair?</p>
<p>(This is also the first experiment, I also hope to then use resonance energy and neutron width to predict another variable but essentially in exactly the same way as described in this problem just the new experiment contains one more feature)</p>
<div class="reply">
<a aria-label="Reply to IM" class="comment-reply-link" href="#comment-444813" onclick='return addComment.moveForm( "comment-444813", "444813", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-444836">
<div class="comment-container" id="li-comment-444836">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 31, 2018 at 6:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-444836" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It sounds like you have 300 time steps of 1 input feature.</p>
<p>You could have one sample of [1,300,1] but that would not be enough to train a model.</p>
<p>Perhaps you can split the input samples into smaller subsequences of 5 or 10 time steps?</p>
<p>Perhaps this worked example will make things clearer for you:<br/>
<a href="https://machinelearningmastery.com/prepare-univariate-time-series-data-long-short-term-memory-networks/" rel="nofollow">https://machinelearningmastery.com/prepare-univariate-time-series-data-long-short-term-memory-networks/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444836" onclick='return addComment.moveForm( "comment-444836", "444836", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-444973">
<div class="comment-container" id="li-comment-444973">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c7a1c86062ccd3fd87d9ba527f166729?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c7a1c86062ccd3fd87d9ba527f166729?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">IM</span>
<span class="date">August 1, 2018 at 9:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-444973" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you very much for the swift reply.  </p>
<p>Ah my data is here<br/>
<a href="https://pastebin.com/index/9qwJU3AQ" rel="nofollow">https://pastebin.com/index/9qwJU3AQ</a></p>
<p>I have read the link you provided however I am unclear as to whether my data allows me to drop the time variable as mentioned in your article.  If so, I could perhaps have the sample of [1,300,1] as opposed to [1,300,2]</p>
<p>One  query I have is I’m getting a score of  ‘Test Score: 0.00 MSE (0.01 RMSE)” for my test set (which is 30% of my samples) would not having enough samples really be shown by such low RMSE scores? If anything doesn’t that show the predictions are almost too good (or overfitting)?</p>
<p>Sorry one final thing from reading this tutorial – If one uses an LSTM layer, is it still possible to use look_back? (an argument used quite frequently in your other tutorials when creating a dataset).  If I am correct, an LSTM layer essentially allows for previous calculations to be examined when determining the current calculation, but look_back determines how many previous timesteps can be consider at each timestep calculation?</p>
<div class="reply">
<a aria-label="Reply to IM" class="comment-reply-link" href="#comment-444973" onclick='return addComment.moveForm( "comment-444973", "444973", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-444982">
<div class="comment-container" id="li-comment-444982">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 1, 2018 at 2:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-444982" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I do not have the capacity to shape the data for you. I believe you have everything you need to shape your data for an LSTM model.</p>
<p>A look-back refers to the number of prior time steps of data to feed to the model in one sample. E.g. the “timesteps” in [samples, timesteps, features].</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444982" onclick='return addComment.moveForm( "comment-444982", "444982", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-445100">
<div class="comment-container" id="li-comment-445100">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c7a1c86062ccd3fd87d9ba527f166729?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c7a1c86062ccd3fd87d9ba527f166729?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Isaac</span>
<span class="date">August 3, 2018 at 5:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-445100" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Sure that sounds good I will have a go at that.  </p>
<p>One quick question I had is when I plot my results in many of your tutorial you tend to use the lines:</p>
<p>testPredictPlot = numpy.empty_like(dataset)<br/>
testPredictPlot[:, :] = numpy.nan<br/>
testPredictPlot[len(trainPredict)+(look_back)+1:len(dataset)-1, :] = testPredict</p>
<p>so the first line simply creates the numpy matrix like dataset,<br/>
but does the second line fill it with nan values? (if so why, or is it just a check?)<br/>
The third line then shift the test predict plot?</p>
<p>Many thanks</p>
<div class="reply">
<a aria-label="Reply to Isaac" class="comment-reply-link" href="#comment-445100" onclick='return addComment.moveForm( "comment-445100", "445100", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-445122">
<div class="comment-container" id="li-comment-445122">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 3, 2018 at 6:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-445122" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re explanation seems correct.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-445122" onclick='return addComment.moveForm( "comment-445122", "445122", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-446424">
<div class="comment-container" id="li-comment-446424">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d14465c2430cbc5b1326a22b38a34b61?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d14465c2430cbc5b1326a22b38a34b61?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ray</span>
<span class="date">August 18, 2018 at 11:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-446424" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thank you for this post. I’ve learned a lot from it.<br/>
I have a question about my LSTM model for classification.<br/>
My input data is 4842 samples, 34 time steps, 254 features. In other words, it’s (4842,34,254).<br/>
I have trained it with proper parameters. Although I got a decent result with 98% accuracy on validation data, I got pretty low accuracy at around 20% on test data (from separate data).<br/>
My first thought is overfitting but I also tried callback function such as earlystopping or reducelronplateau. It does not give me a better result.<br/>
Could you give me any suggestions on this issue?</p>
<p>Many thanks!</p>
<div class="reply">
<a aria-label="Reply to Ray" class="comment-reply-link" href="#comment-446424" onclick='return addComment.moveForm( "comment-446424", "446424", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-446455">
<div class="comment-container" id="li-comment-446455">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 19, 2018 at 6:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-446455" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, sounds like overfitting.</p>
<p>I have a suite of ideas here to try:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-446455" onclick='return addComment.moveForm( "comment-446455", "446455", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-447589">
<div class="comment-container" id="li-comment-447589">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/31aadce94c562bf36c551a7c5683adcb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/31aadce94c562bf36c551a7c5683adcb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Amal</span>
<span class="date">September 2, 2018 at 5:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-447589" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I learn a lot from your blog posts. For this specific post, I have three specific questions. </p>
<p>Q1:  How do we decide the value of FIRST parameter of the constructor LSTM. You used LSTM (32, …). How was that value of 32 decided for the representative problem that is being addressed here? For word embedding input, is a vlaue between 200 and 500 reasonable? </p>
<p>Q3:  What is the significane of this parameter? Is it number of LSTM cells and should it be matched with the value of dimension of input layer of the Keras model (in case of work embedding, value b/w 200 and 500)? </p>
<p>Q3: What would be perfformance impact of choosing a value of 500 for this parameter? </p>
<p>Thanks and Regards</p>
<div class="reply">
<a aria-label="Reply to Amal" class="comment-reply-link" href="#comment-447589" onclick='return addComment.moveForm( "comment-447589", "447589", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-447619">
<div class="comment-container" id="li-comment-447619">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 3, 2018 at 6:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-447619" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The number of nodes in the first hidden layer is found via trial and error or tuning, more here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/how-many-layers-and-nodes-do-i-need-in-my-neural-network" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-many-layers-and-nodes-do-i-need-in-my-neural-network</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-447619" onclick='return addComment.moveForm( "comment-447619", "447619", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-447761">
<div class="comment-container" id="li-comment-447761">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/83f17e34f558b6aba4768207ea021e46?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/83f17e34f558b6aba4768207ea021e46?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Joshua Dawson</span>
<span class="date">September 4, 2018 at 11:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-447761" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I just don’t understand reshape. I do not see how you calculate the array and enter it to batch size or train data on it. I have been stuck on this all day and googling. Any help from anyone is greatly appreciated</p>
<div class="reply">
<a aria-label="Reply to Joshua Dawson" class="comment-reply-link" href="#comment-447761" onclick='return addComment.moveForm( "comment-447761", "447761", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-447770">
<div class="comment-container" id="li-comment-447770">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 4, 2018 at 1:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-447770" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps go back to basics and learn how to use the reshape function:<br/>
<a href="https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/" rel="nofollow">https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-447770" onclick='return addComment.moveForm( "comment-447770", "447770", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-448724">
<div class="comment-container" id="li-comment-448724">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7ce5fd689740f50e1a3b40db5780b3aa?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7ce5fd689740f50e1a3b40db5780b3aa?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">osam</span>
<span class="date">September 14, 2018 at 2:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-448724" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hello Jason, thanks for your great explanation<br/>
can you help me with this question:</p>
<p><a href="https://stackoverflow.com/questions/52317804/recurrent-neural-network-using-different-time-steps-with-keras" rel="nofollow">https://stackoverflow.com/questions/52317804/recurrent-neural-network-using-different-time-steps-with-keras</a></p>
<div class="reply">
<a aria-label="Reply to osam" class="comment-reply-link" href="#comment-448724" onclick='return addComment.moveForm( "comment-448724", "448724", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-448747">
<div class="comment-container" id="li-comment-448747">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 14, 2018 at 6:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-448747" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps you can summarize it for me in a sentence?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-448747" onclick='return addComment.moveForm( "comment-448747", "448747", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-449524">
<div class="comment-container" id="li-comment-449524">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/61773f170dea26dc5965174fd10cff97?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/61773f170dea26dc5965174fd10cff97?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sophia</span>
<span class="date">September 22, 2018 at 2:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-449524" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>I have multidimensional timeseries data with a sample size of 200,000 and 50 dimensions.<br/>
I want to train a sequence to sequence autoencoder on normal data to use it later to detect anomalies. I want to have a go at this task using a LSTM autoencoder, using the example from the keras site:</p>
<p><a href="https://blog.keras.io/building-autoencoders-in-keras.html" rel="nofollow">https://blog.keras.io/building-autoencoders-in-keras.html</a></p>
<p>inputs = Input(shape=(timesteps, input_dim))<br/>
encoded = LSTM(latent_dim)(inputs)</p>
<p>decoded = RepeatVector(timesteps)(encoded)<br/>
decoded = LSTM(input_dim, return_sequences=True)(decoded)</p>
<p>sequence_autoencoder = Model(inputs, decoded)<br/>
encoder = Model(inputs, encoded)</p>
<p>I am confused about how to convert my data.<br/>
When generating the sequences lets say with a timestep of 100: do I convert this 200k data into separate sequences of 100, or use a sliding window to generate my sequences?</p>
<p>Many thanks for your help.</p>
<div class="reply">
<a aria-label="Reply to Sophia" class="comment-reply-link" href="#comment-449524" onclick='return addComment.moveForm( "comment-449524", "449524", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-449545">
<div class="comment-container" id="li-comment-449545">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 22, 2018 at 6:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-449545" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, you split the long sequence into subsequences.</p>
<p>No need to overlap, but you can if you want and see if it improves detection.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-449545" onclick='return addComment.moveForm( "comment-449545", "449545", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-450715">
<div class="comment-container" id="li-comment-450715">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b3bbe3a655818c0e5db63cb43bbcc1a4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b3bbe3a655818c0e5db63cb43bbcc1a4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Pawan</span>
<span class="date">October 5, 2018 at 4:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-450715" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Excellent tutorial. I have a question that I wanted to ask.<br/>
I have a total of 3 sequences.<br/>
Sequence 1: It has a shape of 800×2500 (800 observations and 2500 features) It falls into category 1<br/>
Sequence 2: It has a shape of 1000×2500. It falls into category 2<br/>
Sequence 3: It has a shape of 600×2500. It falls into category 3.<br/>
I have combined these 3 sequences into 1 array which has 2400×2500 features. I want to train an LSTM network on this array. Want it to learn pattern of these sequences and predict the category (1,2 r 3) given a new test sequence of any length (? x 2500) shape.</p>
<p>What should my input shape be? Should it be (1,2400,2500)?</p>
<div class="reply">
<a aria-label="Reply to Pawan" class="comment-reply-link" href="#comment-450715" onclick='return addComment.moveForm( "comment-450715", "450715", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-450737">
<div class="comment-container" id="li-comment-450737">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 5, 2018 at 5:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-450737" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Each sequence would be a separate sample and the number of time steps would have to be padded with zeros to match.</p>
<p>The shape would be: [3, 1000, 2500]</p>
<p>Training a model on 3 samples does not sound useful, you might need 3 thousand or 3 million samples.</p>
<p>Also, 1000 time steps might be a little long, 200-400 is preferred.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-450737" onclick='return addComment.moveForm( "comment-450737", "450737", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-451752">
<div class="comment-container" id="li-comment-451752">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2545936e2f2ba69a20bff0f73922d5a8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2545936e2f2ba69a20bff0f73922d5a8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Halidi</span>
<span class="date">October 16, 2018 at 8:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-451752" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>model.fit(trainX,trainY,epochs=100,verbose=0)</p>
<p>ValueError: Error when checking input: expected lstm_2_input to have shape (3, 1) but got array with shape (1, 1) this error occur</p>
<div class="reply">
<a aria-label="Reply to Halidi" class="comment-reply-link" href="#comment-451752" onclick='return addComment.moveForm( "comment-451752", "451752", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-451766">
<div class="comment-container" id="li-comment-451766">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 16, 2018 at 2:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-451766" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have some suggestions here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-451766" onclick='return addComment.moveForm( "comment-451766", "451766", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-451818">
<div class="comment-container" id="li-comment-451818">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e4c7f41c0748f35bb4406c41d2fd6722?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e4c7f41c0748f35bb4406c41d2fd6722?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">adel</span>
<span class="date">October 17, 2018 at 3:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-451818" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
thank you so much for this tutorial. I have a question conserning Conv2D </p>
<p>i want to devlop model for binery image classification with size (256*256)</p>
<p>i put my image in liste numpy with lenth (10000)  and each index have np.array (256*256) </p>
<p>i get error when i start fit the model with input_shape = (256,256,1)</p>
<p>what i should define input shape </p>
<p>thank you</p>
<div class="reply">
<a aria-label="Reply to adel" class="comment-reply-link" href="#comment-451818" onclick='return addComment.moveForm( "comment-451818", "451818", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-451848">
<div class="comment-container" id="li-comment-451848">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 17, 2018 at 6:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-451848" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>A 2D CNN will require input with the shape: rows x cols x channels. [256,256,1] sounds right.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-451848" onclick='return addComment.moveForm( "comment-451848", "451848", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-452533">
<div class="comment-container" id="li-comment-452533">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3a0baee1bda06c9e2d624833a8807ed1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3a0baee1bda06c9e2d624833a8807ed1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tomas Bo</span>
<span class="date">October 24, 2018 at 7:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-452533" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, thank you for your tutorials.</p>
<p>I am trying to understand data inputs to LSTM autoencoder, but I am lost.<br/>
I want use autoencoder for anomaly detection in time series (falling detection).</p>
<p>Dataset:<br/>
500 samples (data from gyroscope – walking, jumping, running…)<br/>
600-10000 time steps in each sample (6-100seconds).<br/>
3 features.</p>
<p>Example of one sample(one file):<br/>
time	          x		 y		 z<br/>
1		1.3		9.6		1.3<br/>
2		1.2		9.3		1.5<br/>
3		0.9		8.0		-2<br/>
.                 .               .               .<br/>
.                 .               .               .<br/>
.		  .		  .		  .<br/>
1000	1.4		9.8		 2</p>
<p>Idea:<br/>
Train autoencoder to reproduce normal data(walking,jumping,running…).<br/>
Anomaly detection: Reproduction error.<br/>
I want to check anomaly (fall) in 2second time windows(200 time steps) -&gt; Reproduce every 2second window and check reproduction error.</p>
<p>Questions:<br/>
Can you please explain how to prepare dataset for this task?(dimensions, structure of dataset…)</p>
<p>How big batches and time steps(seq_length) shoud I use?</p>
<p>Should I generate batches randomly, or from start of dataset? (batch1: 0 – batch_size, batch2: batch_size-batch_size*2 …) -&gt; I saw that someone generated random batches in every iteration. Couldn’t that cause some data to be used multiple times and others is not used at all?</p>
<p>Thank you.</p>
<div class="reply">
<a aria-label="Reply to Tomas Bo" class="comment-reply-link" href="#comment-452533" onclick='return addComment.moveForm( "comment-452533", "452533", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-452571">
<div class="comment-container" id="li-comment-452571">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 24, 2018 at 2:39 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-452571" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have an example of preparing activity recognition data or an LSTM here that might be useful:<br/>
<a href="https://machinelearningmastery.com/how-to-model-human-activity-from-smartphone-data/" rel="nofollow">https://machinelearningmastery.com/how-to-model-human-activity-from-smartphone-data/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-452571" onclick='return addComment.moveForm( "comment-452571", "452571", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-452594">
<div class="comment-container" id="li-comment-452594">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/29bd436e0c8e5c9eb76f0f0f7cf68bbe?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/29bd436e0c8e5c9eb76f0f0f7cf68bbe?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jaskaran</span>
<span class="date">October 24, 2018 at 5:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-452594" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, thanks a lot for this tutorial. I’m working on some project but still stuck after reading this. Here’s the description</p>
<p>I have a dataframe of 2 columns, both text – one is title and other is the label to it.<br/>
Unique label count is around 40k so one hot encode was out of question.<br/>
I used word2vec with size=150 for both, trained and used the created model to encode both title and label.<br/>
e.g. for hello world<br/>
I split them and then use their respective word vectors of size 150, add them and normalize to create a vector that represents hello world.</p>
<p>So both columns in my dataframe had been changed and each column of each row has a vector.</p>
<p>dataframe.shape shows (len, 2) where len is length of dataframe<br/>
and then I did</p>
<p>X = df[‘title’].values<br/>
y = df[‘label’].values</p>
<p>and I got two numpy.ndarray with following shapes</p>
<p>X.shape –&gt; (len,)<br/>
X[0].shape –&gt; (150,)<br/>
y.shape –&gt; (len,)<br/>
y[0].shape –&gt; (150,)</p>
<p>After this I’m stuck with input and output shapes for the network. </p>
<p>I tried with LSTM and I got the error that lstm expected 3 dimensions but got array</p>
<p>I tried with Dense layers and still got shape errors.</p>
<p>Basically I’m struggling as to what the input and output should be for the network.</p>
<p>Any help in this regard is appreciated. I can provide more details and code if needed.</p>
<div class="reply">
<a aria-label="Reply to Jaskaran" class="comment-reply-link" href="#comment-452594" onclick='return addComment.moveForm( "comment-452594", "452594", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-452659">
<div class="comment-container" id="li-comment-452659">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 25, 2018 at 7:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-452659" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What do you mean you used word2vec for the label? Does that mean you are predicting a vector that is then mapped to words? Sounds odd.</p>
<p>I would recommend an embedding on the front end and softmax on the output with 40k one hot encoded vectors.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-452659" onclick='return addComment.moveForm( "comment-452659", "452659", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-453736">
<div class="comment-container" id="li-comment-453736">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cf5379ca84454af9c9cb4de50a122d93?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cf5379ca84454af9c9cb4de50a122d93?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">rajesh</span>
<span class="date">November 5, 2018 at 6:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-453736" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi jason, thank you for the tutorial.</p>
<p>I am trying to feed 3 column(3316 rows) merged encoded text Train_data and Train_Labels categorizing class 1-9(3316 rows) to an lstm network.<br/>
Train_input  last column is output of word embedded vector of 50 dimensions,(3316,50)<br/>
Train_input first and second columns are words – one-hot encoded text data (3316,2)<br/>
After merging three columns the shape is (samples=1, time_steps=3316, features=3)</p>
<p>TraIN_LABELS  categorizing above train_data into class 1-9. encoded it using label encoder.</p>
<p>train_input=(1,3316,3), train_label=(1,3316,9) facing error with this data shape</p>
<p>reshaping labels to (1,3316,3) is not happening </p>
<p>how do i reshape labels to feed to lstm?</p>
<div class="reply">
<a aria-label="Reply to rajesh" class="comment-reply-link" href="#comment-453736" onclick='return addComment.moveForm( "comment-453736", "453736", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-453790">
<div class="comment-container" id="li-comment-453790">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 6, 2018 at 6:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-453790" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The labels are typically a 1D array with one element per input sample.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453790" onclick='return addComment.moveForm( "comment-453790", "453790", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-453978">
<div class="comment-container" id="li-comment-453978">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cf5379ca84454af9c9cb4de50a122d93?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cf5379ca84454af9c9cb4de50a122d93?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">rajesh</span>
<span class="date">November 7, 2018 at 5:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-453978" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for the reply jason.</p>
<p>LSTM network returned error as “expecting dense 3dimensional shape instead recieved<br/>
(3316,)” when given 1D array.<br/>
Is there any other way that i can feed? Have i done any mistake in reshaping train data?</p>
<div class="reply">
<a aria-label="Reply to rajesh" class="comment-reply-link" href="#comment-453978" onclick='return addComment.moveForm( "comment-453978", "453978", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-453744">
<div class="comment-container" id="li-comment-453744">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fc90367da31cafbd363143c24ce90b3e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fc90367da31cafbd363143c24ce90b3e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">cfdcfd</span>
<span class="date">November 5, 2018 at 8:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-453744" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Really appreciated your explanation!<br/>
Could you explain how  to feed multi-input the LSTM, let’s say:<br/>
you have: data = data.reshape(1, 10, 2)<br/>
data = array([<br/>
	[0.1, 1.0],<br/>
	[0.2, 0.9],<br/>
	[0.3, 0.8],<br/>
	[0.4, 0.7],<br/>
	[0.5, 0.6],<br/>
	[0.6, 0.5],<br/>
	[0.7, 0.4],<br/>
	[0.8, 0.3],<br/>
	[0.9, 0.2],<br/>
	[1.0, 0.1]])</p>
<p>and model.add(LSTM(32, input_shape=(10, 2)))</p>
<p>So in1 iteration of epoch, the value in the first column:  0.1,0.2,….. 1.0 will be fed into xt, xt+1,…, xt+9 of input gate of LSTM. And the 2nd column: 1.0, 0.9…0.1, will they be also fed into xt,xt+1,…,xt+9 or they will fed into another input gate of LSTM: xxt, xxt+1,….,xxt+9 ?</p>
<div class="reply">
<a aria-label="Reply to cfdcfd" class="comment-reply-link" href="#comment-453744" onclick='return addComment.moveForm( "comment-453744", "453744", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-453792">
<div class="comment-container" id="li-comment-453792">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 6, 2018 at 6:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-453792" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not quite, if there is 1 sample, and your batch size is 1 sample, then all time steps in the 1 input sample will be fed into the model for epoch 1.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453792" onclick='return addComment.moveForm( "comment-453792", "453792", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-453819">
<div class="comment-container" id="li-comment-453819">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fc90367da31cafbd363143c24ce90b3e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fc90367da31cafbd363143c24ce90b3e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">cfdcfd</span>
<span class="date">November 6, 2018 at 11:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-453819" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I am still not clear !<br/>
So model.add(LSTM(32, input_shape=(10, 2)))<br/>
what is the number 2 in the input_shape(10,2) mean ?</p>
<div class="reply">
<a aria-label="Reply to cfdcfd" class="comment-reply-link" href="#comment-453819" onclick='return addComment.moveForm( "comment-453819", "453819", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-453836">
<div class="comment-container" id="li-comment-453836">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 6, 2018 at 2:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-453836" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>(10,2) means that each sample will have 10 timesteps with 2 features.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453836" onclick='return addComment.moveForm( "comment-453836", "453836", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-453745">
<div class="comment-container" id="li-comment-453745">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b5ea13f72be3427696b43e4f2b2ef068?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b5ea13f72be3427696b43e4f2b2ef068?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jungbin</span>
<span class="date">November 5, 2018 at 8:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-453745" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason, thanks a lot for your great post.</p>
<p>I had understood the post and made a dataset as follow.</p>
<p>x_train_shape : (35849, 100, 3)<br/>
y_train_shape : (35849, )<br/>
x_validation_shape : (8963, 100, 3)<br/>
y_validation_shape : (8963, )<br/>
x_train_shape : (11204, 100, 3)<br/>
y_train_shape : (11204, )</p>
<p>It is a time series sensor data of three-channel.</p>
<p>And, the actual form of the data is as follow.</p>
<p>(2067, 1976, 1964)<br/>
(2280, 1994, 1952)<br/>
(2309, 1976, 1968)<br/>
.<br/>
.<br/>
.<br/>
(2020, 2160, 1979)<br/>
(1994, 2181, 2064)</p>
<p>I did labeling the data for particular section by [window size : 100, stride : 15] per a channel.</p>
<p>For example, if the particular section is from 251 to 750, 27 pieces of cutted-data are made as follows.</p>
<p>251~350, 266~365, 281~380, …, 641~740</p>
<p>With this data, I was able to proceed learning with DFN and CNN to perform effectively.</p>
<p>However, when I do learning using LSTM, the learning does not proceed that the loss does not decrease and the accuracy is around 50%.</p>
<p>So I would like to hear your opinion about this phenomenon, which has a broad and deep knowledge in this field.</p>
<p>Should I change the data structure differently?</p>
<p>Or, is there a particular LSTM-containing model structure suitable for data like this structure?</p>
<p>Or, do you have another new opinion?</p>
<p>Thank you so much for your interest in my problem.</p>
<div class="reply">
<a aria-label="Reply to Jungbin" class="comment-reply-link" href="#comment-453745" onclick='return addComment.moveForm( "comment-453745", "453745", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-453793">
<div class="comment-container" id="li-comment-453793">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 6, 2018 at 6:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-453793" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>LSTMs are generally poor a time series forecasting. You may need to carefully tune the model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453793" onclick='return addComment.moveForm( "comment-453793", "453793", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-453858">
<div class="comment-container" id="li-comment-453858">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b5ea13f72be3427696b43e4f2b2ef068?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b5ea13f72be3427696b43e4f2b2ef068?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jungbin</span>
<span class="date">November 6, 2018 at 6:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-453858" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for your reply.</p>
<p>Last night, I was contemplating a lot. I was able to figure out why my dataset is not suitable for this model.</p>
<p>This is because a unit of data cannot affect the decision.</p>
<p>So I’m going to find a way to increase the data processing unit on LSTM.</p>
<p>I have been able to think a lot through your material and reply.</p>
<p>Thank you so much again.</p>
<div class="reply">
<a aria-label="Reply to Jungbin" class="comment-reply-link" href="#comment-453858" onclick='return addComment.moveForm( "comment-453858", "453858", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-453908">
<div class="comment-container" id="li-comment-453908">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 7, 2018 at 6:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-453908" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice work.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453908" onclick='return addComment.moveForm( "comment-453908", "453908", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-454174">
<div class="comment-container" id="li-comment-454174">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e83111df8d6a83221a0be53bad03331b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e83111df8d6a83221a0be53bad03331b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Soheila</span>
<span class="date">November 9, 2018 at 4:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-454174" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>I am really confused with Input shape. Assume I have a data set of some info about houses.<br/>
Features are [size, room_no, floor_no]</p>
<p>My data set contains 4 samples as follow:<br/>
dataX  = [[200, 3, 1], [150, 1, 1], [270, 4, 2], [320, 3, 2]]. Which for example dataX[0] is house number0 with size of 200, 3 rooms and 1 floor.</p>
<p>Now I want to train my LSTM. Are (samples, time_step, feature) different from the ones I defined here? I mean I have 4 samples with 3 features! How do you tell that to LSTM? For example would you please say that in the first 2 or 3 time steps what data is fed into LSTM?</p>
<p>Thank you very much. 🙂</p>
<div class="reply">
<a aria-label="Reply to Soheila" class="comment-reply-link" href="#comment-454174" onclick='return addComment.moveForm( "comment-454174", "454174", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-454251">
<div class="comment-container" id="li-comment-454251">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 10, 2018 at 5:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-454251" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Each of size, rooms and floor are “features”. Features=3</p>
<p>If you have 3 houses, these are “samples”. Samples=3</p>
<p>But you did not mention any time steps. If you have no time steps (observations over time), an LSTM is a poor choice and I would recommend an MLP instead.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-454251" onclick='return addComment.moveForm( "comment-454251", "454251", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-455662">
<div class="comment-container" id="li-comment-455662">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0bfbe395d42d91afa702616785a7e4e0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0bfbe395d42d91afa702616785a7e4e0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">nuiii</span>
<span class="date">November 21, 2018 at 1:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-455662" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>First of all, thanks for all your work. It is grateful to have a support like you give us in all your tutorials!</p>
<p>On the other hand, I have a question. For LSTMs we need a 3D array (samples, features, timesteps). But I still don’t understand what “timesteps” means? Is it the same of loop_back variable?</p>
<p>Thanks,</p>
<div class="reply">
<a aria-label="Reply to nuiii" class="comment-reply-link" href="#comment-455662" onclick='return addComment.moveForm( "comment-455662", "455662", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-455695">
<div class="comment-container" id="li-comment-455695">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 21, 2018 at 7:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-455695" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Time steps are observations (features) made over time (e.g. minutes, hours, etc.). Or, they can be items in a sequence like words in a sentence.</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-455695" onclick='return addComment.moveForm( "comment-455695", "455695", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-455860">
<div class="comment-container" id="li-comment-455860">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b21d54103531861ff5f43242d7a56f87?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b21d54103531861ff5f43242d7a56f87?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Joe</span>
<span class="date">November 22, 2018 at 10:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-455860" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Like others, I wanna say thank you for this and other useful articles.</p>
<p>I need to connect output of ConvLSTM2D to a LSTM!<br/>
The output of ConvLSTM2D is (samples, time, output_row, output_col, filters) which return_sequences is True.<br/>
I’m confused here how this 5-D input can be feed to a LSTM!<br/>
I will be thankful if any help!</p>
<div class="reply">
<a aria-label="Reply to Joe" class="comment-reply-link" href="#comment-455860" onclick='return addComment.moveForm( "comment-455860", "455860", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-455892">
<div class="comment-container" id="li-comment-455892">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 23, 2018 at 7:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-455892" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Are you sure the output of the ConvLSTM2D is as you describe?</p>
<p>If so, perhaps you can use a lambda to flatten rows/cols and filters.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-455892" onclick='return addComment.moveForm( "comment-455892", "455892", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-456735">
<div class="comment-container" id="li-comment-456735">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d1c6df78670720e75350d2ef4d429962?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d1c6df78670720e75350d2ef4d429962?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ahmed</span>
<span class="date">November 30, 2018 at 10:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-456735" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>I have a dataframe of n,p rows (n for the different samples and p for q timesteps  and r static feature p = q+r ). For each row, I have q values for the measure of interest and r static features.</p>
<p>Basically, I want to do a time series classification that is based also on the static features.</p>
<p>From what I understood, the input shape should be (n,q,r) but I cannot transform my dataframe from (n,p) to (n,q,r) since p = q+r</p>
<p>Thank you a lot for your help !</p>
<div class="reply">
<a aria-label="Reply to Ahmed" class="comment-reply-link" href="#comment-456735" onclick='return addComment.moveForm( "comment-456735", "456735", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-456763">
<div class="comment-container" id="li-comment-456763">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 1, 2018 at 6:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-456763" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t follow what you mean by p = q+r?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-456763" onclick='return addComment.moveForm( "comment-456763", "456763", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-457818">
<div class="comment-container" id="li-comment-457818">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/194a3cb48b8a86c00163efdb844deddc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/194a3cb48b8a86c00163efdb844deddc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Guido Salimbeni</span>
<span class="date">December 7, 2018 at 10:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-457818" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,<br/>
why do we need to reshape the data in numpy before feeding the data to the lstm. Why Keras doesn’t do it automatically?</p>
<p>if I have a sequence of 10 values and I want to predict the 11th value, I guess Keras LSTM has already all the information in a numpy array of size (1,10) to answer the task of predicting the 11th value . Why do I need to reshape it to (1,10,1) ?</p>
<p>regards<br/>
Guido</p>
<div class="reply">
<a aria-label="Reply to Guido Salimbeni" class="comment-reply-link" href="#comment-457818" onclick='return addComment.moveForm( "comment-457818", "457818", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-457868">
<div class="comment-container" id="li-comment-457868">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 8, 2018 at 7:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/#comment-457868" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Why – that is the expectation of the API. Don’t fight it, meet it.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-457868" onclick='return addComment.moveForm( "comment-457868", "457868", "respond", "4286" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/reshape-input-data-long-short-term-memory-networks-keras/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="4286"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="bed98e96f0"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="57"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery!</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Jason Brownlee, PhD
<br/>
I write tutorials to help developers (<i>like you</i>) get results with machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-29"> <div class="textwidget"><p></p><center><br/>
<strong>Long Short-Term Memory Networks</strong><br/>
Develop sequence prediction models in Keras.
<p><a href="/lstms-with-python/">Click to Get Started Now!</a><br/>
<a href="/lstms-with-python/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/07/Cover-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch"><img alt="How to Develop a Neural Machine Translation System in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/01/How-to-Develop-a-Neural-Machine-Translation-System-in-Keras-150x150.jpg" title="How to Develop a Neural Machine Translation System from Scratch" width="45"/></a> <a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch">How to Develop a Neural Machine Translation System from Scratch</a>
<span class="meta">January 10, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning"><img alt="Difference Between Classification and Regression in Machine Learning" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/Difference-Between-Classification-and-Regression-in-Machine-Learning-150x150.jpg" title="Difference Between Classification and Regression in Machine Learning" width="45"/></a> <a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning">Difference Between Classification and Regression in Machine Learning</a>
<span class="meta">December 11, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem..."><img alt="So, You are Working on a Machine Learning Problem..." class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/So-You-are-Working-on-a-Machine-Learning-Problem...-150x150.jpg" title="So, You are Working on a Machine Learning Problem..." width="45"/></a> <a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem…">So, You are Working on a Machine Learning Problem…</a>
<span class="meta">April 4, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis"><img alt="Plot of the Multichannel Convolutional Neural Network For Text" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-150x150.png" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis" width="45"/></a> <a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis">How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis</a>
<span class="meta">January 12, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras"><img alt="How to Make Classification and Regression Predictions for Deep Learning Models in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/How-to-Make-Classification-and-Regression-Predictions-for-Deep-Learning-Models-in-Keras-150x150.jpg" title="How to Make Predictions with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras">How to Make Predictions with Keras</a>
<span class="meta">April 9, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)"><img alt="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/11-Classical-Time-Series-Forecasting-Methods-in-Python-Cheat-Sheet-150x150.jpg" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)">11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)</a>
<span class="meta">August 6, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras"><img alt="How to Visualize a Deep Learning Neural Network Model in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/How-to-Visualize-a-Deep-Learning-Neural-Network-Model-in-Keras-150x150.jpg" title="How to Visualize a Deep Learning Neural Network Model in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras">How to Visualize a Deep Learning Neural Network Model in Keras</a>
<span class="meta">December 13, 2017</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> <div class="widget_text widget widget_custom_html" id="custom_html-2"><h3>You might also like…</h3><div class="textwidget custom-html-widget"><ul>
<li><a href="/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Install Python for Machine Learning</a></li>
<li><a href="/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python</a></li>
<li><a href="/tutorial-first-neural-network-python-keras/">Your First Neural Network in Python</a></li>
<li><a href="/how-to-run-your-first-classifier-in-weka/">Your First Classifier in Weka</a></li>
<li><a href="/arima-for-time-series-forecasting-with-python/">Your First Time Series Forecasting Project</a></li>
</ul></div></div></aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/disclaimer/">Disclaimer</a> | 
<a href="/terms-of-service/">Terms</a> | 
<a href="/contact/">Contact</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.8" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.0.5" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.8" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.1" type="text/javascript"></script>
</body>
</html>