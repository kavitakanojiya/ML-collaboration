<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v9.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>How to Convert a Time Series to a Supervised Learning Problem in Python</title>
<link href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="How to Convert a Time Series to a Supervised Learning Problem in Python" property="og:title"/>
<meta content="Machine learning methods like deep learning can be used for time series forecasting. Before machine learning can be used, time series forecasting problems must be re-framed as supervised learning problems. From a sequence to pairs of input and output sequences. In this tutorial, you will discover how to transform univariate and multivariate time series forecasting …" property="og:description"/>
<meta content="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="https://www.facebook.com/jason.brownlee.39" property="article:author"/>
<meta content="Time Series" property="article:section"/>
<meta content="2017-05-07T19:00:31+00:00" property="article:published_time"/>
<meta content="2017-03-30T03:28:10+00:00" property="article:modified_time"/>
<meta content="2017-03-30T03:28:10+00:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/05/How-to-Convert-a-Time-Series-to-a-Supervised-Learning-Problem-in-Python.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/05/How-to-Convert-a-Time-Series-to-a-Supervised-Learning-Problem-in-Python.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="361" property="og:image:height"/>
<meta content="How to Convert a Time Series to a Supervised Learning Problem in Python" property="og:image:alt"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"https:\/\/machinelearningmastery.com\/#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/feed/" rel="alternate" title="Machine Learning Mastery » How to Convert a Time Series to a Supervised Learning Problem in Python Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<style media="all" type="text/css">
.wpautoterms-footer{background-color:#ffffff;text-align:center;}
.wpautoterms-footer a{color:#000000;font-family:Arial, sans-serif;font-size:14px;}
.wpautoterms-footer .separator{color:#cccccc;font-family:Arial, sans-serif;font-size:14px;}</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/auto-terms-of-service-and-privacy-policy/css/wpautoterms.css?ver=4.9.8" id="wpautoterms_css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.0.5" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/css/front.css?ver=2.0.20" id="ssb-front-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/ewd-ufaq-styles.css?ver=4.9.8" id="ewd-ufaq-style-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/rrssb-min.css?ver=4.9.8" id="ewd-ufaq-rrssb-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.8" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=2.0.20" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.8" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.8" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=3984" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fconvert-time-series-supervised-learning-problem-python%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fconvert-time-series-supervised-learning-problem-python%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<style media="screen">

        .simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
      margin: ;
    }
         /*inline margin*/
    
  
  
  
  
  
          .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
         margin: ;
     }

          /*margin-digbar*/

  
  
  
  
 
   
   

</style>
<script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#4c89bf; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#4c89bf;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#4c89bf!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#ffffff;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-3984 single-format-standard unknown alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/icon-100x100.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-55"> <div class="textwidget"><p>Want help with time series? <a href="https://machinelearningmastery.lpages.co/tsfwp-mini-course/">Take the FREE Mini-Course</a></p>
</div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<input name="post_type" type="hidden" value="post"/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Main Menu</h3><ul class="nav fl" id="main-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503" id="menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Start Here</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501" id="menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506" id="menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508" id="menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (Keras)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511" id="menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509" id="menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515" id="menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">Deep Learning for NLP</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512" id="menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Understand Algorithms</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507" id="menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms (Python)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6513" id="menu-item-6513"><a href="https://machinelearningmastery.com/category/machine-learning-process/">Machine Learning Process</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516" id="menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517" id="menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522" id="menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6518" id="menu-item-6518"><a href="https://machinelearningmastery.com/category/start-machine-learning/">Getting Started</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510" id="menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519" id="menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistical Methods</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6520" id="menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Time Series (introductory)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523" id="menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6514" id="menu-item-6514"><a href="https://machinelearningmastery.com/category/machine-learning-resources/">Resources</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502" id="menu-item-6502"><a href="https://machinelearningmastery.com/products/">Ebooks</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500" id="menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504" id="menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505" id="menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-3984 post type-post status-publish format-standard has-post-thumbnail hentry category-time-series">
<header>
<h1 class="title entry-title">How to Convert a Time Series to a Supervised Learning Problem in Python</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2017-05-08T05:00:31+1100">May 8, 2017</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/time-series/" title="View all items in Time Series">Time Series</a></span> </div>
<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-3984 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Convert+a+Time+Series+to+a+Supervised+Learning+Problem+in+Python&amp;url=https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
<p>Machine learning methods like deep learning can be used for time series forecasting.</p>
<p>Before machine learning can be used, time series forecasting problems must be re-framed as supervised learning problems. From a sequence to pairs of input and output sequences.</p>
<p>In this tutorial, you will discover how to transform univariate and multivariate time series forecasting problems into supervised learning problems for use with machine learning algorithms.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>How to develop a function to transform a time series dataset into a supervised learning dataset.</li>
<li>How to transform univariate time series data for machine learning.</li>
<li>How to transform multivariate time series data for machine learning.</li>
</ul>
<p>Let’s get started.</p>
<div class="wp-caption aligncenter" id="attachment_3985" style="width: 650px"><img alt="How to Convert a Time Series to a Supervised Learning Problem in Python" class="size-full wp-image-3985" height="361" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/05/How-to-Convert-a-Time-Series-to-a-Supervised-Learning-Problem-in-Python.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/05/How-to-Convert-a-Time-Series-to-a-Supervised-Learning-Problem-in-Python.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/05/How-to-Convert-a-Time-Series-to-a-Supervised-Learning-Problem-in-Python-300x169.jpg 300w" width="640"/><p class="wp-caption-text">How to Convert a Time Series to a Supervised Learning Problem in Python<br/>Photo by <a href="https://www.flickr.com/photos/quimgil/8490510169/">Quim Gil</a>, some rights reserved.</p></div>
<h2>Time Series vs Supervised Learning</h2>
<p>Before we get started, let’s take a moment to better understand the form of time series and supervised learning data.</p>
<p>A time series is a sequence of numbers that are ordered by a time index. This can be thought of as a list or column of ordered values.</p>
<p>For example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6392dc30818703799" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
0
1
2
3
4
5
6
7
8
9</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6392dc30818703799-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc30818703799-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6392dc30818703799-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc30818703799-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6392dc30818703799-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc30818703799-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6392dc30818703799-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc30818703799-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6392dc30818703799-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc30818703799-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6392dc30818703799-1">0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc30818703799-2">1</div><div class="crayon-line" id="crayon-5c0ca6392dc30818703799-3">2</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc30818703799-4">3</div><div class="crayon-line" id="crayon-5c0ca6392dc30818703799-5">4</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc30818703799-6">5</div><div class="crayon-line" id="crayon-5c0ca6392dc30818703799-7">6</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc30818703799-8">7</div><div class="crayon-line" id="crayon-5c0ca6392dc30818703799-9">8</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc30818703799-10">9</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>A supervised learning problem is comprised of input patterns (<em>X</em>) and output patterns (<em>y</em>), such that an algorithm can learn how to predict the output patterns from the input patterns.</p>
<p>For example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6392dc39180522838" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
X,	y
1	2
2,	3
3,	4
4,	5
5,	6
6,	7
7,	8
8,	9</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6392dc39180522838-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc39180522838-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6392dc39180522838-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc39180522838-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6392dc39180522838-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc39180522838-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6392dc39180522838-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc39180522838-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6392dc39180522838-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6392dc39180522838-1">X,	y</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc39180522838-2">1	2</div><div class="crayon-line" id="crayon-5c0ca6392dc39180522838-3">2,	3</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc39180522838-4">3,	4</div><div class="crayon-line" id="crayon-5c0ca6392dc39180522838-5">4,	5</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc39180522838-6">5,	6</div><div class="crayon-line" id="crayon-5c0ca6392dc39180522838-7">6,	7</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc39180522838-8">7,	8</div><div class="crayon-line" id="crayon-5c0ca6392dc39180522838-9">8,	9</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>For more on this topic, see the post:</p>
<ul>
<li><a href="http://machinelearningmastery.com/time-series-forecasting-supervised-learning/">Time Series Forecasting as Supervised Learning</a></li>
</ul>
<h2>Pandas shift() Function</h2>
<p>A key function to help transform time series data into a supervised learning problem is the Pandas <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.shift.html">shift()</a> function.</p>
<p>Given a DataFrame, the <em>shift()</em> function can be used to create copies of columns that are pushed forward (rows of NaN values added to the front) or pulled back (rows of NaN values added to the end).</p>
<p>This is the behavior required to create columns of lag observations as well as columns of forecast observations for a time series dataset in a supervised learning format.</p>
<p>Let’s look at some examples of the shift function in action.</p>
<p>We can define a mock time series dataset as a sequence of 10 numbers, in this case a single column in a DataFrame as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6392dc3c230618874" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import DataFrame
df = DataFrame()
df['t'] = [x for x in range(10)]
print(df)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6392dc3c230618874-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc3c230618874-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6392dc3c230618874-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc3c230618874-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6392dc3c230618874-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc3c230618874-2"><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc3c230618874-3"><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-s">'t'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc3c230618874-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>Running the example prints the time series data with the row indices for each observation.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6392dc3d526212851" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
   t
0  0
1  1
2  2
3  3
4  4
5  5
6  6
7  7
8  8
9  9</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6392dc3d526212851-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc3d526212851-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6392dc3d526212851-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc3d526212851-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6392dc3d526212851-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc3d526212851-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6392dc3d526212851-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc3d526212851-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6392dc3d526212851-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc3d526212851-10">10</div><div class="crayon-num" data-line="crayon-5c0ca6392dc3d526212851-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6392dc3d526212851-1">   t</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc3d526212851-2">0  0</div><div class="crayon-line" id="crayon-5c0ca6392dc3d526212851-3">1  1</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc3d526212851-4">2  2</div><div class="crayon-line" id="crayon-5c0ca6392dc3d526212851-5">3  3</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc3d526212851-6">4  4</div><div class="crayon-line" id="crayon-5c0ca6392dc3d526212851-7">5  5</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc3d526212851-8">6  6</div><div class="crayon-line" id="crayon-5c0ca6392dc3d526212851-9">7  7</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc3d526212851-10">8  8</div><div class="crayon-line" id="crayon-5c0ca6392dc3d526212851-11">9  9</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can shift all the observations down by one time step by inserting one new row at the top. Because the new row has no data, we can use NaN to represent “no data”.</p>
<p>The shift function can do this for us and we can insert this shifted column next to our original series.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6392dc3f819530802" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import DataFrame
df = DataFrame()
df['t'] = [x for x in range(10)]
df['t-1'] = df['t'].shift(1)
print(df)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6392dc3f819530802-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc3f819530802-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6392dc3f819530802-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc3f819530802-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6392dc3f819530802-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6392dc3f819530802-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc3f819530802-2"><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc3f819530802-3"><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-s">'t'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc3f819530802-4"><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-s">'t-1'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-s">'t'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc3f819530802-5"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>Running the example gives us two columns in the dataset. The first with the original observations and a new shifted column.</p>
<p>We can see that shifting the series forward one time step gives us a primitive supervised learning problem, although with <em>X</em> and <em>y</em> in the wrong order. Ignore the column of row labels. The first row would have to be discarded because of the NaN value. The second row shows the input value of 0.0 in the second column (input or <em>X</em>) and the value of 1 in the first column (output or <em>y</em>).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6392dc41312400927" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
   t  t-1
0  0  NaN
1  1  0.0
2  2  1.0
3  3  2.0
4  4  3.0
5  5  4.0
6  6  5.0
7  7  6.0
8  8  7.0
9  9  8.0</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6392dc41312400927-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc41312400927-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6392dc41312400927-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc41312400927-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6392dc41312400927-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc41312400927-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6392dc41312400927-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc41312400927-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6392dc41312400927-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc41312400927-10">10</div><div class="crayon-num" data-line="crayon-5c0ca6392dc41312400927-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6392dc41312400927-1">   t  t-1</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc41312400927-2">0  0  NaN</div><div class="crayon-line" id="crayon-5c0ca6392dc41312400927-3">1  1  0.0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc41312400927-4">2  2  1.0</div><div class="crayon-line" id="crayon-5c0ca6392dc41312400927-5">3  3  2.0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc41312400927-6">4  4  3.0</div><div class="crayon-line" id="crayon-5c0ca6392dc41312400927-7">5  5  4.0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc41312400927-8">6  6  5.0</div><div class="crayon-line" id="crayon-5c0ca6392dc41312400927-9">7  7  6.0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc41312400927-10">8  8  7.0</div><div class="crayon-line" id="crayon-5c0ca6392dc41312400927-11">9  9  8.0</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can see that if we can repeat this process with shifts of 2, 3, and more, how we could create long input sequences (<em>X</em>) that can be used to forecast an output value (<em>y</em>).</p>
<p>The shift operator can also accept a negative integer value. This has the effect of pulling the observations up by inserting new rows at the end. Below is an example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6392dc43325579589" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import DataFrame
df = DataFrame()
df['t'] = [x for x in range(10)]
df['t+1'] = df['t'].shift(-1)
print(df)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6392dc43325579589-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc43325579589-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6392dc43325579589-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc43325579589-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6392dc43325579589-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6392dc43325579589-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc43325579589-2"><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc43325579589-3"><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-s">'t'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc43325579589-4"><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-s">'t+1'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-s">'t'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc43325579589-5"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>Running the example shows a new column with a NaN value as the last value.</p>
<p>We can see that the forecast column can be taken as an input (<em>X</em>) and the second as an output value (<em>y</em>). That is the input value of 0 can be used to forecast the output value of 1.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6392dc44843113771" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
   t  t+1
0  0  1.0
1  1  2.0
2  2  3.0
3  3  4.0
4  4  5.0
5  5  6.0
6  6  7.0
7  7  8.0
8  8  9.0
9  9  NaN</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6392dc44843113771-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc44843113771-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6392dc44843113771-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc44843113771-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6392dc44843113771-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc44843113771-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6392dc44843113771-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc44843113771-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6392dc44843113771-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc44843113771-10">10</div><div class="crayon-num" data-line="crayon-5c0ca6392dc44843113771-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6392dc44843113771-1">   t  t+1</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc44843113771-2">0  0  1.0</div><div class="crayon-line" id="crayon-5c0ca6392dc44843113771-3">1  1  2.0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc44843113771-4">2  2  3.0</div><div class="crayon-line" id="crayon-5c0ca6392dc44843113771-5">3  3  4.0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc44843113771-6">4  4  5.0</div><div class="crayon-line" id="crayon-5c0ca6392dc44843113771-7">5  5  6.0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc44843113771-8">6  6  7.0</div><div class="crayon-line" id="crayon-5c0ca6392dc44843113771-9">7  7  8.0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc44843113771-10">8  8  9.0</div><div class="crayon-line" id="crayon-5c0ca6392dc44843113771-11">9  9  NaN</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Technically, in time series forecasting terminology the current time (<em>t</em>) and future times (<em>t+1</em>, <em>t+n</em>) are forecast times and past observations (<em>t-1</em>, <em>t-n</em>) are used to make forecasts.</p>
<p>We can see how positive and negative shifts can be used to create a new DataFrame from a time series with sequences of input and output patterns for a supervised learning problem.</p>
<p>This permits not only classical <em>X -&gt; y</em> prediction, but also <em>X -&gt; Y</em> where both input and output can be sequences.</p>
<p>Further, the shift function also works on so-called multivariate time series problems. That is where instead of having one set of observations for a time series, we have multiple (e.g. temperature and pressure). All variates in the time series can be shifted forward or backward to create multivariate input and output sequences. We will explore this more later in the tutorial.</p>
<h2>The series_to_supervised() Function</h2>
<p>We can use the <em>shift()</em> function in Pandas to automatically create new framings of time series problems given the desired length of input and output sequences.</p>
<p>This would be a useful tool as it would allow us to explore different framings of a time series problem with machine learning algorithms to see which might result in better performing models.</p>
<p>In this section, we will define a new Python function named <em>series_to_supervised()</em> that takes a univariate or multivariate time series and frames it as a supervised learning dataset.</p>
<p>The function takes four arguments:</p>
<ul>
<li><strong>data</strong>: Sequence of observations as a list or 2D NumPy array. Required.</li>
<li><strong>n_in</strong>: Number of lag observations as input (<em>X</em>). Values may be between [1..len(data)] Optional. Defaults to 1.</li>
<li><strong>n_out</strong>: Number of observations as output (<em>y</em>). Values may be between [0..len(data)-1]. Optional. Defaults to 1.</li>
<li><strong>dropnan</strong>: Boolean whether or not to drop rows with NaN values. Optional. Defaults to True.</li>
</ul>
<p>The function returns a single value:</p>
<ul>
<li><strong>return</strong>: Pandas DataFrame of series framed for supervised learning.</li>
</ul>
<p>The new dataset is constructed as a DataFrame, with each column suitably named both by variable number and time step. This allows you to design a variety of different time step sequence type forecasting problems from a given univariate or multivariate time series.</p>
<p>Once the DataFrame is returned, you can decide how to split the rows of the returned DataFrame into <em>X</em> and <em>y</em> components for supervised learning any way you wish.</p>
<p>The function is defined with default parameters so that if you call it with just your data, it will construct a DataFrame with <em>t-1</em> as <em>X</em> and <em>t</em> as <em>y</em>.</p>
<p>The function is confirmed to be compatible with Python 2 and Python 3.</p>
<p>The complete function is listed below, including function comments.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6392dc46975845356" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import DataFrame
from pandas import concat

def series_to_supervised(data, n_in=1, n_out=1, dropnan=True):
	"""
	Frame a time series as a supervised learning dataset.
	Arguments:
		data: Sequence of observations as a list or NumPy array.
		n_in: Number of lag observations as input (X).
		n_out: Number of observations as output (y).
		dropnan: Boolean whether or not to drop rows with NaN values.
	Returns:
		Pandas DataFrame of series framed for supervised learning.
	"""
	n_vars = 1 if type(data) is list else data.shape[1]
	df = DataFrame(data)
	cols, names = list(), list()
	# input sequence (t-n, ... t-1)
	for i in range(n_in, 0, -1):
		cols.append(df.shift(i))
		names += [('var%d(t-%d)' % (j+1, i)) for j in range(n_vars)]
	# forecast sequence (t, t+1, ... t+n)
	for i in range(0, n_out):
		cols.append(df.shift(-i))
		if i == 0:
			names += [('var%d(t)' % (j+1)) for j in range(n_vars)]
		else:
			names += [('var%d(t+%d)' % (j+1, i)) for j in range(n_vars)]
	# put it all together
	agg = concat(cols, axis=1)
	agg.columns = names
	# drop rows with NaN values
	if dropnan:
		agg.dropna(inplace=True)
	return agg</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6392dc46975845356-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc46975845356-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6392dc46975845356-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc46975845356-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6392dc46975845356-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc46975845356-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6392dc46975845356-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc46975845356-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6392dc46975845356-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc46975845356-10">10</div><div class="crayon-num" data-line="crayon-5c0ca6392dc46975845356-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc46975845356-12">12</div><div class="crayon-num" data-line="crayon-5c0ca6392dc46975845356-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc46975845356-14">14</div><div class="crayon-num" data-line="crayon-5c0ca6392dc46975845356-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc46975845356-16">16</div><div class="crayon-num" data-line="crayon-5c0ca6392dc46975845356-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc46975845356-18">18</div><div class="crayon-num" data-line="crayon-5c0ca6392dc46975845356-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc46975845356-20">20</div><div class="crayon-num" data-line="crayon-5c0ca6392dc46975845356-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc46975845356-22">22</div><div class="crayon-num" data-line="crayon-5c0ca6392dc46975845356-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc46975845356-24">24</div><div class="crayon-num" data-line="crayon-5c0ca6392dc46975845356-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc46975845356-26">26</div><div class="crayon-num" data-line="crayon-5c0ca6392dc46975845356-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc46975845356-28">28</div><div class="crayon-num" data-line="crayon-5c0ca6392dc46975845356-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc46975845356-30">30</div><div class="crayon-num" data-line="crayon-5c0ca6392dc46975845356-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc46975845356-32">32</div><div class="crayon-num" data-line="crayon-5c0ca6392dc46975845356-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc46975845356-34">34</div><div class="crayon-num" data-line="crayon-5c0ca6392dc46975845356-35">35</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6392dc46975845356-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc46975845356-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">concat</span></div><div class="crayon-line" id="crayon-5c0ca6392dc46975845356-3"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc46975845356-4"><span class="crayon-e">def </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_in</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca6392dc46975845356-5"><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-s">"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc46975845356-6"><span class="crayon-s">	Frame a time series as a supervised learning dataset.</span></div><div class="crayon-line" id="crayon-5c0ca6392dc46975845356-7"><span class="crayon-s">	Arguments:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc46975845356-8"><span class="crayon-s">		data: Sequence of observations as a list or NumPy array.</span></div><div class="crayon-line" id="crayon-5c0ca6392dc46975845356-9"><span class="crayon-s">		n_in: Number of lag observations as input (X).</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc46975845356-10"><span class="crayon-s">		n_out: Number of observations as output (y).</span></div><div class="crayon-line" id="crayon-5c0ca6392dc46975845356-11"><span class="crayon-s">		dropnan: Boolean whether or not to drop rows with NaN values.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc46975845356-12"><span class="crayon-s">	Returns:</span></div><div class="crayon-line" id="crayon-5c0ca6392dc46975845356-13"><span class="crayon-s">		Pandas DataFrame of series framed for supervised learning.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc46975845356-14"><span class="crayon-s">	"</span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5c0ca6392dc46975845356-15"><span class="crayon-h"> </span><span class="crayon-v">n_vars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">type</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">list </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc46975845356-16"><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc46975845356-17"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc46975845356-18"><span class="crayon-h"> </span><span class="crayon-p"># input sequence (t-n, ... t-1)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc46975845356-19"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc46975845356-20"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc46975845356-21"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t-%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc46975845356-22"><span class="crayon-h"> </span><span class="crayon-p"># forecast sequence (t, t+1, ... t+n)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc46975845356-23"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc46975845356-24"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc46975845356-25"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc46975845356-26"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca6392dc46975845356-27"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc46975845356-28"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t+%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca6392dc46975845356-29"><span class="crayon-h"> </span><span class="crayon-p"># put it all together</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc46975845356-30"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc46975845356-31"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc46975845356-32"><span class="crayon-h"> </span><span class="crayon-p"># drop rows with NaN values</span></div><div class="crayon-line" id="crayon-5c0ca6392dc46975845356-33"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc46975845356-34"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-e">dropna</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc46975845356-35"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">agg</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0018 seconds] -->
<p>Can you see obvious ways to make the function more robust or more readable?<br/>
Please let me know in the comments below.</p>
<p>Now that we have the whole function, we can explore how it may be used.</p>
<h2>One-Step Univariate Forecasting</h2>
<p>It is standard practice in time series forecasting to use lagged observations (e.g. t-1) as input variables to forecast the current time step (t).</p>
<p>This is called one-step forecasting.</p>
<p>The example below demonstrates a one lag time step (t-1) to predict the current time step (t).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6392dc48419364697" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import DataFrame
from pandas import concat

def series_to_supervised(data, n_in=1, n_out=1, dropnan=True):
	"""
	Frame a time series as a supervised learning dataset.
	Arguments:
		data: Sequence of observations as a list or NumPy array.
		n_in: Number of lag observations as input (X).
		n_out: Number of observations as output (y).
		dropnan: Boolean whether or not to drop rows with NaN values.
	Returns:
		Pandas DataFrame of series framed for supervised learning.
	"""
	n_vars = 1 if type(data) is list else data.shape[1]
	df = DataFrame(data)
	cols, names = list(), list()
	# input sequence (t-n, ... t-1)
	for i in range(n_in, 0, -1):
		cols.append(df.shift(i))
		names += [('var%d(t-%d)' % (j+1, i)) for j in range(n_vars)]
	# forecast sequence (t, t+1, ... t+n)
	for i in range(0, n_out):
		cols.append(df.shift(-i))
		if i == 0:
			names += [('var%d(t)' % (j+1)) for j in range(n_vars)]
		else:
			names += [('var%d(t+%d)' % (j+1, i)) for j in range(n_vars)]
	# put it all together
	agg = concat(cols, axis=1)
	agg.columns = names
	# drop rows with NaN values
	if dropnan:
		agg.dropna(inplace=True)
	return agg


values = [x for x in range(10)]
data = series_to_supervised(values)
print(data)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6392dc48419364697-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc48419364697-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6392dc48419364697-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc48419364697-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6392dc48419364697-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc48419364697-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6392dc48419364697-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc48419364697-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6392dc48419364697-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc48419364697-10">10</div><div class="crayon-num" data-line="crayon-5c0ca6392dc48419364697-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc48419364697-12">12</div><div class="crayon-num" data-line="crayon-5c0ca6392dc48419364697-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc48419364697-14">14</div><div class="crayon-num" data-line="crayon-5c0ca6392dc48419364697-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc48419364697-16">16</div><div class="crayon-num" data-line="crayon-5c0ca6392dc48419364697-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc48419364697-18">18</div><div class="crayon-num" data-line="crayon-5c0ca6392dc48419364697-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc48419364697-20">20</div><div class="crayon-num" data-line="crayon-5c0ca6392dc48419364697-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc48419364697-22">22</div><div class="crayon-num" data-line="crayon-5c0ca6392dc48419364697-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc48419364697-24">24</div><div class="crayon-num" data-line="crayon-5c0ca6392dc48419364697-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc48419364697-26">26</div><div class="crayon-num" data-line="crayon-5c0ca6392dc48419364697-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc48419364697-28">28</div><div class="crayon-num" data-line="crayon-5c0ca6392dc48419364697-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc48419364697-30">30</div><div class="crayon-num" data-line="crayon-5c0ca6392dc48419364697-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc48419364697-32">32</div><div class="crayon-num" data-line="crayon-5c0ca6392dc48419364697-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc48419364697-34">34</div><div class="crayon-num" data-line="crayon-5c0ca6392dc48419364697-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc48419364697-36">36</div><div class="crayon-num" data-line="crayon-5c0ca6392dc48419364697-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc48419364697-38">38</div><div class="crayon-num" data-line="crayon-5c0ca6392dc48419364697-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc48419364697-40">40</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6392dc48419364697-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc48419364697-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">concat</span></div><div class="crayon-line" id="crayon-5c0ca6392dc48419364697-3"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc48419364697-4"><span class="crayon-e">def </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_in</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca6392dc48419364697-5"><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-s">"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc48419364697-6"><span class="crayon-s">	Frame a time series as a supervised learning dataset.</span></div><div class="crayon-line" id="crayon-5c0ca6392dc48419364697-7"><span class="crayon-s">	Arguments:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc48419364697-8"><span class="crayon-s">		data: Sequence of observations as a list or NumPy array.</span></div><div class="crayon-line" id="crayon-5c0ca6392dc48419364697-9"><span class="crayon-s">		n_in: Number of lag observations as input (X).</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc48419364697-10"><span class="crayon-s">		n_out: Number of observations as output (y).</span></div><div class="crayon-line" id="crayon-5c0ca6392dc48419364697-11"><span class="crayon-s">		dropnan: Boolean whether or not to drop rows with NaN values.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc48419364697-12"><span class="crayon-s">	Returns:</span></div><div class="crayon-line" id="crayon-5c0ca6392dc48419364697-13"><span class="crayon-s">		Pandas DataFrame of series framed for supervised learning.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc48419364697-14"><span class="crayon-s">	"</span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5c0ca6392dc48419364697-15"><span class="crayon-h"> </span><span class="crayon-v">n_vars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">type</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">list </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc48419364697-16"><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc48419364697-17"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc48419364697-18"><span class="crayon-h"> </span><span class="crayon-p"># input sequence (t-n, ... t-1)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc48419364697-19"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc48419364697-20"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc48419364697-21"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t-%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc48419364697-22"><span class="crayon-h"> </span><span class="crayon-p"># forecast sequence (t, t+1, ... t+n)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc48419364697-23"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc48419364697-24"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc48419364697-25"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc48419364697-26"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca6392dc48419364697-27"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc48419364697-28"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t+%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca6392dc48419364697-29"><span class="crayon-h"> </span><span class="crayon-p"># put it all together</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc48419364697-30"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc48419364697-31"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc48419364697-32"><span class="crayon-h"> </span><span class="crayon-p"># drop rows with NaN values</span></div><div class="crayon-line" id="crayon-5c0ca6392dc48419364697-33"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc48419364697-34"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-e">dropna</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc48419364697-35"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">agg</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc48419364697-36"> </div><div class="crayon-line" id="crayon-5c0ca6392dc48419364697-37"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc48419364697-38"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca6392dc48419364697-39"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc48419364697-40"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0020 seconds] -->
<p>Running the example prints the output of the reframed time series.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6392dc4d506783354" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
   var1(t-1)  var1(t)
1        0.0        1
2        1.0        2
3        2.0        3
4        3.0        4
5        4.0        5
6        5.0        6
7        6.0        7
8        7.0        8
9        8.0        9</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6392dc4d506783354-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc4d506783354-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6392dc4d506783354-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc4d506783354-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6392dc4d506783354-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc4d506783354-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6392dc4d506783354-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc4d506783354-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6392dc4d506783354-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc4d506783354-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6392dc4d506783354-1">   var1(t-1)  var1(t)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc4d506783354-2">1        0.0        1</div><div class="crayon-line" id="crayon-5c0ca6392dc4d506783354-3">2        1.0        2</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc4d506783354-4">3        2.0        3</div><div class="crayon-line" id="crayon-5c0ca6392dc4d506783354-5">4        3.0        4</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc4d506783354-6">5        4.0        5</div><div class="crayon-line" id="crayon-5c0ca6392dc4d506783354-7">6        5.0        6</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc4d506783354-8">7        6.0        7</div><div class="crayon-line" id="crayon-5c0ca6392dc4d506783354-9">8        7.0        8</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc4d506783354-10">9        8.0        9</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can see that the observations are named “<em>var1</em>” and that the input observation is suitably named (t-1) and the output time step is named (t).</p>
<p>We can also see that rows with NaN values have been automatically removed from the DataFrame.</p>
<p>We can repeat this example with an arbitrary number length input sequence, such as 3. This can be done by specifying the length of the input sequence as an argument; for example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6392dc4e148465106" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
data = series_to_supervised(values, 3)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6392dc4e148465106-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6392dc4e148465106-1"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6392dc50160570834" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import DataFrame
from pandas import concat

def series_to_supervised(data, n_in=1, n_out=1, dropnan=True):
	"""
	Frame a time series as a supervised learning dataset.
	Arguments:
		data: Sequence of observations as a list or NumPy array.
		n_in: Number of lag observations as input (X).
		n_out: Number of observations as output (y).
		dropnan: Boolean whether or not to drop rows with NaN values.
	Returns:
		Pandas DataFrame of series framed for supervised learning.
	"""
	n_vars = 1 if type(data) is list else data.shape[1]
	df = DataFrame(data)
	cols, names = list(), list()
	# input sequence (t-n, ... t-1)
	for i in range(n_in, 0, -1):
		cols.append(df.shift(i))
		names += [('var%d(t-%d)' % (j+1, i)) for j in range(n_vars)]
	# forecast sequence (t, t+1, ... t+n)
	for i in range(0, n_out):
		cols.append(df.shift(-i))
		if i == 0:
			names += [('var%d(t)' % (j+1)) for j in range(n_vars)]
		else:
			names += [('var%d(t+%d)' % (j+1, i)) for j in range(n_vars)]
	# put it all together
	agg = concat(cols, axis=1)
	agg.columns = names
	# drop rows with NaN values
	if dropnan:
		agg.dropna(inplace=True)
	return agg


values = [x for x in range(10)]
data = series_to_supervised(values, 3)
print(data)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6392dc50160570834-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc50160570834-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6392dc50160570834-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc50160570834-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6392dc50160570834-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc50160570834-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6392dc50160570834-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc50160570834-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6392dc50160570834-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc50160570834-10">10</div><div class="crayon-num" data-line="crayon-5c0ca6392dc50160570834-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc50160570834-12">12</div><div class="crayon-num" data-line="crayon-5c0ca6392dc50160570834-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc50160570834-14">14</div><div class="crayon-num" data-line="crayon-5c0ca6392dc50160570834-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc50160570834-16">16</div><div class="crayon-num" data-line="crayon-5c0ca6392dc50160570834-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc50160570834-18">18</div><div class="crayon-num" data-line="crayon-5c0ca6392dc50160570834-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc50160570834-20">20</div><div class="crayon-num" data-line="crayon-5c0ca6392dc50160570834-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc50160570834-22">22</div><div class="crayon-num" data-line="crayon-5c0ca6392dc50160570834-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc50160570834-24">24</div><div class="crayon-num" data-line="crayon-5c0ca6392dc50160570834-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc50160570834-26">26</div><div class="crayon-num" data-line="crayon-5c0ca6392dc50160570834-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc50160570834-28">28</div><div class="crayon-num" data-line="crayon-5c0ca6392dc50160570834-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc50160570834-30">30</div><div class="crayon-num" data-line="crayon-5c0ca6392dc50160570834-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc50160570834-32">32</div><div class="crayon-num" data-line="crayon-5c0ca6392dc50160570834-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc50160570834-34">34</div><div class="crayon-num" data-line="crayon-5c0ca6392dc50160570834-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc50160570834-36">36</div><div class="crayon-num" data-line="crayon-5c0ca6392dc50160570834-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc50160570834-38">38</div><div class="crayon-num" data-line="crayon-5c0ca6392dc50160570834-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc50160570834-40">40</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6392dc50160570834-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc50160570834-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">concat</span></div><div class="crayon-line" id="crayon-5c0ca6392dc50160570834-3"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc50160570834-4"><span class="crayon-e">def </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_in</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca6392dc50160570834-5"><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-s">"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc50160570834-6"><span class="crayon-s">	Frame a time series as a supervised learning dataset.</span></div><div class="crayon-line" id="crayon-5c0ca6392dc50160570834-7"><span class="crayon-s">	Arguments:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc50160570834-8"><span class="crayon-s">		data: Sequence of observations as a list or NumPy array.</span></div><div class="crayon-line" id="crayon-5c0ca6392dc50160570834-9"><span class="crayon-s">		n_in: Number of lag observations as input (X).</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc50160570834-10"><span class="crayon-s">		n_out: Number of observations as output (y).</span></div><div class="crayon-line" id="crayon-5c0ca6392dc50160570834-11"><span class="crayon-s">		dropnan: Boolean whether or not to drop rows with NaN values.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc50160570834-12"><span class="crayon-s">	Returns:</span></div><div class="crayon-line" id="crayon-5c0ca6392dc50160570834-13"><span class="crayon-s">		Pandas DataFrame of series framed for supervised learning.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc50160570834-14"><span class="crayon-s">	"</span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5c0ca6392dc50160570834-15"><span class="crayon-h"> </span><span class="crayon-v">n_vars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">type</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">list </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc50160570834-16"><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc50160570834-17"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc50160570834-18"><span class="crayon-h"> </span><span class="crayon-p"># input sequence (t-n, ... t-1)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc50160570834-19"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc50160570834-20"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc50160570834-21"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t-%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc50160570834-22"><span class="crayon-h"> </span><span class="crayon-p"># forecast sequence (t, t+1, ... t+n)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc50160570834-23"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc50160570834-24"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc50160570834-25"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc50160570834-26"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca6392dc50160570834-27"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc50160570834-28"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t+%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca6392dc50160570834-29"><span class="crayon-h"> </span><span class="crayon-p"># put it all together</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc50160570834-30"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc50160570834-31"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc50160570834-32"><span class="crayon-h"> </span><span class="crayon-p"># drop rows with NaN values</span></div><div class="crayon-line" id="crayon-5c0ca6392dc50160570834-33"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc50160570834-34"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-e">dropna</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc50160570834-35"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">agg</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc50160570834-36"> </div><div class="crayon-line" id="crayon-5c0ca6392dc50160570834-37"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc50160570834-38"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca6392dc50160570834-39"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc50160570834-40"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0020 seconds] -->
<p>Again, running the example prints the reframed series. We can see that the input sequence is in the correct left-to-right order with the output variable to be predicted on the far right.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6392dc52424372095" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
   var1(t-3)  var1(t-2)  var1(t-1)  var1(t)
3        0.0        1.0        2.0        3
4        1.0        2.0        3.0        4
5        2.0        3.0        4.0        5
6        3.0        4.0        5.0        6
7        4.0        5.0        6.0        7
8        5.0        6.0        7.0        8
9        6.0        7.0        8.0        9</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6392dc52424372095-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc52424372095-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6392dc52424372095-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc52424372095-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6392dc52424372095-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc52424372095-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6392dc52424372095-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc52424372095-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6392dc52424372095-1">   var1(t-3)  var1(t-2)  var1(t-1)  var1(t)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc52424372095-2">3        0.0        1.0        2.0        3</div><div class="crayon-line" id="crayon-5c0ca6392dc52424372095-3">4        1.0        2.0        3.0        4</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc52424372095-4">5        2.0        3.0        4.0        5</div><div class="crayon-line" id="crayon-5c0ca6392dc52424372095-5">6        3.0        4.0        5.0        6</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc52424372095-6">7        4.0        5.0        6.0        7</div><div class="crayon-line" id="crayon-5c0ca6392dc52424372095-7">8        5.0        6.0        7.0        8</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc52424372095-8">9        6.0        7.0        8.0        9</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Multi-Step or Sequence Forecasting</h2>
<p>A different type of forecasting problem is using past observations to forecast a sequence of future observations.</p>
<p>This may be called sequence forecasting or multi-step forecasting.</p>
<p>We can frame a time series for sequence forecasting by specifying another argument. For example, we could frame a forecast problem with an input sequence of 2 past observations to forecast 2 future observations as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6392dc54169955964" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
data = series_to_supervised(values, 2, 2)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6392dc54169955964-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6392dc54169955964-1"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The complete example is listed below:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6392dc55819904220" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import DataFrame
from pandas import concat

def series_to_supervised(data, n_in=1, n_out=1, dropnan=True):
	"""
	Frame a time series as a supervised learning dataset.
	Arguments:
		data: Sequence of observations as a list or NumPy array.
		n_in: Number of lag observations as input (X).
		n_out: Number of observations as output (y).
		dropnan: Boolean whether or not to drop rows with NaN values.
	Returns:
		Pandas DataFrame of series framed for supervised learning.
	"""
	n_vars = 1 if type(data) is list else data.shape[1]
	df = DataFrame(data)
	cols, names = list(), list()
	# input sequence (t-n, ... t-1)
	for i in range(n_in, 0, -1):
		cols.append(df.shift(i))
		names += [('var%d(t-%d)' % (j+1, i)) for j in range(n_vars)]
	# forecast sequence (t, t+1, ... t+n)
	for i in range(0, n_out):
		cols.append(df.shift(-i))
		if i == 0:
			names += [('var%d(t)' % (j+1)) for j in range(n_vars)]
		else:
			names += [('var%d(t+%d)' % (j+1, i)) for j in range(n_vars)]
	# put it all together
	agg = concat(cols, axis=1)
	agg.columns = names
	# drop rows with NaN values
	if dropnan:
		agg.dropna(inplace=True)
	return agg


values = [x for x in range(10)]
data = series_to_supervised(values, 2, 2)
print(data)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6392dc55819904220-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc55819904220-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6392dc55819904220-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc55819904220-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6392dc55819904220-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc55819904220-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6392dc55819904220-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc55819904220-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6392dc55819904220-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc55819904220-10">10</div><div class="crayon-num" data-line="crayon-5c0ca6392dc55819904220-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc55819904220-12">12</div><div class="crayon-num" data-line="crayon-5c0ca6392dc55819904220-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc55819904220-14">14</div><div class="crayon-num" data-line="crayon-5c0ca6392dc55819904220-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc55819904220-16">16</div><div class="crayon-num" data-line="crayon-5c0ca6392dc55819904220-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc55819904220-18">18</div><div class="crayon-num" data-line="crayon-5c0ca6392dc55819904220-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc55819904220-20">20</div><div class="crayon-num" data-line="crayon-5c0ca6392dc55819904220-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc55819904220-22">22</div><div class="crayon-num" data-line="crayon-5c0ca6392dc55819904220-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc55819904220-24">24</div><div class="crayon-num" data-line="crayon-5c0ca6392dc55819904220-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc55819904220-26">26</div><div class="crayon-num" data-line="crayon-5c0ca6392dc55819904220-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc55819904220-28">28</div><div class="crayon-num" data-line="crayon-5c0ca6392dc55819904220-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc55819904220-30">30</div><div class="crayon-num" data-line="crayon-5c0ca6392dc55819904220-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc55819904220-32">32</div><div class="crayon-num" data-line="crayon-5c0ca6392dc55819904220-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc55819904220-34">34</div><div class="crayon-num" data-line="crayon-5c0ca6392dc55819904220-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc55819904220-36">36</div><div class="crayon-num" data-line="crayon-5c0ca6392dc55819904220-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc55819904220-38">38</div><div class="crayon-num" data-line="crayon-5c0ca6392dc55819904220-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc55819904220-40">40</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6392dc55819904220-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc55819904220-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">concat</span></div><div class="crayon-line" id="crayon-5c0ca6392dc55819904220-3"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc55819904220-4"><span class="crayon-e">def </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_in</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca6392dc55819904220-5"><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-s">"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc55819904220-6"><span class="crayon-s">	Frame a time series as a supervised learning dataset.</span></div><div class="crayon-line" id="crayon-5c0ca6392dc55819904220-7"><span class="crayon-s">	Arguments:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc55819904220-8"><span class="crayon-s">		data: Sequence of observations as a list or NumPy array.</span></div><div class="crayon-line" id="crayon-5c0ca6392dc55819904220-9"><span class="crayon-s">		n_in: Number of lag observations as input (X).</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc55819904220-10"><span class="crayon-s">		n_out: Number of observations as output (y).</span></div><div class="crayon-line" id="crayon-5c0ca6392dc55819904220-11"><span class="crayon-s">		dropnan: Boolean whether or not to drop rows with NaN values.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc55819904220-12"><span class="crayon-s">	Returns:</span></div><div class="crayon-line" id="crayon-5c0ca6392dc55819904220-13"><span class="crayon-s">		Pandas DataFrame of series framed for supervised learning.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc55819904220-14"><span class="crayon-s">	"</span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5c0ca6392dc55819904220-15"><span class="crayon-h"> </span><span class="crayon-v">n_vars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">type</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">list </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc55819904220-16"><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc55819904220-17"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc55819904220-18"><span class="crayon-h"> </span><span class="crayon-p"># input sequence (t-n, ... t-1)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc55819904220-19"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc55819904220-20"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc55819904220-21"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t-%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc55819904220-22"><span class="crayon-h"> </span><span class="crayon-p"># forecast sequence (t, t+1, ... t+n)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc55819904220-23"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc55819904220-24"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc55819904220-25"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc55819904220-26"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca6392dc55819904220-27"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc55819904220-28"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t+%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca6392dc55819904220-29"><span class="crayon-h"> </span><span class="crayon-p"># put it all together</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc55819904220-30"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc55819904220-31"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc55819904220-32"><span class="crayon-h"> </span><span class="crayon-p"># drop rows with NaN values</span></div><div class="crayon-line" id="crayon-5c0ca6392dc55819904220-33"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc55819904220-34"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-e">dropna</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc55819904220-35"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">agg</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc55819904220-36"> </div><div class="crayon-line" id="crayon-5c0ca6392dc55819904220-37"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc55819904220-38"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca6392dc55819904220-39"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc55819904220-40"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0021 seconds] -->
<p>Running the example shows the differentiation of input (t-n) and output (t+n) variables with the current observation (t) considered an output.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6392dc57689831892" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
   var1(t-2)  var1(t-1)  var1(t)  var1(t+1)
2        0.0        1.0        2        3.0
3        1.0        2.0        3        4.0
4        2.0        3.0        4        5.0
5        3.0        4.0        5        6.0
6        4.0        5.0        6        7.0
7        5.0        6.0        7        8.0
8        6.0        7.0        8        9.0</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6392dc57689831892-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc57689831892-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6392dc57689831892-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc57689831892-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6392dc57689831892-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc57689831892-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6392dc57689831892-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc57689831892-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6392dc57689831892-1">   var1(t-2)  var1(t-1)  var1(t)  var1(t+1)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc57689831892-2">2        0.0        1.0        2        3.0</div><div class="crayon-line" id="crayon-5c0ca6392dc57689831892-3">3        1.0        2.0        3        4.0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc57689831892-4">4        2.0        3.0        4        5.0</div><div class="crayon-line" id="crayon-5c0ca6392dc57689831892-5">5        3.0        4.0        5        6.0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc57689831892-6">6        4.0        5.0        6        7.0</div><div class="crayon-line" id="crayon-5c0ca6392dc57689831892-7">7        5.0        6.0        7        8.0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc57689831892-8">8        6.0        7.0        8        9.0</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Multivariate Forecasting</h2>
<p>Another important type of time series is called multivariate time series.</p>
<p>This is where we may have observations of multiple different measures and an interest in forecasting one or more of them.</p>
<p>For example, we may have two sets of time series observations obs1 and obs2 and we wish to forecast one or both of these.</p>
<p>We can call <em>series_to_supervised()</em> in exactly the same way.</p>
<p>For example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6392dc59186751871" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import DataFrame
from pandas import concat

def series_to_supervised(data, n_in=1, n_out=1, dropnan=True):
	"""
	Frame a time series as a supervised learning dataset.
	Arguments:
		data: Sequence of observations as a list or NumPy array.
		n_in: Number of lag observations as input (X).
		n_out: Number of observations as output (y).
		dropnan: Boolean whether or not to drop rows with NaN values.
	Returns:
		Pandas DataFrame of series framed for supervised learning.
	"""
	n_vars = 1 if type(data) is list else data.shape[1]
	df = DataFrame(data)
	cols, names = list(), list()
	# input sequence (t-n, ... t-1)
	for i in range(n_in, 0, -1):
		cols.append(df.shift(i))
		names += [('var%d(t-%d)' % (j+1, i)) for j in range(n_vars)]
	# forecast sequence (t, t+1, ... t+n)
	for i in range(0, n_out):
		cols.append(df.shift(-i))
		if i == 0:
			names += [('var%d(t)' % (j+1)) for j in range(n_vars)]
		else:
			names += [('var%d(t+%d)' % (j+1, i)) for j in range(n_vars)]
	# put it all together
	agg = concat(cols, axis=1)
	agg.columns = names
	# drop rows with NaN values
	if dropnan:
		agg.dropna(inplace=True)
	return agg


raw = DataFrame()
raw['ob1'] = [x for x in range(10)]
raw['ob2'] = [x for x in range(50, 60)]
values = raw.values
data = series_to_supervised(values)
print(data)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6392dc59186751871-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc59186751871-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6392dc59186751871-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc59186751871-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6392dc59186751871-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc59186751871-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6392dc59186751871-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc59186751871-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6392dc59186751871-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc59186751871-10">10</div><div class="crayon-num" data-line="crayon-5c0ca6392dc59186751871-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc59186751871-12">12</div><div class="crayon-num" data-line="crayon-5c0ca6392dc59186751871-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc59186751871-14">14</div><div class="crayon-num" data-line="crayon-5c0ca6392dc59186751871-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc59186751871-16">16</div><div class="crayon-num" data-line="crayon-5c0ca6392dc59186751871-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc59186751871-18">18</div><div class="crayon-num" data-line="crayon-5c0ca6392dc59186751871-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc59186751871-20">20</div><div class="crayon-num" data-line="crayon-5c0ca6392dc59186751871-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc59186751871-22">22</div><div class="crayon-num" data-line="crayon-5c0ca6392dc59186751871-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc59186751871-24">24</div><div class="crayon-num" data-line="crayon-5c0ca6392dc59186751871-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc59186751871-26">26</div><div class="crayon-num" data-line="crayon-5c0ca6392dc59186751871-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc59186751871-28">28</div><div class="crayon-num" data-line="crayon-5c0ca6392dc59186751871-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc59186751871-30">30</div><div class="crayon-num" data-line="crayon-5c0ca6392dc59186751871-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc59186751871-32">32</div><div class="crayon-num" data-line="crayon-5c0ca6392dc59186751871-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc59186751871-34">34</div><div class="crayon-num" data-line="crayon-5c0ca6392dc59186751871-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc59186751871-36">36</div><div class="crayon-num" data-line="crayon-5c0ca6392dc59186751871-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc59186751871-38">38</div><div class="crayon-num" data-line="crayon-5c0ca6392dc59186751871-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc59186751871-40">40</div><div class="crayon-num" data-line="crayon-5c0ca6392dc59186751871-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc59186751871-42">42</div><div class="crayon-num" data-line="crayon-5c0ca6392dc59186751871-43">43</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6392dc59186751871-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc59186751871-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">concat</span></div><div class="crayon-line" id="crayon-5c0ca6392dc59186751871-3"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc59186751871-4"><span class="crayon-e">def </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_in</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca6392dc59186751871-5"><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-s">"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc59186751871-6"><span class="crayon-s">	Frame a time series as a supervised learning dataset.</span></div><div class="crayon-line" id="crayon-5c0ca6392dc59186751871-7"><span class="crayon-s">	Arguments:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc59186751871-8"><span class="crayon-s">		data: Sequence of observations as a list or NumPy array.</span></div><div class="crayon-line" id="crayon-5c0ca6392dc59186751871-9"><span class="crayon-s">		n_in: Number of lag observations as input (X).</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc59186751871-10"><span class="crayon-s">		n_out: Number of observations as output (y).</span></div><div class="crayon-line" id="crayon-5c0ca6392dc59186751871-11"><span class="crayon-s">		dropnan: Boolean whether or not to drop rows with NaN values.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc59186751871-12"><span class="crayon-s">	Returns:</span></div><div class="crayon-line" id="crayon-5c0ca6392dc59186751871-13"><span class="crayon-s">		Pandas DataFrame of series framed for supervised learning.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc59186751871-14"><span class="crayon-s">	"</span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5c0ca6392dc59186751871-15"><span class="crayon-h"> </span><span class="crayon-v">n_vars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">type</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">list </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc59186751871-16"><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc59186751871-17"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc59186751871-18"><span class="crayon-h"> </span><span class="crayon-p"># input sequence (t-n, ... t-1)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc59186751871-19"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc59186751871-20"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc59186751871-21"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t-%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc59186751871-22"><span class="crayon-h"> </span><span class="crayon-p"># forecast sequence (t, t+1, ... t+n)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc59186751871-23"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc59186751871-24"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc59186751871-25"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc59186751871-26"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca6392dc59186751871-27"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc59186751871-28"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t+%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca6392dc59186751871-29"><span class="crayon-h"> </span><span class="crayon-p"># put it all together</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc59186751871-30"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc59186751871-31"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc59186751871-32"><span class="crayon-h"> </span><span class="crayon-p"># drop rows with NaN values</span></div><div class="crayon-line" id="crayon-5c0ca6392dc59186751871-33"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc59186751871-34"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-e">dropna</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc59186751871-35"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">agg</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc59186751871-36"> </div><div class="crayon-line" id="crayon-5c0ca6392dc59186751871-37"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc59186751871-38"><span class="crayon-v">raw</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc59186751871-39"><span class="crayon-v">raw</span><span class="crayon-sy">[</span><span class="crayon-s">'ob1'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc59186751871-40"><span class="crayon-v">raw</span><span class="crayon-sy">[</span><span class="crayon-s">'ob2'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca6392dc59186751871-41"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">raw</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc59186751871-42"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc59186751871-43"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0023 seconds] -->
<p>Running the example prints the new framing of the data, showing an input pattern with one time step for both variables and an output pattern of one time step for both variables.</p>
<p>Again, depending on the specifics of the problem, the division of columns into <em>X</em> and <em>Y</em> components can be chosen arbitrarily, such as if the current observation of <em>var1</em> was also provided as input and only <em>var2</em> was to be predicted.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6392dc5b329754678" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
   var1(t-1)  var2(t-1)  var1(t)  var2(t)
1        0.0       50.0        1       51
2        1.0       51.0        2       52
3        2.0       52.0        3       53
4        3.0       53.0        4       54
5        4.0       54.0        5       55
6        5.0       55.0        6       56
7        6.0       56.0        7       57
8        7.0       57.0        8       58
9        8.0       58.0        9       59</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6392dc5b329754678-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5b329754678-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5b329754678-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5b329754678-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5b329754678-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5b329754678-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5b329754678-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5b329754678-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5b329754678-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5b329754678-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6392dc5b329754678-1">   var1(t-1)  var2(t-1)  var1(t)  var2(t)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5b329754678-2">1        0.0       50.0        1       51</div><div class="crayon-line" id="crayon-5c0ca6392dc5b329754678-3">2        1.0       51.0        2       52</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5b329754678-4">3        2.0       52.0        3       53</div><div class="crayon-line" id="crayon-5c0ca6392dc5b329754678-5">4        3.0       53.0        4       54</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5b329754678-6">5        4.0       54.0        5       55</div><div class="crayon-line" id="crayon-5c0ca6392dc5b329754678-7">6        5.0       55.0        6       56</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5b329754678-8">7        6.0       56.0        7       57</div><div class="crayon-line" id="crayon-5c0ca6392dc5b329754678-9">8        7.0       57.0        8       58</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5b329754678-10">9        8.0       58.0        9       59</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>You can see how this may be easily used for sequence forecasting with multivariate time series by specifying the length of the input and output sequences as above.</p>
<p>For example, below is an example of a reframing with 1 time step as input and 2 time steps as forecast sequence.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6392dc5e877965391" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import DataFrame
from pandas import concat

def series_to_supervised(data, n_in=1, n_out=1, dropnan=True):
	"""
	Frame a time series as a supervised learning dataset.
	Arguments:
		data: Sequence of observations as a list or NumPy array.
		n_in: Number of lag observations as input (X).
		n_out: Number of observations as output (y).
		dropnan: Boolean whether or not to drop rows with NaN values.
	Returns:
		Pandas DataFrame of series framed for supervised learning.
	"""
	n_vars = 1 if type(data) is list else data.shape[1]
	df = DataFrame(data)
	cols, names = list(), list()
	# input sequence (t-n, ... t-1)
	for i in range(n_in, 0, -1):
		cols.append(df.shift(i))
		names += [('var%d(t-%d)' % (j+1, i)) for j in range(n_vars)]
	# forecast sequence (t, t+1, ... t+n)
	for i in range(0, n_out):
		cols.append(df.shift(-i))
		if i == 0:
			names += [('var%d(t)' % (j+1)) for j in range(n_vars)]
		else:
			names += [('var%d(t+%d)' % (j+1, i)) for j in range(n_vars)]
	# put it all together
	agg = concat(cols, axis=1)
	agg.columns = names
	# drop rows with NaN values
	if dropnan:
		agg.dropna(inplace=True)
	return agg


raw = DataFrame()
raw['ob1'] = [x for x in range(10)]
raw['ob2'] = [x for x in range(50, 60)]
values = raw.values
data = series_to_supervised(values, 1, 2)
print(data)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6392dc5e877965391-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5e877965391-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5e877965391-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5e877965391-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5e877965391-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5e877965391-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5e877965391-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5e877965391-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5e877965391-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5e877965391-10">10</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5e877965391-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5e877965391-12">12</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5e877965391-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5e877965391-14">14</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5e877965391-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5e877965391-16">16</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5e877965391-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5e877965391-18">18</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5e877965391-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5e877965391-20">20</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5e877965391-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5e877965391-22">22</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5e877965391-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5e877965391-24">24</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5e877965391-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5e877965391-26">26</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5e877965391-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5e877965391-28">28</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5e877965391-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5e877965391-30">30</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5e877965391-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5e877965391-32">32</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5e877965391-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5e877965391-34">34</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5e877965391-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5e877965391-36">36</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5e877965391-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5e877965391-38">38</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5e877965391-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5e877965391-40">40</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5e877965391-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc5e877965391-42">42</div><div class="crayon-num" data-line="crayon-5c0ca6392dc5e877965391-43">43</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6392dc5e877965391-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5e877965391-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">concat</span></div><div class="crayon-line" id="crayon-5c0ca6392dc5e877965391-3"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5e877965391-4"><span class="crayon-e">def </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_in</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca6392dc5e877965391-5"><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-s">"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5e877965391-6"><span class="crayon-s">	Frame a time series as a supervised learning dataset.</span></div><div class="crayon-line" id="crayon-5c0ca6392dc5e877965391-7"><span class="crayon-s">	Arguments:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5e877965391-8"><span class="crayon-s">		data: Sequence of observations as a list or NumPy array.</span></div><div class="crayon-line" id="crayon-5c0ca6392dc5e877965391-9"><span class="crayon-s">		n_in: Number of lag observations as input (X).</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5e877965391-10"><span class="crayon-s">		n_out: Number of observations as output (y).</span></div><div class="crayon-line" id="crayon-5c0ca6392dc5e877965391-11"><span class="crayon-s">		dropnan: Boolean whether or not to drop rows with NaN values.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5e877965391-12"><span class="crayon-s">	Returns:</span></div><div class="crayon-line" id="crayon-5c0ca6392dc5e877965391-13"><span class="crayon-s">		Pandas DataFrame of series framed for supervised learning.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5e877965391-14"><span class="crayon-s">	"</span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5c0ca6392dc5e877965391-15"><span class="crayon-h"> </span><span class="crayon-v">n_vars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">type</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">list </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5e877965391-16"><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc5e877965391-17"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5e877965391-18"><span class="crayon-h"> </span><span class="crayon-p"># input sequence (t-n, ... t-1)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc5e877965391-19"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5e877965391-20"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc5e877965391-21"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t-%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5e877965391-22"><span class="crayon-h"> </span><span class="crayon-p"># forecast sequence (t, t+1, ... t+n)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc5e877965391-23"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5e877965391-24"><span class="crayon-h"> </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc5e877965391-25"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5e877965391-26"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca6392dc5e877965391-27"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5e877965391-28"><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'var%d(t+%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca6392dc5e877965391-29"><span class="crayon-h"> </span><span class="crayon-p"># put it all together</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5e877965391-30"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc5e877965391-31"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5e877965391-32"><span class="crayon-h"> </span><span class="crayon-p"># drop rows with NaN values</span></div><div class="crayon-line" id="crayon-5c0ca6392dc5e877965391-33"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5e877965391-34"><span class="crayon-h"> </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-e">dropna</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc5e877965391-35"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">agg</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5e877965391-36"> </div><div class="crayon-line" id="crayon-5c0ca6392dc5e877965391-37"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5e877965391-38"><span class="crayon-v">raw</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc5e877965391-39"><span class="crayon-v">raw</span><span class="crayon-sy">[</span><span class="crayon-s">'ob1'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5e877965391-40"><span class="crayon-v">raw</span><span class="crayon-sy">[</span><span class="crayon-s">'ob2'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca6392dc5e877965391-41"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">raw</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc5e877965391-42"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6392dc5e877965391-43"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0024 seconds] -->
<p>Running the example shows the large reframed DataFrame.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6392dc60095481089" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
   var1(t-1)  var2(t-1)  var1(t)  var2(t)  var1(t+1)  var2(t+1)
1        0.0       50.0        1       51        2.0       52.0
2        1.0       51.0        2       52        3.0       53.0
3        2.0       52.0        3       53        4.0       54.0
4        3.0       53.0        4       54        5.0       55.0
5        4.0       54.0        5       55        6.0       56.0
6        5.0       55.0        6       56        7.0       57.0
7        6.0       56.0        7       57        8.0       58.0
8        7.0       57.0        8       58        9.0       59.0</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6392dc60095481089-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc60095481089-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6392dc60095481089-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc60095481089-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6392dc60095481089-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc60095481089-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6392dc60095481089-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6392dc60095481089-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6392dc60095481089-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6392dc60095481089-1">   var1(t-1)  var2(t-1)  var1(t)  var2(t)  var1(t+1)  var2(t+1)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc60095481089-2">1        0.0       50.0        1       51        2.0       52.0</div><div class="crayon-line" id="crayon-5c0ca6392dc60095481089-3">2        1.0       51.0        2       52        3.0       53.0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc60095481089-4">3        2.0       52.0        3       53        4.0       54.0</div><div class="crayon-line" id="crayon-5c0ca6392dc60095481089-5">4        3.0       53.0        4       54        5.0       55.0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc60095481089-6">5        4.0       54.0        5       55        6.0       56.0</div><div class="crayon-line" id="crayon-5c0ca6392dc60095481089-7">6        5.0       55.0        6       56        7.0       57.0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6392dc60095481089-8">7        6.0       56.0        7       57        8.0       58.0</div><div class="crayon-line" id="crayon-5c0ca6392dc60095481089-9">8        7.0       57.0        8       58        9.0       59.0</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Experiment with your own dataset and try multiple different framings to see what works best.</p>
<h2>Summary</h2>
<p>In this tutorial, you discovered how to reframe time series datasets as supervised learning problems with Python.</p>
<p>Specifically, you learned:</p>
<ul>
<li>About the Pandas <em>shift()</em> function and how it can be used to automatically define supervised learning datasets from time series data.</li>
<li>How to reframe a univariate time series into one-step and multi-step supervised learning problems.</li>
<li>How to reframe multivariate time series into one-step and multi-step supervised learning problems.</li>
</ul>
<p>Do you have any questions?<br/>
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="awac-wrapper"><div class="awac widget text-26"> <div class="textwidget"><p></p><center>
<div class="woo-sc-hr"></div>
<h2>Want to Develop Time Series Forecasts with Python?</h2>
<p><a href="/introduction-to-time-series-forecasting-with-python/"><img align="left" alt="Introduction to Time Series Forecasting With Python" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/02/Introduction-to-Time-Series-Forecasting-With-Python-220.png" style="border: 0;"/></a></p>
<h4>Develop Your Own Forecasts in Minutes</h4>
<p>...with just a few lines of python code</p>
<p>Discover how in my new Ebook:<br/>
<a href="/introduction-to-time-series-forecasting-with-python/">Introduction to Time Series Forecasting With Python</a></p>
<p>It covers <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> on topics like:<br/>
<em>Loading data, visualization, modeling, algorithm tuning,</em> and much more...</p>
<h4>Finally Bring Time Series Forecasting to<br/>
Your Own Projects</h4>
<p>Skip the Academics. Just Results.</p>
<p><a href="/introduction-to-time-series-forecasting-with-python/">Click to learn more</a>.</p>
<div class="woo-sc-hr"></div>
<p></p></center>
</div>
</div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-3984 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Convert+a+Time+Series+to+a+Supervised+Learning+Problem+in+Python&amp;url=https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
</section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/use-weight-regularization-lstm-networks-time-series-forecasting/" rel="prev"><i class="fa fa-angle-left"></i> How to Use Weight Regularization with LSTM Networks for Time Series Forecasting</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="next">Multi-step Time Series Forecasting with Long Short-Term Memory Networks in Python <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">151 Responses to <em>How to Convert a Time Series to a Supervised Learning Problem in Python</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-399021">
<div class="comment-container" id="li-comment-399021">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7dcb623e6c03db17645676ec6f8b0870?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7dcb623e6c03db17645676ec6f8b0870?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mikkel</span>
<span class="date">May 8, 2017 at 7:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-399021" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thanks for your highly relevant article 🙂</p>
<p>I am having a hard time following the structure of the dataset. I understand the basics of t-n, t-1, t, t+1, t+n and so forth. Although, what exactly are we describing here in the t and t-1 column? Is it the change over time for a specific explanatory variable? In that case, wouldn’t it make more sense to transpose the data, so that the time were described in the rows rather than columns?</p>
<p>Also, how would you then characterise following data:</p>
<p>Customer_ID      Month       Balance<br/>
        1                    01            1,500<br/>
        1                    02            1,600<br/>
        1                    03            1,700<br/>
        1                    04            1,900<br/>
        2                    01            1,000<br/>
        2                    02              900<br/>
        2                    03              700<br/>
        2                    04              500<br/>
        3                    01            3,500<br/>
        3                    02            1,500<br/>
        3                    03            2,500<br/>
        3                    04            4,500    </p>
<p>Let’s say, that we wanna forcast their balance using supervised learning, or classify the customers as “savers” or “spenders”</p>
<div class="reply">
<a aria-label="Reply to Mikkel" class="comment-reply-link" href="#comment-399021" onclick='return addComment.moveForm( "comment-399021", "399021", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-399088">
<div class="comment-container" id="li-comment-399088">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 9, 2017 at 7:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-399088" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, it is transposing each variable, but allowing control over the length of each row back into time.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-399088" onclick='return addComment.moveForm( "comment-399088", "399088", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-430839">
<div class="comment-container" id="li-comment-430839">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c28b83c1b5789deb3188a9b592120bd4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c28b83c1b5789deb3188a9b592120bd4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mostafa</span>
<span class="date">March 2, 2018 at 2:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-430839" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thanks for very helpful tutorials, I have the same question as Mikkel.</p>
<p>how would you then characterise following data?</p>
<p>let’s suppose we have a dataset same as  the following.<br/>
and we want to predict the Balance of each Customer at the fourth month, how should I deal with this problem?</p>
<p>Thanks a bunch in advance</p>
<p>Customer_ID     Month          Balance<br/>
1                          01                 1,500<br/>
1                          02                 1,600<br/>
1                          03                 1,700<br/>
1                          04                 1,900<br/>
2                          01                 1,000<br/>
2                          02                    900<br/>
2                          03                    700<br/>
2                          04                    500<br/>
3                          01                 3,500<br/>
3                          02                 1,500<br/>
3                          03                 2,500<br/>
3                          04                 4,500</p>
<div class="reply">
<a aria-label="Reply to Mostafa" class="comment-reply-link" href="#comment-430839" onclick='return addComment.moveForm( "comment-430839", "430839", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-430858">
<div class="comment-container" id="li-comment-430858">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 2, 2018 at 5:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-430858" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Test different framing of the problem.</p>
<p>Try modeling all customers together as a first step.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430858" onclick='return addComment.moveForm( "comment-430858", "430858", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-4" id="comment-441571">
<div class="comment-container" id="li-comment-441571">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/03cc429f3e84238cf814dd121f08eea1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/03cc429f3e84238cf814dd121f08eea1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Yavuz</span>
<span class="date">June 21, 2018 at 11:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-441571" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Mostafa,</p>
<p>I am dealing with a similar kind of problem right now. Have you found any simple and coherent answer to your question? Any article, code example or video lecture?</p>
<p>I appreciate if you found something and let me know.</p>
<p>Thanks, regards.</p>
<div class="reply">
<a aria-label="Reply to Yavuz" class="comment-reply-link" href="#comment-441571" onclick='return addComment.moveForm( "comment-441571", "441571", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-442004">
<div class="comment-container" id="li-comment-442004">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8e6b29017b65ae999d009db695a971f3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8e6b29017b65ae999d009db695a971f3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://no" rel="external nofollow">WangGang</a></span>
<span class="date">June 25, 2018 at 10:16 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-442004" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would like to ask if I have the data for the first 5 hours, how to get the data for the sixth hour, Thanks</p>
<div class="reply">
<a aria-label="Reply to WangGang" class="comment-reply-link" href="#comment-442004" onclick='return addComment.moveForm( "comment-442004", "442004", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-399137">
<div class="comment-container" id="li-comment-399137">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/abaa99146ddd0419bebddeea30638819?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/abaa99146ddd0419bebddeea30638819?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Daniel</span>
<span class="date">May 9, 2017 at 4:56 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-399137" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,</p>
<p>this is an awesome article! I was looking for that the whole time.</p>
<p>The only thing is I am general programming in R, so I only found something similar like your code, but I am not sure if it is the same. I have got this from <a href="https://www.r-bloggers.com/generating-a-laglead-variables/" rel="nofollow">https://www.r-bloggers.com/generating-a-laglead-variables/</a> and it deals with lagged and leaded values. Also the output includes NA values.</p>
<p>shift1)<br/>
        return(sapply(shift_by,shift, x=x))</p>
<p>    out 0 )<br/>
        out&lt;-c(tail(x,-abs_shift_by),rep(NA,abs_shift_by))<br/>
    else if (shift_by &lt; 0 )<br/>
        out&lt;-c(rep(NA,abs_shift_by), head(x,-abs_shift_by))<br/>
    else<br/>
        out&lt;-x<br/>
    out<br/>
}</p>
<p>Output:<br/>
    x df_lead2 df_lag2<br/>
1   1        3      NA<br/>
2   2        4      NA<br/>
3   3        5       1<br/>
4   4        6       2<br/>
5   5        7       3<br/>
6   6        8       4<br/>
7   7        9       5<br/>
8   8       10       6<br/>
9   9       NA       7<br/>
10 10       NA       8</p>
<p>I also tried to recompile your code in R, but it failed.</p>
<div class="reply">
<a aria-label="Reply to Daniel" class="comment-reply-link" href="#comment-399137" onclick='return addComment.moveForm( "comment-399137", "399137", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-399251">
<div class="comment-container" id="li-comment-399251">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 10, 2017 at 8:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-399251" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend contacting the authors of the R code you reference.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-399251" onclick='return addComment.moveForm( "comment-399251", "399251", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-399421">
<div class="comment-container" id="li-comment-399421">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c1f3df17a4e7d685d7dfa9ad741018e0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c1f3df17a4e7d685d7dfa9ad741018e0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">chris</span>
<span class="date">May 12, 2017 at 3:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-399421" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can you answer this in Go, Java, C# and COBOL as well????? Thanks, I really don’t want to do anything</p>
<div class="reply">
<a aria-label="Reply to chris" class="comment-reply-link" href="#comment-399421" onclick='return addComment.moveForm( "comment-399421", "399421", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-399446">
<div class="comment-container" id="li-comment-399446">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 12, 2017 at 7:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-399446" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I do my best to help, some need more help than others.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-399446" onclick='return addComment.moveForm( "comment-399446", "399446", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-399192">
<div class="comment-container" id="li-comment-399192">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/47fa92e81c98cb0418d3897f99d60ef6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/47fa92e81c98cb0418d3897f99d60ef6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Lee</span>
<span class="date">May 9, 2017 at 11:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-399192" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, good article, but could be much better if you illustrated everything with some actual time series data. Also, no need to repeat the function code 5 times 😉 Gripes aside, this was very timely as I’m just about to get into some time series forecasting, so thanks for this article!!!</p>
<div class="reply">
<a aria-label="Reply to Lee" class="comment-reply-link" href="#comment-399192" onclick='return addComment.moveForm( "comment-399192", "399192", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-399256">
<div class="comment-container" id="li-comment-399256">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 10, 2017 at 8:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-399256" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion Lee.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-399256" onclick='return addComment.moveForm( "comment-399256", "399256", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-399481">
<div class="comment-container" id="li-comment-399481">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/15204f195246425556b5cd78c6d93add?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/15204f195246425556b5cd78c6d93add?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Christopher</span>
<span class="date">May 12, 2017 at 9:16 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-399481" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
thank you for the good article! I really like the shifting approach for reframing the training data!<br/>
But my question about this topic is: What do you think is the next step for a one-step univariate forecasting? Which machine learning method is the most suitable for that?<br/>
Obviously a regressor is the best choice but how can I determine the size of the sliding window for the training? </p>
<p>Thanks a lot for your help and work<br/>
~ Christopher</p>
<div class="reply">
<a aria-label="Reply to Christopher" class="comment-reply-link" href="#comment-399481" onclick='return addComment.moveForm( "comment-399481", "399481", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-399532">
<div class="comment-container" id="li-comment-399532">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 13, 2017 at 6:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-399532" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>My advice is to trial a suite of different window sizes and see what works best. </p>
<p>You can use an ACF/PACF plots as a heuristic:<br/>
<a href="http://machinelearningmastery.com/gentle-introduction-autocorrelation-partial-autocorrelation/" rel="nofollow">http://machinelearningmastery.com/gentle-introduction-autocorrelation-partial-autocorrelation/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-399532" onclick='return addComment.moveForm( "comment-399532", "399532", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-401872">
<div class="comment-container" id="li-comment-401872">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9a65642d348a8bf2a511a7ec85db6ef1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9a65642d348a8bf2a511a7ec85db6ef1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">tom</span>
<span class="date">June 8, 2017 at 4:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-401872" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi Jason：<br/>
       In this post, you  create new framings of time series ,such as t-1, t, t+1.But, what’s the use of these time series .Do you mean these time series can make a good effect on model? Maybe<br/>
my question is too simple ,because I am a newer ,please understand! thank you !</p>
<div class="reply">
<a aria-label="Reply to tom" class="comment-reply-link" href="#comment-401872" onclick='return addComment.moveForm( "comment-401872", "401872", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401936">
<div class="comment-container" id="li-comment-401936">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 9, 2017 at 6:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-401936" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am providing a technique to help you convert a series into a supervised learning problem.</p>
<p>This is valuable because you can then transform your time series problems into supervised learning problems and apply a suite of standard classification and regression techniques in order to make forecasts.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401936" onclick='return addComment.moveForm( "comment-401936", "401936", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-401968">
<div class="comment-container" id="li-comment-401968">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9a65642d348a8bf2a511a7ec85db6ef1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9a65642d348a8bf2a511a7ec85db6ef1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">tom</span>
<span class="date">June 9, 2017 at 11:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-401968" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Wow, your answer always makes me learn a lot。Thank you Jason!</p>
<div class="reply">
<a aria-label="Reply to tom" class="comment-reply-link" href="#comment-401968" onclick='return addComment.moveForm( "comment-401968", "401968", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-402067">
<div class="comment-container" id="li-comment-402067">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 10, 2017 at 8:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-402067" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-402067" onclick='return addComment.moveForm( "comment-402067", "402067", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-403593">
<div class="comment-container" id="li-comment-403593">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fdddac309b1149cfcad5da9744944825?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fdddac309b1149cfcad5da9744944825?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Brad Suzon</span>
<span class="date">June 23, 2017 at 11:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-403593" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If there are multiple variables varXi to train and only one variable varY to predict will the same technique be used in the below way:<br/>
varX1(t-1)   varX2(t-1)   varX1(t)   varX2(t)   …   varY(t-1)   varY(t)<br/>
   ..                 ..                ..                ..                  ..                ..<br/>
and then use linear regression and as Response= varY(t) ?</p>
<p>Thanks in advance</p>
<div class="reply">
<a aria-label="Reply to Brad Suzon" class="comment-reply-link" href="#comment-403593" onclick='return addComment.moveForm( "comment-403593", "403593", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-403640">
<div class="comment-container" id="li-comment-403640">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 24, 2017 at 8:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-403640" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not sure I follow your question Brad, perhaps you can restate it?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-403640" onclick='return addComment.moveForm( "comment-403640", "403640", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-403751">
<div class="comment-container" id="li-comment-403751">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fdddac309b1149cfcad5da9744944825?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fdddac309b1149cfcad5da9744944825?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Brad</span>
<span class="date">June 25, 2017 at 4:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-403751" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In case there are multiple measures and then make the transformation in order to forecast only varXn:</p>
<p>var1(t-1)       var2(t-1)      var1(t)      var2(t) …      varN(t-1)        varN(t)</p>
<p>linear regression should use as the response variable the varN(t) ?</p>
<div class="reply">
<a aria-label="Reply to Brad" class="comment-reply-link" href="#comment-403751" onclick='return addComment.moveForm( "comment-403751", "403751", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-403807">
<div class="comment-container" id="li-comment-403807">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 26, 2017 at 6:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-403807" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-403807" onclick='return addComment.moveForm( "comment-403807", "403807", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-403648">
<div class="comment-container" id="li-comment-403648">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9f4d532e7bae2467c8839e102d02e3a9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9f4d532e7bae2467c8839e102d02e3a9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://GitHub.com/xbno" rel="external nofollow">Geoff</a></span>
<span class="date">June 24, 2017 at 8:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-403648" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I’ve found your articles very useful during my capstone at a bootcamp I’m attending. I have two questions that I hope you could advise where to find better info about.<br/>
First, I’ve run into an issue with running PCA on the newly supervised version only the data. Does PCA recognize that the lagged series are actually the same data? If one was to do PCA do they need to perform it before supervising the data?<br/>
Secondly, what do you propose as the best learning algorithms and proper ways to perform train test splits on the data?<br/>
Thanks again,</p>
<div class="reply">
<a aria-label="Reply to Geoff" class="comment-reply-link" href="#comment-403648" onclick='return addComment.moveForm( "comment-403648", "403648", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-403719">
<div class="comment-container" id="li-comment-403719">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 25, 2017 at 5:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-403719" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I have not used PCA on time series data. I expect careful handling of the framing of the data is required.</p>
<p>I have tips for backtesting on time series data here:<br/>
<a href="http://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/" rel="nofollow">http://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-403719" onclick='return addComment.moveForm( "comment-403719", "403719", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-404440">
<div class="comment-container" id="li-comment-404440">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a9bf30f417481ce4463a98437fcb2c2f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a9bf30f417481ce4463a98437fcb2c2f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kushal</span>
<span class="date">July 1, 2017 at 1:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-404440" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason</p>
<p>Great post.</p>
<p>Just one question. If the some of the input variables are continuous and some are categorical with one binary, predicting two output variables.</p>
<p>How does the shift work then?</p>
<p>Thanks<br/>
Kushal</p>
<div class="reply">
<a aria-label="Reply to Kushal" class="comment-reply-link" href="#comment-404440" onclick='return addComment.moveForm( "comment-404440", "404440", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-404500">
<div class="comment-container" id="li-comment-404500">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 2, 2017 at 6:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-404500" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The same, but consider encoding your categorical variables first (e.g. number encoding or one hot encoding).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-404500" onclick='return addComment.moveForm( "comment-404500", "404500", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-406027">
<div class="comment-container" id="li-comment-406027">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a9bf30f417481ce4463a98437fcb2c2f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a9bf30f417481ce4463a98437fcb2c2f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kushal</span>
<span class="date">July 15, 2017 at 5:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-406027" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks</p>
<p>Should I then use the lagged versions of the predictors?</p>
<p>Kushal</p>
<div class="reply">
<a aria-label="Reply to Kushal" class="comment-reply-link" href="#comment-406027" onclick='return addComment.moveForm( "comment-406027", "406027", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-406081">
<div class="comment-container" id="li-comment-406081">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 16, 2017 at 7:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-406081" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps, I do not follow your question, perhaps you can restate it with more information?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-406081" onclick='return addComment.moveForm( "comment-406081", "406081", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-405093">
<div class="comment-container" id="li-comment-405093">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/61f9f7daef721495bd9665f5fdc4cc7c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/61f9f7daef721495bd9665f5fdc4cc7c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Viorel Emilian Teodorescu</span>
<span class="date">July 8, 2017 at 9:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-405093" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>great article, Jason!</p>
<div class="reply">
<a aria-label="Reply to Viorel Emilian Teodorescu" class="comment-reply-link" href="#comment-405093" onclick='return addComment.moveForm( "comment-405093", "405093", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-405259">
<div class="comment-container" id="li-comment-405259">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 9, 2017 at 10:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-405259" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, I hope it helps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-405259" onclick='return addComment.moveForm( "comment-405259", "405259", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-409220">
<div class="comment-container" id="li-comment-409220">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/69314a0b57f1b141a7e85ff86d5bda98?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/69314a0b57f1b141a7e85ff86d5bda98?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chinesh</span>
<span class="date">August 10, 2017 at 5:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-409220" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>very helpful article !!</p>
<p>I am working on developing an algorithm which will predict the future traffic for the restaurant. The features I am using are: Day,whether there was festival,temperature,climatic condition , current rating,whether there was holiday,service rating,number of reviews etc.Can I solve this problem using time series analysis along with these features,If yes how.<br/>
Please guide me</p>
<div class="reply">
<a aria-label="Reply to Chinesh" class="comment-reply-link" href="#comment-409220" onclick='return addComment.moveForm( "comment-409220", "409220", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-409264">
<div class="comment-container" id="li-comment-409264">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 11, 2017 at 6:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-409264" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This process will guide you:<br/>
<a href="http://machinelearningmastery.com/start-here/#process" rel="nofollow">http://machinelearningmastery.com/start-here/#process</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-409264" onclick='return addComment.moveForm( "comment-409264", "409264", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-410622">
<div class="comment-container" id="li-comment-410622">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7ae5658c180be12d20ffa314d27c213e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7ae5658c180be12d20ffa314d27c213e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hossein</span>
<span class="date">August 23, 2017 at 1:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-410622" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great article Jason. Just a naive question: How does this method different from moving average smoothing? I’m a bit confused!<br/>
Thanks</p>
<div class="reply">
<a aria-label="Reply to Hossein" class="comment-reply-link" href="#comment-410622" onclick='return addComment.moveForm( "comment-410622", "410622", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-410664">
<div class="comment-container" id="li-comment-410664">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 23, 2017 at 6:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-410664" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This post is just about the framing of the problem.</p>
<p>Moving average is something to do to the data once it is framed.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-410664" onclick='return addComment.moveForm( "comment-410664", "410664", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-411247">
<div class="comment-container" id="li-comment-411247">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/95e1d9d824529e06c22bbeaf727e3285?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/95e1d9d824529e06c22bbeaf727e3285?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">pkl520</span>
<span class="date">August 26, 2017 at 10:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-411247" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi , Jason! Good article as always~</p>
<p>I have a question. </p>
<p>“Running the example shows the differentiation of input (t-n) and output (t+n) variables with the current observation (t) considered an output.”</p>
<p>values = [x for x in range(10)]<br/>
data = series_to_supervised(values, 2, 2)<br/>
print(data)</p>
<p>   var1(t-2)  var1(t-1)  var1(t)  var1(t+1)<br/>
2        0.0        1.0        2        3.0<br/>
3        1.0        2.0        3        4.0<br/>
4        2.0        3.0        4        5.0<br/>
5        3.0        4.0        5        6.0<br/>
6        4.0        5.0        6        7.0<br/>
7        5.0        6.0        7        8.0<br/>
8        6.0        7.0        8        9.0</p>
<p>So above example, var1(t-2)  var1(t-1) are input , var1(t)  var1(t+1) are output, am I right?</p>
<p>Then,below example.</p>
<p>raw = DataFrame()<br/>
raw[‘ob1’] = [x for x in range(10)]<br/>
raw[‘ob2’] = [x for x in range(50, 60)]<br/>
values = raw.values<br/>
data = series_to_supervised(values, 1, 2)<br/>
print(data)<br/>
Running the example shows the large reframed DataFrame.</p>
<p>   var1(t-1)  var2(t-1)  var1(t)  var2(t)  var1(t+1)  var2(t+1)<br/>
1        0.0       50.0        1       51        2.0       52.0<br/>
2        1.0       51.0        2       52        3.0       53.0<br/>
3        2.0       52.0        3       53        4.0       54.0<br/>
4        3.0       53.0        4       54        5.0       55.0<br/>
5        4.0       54.0        5       55        6.0       56.0<br/>
6        5.0       55.0        6       56        7.0       57.0<br/>
7        6.0       56.0        7       57        8.0       58.0<br/>
8        7.0       57.0        8       58        9.0       59.0</p>
<p>var1(t-1)  var2(t-1) are input,  var1(t)  var2(t)  var1(t+1)  var2(t+1) are output.</p>
<p>can u answer my question? I will be very appreciate!</p>
<div class="reply">
<a aria-label="Reply to pkl520" class="comment-reply-link" href="#comment-411247" onclick='return addComment.moveForm( "comment-411247", "411247", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-411292">
<div class="comment-container" id="li-comment-411292">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 27, 2017 at 5:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-411292" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, or you can interpret and use the columns any way you wish.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-411292" onclick='return addComment.moveForm( "comment-411292", "411292", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-411711">
<div class="comment-container" id="li-comment-411711">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Thabet</span>
<span class="date">August 30, 2017 at 7:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-411711" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Jason!!<br/>
You are the best teacher ever</p>
<div class="reply">
<a aria-label="Reply to Thabet" class="comment-reply-link" href="#comment-411711" onclick='return addComment.moveForm( "comment-411711", "411711", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-411758">
<div class="comment-container" id="li-comment-411758">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 30, 2017 at 4:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-411758" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Thabet.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-411758" onclick='return addComment.moveForm( "comment-411758", "411758", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-415028">
<div class="comment-container" id="li-comment-415028">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4f5f36c0e18f2ddd78b215c42c07f495?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4f5f36c0e18f2ddd78b215c42c07f495?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Charles</span>
<span class="date">September 29, 2017 at 12:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-415028" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason,</p>
<p>I love your articles! Keep it up! I have a generalization question. In this data set:</p>
<p>   var1(t-1)  var2(t-1)  var1(t)  var2(t)<br/>
1        0.0       50.0        1       51<br/>
2        1.0       51.0        2       52<br/>
3        2.0       52.0        3       53<br/>
4        3.0       53.0        4       54<br/>
5        4.0       54.0        5       55<br/>
6        5.0       55.0        6       56<br/>
7        6.0       56.0        7       57<br/>
8        7.0       57.0        8       58<br/>
9        8.0       58.0        9       59</p>
<p>If I was trying to predict var2(t) from the other 3 data,  would the input data X shape would be (9,1,3) and the target data Y would be (9,1)?  To generalize, what if this was just one instance of multiple time series that I wanted to use. Say I have 1000 instances of time series. Would my data X have the shape (1000,9,3)? And the input target set Y would have shape (1000,9)?</p>
<p>Is my reasoning off? Am I framing my problem the wrong way?</p>
<p>Thanks!<br/>
Charles</p>
<div class="reply">
<a aria-label="Reply to Charles" class="comment-reply-link" href="#comment-415028" onclick='return addComment.moveForm( "comment-415028", "415028", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415044">
<div class="comment-container" id="li-comment-415044">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 29, 2017 at 5:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-415044" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This post provides help regarding how to reshape data for LSTMs:<br/>
<a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" rel="nofollow">https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-415044" onclick='return addComment.moveForm( "comment-415044", "415044", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-415266">
<div class="comment-container" id="li-comment-415266">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f66bd029322bd0e0629e748ce911b95b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f66bd029322bd0e0629e748ce911b95b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sean Maloney</span>
<span class="date">October 1, 2017 at 5:24 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-415266" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason!</p>
<p>I’m really struggling to make a new prediction once the model has been build. Could you give an example? I’ve been trying to write a method that takes the past time data and returns the yhat for the next time.</p>
<p>Thanks you.</p>
<div class="reply">
<a aria-label="Reply to Sean Maloney" class="comment-reply-link" href="#comment-415266" onclick='return addComment.moveForm( "comment-415266", "415266", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415303">
<div class="comment-container" id="li-comment-415303">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 2, 2017 at 9:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-415303" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, see this post:<br/>
<a href="https://machinelearningmastery.com/make-sample-forecasts-arima-python/" rel="nofollow">https://machinelearningmastery.com/make-sample-forecasts-arima-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-415303" onclick='return addComment.moveForm( "comment-415303", "415303", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-415267">
<div class="comment-container" id="li-comment-415267">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f66bd029322bd0e0629e748ce911b95b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f66bd029322bd0e0629e748ce911b95b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sean Maloney</span>
<span class="date">October 1, 2017 at 5:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-415267" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>P.S. I’m the most stuck at how to scale the new input values.</p>
<div class="reply">
<a aria-label="Reply to Sean Maloney" class="comment-reply-link" href="#comment-415267" onclick='return addComment.moveForm( "comment-415267", "415267", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415304">
<div class="comment-container" id="li-comment-415304">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 2, 2017 at 9:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-415304" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Any data transforms performed on training data must be performed on new data for which you want to make a prediction.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-415304" onclick='return addComment.moveForm( "comment-415304", "415304", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-417598">
<div class="comment-container" id="li-comment-417598">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8c62cab1bf8f250254f647432ffd1489?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8c62cab1bf8f250254f647432ffd1489?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nish</span>
<span class="date">October 23, 2017 at 11:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-417598" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
This is great, but what if I have around ten features (say 4 categorical and 6 continuous), a couple of thousand data points per day, around 200 days worth of data in my training set? The shift function could work in theory but you’d be adding hundreds of thousands of columns, which would be computationally horrendous.<br/>
In such situations, what is the recommended approach?</p>
<div class="reply">
<a aria-label="Reply to Nish" class="comment-reply-link" href="#comment-417598" onclick='return addComment.moveForm( "comment-417598", "417598", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417616">
<div class="comment-container" id="li-comment-417616">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 23, 2017 at 4:11 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-417616" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, you will get a lot of columns.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-417616" onclick='return addComment.moveForm( "comment-417616", "417616", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-418686">
<div class="comment-container" id="li-comment-418686">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e51fe8b7253165eeadfa41b4702c380f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e51fe8b7253165eeadfa41b4702c380f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shud</span>
<span class="date">November 1, 2017 at 5:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-418686" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,</p>
<p>I converted my time series problem into regression problem and i used GradientBoostingRegressor to model the data. I see my adjusted R-squared keep changing everytime i run the model. I believe this is because of the correlation that exists between the independent variable (lag variables). How to handle this scenario? Though the range of fluctuation is small, i am concerned that this might be a bad model</p>
<div class="reply">
<a aria-label="Reply to Shud" class="comment-reply-link" href="#comment-418686" onclick='return addComment.moveForm( "comment-418686", "418686", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418730">
<div class="comment-container" id="li-comment-418730">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 2, 2017 at 5:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-418730" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It may be because of the stochastic nature of the algorithm:<br/>
<a href="https://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">https://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-418730" onclick='return addComment.moveForm( "comment-418730", "418730", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-419910">
<div class="comment-container" id="li-comment-419910">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0bcc669c35e96d89395674c516ea5dfe?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0bcc669c35e96d89395674c516ea5dfe?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nitin Gupta</span>
<span class="date">November 13, 2017 at 10:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-419910" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,</p>
<p>I applied the concept that you have explained to my data and used linear regression. Can I expand this concept to polynomial regression also, by squaring the t-1 terms?</p>
<div class="reply">
<a aria-label="Reply to Nitin Gupta" class="comment-reply-link" href="#comment-419910" onclick='return addComment.moveForm( "comment-419910", "419910", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-419948">
<div class="comment-container" id="li-comment-419948">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 14, 2017 at 10:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-419948" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure, let me know how you go.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-419948" onclick='return addComment.moveForm( "comment-419948", "419948", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-420101">
<div class="comment-container" id="li-comment-420101">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1e52973806da42e0e49a29378b23b247?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1e52973806da42e0e49a29378b23b247?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Samuel</span>
<span class="date">November 15, 2017 at 9:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-420101" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,</p>
<p>thanks a lot for your article! I already read a lot of your articles. These articles are great, they really helped me a lot.</p>
<p>But I still have a rather general question, that I can’t seem to wrap my head around.</p>
<p>The question is basically:<br/>
In which case do I treat a supervised learning problem as a time series problem, or vice versa?</p>
<p>For further insight, this is my problem I am currently struggling with:<br/>
I have data out of a factory (hundreds of features), which I can use as my input.<br/>
Additionally I have the energy demand of the factory as my output.<br/>
So I already have a lot of input-output-pairs.<br/>
The energy demand of the factory is also the quantity I want to predict.<br/>
Each data point has its own timestamp.<br/>
I can transform the timestamp into several features to take trends and seasonality into account.<br/>
Subsequently I can use different regression models to predict the energy demand of the factory.<br/>
This would then be a classical supervised regression problem.</p>
<p>But as I unterstood it from your time series articles, I could as well treat the same problem as a time series problem.<br/>
I could use the timestamp to extract time values which I can use in multivariate time series forecasting.</p>
<p>In most examples you gave in your time series articles, you had the output over time.<br/>
<a href="https://machinelearningmastery.com/reframe-time-series-forecasting-problem/" rel="nofollow">https://machinelearningmastery.com/reframe-time-series-forecasting-problem/</a><br/>
And in this article you shifted the time series to get an input, in order to treat the problem as a supervised learning problem.</p>
<p>So let’s suppose you have the same number of features in both cases.<br/>
Is it a promising solution to change the supervised learning problem to a time series problem?<br/>
What would be the benefits and drawbacks of doing this?</p>
<p>As most regression outputs are over time.<br/>
Is there a general rule, when to use which framing(supervised or time series) of the problem?</p>
<p>I hope, that I could phrase my confusion in an ordered fashion.</p>
<p>Thanks a lot for your time and help, I really appreciate it!</p>
<p>Cheers Samuel</p>
<div class="reply">
<a aria-label="Reply to Samuel" class="comment-reply-link" href="#comment-420101" onclick='return addComment.moveForm( "comment-420101", "420101", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-420178">
<div class="comment-container" id="li-comment-420178">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 16, 2017 at 10:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-420178" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>To use supervised learning algorithms you must represent your time series as a supervised learning problem.</p>
<p>Not sure I follow what you mean by tuning a supervised learning problem into a series?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-420178" onclick='return addComment.moveForm( "comment-420178", "420178", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-421614">
<div class="comment-container" id="li-comment-421614">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1e52973806da42e0e49a29378b23b247?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1e52973806da42e0e49a29378b23b247?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Samuel</span>
<span class="date">November 29, 2017 at 10:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-421614" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,</p>
<p>thank you for your fast answer.<br/>
I’m sorry that I couldn’t frame my question comprehensibly, I’m still new to ML.<br/>
I’ll try to explain what I mean with an example.</p>
<p>Let’s suppose you have the following data, I adapted it from your article:<br/>
<a href="https://machinelearningmastery.com/time-series-forecasting-supervised-learning/" rel="nofollow">https://machinelearningmastery.com/time-series-forecasting-supervised-learning/</a></p>
<p>input1(time), input2, output<br/>
1, 0.2, 88<br/>
2, 0.5, 89<br/>
3, 0.7, 87<br/>
4, 0.4, 88<br/>
5, 1.0, 90</p>
<p>This data is, what you would consider a time series. But as you already have 2 inputs and 1 output you could already use the data for supervised machine learning.<br/>
In order to predict future outputs of the data you would have to know input 1 and 2 at timestep 6. Let’s assume you know from your production plan in a factory that the input2 will have a value of 0.8 at timestep 6 (input1). With this data you could gain y_pred from your model. You would have treated the data purely as a supervised machine learning problem.</p>
<p>input1(time), input2, output<br/>
1, 0.2, 88<br/>
2, 0.5, 89<br/>
3, 0.7, 87<br/>
4, 0.4, 88<br/>
5, 1.0, 90<br/>
6, 0.8, y_pred</p>
<p>But you could do time-series forecasting with the same data as well, if I understood your articles correctly.</p>
<p>input1(time), input2, output<br/>
nan, nan, 88<br/>
1, 0.2, 89<br/>
2, 0.5, 87<br/>
3, 0.7, 88<br/>
4, 0.4, 90<br/>
5, 1.0, y_pred</p>
<p>This leads to my questions:</p>
<p>In which case do I treat the data as a supervised learning problem and in which case as a time series problem?<br/>
Is it a promising solution to change the supervised learning problem to a time series problem?<br/>
What would be the benefits and drawbacks of doing this?<br/>
As my regression outputs are over time.<br/>
Is there a general rule, when to use which framing (supervised or time series) of the problem?</p>
<p>I hope, that I stated my questions more clearly.</p>
<p>Thanks a lot in advance for your help!</p>
<p>Best regards Samuel</p>
<div class="reply">
<a aria-label="Reply to Samuel" class="comment-reply-link" href="#comment-421614" onclick='return addComment.moveForm( "comment-421614", "421614", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-421664">
<div class="comment-container" id="li-comment-421664">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 30, 2017 at 8:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-421664" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I follow your first case mostly, but time would not be an input, it would be removed and assumed. I do not follow your second case.</p>
<p>I believe it would be:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca63930c29024633424" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
output(t) = f(input2(t), output(t-1))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca63930c29024633424-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca63930c29024633424-1"><span class="crayon-e">output</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">f</span><span class="crayon-sy">(</span><span class="crayon-e">input2</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">output</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p>What is best for your specific data, I have no idea. Try a suite of different framings (including more or less lag obs) and see which models give the best skill on your problem. That is the only trade-off to consider.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-421664" onclick='return addComment.moveForm( "comment-421664", "421664", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-420382">
<div class="comment-container" id="li-comment-420382">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e24ec8362962de677290f1cdca0c4e72?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e24ec8362962de677290f1cdca0c4e72?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.insightsbot.com" rel="external nofollow">MJ</a></span>
<span class="date">November 18, 2017 at 12:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-420382" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ver helpful, thanks!</p>
<div class="reply">
<a aria-label="Reply to MJ" class="comment-reply-link" href="#comment-420382" onclick='return addComment.moveForm( "comment-420382", "420382", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-420428">
<div class="comment-container" id="li-comment-420428">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 18, 2017 at 10:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-420428" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear it.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-420428" onclick='return addComment.moveForm( "comment-420428", "420428", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-421649">
<div class="comment-container" id="li-comment-421649">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dd88fbdf39d33e2f0d41c4aa8e70efad?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dd88fbdf39d33e2f0d41c4aa8e70efad?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Michael</span>
<span class="date">November 30, 2017 at 6:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-421649" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason:<br/>
Thank you for all the time and effort you have expended to share your knowledge of Deep Learning, Neural Networks, etc.  Nice work.</p>
<p>I have altered your series_to_supervised function in several ways which might be helpfut to other novices:<br/>
(1) the returned column names are based on the original data<br/>
(2) the current period data is always included so that leading and lagging period counts can be 0.<br/>
(3) the selLag and selFut arguments can limit the subset of columns that are shifted.</p>
<p>There is a simple set of test code at the bottom of this listing:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca63930c71649889457" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from pandas import DataFrame
from pandas import concat
import random

def time_series_to_supervised(data, n_lag=1, n_fut=1, selLag=None, selFut=None, dropnan=True):
    """
    Converts a time series to a supervised learning data set by adding time-shifted prior and future period
    data as input or output (i.e., target result) columns for each period
    :param data:  a series of periodic attributes as a list or NumPy array
    :param n_lag: number of PRIOR periods to lag as input (X); generates: Xa(t-1), Xa(t-2); min= 0 --&gt; nothing lagged
    :param n_fut: number of FUTURE periods to add as target output (y); generates Yout(t+1); min= 0 --&gt; no future periods
    :param selLag:  only copy these specific PRIOR period attributes; default= None; EX: ['Xa', 'Xb' ]
    :param selFut:  only copy these specific FUTURE period attributes; default= None; EX: ['rslt', 'xx']
    :param dropnan: True= drop rows with NaN values; default= True
    :return: a Pandas DataFrame of time series data organized for supervised learning
    NOTES:
    (1) The current period's data is always included in the output.
    (2) A suffix is added to the original column names to indicate a relative time reference: e.g., (t) is the current
        period; (t-2) is from two periods in the past; (t+1) is from the next period
    (3) This is an extension of Jason Brownlee's series_to_supervised() function, customized for MFI use
    """
    n_vars = 1 if type(data) is list else data.shape[1]
    df = DataFrame(data)
    origNames = df.columns
    cols, names = list(), list()
    # include all current period attributes
    cols.append(df.shift(0))
    names += [('%s' % origNames[j]) for j in range(n_vars)]

    # lag any past period attributes (t-n_lag,...,t-1)
    n_lag = max(0, n_lag)  # force valid number of lag periods
    for i in range(n_lag, 0, -1):
        suffix= '(t-%d)' % i
        if (None == selLag):   # copy all attributes from PRIOR periods?
            cols.append(df.shift(i))
            names += [('%s%s' % (origNames[j], suffix)) for j in range(n_vars)]
        else:
            for var in (selLag):
                cols.append(df[var].shift(i))
                names+= [('%s%s' % (var, suffix))]

    # include future period attributes (t+1,...,t+n_fut)
    n_fut = max(n_fut, 0)  # force valid number of future periods to shift back
    for i in range(1, n_fut + 1):
        suffix= '(t+%d)' % i
        if (None == selFut):  # copy all attributes from future periods?
            cols.append(df.shift(-i))
            names += [('%s%s' % (origNames[j], suffix)) for j in range(n_vars)]
        else:  # copy only selected future attributes
            for var in (selFut):
                cols.append(df[var].shift(-i))
                names += [('%s%s' % (var, suffix))]
    # combine everything
    agg = concat(cols, axis=1)
    agg.columns = names
    # drop rows with NaN values introduced by lagging
    if dropnan:
        agg.dropna(inplace=True)
    return agg


""" 
def main():    # simple test example
    df= DataFrame()
    df['xa']= [x for x in range(10)]
    df['xb']= [2*x for x in range(10)]
    df['rslt']= random.sample(range(100),10)
    print(df)
    dfx= time_series_to_supervised(df, n_lag= 1, n_fut= 2, dropnan= False, selLag= ['xa'], selFut=['rslt'])
    print (dfx)


if __name__ ==  '__main__':
    main()

"""</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-2">2</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-4">4</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-6">6</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-8">8</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-10">10</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-12">12</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-14">14</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-16">16</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-18">18</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-20">20</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-22">22</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-24">24</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-26">26</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-28">28</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-30">30</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-32">32</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-34">34</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-36">36</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-38">38</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-40">40</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-42">42</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-44">44</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-46">46</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-48">48</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-50">50</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-52">52</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-54">54</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-56">56</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-58">58</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-60">60</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-62">62</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-64">64</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-66">66</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-68">68</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-70">70</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-72">72</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-74">74</div><div class="crayon-num" data-line="crayon-5c0ca63930c71649889457-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930c71649889457-76">76</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca63930c71649889457-1"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">DataFrame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">concat</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-3"><span class="crayon-e">import </span><span class="crayon-e">random</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-4"> </div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-5"><span class="crayon-e">def </span><span class="crayon-e">time_series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_lag</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_fut</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">selLag</span><span class="crayon-o">=</span><span class="crayon-v">None</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">selFut</span><span class="crayon-o">=</span><span class="crayon-v">None</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-6"><span class="crayon-h">    </span><span class="crayon-s">""</span><span class="crayon-s">"</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-7"><span class="crayon-s">    Converts a time series to a supervised learning data set by adding time-shifted prior and future period</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-8"><span class="crayon-s">    data as input or output (i.e., target result) columns for each period</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-9"><span class="crayon-s">    :param data:  a series of periodic attributes as a list or NumPy array</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-10"><span class="crayon-s">    :param n_lag: number of PRIOR periods to lag as input (X); generates: Xa(t-1), Xa(t-2); min= 0 --&gt; nothing lagged</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-11"><span class="crayon-s">    :param n_fut: number of FUTURE periods to add as target output (y); generates Yout(t+1); min= 0 --&gt; no future periods</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-12"><span class="crayon-s">    :param selLag:  only copy these specific PRIOR period attributes; default= None; EX: ['Xa', 'Xb' ]</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-13"><span class="crayon-s">    :param selFut:  only copy these specific FUTURE period attributes; default= None; EX: ['rslt', 'xx']</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-14"><span class="crayon-s">    :param dropnan: True= drop rows with NaN values; default= True</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-15"><span class="crayon-s">    :return: a Pandas DataFrame of time series data organized for supervised learning</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-16"><span class="crayon-s">    NOTES:</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-17"><span class="crayon-s">    (1) The current period's data is always included in the output.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-18"><span class="crayon-s">    (2) A suffix is added to the original column names to indicate a relative time reference: e.g., (t) is the current</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-19"><span class="crayon-s">        period; (t-2) is from two periods in the past; (t+1) is from the next period</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-20"><span class="crayon-s">    (3) This is an extension of Jason Brownlee's series_to_supervised() function, customized for MFI use</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-21"><span class="crayon-s">    "</span><span class="crayon-s">""</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-22"><span class="crayon-h">    </span><span class="crayon-v">n_vars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">type</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">list </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-23"><span class="crayon-h">    </span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-24"><span class="crayon-h">    </span><span class="crayon-v">origNames</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">columns</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-25"><span class="crayon-e">    </span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-26"><span class="crayon-h">    </span><span class="crayon-p"># include all current period attributes</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-27"><span class="crayon-h">    </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-28"><span class="crayon-h">    </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'%s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">origNames</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-29"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-30"><span class="crayon-h">    </span><span class="crayon-p"># lag any past period attributes (t-n_lag,...,t-1)</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-31"><span class="crayon-h">    </span><span class="crayon-v">n_lag</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_lag</span><span class="crayon-sy">)</span><span class="crayon-h">  </span><span class="crayon-p"># force valid number of lag periods</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-32"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_lag</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-33"><span class="crayon-h">        </span><span class="crayon-v">suffix</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'(t-%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-i">i</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-34"><span class="crayon-h">        </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">None</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">selLag</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h">   </span><span class="crayon-p"># copy all attributes from PRIOR periods?</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-35"><span class="crayon-h">            </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-36"><span class="crayon-h">            </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'%s%s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">origNames</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">suffix</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-37"><span class="crayon-h">        </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-38"><span class="crayon-h">            </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">selLag</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-39"><span class="crayon-h">                </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-t">var</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-40"><span class="crayon-h">                </span><span class="crayon-v">names</span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'%s%s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">var</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">suffix</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-41"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-42"><span class="crayon-h">    </span><span class="crayon-p"># include future period attributes (t+1,...,t+n_fut)</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-43"><span class="crayon-h">    </span><span class="crayon-v">n_fut</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-v">n_fut</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h">  </span><span class="crayon-p"># force valid number of future periods to shift back</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-44"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_fut</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-45"><span class="crayon-h">        </span><span class="crayon-v">suffix</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'(t+%d)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-i">i</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-46"><span class="crayon-h">        </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">None</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">selFut</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-p"># copy all attributes from future periods?</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-47"><span class="crayon-h">            </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-48"><span class="crayon-h">            </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'%s%s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">origNames</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">suffix</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_vars</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-49"><span class="crayon-h">        </span><span class="crayon-st">else</span><span class="crayon-o">:</span><span class="crayon-h">  </span><span class="crayon-p"># copy only selected future attributes</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-50"><span class="crayon-h">            </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">selFut</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-51"><span class="crayon-h">                </span><span class="crayon-v">cols</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-t">var</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-52"><span class="crayon-h">                </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'%s%s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">var</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">suffix</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-53"><span class="crayon-h">    </span><span class="crayon-p"># combine everything</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-54"><span class="crayon-h">    </span><span class="crayon-v">agg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-v">cols</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-55"><span class="crayon-h">    </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-56"><span class="crayon-h">    </span><span class="crayon-p"># drop rows with NaN values introduced by lagging</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-57"><span class="crayon-h">    </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">dropnan</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-58"><span class="crayon-h">        </span><span class="crayon-v">agg</span><span class="crayon-sy">.</span><span class="crayon-e">dropna</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-59"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">agg</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-60"> </div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-61"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-62"><span class="crayon-s">""</span><span class="crayon-s">" </span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-63"><span class="crayon-s">def main():    # simple test example</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-64"><span class="crayon-s">    df= DataFrame()</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-65"><span class="crayon-s">    df['xa']= [x for x in range(10)]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-66"><span class="crayon-s">    df['xb']= [2*x for x in range(10)]</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-67"><span class="crayon-s">    df['rslt']= random.sample(range(100),10)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-68"><span class="crayon-s">    print(df)</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-69"><span class="crayon-s">    dfx= time_series_to_supervised(df, n_lag= 1, n_fut= 2, dropnan= False, selLag= ['xa'], selFut=['rslt'])</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-70"><span class="crayon-s">    print (dfx)</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-71"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-72"> </div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-73"><span class="crayon-s">if __name__ ==  '__main__':</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-74"><span class="crayon-s">    main()</span></div><div class="crayon-line" id="crayon-5c0ca63930c71649889457-75"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930c71649889457-76"><span class="crayon-s">"</span><span class="crayon-s">""</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0033 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to Michael" class="comment-reply-link" href="#comment-421649" onclick='return addComment.moveForm( "comment-421649", "421649", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-421676">
<div class="comment-container" id="li-comment-421676">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 30, 2017 at 8:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-421676" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Very cool Michael, thanks for sharing!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-421676" onclick='return addComment.moveForm( "comment-421676", "421676", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-421786">
<div class="comment-container" id="li-comment-421786">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6fcf4acb9cde9fb2d5fd7801caa433b1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6fcf4acb9cde9fb2d5fd7801caa433b1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Maciej</span>
<span class="date">December 1, 2017 at 7:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-421786" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>When I do forecasting, let’s say only one step ahead, as the first input value I should use any value that belongs i.e. to validation data (in order to set up initial state of forecasting). In second, third and so on prediction step I should use previous output of forecasting as input of NN. Do I understand correctly ?</p>
<div class="reply">
<a aria-label="Reply to Maciej" class="comment-reply-link" href="#comment-421786" onclick='return addComment.moveForm( "comment-421786", "421786", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-421823">
<div class="comment-container" id="li-comment-421823">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 1, 2017 at 7:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-421823" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I think so.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-421823" onclick='return addComment.moveForm( "comment-421823", "421823", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-421892">
<div class="comment-container" id="li-comment-421892">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6fcf4acb9cde9fb2d5fd7801caa433b1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6fcf4acb9cde9fb2d5fd7801caa433b1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Maciej</span>
<span class="date">December 2, 2017 at 4:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-421892" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ok, so another question. In the blog post here: <a href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" rel="nofollow">https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/</a>, as an input for NN you use test values. The predictions are only saved to a list and they are not used to predict further values of timeseries.</p>
<p>My question is. Is it possible to predict a series of values knowing only the first value ?<br/>
For example. I train a network to predict values of sine wave. Is it possible to predict next N values of sine wave starting from value zero and feeding NN with result of prediction to predict t + 1, t + 2 etc ?</p>
<div class="reply">
<a aria-label="Reply to Maciej" class="comment-reply-link" href="#comment-421892" onclick='return addComment.moveForm( "comment-421892", "421892", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-4" id="comment-421893">
<div class="comment-container" id="li-comment-421893">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6fcf4acb9cde9fb2d5fd7801caa433b1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6fcf4acb9cde9fb2d5fd7801caa433b1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Maciej</span>
<span class="date">December 2, 2017 at 4:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-421893" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If my above understanding is incorrect then it means that if your test values are completely different than those which were used to train network, we will get even worse predictions.</p>
<div class="reply">
<a aria-label="Reply to Maciej" class="comment-reply-link" href="#comment-421893" onclick='return addComment.moveForm( "comment-421893", "421893", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-421922">
<div class="comment-container" id="li-comment-421922">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 2, 2017 at 9:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-421922" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes. Bad predictions in a recursive model will give even worse subsequent predictions.</p>
<p>Ideally, you want to get ground truth values as inputs.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-421921">
<div class="comment-container" id="li-comment-421921">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 2, 2017 at 9:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-421921" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, this is called multi-step forecasting. Here is an example:<br/>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-421921" onclick='return addComment.moveForm( "comment-421921", "421921", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-421998">
<div class="comment-container" id="li-comment-421998">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6fcf4acb9cde9fb2d5fd7801caa433b1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6fcf4acb9cde9fb2d5fd7801caa433b1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Maciej</span>
<span class="date">December 3, 2017 at 5:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-421998" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Does it mean that using multi-step forecast (let’s say I will predict 4 values) I can predict a timeseries which contains 100 samples providing only initial step (for example providing only first two values of the timeseries) ?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-422090">
<div class="comment-container" id="li-comment-422090">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 4, 2017 at 7:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-422090" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, but I would expect the skill to be poor – it’s a very hard problem to predict so many time steps from so little information.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-426275">
<div class="comment-container" id="li-comment-426275">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fdd50550b48456052fed5a5226bf68f1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fdd50550b48456052fed5a5226bf68f1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Liz</span>
<span class="date">January 12, 2018 at 7:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-426275" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Mr. Brownlee, </p>
<p>thank you for all of your nice tutorials. They really help!<br/>
I have two questions about the input data for an LSTM for multi-step predictions.<br/>
1. If I have multiple features that I use as input for the prediction and at a point (t) I have no new values for any of them. Do I have to predict all my input features in order to make make a multi-step forecast?<br/>
2. If some of my input data is binary data and not continuous can I still predict it with the same LSTM? Or do I need a separate Classification?</p>
<p>Sorry if its very basic, I am quite new to LSTM.<br/>
Best regards Liz</p>
<div class="reply">
<a aria-label="Reply to Liz" class="comment-reply-link" href="#comment-426275" onclick='return addComment.moveForm( "comment-426275", "426275", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-426298">
<div class="comment-container" id="li-comment-426298">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 12, 2018 at 11:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-426298" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, you can use whatever inputs you choose.</p>
<p>Sure you can have binary inputs.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426298" onclick='return addComment.moveForm( "comment-426298", "426298", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-426336">
<div class="comment-container" id="li-comment-426336">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fdd50550b48456052fed5a5226bf68f1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fdd50550b48456052fed5a5226bf68f1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Liz</span>
<span class="date">January 13, 2018 at 1:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-426336" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for your quick answer.<br/>
Unfortunately I still have some trouble with the implementation.<br/>
If I use feature_1 and feature_2 as input for my my LSTM but only predict feature_1 at time (t+1) how do I make the next step to know feature_1 at time (t+2).<br/>
Somehow I seem to miss feature_2 at time (t+1) for this approach.<br/>
Could you tell me where I am off?<br/>
Best regards Liz</p>
<div class="reply">
<a aria-label="Reply to Liz" class="comment-reply-link" href="#comment-426336" onclick='return addComment.moveForm( "comment-426336", "426336", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-426372">
<div class="comment-container" id="li-comment-426372">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 13, 2018 at 5:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-426372" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps double check your input data is complete?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426372" onclick='return addComment.moveForm( "comment-426372", "426372", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-428044">
<div class="comment-container" id="li-comment-428044">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8350e7a8b864f2a8f4642331a8a97644?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8350e7a8b864f2a8f4642331a8a97644?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">strawberry lv</span>
<span class="date">January 31, 2018 at 6:41 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-428044" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello,thank you for the article and i have learned a lot from it.<br/>
Now i have a question about it.<br/>
The method can be understood as using the value before to forecast the next value. If i need to forecast the value at t+1,…t+ N, whether i need to use the model to first forecat the value at t + 1, and then using the value to forecast t+ 2, then, …. until t+N.<br/>
or do you have any aother methed</p>
<div class="reply">
<a aria-label="Reply to strawberry lv" class="comment-reply-link" href="#comment-428044" onclick='return addComment.moveForm( "comment-428044", "428044", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-432418">
<div class="comment-container" id="li-comment-432418">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3f651c2a747521639aa4e99dae2e1687?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3f651c2a747521639aa4e99dae2e1687?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Arslan Ahmed</span>
<span class="date">March 17, 2018 at 9:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-432418" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
I am working on energy consumption data and I have the same question. Did you get to know any efficient method to forecast the value at t+1, t+2, t+3 + …… t+N?</p>
<div class="reply">
<a aria-label="Reply to Arslan Ahmed" class="comment-reply-link" href="#comment-432418" onclick='return addComment.moveForm( "comment-432418", "432418", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-428058">
<div class="comment-container" id="li-comment-428058">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2d0d8b7dab042f768a39ba9b49e681d6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2d0d8b7dab042f768a39ba9b49e681d6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sameer</span>
<span class="date">January 31, 2018 at 11:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-428058" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Dr.Brownlee,</p>
<p>I’m planning to purchase your Introduction to Time series forecasting book. I just want to know that if you’ve covered Multivariate cum multistep LSTM</p>
<div class="reply">
<a aria-label="Reply to Sameer" class="comment-reply-link" href="#comment-428058" onclick='return addComment.moveForm( "comment-428058", "428058", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-428092">
<div class="comment-container" id="li-comment-428092">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 1, 2018 at 7:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-428092" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, only univariate.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-428092" onclick='return addComment.moveForm( "comment-428092", "428092", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-430073">
<div class="comment-container" id="li-comment-430073">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/711f286ece117e00eb1a962ae8ad1e0b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/711f286ece117e00eb1a962ae8ad1e0b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Victor</span>
<span class="date">February 21, 2018 at 5:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-430073" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for the article. I have a question about going back n periods in terms of choosing the features. If I have a feature and make for example 5 new features based off of some lag time, my new features are all very highly correlated (between 0.7 and 0.95). My model is resulting in training score of 1 and test score of 0.99. I’m concerned that there is an issue with multicollinearity between all the lag features that is causing my model to overfit. Is this a legitimate concern and how could I go about fixing it if so? Thanks!</p>
<div class="reply">
<a aria-label="Reply to Victor" class="comment-reply-link" href="#comment-430073" onclick='return addComment.moveForm( "comment-430073", "430073", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-430109">
<div class="comment-container" id="li-comment-430109">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 21, 2018 at 6:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-430109" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Try removing correlated features, train a new model and compare model skill.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430109" onclick='return addComment.moveForm( "comment-430109", "430109", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-430121">
<div class="comment-container" id="li-comment-430121">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/35280721b223b9bfa74fc496c68372ab?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/35280721b223b9bfa74fc496c68372ab?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ram Seshadri</span>
<span class="date">February 21, 2018 at 12:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-430121" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason:</p>
<p>My sincere thanks for all you do. Your blogs were very helpful when I started on the ML journey. </p>
<p>I read this blog post for a Time Series problem I was working on. While I liked the “series_to_supervised”  function, I typically use data frames to store and retrieve data while working in ML. Hence, I thought I would modify the code to send in a dataframe and get back a dataframe with just the new columns added. Please take a look at my revised code.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca63930998301380995" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
def ts_dataframe_to_supervised(df, target, n_in=1, n_out=1, dropT=True):
    """
    Transform a time series dataframe into a supervised learning dataset.
    Arguments:
        df: a dataframe.
        target: this is the target variable you intend to use in supervised learning
        n_in: Number of lag observations as input (X).
        n_out: Number of observations as output (y).
        dropT: Boolean - whether or not to drop columns at time "t".
    Returns:
        Pandas DataFrame of series framed for supervised learning.
    """
    namevars = df.columns.tolist()
    # input sequence (t-n, ... t-1)
    drops = []
    for i in range(n_in, -1, -1):
        if i == 0:
            for var in namevars:
                addname = var+'(t)'
                df.rename(columns={var:addname},inplace=True)
                drops.append(addname)
        else:
            for var in namevars:
                addname = var+'(t-'+str(i)+')'
                df[addname] = df[var].shift(i)
    # forecast sequence (t, t+1, ... t+n)
    if n_out == 0:
        n_out = False
    for i in range(1, n_out):
        for var in namevars:
            addname = var+'(t+'+str(i)+')'
            df[addname] = df[var].shift(-i)
    # drop rows with NaN values
    df.dropna(inplace=True,axis=0)
    # put it all together
    target = target+'(t)'
    if dropT:
        drops.remove(target)
        df.drop(drops, axis=1, inplace=True)
    preds = [x for x in list(df) if x not in [target]] 
    return df, target, preds</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca63930998301380995-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930998301380995-2">2</div><div class="crayon-num" data-line="crayon-5c0ca63930998301380995-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930998301380995-4">4</div><div class="crayon-num" data-line="crayon-5c0ca63930998301380995-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930998301380995-6">6</div><div class="crayon-num" data-line="crayon-5c0ca63930998301380995-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930998301380995-8">8</div><div class="crayon-num" data-line="crayon-5c0ca63930998301380995-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930998301380995-10">10</div><div class="crayon-num" data-line="crayon-5c0ca63930998301380995-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930998301380995-12">12</div><div class="crayon-num" data-line="crayon-5c0ca63930998301380995-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930998301380995-14">14</div><div class="crayon-num" data-line="crayon-5c0ca63930998301380995-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930998301380995-16">16</div><div class="crayon-num" data-line="crayon-5c0ca63930998301380995-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930998301380995-18">18</div><div class="crayon-num" data-line="crayon-5c0ca63930998301380995-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930998301380995-20">20</div><div class="crayon-num" data-line="crayon-5c0ca63930998301380995-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930998301380995-22">22</div><div class="crayon-num" data-line="crayon-5c0ca63930998301380995-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930998301380995-24">24</div><div class="crayon-num" data-line="crayon-5c0ca63930998301380995-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930998301380995-26">26</div><div class="crayon-num" data-line="crayon-5c0ca63930998301380995-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930998301380995-28">28</div><div class="crayon-num" data-line="crayon-5c0ca63930998301380995-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930998301380995-30">30</div><div class="crayon-num" data-line="crayon-5c0ca63930998301380995-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930998301380995-32">32</div><div class="crayon-num" data-line="crayon-5c0ca63930998301380995-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930998301380995-34">34</div><div class="crayon-num" data-line="crayon-5c0ca63930998301380995-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930998301380995-36">36</div><div class="crayon-num" data-line="crayon-5c0ca63930998301380995-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930998301380995-38">38</div><div class="crayon-num" data-line="crayon-5c0ca63930998301380995-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930998301380995-40">40</div><div class="crayon-num" data-line="crayon-5c0ca63930998301380995-41">41</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca63930998301380995-1"><span class="crayon-e">def </span><span class="crayon-e">ts_dataframe_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">target</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_in</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropT</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930998301380995-2"><span class="crayon-h">    </span><span class="crayon-s">""</span><span class="crayon-s">"</span></div><div class="crayon-line" id="crayon-5c0ca63930998301380995-3"><span class="crayon-s">    Transform a time series dataframe into a supervised learning dataset.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930998301380995-4"><span class="crayon-s">    Arguments:</span></div><div class="crayon-line" id="crayon-5c0ca63930998301380995-5"><span class="crayon-s">        df: a dataframe.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930998301380995-6"><span class="crayon-s">        target: this is the target variable you intend to use in supervised learning</span></div><div class="crayon-line" id="crayon-5c0ca63930998301380995-7"><span class="crayon-s">        n_in: Number of lag observations as input (X).</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930998301380995-8"><span class="crayon-s">        n_out: Number of observations as output (y).</span></div><div class="crayon-line" id="crayon-5c0ca63930998301380995-9"><span class="crayon-s">        dropT: Boolean - whether or not to drop columns at time "</span><span class="crayon-i">t</span><span class="crayon-s">".</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930998301380995-10"><span class="crayon-s">    Returns:</span></div><div class="crayon-line" id="crayon-5c0ca63930998301380995-11"><span class="crayon-s">        Pandas DataFrame of series framed for supervised learning.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930998301380995-12"><span class="crayon-s">    "</span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5c0ca63930998301380995-13"><span class="crayon-h">    </span><span class="crayon-v">namevars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">.</span><span class="crayon-e">tolist</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930998301380995-14"><span class="crayon-h">    </span><span class="crayon-p"># input sequence (t-n, ... t-1)</span></div><div class="crayon-line" id="crayon-5c0ca63930998301380995-15"><span class="crayon-h">    </span><span class="crayon-v">drops</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930998301380995-16"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca63930998301380995-17"><span class="crayon-h">        </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930998301380995-18"><span class="crayon-h">            </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">namevars</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca63930998301380995-19"><span class="crayon-h">                </span><span class="crayon-v">addname</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">var</span><span class="crayon-o">+</span><span class="crayon-s">'(t)'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930998301380995-20"><span class="crayon-h">                </span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">rename</span><span class="crayon-sy">(</span><span class="crayon-v">columns</span><span class="crayon-o">=</span><span class="crayon-sy">{</span><span class="crayon-t">var</span><span class="crayon-o">:</span><span class="crayon-v">addname</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca63930998301380995-21"><span class="crayon-h">                </span><span class="crayon-v">drops</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">addname</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930998301380995-22"><span class="crayon-h">        </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca63930998301380995-23"><span class="crayon-h">            </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">namevars</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930998301380995-24"><span class="crayon-h">                </span><span class="crayon-v">addname</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">var</span><span class="crayon-o">+</span><span class="crayon-s">'(t-'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-s">')'</span></div><div class="crayon-line" id="crayon-5c0ca63930998301380995-25"><span class="crayon-h">                </span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-v">addname</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-t">var</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930998301380995-26"><span class="crayon-h">    </span><span class="crayon-p"># forecast sequence (t, t+1, ... t+n)</span></div><div class="crayon-line" id="crayon-5c0ca63930998301380995-27"><span class="crayon-h">    </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930998301380995-28"><span class="crayon-h">        </span><span class="crayon-v">n_out</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line" id="crayon-5c0ca63930998301380995-29"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930998301380995-30"><span class="crayon-h">        </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">var</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">namevars</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca63930998301380995-31"><span class="crayon-h">            </span><span class="crayon-v">addname</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">var</span><span class="crayon-o">+</span><span class="crayon-s">'(t+'</span><span class="crayon-o">+</span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-s">')'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930998301380995-32"><span class="crayon-h">            </span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-v">addname</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-t">var</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca63930998301380995-33"><span class="crayon-h">    </span><span class="crayon-p"># drop rows with NaN values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930998301380995-34"><span class="crayon-h">    </span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">dropna</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca63930998301380995-35"><span class="crayon-h">    </span><span class="crayon-p"># put it all together</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930998301380995-36"><span class="crayon-h">    </span><span class="crayon-v">target</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">target</span><span class="crayon-o">+</span><span class="crayon-s">'(t)'</span></div><div class="crayon-line" id="crayon-5c0ca63930998301380995-37"><span class="crayon-h">    </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">dropT</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930998301380995-38"><span class="crayon-h">        </span><span class="crayon-v">drops</span><span class="crayon-sy">.</span><span class="crayon-e">remove</span><span class="crayon-sy">(</span><span class="crayon-v">target</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca63930998301380995-39"><span class="crayon-h">        </span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">drops</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930998301380995-40"><span class="crayon-h">    </span><span class="crayon-v">preds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">target</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5c0ca63930998301380995-41"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">target</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">preds</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0022 seconds] -->
<p></p>
<p>Usage:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6393099c167244031" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
df, target,preds = ts_dataframe_to_supervised(df, target, 1, 0, False)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6393099c167244031-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6393099c167244031-1"><span class="crayon-v">df</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">target</span><span class="crayon-sy">,</span><span class="crayon-v">preds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ts_dataframe_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">target</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>Please take a look and let me know. Hope this helps others,<br/>
Ram</p>
<div class="reply">
<a aria-label="Reply to Ram Seshadri" class="comment-reply-link" href="#comment-430121" onclick='return addComment.moveForm( "comment-430121", "430121", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-430194">
<div class="comment-container" id="li-comment-430194">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 22, 2018 at 11:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-430194" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Very cool Ram, thanks for sharing!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430194" onclick='return addComment.moveForm( "comment-430194", "430194", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-430559">
<div class="comment-container" id="li-comment-430559">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7709a5a5c679b007b7dbf8060a139afc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7709a5a5c679b007b7dbf8060a139afc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Marius Terblanche</span>
<span class="date">February 26, 2018 at 11:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-430559" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,<br/>
great article, as always!<br/>
May I ask a question, please?<br/>
Once the time series data (say for multi-step, univariate forecasting) have been prepared using code described above, is it then ready (and in the 3D structure) required for feeding into the first hidden layer of a LSTM RNN?<br/>
May be dumb question!<br/>
Many thanks in advance.<br/>
Marius.</p>
<div class="reply">
<a aria-label="Reply to Marius Terblanche" class="comment-reply-link" href="#comment-430559" onclick='return addComment.moveForm( "comment-430559", "430559", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-430595">
<div class="comment-container" id="li-comment-430595">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 27, 2018 at 6:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-430595" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It really depends on your data and your framing of the problem.</p>
<p>The output will be 2D, you may still need to make it 3D. See this post:<br/>
<a href="https://machinelearningmastery.com/prepare-univariate-time-series-data-long-short-term-memory-networks/" rel="nofollow">https://machinelearningmastery.com/prepare-univariate-time-series-data-long-short-term-memory-networks/</a></p>
<p>And this post:<br/>
<a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" rel="nofollow">https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430595" onclick='return addComment.moveForm( "comment-430595", "430595", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-431440">
<div class="comment-container" id="li-comment-431440">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f2db260d6a416d54888a51b252a30d1c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f2db260d6a416d54888a51b252a30d1c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">MikeF</span>
<span class="date">March 7, 2018 at 12:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-431440" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thanks for this post. Its simple enough to understand. However, after converting my time series data I found some feature values are from the future and won’t be available when trying to make predictions. How do you suggest I work around?</p>
<div class="reply">
<a aria-label="Reply to MikeF" class="comment-reply-link" href="#comment-431440" onclick='return addComment.moveForm( "comment-431440", "431440", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-431455">
<div class="comment-container" id="li-comment-431455">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 7, 2018 at 3:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-431455" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps remove those features?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-431455" onclick='return addComment.moveForm( "comment-431455", "431455", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-433357">
<div class="comment-container" id="li-comment-433357">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3bb36d519799fcd2e61f1993be438331?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3bb36d519799fcd2e61f1993be438331?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Adarsh</span>
<span class="date">March 27, 2018 at 3:11 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-433357" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>i have  a dataset liike this </p>
<p>accno     dateofvisit<br/>
12345     12/05/15 9:00:00<br/>
123345    13/06/15 13:00:00<br/>
12345      12/05/15  13:00:00</p>
<p>how will i forecast when that customer will visit again</p>
<div class="reply">
<a aria-label="Reply to Adarsh" class="comment-reply-link" href="#comment-433357" onclick='return addComment.moveForm( "comment-433357", "433357", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-433378">
<div class="comment-container" id="li-comment-433378">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 27, 2018 at 4:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-433378" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can get started with time series forecasting here:<br/>
<a href="https://machinelearningmastery.com/start-here/#timeseries" rel="nofollow">https://machinelearningmastery.com/start-here/#timeseries</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-433378" onclick='return addComment.moveForm( "comment-433378", "433378", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-434646">
<div class="comment-container" id="li-comment-434646">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fe54daefee7adb1f2af7be4684b73f77?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fe54daefee7adb1f2af7be4684b73f77?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Fatima</span>
<span class="date">April 10, 2018 at 6:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-434646" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>I need to develop input vector which uses every 30 minutes prior to time t for example:</p>
<p> input vector is like (t-30,t-60,t-90,…,t-240) to predict t. </p>
<p>If I wanna use your function for my task, Is it correct to change the shift function to df.shift(3*i) ?</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Fatima" class="comment-reply-link" href="#comment-434646" onclick='return addComment.moveForm( "comment-434646", "434646", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-434689">
<div class="comment-container" id="li-comment-434689">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 11, 2018 at 6:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-434689" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>One approach might be to selectively retrieve/remove columns after the transform.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-434689" onclick='return addComment.moveForm( "comment-434689", "434689", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-434833">
<div class="comment-container" id="li-comment-434833">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fe54daefee7adb1f2af7be4684b73f77?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fe54daefee7adb1f2af7be4684b73f77?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">fatima</span>
<span class="date">April 12, 2018 at 7:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-434833" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>So I should take these steps:</p>
<p>1- transform for different lags<br/>
2-select column related to first lag (for example 30min(<br/>
3- transform for other lags<br/>
4- concatenate along axis=1 </p>
<p>When I perform such steps seems the result is equivalent to when I shift by 3?<br/>
I have some questions<br/>
which one is better to use?(Shift by 3 or do above steps)<br/>
should I remove time t after each transform and just keep time t for last lag?</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to fatima" class="comment-reply-link" href="#comment-434833" onclick='return addComment.moveForm( "comment-434833", "434833", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-434877">
<div class="comment-container" id="li-comment-434877">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 13, 2018 at 6:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-434877" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Use an approach that you feel makes the most sense for your problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-434877" onclick='return addComment.moveForm( "comment-434877", "434877", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-435139">
<div class="comment-container" id="li-comment-435139">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2b7ba0d0f2f43ac6669110ea025f6b90?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2b7ba0d0f2f43ac6669110ea025f6b90?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vishwas</span>
<span class="date">April 16, 2018 at 3:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-435139" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>Amazing article for creating supervised series. But I have a doubt,<br/>
Suppose If I wanted the predict sales for next 14 days using Daily sales historical data. Would that require me too take 14 lags to predict the next 14 days??<br/>
Ex: (t-14, t-13 …..t-1) to predict (t,t+1,t+2,t+14)</p>
<div class="reply">
<a aria-label="Reply to vishwas" class="comment-reply-link" href="#comment-435139" onclick='return addComment.moveForm( "comment-435139", "435139", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-435181">
<div class="comment-container" id="li-comment-435181">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 17, 2018 at 5:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-435181" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, the in/out obs are separate. You could have 1 input and 14 outputs if you really wanted.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435181" onclick='return addComment.moveForm( "comment-435181", "435181", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-435238">
<div class="comment-container" id="li-comment-435238">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ccac25358ff5f928f5a7c8c29ce771fc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ccac25358ff5f928f5a7c8c29ce771fc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vishwas</span>
<span class="date">April 17, 2018 at 3:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-435238" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the quick response Jason!!</p>
<div class="reply">
<a aria-label="Reply to Vishwas" class="comment-reply-link" href="#comment-435238" onclick='return addComment.moveForm( "comment-435238", "435238", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-435206">
<div class="comment-container" id="li-comment-435206">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/03782ff32c1aaa0314d3a8839006ef8f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/03782ff32c1aaa0314d3a8839006ef8f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sanketh Nagarajan</span>
<span class="date">April 17, 2018 at 8:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-435206" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I want to predict if the next value will be higher or lower than the previous value. Can I use the same method to frame it as a classification problem?<br/>
For example:</p>
<p> V(t) class</p>
<p> 0.2  0<br/>
 0.3  1<br/>
 0.1  0<br/>
 0.5  0<br/>
 2.0  1<br/>
 1.5  0</p>
<p>where class zero represents a decrease and class 1 represents an increase?</p>
<p>Thanks,<br/>
Sanketh</p>
<div class="reply">
<a aria-label="Reply to Sanketh Nagarajan" class="comment-reply-link" href="#comment-435206" onclick='return addComment.moveForm( "comment-435206", "435206", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-435225">
<div class="comment-container" id="li-comment-435225">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 17, 2018 at 2:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-435225" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435225" onclick='return addComment.moveForm( "comment-435225", "435225", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-436836">
<div class="comment-container" id="li-comment-436836">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7d85a7c05681c52ea4fcd6d4bab0d3cf?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7d85a7c05681c52ea4fcd6d4bab0d3cf?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">brandon</span>
<span class="date">May 7, 2018 at 11:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-436836" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, really nice explanations in your blog. When I have the shape e.g. (180,20) of a shifted dataframe, how can I come back to my original data back with shape (200,1) back ?</p>
<div class="reply">
<a aria-label="Reply to brandon" class="comment-reply-link" href="#comment-436836" onclick='return addComment.moveForm( "comment-436836", "436836", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-436874">
<div class="comment-container" id="li-comment-436874">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 8, 2018 at 6:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-436874" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You will have to write custom code to reverse the transform.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436874" onclick='return addComment.moveForm( "comment-436874", "436874", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-436943">
<div class="comment-container" id="li-comment-436943">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/36bb3870bc5c3b119b26b77ad25d1dbd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/36bb3870bc5c3b119b26b77ad25d1dbd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Farooq Arshad</span>
<span class="date">May 8, 2018 at 8:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-436943" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Amazing article.<br/>
I have a question, Suppose I want to move the window by 24 steps instead of just one step, what modifications do I have to do in this case?<br/>
Like i have Energy data with one hour interval and I want to predict next 24 hours (1 day) looking at last 21 days (504 hours) then for the next prediction i want to move window by 24 hours (1 day).</p>
<div class="reply">
<a aria-label="Reply to Farooq Arshad" class="comment-reply-link" href="#comment-436943" onclick='return addComment.moveForm( "comment-436943", "436943", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-436987">
<div class="comment-container" id="li-comment-436987">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 9, 2018 at 6:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-436987" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps re-read the description of the function to understand what arguments to provide to the function.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436987" onclick='return addComment.moveForm( "comment-436987", "436987", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-437914">
<div class="comment-container" id="li-comment-437914">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bb14f16e3eead89df91ea2553aa45896?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bb14f16e3eead89df91ea2553aa45896?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex</span>
<span class="date">May 19, 2018 at 5:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-437914" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Models blindly fit on data specified like this are guaranteed to overfit.</p>
<p>Suppose you estimate model performance with a cross-validation procedure and you have folds:</p>
<p>Fold1 (January)<br/>
Fold2 (February)<br/>
Fold3 (March)<br/>
Fold4 (April)</p>
<p>Consider a model fit on folds 1, 2 and 4. Now you predicting some feature for March based on the value of that feature in April!</p>
<p>If you choose to use a lagged regressor matrix like this, please please please look into appropriate model validation.</p>
<p>One good reason is Hyndman’s textbook, available freely online: <a href="https://otexts.org/fpp2/accuracy.html" rel="nofollow">https://otexts.org/fpp2/accuracy.html</a></p>
<div class="reply">
<a aria-label="Reply to Alex" class="comment-reply-link" href="#comment-437914" onclick='return addComment.moveForm( "comment-437914", "437914", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-437935">
<div class="comment-container" id="li-comment-437935">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 19, 2018 at 7:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-437935" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Indeed, one should never use cross validation for time series.</p>
<p>Instead, one would use walk-forward validation:<br/>
<a href="https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437935" onclick='return addComment.moveForm( "comment-437935", "437935", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-438309">
<div class="comment-container" id="li-comment-438309">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0213e5a21c70a3d998f03fa55e2a8520?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0213e5a21c70a3d998f03fa55e2a8520?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">marc</span>
<span class="date">May 23, 2018 at 10:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-438309" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, really nice blog and learned much from you. I implement one LSTM encoder decoder with sliding windows. The prediction was nearly the same as the input, is it usual that this happens on sliding windows ? I am a bit surprised because the model saw only in the training a little part of data and the model later predicted almost the same input. That makes me thinking I might be wrong. I do not want to post the coding it ist just standard lstm encoder decoder code, but the fact that the model saw only a little part of the data in training is confusing me.</p>
<div class="reply">
<a aria-label="Reply to marc" class="comment-reply-link" href="#comment-438309" onclick='return addComment.moveForm( "comment-438309", "438309", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-438327">
<div class="comment-container" id="li-comment-438327">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 23, 2018 at 2:39 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-438327" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It sounds like the model learned a persistence forecast, it might suggest further tuning is required. I outline more on this here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/why-is-my-forecasted-time-series-right-behind-the-actual-time-series" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-is-my-forecasted-time-series-right-behind-the-actual-time-series</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-438327" onclick='return addComment.moveForm( "comment-438327", "438327", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-438319">
<div class="comment-container" id="li-comment-438319">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fa661b0ff84cf4626e737690c3d7df15?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fa661b0ff84cf4626e737690c3d7df15?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">james</span>
<span class="date">May 23, 2018 at 1:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-438319" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>HI json，it’s so good your code,but i have a question that i change the window size(reframed = series_to_supervised(scaled, 1, 1) to reframed = series_to_supervised(scaled, 2, 1)),then i get bad prediction,how can i solve or what cause it<br/>
Please take a look at my revised code.</p>
<p>from math import sqrt<br/>
from numpy import concatenate<br/>
from matplotlib import pyplot<br/>
from pandas import read_csv<br/>
from pandas import DataFrame<br/>
from pandas import concat<br/>
from sklearn.preprocessing import MinMaxScaler<br/>
from sklearn.preprocessing import LabelEncoder<br/>
from sklearn.metrics import mean_squared_error<br/>
from keras.models import Sequential<br/>
from keras.layers import Dense<br/>
from keras.layers import LSTM<br/>
# convert series to supervised learning<br/>
def series_to_supervised(data, n_in=1, n_out=1, dropnan=True):<br/>
	n_vars = 1 if type(data) is list else data.shape[1]<br/>
	df = DataFrame(data)<br/>
	cols, names = list(), list()<br/>
	# input sequence (t-n, … t-1)<br/>
	for i in range(n_in, 0, -1):<br/>
		cols.append(df.shift(i))<br/>
		names += [(‘var%d(t-%d)’ % (j+1, i)) for j in range(n_vars)]<br/>
	# forecast sequence (t, t+1, … t+n)<br/>
	for i in range(0, n_out):<br/>
		cols.append(df.shift(-i))<br/>
		if i == 0:<br/>
			names += [(‘var%d(t)’ % (j+1)) for j in range(n_vars)]<br/>
		else:<br/>
			names += [(‘var%d(t+%d)’ % (j+1, i)) for j in range(n_vars)]<br/>
	# put it all together<br/>
	agg = concat(cols, axis=1)<br/>
	agg.columns = names<br/>
	# drop rows with NaN values<br/>
	if dropnan:<br/>
		agg.dropna(inplace=True)<br/>
	return agg<br/>
# load dataset<br/>
dataset = read_csv(‘pollution.csv’, header=0, index_col=0)<br/>
values = dataset.values</p>
<p># integer encode direction</p>
<p>encoder = LabelEncoder()<br/>
values[:,4] = encoder.fit_transform(values[:,4])</p>
<p># ensure all data is float<br/>
values = values.astype(‘float32′)</p>
<p># normalize features<br/>
scaler = MinMaxScaler(feature_range=(0, 1))<br/>
scaled = scaler.fit_transform(values)</p>
<p># frame as supervised learning<br/>
reframed = series_to_supervised(scaled, 2, 1)<br/>
# drop columns we don’t want to predict<br/>
reframed.drop(reframed.columns[[9,10,11,12,13,14,15]], axis=1, inplace=True)<br/>
print(reframed.head())</p>
<p># split into train and test sets<br/>
values = reframed.values<br/>
n_train_hours = 365*24<br/>
train = values[:n_train_hours, :]<br/>
test = values[n_train_hours:, :]</p>
<p># split into input and outputs<br/>
train_X, train_y = train[:, :-1], train[:, -1]<br/>
test_X, test_y = test[:, :-1], test[:, -1]</p>
<p># reshape input to be 3D [samples, timesteps, features]<br/>
train_X = train_X.reshape((train_X.shape[0], 1, train_X.shape[1]))<br/>
test_X = test_X.reshape((test_X.shape[0], 1, test_X.shape[1]))<br/>
print(train_X.shape, train_y.shape, test_X.shape, test_y.shape)</p>
<p># design network<br/>
model = Sequential()<br/>
model.add(LSTM(50, input_shape=(train_X.shape[1], train_X.shape[2])))<br/>
model.add(Dense(1))<br/>
model.compile(loss=’mae’, optimizer=’adam’)<br/>
# fit network<br/>
history = model.fit(train_X, train_y, epochs=50, batch_size=72, validation_data=(test_X, test_y), verbose=2, shuffle=False)<br/>
# plot history<br/>
pyplot.plot(history.history[‘loss’], label=’train’)<br/>
pyplot.plot(history.history[‘val_loss’], label=’test’)<br/>
pyplot.legend()<br/>
pyplot.show()<br/>
# make a prediction<br/>
yhat = model.predict(test_X)<br/>
test_X = test_X.reshape((test_X.shape[0], test_X.shape[2]))<br/>
# invert scaling for forecast<br/>
inv_yhat = concatenate((yhat, test_X[:, 1:8]), axis=1)<br/>
inv_yhat = scaler.inverse_transform(inv_yhat)<br/>
inv_yhat = inv_yhat[:,0]<br/>
# invert scaling for actual<br/>
inv_y = scaler.inverse_transform(test_X[:,:8])<br/>
inv_y = inv_y[:,0]<br/>
# calculate RMSE<br/>
rmse = sqrt(mean_squared_error(inv_y, inv_yhat))<br/>
print(‘Test RMSE: %.3f’ % rmse)<br/>
# plot prediction and actual<br/>
pyplot.plot(inv_yhat[:100], label=’prediction’)<br/>
pyplot.plot(inv_y[:100], label=’actual’)<br/>
pyplot.legend()<br/>
pyplot.show()</p>
<div class="reply">
<a aria-label="Reply to james" class="comment-reply-link" href="#comment-438319" onclick='return addComment.moveForm( "comment-438319", "438319", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-438329">
<div class="comment-container" id="li-comment-438329">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 23, 2018 at 2:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-438329" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The model may require further tuning for the change in problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-438329" onclick='return addComment.moveForm( "comment-438329", "438329", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-438339">
<div class="comment-container" id="li-comment-438339">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fa661b0ff84cf4626e737690c3d7df15?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fa661b0ff84cf4626e737690c3d7df15?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">james</span>
<span class="date">May 23, 2018 at 4:51 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-438339" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I noticed that your code takes into account the effect of the last point in time on the current point in time.But this is not applicable in many cases. What are the optimization ideas?</p>
<div class="reply">
<a aria-label="Reply to james" class="comment-reply-link" href="#comment-438339" onclick='return addComment.moveForm( "comment-438339", "438339", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-438403">
<div class="comment-container" id="li-comment-438403">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 24, 2018 at 8:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-438403" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Most approaches assume that the observation at t is a function of prior time steps (t-1, t-2, …). Why do you think this is not the case?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-438403" onclick='return addComment.moveForm( "comment-438403", "438403", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-438428">
<div class="comment-container" id="li-comment-438428">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/97df32586ef8d4d71a43c30caae6f673?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/97df32586ef8d4d71a43c30caae6f673?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">james</span>
<span class="date">May 24, 2018 at 11:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-438428" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>oh,maybe i don’t describe my question clearly,my question is why just consider t-1,when consider(t-1,t-2,t-3),the example you gave has poor performance</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-438440">
<div class="comment-container" id="li-comment-438440">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 24, 2018 at 1:51 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-438440" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No good reason, just demonstration. You may change the model to include any set of features you wish.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-438444">
<div class="comment-container" id="li-comment-438444">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/07e0ed394ea637f594d55289b7bf41c6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/07e0ed394ea637f594d55289b7bf41c6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ishrat Sarwar</span>
<span class="date">May 24, 2018 at 2:21 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-438444" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Sir:<br/>
              I have 70 input time series. I Only need to predict 1, 2 or 3 time series out of input(70 features) time series. Here are my questions.</p>
<p>-&gt; Should I use LSTM for such problem?<br/>
-&gt; Should I predict all 70 of time series?<br/>
-&gt; If not LSTM then what approach should I use?</p>
<p>(Forex trading prediction problem)</p>
<div class="reply">
<a aria-label="Reply to Ishrat Sarwar" class="comment-reply-link" href="#comment-438444" onclick='return addComment.moveForm( "comment-438444", "438444", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-438546">
<div class="comment-container" id="li-comment-438546">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 25, 2018 at 9:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-438546" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great questions!</p>
<p>– Try a suite of methods to see what works.<br/>
– Try different amounts of history and different numbers of forward time steps, find a sweet spot suitable for your project goals.<br/>
– Try classical ts methods, ml methods and dl methods.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-438546" onclick='return addComment.moveForm( "comment-438546", "438546", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-439408">
<div class="comment-container" id="li-comment-439408">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/48a01b92f8306ea490e9e5f1ed311e34?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/48a01b92f8306ea490e9e5f1ed311e34?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">marc</span>
<span class="date">June 1, 2018 at 6:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-439408" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>HI Jason, I have a huge data with small steps between data time series, they nearly change not in total till the last cycles. I thought maybe not only shifting by 1, how can I shiift more e.g. t-1 and t by 20 steps. Does also this make sense ?</p>
<div class="reply">
<a aria-label="Reply to marc" class="comment-reply-link" href="#comment-439408" onclick='return addComment.moveForm( "comment-439408", "439408", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-439471">
<div class="comment-container" id="li-comment-439471">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2018 at 6:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-439471" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not sure I follow, sorry. Perhaps give a small example?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-439471" onclick='return addComment.moveForm( "comment-439471", "439471", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-439544">
<div class="comment-container" id="li-comment-439544">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/48a01b92f8306ea490e9e5f1ed311e34?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/48a01b92f8306ea490e9e5f1ed311e34?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">marc</span>
<span class="date">June 2, 2018 at 9:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-439544" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>lets say I have this data:</p>
<p>5<br/>
6<br/>
7<br/>
8<br/>
9<br/>
10<br/>
11<br/>
12<br/>
and usually if you make sliding windows, shifting them by 1 from t-2 to t<br/>
5 6 7<br/>
6 7 8<br/>
7 8 9<br/>
8 9 10<br/>
9 10 11<br/>
10 11 12<br/>
11 12<br/>
12 </p>
<p>how can I do shifting not by 1 but maybe 3 looking at the first row (in this case) or more from t-2 to t:<br/>
5 8 11<br/>
6 9 12<br/>
7 10<br/>
8 11<br/>
9  12<br/>
10<br/>
11<br/>
12</p>
<p>I ask that because my data range is so small that shifting by 1 is not having much effect and thought maybe something like this could help. How do I have to adjust your codes for supervised learning to do that. And do you think this is a good idea ?</p>
<div class="reply">
<a aria-label="Reply to marc" class="comment-reply-link" href="#comment-439544" onclick='return addComment.moveForm( "comment-439544", "439544", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-439593">
<div class="comment-container" id="li-comment-439593">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 3, 2018 at 6:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-439593" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Specify the lag (n_in) as 3 to the function.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-439593" onclick='return addComment.moveForm( "comment-439593", "439593", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-441062">
<div class="comment-container" id="li-comment-441062">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7601113bc7aabf6cc3f2ec01d74ec843?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7601113bc7aabf6cc3f2ec01d74ec843?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bootstrap</span>
<span class="date">June 17, 2018 at 10:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-441062" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason!</p>
<p>Once I apply this function to my data, what’s the best way to split the data between train and test set?</p>
<p>Normally I would use sklearn train_test_split, which can shuffle the data and apply a split based on a user set proportion. However, intuitively, something tells me this incorrect, rather I would need to split the data based on the degree of shift(). Could you please clarify?</p>
<div class="reply">
<a aria-label="Reply to Bootstrap" class="comment-reply-link" href="#comment-441062" onclick='return addComment.moveForm( "comment-441062", "441062", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-441113">
<div class="comment-container" id="li-comment-441113">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 18, 2018 at 6:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-441113" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The best way depends on your specific prediction problem and your project goals.</p>
<p>This post has some suggestions for how to evaluate models on time series problems:<br/>
<a href="https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-441113" onclick='return addComment.moveForm( "comment-441113", "441113", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-442121">
<div class="comment-container" id="li-comment-442121">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5e367358e788468e9bf8ad765a17392d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5e367358e788468e9bf8ad765a17392d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">brad</span>
<span class="date">June 27, 2018 at 5:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-442121" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>When I give the function a sliding window of 20 series_to_supervised(values, 20) my new data shape is (None,21) none is variable here. Why do I get 21 ? Do i need to remove the last column ? or how do I move on ? thanks a lot for your posts.</p>
<div class="reply">
<a aria-label="Reply to brad" class="comment-reply-link" href="#comment-442121" onclick='return addComment.moveForm( "comment-442121", "442121", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-442144">
<div class="comment-container" id="li-comment-442144">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 27, 2018 at 8:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-442144" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would guess 20 for the input 1 for the output.</p>
<p>Confirm this by printing the head() of the returned data frame.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442144" onclick='return addComment.moveForm( "comment-442144", "442144", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-442220">
<div class="comment-container" id="li-comment-442220">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fdf0453372d624a9c1b9774ecf4aad8c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fdf0453372d624a9c1b9774ecf4aad8c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">lara</span>
<span class="date">June 28, 2018 at 7:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-442220" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>why we must convert it into a supervised learning for lstm problem ?</p>
<div class="reply">
<a aria-label="Reply to lara" class="comment-reply-link" href="#comment-442220" onclick='return addComment.moveForm( "comment-442220", "442220", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-442233">
<div class="comment-container" id="li-comment-442233">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 28, 2018 at 2:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-442233" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Because the LSTM is a supervised learning algorithm.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442233" onclick='return addComment.moveForm( "comment-442233", "442233", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-443198">
<div class="comment-container" id="li-comment-443198">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c13b0c0e87de1bb3159933ce1c2a4425?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c13b0c0e87de1bb3159933ce1c2a4425?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vinsondo</span>
<span class="date">July 11, 2018 at 9:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-443198" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, I love the articles. Thank you very much.</p>
<p>I have seen you have the multiple time series inputs to predict time series output.<br/>
I have a different input feature setup and try to figure it out how to implement them and use RNN to predict the time series output.</p>
<p>Let’s say I have 7 input features, feature1 to feature7 in which feature1 is a time series.<br/>
feature2 to feature5 is a scalar value and feature6 and feature7 are the scalar vectors.</p>
<p>Another way to describe the problem, for a given single value from feature2 to feature5, (ex, 2,500, 7Mhz, 10000, respectively), and a given range of values in Feature6 and Feature7, (ex, feature6 is array [2,6,40,12,….,100] and feature7 is array [200,250,700,900,800,….,12]. Then, I need to predict the times series output from the time series input feature1.</p>
<p>How do I design all these 7 feature inputs to the RNN?<br/>
If you have a book that cover this, please let me know. Thank you.</p>
<div class="reply">
<a aria-label="Reply to vinsondo" class="comment-reply-link" href="#comment-443198" onclick='return addComment.moveForm( "comment-443198", "443198", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-443213">
<div class="comment-container" id="li-comment-443213">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 11, 2018 at 2:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-443213" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If you have a series and a pattern as input (is that correct?), you can have a model with an RNN for the series and another input for the pattern, e.g. a multi-headed model.</p>
<p>Or you can provide the pattern as an input with each step of the series along with the series data.</p>
<p>Try both approaches, and perhaps other approaches, and see what works best for your problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443213" onclick='return addComment.moveForm( "comment-443213", "443213", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-444470">
<div class="comment-container" id="li-comment-444470">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1e7fc3010b5ee1e1e9350ae5d47a74f9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1e7fc3010b5ee1e1e9350ae5d47a74f9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">James Adams</span>
<span class="date">July 26, 2018 at 11:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-444470" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for this helpful article, Jason.</p>
<p>In case it’s helpful to others, I’ve modified the function to be used for converting time series data over an entire DataFrame, for use with multivariate data when a DataFrame contains multiple columns of time series data, [available here](<a href="https://gist.github.com/monocongo/6e0df19c9dd845f3f465a9a6ccfcef37" rel="nofollow">https://gist.github.com/monocongo/6e0df19c9dd845f3f465a9a6ccfcef37</a>).</p>
<div class="reply">
<a aria-label="Reply to James Adams" class="comment-reply-link" href="#comment-444470" onclick='return addComment.moveForm( "comment-444470", "444470", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-444498">
<div class="comment-container" id="li-comment-444498">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 27, 2018 at 5:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-444498" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks James.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444498" onclick='return addComment.moveForm( "comment-444498", "444498", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-444945">
<div class="comment-container" id="li-comment-444945">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/50d0c50a1b00a8d7894ca6dcc8b39e7c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/50d0c50a1b00a8d7894ca6dcc8b39e7c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">James</span>
<span class="date">August 1, 2018 at 7:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-444945" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>This article was really helpful as a starting point in my adventure into LSTM forecasting. Along with a couple of your other articles I was able to create a multivariate multiple time step LSTM model. Just a thought on your article itself: you used really complicated data structure (I think I ended up with array of arrays and individual values very quickly) when something simpler would do and be more easily adaptable. Over all, though, this was very good tutorial and was helpful to understand the basics of my own project.</p>
<div class="reply">
<a aria-label="Reply to James" class="comment-reply-link" href="#comment-444945" onclick='return addComment.moveForm( "comment-444945", "444945", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-444969">
<div class="comment-container" id="li-comment-444969">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 1, 2018 at 7:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-444969" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks James.</p>
<p>Do you have a suggestion of something simpler?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444969" onclick='return addComment.moveForm( "comment-444969", "444969", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-446160">
<div class="comment-container" id="li-comment-446160">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/68191d95ca2db3819fd1ebbd9abfac55?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/68191d95ca2db3819fd1ebbd9abfac55?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Martin Šomodi</span>
<span class="date">August 15, 2018 at 8:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-446160" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Love and appreciate the article – helped me a lot with my master’s work in the beginning. I still have lot of work and studying to do, but this tutorial along with “Multivariate Time Series Forecasting with LSTMs in Keras” helped me to understand basics of working with keras and data preparation. Keep up the good work 🙂</p>
<div class="reply">
<a aria-label="Reply to Martin Šomodi" class="comment-reply-link" href="#comment-446160" onclick='return addComment.moveForm( "comment-446160", "446160", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-446191">
<div class="comment-container" id="li-comment-446191">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 16, 2018 at 6:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-446191" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, I’m happy to hear that.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-446191" onclick='return addComment.moveForm( "comment-446191", "446191", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-446185">
<div class="comment-container" id="li-comment-446185">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/17e20291c008fe5326093c94a95577d7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/17e20291c008fe5326093c94a95577d7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Juan Carlos Vargas Sosa</span>
<span class="date">August 16, 2018 at 5:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-446185" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for the effort you put in all the blogs that you have shared with all of us.<br/>
I want to share a small contribution of simpler series_to_supervised function. I think it only works in Python 3.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca63930284111508471" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
def series_to_supervised(dataframe, n_in=1, n_out=1):
    output_dataframe = pd.DataFrame()
    for k in range(n_in, 0, -1):
        columns = ['{}(t-{})'.format(column, k) for column in dataframe.columns]
        output_dataframe[columns] = dataframe.shift(k)

    for k in range(0, n_out):        
        if k == 0:
            columns = ['{}(t)'.format(column) for column in dataframe.columns]
        else:
            columns = ['{}(t+{})'.format(column, k) for column in dataframe.columns]
        output_dataframe[columns] = dataframe.shift(-k)

    output_dataframe.dropna(inplace=True)
    return output_dataframe</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca63930284111508471-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930284111508471-2">2</div><div class="crayon-num" data-line="crayon-5c0ca63930284111508471-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930284111508471-4">4</div><div class="crayon-num" data-line="crayon-5c0ca63930284111508471-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930284111508471-6">6</div><div class="crayon-num" data-line="crayon-5c0ca63930284111508471-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930284111508471-8">8</div><div class="crayon-num" data-line="crayon-5c0ca63930284111508471-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930284111508471-10">10</div><div class="crayon-num" data-line="crayon-5c0ca63930284111508471-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930284111508471-12">12</div><div class="crayon-num" data-line="crayon-5c0ca63930284111508471-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca63930284111508471-14">14</div><div class="crayon-num" data-line="crayon-5c0ca63930284111508471-15">15</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca63930284111508471-1"><span class="crayon-e">def </span><span class="crayon-e">series_to_supervised</span><span class="crayon-sy">(</span><span class="crayon-v">dataframe</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_in</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930284111508471-2"><span class="crayon-h">    </span><span class="crayon-v">output_dataframe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca63930284111508471-3"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">k</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930284111508471-4"><span class="crayon-h">        </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'{}(t-{})'</span><span class="crayon-sy">.</span><span class="crayon-e">format</span><span class="crayon-sy">(</span><span class="crayon-v">column</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">column </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca63930284111508471-5"><span class="crayon-h">        </span><span class="crayon-v">output_dataframe</span><span class="crayon-sy">[</span><span class="crayon-v">columns</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-v">k</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930284111508471-6"> </div><div class="crayon-line" id="crayon-5c0ca63930284111508471-7"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">k</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_out</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h">        </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930284111508471-8"><span class="crayon-h">        </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca63930284111508471-9"><span class="crayon-h">            </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'{}(t)'</span><span class="crayon-sy">.</span><span class="crayon-e">format</span><span class="crayon-sy">(</span><span class="crayon-v">column</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">column </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930284111508471-10"><span class="crayon-h">        </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca63930284111508471-11"><span class="crayon-h">            </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'{}(t+{})'</span><span class="crayon-sy">.</span><span class="crayon-e">format</span><span class="crayon-sy">(</span><span class="crayon-v">column</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">column </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930284111508471-12"><span class="crayon-h">        </span><span class="crayon-v">output_dataframe</span><span class="crayon-sy">[</span><span class="crayon-v">columns</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">k</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca63930284111508471-13"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca63930284111508471-14"><span class="crayon-h">    </span><span class="crayon-v">output_dataframe</span><span class="crayon-sy">.</span><span class="crayon-e">dropna</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca63930284111508471-15"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">output_dataframe</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0013 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to Juan Carlos Vargas Sosa" class="comment-reply-link" href="#comment-446185" onclick='return addComment.moveForm( "comment-446185", "446185", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-446205">
<div class="comment-container" id="li-comment-446205">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 16, 2018 at 6:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-446205" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great, thanks for sharing!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-446205" onclick='return addComment.moveForm( "comment-446205", "446205", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-446323">
<div class="comment-container" id="li-comment-446323">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e2279d3b4d56a201e56a99e3bca25de5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e2279d3b4d56a201e56a99e3bca25de5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Xu</span>
<span class="date">August 17, 2018 at 1:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-446323" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for your posts.  My question is: for the classification problem, is OK using the same way to reframe the data?<br/>
 Best<br/>
Xu</p>
<div class="reply">
<a aria-label="Reply to Xu" class="comment-reply-link" href="#comment-446323" onclick='return addComment.moveForm( "comment-446323", "446323", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-446330">
<div class="comment-container" id="li-comment-446330">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 17, 2018 at 2:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-446330" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-446330" onclick='return addComment.moveForm( "comment-446330", "446330", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-446563">
<div class="comment-container" id="li-comment-446563">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/77352d18775bf8354bca4655dfb07780?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/77352d18775bf8354bca4655dfb07780?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Carlos B</span>
<span class="date">August 21, 2018 at 2:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-446563" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Your site is always so helpful! I’m slightly confused here though. If I have a time series dataset that already consists of some input variables (VarIn_1 to VarIn_3) and the corresponding output values (Out_1 and Out_2), do I still need to run the dataset through the series_to_supervised() function before fitting to my LSTM model?</p>
<p>Example dataset:<br/>
Time Win,  VarIn_1, VarIn_2, VarIn_3, Out_1, Out_2<br/>
1,               5,           3,           7,           2,        3<br/>
2,               6,           2,           4,           3,        1<br/>
3,               4,           4,           6,           1,        4<br/>
…,              …,          …,          …,           …,      …,</p>
<p>Best wishes,<br/>
 Carl</p>
<div class="reply">
<a aria-label="Reply to Carlos B" class="comment-reply-link" href="#comment-446563" onclick='return addComment.moveForm( "comment-446563", "446563", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-446587">
<div class="comment-container" id="li-comment-446587">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 21, 2018 at 6:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-446587" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps not.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-446587" onclick='return addComment.moveForm( "comment-446587", "446587", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-447198">
<div class="comment-container" id="li-comment-447198">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c353837d0e48bf18bc326ac4b607f91c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c353837d0e48bf18bc326ac4b607f91c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Julien</span>
<span class="date">August 29, 2018 at 8:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-447198" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,<br/>
Thank you so much for your great efforts.</p>
<p>I am trying to predict day ahead using the h2o package in r. below i.e glm model.</p>
<p>glm_model &lt;- glm(RealPtot ~ ., data= c(input3, target), family=gaussian)</p>
<p>Then I calculate the MAPE for each day using :</p>
<p>mape_calc &lt;- function(sub_df) {<br/>
  pred &lt;- predict.glm(glm_model, sub_df)<br/>
  actual &lt;- sub_df$Real_data<br/>
  mape &lt;- 100 * mean(abs((actual – pred)/actual))<br/>
  new_df &lt;- data.frame(date = sub_df$date[[1]], mape = mape)<br/>
  return(new_df)<br/>
}</p>
<p># LIST OF ONE-ROW DATAFRAMES<br/>
df_list &lt;- by(test_data, test_data$date, mape_calc)</p>
<p># FINAL DATAFRAME<br/>
final_df &lt;- do.call(rbind, df_list)</p>
<p>I am trying to implement the same above code using h2o, but I am facing difficulties in data conversion in the h2o environment. Any thoughts will be appreciated. Thanks in advance.</p>
<div class="reply">
<a aria-label="Reply to Julien" class="comment-reply-link" href="#comment-447198" onclick='return addComment.moveForm( "comment-447198", "447198", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-447200">
<div class="comment-container" id="li-comment-447200">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 29, 2018 at 9:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-447200" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have any experience with h2o, perhaps contact their support?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-447200" onclick='return addComment.moveForm( "comment-447200", "447200", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-448316">
<div class="comment-container" id="li-comment-448316">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c47052fbad8121372a57b055adb37332?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c47052fbad8121372a57b055adb37332?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">BenniEvolent</span>
<span class="date">September 10, 2018 at 5:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-448316" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason your articles are great. I do not mind code repetition, it does take care of issues newbies might face. The Responses section is also a big help. Thanks!</p>
<div class="reply">
<a aria-label="Reply to BenniEvolent" class="comment-reply-link" href="#comment-448316" onclick='return addComment.moveForm( "comment-448316", "448316", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-448354">
<div class="comment-container" id="li-comment-448354">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 11, 2018 at 6:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-448354" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-448354" onclick='return addComment.moveForm( "comment-448354", "448354", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-448646">
<div class="comment-container" id="li-comment-448646">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1f4fe7ddb051783c7c99eb0564a7decd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1f4fe7ddb051783c7c99eb0564a7decd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aladji Diallo</span>
<span class="date">September 13, 2018 at 12:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-448646" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I wonder how you get rid of the dates. I trying to use your method to make my prediction for times series But. I have the date as index.</p>
<div class="reply">
<a aria-label="Reply to Aladji Diallo" class="comment-reply-link" href="#comment-448646" onclick='return addComment.moveForm( "comment-448646", "448646", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-448667">
<div class="comment-container" id="li-comment-448667">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 13, 2018 at 8:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-448667" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Remove the column that contains the dates. You can do this in code or in the data file directly (e.g. via excel).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-448667" onclick='return addComment.moveForm( "comment-448667", "448667", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-448717">
<div class="comment-container" id="li-comment-448717">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/55f95422ea87bba96e9dc169a0f17a20?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/55f95422ea87bba96e9dc169a0f17a20?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Andy</span>
<span class="date">September 14, 2018 at 12:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-448717" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,<br/>
nice post, I have a question regarding the train/test split in this case:<br/>
E.g. I now take the first 80 % of the rows as training data and the rest as test data.<br/>
Would it be considered data leakage since the last two samples in the training data contain the first values of the test set as targets (values for t, t+1)?</p>
<div class="reply">
<a aria-label="Reply to Andy" class="comment-reply-link" href="#comment-448717" onclick='return addComment.moveForm( "comment-448717", "448717", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-448744">
<div class="comment-container" id="li-comment-448744">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 14, 2018 at 6:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-448744" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nope.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-448744" onclick='return addComment.moveForm( "comment-448744", "448744", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-449160">
<div class="comment-container" id="li-comment-449160">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/55f95422ea87bba96e9dc169a0f17a20?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/55f95422ea87bba96e9dc169a0f17a20?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Andy</span>
<span class="date">September 18, 2018 at 4:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-449160" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>thanks for your response, but why is that?<br/>
Maybe I wasn’t clear, but I found what I wanted to say in a post on medium:<br/>
<a href="https://medium.com/apteo/avoid-time-loops-with-cross-validation-aa595318543e" rel="nofollow">https://medium.com/apteo/avoid-time-loops-with-cross-validation-aa595318543e</a> </p>
<p>See their second visualization, they call it “look ahead gap” which excludes the ground truth data of the last prediction step in the training set from the test set. </p>
<p>What do you think about that? Is that common practice?</p>
<div class="reply">
<a aria-label="Reply to Andy" class="comment-reply-link" href="#comment-449160" onclick='return addComment.moveForm( "comment-449160", "449160", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-449192">
<div class="comment-container" id="li-comment-449192">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 18, 2018 at 6:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-449192" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have seen many many many papers use CV to report results for time series and they are almost always invalid.</p>
<p>You can use CV, but be very careful. If results really matter, use walk-forward validation. You cannot mess it up.</p>
<p>It like coding, you can use “goto”, but don’t.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-449192" onclick='return addComment.moveForm( "comment-449192", "449192", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-449206">
<div class="comment-container" id="li-comment-449206">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/55f95422ea87bba96e9dc169a0f17a20?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/55f95422ea87bba96e9dc169a0f17a20?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Andy</span>
<span class="date">September 18, 2018 at 9:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-449206" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>They also argue against classical CV, they actually do use walk-forward validation (I think their usage of the term “walk forward cross validation” is a little misleading).<br/>
So yes, I am definitely using walk forward validation! </p>
<p>Let me illustrate my question with a simplified example: </p>
<p>If we have this time series:<br/>
[1, 3, 4, 5, 6, 1] </p>
<p>I would split the data into training set<br/>
[1, 3, 4, 5] </p>
<p>… and test set<br/>
[ 6, 1] </p>
<p>I would do this before converting it into a supervised problem.<br/>
So if I do the conversion to a supervised problem now, I will end up with this for my training set: </p>
<p> t  |   t+1<br/>
1  |    3<br/>
3  |    4<br/>
4  |    5<br/>
5  |  NaN</p>
<p>For the 4th row, I do not have a value for t+1, since it is not part of the training set. If I took the value 6 from my test set here, I would include information about the test set.<br/>
So here I would only train up to the 3rd row, since that is the last complete entry. </p>
<p>For the test I would then use this trained model to predict t+1 following the value 6.<br/>
This leads to a gap, since I will not receive a prediction for the fourth row in this iteration (the “look ahead gap”?).</p>
<p>If I were to convert the series into a supervised problem before the split, this issue (is it one?) doesn’t become as clear, but I would remove the last row of the training set in this case, since it contains the first value of my test set as a target.</p>
<p>So, can I convert first and then split or do I need to split first, then convert like in the example?<br/>
The underlying question is, if “seeing” or not “seeing” the value of following time step as a target, has an influence on the performance of the prediction in following time step?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-449223">
<div class="comment-container" id="li-comment-449223">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 18, 2018 at 2:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-449223" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sounds like you’re getting caught up. </p>
<p>Focus on this: you want to test the model the way you intend to use it.</p>
<p>If data is available to the model final prior the need for a prediction, the model should/must make use of the data in order to make the best possible prediction. This is the premise for walk-forward validation.</p>
<p>Concerns of train/test data only make sense at the point of a single prediction and its evaluation. It is not leakage to “see” data that was part of the test set for the prior forecast, unless you do not expect to use the model in that way. In which case, change the configuration of walk-forward validation from one-step to two-step or whatever.</p>
<p>Does that help at all?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-5" id="comment-449247">
<div class="comment-container" id="li-comment-449247">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/55f95422ea87bba96e9dc169a0f17a20?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/55f95422ea87bba96e9dc169a0f17a20?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Andy</span>
<span class="date">September 18, 2018 at 5:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-449247" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I was caught up and it helps to think about what will be available when making predictions.</p>
<p>My problem was that I am doing a direct 3-step ahead forecast, so there are three “dead“ rows before each further prediction step, since I need 3 future values for a complete training sample (they are not really dead since I use the entries as t+1, t+2, and t+3 at t).</p>
<p>Thank you for your patience!</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-449286">
<div class="comment-container" id="li-comment-449286">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 19, 2018 at 6:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-449286" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, they are not dead/empty. </p>
<p>They will have real prior obs at the time a prediction is being made. So train and eval your model under that assumption.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-453277">
<div class="comment-container" id="li-comment-453277">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b4579c58a04d78923ef390758d3c81c4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b4579c58a04d78923ef390758d3c81c4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">SRIKANTH</span>
<span class="date">October 31, 2018 at 9:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-453277" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I sincerely Thanks a lot for this information by yours. Great job!!!!! and also I wish more articles from yours in future.</p>
<p>I am understand concepts from these two articles<br/>
Convert-time-series-supervised-learning-problem-python and Time-series-forecasting-supervised-learning. </p>
<p>Now I want to predicate and set the boolean either TRUE or False  value based on the either  Latidtude and Longitude  or Geohash value, for this how can I used Multivariate Forecasting.<br/>
I am completely new to this area please suggest me the directions I will follow it and do it.</p>
<p>Thanks inadvacne. I am doing this in Python3 in my Mac mini</p>
<div class="reply">
<a aria-label="Reply to SRIKANTH" class="comment-reply-link" href="#comment-453277" onclick='return addComment.moveForm( "comment-453277", "453277", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-453309">
<div class="comment-container" id="li-comment-453309">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 1, 2018 at 6:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-453309" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sounds like a time series classification task.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453309" onclick='return addComment.moveForm( "comment-453309", "453309", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-453638">
<div class="comment-container" id="li-comment-453638">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/25f908b89bb92bb471f645dd4b1fd5ea?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/25f908b89bb92bb471f645dd4b1fd5ea?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">FP</span>
<span class="date">November 4, 2018 at 3:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-453638" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>How can I apply the lag only to variable 1 in multivariate time series? In other words, I have  5 variables, but would only to lag variable 1?</p>
<div class="reply">
<a aria-label="Reply to FP" class="comment-reply-link" href="#comment-453638" onclick='return addComment.moveForm( "comment-453638", "453638", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-453683">
<div class="comment-container" id="li-comment-453683">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 5, 2018 at 6:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/#comment-453683" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>One approach is to use the lag obs from one variable as features to a ML model.</p>
<p>Another approach is to have a multi-headed model, one for the time series and one for the static variables.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453683" onclick='return addComment.moveForm( "comment-453683", "453683", "respond", "3984" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/convert-time-series-supervised-learning-problem-python/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="3984"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="e755827f2c"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="3"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery!</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Jason Brownlee, PhD
<br/>
I write tutorials to help developers (<i>like you</i>) get results with machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-27"> <div class="textwidget"><p></p><center><br/>
<strong>Time Series Forecasting with Python</strong><br/>
Explore time series data and predict the future.
<p><a href="/introduction-to-time-series-forecasting-with-python/">Click to Get Started Now!</a><br/>
<a href="/introduction-to-time-series-forecasting-with-python/"><img alt="Introduction to Time Series Forecasting With Python" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/02/Introduction-to-Time-Series-Forecasting-With-Python-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch"><img alt="How to Develop a Neural Machine Translation System in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/01/How-to-Develop-a-Neural-Machine-Translation-System-in-Keras-150x150.jpg" title="How to Develop a Neural Machine Translation System from Scratch" width="45"/></a> <a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch">How to Develop a Neural Machine Translation System from Scratch</a>
<span class="meta">January 10, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning"><img alt="Difference Between Classification and Regression in Machine Learning" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/Difference-Between-Classification-and-Regression-in-Machine-Learning-150x150.jpg" title="Difference Between Classification and Regression in Machine Learning" width="45"/></a> <a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning">Difference Between Classification and Regression in Machine Learning</a>
<span class="meta">December 11, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem..."><img alt="So, You are Working on a Machine Learning Problem..." class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/So-You-are-Working-on-a-Machine-Learning-Problem...-150x150.jpg" title="So, You are Working on a Machine Learning Problem..." width="45"/></a> <a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem…">So, You are Working on a Machine Learning Problem…</a>
<span class="meta">April 4, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis"><img alt="Plot of the Multichannel Convolutional Neural Network For Text" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-150x150.png" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis" width="45"/></a> <a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis">How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis</a>
<span class="meta">January 12, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras"><img alt="How to Make Classification and Regression Predictions for Deep Learning Models in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/How-to-Make-Classification-and-Regression-Predictions-for-Deep-Learning-Models-in-Keras-150x150.jpg" title="How to Make Predictions with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras">How to Make Predictions with Keras</a>
<span class="meta">April 9, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)"><img alt="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/11-Classical-Time-Series-Forecasting-Methods-in-Python-Cheat-Sheet-150x150.jpg" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)">11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)</a>
<span class="meta">August 6, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras"><img alt="How to Visualize a Deep Learning Neural Network Model in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/How-to-Visualize-a-Deep-Learning-Neural-Network-Model-in-Keras-150x150.jpg" title="How to Visualize a Deep Learning Neural Network Model in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras">How to Visualize a Deep Learning Neural Network Model in Keras</a>
<span class="meta">December 13, 2017</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> <div class="widget_text widget widget_custom_html" id="custom_html-2"><h3>You might also like…</h3><div class="textwidget custom-html-widget"><ul>
<li><a href="/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Install Python for Machine Learning</a></li>
<li><a href="/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python</a></li>
<li><a href="/tutorial-first-neural-network-python-keras/">Your First Neural Network in Python</a></li>
<li><a href="/how-to-run-your-first-classifier-in-weka/">Your First Classifier in Weka</a></li>
<li><a href="/arima-for-time-series-forecasting-with-python/">Your First Time Series Forecasting Project</a></li>
</ul></div></div></aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/disclaimer/">Disclaimer</a> | 
<a href="/terms-of-service/">Terms</a> | 
<a href="/contact/">Contact</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.8" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.0.5" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.8" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.1" type="text/javascript"></script>
</body>
</html>