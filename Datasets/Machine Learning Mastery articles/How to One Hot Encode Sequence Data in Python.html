<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v9.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>How to One Hot Encode Sequence Data in Python</title>
<link href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="How to One Hot Encode Sequence Data in Python" property="og:title"/>
<meta content="Machine learning algorithms cannot work with categorical data directly. Categorical data must be converted to numbers. This applies when you are working with a sequence classification type problem and plan on using deep learning methods such as Long Short-Term Memory recurrent neural networks. In this tutorial, you will discover how to convert your input or …" property="og:description"/>
<meta content="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="https://www.facebook.com/jason.brownlee.39" property="article:author"/>
<meta content="Long Short-Term Memory Networks" property="article:section"/>
<meta content="2017-07-11T19:00:49+00:00" property="article:published_time"/>
<meta content="2017-07-19T22:48:08+00:00" property="article:modified_time"/>
<meta content="2017-07-19T22:48:08+00:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/07/How-to-One-Hot-Encode-Sequence-Classification-Data-in-Python.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/07/How-to-One-Hot-Encode-Sequence-Classification-Data-in-Python.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="480" property="og:image:height"/>
<meta content="How to One Hot Encode Sequence Classification Data in Python" property="og:image:alt"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"https:\/\/machinelearningmastery.com\/#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/feed/" rel="alternate" title="Machine Learning Mastery » How to One Hot Encode Sequence Data in Python Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<style media="all" type="text/css">
.wpautoterms-footer{background-color:#ffffff;text-align:center;}
.wpautoterms-footer a{color:#000000;font-family:Arial, sans-serif;font-size:14px;}
.wpautoterms-footer .separator{color:#cccccc;font-family:Arial, sans-serif;font-size:14px;}</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/auto-terms-of-service-and-privacy-policy/css/wpautoterms.css?ver=4.9.8" id="wpautoterms_css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.0.5" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/css/front.css?ver=2.0.20" id="ssb-front-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/ewd-ufaq-styles.css?ver=4.9.8" id="ewd-ufaq-style-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/rrssb-min.css?ver=4.9.8" id="ewd-ufaq-rrssb-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.8" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=2.0.20" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.8" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.8" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=4129" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fhow-to-one-hot-encode-sequence-data-in-python%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fhow-to-one-hot-encode-sequence-data-in-python%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<style media="screen">

        .simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
      margin: ;
    }
         /*inline margin*/
    
  
  
  
  
  
          .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
         margin: ;
     }

          /*margin-digbar*/

  
  
  
  
 
   
   

</style>
<script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#4c89bf; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#4c89bf;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#4c89bf!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#ffffff;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-4129 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/icon-100x100.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-31"> <div class="textwidget"><p>Want help with LSTMs? <a href="https://machinelearningmastery.lpages.co/lnwp-mini-course/">Take the FREE Mini-Course</a>.</p>
</div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<input name="post_type" type="hidden" value="post"/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Main Menu</h3><ul class="nav fl" id="main-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503" id="menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Start Here</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501" id="menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506" id="menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508" id="menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (Keras)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6511" id="menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509" id="menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515" id="menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">Deep Learning for NLP</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512" id="menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Understand Algorithms</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507" id="menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms (Python)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6513" id="menu-item-6513"><a href="https://machinelearningmastery.com/category/machine-learning-process/">Machine Learning Process</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516" id="menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517" id="menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522" id="menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6518" id="menu-item-6518"><a href="https://machinelearningmastery.com/category/start-machine-learning/">Getting Started</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510" id="menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519" id="menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistical Methods</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520" id="menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Time Series (introductory)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523" id="menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6514" id="menu-item-6514"><a href="https://machinelearningmastery.com/category/machine-learning-resources/">Resources</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502" id="menu-item-6502"><a href="https://machinelearningmastery.com/products/">Ebooks</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500" id="menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504" id="menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505" id="menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-4129 post type-post status-publish format-standard has-post-thumbnail hentry category-lstm">
<header>
<h1 class="title entry-title">How to One Hot Encode Sequence Data in Python</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2017-07-12T05:00:49+1100">July 12, 2017</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/lstm/" title="View all items in Long Short-Term Memory Networks">Long Short-Term Memory Networks</a></span> </div>
<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-4129 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+One+Hot+Encode+Sequence+Data+in+Python&amp;url=https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
<p>Machine learning algorithms cannot work with categorical data directly.</p>
<p>Categorical data must be converted to numbers.</p>
<p>This applies when you are working with a sequence classification type problem and plan on using deep learning methods such as Long Short-Term Memory recurrent neural networks.</p>
<p>In this tutorial, you will discover how to convert your input or output sequence data to a one hot encoding for use in sequence classification problems with deep learning in Python.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>What an integer encoding and one hot encoding are and why they are necessary in machine learning.</li>
<li>How to calculate an integer encoding and one hot encoding by hand in Python.</li>
<li>How to use the scikit-learn and Keras libraries to automatically encode your sequence data in Python.</li>
</ul>
<p>Let’s get started.</p>
<div class="wp-caption aligncenter" id="attachment_4130" style="width: 650px"><img alt="How to One Hot Encode Sequence Classification Data in Python" class="size-full wp-image-4130" height="480" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/07/How-to-One-Hot-Encode-Sequence-Classification-Data-in-Python.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/07/How-to-One-Hot-Encode-Sequence-Classification-Data-in-Python.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/07/How-to-One-Hot-Encode-Sequence-Classification-Data-in-Python-300x225.jpg 300w" width="640"/><p class="wp-caption-text">How to One Hot Encode Sequence Classification Data in Python<br/>Photo by <a href="https://www.flickr.com/photos/elevy/6997586997/">Elias Levy</a>, some rights reserved.</p></div>
<h2>Tutorial Overview</h2>
<p>This tutorial is divided into 4 parts; they are:</p>
<ol>
<li>What is One Hot Encoding?</li>
<li>Manual One Hot Encoding</li>
<li>One Hot Encode with scikit-learn</li>
<li>One Hot Encode with Keras</li>
</ol>
<h2>What is One Hot Encoding?</h2>
<p>A one hot encoding is a representation of categorical variables as binary vectors.</p>
<p>This first requires that the categorical values be mapped to integer values.</p>
<p>Then, each integer value is represented as a binary vector that is all zero values except the index of the integer, which is marked with a 1.</p>
<h3>Worked Example of a One Hot Encoding</h3>
<p>Let’s make this concrete with a worked example.</p>
<p>Assume we have a sequence of labels with the values ‘red’ and ‘green’.</p>
<p>We can assign ‘red’ an integer value of 0 and ‘green’ the integer value of 1. As long as we always assign these numbers to these labels, this is called an integer encoding. Consistency is important so that we can invert the encoding later and get labels back from integer values, such as in the case of making a prediction.</p>
<p>Next, we can create a binary vector to represent each integer value. The vector will have a length of 2 for the 2 possible integer values.</p>
<p>The ‘red’ label encoded as a 0 will be represented with a binary vector [1, 0] where the zeroth index is marked with a value of 1. In turn, the ‘green’ label encoded as a 1 will be represented with a binary vector [0, 1] where the first index is marked with a value of 1.</p>
<p>If we had the sequence:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa22acafb396010343" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
'red', 'red', 'green'</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa22acafb396010343-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa22acafb396010343-1">'red', 'red', 'green'</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We could represent it with the integer encoding:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa22acb03907777806" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
0, 0, 1</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa22acb03907777806-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa22acb03907777806-1">0, 0, 1</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>And the one hot encoding of:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa22acb05680616847" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
[1, 0]
[1, 0]
[0, 1]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa22acb05680616847-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb05680616847-2">2</div><div class="crayon-num" data-line="crayon-5c0caa22acb05680616847-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa22acb05680616847-1">[1, 0]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb05680616847-2">[1, 0]</div><div class="crayon-line" id="crayon-5c0caa22acb05680616847-3">[0, 1]</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p></p>
<h3>Why Use a One Hot Encoding?</h3>
<p>A one hot encoding allows the representation of categorical data to be more expressive.</p>
<p>Many machine learning algorithms cannot work with categorical data directly. The categories must be converted into numbers. This is required for both input and output variables that are categorical.</p>
<p>We could use an integer encoding directly, rescaled where needed. This may work for problems where there is a natural ordinal relationship between the categories, and in turn the integer values, such as labels for temperature ‘cold’, warm’, and ‘hot’.</p>
<p>There may be problems when there is no ordinal relationship and allowing the representation to lean on any such relationship might be damaging to learning to solve the problem. An example might be the labels ‘dog’ and ‘cat’</p>
<p>In these cases, we would like to give the network more expressive power to learn a probability-like number for each possible label value. This can help in both making the problem easier for the network to model. When a one hot encoding is used for the output variable, it may offer a more nuanced set of predictions than a single label.</p>
<div class="woo-sc-hr"></div>
<center>
<h3>Need help with LSTMs for Sequence Prediction?</h3>
<p>Take my free 7-day email course and discover 6 different LSTM architectures (with code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.lpages.co/leadbox/1403a9373f72a2%3A164f8be4f346dc/5754903989321728/" rel="noopener" style="background: #ffce0a; color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.25) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.5) 0px 1px 3px inset, rgba(0, 0, 0, 0.5) 0px 1px 3px;" target="_blank">Start Your FREE Mini-Course Now!</a><script data-config="%7B%7D" data-leadbox="1403a9373f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.lpages.co/leadbox/1403a9373f72a2%3A164f8be4f346dc/5754903989321728/" src="https://machinelearningmastery.lpages.co/leadbox-1500400021.js" type="text/javascript"></script></p>
</center>
<div class="woo-sc-hr"></div>
<h2>Manual One Hot Encoding</h2>
<p>In this example, we will assume the case where we have an example string of characters of alphabet letters, but the example sequence does not cover all possible examples.</p>
<p>We will use the input sequence of the following characters:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa22acb07334055148" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
hello world</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa22acb07334055148-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa22acb07334055148-1">hello world</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We will assume that the universe of all possible inputs is the complete alphabet of lower case characters, and space. We will therefore use this as an excuse to demonstrate how to roll our own one hot encoding.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa22acb08661605622" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from numpy import argmax
# define input string
data = 'hello world'
print(data)
# define universe of possible input values
alphabet = 'abcdefghijklmnopqrstuvwxyz '
# define a mapping of chars to integers
char_to_int = dict((c, i) for i, c in enumerate(alphabet))
int_to_char = dict((i, c) for i, c in enumerate(alphabet))
# integer encode input data
integer_encoded = [char_to_int[char] for char in data]
print(integer_encoded)
# one hot encode
onehot_encoded = list()
for value in integer_encoded:
	letter = [0 for _ in range(len(alphabet))]
	letter[value] = 1
	onehot_encoded.append(letter)
print(onehot_encoded)
# invert encoding
inverted = int_to_char[argmax(onehot_encoded[0])]
print(inverted)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa22acb08661605622-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb08661605622-2">2</div><div class="crayon-num" data-line="crayon-5c0caa22acb08661605622-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb08661605622-4">4</div><div class="crayon-num" data-line="crayon-5c0caa22acb08661605622-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb08661605622-6">6</div><div class="crayon-num" data-line="crayon-5c0caa22acb08661605622-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb08661605622-8">8</div><div class="crayon-num" data-line="crayon-5c0caa22acb08661605622-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb08661605622-10">10</div><div class="crayon-num" data-line="crayon-5c0caa22acb08661605622-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb08661605622-12">12</div><div class="crayon-num" data-line="crayon-5c0caa22acb08661605622-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb08661605622-14">14</div><div class="crayon-num" data-line="crayon-5c0caa22acb08661605622-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb08661605622-16">16</div><div class="crayon-num" data-line="crayon-5c0caa22acb08661605622-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb08661605622-18">18</div><div class="crayon-num" data-line="crayon-5c0caa22acb08661605622-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb08661605622-20">20</div><div class="crayon-num" data-line="crayon-5c0caa22acb08661605622-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb08661605622-22">22</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa22acb08661605622-1"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-v">argmax</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb08661605622-2"><span class="crayon-p"># define input string</span></div><div class="crayon-line" id="crayon-5c0caa22acb08661605622-3"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'hello world'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb08661605622-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa22acb08661605622-5"><span class="crayon-p"># define universe of possible input values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb08661605622-6"><span class="crayon-v">alphabet</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'abcdefghijklmnopqrstuvwxyz '</span></div><div class="crayon-line" id="crayon-5c0caa22acb08661605622-7"><span class="crayon-p"># define a mapping of chars to integers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb08661605622-8"><span class="crayon-v">char_to_int</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">c</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">alphabet</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa22acb08661605622-9"><span class="crayon-v">int_to_char</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">alphabet</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb08661605622-10"><span class="crayon-p"># integer encode input data</span></div><div class="crayon-line" id="crayon-5c0caa22acb08661605622-11"><span class="crayon-v">integer_encoded</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">char_to_int</span><span class="crayon-sy">[</span><span class="crayon-t">char</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">char</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb08661605622-12"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">integer_encoded</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa22acb08661605622-13"><span class="crayon-p"># one hot encode</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb08661605622-14"><span class="crayon-v">onehot_encoded</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa22acb08661605622-15"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">value </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">integer_encoded</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb08661605622-16"><span class="crayon-h"> </span><span class="crayon-v">letter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">alphabet</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa22acb08661605622-17"><span class="crayon-h"> </span><span class="crayon-v">letter</span><span class="crayon-sy">[</span><span class="crayon-v">value</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb08661605622-18"><span class="crayon-h"> </span><span class="crayon-v">onehot_encoded</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">letter</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa22acb08661605622-19"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">onehot_encoded</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb08661605622-20"><span class="crayon-p"># invert encoding</span></div><div class="crayon-line" id="crayon-5c0caa22acb08661605622-21"><span class="crayon-v">inverted</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">int_to_char</span><span class="crayon-sy">[</span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">onehot_encoded</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb08661605622-22"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">inverted</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>Running the example first prints the input string.</p>
<p>A mapping of all possible inputs is created from char values to integer values. This mapping is then used to encode the input string. We can see that the first letter in the input ‘h’ is encoded as 7, or the index 7 in the array of possible input values (alphabet).</p>
<p>The integer encoding is then converted to a one hot encoding. This is done one integer encoded character at a time. A list of 0 values is created the length of the alphabet so that any expected character can be represented.</p>
<p>Next, the index of the specific character is marked with a 1. We can see that the first letter ‘h’ integer encoded as a 7 is represented by a binary vector with the length 27 and the 7th index marked with a 1.</p>
<p>Finally, we invert the encoding of the first letter and print the result. We do this by locating the index of in the binary vector with the largest value using the NumPy argmax() function and then using the integer value in a reverse lookup table of character values to integers.</p>
<p>Note: output was formatted for readability.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa22acb0a784629503" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
hello world

[7, 4, 11, 11, 14, 26, 22, 14, 17, 11, 3]

[[0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
 [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
 [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
 [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]

h</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa22acb0a784629503-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb0a784629503-2">2</div><div class="crayon-num" data-line="crayon-5c0caa22acb0a784629503-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb0a784629503-4">4</div><div class="crayon-num" data-line="crayon-5c0caa22acb0a784629503-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb0a784629503-6">6</div><div class="crayon-num" data-line="crayon-5c0caa22acb0a784629503-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb0a784629503-8">8</div><div class="crayon-num" data-line="crayon-5c0caa22acb0a784629503-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb0a784629503-10">10</div><div class="crayon-num" data-line="crayon-5c0caa22acb0a784629503-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb0a784629503-12">12</div><div class="crayon-num" data-line="crayon-5c0caa22acb0a784629503-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb0a784629503-14">14</div><div class="crayon-num" data-line="crayon-5c0caa22acb0a784629503-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb0a784629503-16">16</div><div class="crayon-num" data-line="crayon-5c0caa22acb0a784629503-17">17</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa22acb0a784629503-1">hello world</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb0a784629503-2"> </div><div class="crayon-line" id="crayon-5c0caa22acb0a784629503-3">[7, 4, 11, 11, 14, 26, 22, 14, 17, 11, 3]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb0a784629503-4"> </div><div class="crayon-line" id="crayon-5c0caa22acb0a784629503-5">[[0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb0a784629503-6"> [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],</div><div class="crayon-line" id="crayon-5c0caa22acb0a784629503-7"> [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb0a784629503-8"> [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],</div><div class="crayon-line" id="crayon-5c0caa22acb0a784629503-9"> [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb0a784629503-10"> [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],</div><div class="crayon-line" id="crayon-5c0caa22acb0a784629503-11"> [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0],</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb0a784629503-12"> [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],</div><div class="crayon-line" id="crayon-5c0caa22acb0a784629503-13"> [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb0a784629503-14"> [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],</div><div class="crayon-line" id="crayon-5c0caa22acb0a784629503-15"> [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb0a784629503-16"> </div><div class="crayon-line" id="crayon-5c0caa22acb0a784629503-17">h</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Now that we have seen how to roll our own one hot encoding from scratch, let’s see how we can use the scikit-learn library to perform this mapping automatically for cases where the input sequence fully captures the expected range of input values.</p>
<h2>One Hot Encode with scikit-learn</h2>
<p>In this example, we will assume the case where you have an output sequence of the following 3 labels:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa22acb0f412849245" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
"cold"
"warm"
"hot"</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa22acb0f412849245-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb0f412849245-2">2</div><div class="crayon-num" data-line="crayon-5c0caa22acb0f412849245-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa22acb0f412849245-1">"cold"</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb0f412849245-2">"warm"</div><div class="crayon-line" id="crayon-5c0caa22acb0f412849245-3">"hot"</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>An example sequence of 10 time steps may be:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa22acb10128928210" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
cold, cold, warm, cold, hot, hot, warm, cold, warm, hot</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa22acb10128928210-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa22acb10128928210-1">cold, cold, warm, cold, hot, hot, warm, cold, warm, hot</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>This would first require an integer encoding, such as 1, 2, 3. This would be followed by a one hot encoding of integers to a binary vector with 3 values, such as [1, 0, 0].</p>
<p>The sequence provides at least one example of every possible value in the sequence. Therefore we can use automatic methods to define the mapping of labels to integers and integers to binary vectors.</p>
<p>In this example, we will use the encoders from the scikit-learn library. Specifically, the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html">LabelEncoder</a> of creating an integer encoding of labels and the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html">OneHotEncoder</a> for creating a one hot encoding of integer encoded values.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa22acb12307182113" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from numpy import array
from numpy import argmax
from sklearn.preprocessing import LabelEncoder
from sklearn.preprocessing import OneHotEncoder
# define example
data = ['cold', 'cold', 'warm', 'cold', 'hot', 'hot', 'warm', 'cold', 'warm', 'hot']
values = array(data)
print(values)
# integer encode
label_encoder = LabelEncoder()
integer_encoded = label_encoder.fit_transform(values)
print(integer_encoded)
# binary encode
onehot_encoder = OneHotEncoder(sparse=False)
integer_encoded = integer_encoded.reshape(len(integer_encoded), 1)
onehot_encoded = onehot_encoder.fit_transform(integer_encoded)
print(onehot_encoded)
# invert first example
inverted = label_encoder.inverse_transform([argmax(onehot_encoded[0, :])])
print(inverted)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa22acb12307182113-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb12307182113-2">2</div><div class="crayon-num" data-line="crayon-5c0caa22acb12307182113-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb12307182113-4">4</div><div class="crayon-num" data-line="crayon-5c0caa22acb12307182113-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb12307182113-6">6</div><div class="crayon-num" data-line="crayon-5c0caa22acb12307182113-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb12307182113-8">8</div><div class="crayon-num" data-line="crayon-5c0caa22acb12307182113-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb12307182113-10">10</div><div class="crayon-num" data-line="crayon-5c0caa22acb12307182113-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb12307182113-12">12</div><div class="crayon-num" data-line="crayon-5c0caa22acb12307182113-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb12307182113-14">14</div><div class="crayon-num" data-line="crayon-5c0caa22acb12307182113-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb12307182113-16">16</div><div class="crayon-num" data-line="crayon-5c0caa22acb12307182113-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb12307182113-18">18</div><div class="crayon-num" data-line="crayon-5c0caa22acb12307182113-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb12307182113-20">20</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa22acb12307182113-1"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb12307182113-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">argmax</span></div><div class="crayon-line" id="crayon-5c0caa22acb12307182113-3"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">LabelEncoder</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb12307182113-4"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-v">OneHotEncoder</span></div><div class="crayon-line" id="crayon-5c0caa22acb12307182113-5"><span class="crayon-p"># define example</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb12307182113-6"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'cold'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'cold'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'warm'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'cold'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'hot'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'hot'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'warm'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'cold'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'warm'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'hot'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa22acb12307182113-7"><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb12307182113-8"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa22acb12307182113-9"><span class="crayon-p"># integer encode</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb12307182113-10"><span class="crayon-v">label_encoder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LabelEncoder</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa22acb12307182113-11"><span class="crayon-v">integer_encoded</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">label_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb12307182113-12"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">integer_encoded</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa22acb12307182113-13"><span class="crayon-p"># binary encode</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb12307182113-14"><span class="crayon-v">onehot_encoder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">OneHotEncoder</span><span class="crayon-sy">(</span><span class="crayon-v">sparse</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa22acb12307182113-15"><span class="crayon-v">integer_encoded</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">integer_encoded</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">integer_encoded</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb12307182113-16"><span class="crayon-v">onehot_encoded</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">onehot_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">integer_encoded</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa22acb12307182113-17"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">onehot_encoded</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb12307182113-18"><span class="crayon-p"># invert first example</span></div><div class="crayon-line" id="crayon-5c0caa22acb12307182113-19"><span class="crayon-v">inverted</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">label_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">onehot_encoded</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb12307182113-20"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">inverted</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>Running the example first prints the sequence of labels. This is followed by the integer encoding of the labels and finally the one hot encoding.</p>
<p>The training data contained the set of all possible examples so we could rely on the integer and one hot encoding transforms to create a complete mapping of labels to encodings.</p>
<p>By default, the OneHotEncoder class will return a more efficient sparse encoding. This may not be suitable for some applications, such as use with the Keras deep learning library. In this case, we disabled the sparse return type by setting the <em>sparse=False</em> argument.</p>
<p>If we receive a prediction in this 3-value one hot encoding, we can easily invert the transform back to the original label.</p>
<p>First, we can use the argmax() NumPy function to locate the index of the column with the largest value. This can then be fed to the LabelEncoder to calculate an inverse transform back to a text label.</p>
<p>This is demonstrated at the end of the example with the inverse transform of the first one hot encoded example back to the label value ‘cold’.</p>
<p>Again, note that input was formatted for readability.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa22acb14874564207" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
['cold' 'cold' 'warm' 'cold' 'hot' 'hot' 'warm' 'cold' 'warm' 'hot']

[0 0 2 0 1 1 2 0 2 1]

[[ 1.  0.  0.]
 [ 1.  0.  0.]
 [ 0.  0.  1.]
 [ 1.  0.  0.]
 [ 0.  1.  0.]
 [ 0.  1.  0.]
 [ 0.  0.  1.]
 [ 1.  0.  0.]
 [ 0.  0.  1.]
 [ 0.  1.  0.]]

['cold']</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa22acb14874564207-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb14874564207-2">2</div><div class="crayon-num" data-line="crayon-5c0caa22acb14874564207-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb14874564207-4">4</div><div class="crayon-num" data-line="crayon-5c0caa22acb14874564207-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb14874564207-6">6</div><div class="crayon-num" data-line="crayon-5c0caa22acb14874564207-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb14874564207-8">8</div><div class="crayon-num" data-line="crayon-5c0caa22acb14874564207-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb14874564207-10">10</div><div class="crayon-num" data-line="crayon-5c0caa22acb14874564207-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb14874564207-12">12</div><div class="crayon-num" data-line="crayon-5c0caa22acb14874564207-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb14874564207-14">14</div><div class="crayon-num" data-line="crayon-5c0caa22acb14874564207-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb14874564207-16">16</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa22acb14874564207-1">['cold' 'cold' 'warm' 'cold' 'hot' 'hot' 'warm' 'cold' 'warm' 'hot']</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb14874564207-2"> </div><div class="crayon-line" id="crayon-5c0caa22acb14874564207-3">[0 0 2 0 1 1 2 0 2 1]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb14874564207-4"> </div><div class="crayon-line" id="crayon-5c0caa22acb14874564207-5">[[ 1.  0.  0.]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb14874564207-6"> [ 1.  0.  0.]</div><div class="crayon-line" id="crayon-5c0caa22acb14874564207-7"> [ 0.  0.  1.]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb14874564207-8"> [ 1.  0.  0.]</div><div class="crayon-line" id="crayon-5c0caa22acb14874564207-9"> [ 0.  1.  0.]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb14874564207-10"> [ 0.  1.  0.]</div><div class="crayon-line" id="crayon-5c0caa22acb14874564207-11"> [ 0.  0.  1.]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb14874564207-12"> [ 1.  0.  0.]</div><div class="crayon-line" id="crayon-5c0caa22acb14874564207-13"> [ 0.  0.  1.]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb14874564207-14"> [ 0.  1.  0.]]</div><div class="crayon-line" id="crayon-5c0caa22acb14874564207-15"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb14874564207-16">['cold']</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>In the next example, we look at how we can directly one hot encode a sequence of integer values.</p>
<h2>One Hot Encode with Keras</h2>
<p>You may have a sequence that is already integer encoded.</p>
<p>You could work with the integers directly, after some scaling. Alternately, you can one hot encode the integers directly. This is important to consider if the integers do not have a real ordinal relationship and are really just placeholders for labels.</p>
<p>The Keras library offers a function called <a href="https://keras.io/utils/#to_categorical">to_categorical()</a> that you can use to one hot encode integer data.</p>
<p>In this example, we have 4 integer values [0, 1, 2, 3] and we have the input sequence of the following 10 numbers:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa22acb16781474487" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
data = [1, 3, 2, 0, 3, 2, 2, 1, 0, 1]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa22acb16781474487-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa22acb16781474487-1">data = [1, 3, 2, 0, 3, 2, 2, 1, 0, 1]</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>The sequence has an example of all known values so we can use the to_categorical() function directly. Alternately, if the sequence was 0-based (started at 0) and was not representative of all possible values, we could specify the num_classes argument <em>to_categorical(num_classes=4)</em>.</p>
<p>A complete example of this function is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa22acb18095170100" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from numpy import array
from numpy import argmax
from keras.utils import to_categorical
# define example
data = [1, 3, 2, 0, 3, 2, 2, 1, 0, 1]
data = array(data)
print(data)
# one hot encode
encoded = to_categorical(data)
print(encoded)
# invert encoding
inverted = argmax(encoded[0])
print(inverted)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa22acb18095170100-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb18095170100-2">2</div><div class="crayon-num" data-line="crayon-5c0caa22acb18095170100-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb18095170100-4">4</div><div class="crayon-num" data-line="crayon-5c0caa22acb18095170100-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb18095170100-6">6</div><div class="crayon-num" data-line="crayon-5c0caa22acb18095170100-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb18095170100-8">8</div><div class="crayon-num" data-line="crayon-5c0caa22acb18095170100-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb18095170100-10">10</div><div class="crayon-num" data-line="crayon-5c0caa22acb18095170100-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb18095170100-12">12</div><div class="crayon-num" data-line="crayon-5c0caa22acb18095170100-13">13</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa22acb18095170100-1"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb18095170100-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">argmax</span></div><div class="crayon-line" id="crayon-5c0caa22acb18095170100-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-v">to_categorical</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb18095170100-4"><span class="crayon-p"># define example</span></div><div class="crayon-line" id="crayon-5c0caa22acb18095170100-5"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb18095170100-6"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa22acb18095170100-7"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb18095170100-8"><span class="crayon-p"># one hot encode</span></div><div class="crayon-line" id="crayon-5c0caa22acb18095170100-9"><span class="crayon-v">encoded</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb18095170100-10"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">encoded</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa22acb18095170100-11"><span class="crayon-p"># invert encoding</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb18095170100-12"><span class="crayon-v">inverted</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">encoded</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa22acb18095170100-13"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">inverted</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>Running the example first defines and prints the input sequence.</p>
<p>The integers are then encoded as binary vectors and printed. We can see that the first integer value 1 is encoded as [0, 1, 0, 0] just like we would expect.</p>
<p>We then invert the encoding by using the NumPy argmax() function on the first value in the sequence that returns the expected value 1 for the first integer.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa22acb1a112198451" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
[1 3 2 0 3 2 2 1 0 1]

[[ 0.  1.  0.  0.]
 [ 0.  0.  0.  1.]
 [ 0.  0.  1.  0.]
 [ 1.  0.  0.  0.]
 [ 0.  0.  0.  1.]
 [ 0.  0.  1.  0.]
 [ 0.  0.  1.  0.]
 [ 0.  1.  0.  0.]
 [ 1.  0.  0.  0.]
 [ 0.  1.  0.  0.]]

1</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa22acb1a112198451-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb1a112198451-2">2</div><div class="crayon-num" data-line="crayon-5c0caa22acb1a112198451-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb1a112198451-4">4</div><div class="crayon-num" data-line="crayon-5c0caa22acb1a112198451-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb1a112198451-6">6</div><div class="crayon-num" data-line="crayon-5c0caa22acb1a112198451-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb1a112198451-8">8</div><div class="crayon-num" data-line="crayon-5c0caa22acb1a112198451-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb1a112198451-10">10</div><div class="crayon-num" data-line="crayon-5c0caa22acb1a112198451-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb1a112198451-12">12</div><div class="crayon-num" data-line="crayon-5c0caa22acb1a112198451-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22acb1a112198451-14">14</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa22acb1a112198451-1">[1 3 2 0 3 2 2 1 0 1]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb1a112198451-2"> </div><div class="crayon-line" id="crayon-5c0caa22acb1a112198451-3">[[ 0.  1.  0.  0.]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb1a112198451-4"> [ 0.  0.  0.  1.]</div><div class="crayon-line" id="crayon-5c0caa22acb1a112198451-5"> [ 0.  0.  1.  0.]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb1a112198451-6"> [ 1.  0.  0.  0.]</div><div class="crayon-line" id="crayon-5c0caa22acb1a112198451-7"> [ 0.  0.  0.  1.]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb1a112198451-8"> [ 0.  0.  1.  0.]</div><div class="crayon-line" id="crayon-5c0caa22acb1a112198451-9"> [ 0.  0.  1.  0.]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb1a112198451-10"> [ 0.  1.  0.  0.]</div><div class="crayon-line" id="crayon-5c0caa22acb1a112198451-11"> [ 1.  0.  0.  0.]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb1a112198451-12"> [ 0.  1.  0.  0.]]</div><div class="crayon-line" id="crayon-5c0caa22acb1a112198451-13"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22acb1a112198451-14">1</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p></p>
<h2>Further Reading</h2>
<p>This section lists some resources for further reading.</p>
<ul>
<li><a href="https://www.quora.com/What-is-one-hot-encoding-and-when-is-it-used-in-data-science">What is one hot encoding and when is it used in data science?</a> on Quora</li>
<li><a href="http://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html">OneHotEncoder scikit-learn API documentation</a></li>
<li><a href="http://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html">LabelEncoder scikit-learn API documentation</a></li>
<li><a href="https://keras.io/utils/#to_categorical">to_categorical Keras API documentation</a></li>
<li><a href="http://machinelearningmastery.com/data-preparation-gradient-boosting-xgboost-python/">Data Preparation for Gradient Boosting with XGBoost in Python</a></li>
<li><a href="http://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/">Multi-Class Classification Tutorial with the Keras Deep Learning Library</a></li>
</ul>
<h2>Summary</h2>
<p>In this tutorial, you discovered how to encode your categorical sequence data for deep learning using a one hot encoding in Python.</p>
<p>Specifically, you learned:</p>
<ul>
<li>What integer encoding and one hot encoding are and why they are necessary in machine learning.</li>
<li>How to calculate an integer encoding and one hot encoding by hand in Python.</li>
<li>How to use the scikit-learn and Keras libraries to automatically encode your sequence data in Python.</li>
</ul>
<p>Do you have any questions about preparing your sequence data?<br/>
Ask your questions in the comments and I will do my best to answer.</p>
<div class="awac-wrapper"><div class="awac widget text-30"> <div class="textwidget"><div class="woo-sc-hr"></div>
<p></p><center>
<h2>Develop LSTMs for Sequence Prediction Today!</h2>
<p><a href="/lstms-with-python/"><img align="left" alt="Long Short-Term Memory Networks with Python" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/07/Cover-220.png" style="border: 0;"/></a></p>
<h4>Develop Your Own LSTM models in Minutes</h4>
<p>…with just a few lines of python code</p>
<p>Discover how in my new Ebook:<br/>
<a href="/lstms-with-python/">Long Short-Term Memory Networks with Python</a></p>
<p>It provides <strong>self-study tutorials</strong> on topics like:<br/>
<em>CNN LSTMs, Encoder-Decoder LSTMs, generative models, data preparation, making predictions</em> and much more…</p>
<h4>Finally Bring LSTM Recurrent Neural Networks to<br/>
Your Sequence Predictions Projects</h4>
<p>Skip the Academics. Just Results.</p>
<p><a href="/lstms-with-python/">Click to learn more</a>.<br/>
</p></center><br/>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-4129 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+One+Hot+Encode+Sequence+Data+in+Python&amp;url=https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
</section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/remove-trends-seasonality-difference-transform-python/" rel="prev"><i class="fa fa-angle-left"></i> How to Remove Trends and Seasonality with a Difference Transform in Python</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/difference-test-validation-datasets/" rel="next">What is the Difference Between Test and Validation Datasets? <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">105 Responses to <em>How to One Hot Encode Sequence Data in Python</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-405657">
<div class="comment-container" id="li-comment-405657">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e2440bf842896c705da5e32ff00436e7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e2440bf842896c705da5e32ff00436e7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Natallia Lundqvist</span>
<span class="date">July 12, 2017 at 7:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-405657" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for this post! It came really timely. A question. Utility to_categorical(data) accepts vector as input. What would one do in case you have a 2D tensor as input? Would you loop over number of samples (could be several hundred of thousands entries + do the model training in a loop) or one would have to do seq = tokenizer.texts_to_sequences(inputseq) and then tokenizer.sequences_to_matrix(seq, mode=’binary’)?? The last option will give a 2D tensor as output in form array([ 0.,  1.,  1., …,  0.,  0.,  0.]). In that case model training goes as usual, but for decoding predictions one would have to loop to find all maximums (argmax give ONLY the first maximum).</p>
<div class="reply">
<a aria-label="Reply to Natallia Lundqvist" class="comment-reply-link" href="#comment-405657" onclick='return addComment.moveForm( "comment-405657", "405657", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-405720">
<div class="comment-container" id="li-comment-405720">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 13, 2017 at 9:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-405720" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ouch, it is hard to give good advice without specifics. Choose a formulation that preserves the structure of your sequence.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-405720" onclick='return addComment.moveForm( "comment-405720", "405720", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-405820">
<div class="comment-container" id="li-comment-405820">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1b3b04ffee3cfc4f6395f3127d36304b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1b3b04ffee3cfc4f6395f3127d36304b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Franco</span>
<span class="date">July 14, 2017 at 5:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-405820" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Awesome post again Jason! Thank you. I’ve just added it to my ML checklist.</p>
<div class="reply">
<a aria-label="Reply to Franco" class="comment-reply-link" href="#comment-405820" onclick='return addComment.moveForm( "comment-405820", "405820", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-405851">
<div class="comment-container" id="li-comment-405851">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 14, 2017 at 8:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-405851" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Excellent Franco!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-405851" onclick='return addComment.moveForm( "comment-405851", "405851", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-405867">
<div class="comment-container" id="li-comment-405867">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7b7841540ee5d0f75cc60343a0944abd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7b7841540ee5d0f75cc60343a0944abd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rohit</span>
<span class="date">July 14, 2017 at 10:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-405867" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>how do we perform integer encoding in keras ? Is there any inbuild function like LabelEncoder in scikit ?</p>
<div class="reply">
<a aria-label="Reply to Rohit" class="comment-reply-link" href="#comment-405867" onclick='return addComment.moveForm( "comment-405867", "405867", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-405991">
<div class="comment-container" id="li-comment-405991">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 15, 2017 at 9:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-405991" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not really. You can do it manually.</p>
<p>If you’re working with text, there are tools here:<br/>
<a href="https://keras.io/preprocessing/text/" rel="nofollow">https://keras.io/preprocessing/text/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-405991" onclick='return addComment.moveForm( "comment-405991", "405991", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-407121">
<div class="comment-container" id="li-comment-407121">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/46ac59ca825fb00c62ef6dca7a287665?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/46ac59ca825fb00c62ef6dca7a287665?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Moe</span>
<span class="date">July 24, 2017 at 2:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-407121" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Great article!</p>
<p>What if the sequence was not representative of all possible values, and we don’t know the num of classes to set the num_classes argument?</p>
<div class="reply">
<a aria-label="Reply to Moe" class="comment-reply-link" href="#comment-407121" onclick='return addComment.moveForm( "comment-407121", "407121", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-407210">
<div class="comment-container" id="li-comment-407210">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 25, 2017 at 9:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-407210" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<p>Yes, that is a challenge. </p>
<p>Off the cuff, you may need to re-encode data in the future. Or choose an encoding that has “space” for new values that you have not seen yet. I expect there is some good research on this topic.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-407210" onclick='return addComment.moveForm( "comment-407210", "407210", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-409971">
<div class="comment-container" id="li-comment-409971">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b0dffa1b0e0991ce1b2f2c00b6f97a90?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b0dffa1b0e0991ce1b2f2c00b6f97a90?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Malcolm</span>
<span class="date">August 17, 2017 at 9:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-409971" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Informative post as always! </p>
<p>I understand how this is used to train a model.<br/>
However, how can you ensure that data you want to get predictions for is encoded in the same way as the training data? E.g. ‘hot’ maps to column 3. </p>
<p>For my application once the model is trained it will need to provide predictions at a later date and on different machines.</p>
<div class="reply">
<a aria-label="Reply to Malcolm" class="comment-reply-link" href="#comment-409971" onclick='return addComment.moveForm( "comment-409971", "409971", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-410012">
<div class="comment-container" id="li-comment-410012">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 18, 2017 at 6:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-410012" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question!</p>
<p>It must be consistent. Either you use the same code, and/or you save the “model” that performs the transform.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-410012" onclick='return addComment.moveForm( "comment-410012", "410012", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-413460">
<div class="comment-container" id="li-comment-413460">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0fe411a9390ba408aa7b5988e620d70d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0fe411a9390ba408aa7b5988e620d70d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sasi</span>
<span class="date">September 11, 2017 at 4:16 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-413460" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank u!!!!!! great work……….</p>
<div class="reply">
<a aria-label="Reply to sasi" class="comment-reply-link" href="#comment-413460" onclick='return addComment.moveForm( "comment-413460", "413460", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-413631">
<div class="comment-container" id="li-comment-413631">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 13, 2017 at 12:21 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-413631" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-413631" onclick='return addComment.moveForm( "comment-413631", "413631", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-415037">
<div class="comment-container" id="li-comment-415037">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8c62cab1bf8f250254f647432ffd1489?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8c62cab1bf8f250254f647432ffd1489?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">NVK</span>
<span class="date">September 29, 2017 at 3:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-415037" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey there,<br/>
Great tutorial as always!<br/>
Quick question though – what if my dataset contains both categorical and continuous values? Wouldn’t OH encoding encode the entire dataset, when all I really need is just the categorical columns encoded?<br/>
Also would the recommended flow be to (a) scale the numeric data only (b) encode the whole dataset?<br/>
Or (a) encode the whole dataset and then (b) scale all values?</p>
<div class="reply">
<a aria-label="Reply to NVK" class="comment-reply-link" href="#comment-415037" onclick='return addComment.moveForm( "comment-415037", "415037", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415049">
<div class="comment-container" id="li-comment-415049">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 29, 2017 at 5:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-415049" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend only encoding the categorical variables.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-415049" onclick='return addComment.moveForm( "comment-415049", "415049", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-445504">
<div class="comment-container" id="li-comment-445504">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e0b7a24ec4997afeef4ba7cc2e411023?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e0b7a24ec4997afeef4ba7cc2e411023?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ola</span>
<span class="date">August 8, 2018 at 5:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-445504" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice post!</p>
<div class="reply">
<a aria-label="Reply to Ola" class="comment-reply-link" href="#comment-445504" onclick='return addComment.moveForm( "comment-445504", "445504", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-415505">
<div class="comment-container" id="li-comment-415505">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f2c3d671852d28044c203cd2ddf9b782?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f2c3d671852d28044c203cd2ddf9b782?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ed</span>
<span class="date">October 4, 2017 at 5:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-415505" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi there,</p>
<p>I am working on model productization. To reduce the data processing gap between experiment and production, would like to  embed one hot encoding in Keras model. The questions are</p>
<p>1. When using “to_categorical”, it will convert categorical on the fly and it seems break the encoding. For example, we have “apple”, “orange” and “banana” when training model. After rollout the model, there include unseen category such as “lemon”. How can we handle this kind of scenario?</p>
<p>2. As want to embed the encoding in Keras. Therefore, trying to not using sklearn label encoder and one hot encoder. Does it possible to do that? </p>
<p>Please kindly advise.</p>
<div class="reply">
<a aria-label="Reply to ed" class="comment-reply-link" href="#comment-415505" onclick='return addComment.moveForm( "comment-415505", "415505", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-415521">
<div class="comment-container" id="li-comment-415521">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 4, 2017 at 5:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-415521" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps you can develop your own small function to perform the encoding and perform it consistently?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-415521" onclick='return addComment.moveForm( "comment-415521", "415521", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-415672">
<div class="comment-container" id="li-comment-415672">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/136d9909976df04214d0bc0274515759?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/136d9909976df04214d0bc0274515759?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Adhaar Sharma</span>
<span class="date">October 5, 2017 at 8:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-415672" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Love the website! Had a quick question:</p>
<p>If I have a X dataset of 6 categorical attributes, where each attribute has lets say the following number of unique categories respectively [4, 4, 4, 3, 3, 3]. Also lets say there are 600 instances</p>
<p>When I LabelEncode and then OneHotEncode this X dataset, I now rightly get a sequence of 21 0-1 values after the toarray() method on the fit_transform.</p>
<p>However, when I input the X dataset like that, i.e. with a shape of (600, 21), I get a much worse error than if I had just left it LabelEncoded and with a shape of (600, 6).</p>
<p>My question is am I doing something wrong? Should I be re-grouping the sequence of 21 integers that I get back into their respective clusters? For ex: I get this array for the first row as a result of the OneHotEncode:<br/>
[0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0]<br/>
so should I group the digits back into something like this<br/>
[(0, 0, 0, 1), (0, 0, 0, 1), (0, 0, 0, 1), (0, 0, 1), (0, 0, 1), (0, 1, 0)]<br/>
where now we again have a (600, 6) shape for my input dataset? </p>
<p>I tried creating a numpy array with this formulation but the sci-kit decision tree classifier checks and tries to convert any numpy array where the dtype is an object, and thus the tuples did not validate.</p>
<p>Essentially, I want to know whether the (600, 21) shape is causing any data loss being in that format. And if it is what is the best way to regroup the encodings into their respective attributes so I can lower my error.</p>
<p>Thank you!</p>
<div class="reply">
<a aria-label="Reply to Adhaar Sharma" class="comment-reply-link" href="#comment-415672" onclick='return addComment.moveForm( "comment-415672", "415672", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-415713">
<div class="comment-container" id="li-comment-415713">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 5, 2017 at 5:21 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-415713" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hmmm.</p>
<p>The data should be 500, 21 after the encoding, so far so good.</p>
<p>No need to group. </p>
<p>Skill better or worse depends on the algorithm and your specific data. Everything is a test to help us discover what works for our problem. </p>
<p>Consider trying more algorithms.<br/>
Consider trying encoding only some variables and leaving others as-is or integer encode.<br/>
Brainstorm more things to try, see this post for ideas:<br/>
<a href="http://machinelearningmastery.com/machine-learning-performance-improvement-cheat-sheet/" rel="nofollow">http://machinelearningmastery.com/machine-learning-performance-improvement-cheat-sheet/</a></p>
<p>I hope that helps as a start.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-415713" onclick='return addComment.moveForm( "comment-415713", "415713", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-415765">
<div class="comment-container" id="li-comment-415765">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/136d9909976df04214d0bc0274515759?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/136d9909976df04214d0bc0274515759?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Adhaar Sharma</span>
<span class="date">October 6, 2017 at 5:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-415765" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Okay, great! I just wasn’t sure whether to debug the onehot encoder or try other things. Looks like trying other things is the way to go.</p>
<p>Thanks you so much for your help Jason!</p>
<div class="reply">
<a aria-label="Reply to Adhaar Sharma" class="comment-reply-link" href="#comment-415765" onclick='return addComment.moveForm( "comment-415765", "415765", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-416161">
<div class="comment-container" id="li-comment-416161">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cba01030fbbb56368eb05d276348a299?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cba01030fbbb56368eb05d276348a299?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Prashant</span>
<span class="date">October 10, 2017 at 4:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-416161" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hii,<br/>
Great tutorial as always!<br/>
I am having a doubt…Why we are reshaping the integer_encoded vector<br/>
“integer_encoded = integer_encoded.reshape(len(integer_encoded), 1)”?</p>
<div class="reply">
<a aria-label="Reply to Prashant" class="comment-reply-link" href="#comment-416161" onclick='return addComment.moveForm( "comment-416161", "416161", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-416187">
<div class="comment-container" id="li-comment-416187">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 10, 2017 at 7:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-416187" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question, because the sklearn tools expect 2D data as input.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-416187" onclick='return addComment.moveForm( "comment-416187", "416187", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-422692">
<div class="comment-container" id="li-comment-422692">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3d07a7b4845fb7c5c7b25a541e686818?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3d07a7b4845fb7c5c7b25a541e686818?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Dolunay</span>
<span class="date">December 11, 2017 at 1:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-422692" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello,</p>
<p>Thanks a lot for your great posts!<br/>
There are some studies using only the index of the words without turning them into one-hot,</p>
<p>such as:<br/>
[7, 4, 11, 11, 14, 26, 22, 14, 17, 11, 3]</p>
<p>they just use this sequence as input. I’d like to ask that since we generate indexes starting from 0, wouldn’t it be a problem when we’re doing 0-padding?</p>
<p>Thanks a lot!</p>
<div class="reply">
<a aria-label="Reply to Dolunay" class="comment-reply-link" href="#comment-422692" onclick='return addComment.moveForm( "comment-422692", "422692", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-422716">
<div class="comment-container" id="li-comment-422716">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 11, 2017 at 5:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-422716" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The 0 is often reserved for “no word” or “unknown word”.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-422716" onclick='return addComment.moveForm( "comment-422716", "422716", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-422726">
<div class="comment-container" id="li-comment-422726">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3d07a7b4845fb7c5c7b25a541e686818?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3d07a7b4845fb7c5c7b25a541e686818?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Dolunay</span>
<span class="date">December 11, 2017 at 6:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-422726" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ok, but in one-hot form, why didn’t we  reserve 0 position for unknown word?</p>
<div class="reply">
<a aria-label="Reply to Dolunay" class="comment-reply-link" href="#comment-422726" onclick='return addComment.moveForm( "comment-422726", "422726", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-422763">
<div class="comment-container" id="li-comment-422763">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 11, 2017 at 4:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-422763" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This happens automatically when using libraries such as Keras to perform the encoding. We can also do that manually.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-422763" onclick='return addComment.moveForm( "comment-422763", "422763", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-422780">
<div class="comment-container" id="li-comment-422780">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3d07a7b4845fb7c5c7b25a541e686818?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3d07a7b4845fb7c5c7b25a541e686818?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Dolunay</span>
<span class="date">December 11, 2017 at 7:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-422780" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m doing it manually, at some point I became suspicious whether I was doing wrong, this is how I create char-index dictionaries.</p>
<p>	ch_ind = dict((c, i+1) for i, c in enumerate(s_chars))<br/>
	ind_ch = dict((i+1, c) for i, c in enumerate(s_chars))</p>
<p>then this is how I create my one hot encoding,</p>
<p>	X = np.zeros((MAX_LEN, len(ch_ind))) </p>
<p>	for i, ch in enumerate(line[:MAX_LEN]):<br/>
		X[i, (ch_ind[ch])] = 1 </p>
<p>	return X</p>
<p>This means that I won’t  have the following encoding, since I dont have a char at point 0,</p>
<p>[1 0 0 0 …]</p>
<p>But does this really achieve saving point 0 for padding?</p>
<p>Thanks a lot for your time!</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-425843">
<div class="comment-container" id="li-comment-425843">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ae55ee265104e50fa9624d42baad260b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ae55ee265104e50fa9624d42baad260b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Satish Chilloji</span>
<span class="date">January 8, 2018 at 5:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-425843" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>What if we have categorical variables with levels more than 500? How to deal with this, Is it OHE? Which will in return gives high number columns.</p>
<div class="reply">
<a aria-label="Reply to Satish Chilloji" class="comment-reply-link" href="#comment-425843" onclick='return addComment.moveForm( "comment-425843", "425843", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425855">
<div class="comment-container" id="li-comment-425855">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 8, 2018 at 5:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-425855" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Try it and see.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425855" onclick='return addComment.moveForm( "comment-425855", "425855", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-426046">
<div class="comment-container" id="li-comment-426046">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6df474daa81723ffedff12cee7e69628?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6df474daa81723ffedff12cee7e69628?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ion</span>
<span class="date">January 10, 2018 at 5:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-426046" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>how to proceed when all input data are categories?</p>
<div class="reply">
<a aria-label="Reply to Ion" class="comment-reply-link" href="#comment-426046" onclick='return addComment.moveForm( "comment-426046", "426046", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426074">
<div class="comment-container" id="li-comment-426074">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 10, 2018 at 5:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-426074" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can use a label encoder and perhaps even a one hot encoder on all of them.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426074" onclick='return addComment.moveForm( "comment-426074", "426074", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-426575">
<div class="comment-container" id="li-comment-426575">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f258da42427a18e6231ce1fcad89bbc9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f258da42427a18e6231ce1fcad89bbc9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Adwait Chandorkar</span>
<span class="date">January 15, 2018 at 6:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-426575" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Dr.Jason,</p>
<p>I have a CSV dataset where some of the values are floating point values while the rest are labels. If i use one-hot encoding for the labels, they will be converted into binary vectors. However, the other values are floating.</p>
<p>I want to train a classifier on this data. Is it correct to train a classifier using a dataset with combination of binary vectors and floating point values? Shouldn’t all the parameters in the dataset should be of the same data-type?</p>
<div class="reply">
<a aria-label="Reply to Adwait Chandorkar" class="comment-reply-link" href="#comment-426575" onclick='return addComment.moveForm( "comment-426575", "426575", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426591">
<div class="comment-container" id="li-comment-426591">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 15, 2018 at 7:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-426591" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, train on the combined original and encoded variables.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426591" onclick='return addComment.moveForm( "comment-426591", "426591", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-427645">
<div class="comment-container" id="li-comment-427645">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/13ca2917294cd3de876326daf01ba9dc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/13ca2917294cd3de876326daf01ba9dc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Gunter</span>
<span class="date">January 26, 2018 at 5:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-427645" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>your articles are an excellent source for newbies like me! Thank you indeed for putting so much energy into it, Sir!<br/>
I found that pandas.Dataframe has a nice method to do one-hot encoding as well by using get_dummies which is very handy ( <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.get_dummies.html" rel="nofollow">https://pandas.pydata.org/pandas-docs/stable/generated/pandas.get_dummies.html</a> ).</p>
<div class="reply">
<a aria-label="Reply to Gunter" class="comment-reply-link" href="#comment-427645" onclick='return addComment.moveForm( "comment-427645", "427645", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-427699">
<div class="comment-container" id="li-comment-427699">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 27, 2018 at 5:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-427699" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-427699" onclick='return addComment.moveForm( "comment-427699", "427699", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-429081">
<div class="comment-container" id="li-comment-429081">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a9a82d05d71503b7c693d0f6410d35b2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a9a82d05d71503b7c693d0f6410d35b2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">mohammed musaib</span>
<span class="date">February 11, 2018 at 6:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-429081" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have a ? in hypothroid dataset , how do i handle this type of stuff. pls let me know your good solution</p>
<div class="reply">
<a aria-label="Reply to mohammed musaib" class="comment-reply-link" href="#comment-429081" onclick='return addComment.moveForm( "comment-429081", "429081", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-429130">
<div class="comment-container" id="li-comment-429130">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 12, 2018 at 8:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-429130" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This process will help you work through your predictive modeling problem:<br/>
<a href="https://machinelearningmastery.com/start-here/#process" rel="nofollow">https://machinelearningmastery.com/start-here/#process</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-429130" onclick='return addComment.moveForm( "comment-429130", "429130", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-429035">
<div class="comment-container" id="li-comment-429035">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/eb05e181ca9874c93fa5812b5f270959?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/eb05e181ca9874c93fa5812b5f270959?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sacha_yacoubi</span>
<span class="date">February 11, 2018 at 3:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-429035" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear jason,<br/>
Once we use one_hot_encoder to represent categorical attributes that take a large number of values  ,we can end up having a very large matrix. Could you please explain the idea behind “Embeddings” in Neural networks to overcome this issue? </p>
<p>Regards.</p>
<div class="reply">
<a aria-label="Reply to Sacha_yacoubi" class="comment-reply-link" href="#comment-429035" onclick='return addComment.moveForm( "comment-429035", "429035", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-429055">
<div class="comment-container" id="li-comment-429055">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 11, 2018 at 7:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-429055" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure, see these posts:<br/>
<a href="https://machinelearningmastery.com/?s=word+embedding&amp;submit=Search" rel="nofollow">https://machinelearningmastery.com/?s=word+embedding&amp;submit=Search</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-429055" onclick='return addComment.moveForm( "comment-429055", "429055", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-429916">
<div class="comment-container" id="li-comment-429916">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9f497e18136ed39df6ae600f8d21fbdd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9f497e18136ed39df6ae600f8d21fbdd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vish</span>
<span class="date">February 19, 2018 at 11:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-429916" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Great post as always.  Since categorical(non-numeric)  data in most cases has to be One Hot Encoded, just wondering why there is no direct method which takes categorical data and returns a one-hot-encoded data set directly instead of the user always having to call label Encoder to get the data integer encoded first?</p>
<div class="reply">
<a aria-label="Reply to vish" class="comment-reply-link" href="#comment-429916" onclick='return addComment.moveForm( "comment-429916", "429916", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-429939">
<div class="comment-container" id="li-comment-429939">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 19, 2018 at 3:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-429939" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sometimes there is benefit on working with the integer encoded values instead.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-429939" onclick='return addComment.moveForm( "comment-429939", "429939", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-430801">
<div class="comment-container" id="li-comment-430801">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d95cc0796f07e552a88f0c616c8a59aa?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d95cc0796f07e552a88f0c616c8a59aa?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">maryam</span>
<span class="date">March 1, 2018 at 8:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-430801" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I appreciate the clear tutorial u have written, especially for a novice like me.<br/>
I want to gain a probability output instead of the label of class as an output.<br/>
I know I should apply “”model.add(Dense(2, activation=’sigmoid’))”” instead of applying “”model.add(Dense(1, activation=’sigmoid’))”” and also i should use commands which in “One Hot Encode with Keras”.<br/>
But I doubt whether I should put class labels in data = [1, 3, 2, 0, 3, 2, 2, 1, 0, 1] or not. I mean instead of data = [1, 3, 2, 0, 3, 2, 2, 1, 0, 1] should I write data =[0,1]. I have a binary classification problem for text dataset.<br/>
would u mind please answering me by a tutorial link or even by writing command?<br/>
Waiting for your replying.</p>
<div class="reply">
<a aria-label="Reply to maryam" class="comment-reply-link" href="#comment-430801" onclick='return addComment.moveForm( "comment-430801", "430801", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-430817">
<div class="comment-container" id="li-comment-430817">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 1, 2018 at 3:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-430817" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can make probability predictions by calling predict_proba() on your model.</p>
<p>For a binary outcome, you can use a single node in the output layer and the outcome will be a 0 or 1, not a one hot encoded class.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430817" onclick='return addComment.moveForm( "comment-430817", "430817", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-430867">
<div class="comment-container" id="li-comment-430867">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d95cc0796f07e552a88f0c616c8a59aa?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d95cc0796f07e552a88f0c616c8a59aa?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Maryam</span>
<span class="date">March 2, 2018 at 7:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-430867" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi dear Jason,<br/>
I appreciate the time you spend replying me.<br/>
I do not want to achieve 0,1 outcome. I want to achieve possible output such as 90% for class “good”, 10% for class “bad”.<br/>
I do not want to gain neither the label as output nor f-measure or accuracy.<br/>
I want to gain similarity measure = probability measure for lstm, cnn, rnn. I should write k fold cross-validation to build a model which can achieve similarity measure for each label.<br/>
Please give me a tutorial to write k fold-cross validation to building a model to achieving possible output by a similarity measure.</p>
<p>“””If I want to mention briefly, I want to read about how I can write k-fold cross validation commands and also i want to know what the function of similarity measure is in Keras?”””<br/>
Thank u for helping a novice so clear.<br/>
Best wishes</p>
<div class="reply">
<a aria-label="Reply to Maryam" class="comment-reply-link" href="#comment-430867" onclick='return addComment.moveForm( "comment-430867", "430867", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-430886">
<div class="comment-container" id="li-comment-430886">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 2, 2018 at 3:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-430886" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is a probability outcome. You can achieve this with a binary outcome bu calling predict() and using the value and 1 – value to get the probabilities for class 1 and class 0 respectively.</p>
<p>Cross validation is only used to estimate the skill of the model. After you have an estimate of model skill, the CV folds and models are discarded and you can fit a final model to be used to make predictions. Learn more about this here:<br/>
<a href="https://machinelearningmastery.com/train-final-machine-learning-model/" rel="nofollow">https://machinelearningmastery.com/train-final-machine-learning-model/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430886" onclick='return addComment.moveForm( "comment-430886", "430886", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-430918">
<div class="comment-container" id="li-comment-430918">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d95cc0796f07e552a88f0c616c8a59aa?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d95cc0796f07e552a88f0c616c8a59aa?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Maryam</span>
<span class="date">March 2, 2018 at 10:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-430918" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thank you for spending your time for replying.<br/>
Hoping to solve the question.<br/>
Best wishes.<br/>
Maryam</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-430844">
<div class="comment-container" id="li-comment-430844">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1fd966aed9d3d3cbb0ff924d1c65cb3c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1fd966aed9d3d3cbb0ff924d1c65cb3c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tim Levine</span>
<span class="date">March 2, 2018 at 4:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-430844" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason,</p>
<p>Great post. You’re making me into a machine learning ninja! Do you think one-hot encoding is a good choice for ordinal data like cold,warm,hot?  That is by encoding into separate columns don’t you lose the relationship that those three are on a continiuum.  I thought the general approach to data preparation is to expose my knowledge of each variable to the machine learning algorithm. It seems that one-hot encoding obfuscates it in this case.  Do you think leaving those three as integers might be a better choice? What would you recommend?</p>
<p>thanks,</p>
<p>Tim</p>
<div class="reply">
<a aria-label="Reply to Tim Levine" class="comment-reply-link" href="#comment-430844" onclick='return addComment.moveForm( "comment-430844", "430844", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-430862">
<div class="comment-container" id="li-comment-430862">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 2, 2018 at 5:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-430862" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It can make the relationship simpler for an algorithm, vectorized rather than compound.</p>
<p>In general, test and demonstrate the change improves model skill.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430862" onclick='return addComment.moveForm( "comment-430862", "430862", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-433681">
<div class="comment-container" id="li-comment-433681">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/431a5fe639f28f670e11d7d82702ec02?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/431a5fe639f28f670e11d7d82702ec02?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jarad</span>
<span class="date">March 30, 2018 at 10:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-433681" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, great tutorial! Do you know how I would go about combining multiple one-hot vectors of different lengths? Let’s say that in addition to each letter’s one-hot coding I also have other categories such as gender and country.</p>
<p>Also, what if I need to combine these with an integer such as age?</p>
<p>Cheers! 🙂</p>
<div class="reply">
<a aria-label="Reply to Jarad" class="comment-reply-link" href="#comment-433681" onclick='return addComment.moveForm( "comment-433681", "433681", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-433734">
<div class="comment-container" id="li-comment-433734">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 31, 2018 at 6:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-433734" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If I follow, you could have other variables “next to” the one hot encoded inputs to form a very long input vector.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-433734" onclick='return addComment.moveForm( "comment-433734", "433734", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-434410">
<div class="comment-container" id="li-comment-434410">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6c5e2611e463d93e1c2d145c7dab3e63?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6c5e2611e463d93e1c2d145c7dab3e63?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Abraham foto</span>
<span class="date">April 7, 2018 at 11:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-434410" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>what great work and makes life easier approach on ML</p>
<p>Hi Jason, recently, iam working with a data that has 921179 rows and about 32 columns. out of the 32 columns, the 22 are Object types  and i was trying to encode the dataset using label encoder and oneHotEncoder.<br/>
1, each columns has at least 20 unique values. there will be hounders of categories together.<br/>
2, is it a right way to encode with labelEncoder and then with one hot Encoder to such a big data.<br/>
 or if you can suggest me an easier approach.</p>
<p>tnx inadvance!</p>
<div class="reply">
<a aria-label="Reply to Abraham foto" class="comment-reply-link" href="#comment-434410" onclick='return addComment.moveForm( "comment-434410", "434410", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-434435">
<div class="comment-container" id="li-comment-434435">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 8, 2018 at 6:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-434435" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps try a suite of approaches and evaluate them based on their impact on model skill.</p>
<p>– try integer encoding.<br/>
– try one hot encoding<br/>
– try removing them<br/>
– try grouping labels and then encoding.<br/>
– … </p>
<p>Let me know how you go.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-434435" onclick='return addComment.moveForm( "comment-434435", "434435", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-434472">
<div class="comment-container" id="li-comment-434472">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6c5e2611e463d93e1c2d145c7dab3e63?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6c5e2611e463d93e1c2d145c7dab3e63?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Abraham foto</span>
<span class="date">April 8, 2018 at 8:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-434472" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thanks for the quick response!</p>
<p>– i imported the dataset using pandas : df = pd.read_csv(‘name.csv’)<br/>
– then i selected only object categories : df = df.select_dtypes(include=[‘object’])<br/>
-label encoding  df1.apply(LabelEncoder().fit_transform) – worked fine till this point.<br/>
– then i tried to create dummy variables , this is where it went wrong<br/>
– df.apply(OneHotEncoder(categorical_features=’all’).fit_transform) – i got error message like this</p>
<p>  File “”, line 1, in<br/>
    X = one.fit_transform(X1)</p>
<p>  File “/Users/afoto/anaconda2/lib/python2.7/site-packages/sklearn/preprocessing/data.py”, line 2019, in fit_transform<br/>
    self.categorical_features, copy=True)</p>
<p>  File “/Users/afoto/anaconda2/lib/python2.7/site-packages/sklearn/preprocessing/data.py”, line 1809, in _transform_selected<br/>
    X = check_array(X, accept_sparse=’csc’, copy=copy, dtype=FLOAT_DTYPES)</p>
<p>  File “/Users/afoto/anaconda2/lib/python2.7/site-packages/sklearn/utils/validation.py”, line 433, in check_array<br/>
    array = np.array(array, dtype=dtype, order=order, copy=copy)</p>
<p>ValueError: could not convert string to float: no</p>
<div class="reply">
<a aria-label="Reply to Abraham foto" class="comment-reply-link" href="#comment-434472" onclick='return addComment.moveForm( "comment-434472", "434472", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-434498">
<div class="comment-container" id="li-comment-434498">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 9, 2018 at 6:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-434498" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps confirm that you were applying the one hot encoding on the integer encoded var and not the original string variable?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-434498" onclick='return addComment.moveForm( "comment-434498", "434498", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-434654">
<div class="comment-container" id="li-comment-434654">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6c5e2611e463d93e1c2d145c7dab3e63?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6c5e2611e463d93e1c2d145c7dab3e63?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Abraham foto</span>
<span class="date">April 10, 2018 at 7:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-434654" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thanks for a response. </p>
<p>lately, i sow one tutorial on handling many categorical attributes. the approach is simple as follows;</p>
<p>1, iterate through all attributes with object data type object and then identify the unique categories<br/>
2, if the number of categories is more than 15  or 20, for instance a feature called nationality and we found out that the majority is 4000 = Americans, 200 europeans , 10 Africans and 50 Indians, 2 Chinese and etc.<br/>
3,  we create a dummy variables for the Americans and Europeans and other( where the other is the remaining counties)</p>
<p>this approach i found it to be intuitive and easier to implement.<br/>
looking forward for your invaluable comments and feedbacks. </p>
<p>Thanks and Cheers!</p>
<div class="reply">
<a aria-label="Reply to Abraham foto" class="comment-reply-link" href="#comment-434654" onclick='return addComment.moveForm( "comment-434654", "434654", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-434694">
<div class="comment-container" id="li-comment-434694">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 11, 2018 at 6:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-434694" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, I like this approach.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-434694" onclick='return addComment.moveForm( "comment-434694", "434694", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-435168">
<div class="comment-container" id="li-comment-435168">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ef2919741006a5c82bd810f210ee6a36?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ef2919741006a5c82bd810f210ee6a36?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ankit Tripathi</span>
<span class="date">April 17, 2018 at 12:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-435168" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,</p>
<p>It was an excellent  article with exhaustive coverage.  However, I have one doubt. I used the following code to use one hot encode for some categorical variables, but, the model fit throws error after successfully using one hot encoding. There is no error if I use ordinal encoding. Here is the code:</p>
<p>#ONE HOT ENCODING</p>
<p>from sklearn.preprocessing import OneHotEncoder<br/>
def one_hot_encode_features(df_train,df_test):<br/>
    features = [‘Fare’, ‘Cabin’, ‘Age’, ‘Sex’]<br/>
    #features = [ ‘Cabin’, ‘Sex’]<br/>
    df_combined = pd.concat([df_train[features], df_test[features]])<br/>
    for feature in features:<br/>
        le = preprocessing.LabelEncoder()<br/>
        onehot_encoder = OneHotEncoder()<br/>
        le = le.fit(df_combined[feature])<br/>
        integer_encoding_train=le.transform(df_train[feature])<br/>
        integer_encoding_test=le.transform(df_test[feature])<br/>
        integer_encoding_train = integer_encoding_train.reshape(len(integer_encoding_train), 1)<br/>
        integer_encoding_test = integer_encoding_test.reshape(len(integer_encoding_test), 1)<br/>
        df_train[feature] = onehot_encoder.fit_transform(integer_encoding_train)<br/>
        df_test[feature] = onehot_encoder.fit_transform(integer_encoding_test)<br/>
    return df_train, df_test<br/>
data_train, data_test = one_hot_encode_features(data_train, data_test)</p>
<p>#FITTING THE MODEL:<br/>
from sklearn.naive_bayes import GaussianNB<br/>
from sklearn.metrics import make_scorer, accuracy_score<br/>
from sklearn.model_selection import GridSearchCV</p>
<p>clf = GaussianNB()<br/>
acc_scorer = make_scorer(accuracy_score)<br/>
clf.fit(X_train, Y_train)</p>
<div class="reply">
<a aria-label="Reply to Ankit Tripathi" class="comment-reply-link" href="#comment-435168" onclick='return addComment.moveForm( "comment-435168", "435168", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-435192">
<div class="comment-container" id="li-comment-435192">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 17, 2018 at 6:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-435192" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I cannot debug your code.</p>
<p>Perhaps try posting your code to the developers on stackoverflow?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435192" onclick='return addComment.moveForm( "comment-435192", "435192", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-435260">
<div class="comment-container" id="li-comment-435260">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ef2919741006a5c82bd810f210ee6a36?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ef2919741006a5c82bd810f210ee6a36?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ankit Tripathi</span>
<span class="date">April 17, 2018 at 10:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-435260" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,</p>
<p>Here is a question not related to code debugging, I received a one hot encoded sparse matrix after following the steps in this article. However, I am finding trouble to add it to my training dataframe. </p>
<p>f_train[feature] = onehot_encoder.fit_transform(integer_encoding_train) fills all the n rows with the same values. How can this be achieved correctly?</p>
<div class="reply">
<a aria-label="Reply to Ankit Tripathi" class="comment-reply-link" href="#comment-435260" onclick='return addComment.moveForm( "comment-435260", "435260", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-435303">
<div class="comment-container" id="li-comment-435303">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 18, 2018 at 8:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-435303" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question, perhaps an hstack() might help.</p>
<p>This post will help:<br/>
<a href="https://machinelearningmastery.com/gentle-introduction-n-dimensional-arrays-python-numpy/" rel="nofollow">https://machinelearningmastery.com/gentle-introduction-n-dimensional-arrays-python-numpy/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435303" onclick='return addComment.moveForm( "comment-435303", "435303", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-435242">
<div class="comment-container" id="li-comment-435242">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ef2919741006a5c82bd810f210ee6a36?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ef2919741006a5c82bd810f210ee6a36?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ankit Tripathi</span>
<span class="date">April 17, 2018 at 5:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-435242" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Okay, thanks Jason</p>
<div class="reply">
<a aria-label="Reply to Ankit Tripathi" class="comment-reply-link" href="#comment-435242" onclick='return addComment.moveForm( "comment-435242", "435242", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-436630">
<div class="comment-container" id="li-comment-436630">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3bb36d519799fcd2e61f1993be438331?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3bb36d519799fcd2e61f1993be438331?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Adarsh</span>
<span class="date">May 4, 2018 at 7:16 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-436630" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>is this method is advice able for large number of categorical variable say i have 1500 categories for one variable is it advisable to use one-hot encoding</p>
<div class="reply">
<a aria-label="Reply to Adarsh" class="comment-reply-link" href="#comment-436630" onclick='return addComment.moveForm( "comment-436630", "436630", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-436663">
<div class="comment-container" id="li-comment-436663">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 5, 2018 at 6:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-436663" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, it may be ok.</p>
<p>I also list some additional approaches here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-handle-a-large-number-of-categories" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-handle-a-large-number-of-categories</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436663" onclick='return addComment.moveForm( "comment-436663", "436663", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-437256">
<div class="comment-container" id="li-comment-437256">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ad747ebacbb3889729d9ec5a2e32e4d3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ad747ebacbb3889729d9ec5a2e32e4d3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">diehumblex</span>
<span class="date">May 11, 2018 at 11:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-437256" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, first I integer encoded the classes then converted that to one hot encoding. during prediction, I used reverse and got the class. Now I also want the confidence of the class. I am using keras and on using predict_prob I get ‘Model’ object has no attribute ‘predict_proba’ as I am not using sequential. any suggestions how to get the confidence of class?</p>
<div class="reply">
<a aria-label="Reply to diehumblex" class="comment-reply-link" href="#comment-437256" onclick='return addComment.moveForm( "comment-437256", "437256", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-437294">
<div class="comment-container" id="li-comment-437294">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 12, 2018 at 6:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-437294" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If you are using softmax or sigmoid as the activation functions on the output layer, you can use the values directly as probability-like values.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437294" onclick='return addComment.moveForm( "comment-437294", "437294", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-437501">
<div class="comment-container" id="li-comment-437501">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6c5e2611e463d93e1c2d145c7dab3e63?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6c5e2611e463d93e1c2d145c7dab3e63?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Abraham foto</span>
<span class="date">May 14, 2018 at 9:11 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-437501" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>when we use one hot encoding with sklearn, how do we check if the code is free of dummy trap.<br/>
what i meant is that if i have may features with numeric categorical values like feature x1: 3,2,1,5,3,4,2<br/>
and feature x2: 1,2,3,2,1,3 and so on<br/>
if i use one hot encoding all the categories in one go<br/>
oneHot =OneHotEncode(category_feature=[the number of to be encoded] -&gt; example feature 1,2,4<br/>
the feature x1: have  4 categories and after one hot do we get 4 new features or 3 features. in get dummy we get 3, thus there is no dummy trap, hoe about in one hot encoder</p>
<div class="reply">
<a aria-label="Reply to Abraham foto" class="comment-reply-link" href="#comment-437501" onclick='return addComment.moveForm( "comment-437501", "437501", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-437530">
<div class="comment-container" id="li-comment-437530">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 15, 2018 at 7:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-437530" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You get n elements in the binary vector where n is the number of unique categories.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437530" onclick='return addComment.moveForm( "comment-437530", "437530", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-438449">
<div class="comment-container" id="li-comment-438449">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/59c0586e8d7f232a5f381a6d76ce5e88?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/59c0586e8d7f232a5f381a6d76ce5e88?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">shailendra</span>
<span class="date">May 24, 2018 at 3:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-438449" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>how can we use one hot encoding for next word prediction is there is post for doing this?<br/>
thank you</p>
<div class="reply">
<a aria-label="Reply to shailendra" class="comment-reply-link" href="#comment-438449" onclick='return addComment.moveForm( "comment-438449", "438449", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-438547">
<div class="comment-container" id="li-comment-438547">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 25, 2018 at 9:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-438547" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>One hot encoding is an encoding scheme, not a prediction scheme.</p>
<p>You must develop a model to make predictions. I recommend looking at language models:<br/>
<a href="https://machinelearningmastery.com/?s=language+model&amp;post_type=post&amp;submit=Search" rel="nofollow">https://machinelearningmastery.com/?s=language+model&amp;post_type=post&amp;submit=Search</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-438547" onclick='return addComment.moveForm( "comment-438547", "438547", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-438487">
<div class="comment-container" id="li-comment-438487">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a1d861efffdf66f3ee8e5fcf27522ec0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a1d861efffdf66f3ee8e5fcf27522ec0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Emna</span>
<span class="date">May 24, 2018 at 9:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-438487" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have a small issue concerning using the onehot encoding. I have a list  of tokens and this list contains string, numbers and even special characters like this ”. I have done one hot encoding to this list, fed it into autoencoder model. Then, I fed to the model an unseen one hot encoded list. Then, the output from the autoencoder model is fed to inverse one hot encoding function. The generated list is not even close to the unseen list although the accuracy of my model is 0.9. Do you have any idea what is the problem ? I have used the one hot encoding functions from this tutorial.</p>
<div class="reply">
<a aria-label="Reply to Emna" class="comment-reply-link" href="#comment-438487" onclick='return addComment.moveForm( "comment-438487", "438487", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-438557">
<div class="comment-container" id="li-comment-438557">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 25, 2018 at 9:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-438557" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sounds like a bug in your implementation. I have some ideas here:</p>
<p>– Consider aggressively cutting the code back to the minimum required. This will help you isolate the problem and focus on it.<br/>
– Consider cutting the problem back to just one or a few simple examples.<br/>
– Consider finding other similar code examples that do work and slowly modify them to meet your needs. This might expose your misstep.<br/>
– Consider posting your question and code to StackOverflow.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-438557" onclick='return addComment.moveForm( "comment-438557", "438557", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-442089">
<div class="comment-container" id="li-comment-442089">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3bb36d519799fcd2e61f1993be438331?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3bb36d519799fcd2e61f1993be438331?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Adarsh</span>
<span class="date">June 26, 2018 at 7:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-442089" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>how to deal with new category of a feature example</p>
<p>feature x has this categories while building model<br/>
2001<br/>
2002<br/>
2003<br/>
while using the model for prediction say i get 2004 as a value for that feature how do i deal with this using one hot encoder ???? also the sci-kit learn method for the same would be helpful</p>
<div class="reply">
<a aria-label="Reply to Adarsh" class="comment-reply-link" href="#comment-442089" onclick='return addComment.moveForm( "comment-442089", "442089", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-442132">
<div class="comment-container" id="li-comment-442132">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 27, 2018 at 8:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-442132" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You must plan the encoding to support new categories in the future.</p>
<p>If the problem definition changes, you may need to ignore the change or rebuild the representation and model. Often the latter is cheap.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442132" onclick='return addComment.moveForm( "comment-442132", "442132", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-443038">
<div class="comment-container" id="li-comment-443038">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/84d35c7345e37f319ff6d3875ca3288b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/84d35c7345e37f319ff6d3875ca3288b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Clasence</span>
<span class="date">July 9, 2018 at 8:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-443038" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have learned from your posts severally, and I wanted to thank you for taking the time to explain these concepts. It is really helpful for those of us starting up with machine learning. I am so grateful!</p>
<div class="reply">
<a aria-label="Reply to Clasence" class="comment-reply-link" href="#comment-443038" onclick='return addComment.moveForm( "comment-443038", "443038", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-443080">
<div class="comment-container" id="li-comment-443080">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 10, 2018 at 6:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-443080" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, I’m glad the posts help.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443080" onclick='return addComment.moveForm( "comment-443080", "443080", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-443789">
<div class="comment-container" id="li-comment-443789">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/aac25437c6df5204a6006e3455bd91c3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/aac25437c6df5204a6006e3455bd91c3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Varun</span>
<span class="date">July 18, 2018 at 2:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-443789" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have a column in pandas dataframe that contains thousands of unique character data. How to perform one hot encoding on this ? Actually I have 40 columns. Doing so will add 1000 extra columns.</p>
<div class="reply">
<a aria-label="Reply to Varun" class="comment-reply-link" href="#comment-443789" onclick='return addComment.moveForm( "comment-443789", "443789", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-443790">
<div class="comment-container" id="li-comment-443790">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 18, 2018 at 2:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-443790" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>1000 columns is not a lot, we may have tens or hundreds of thousands of columns in NLP problems.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443790" onclick='return addComment.moveForm( "comment-443790", "443790", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-443795">
<div class="comment-container" id="li-comment-443795">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/aac25437c6df5204a6006e3455bd91c3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/aac25437c6df5204a6006e3455bd91c3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Varun</span>
<span class="date">July 18, 2018 at 3:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-443795" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Is there an alternative for one hot encoding ?</p>
<div class="reply">
<a aria-label="Reply to Varun" class="comment-reply-link" href="#comment-443795" onclick='return addComment.moveForm( "comment-443795", "443795", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-443847">
<div class="comment-container" id="li-comment-443847">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 19, 2018 at 7:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-443847" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, integer encoding or a word embedding.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443847" onclick='return addComment.moveForm( "comment-443847", "443847", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-445505">
<div class="comment-container" id="li-comment-445505">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e0b7a24ec4997afeef4ba7cc2e411023?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e0b7a24ec4997afeef4ba7cc2e411023?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ola</span>
<span class="date">August 8, 2018 at 5:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-445505" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice post!</p>
<div class="reply">
<a aria-label="Reply to Ola" class="comment-reply-link" href="#comment-445505" onclick='return addComment.moveForm( "comment-445505", "445505", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-445529">
<div class="comment-container" id="li-comment-445529">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 8, 2018 at 6:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-445529" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-445529" onclick='return addComment.moveForm( "comment-445529", "445529", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-446651">
<div class="comment-container" id="li-comment-446651">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c5979ca5bc7d7ead895c91a7e78fd24e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c5979ca5bc7d7ead895c91a7e78fd24e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">cholzkorn</span>
<span class="date">August 21, 2018 at 8:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-446651" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi! I really liked your code (it helped me a lot!) and I have built upon it. This is a function which converts the given column to type category and correctly names the output columns. I thought I’d share it here:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa22aea07768799909" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
def onehot(cname):
    # Transform to category and get column names
    ascat = cname.astype('category')
    names = array(pd.Series(ascat.unique()))
    # Transform to array
    values = array(cname)
    # Integer encoding
    label_encoder = LabelEncoder()
    integer_encoded = label_encoder.fit_transform(values)
    # binary encode
    onehot_encoder = OneHotEncoder(sparse=False)
    integer_encoded = integer_encoded.reshape(len(integer_encoded), 1)
    onehot_encoded = onehot_encoder.fit_transform(integer_encoded)
    # convert to DataFrame
    ohdf = pd.DataFrame(onehot_encoded)
    # Give column names
    ohdf.columns = names
    # Return the onehot-DataFrame
    return ohdf</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa22aea07768799909-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22aea07768799909-2">2</div><div class="crayon-num" data-line="crayon-5c0caa22aea07768799909-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22aea07768799909-4">4</div><div class="crayon-num" data-line="crayon-5c0caa22aea07768799909-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22aea07768799909-6">6</div><div class="crayon-num" data-line="crayon-5c0caa22aea07768799909-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22aea07768799909-8">8</div><div class="crayon-num" data-line="crayon-5c0caa22aea07768799909-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22aea07768799909-10">10</div><div class="crayon-num" data-line="crayon-5c0caa22aea07768799909-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22aea07768799909-12">12</div><div class="crayon-num" data-line="crayon-5c0caa22aea07768799909-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22aea07768799909-14">14</div><div class="crayon-num" data-line="crayon-5c0caa22aea07768799909-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22aea07768799909-16">16</div><div class="crayon-num" data-line="crayon-5c0caa22aea07768799909-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa22aea07768799909-18">18</div><div class="crayon-num" data-line="crayon-5c0caa22aea07768799909-19">19</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa22aea07768799909-1"><span class="crayon-e">def </span><span class="crayon-e">onehot</span><span class="crayon-sy">(</span><span class="crayon-v">cname</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22aea07768799909-2"><span class="crayon-h">    </span><span class="crayon-p"># Transform to category and get column names</span></div><div class="crayon-line" id="crayon-5c0caa22aea07768799909-3"><span class="crayon-h">    </span><span class="crayon-v">ascat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cname</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'category'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22aea07768799909-4"><span class="crayon-h">    </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">Series</span><span class="crayon-sy">(</span><span class="crayon-v">ascat</span><span class="crayon-sy">.</span><span class="crayon-e">unique</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa22aea07768799909-5"><span class="crayon-h">    </span><span class="crayon-p"># Transform to array</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22aea07768799909-6"><span class="crayon-h">    </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">cname</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa22aea07768799909-7"><span class="crayon-h">    </span><span class="crayon-p"># Integer encoding</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22aea07768799909-8"><span class="crayon-h">    </span><span class="crayon-v">label_encoder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LabelEncoder</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa22aea07768799909-9"><span class="crayon-h">    </span><span class="crayon-v">integer_encoded</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">label_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">values</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22aea07768799909-10"><span class="crayon-h">    </span><span class="crayon-p"># binary encode</span></div><div class="crayon-line" id="crayon-5c0caa22aea07768799909-11"><span class="crayon-h">    </span><span class="crayon-v">onehot_encoder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">OneHotEncoder</span><span class="crayon-sy">(</span><span class="crayon-v">sparse</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22aea07768799909-12"><span class="crayon-h">    </span><span class="crayon-v">integer_encoded</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">integer_encoded</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">integer_encoded</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa22aea07768799909-13"><span class="crayon-h">    </span><span class="crayon-v">onehot_encoded</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">onehot_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">integer_encoded</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22aea07768799909-14"><span class="crayon-h">    </span><span class="crayon-p"># convert to DataFrame</span></div><div class="crayon-line" id="crayon-5c0caa22aea07768799909-15"><span class="crayon-h">    </span><span class="crayon-v">ohdf</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">onehot_encoded</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22aea07768799909-16"><span class="crayon-h">    </span><span class="crayon-p"># Give column names</span></div><div class="crayon-line" id="crayon-5c0caa22aea07768799909-17"><span class="crayon-h">    </span><span class="crayon-v">ohdf</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">names</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa22aea07768799909-18"><span class="crayon-h">    </span><span class="crayon-p"># Return the onehot-DataFrame</span></div><div class="crayon-line" id="crayon-5c0caa22aea07768799909-19"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">ohdf</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0011 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to cholzkorn" class="comment-reply-link" href="#comment-446651" onclick='return addComment.moveForm( "comment-446651", "446651", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-446683">
<div class="comment-container" id="li-comment-446683">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 22, 2018 at 6:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-446683" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for sharing!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-446683" onclick='return addComment.moveForm( "comment-446683", "446683", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-448820">
<div class="comment-container" id="li-comment-448820">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a1d861efffdf66f3ee8e5fcf27522ec0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a1d861efffdf66f3ee8e5fcf27522ec0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Emna</span>
<span class="date">September 15, 2018 at 12:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-448820" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can we encode texts or xm elements fields to arrays not a single value (integer)</p>
<div class="reply">
<a aria-label="Reply to Emna" class="comment-reply-link" href="#comment-448820" onclick='return addComment.moveForm( "comment-448820", "448820", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-448865">
<div class="comment-container" id="li-comment-448865">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 15, 2018 at 6:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-448865" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can encode the words as number or letters as numbers. The former is more common and useful.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-448865" onclick='return addComment.moveForm( "comment-448865", "448865", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-449266">
<div class="comment-container" id="li-comment-449266">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/38d4a28c1dd2977e6a874151431c5356?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/38d4a28c1dd2977e6a874151431c5356?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kevin Swingler</span>
<span class="date">September 18, 2018 at 11:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-449266" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
That is a nice post, thanks. Have you used one hot encoding as an input to a multiple linear regression and looked at the resulting coefficients? They are not what you might expect, but I can’t find a source where this is discussed. I wonder if you have come across anything on this?</p>
<p>If we take a random binary matrix with n rows and p columns representing p variables over n examples and a vector w of coefficients, then generate y=Xw we produce a data set of inputs X and outputs y. If we then use multiple linear regression to estimate w (which we already know, in this example as we used it to generate y), we get the values from w that we started with. This is true for almost any values in X where n&gt;p EXCEPT where X is a representation of one hot encodings. In that particular case, the estimates of the coefficients in w are not the same as those used to generate y. Have you come across this phenomenon? I suspect it is because each coefficient is under constrained but I have never seen it discussed. It has interesting consequences for the interpretation of models built from on hot encoded variables, I think.</p>
<div class="reply">
<a aria-label="Reply to Kevin Swingler" class="comment-reply-link" href="#comment-449266" onclick='return addComment.moveForm( "comment-449266", "449266", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-449294">
<div class="comment-container" id="li-comment-449294">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 19, 2018 at 6:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-449294" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Linear regression is not great with encoded categorical vars. Perhaps try other methods, perhaps a decision tree?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-449294" onclick='return addComment.moveForm( "comment-449294", "449294", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-449304">
<div class="comment-container" id="li-comment-449304">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2fd1df5caf55155813cdf1c57ddbafca?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2fd1df5caf55155813cdf1c57ddbafca?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Akshay Bhaskaran</span>
<span class="date">September 19, 2018 at 6:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-449304" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, firstly thanks for the beautiful step-by-step explanation. I have a quick question (I’m a beginner to scikit-learn and ML as a whole):</p>
<p>1. I selected some input features list [X]<br/>
2. I found out the missing values in specific columns<br/>
3. For one of the columns that has missing values, let’s say the categories are [‘Fa’, ‘Gd’, ‘Ex’, ‘TA’, Nan]<br/>
4. I have done Number and a Binary (one-hot) encoding to get this:<br/>
Missing values:  [nan, ‘Fa’, ‘TA’, ‘Ex’, ‘Gd’]<br/>
Number encoding:  [4 1 3 0 2]<br/>
Binary/one-hot encoding:<br/>
 [[0. 0. 0. 0. 1.]<br/>
 [0. 1. 0. 0. 0.]<br/>
 [0. 0. 0. 1. 0.]<br/>
 [1. 0. 0. 0. 0.]<br/>
 [0. 0. 1. 0. 0.]]<br/>
5. Now, HOW DO I FILL THESE VALUES BACK TO THE COLUMN FROM WHERE THEY WERE MISSING? Do I need to work on Imputation? Or create a new data frame?</p>
<p>Your help is much appreciated, and thanks in advance..</p>
<div class="reply">
<a aria-label="Reply to Akshay Bhaskaran" class="comment-reply-link" href="#comment-449304" onclick='return addComment.moveForm( "comment-449304", "449304", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-449316">
<div class="comment-container" id="li-comment-449316">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 19, 2018 at 1:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-449316" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You drop the original column and concatenate the new columns with your remaining data.</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-449316" onclick='return addComment.moveForm( "comment-449316", "449316", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-449433">
<div class="comment-container" id="li-comment-449433">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2fd1df5caf55155813cdf1c57ddbafca?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2fd1df5caf55155813cdf1c57ddbafca?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Akshay Bhaskaran</span>
<span class="date">September 21, 2018 at 1:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-449433" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That helps, thanks Jason. One other question would be this:</p>
<p>Say I have some columns with missing values and are categorical, like: {nan, ‘Gd’, ‘TA’, ‘Fa’, ‘Ex’}. Now I do the following:</p>
<p>1. Drop the column from original X dataframe<br/>
2. Do a number encoding on the categorical data: [4 2 3 1 0]<br/>
3. Next, I do a Binary One-hot encoding on these:[[0. 0. 0. 0. 1.]<br/>
 [0. 0. 1. 0. 0.]<br/>
 [0. 0. 0. 1. 0.]<br/>
 [0. 1. 0. 0. 0.]<br/>
 [1. 0. 0. 0. 0.]]</p>
<p>4. Now, my question here is, I have some numbers to play with in a column. Do I need to do any kind of imputation with (strategy=mean/median/most_frequent), or now directly I can add these columns with the number values to original dataframe and start my model?</p>
<div class="reply">
<a aria-label="Reply to Akshay Bhaskaran" class="comment-reply-link" href="#comment-449433" onclick='return addComment.moveForm( "comment-449433", "449433", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-449453">
<div class="comment-container" id="li-comment-449453">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 21, 2018 at 6:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-449453" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question.</p>
<p>You can impute the missing values before hand as categorical values.<br/>
You can treat the nan as its own value.<br/>
You can delete those rows.<br/>
…</p>
<p>Try a few approaches and see which results in the best model performance.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-449453" onclick='return addComment.moveForm( "comment-449453", "449453", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-449478">
<div class="comment-container" id="li-comment-449478">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2fd1df5caf55155813cdf1c57ddbafca?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2fd1df5caf55155813cdf1c57ddbafca?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Akshay Bhaskaran</span>
<span class="date">September 21, 2018 at 2:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-449478" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Cool..thanks again Jason.. And, sorry about my dumb questions as I’m just 2 weeks old to Machine Learning..</p>
<p>&gt; I have two data sets (train.csv and test.csv).<br/>
&gt; It is evident that I should fit and train my model on “train”ing data and do the prediction with “test”ing data (validation)</p>
<p>&gt;this is my question here:<br/>
when I do a split of test and validation data, it is very easy to do when we have one single dataframe:</p>
<p>          train_X, val_X, train_y, val_y = [X, y, random_state=0]</p>
<p>&gt; Now, when I have two dataframes – train.csv and test.csv, how do I address it? Like how do I split the data appropriately here</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-449483">
<div class="comment-container" id="li-comment-449483">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 21, 2018 at 2:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-449483" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Train is split into train and validation.</p>
<p>You can learn more here:<br/>
<a href="https://machinelearningmastery.com/difference-test-validation-datasets/" rel="nofollow">https://machinelearningmastery.com/difference-test-validation-datasets/</a></p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-450713">
<div class="comment-container" id="li-comment-450713">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9a6de138508ee75f0fe98d24aebe4214?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9a6de138508ee75f0fe98d24aebe4214?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Eugene</span>
<span class="date">October 5, 2018 at 4:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-450713" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for this post.<br/>
I am using your code to transform a list of DNA sequences that have the following structure: [[a,b,c,d,e],[f,g,h,i,j],[k,l,m,n]]. It is basically a list of lists containing letters.<br/>
I used the np.array function on my list of lists, but the fit_transform gave me an error of shape.<br/>
What do you suggest?</p>
<div class="reply">
<a aria-label="Reply to Eugene" class="comment-reply-link" href="#comment-450713" onclick='return addComment.moveForm( "comment-450713", "450713", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-450736">
<div class="comment-container" id="li-comment-450736">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 5, 2018 at 5:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-450736" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m not sure what you’re trying to do exactly.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-450736" onclick='return addComment.moveForm( "comment-450736", "450736", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-451268">
<div class="comment-container" id="li-comment-451268">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/309ef767b8255b03fc4bd5a221883e59?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/309ef767b8255b03fc4bd5a221883e59?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mel</span>
<span class="date">October 11, 2018 at 2:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-451268" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, Thank you for this great post.<br/>
I used your code to do a label encoder and one hot encoder, but when I call the inverse_transform I get this error:</p>
<p>  inverted = label_encoder.inverse_transform([argmax(data_oh[0, :])])<br/>
  File “…\Programs\Python\Python36\lib\site-packages\sklearn\preprocessing\label.py”, line 283, in inverse_transform<br/>
    return self.classes_[y]<br/>
TypeError: only integer scalar arrays can be converted to a scalar index</p>
<p>Do you know what can be the problem?</p>
<p>My code is the following:<br/>
#integer encode<br/>
label_encoder_dict = defaultdict(LabelEncoder) #retain all columns LabelEncoder as dictionary.<br/>
integer_encoded = data_cat.apply(lambda x: label_encoder_dict[x.name].fit_transform(x))<br/>
#binary encode<br/>
oh = OneHotEncoder(handle_unknown=’ignore’, sparse=False)<br/>
integer_encoded = integer_encoded.as_matrix(integer_encoded.columns)<br/>
data_oh = self.oh.fit_transform(integer_encoded)<br/>
label_encoder = self.label_encoder_dict[‘DEST’]<br/>
inverted = label_encoder.inverse_transform([argmax(data_oh[0, :])])</p>
<p>Thank you!</p>
<div class="reply">
<a aria-label="Reply to Mel" class="comment-reply-link" href="#comment-451268" onclick='return addComment.moveForm( "comment-451268", "451268", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-451305">
<div class="comment-container" id="li-comment-451305">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 11, 2018 at 8:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-451305" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have not seen this before.</p>
<p>One tip is that the inverse transform expects the data to have the same shape and form as is provided by the transform() function.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-451305" onclick='return addComment.moveForm( "comment-451305", "451305", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-453492">
<div class="comment-container" id="li-comment-453492">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5ccc4744a0efe606c2bdbe8b71d1671d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5ccc4744a0efe606c2bdbe8b71d1671d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Eklil Khan</span>
<span class="date">November 3, 2018 at 2:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-453492" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the great work. I have a dataset that has this structure:</p>
<p>down vote<br/>
unaccept<br/>
I reduced your dataset file to:</p>
<p>A</p>
<p>B</p>
<p>C</p>
<p>D</p>
<p>E</p>
<p>F</p>
<p>and I extracted the data from this dataset by the below code.</p>
<p>import re</p>
<p>with open (“test_dataset.log”, “r”) as myfile:<br/>
    read_dataset = myfile.read()</p>
<p>i_ident = []<br/>
j_atr = []<br/>
find_ident = re.findall(r'(.*?)’, read_dataset, re.S)<br/>
ident_list = list(map(lambda x: x.replace(‘\n’, ‘ ‘), find_ident))<br/>
for i in range(len(ident_list)):<br/>
    i_ident.append(str(ident_list[i]))</p>
<p>find_atr = re.findall(r'(.*?)’, read_dataset, re.S)<br/>
atr_list = list(map(lambda x: x.replace(‘\n’, ‘ ‘), find_atr))<br/>
#print(coref_list)<br/>
for i in range(len(atr_list)):<br/>
    j_atr.append(str(atr_list[i]))</p>
<p>print(i_ident)<br/>
print()<br/>
print(j_atr)</p>
<p>Where I have stored the values of these data in i and j variable. I want to do the coreference resolution in the decision tree. For doing this task I have defined some functions like the following:</p>
<p>distance_feature(): distance between i and j according to the number of sentences. output: 0 or 1</p>
<p>Ispronoun_feature(): this feature is set to true if a noun phrase is a pronoun.</p>
<p>appositive_feature(): This feature checks if j is in apposition of i.</p>
<p>and more it is about 12 features that I have extracted. Now How can build my tree, if I want to change the data to one-hot encoding, you see the dataset structure which all unstructured. then in sci-kit learn how do I include all these functions to decide if i and j are coreferent. Please let me know if you have some ideas.<br/>
Thank you</p>
<div class="reply">
<a aria-label="Reply to Eklil Khan" class="comment-reply-link" href="#comment-453492" onclick='return addComment.moveForm( "comment-453492", "453492", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-453532">
<div class="comment-container" id="li-comment-453532">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 3, 2018 at 7:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-453532" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have the capacity to debug your code, I have some suggestions here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/can-you-read-review-or-debug-my-code" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/can-you-read-review-or-debug-my-code</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453532" onclick='return addComment.moveForm( "comment-453532", "453532", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-453511">
<div class="comment-container" id="li-comment-453511">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f1533e2e04103ee36f07fefe67779a5a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f1533e2e04103ee36f07fefe67779a5a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Akshat Jain</span>
<span class="date">November 3, 2018 at 6:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-453511" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>I am using to_categorical of Keras and above u specifically said that when sequence starts with 0, but what if I want to use it on a sequence that starts with say 1. then how do we approach it?</p>
<p>I tried it when it always adds an extra column of 0’s in final encoding which is not good and I also tried num_classes argument but I am getting “IndexError” in it.</p>
<div class="reply">
<a aria-label="Reply to Akshat Jain" class="comment-reply-link" href="#comment-453511" onclick='return addComment.moveForm( "comment-453511", "453511", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-453538">
<div class="comment-container" id="li-comment-453538">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 3, 2018 at 7:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-453538" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Why start at 1?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453538" onclick='return addComment.moveForm( "comment-453538", "453538", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-454455">
<div class="comment-container" id="li-comment-454455">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/92e569dc994f594be221da531b4d1737?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/92e569dc994f594be221da531b4d1737?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sneha</span>
<span class="date">November 12, 2018 at 1:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-454455" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
This is a great post. Label encoder will throw an error for unseen values in the test set and hence not able to proceed with One hot Encoding. How to tackle this problem in production systems ?</p>
<div class="reply">
<a aria-label="Reply to Sneha" class="comment-reply-link" href="#comment-454455" onclick='return addComment.moveForm( "comment-454455", "454455", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-454476">
<div class="comment-container" id="li-comment-454476">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 12, 2018 at 5:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-454476" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ensure it is trained on data that contains all possible cases, e.g. is representative.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-454476" onclick='return addComment.moveForm( "comment-454476", "454476", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-455843">
<div class="comment-container" id="li-comment-455843">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/907517c29b7013dd346b2483c0149899?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/907517c29b7013dd346b2483c0149899?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Annur Syafiqah</span>
<span class="date">November 22, 2018 at 5:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-455843" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Dr.jason,</p>
<p>Currently I want to do a feature selection over my dataset. My dataset contain 20 features which 7 of them are  categorical and the rest are continuous features. However I found out that not all feature selection technique applicable for mixed (categorical+ continuous) dataset for example like PCA. After I read about one-hot-encoding, I feel like want to use it to transform all the categorical features into continuous features which mean to standardize the type all the features.  After encoding, I will use PCA to reduce the data dimension. Is it a good idea?</p>
<div class="reply">
<a aria-label="Reply to Annur Syafiqah" class="comment-reply-link" href="#comment-455843" onclick='return addComment.moveForm( "comment-455843", "455843", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-455885">
<div class="comment-container" id="li-comment-455885">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 23, 2018 at 7:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/#comment-455885" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Probably not. Perhaps work with all categorical variables separately then all numeric?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-455885" onclick='return addComment.moveForm( "comment-455885", "455885", "respond", "4129" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/how-to-one-hot-encode-sequence-data-in-python/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="4129"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="c47cf5a25b"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="83"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery!</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Jason Brownlee, PhD
<br/>
I write tutorials to help developers (<i>like you</i>) get results with machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-29"> <div class="textwidget"><p></p><center><br/>
<strong>Long Short-Term Memory Networks</strong><br/>
Develop sequence prediction models in Keras.
<p><a href="/lstms-with-python/">Click to Get Started Now!</a><br/>
<a href="/lstms-with-python/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/07/Cover-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch"><img alt="How to Develop a Neural Machine Translation System in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/01/How-to-Develop-a-Neural-Machine-Translation-System-in-Keras-150x150.jpg" title="How to Develop a Neural Machine Translation System from Scratch" width="45"/></a> <a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch">How to Develop a Neural Machine Translation System from Scratch</a>
<span class="meta">January 10, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning"><img alt="Difference Between Classification and Regression in Machine Learning" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/Difference-Between-Classification-and-Regression-in-Machine-Learning-150x150.jpg" title="Difference Between Classification and Regression in Machine Learning" width="45"/></a> <a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning">Difference Between Classification and Regression in Machine Learning</a>
<span class="meta">December 11, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem..."><img alt="So, You are Working on a Machine Learning Problem..." class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/So-You-are-Working-on-a-Machine-Learning-Problem...-150x150.jpg" title="So, You are Working on a Machine Learning Problem..." width="45"/></a> <a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem…">So, You are Working on a Machine Learning Problem…</a>
<span class="meta">April 4, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis"><img alt="Plot of the Multichannel Convolutional Neural Network For Text" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-150x150.png" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis" width="45"/></a> <a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis">How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis</a>
<span class="meta">January 12, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras"><img alt="How to Make Classification and Regression Predictions for Deep Learning Models in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/How-to-Make-Classification-and-Regression-Predictions-for-Deep-Learning-Models-in-Keras-150x150.jpg" title="How to Make Predictions with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras">How to Make Predictions with Keras</a>
<span class="meta">April 9, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)"><img alt="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/11-Classical-Time-Series-Forecasting-Methods-in-Python-Cheat-Sheet-150x150.jpg" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)">11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)</a>
<span class="meta">August 6, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras"><img alt="How to Visualize a Deep Learning Neural Network Model in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/How-to-Visualize-a-Deep-Learning-Neural-Network-Model-in-Keras-150x150.jpg" title="How to Visualize a Deep Learning Neural Network Model in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras">How to Visualize a Deep Learning Neural Network Model in Keras</a>
<span class="meta">December 13, 2017</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> <div class="widget_text widget widget_custom_html" id="custom_html-2"><h3>You might also like…</h3><div class="textwidget custom-html-widget"><ul>
<li><a href="/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Install Python for Machine Learning</a></li>
<li><a href="/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python</a></li>
<li><a href="/tutorial-first-neural-network-python-keras/">Your First Neural Network in Python</a></li>
<li><a href="/how-to-run-your-first-classifier-in-weka/">Your First Classifier in Weka</a></li>
<li><a href="/arima-for-time-series-forecasting-with-python/">Your First Time Series Forecasting Project</a></li>
</ul></div></div></aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/disclaimer/">Disclaimer</a> | 
<a href="/terms-of-service/">Terms</a> | 
<a href="/contact/">Contact</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.8" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.0.5" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.8" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.1" type="text/javascript"></script>
</body>
</html>