<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v9.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>How to Use the Keras Functional API for Deep Learning</title>
<link href="https://machinelearningmastery.com/keras-functional-api-deep-learning/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="How to Use the Keras Functional API for Deep Learning" property="og:title"/>
<meta content="The Keras Python library makes creating deep learning models fast and easy. The sequential API allows you to create models layer-by-layer for most problems. It is limited in that it does not allow you to create models that share layers or have multiple inputs or outputs. The functional API in Keras is an alternate way …" property="og:description"/>
<meta content="https://machinelearningmastery.com/keras-functional-api-deep-learning/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="https://www.facebook.com/jason.brownlee.39" property="article:author"/>
<meta content="Deep Learning" property="article:section"/>
<meta content="2017-10-26T18:00:20+00:00" property="article:published_time"/>
<meta content="2018-12-07T20:10:44+00:00" property="article:modified_time"/>
<meta content="2018-12-07T20:10:44+00:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/multiple_inputs.png" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/multiple_inputs.png" property="og:image:secure_url"/>
<meta content="600" property="og:image:width"/>
<meta content="936" property="og:image:height"/>
<meta content="Neural Network Graph With Multiple Inputs" property="og:image:alt"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"https:\/\/machinelearningmastery.com\/#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/keras-functional-api-deep-learning/feed/" rel="alternate" title="Machine Learning Mastery » How to Use the Keras Functional API for Deep Learning Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<style media="all" type="text/css">
.wpautoterms-footer{background-color:#ffffff;text-align:center;}
.wpautoterms-footer a{color:#000000;font-family:Arial, sans-serif;font-size:14px;}
.wpautoterms-footer .separator{color:#cccccc;font-family:Arial, sans-serif;font-size:14px;}</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/auto-terms-of-service-and-privacy-policy/css/wpautoterms.css?ver=4.9.8" id="wpautoterms_css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.0.5" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/css/front.css?ver=2.0.20" id="ssb-front-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/ewd-ufaq-styles.css?ver=4.9.8" id="ewd-ufaq-style-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/rrssb-min.css?ver=4.9.8" id="ewd-ufaq-rrssb-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.8" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=2.0.20" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.8" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.8" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=4392" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fkeras-functional-api-deep-learning%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fkeras-functional-api-deep-learning%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<style media="screen">

        .simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
      margin: ;
    }
         /*inline margin*/
    
  
  
  
  
  
          .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
         margin: ;
     }

          /*margin-digbar*/

  
  
  
  
 
   
   

</style>
<script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#4c89bf; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#4c89bf;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#4c89bf!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#ffffff;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-4392 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/icon-100x100.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-32"> <div class="textwidget"><p>Want help with deep learning? <a href="https://machinelearningmastery.lpages.co/deep-learning-with-python-mini-course/">Take the FREE Mini-Course</a></p>
</div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<input name="post_type" type="hidden" value="post"/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Main Menu</h3><ul class="nav fl" id="main-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503" id="menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Start Here</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501" id="menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506" id="menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6508" id="menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (Keras)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511" id="menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509" id="menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515" id="menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">Deep Learning for NLP</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512" id="menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Understand Algorithms</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507" id="menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms (Python)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6513" id="menu-item-6513"><a href="https://machinelearningmastery.com/category/machine-learning-process/">Machine Learning Process</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516" id="menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517" id="menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522" id="menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6518" id="menu-item-6518"><a href="https://machinelearningmastery.com/category/start-machine-learning/">Getting Started</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510" id="menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519" id="menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistical Methods</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520" id="menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Time Series (introductory)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523" id="menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6514" id="menu-item-6514"><a href="https://machinelearningmastery.com/category/machine-learning-resources/">Resources</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502" id="menu-item-6502"><a href="https://machinelearningmastery.com/products/">Ebooks</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500" id="menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504" id="menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505" id="menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-4392 post type-post status-publish format-standard has-post-thumbnail hentry category-deep-learning">
<header>
<h1 class="title entry-title">How to Use the Keras Functional API for Deep Learning</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2017-10-27T05:00:20+1100">October 27, 2017</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/deep-learning/" title="View all items in Deep Learning">Deep Learning</a></span> </div>
<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-4392 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Use+the+Keras+Functional+API+for+Deep+Learning&amp;url=https://machinelearningmastery.com/keras-functional-api-deep-learning/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/keras-functional-api-deep-learning/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/keras-functional-api-deep-learning/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/keras-functional-api-deep-learning/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
<p>The Keras Python library makes creating deep learning models fast and easy.</p>
<p>The sequential API allows you to create models layer-by-layer for most problems. It is limited in that it does not allow you to create models that share layers or have multiple inputs or outputs.</p>
<p>The functional API in Keras is an alternate way of creating models that offers a lot more flexibility, including creating more complex models.</p>
<p>In this tutorial, you will discover how to use the more flexible functional API in Keras to define deep learning models.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>The difference between the Sequential and Functional APIs.</li>
<li>How to define simple Multilayer Perceptron, Convolutional Neural Network, and Recurrent Neural Network models using the functional API.</li>
<li>How to define more complex models with shared layers and multiple inputs and outputs.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Nov/2017</strong>: Update note about hanging dimension for input layers only affecting 1D input, thanks Joe.</li>
<li><strong>Updated Nov/2018</strong>: Added missing flatten layer for CNN, thanks Konstantin.</li>
<li><strong>Update Nov/2018</strong>: Added description of the functional API Python syntax.</li>
</ul>
<h2>Tutorial Overview</h2>
<p>This tutorial is divided into 7 parts; they are:</p>
<ol>
<li>Keras Sequential Models</li>
<li>Keras Functional Models</li>
<li>Standard Network Models</li>
<li>Shared Layers Model</li>
<li>Multiple Input and Output Models</li>
<li>Best Practices</li>
<li><strong>NEW</strong>: Note on the Functional API Python Syntax</li>
</ol>
<h2>1. Keras Sequential Models</h2>
<p>As a review, Keras provides a Sequential model API.</p>
<p>This is a way of creating deep learning models where an instance of the Sequential class is created and model layers are created and added to it.</p>
<p>For example, the layers can be defined and passed to the Sequential as an array:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e09b94448993448" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from keras.models import Sequential
from keras.layers import Dense
model = Sequential([Dense(2, input_dim=1), Dense(1)])</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e09b94448993448-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09b94448993448-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e09b94448993448-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e09b94448993448-1"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09b94448993448-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line" id="crayon-5c0ca43e09b94448993448-3"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>Layers can also be added piecewise:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e09b9d591075197" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from keras.models import Sequential
from keras.layers import Dense
model = Sequential()
model.add(Dense(2, input_dim=1))
model.add(Dense(1))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e09b9d591075197-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09b9d591075197-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e09b9d591075197-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09b9d591075197-4">4</div><div class="crayon-num" data-line="crayon-5c0ca43e09b9d591075197-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e09b9d591075197-1"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09b9d591075197-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line" id="crayon-5c0ca43e09b9d591075197-3"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09b9d591075197-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09b9d591075197-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>The Sequential model API is great for developing deep learning models in most situations, but it also has some limitations.</p>
<p>For example, it is not straightforward to define models that may have multiple different input sources, produce multiple output destinations or models that re-use layers.</p>
<h2>2. Keras Functional Models</h2>
<p>The Keras functional API provides a more flexible way for defining models.</p>
<p>It specifically allows you to define multiple input or output models as well as models that share layers. More than that, it allows you to define ad hoc acyclic network graphs.</p>
<p>Models are defined by creating instances of layers and connecting them directly to each other in pairs, then defining a Model that specifies the layers to act as the input and output to the model.</p>
<p>Let’s look at the three unique aspects of Keras functional API in turn:</p>
<h3>1. Defining Input</h3>
<p>Unlike the Sequential model, you must create and define a standalone Input layer that specifies the shape of input data.</p>
<p>The input layer takes a shape argument that is a tuple that indicates the dimensionality of the input data.</p>
<p>When input data is one-dimensional, such as for a multilayer Perceptron, the shape must explicitly leave room for the shape of the mini-batch size used when splitting the data when training the network. Therefore, the shape tuple is always defined with a hanging last dimension when the input is one-dimensional (2,), for example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e09ba0255853890" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from keras.layers import Input
visible = Input(shape=(2,))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e09ba0255853890-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba0255853890-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e09ba0255853890-1"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba0255853890-2"><span class="crayon-v">visible</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<h3>2. Connecting Layers</h3>
<p>The layers in the model are connected pairwise.</p>
<p>This is done by specifying where the input comes from when defining each new layer. A bracket notation is used, such that after the layer is created, the layer from which the input to the current layer comes from is specified.</p>
<p>Let’s make this clear with a short example. We can create the input layer as above, then create a hidden layer as a Dense that receives input only from the input layer.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e09ba1491589383" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from keras.layers import Input
from keras.layers import Dense
visible = Input(shape=(2,))
hidden = Dense(2)(visible)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e09ba1491589383-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba1491589383-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba1491589383-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba1491589383-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e09ba1491589383-1"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba1491589383-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line" id="crayon-5c0ca43e09ba1491589383-3"><span class="crayon-v">visible</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba1491589383-4"><span class="crayon-v">hidden</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">visible</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Note the (visible) after the creation of the Dense layer that connects the input layer output as the input to the dense hidden layer.</p>
<p>It is this way of connecting layers piece by piece that gives the functional API its flexibility. For example, you can see how easy it would be to start defining ad hoc graphs of layers.</p>
<h3>3. Creating the Model</h3>
<p>After creating all of your model layers and connecting them together, you must define the model.</p>
<p>As with the Sequential API, the model is the thing you can summarize, fit, evaluate, and use to make predictions.</p>
<p>Keras provides a Model class that you can use to create a model from your created layers. It requires that you only specify the input and output layers. For example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e09ba3263546425" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from keras.models import Model
from keras.layers import Input
from keras.layers import Dense
visible = Input(shape=(2,))
hidden = Dense(2)(visible)
model = Model(inputs=visible, outputs=hidden)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e09ba3263546425-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba3263546425-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba3263546425-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba3263546425-4">4</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba3263546425-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba3263546425-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e09ba3263546425-1"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba3263546425-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line" id="crayon-5c0ca43e09ba3263546425-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba3263546425-4"><span class="crayon-v">visible</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09ba3263546425-5"><span class="crayon-v">hidden</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">visible</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba3263546425-6"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-v">visible</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-v">hidden</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>Now that we know all of the key pieces of the Keras functional API, let’s work through defining a suite of different models and build up some practice with it.</p>
<p>Each example is executable and prints the structure and creates a diagram of the graph. I recommend doing this for your own models to make it clear what exactly you have defined.</p>
<p>My hope is that these examples provide templates for you when you want to define your own models using the functional API in the future.</p>
<h2>3. Standard Network Models</h2>
<p>When getting started with the functional API, it is a good idea to see how some standard neural network models are defined.</p>
<p>In this section, we will look at defining a simple multilayer Perceptron, convolutional neural network, and recurrent neural network.</p>
<p>These examples will provide a foundation for understanding the more elaborate examples later.</p>
<h3>Multilayer Perceptron</h3>
<p>In this section, we define a multilayer Perceptron model for binary classification.</p>
<p>The model has 10 inputs, 3 hidden layers with 10, 20, and 10 neurons, and an output layer with 1 output. Rectified linear activation functions are used in each hidden layer and a sigmoid activation function is used in the output layer, for binary classification.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e09ba5026230596" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Multilayer Perceptron
from keras.utils import plot_model
from keras.models import Model
from keras.layers import Input
from keras.layers import Dense
visible = Input(shape=(10,))
hidden1 = Dense(10, activation='relu')(visible)
hidden2 = Dense(20, activation='relu')(hidden1)
hidden3 = Dense(10, activation='relu')(hidden2)
output = Dense(1, activation='sigmoid')(hidden3)
model = Model(inputs=visible, outputs=output)
# summarize layers
print(model.summary())
# plot graph
plot_model(model, to_file='multilayer_perceptron_graph.png')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e09ba5026230596-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba5026230596-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba5026230596-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba5026230596-4">4</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba5026230596-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba5026230596-6">6</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba5026230596-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba5026230596-8">8</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba5026230596-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba5026230596-10">10</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba5026230596-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba5026230596-12">12</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba5026230596-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba5026230596-14">14</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba5026230596-15">15</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e09ba5026230596-1"><span class="crayon-p"># Multilayer Perceptron</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba5026230596-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">plot_model</span></div><div class="crayon-line" id="crayon-5c0ca43e09ba5026230596-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba5026230596-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line" id="crayon-5c0ca43e09ba5026230596-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba5026230596-6"><span class="crayon-v">visible</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09ba5026230596-7"><span class="crayon-v">hidden1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">visible</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba5026230596-8"><span class="crayon-v">hidden2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">hidden1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09ba5026230596-9"><span class="crayon-v">hidden3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">hidden2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba5026230596-10"><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">hidden3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09ba5026230596-11"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-v">visible</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba5026230596-12"><span class="crayon-p"># summarize layers</span></div><div class="crayon-line" id="crayon-5c0ca43e09ba5026230596-13"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba5026230596-14"><span class="crayon-p"># plot graph</span></div><div class="crayon-line" id="crayon-5c0ca43e09ba5026230596-15"><span class="crayon-e">plot_model</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">to_file</span><span class="crayon-o">=</span><span class="crayon-s">'multilayer_perceptron_graph.png'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>Running the example prints the structure of the network.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e09ba7109474536" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
input_1 (InputLayer)         (None, 10)                0
_________________________________________________________________
dense_1 (Dense)              (None, 10)                110
_________________________________________________________________
dense_2 (Dense)              (None, 20)                220
_________________________________________________________________
dense_3 (Dense)              (None, 10)                210
_________________________________________________________________
dense_4 (Dense)              (None, 1)                 11
=================================================================
Total params: 551
Trainable params: 551
Non-trainable params: 0
_________________________________________________________________</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e09ba7109474536-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba7109474536-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba7109474536-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba7109474536-4">4</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba7109474536-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba7109474536-6">6</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba7109474536-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba7109474536-8">8</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba7109474536-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba7109474536-10">10</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba7109474536-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba7109474536-12">12</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba7109474536-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba7109474536-14">14</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba7109474536-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba7109474536-16">16</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba7109474536-17">17</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e09ba7109474536-1">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba7109474536-2">Layer (type)                 Output Shape              Param #</div><div class="crayon-line" id="crayon-5c0ca43e09ba7109474536-3">=================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba7109474536-4">input_1 (InputLayer)         (None, 10)                0</div><div class="crayon-line" id="crayon-5c0ca43e09ba7109474536-5">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba7109474536-6">dense_1 (Dense)              (None, 10)                110</div><div class="crayon-line" id="crayon-5c0ca43e09ba7109474536-7">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba7109474536-8">dense_2 (Dense)              (None, 20)                220</div><div class="crayon-line" id="crayon-5c0ca43e09ba7109474536-9">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba7109474536-10">dense_3 (Dense)              (None, 10)                210</div><div class="crayon-line" id="crayon-5c0ca43e09ba7109474536-11">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba7109474536-12">dense_4 (Dense)              (None, 1)                 11</div><div class="crayon-line" id="crayon-5c0ca43e09ba7109474536-13">=================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba7109474536-14">Total params: 551</div><div class="crayon-line" id="crayon-5c0ca43e09ba7109474536-15">Trainable params: 551</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba7109474536-16">Non-trainable params: 0</div><div class="crayon-line" id="crayon-5c0ca43e09ba7109474536-17">_________________________________________________________________</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>A plot of the model graph is also created and saved to file.</p>
<div class="wp-caption aligncenter" id="attachment_4393" style="width: 193px"><img alt="Multilayer Perceptron Network Graph" class="size-full wp-image-4393" height="449" sizes="(max-width: 183px) 100vw, 183px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/multilayer_perceptron_graph.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/multilayer_perceptron_graph.png 183w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/multilayer_perceptron_graph-122x300.png 122w" width="183"/><p class="wp-caption-text">Multilayer Perceptron Network Graph</p></div>
<h3>Convolutional Neural Network</h3>
<p>In this section, we will define a convolutional neural network for image classification.</p>
<p>The model receives black and white 64×64 images as input, then has a sequence of two convolutional and pooling layers as feature extractors, followed by a fully connected layer to interpret the features and an output layer with a sigmoid activation for two-class predictions.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e09ba8821377713" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Convolutional Neural Network
from keras.utils import plot_model
from keras.models import Model
from keras.layers import Input
from keras.layers import Dense
from keras.layers import Flatten
from keras.layers.convolutional import Conv2D
from keras.layers.pooling import MaxPooling2D
visible = Input(shape=(64,64,1))
conv1 = Conv2D(32, kernel_size=4, activation='relu')(visible)
pool1 = MaxPooling2D(pool_size=(2, 2))(conv1)
conv2 = Conv2D(16, kernel_size=4, activation='relu')(pool1)
pool2 = MaxPooling2D(pool_size=(2, 2))(conv2)
flat = Flatten()(pool2)
hidden1 = Dense(10, activation='relu')(flat)
output = Dense(1, activation='sigmoid')(hidden1)
model = Model(inputs=visible, outputs=output)
# summarize layers
print(model.summary())
# plot graph
plot_model(model, to_file='convolutional_neural_network.png')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e09ba8821377713-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba8821377713-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba8821377713-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba8821377713-4">4</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba8821377713-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba8821377713-6">6</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba8821377713-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba8821377713-8">8</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba8821377713-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba8821377713-10">10</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba8821377713-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba8821377713-12">12</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba8821377713-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba8821377713-14">14</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba8821377713-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba8821377713-16">16</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba8821377713-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba8821377713-18">18</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba8821377713-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09ba8821377713-20">20</div><div class="crayon-num" data-line="crayon-5c0ca43e09ba8821377713-21">21</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e09ba8821377713-1"><span class="crayon-p"># Convolutional Neural Network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba8821377713-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">plot_model</span></div><div class="crayon-line" id="crayon-5c0ca43e09ba8821377713-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba8821377713-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line" id="crayon-5c0ca43e09ba8821377713-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba8821377713-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line" id="crayon-5c0ca43e09ba8821377713-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">convolutional </span><span class="crayon-e">import </span><span class="crayon-e">Conv2D</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba8821377713-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">pooling </span><span class="crayon-e">import </span><span class="crayon-e">MaxPooling2D</span></div><div class="crayon-line" id="crayon-5c0ca43e09ba8821377713-9"><span class="crayon-v">visible</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba8821377713-10"><span class="crayon-v">conv1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">visible</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09ba8821377713-11"><span class="crayon-v">pool1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">conv1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba8821377713-12"><span class="crayon-v">conv2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">pool1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09ba8821377713-13"><span class="crayon-v">pool2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">conv2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba8821377713-14"><span class="crayon-v">flat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">pool2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09ba8821377713-15"><span class="crayon-v">hidden1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">flat</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba8821377713-16"><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">hidden1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09ba8821377713-17"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-v">visible</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba8821377713-18"><span class="crayon-p"># summarize layers</span></div><div class="crayon-line" id="crayon-5c0ca43e09ba8821377713-19"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09ba8821377713-20"><span class="crayon-p"># plot graph</span></div><div class="crayon-line" id="crayon-5c0ca43e09ba8821377713-21"><span class="crayon-e">plot_model</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">to_file</span><span class="crayon-o">=</span><span class="crayon-s">'convolutional_neural_network.png'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0014 seconds] -->
<p>Running the example summarizes the model layers.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e09baa896658470" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 64, 64, 1)         0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 61, 61, 32)        544       
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 30, 30, 32)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 27, 27, 16)        8208      
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 13, 13, 16)        0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 2704)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 10)                27050     
_________________________________________________________________
dense_2 (Dense)              (None, 1)                 11        
=================================================================
Total params: 35,813
Trainable params: 35,813
Non-trainable params: 0
_________________________________________________________________</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e09baa896658470-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09baa896658470-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e09baa896658470-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09baa896658470-4">4</div><div class="crayon-num" data-line="crayon-5c0ca43e09baa896658470-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09baa896658470-6">6</div><div class="crayon-num" data-line="crayon-5c0ca43e09baa896658470-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09baa896658470-8">8</div><div class="crayon-num" data-line="crayon-5c0ca43e09baa896658470-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09baa896658470-10">10</div><div class="crayon-num" data-line="crayon-5c0ca43e09baa896658470-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09baa896658470-12">12</div><div class="crayon-num" data-line="crayon-5c0ca43e09baa896658470-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09baa896658470-14">14</div><div class="crayon-num" data-line="crayon-5c0ca43e09baa896658470-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09baa896658470-16">16</div><div class="crayon-num" data-line="crayon-5c0ca43e09baa896658470-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09baa896658470-18">18</div><div class="crayon-num" data-line="crayon-5c0ca43e09baa896658470-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09baa896658470-20">20</div><div class="crayon-num" data-line="crayon-5c0ca43e09baa896658470-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09baa896658470-22">22</div><div class="crayon-num" data-line="crayon-5c0ca43e09baa896658470-23">23</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e09baa896658470-1">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09baa896658470-2">Layer (type)                 Output Shape              Param #   </div><div class="crayon-line" id="crayon-5c0ca43e09baa896658470-3">=================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09baa896658470-4">input_1 (InputLayer)         (None, 64, 64, 1)         0         </div><div class="crayon-line" id="crayon-5c0ca43e09baa896658470-5">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09baa896658470-6">conv2d_1 (Conv2D)            (None, 61, 61, 32)        544       </div><div class="crayon-line" id="crayon-5c0ca43e09baa896658470-7">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09baa896658470-8">max_pooling2d_1 (MaxPooling2 (None, 30, 30, 32)        0         </div><div class="crayon-line" id="crayon-5c0ca43e09baa896658470-9">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09baa896658470-10">conv2d_2 (Conv2D)            (None, 27, 27, 16)        8208      </div><div class="crayon-line" id="crayon-5c0ca43e09baa896658470-11">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09baa896658470-12">max_pooling2d_2 (MaxPooling2 (None, 13, 13, 16)        0         </div><div class="crayon-line" id="crayon-5c0ca43e09baa896658470-13">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09baa896658470-14">flatten_1 (Flatten)          (None, 2704)              0         </div><div class="crayon-line" id="crayon-5c0ca43e09baa896658470-15">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09baa896658470-16">dense_1 (Dense)              (None, 10)                27050     </div><div class="crayon-line" id="crayon-5c0ca43e09baa896658470-17">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09baa896658470-18">dense_2 (Dense)              (None, 1)                 11        </div><div class="crayon-line" id="crayon-5c0ca43e09baa896658470-19">=================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09baa896658470-20">Total params: 35,813</div><div class="crayon-line" id="crayon-5c0ca43e09baa896658470-21">Trainable params: 35,813</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09baa896658470-22">Non-trainable params: 0</div><div class="crayon-line" id="crayon-5c0ca43e09baa896658470-23">_________________________________________________________________</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>A plot of the model graph is also created and saved to file.</p>
<div class="wp-caption aligncenter" id="attachment_6866" style="width: 303px"><img alt="Convolutional Neural Network Graph" class="size-full wp-image-6866" height="741" sizes="(max-width: 293px) 100vw, 293px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/convolutional_neural_network.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/convolutional_neural_network.png 293w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/convolutional_neural_network-119x300.png 119w" width="293"/><p class="wp-caption-text">Convolutional Neural Network Graph</p></div>
<h3>Recurrent Neural Network</h3>
<p>In this section, we will define a long short-term memory recurrent neural network for sequence classification.</p>
<p>The model expects 100 time steps of one feature as input. The model has a single LSTM hidden layer to extract features from the sequence, followed by a fully connected layer to interpret the LSTM output, followed by an output layer for making binary predictions.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e09bac049580068" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Recurrent Neural Network
from keras.utils import plot_model
from keras.models import Model
from keras.layers import Input
from keras.layers import Dense
from keras.layers.recurrent import LSTM
visible = Input(shape=(100,1))
hidden1 = LSTM(10)(visible)
hidden2 = Dense(10, activation='relu')(hidden1)
output = Dense(1, activation='sigmoid')(hidden2)
model = Model(inputs=visible, outputs=output)
# summarize layers
print(model.summary())
# plot graph
plot_model(model, to_file='recurrent_neural_network.png')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e09bac049580068-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bac049580068-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e09bac049580068-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bac049580068-4">4</div><div class="crayon-num" data-line="crayon-5c0ca43e09bac049580068-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bac049580068-6">6</div><div class="crayon-num" data-line="crayon-5c0ca43e09bac049580068-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bac049580068-8">8</div><div class="crayon-num" data-line="crayon-5c0ca43e09bac049580068-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bac049580068-10">10</div><div class="crayon-num" data-line="crayon-5c0ca43e09bac049580068-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bac049580068-12">12</div><div class="crayon-num" data-line="crayon-5c0ca43e09bac049580068-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bac049580068-14">14</div><div class="crayon-num" data-line="crayon-5c0ca43e09bac049580068-15">15</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e09bac049580068-1"><span class="crayon-p"># Recurrent Neural Network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bac049580068-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">plot_model</span></div><div class="crayon-line" id="crayon-5c0ca43e09bac049580068-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bac049580068-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line" id="crayon-5c0ca43e09bac049580068-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bac049580068-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">recurrent </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5c0ca43e09bac049580068-7"><span class="crayon-v">visible</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bac049580068-8"><span class="crayon-v">hidden1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">visible</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09bac049580068-9"><span class="crayon-v">hidden2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">hidden1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bac049580068-10"><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">hidden2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09bac049580068-11"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-v">visible</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bac049580068-12"><span class="crayon-p"># summarize layers</span></div><div class="crayon-line" id="crayon-5c0ca43e09bac049580068-13"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bac049580068-14"><span class="crayon-p"># plot graph</span></div><div class="crayon-line" id="crayon-5c0ca43e09bac049580068-15"><span class="crayon-e">plot_model</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">to_file</span><span class="crayon-o">=</span><span class="crayon-s">'recurrent_neural_network.png'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>Running the example summarizes the model layers.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e09bae409487888" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
input_1 (InputLayer)         (None, 100, 1)            0
_________________________________________________________________
lstm_1 (LSTM)                (None, 10)                480
_________________________________________________________________
dense_1 (Dense)              (None, 10)                110
_________________________________________________________________
dense_2 (Dense)              (None, 1)                 11
=================================================================
Total params: 601
Trainable params: 601
Non-trainable params: 0
_________________________________________________________________</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e09bae409487888-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bae409487888-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e09bae409487888-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bae409487888-4">4</div><div class="crayon-num" data-line="crayon-5c0ca43e09bae409487888-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bae409487888-6">6</div><div class="crayon-num" data-line="crayon-5c0ca43e09bae409487888-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bae409487888-8">8</div><div class="crayon-num" data-line="crayon-5c0ca43e09bae409487888-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bae409487888-10">10</div><div class="crayon-num" data-line="crayon-5c0ca43e09bae409487888-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bae409487888-12">12</div><div class="crayon-num" data-line="crayon-5c0ca43e09bae409487888-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bae409487888-14">14</div><div class="crayon-num" data-line="crayon-5c0ca43e09bae409487888-15">15</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e09bae409487888-1">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bae409487888-2">Layer (type)                 Output Shape              Param #</div><div class="crayon-line" id="crayon-5c0ca43e09bae409487888-3">=================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bae409487888-4">input_1 (InputLayer)         (None, 100, 1)            0</div><div class="crayon-line" id="crayon-5c0ca43e09bae409487888-5">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bae409487888-6">lstm_1 (LSTM)                (None, 10)                480</div><div class="crayon-line" id="crayon-5c0ca43e09bae409487888-7">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bae409487888-8">dense_1 (Dense)              (None, 10)                110</div><div class="crayon-line" id="crayon-5c0ca43e09bae409487888-9">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bae409487888-10">dense_2 (Dense)              (None, 1)                 11</div><div class="crayon-line" id="crayon-5c0ca43e09bae409487888-11">=================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bae409487888-12">Total params: 601</div><div class="crayon-line" id="crayon-5c0ca43e09bae409487888-13">Trainable params: 601</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bae409487888-14">Non-trainable params: 0</div><div class="crayon-line" id="crayon-5c0ca43e09bae409487888-15">_________________________________________________________________</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>A plot of the model graph is also created and saved to file.</p>
<div class="wp-caption aligncenter" id="attachment_4395" style="width: 193px"><img alt="Recurrent Neural Network Graph" class="size-full wp-image-4395" height="352" sizes="(max-width: 183px) 100vw, 183px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/recurrent_neural_network.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/recurrent_neural_network.png 183w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/recurrent_neural_network-156x300.png 156w" width="183"/><p class="wp-caption-text">Recurrent Neural Network Graph</p></div>
<h2>4. Shared Layers Model</h2>
<p>Multiple layers can share the output from one layer.</p>
<p>For example, there may be multiple different feature extraction layers from an input, or multiple layers used to interpret the output from a feature extraction layer.</p>
<p>Let’s look at both of these examples.</p>
<h3>Shared Input Layer</h3>
<p>In this section, we define multiple convolutional layers with differently sized kernels to interpret an image input.</p>
<p>The model takes black and white images with the size 64×64 pixels. There are two CNN feature extraction submodels that share this input; the first has a kernel size of 4 and the second a kernel size of 8. The outputs from these feature extraction submodels are flattened into vectors and concatenated into one long vector and passed on to a fully connected layer for interpretation before a final output layer makes a binary classification.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e09bb3193920190" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Shared Input Layer
from keras.utils import plot_model
from keras.models import Model
from keras.layers import Input
from keras.layers import Dense
from keras.layers import Flatten
from keras.layers.convolutional import Conv2D
from keras.layers.pooling import MaxPooling2D
from keras.layers.merge import concatenate
# input layer
visible = Input(shape=(64,64,1))
# first feature extractor
conv1 = Conv2D(32, kernel_size=4, activation='relu')(visible)
pool1 = MaxPooling2D(pool_size=(2, 2))(conv1)
flat1 = Flatten()(pool1)
# second feature extractor
conv2 = Conv2D(16, kernel_size=8, activation='relu')(visible)
pool2 = MaxPooling2D(pool_size=(2, 2))(conv2)
flat2 = Flatten()(pool2)
# merge feature extractors
merge = concatenate([flat1, flat2])
# interpretation layer
hidden1 = Dense(10, activation='relu')(merge)
# prediction output
output = Dense(1, activation='sigmoid')(hidden1)
model = Model(inputs=visible, outputs=output)
# summarize layers
print(model.summary())
# plot graph
plot_model(model, to_file='shared_input_layer.png')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e09bb3193920190-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb3193920190-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb3193920190-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb3193920190-4">4</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb3193920190-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb3193920190-6">6</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb3193920190-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb3193920190-8">8</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb3193920190-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb3193920190-10">10</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb3193920190-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb3193920190-12">12</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb3193920190-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb3193920190-14">14</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb3193920190-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb3193920190-16">16</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb3193920190-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb3193920190-18">18</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb3193920190-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb3193920190-20">20</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb3193920190-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb3193920190-22">22</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb3193920190-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb3193920190-24">24</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb3193920190-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb3193920190-26">26</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb3193920190-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb3193920190-28">28</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb3193920190-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb3193920190-30">30</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e09bb3193920190-1"><span class="crayon-p"># Shared Input Layer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb3193920190-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">plot_model</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb3193920190-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb3193920190-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb3193920190-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb3193920190-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb3193920190-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">convolutional </span><span class="crayon-e">import </span><span class="crayon-e">Conv2D</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb3193920190-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">pooling </span><span class="crayon-e">import </span><span class="crayon-e">MaxPooling2D</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb3193920190-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">merge </span><span class="crayon-e">import </span><span class="crayon-v">concatenate</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb3193920190-10"><span class="crayon-p"># input layer</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb3193920190-11"><span class="crayon-v">visible</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb3193920190-12"><span class="crayon-p"># first feature extractor</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb3193920190-13"><span class="crayon-v">conv1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">visible</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb3193920190-14"><span class="crayon-v">pool1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">conv1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb3193920190-15"><span class="crayon-v">flat1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">pool1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb3193920190-16"><span class="crayon-p"># second feature extractor</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb3193920190-17"><span class="crayon-v">conv2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">visible</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb3193920190-18"><span class="crayon-v">pool2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">conv2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb3193920190-19"><span class="crayon-v">flat2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">pool2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb3193920190-20"><span class="crayon-p"># merge feature extractors</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb3193920190-21"><span class="crayon-v">merge</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concatenate</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">flat1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">flat2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb3193920190-22"><span class="crayon-p"># interpretation layer</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb3193920190-23"><span class="crayon-v">hidden1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">merge</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb3193920190-24"><span class="crayon-p"># prediction output</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb3193920190-25"><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">hidden1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb3193920190-26"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-v">visible</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb3193920190-27"><span class="crayon-p"># summarize layers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb3193920190-28"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb3193920190-29"><span class="crayon-p"># plot graph</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb3193920190-30"><span class="crayon-e">plot_model</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">to_file</span><span class="crayon-o">=</span><span class="crayon-s">'shared_input_layer.png'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0016 seconds] -->
<p>Running the example summarizes the model layers.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e09bb5593186826" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to
====================================================================================================
input_1 (InputLayer)             (None, 64, 64, 1)     0
____________________________________________________________________________________________________
conv2d_1 (Conv2D)                (None, 61, 61, 32)    544         input_1[0][0]
____________________________________________________________________________________________________
conv2d_2 (Conv2D)                (None, 57, 57, 16)    1040        input_1[0][0]
____________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)   (None, 30, 30, 32)    0           conv2d_1[0][0]
____________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)   (None, 28, 28, 16)    0           conv2d_2[0][0]
____________________________________________________________________________________________________
flatten_1 (Flatten)              (None, 28800)         0           max_pooling2d_1[0][0]
____________________________________________________________________________________________________
flatten_2 (Flatten)              (None, 12544)         0           max_pooling2d_2[0][0]
____________________________________________________________________________________________________
concatenate_1 (Concatenate)      (None, 41344)         0           flatten_1[0][0]
                                                                   flatten_2[0][0]
____________________________________________________________________________________________________
dense_1 (Dense)                  (None, 10)            413450      concatenate_1[0][0]
____________________________________________________________________________________________________
dense_2 (Dense)                  (None, 1)             11          dense_1[0][0]
====================================================================================================
Total params: 415,045
Trainable params: 415,045
Non-trainable params: 0
____________________________________________________________________________________________________</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e09bb5593186826-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb5593186826-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb5593186826-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb5593186826-4">4</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb5593186826-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb5593186826-6">6</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb5593186826-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb5593186826-8">8</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb5593186826-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb5593186826-10">10</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb5593186826-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb5593186826-12">12</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb5593186826-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb5593186826-14">14</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb5593186826-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb5593186826-16">16</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb5593186826-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb5593186826-18">18</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb5593186826-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb5593186826-20">20</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb5593186826-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb5593186826-22">22</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb5593186826-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb5593186826-24">24</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb5593186826-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb5593186826-26">26</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb5593186826-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb5593186826-28">28</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e09bb5593186826-1">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb5593186826-2">Layer (type)                     Output Shape          Param #     Connected to</div><div class="crayon-line" id="crayon-5c0ca43e09bb5593186826-3">====================================================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb5593186826-4">input_1 (InputLayer)             (None, 64, 64, 1)     0</div><div class="crayon-line" id="crayon-5c0ca43e09bb5593186826-5">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb5593186826-6">conv2d_1 (Conv2D)                (None, 61, 61, 32)    544         input_1[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bb5593186826-7">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb5593186826-8">conv2d_2 (Conv2D)                (None, 57, 57, 16)    1040        input_1[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bb5593186826-9">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb5593186826-10">max_pooling2d_1 (MaxPooling2D)   (None, 30, 30, 32)    0           conv2d_1[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bb5593186826-11">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb5593186826-12">max_pooling2d_2 (MaxPooling2D)   (None, 28, 28, 16)    0           conv2d_2[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bb5593186826-13">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb5593186826-14">flatten_1 (Flatten)              (None, 28800)         0           max_pooling2d_1[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bb5593186826-15">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb5593186826-16">flatten_2 (Flatten)              (None, 12544)         0           max_pooling2d_2[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bb5593186826-17">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb5593186826-18">concatenate_1 (Concatenate)      (None, 41344)         0           flatten_1[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bb5593186826-19">                                                                   flatten_2[0][0]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb5593186826-20">____________________________________________________________________________________________________</div><div class="crayon-line" id="crayon-5c0ca43e09bb5593186826-21">dense_1 (Dense)                  (None, 10)            413450      concatenate_1[0][0]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb5593186826-22">____________________________________________________________________________________________________</div><div class="crayon-line" id="crayon-5c0ca43e09bb5593186826-23">dense_2 (Dense)                  (None, 1)             11          dense_1[0][0]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb5593186826-24">====================================================================================================</div><div class="crayon-line" id="crayon-5c0ca43e09bb5593186826-25">Total params: 415,045</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb5593186826-26">Trainable params: 415,045</div><div class="crayon-line" id="crayon-5c0ca43e09bb5593186826-27">Non-trainable params: 0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb5593186826-28">____________________________________________________________________________________________________</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>A plot of the model graph is also created and saved to file.</p>
<div class="wp-caption aligncenter" id="attachment_4396" style="width: 610px"><img alt="Neural Network Graph With Shared Inputs" class="size-full wp-image-4396" height="644" sizes="(max-width: 600px) 100vw, 600px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/shared_input_layer.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/shared_input_layer.png 600w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/shared_input_layer-280x300.png 280w" width="600"/><p class="wp-caption-text">Neural Network Graph With Shared Inputs</p></div>
<h3>Shared Feature Extraction Layer</h3>
<p>In this section, we will use two parallel submodels to interpret the output of an LSTM feature extractor for sequence classification.</p>
<p>The input to the model is 100 time steps of 1 feature. An LSTM layer with 10 memory cells interprets this sequence. The first interpretation model is a shallow single fully connected layer, the second is a deep 3 layer model. The output of both interpretation models are concatenated into one long vector that is passed to the output layer used to make a binary prediction.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e09bb7144677362" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Shared Feature Extraction Layer
from keras.utils import plot_model
from keras.models import Model
from keras.layers import Input
from keras.layers import Dense
from keras.layers.recurrent import LSTM
from keras.layers.merge import concatenate
# define input
visible = Input(shape=(100,1))
# feature extraction
extract1 = LSTM(10)(visible)
# first interpretation model
interp1 = Dense(10, activation='relu')(extract1)
# second interpretation model
interp11 = Dense(10, activation='relu')(extract1)
interp12 = Dense(20, activation='relu')(interp11)
interp13 = Dense(10, activation='relu')(interp12)
# merge interpretation
merge = concatenate([interp1, interp13])
# output
output = Dense(1, activation='sigmoid')(merge)
model = Model(inputs=visible, outputs=output)
# summarize layers
print(model.summary())
# plot graph
plot_model(model, to_file='shared_feature_extractor.png')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e09bb7144677362-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb7144677362-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb7144677362-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb7144677362-4">4</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb7144677362-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb7144677362-6">6</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb7144677362-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb7144677362-8">8</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb7144677362-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb7144677362-10">10</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb7144677362-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb7144677362-12">12</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb7144677362-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb7144677362-14">14</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb7144677362-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb7144677362-16">16</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb7144677362-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb7144677362-18">18</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb7144677362-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb7144677362-20">20</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb7144677362-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb7144677362-22">22</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb7144677362-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb7144677362-24">24</div><div class="crayon-num" data-line="crayon-5c0ca43e09bb7144677362-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bb7144677362-26">26</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e09bb7144677362-1"><span class="crayon-p"># Shared Feature Extraction Layer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb7144677362-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">plot_model</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb7144677362-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb7144677362-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb7144677362-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb7144677362-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">recurrent </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb7144677362-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">merge </span><span class="crayon-e">import </span><span class="crayon-v">concatenate</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb7144677362-8"><span class="crayon-p"># define input</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb7144677362-9"><span class="crayon-v">visible</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb7144677362-10"><span class="crayon-p"># feature extraction</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb7144677362-11"><span class="crayon-v">extract1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">visible</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb7144677362-12"><span class="crayon-p"># first interpretation model</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb7144677362-13"><span class="crayon-v">interp1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">extract1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb7144677362-14"><span class="crayon-p"># second interpretation model</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb7144677362-15"><span class="crayon-v">interp11</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">extract1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb7144677362-16"><span class="crayon-v">interp12</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">interp11</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb7144677362-17"><span class="crayon-v">interp13</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">interp12</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb7144677362-18"><span class="crayon-p"># merge interpretation</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb7144677362-19"><span class="crayon-v">merge</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concatenate</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">interp1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">interp13</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb7144677362-20"><span class="crayon-p"># output</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb7144677362-21"><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">merge</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb7144677362-22"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-v">visible</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb7144677362-23"><span class="crayon-p"># summarize layers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb7144677362-24"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09bb7144677362-25"><span class="crayon-p"># plot graph</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bb7144677362-26"><span class="crayon-e">plot_model</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">to_file</span><span class="crayon-o">=</span><span class="crayon-s">'shared_feature_extractor.png'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0013 seconds] -->
<p>Running the example summarizes the model layers.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e09bba755247435" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to
====================================================================================================
input_1 (InputLayer)             (None, 100, 1)        0
____________________________________________________________________________________________________
lstm_1 (LSTM)                    (None, 10)            480         input_1[0][0]
____________________________________________________________________________________________________
dense_2 (Dense)                  (None, 10)            110         lstm_1[0][0]
____________________________________________________________________________________________________
dense_3 (Dense)                  (None, 20)            220         dense_2[0][0]
____________________________________________________________________________________________________
dense_1 (Dense)                  (None, 10)            110         lstm_1[0][0]
____________________________________________________________________________________________________
dense_4 (Dense)                  (None, 10)            210         dense_3[0][0]
____________________________________________________________________________________________________
concatenate_1 (Concatenate)      (None, 20)            0           dense_1[0][0]
                                                                   dense_4[0][0]
____________________________________________________________________________________________________
dense_5 (Dense)                  (None, 1)             21          concatenate_1[0][0]
====================================================================================================
Total params: 1,151
Trainable params: 1,151
Non-trainable params: 0
____________________________________________________________________________________________________</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e09bba755247435-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bba755247435-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e09bba755247435-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bba755247435-4">4</div><div class="crayon-num" data-line="crayon-5c0ca43e09bba755247435-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bba755247435-6">6</div><div class="crayon-num" data-line="crayon-5c0ca43e09bba755247435-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bba755247435-8">8</div><div class="crayon-num" data-line="crayon-5c0ca43e09bba755247435-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bba755247435-10">10</div><div class="crayon-num" data-line="crayon-5c0ca43e09bba755247435-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bba755247435-12">12</div><div class="crayon-num" data-line="crayon-5c0ca43e09bba755247435-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bba755247435-14">14</div><div class="crayon-num" data-line="crayon-5c0ca43e09bba755247435-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bba755247435-16">16</div><div class="crayon-num" data-line="crayon-5c0ca43e09bba755247435-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bba755247435-18">18</div><div class="crayon-num" data-line="crayon-5c0ca43e09bba755247435-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bba755247435-20">20</div><div class="crayon-num" data-line="crayon-5c0ca43e09bba755247435-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bba755247435-22">22</div><div class="crayon-num" data-line="crayon-5c0ca43e09bba755247435-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bba755247435-24">24</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e09bba755247435-1">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bba755247435-2">Layer (type)                     Output Shape          Param #     Connected to</div><div class="crayon-line" id="crayon-5c0ca43e09bba755247435-3">====================================================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bba755247435-4">input_1 (InputLayer)             (None, 100, 1)        0</div><div class="crayon-line" id="crayon-5c0ca43e09bba755247435-5">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bba755247435-6">lstm_1 (LSTM)                    (None, 10)            480         input_1[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bba755247435-7">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bba755247435-8">dense_2 (Dense)                  (None, 10)            110         lstm_1[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bba755247435-9">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bba755247435-10">dense_3 (Dense)                  (None, 20)            220         dense_2[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bba755247435-11">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bba755247435-12">dense_1 (Dense)                  (None, 10)            110         lstm_1[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bba755247435-13">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bba755247435-14">dense_4 (Dense)                  (None, 10)            210         dense_3[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bba755247435-15">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bba755247435-16">concatenate_1 (Concatenate)      (None, 20)            0           dense_1[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bba755247435-17">                                                                   dense_4[0][0]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bba755247435-18">____________________________________________________________________________________________________</div><div class="crayon-line" id="crayon-5c0ca43e09bba755247435-19">dense_5 (Dense)                  (None, 1)             21          concatenate_1[0][0]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bba755247435-20">====================================================================================================</div><div class="crayon-line" id="crayon-5c0ca43e09bba755247435-21">Total params: 1,151</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bba755247435-22">Trainable params: 1,151</div><div class="crayon-line" id="crayon-5c0ca43e09bba755247435-23">Non-trainable params: 0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bba755247435-24">____________________________________________________________________________________________________</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>A plot of the model graph is also created and saved to file.</p>
<div class="wp-caption aligncenter" id="attachment_4397" style="width: 325px"><img alt="Neural Network Graph With Shared Feature Extraction Layer" class="size-full wp-image-4397" height="644" sizes="(max-width: 315px) 100vw, 315px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/shared_feature_extractor.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/shared_feature_extractor.png 315w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/shared_feature_extractor-147x300.png 147w" width="315"/><p class="wp-caption-text">Neural Network Graph With Shared Feature Extraction Layer</p></div>
<h2>5. Multiple Input and Output Models</h2>
<p>The functional API can also be used to develop more complex models with multiple inputs, possibly with different modalities. It can also be used to develop models that produce multiple outputs.</p>
<p>We will look at examples of each in this section.</p>
<h3>Multiple Input Model</h3>
<p>We will develop an image classification model that takes two versions of the image as input, each of a different size. Specifically a black and white 64×64 version and a color 32×32 version. Separate feature extraction CNN models operate on each, then the results from both models are concatenated for interpretation and ultimate prediction.</p>
<p>Note that in the creation of the Model() instance, that we define the two input layers as an array. Specifically:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e09bbd822207226" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
model = Model(inputs=[visible1, visible2], outputs=output)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e09bbd822207226-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e09bbd822207226-1"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">visible1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">visible2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e09bbf283822667" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Multiple Inputs
from keras.utils import plot_model
from keras.models import Model
from keras.layers import Input
from keras.layers import Dense
from keras.layers import Flatten
from keras.layers.convolutional import Conv2D
from keras.layers.pooling import MaxPooling2D
from keras.layers.merge import concatenate
# first input model
visible1 = Input(shape=(64,64,1))
conv11 = Conv2D(32, kernel_size=4, activation='relu')(visible1)
pool11 = MaxPooling2D(pool_size=(2, 2))(conv11)
conv12 = Conv2D(16, kernel_size=4, activation='relu')(pool11)
pool12 = MaxPooling2D(pool_size=(2, 2))(conv12)
flat1 = Flatten()(pool12)
# second input model
visible2 = Input(shape=(32,32,3))
conv21 = Conv2D(32, kernel_size=4, activation='relu')(visible2)
pool21 = MaxPooling2D(pool_size=(2, 2))(conv21)
conv22 = Conv2D(16, kernel_size=4, activation='relu')(pool21)
pool22 = MaxPooling2D(pool_size=(2, 2))(conv22)
flat2 = Flatten()(pool22)
# merge input models
merge = concatenate([flat1, flat2])
# interpretation model
hidden1 = Dense(10, activation='relu')(merge)
hidden2 = Dense(10, activation='relu')(hidden1)
output = Dense(1, activation='sigmoid')(hidden2)
model = Model(inputs=[visible1, visible2], outputs=output)
# summarize layers
print(model.summary())
# plot graph
plot_model(model, to_file='multiple_inputs.png')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e09bbf283822667-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bbf283822667-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e09bbf283822667-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bbf283822667-4">4</div><div class="crayon-num" data-line="crayon-5c0ca43e09bbf283822667-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bbf283822667-6">6</div><div class="crayon-num" data-line="crayon-5c0ca43e09bbf283822667-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bbf283822667-8">8</div><div class="crayon-num" data-line="crayon-5c0ca43e09bbf283822667-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bbf283822667-10">10</div><div class="crayon-num" data-line="crayon-5c0ca43e09bbf283822667-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bbf283822667-12">12</div><div class="crayon-num" data-line="crayon-5c0ca43e09bbf283822667-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bbf283822667-14">14</div><div class="crayon-num" data-line="crayon-5c0ca43e09bbf283822667-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bbf283822667-16">16</div><div class="crayon-num" data-line="crayon-5c0ca43e09bbf283822667-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bbf283822667-18">18</div><div class="crayon-num" data-line="crayon-5c0ca43e09bbf283822667-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bbf283822667-20">20</div><div class="crayon-num" data-line="crayon-5c0ca43e09bbf283822667-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bbf283822667-22">22</div><div class="crayon-num" data-line="crayon-5c0ca43e09bbf283822667-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bbf283822667-24">24</div><div class="crayon-num" data-line="crayon-5c0ca43e09bbf283822667-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bbf283822667-26">26</div><div class="crayon-num" data-line="crayon-5c0ca43e09bbf283822667-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bbf283822667-28">28</div><div class="crayon-num" data-line="crayon-5c0ca43e09bbf283822667-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bbf283822667-30">30</div><div class="crayon-num" data-line="crayon-5c0ca43e09bbf283822667-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bbf283822667-32">32</div><div class="crayon-num" data-line="crayon-5c0ca43e09bbf283822667-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bbf283822667-34">34</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e09bbf283822667-1"><span class="crayon-p"># Multiple Inputs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bbf283822667-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">plot_model</span></div><div class="crayon-line" id="crayon-5c0ca43e09bbf283822667-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bbf283822667-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line" id="crayon-5c0ca43e09bbf283822667-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bbf283822667-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line" id="crayon-5c0ca43e09bbf283822667-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">convolutional </span><span class="crayon-e">import </span><span class="crayon-e">Conv2D</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bbf283822667-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">pooling </span><span class="crayon-e">import </span><span class="crayon-e">MaxPooling2D</span></div><div class="crayon-line" id="crayon-5c0ca43e09bbf283822667-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">merge </span><span class="crayon-e">import </span><span class="crayon-v">concatenate</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bbf283822667-10"><span class="crayon-p"># first input model</span></div><div class="crayon-line" id="crayon-5c0ca43e09bbf283822667-11"><span class="crayon-v">visible1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bbf283822667-12"><span class="crayon-v">conv11</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">visible1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09bbf283822667-13"><span class="crayon-v">pool11</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">conv11</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bbf283822667-14"><span class="crayon-v">conv12</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">pool11</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09bbf283822667-15"><span class="crayon-v">pool12</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">conv12</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bbf283822667-16"><span class="crayon-v">flat1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">pool12</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09bbf283822667-17"><span class="crayon-p"># second input model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bbf283822667-18"><span class="crayon-v">visible2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09bbf283822667-19"><span class="crayon-v">conv21</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">visible2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bbf283822667-20"><span class="crayon-v">pool21</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">conv21</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09bbf283822667-21"><span class="crayon-v">conv22</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">pool21</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bbf283822667-22"><span class="crayon-v">pool22</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">conv22</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09bbf283822667-23"><span class="crayon-v">flat2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">pool22</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bbf283822667-24"><span class="crayon-p"># merge input models</span></div><div class="crayon-line" id="crayon-5c0ca43e09bbf283822667-25"><span class="crayon-v">merge</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">concatenate</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">flat1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">flat2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bbf283822667-26"><span class="crayon-p"># interpretation model</span></div><div class="crayon-line" id="crayon-5c0ca43e09bbf283822667-27"><span class="crayon-v">hidden1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">merge</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bbf283822667-28"><span class="crayon-v">hidden2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">hidden1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09bbf283822667-29"><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">hidden2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bbf283822667-30"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">visible1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">visible2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09bbf283822667-31"><span class="crayon-p"># summarize layers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bbf283822667-32"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09bbf283822667-33"><span class="crayon-p"># plot graph</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bbf283822667-34"><span class="crayon-e">plot_model</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">to_file</span><span class="crayon-o">=</span><span class="crayon-s">'multiple_inputs.png'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0023 seconds] -->
<p>Running the example summarizes the model layers.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e09bc1268583557" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to
====================================================================================================
input_1 (InputLayer)             (None, 64, 64, 1)     0
____________________________________________________________________________________________________
input_2 (InputLayer)             (None, 32, 32, 3)     0
____________________________________________________________________________________________________
conv2d_1 (Conv2D)                (None, 61, 61, 32)    544         input_1[0][0]
____________________________________________________________________________________________________
conv2d_3 (Conv2D)                (None, 29, 29, 32)    1568        input_2[0][0]
____________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)   (None, 30, 30, 32)    0           conv2d_1[0][0]
____________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)   (None, 14, 14, 32)    0           conv2d_3[0][0]
____________________________________________________________________________________________________
conv2d_2 (Conv2D)                (None, 27, 27, 16)    8208        max_pooling2d_1[0][0]
____________________________________________________________________________________________________
conv2d_4 (Conv2D)                (None, 11, 11, 16)    8208        max_pooling2d_3[0][0]
____________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)   (None, 13, 13, 16)    0           conv2d_2[0][0]
____________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)   (None, 5, 5, 16)      0           conv2d_4[0][0]
____________________________________________________________________________________________________
flatten_1 (Flatten)              (None, 2704)          0           max_pooling2d_2[0][0]
____________________________________________________________________________________________________
flatten_2 (Flatten)              (None, 400)           0           max_pooling2d_4[0][0]
____________________________________________________________________________________________________
concatenate_1 (Concatenate)      (None, 3104)          0           flatten_1[0][0]
                                                                   flatten_2[0][0]
____________________________________________________________________________________________________
dense_1 (Dense)                  (None, 10)            31050       concatenate_1[0][0]
____________________________________________________________________________________________________
dense_2 (Dense)                  (None, 10)            110         dense_1[0][0]
____________________________________________________________________________________________________
dense_3 (Dense)                  (None, 1)             11          dense_2[0][0]
====================================================================================================
Total params: 49,699
Trainable params: 49,699
Non-trainable params: 0
____________________________________________________________________________________________________</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e09bc1268583557-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc1268583557-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc1268583557-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc1268583557-4">4</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc1268583557-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc1268583557-6">6</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc1268583557-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc1268583557-8">8</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc1268583557-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc1268583557-10">10</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc1268583557-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc1268583557-12">12</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc1268583557-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc1268583557-14">14</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc1268583557-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc1268583557-16">16</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc1268583557-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc1268583557-18">18</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc1268583557-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc1268583557-20">20</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc1268583557-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc1268583557-22">22</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc1268583557-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc1268583557-24">24</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc1268583557-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc1268583557-26">26</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc1268583557-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc1268583557-28">28</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc1268583557-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc1268583557-30">30</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc1268583557-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc1268583557-32">32</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc1268583557-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc1268583557-34">34</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc1268583557-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc1268583557-36">36</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc1268583557-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc1268583557-38">38</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc1268583557-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc1268583557-40">40</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e09bc1268583557-1">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc1268583557-2">Layer (type)                     Output Shape          Param #     Connected to</div><div class="crayon-line" id="crayon-5c0ca43e09bc1268583557-3">====================================================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc1268583557-4">input_1 (InputLayer)             (None, 64, 64, 1)     0</div><div class="crayon-line" id="crayon-5c0ca43e09bc1268583557-5">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc1268583557-6">input_2 (InputLayer)             (None, 32, 32, 3)     0</div><div class="crayon-line" id="crayon-5c0ca43e09bc1268583557-7">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc1268583557-8">conv2d_1 (Conv2D)                (None, 61, 61, 32)    544         input_1[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bc1268583557-9">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc1268583557-10">conv2d_3 (Conv2D)                (None, 29, 29, 32)    1568        input_2[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bc1268583557-11">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc1268583557-12">max_pooling2d_1 (MaxPooling2D)   (None, 30, 30, 32)    0           conv2d_1[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bc1268583557-13">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc1268583557-14">max_pooling2d_3 (MaxPooling2D)   (None, 14, 14, 32)    0           conv2d_3[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bc1268583557-15">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc1268583557-16">conv2d_2 (Conv2D)                (None, 27, 27, 16)    8208        max_pooling2d_1[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bc1268583557-17">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc1268583557-18">conv2d_4 (Conv2D)                (None, 11, 11, 16)    8208        max_pooling2d_3[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bc1268583557-19">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc1268583557-20">max_pooling2d_2 (MaxPooling2D)   (None, 13, 13, 16)    0           conv2d_2[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bc1268583557-21">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc1268583557-22">max_pooling2d_4 (MaxPooling2D)   (None, 5, 5, 16)      0           conv2d_4[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bc1268583557-23">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc1268583557-24">flatten_1 (Flatten)              (None, 2704)          0           max_pooling2d_2[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bc1268583557-25">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc1268583557-26">flatten_2 (Flatten)              (None, 400)           0           max_pooling2d_4[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bc1268583557-27">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc1268583557-28">concatenate_1 (Concatenate)      (None, 3104)          0           flatten_1[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bc1268583557-29">                                                                   flatten_2[0][0]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc1268583557-30">____________________________________________________________________________________________________</div><div class="crayon-line" id="crayon-5c0ca43e09bc1268583557-31">dense_1 (Dense)                  (None, 10)            31050       concatenate_1[0][0]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc1268583557-32">____________________________________________________________________________________________________</div><div class="crayon-line" id="crayon-5c0ca43e09bc1268583557-33">dense_2 (Dense)                  (None, 10)            110         dense_1[0][0]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc1268583557-34">____________________________________________________________________________________________________</div><div class="crayon-line" id="crayon-5c0ca43e09bc1268583557-35">dense_3 (Dense)                  (None, 1)             11          dense_2[0][0]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc1268583557-36">====================================================================================================</div><div class="crayon-line" id="crayon-5c0ca43e09bc1268583557-37">Total params: 49,699</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc1268583557-38">Trainable params: 49,699</div><div class="crayon-line" id="crayon-5c0ca43e09bc1268583557-39">Non-trainable params: 0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc1268583557-40">____________________________________________________________________________________________________</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>A plot of the model graph is also created and saved to file.</p>
<div class="wp-caption aligncenter" id="attachment_4398" style="width: 610px"><img alt="Neural Network Graph With Multiple Inputs" class="size-full wp-image-4398" height="936" sizes="(max-width: 600px) 100vw, 600px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/multiple_inputs.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/multiple_inputs.png 600w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/multiple_inputs-192x300.png 192w" width="600"/><p class="wp-caption-text">Neural Network Graph With Multiple Inputs</p></div>
<h3>Multiple Output Model</h3>
<p>In this section, we will develop a model that makes two different types of predictions. Given an input sequence of 100 time steps of one feature, the model will both classify the sequence and output a new sequence with the same length.</p>
<p>An LSTM layer interprets the input sequence and returns the hidden state for each time step. The first output model creates a stacked LSTM, interprets the features, and makes a binary prediction. The second output model uses the same output layer to make a real-valued prediction for each input time step.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e09bc3740478730" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Multiple Outputs
from keras.utils import plot_model
from keras.models import Model
from keras.layers import Input
from keras.layers import Dense
from keras.layers.recurrent import LSTM
from keras.layers.wrappers import TimeDistributed
# input layer
visible = Input(shape=(100,1))
# feature extraction
extract = LSTM(10, return_sequences=True)(visible)
# classification output
class11 = LSTM(10)(extract)
class12 = Dense(10, activation='relu')(class11)
output1 = Dense(1, activation='sigmoid')(class12)
# sequence output
output2 = TimeDistributed(Dense(1, activation='linear'))(extract)
# output
model = Model(inputs=visible, outputs=[output1, output2])
# summarize layers
print(model.summary())
# plot graph
plot_model(model, to_file='multiple_outputs.png')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e09bc3740478730-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc3740478730-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc3740478730-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc3740478730-4">4</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc3740478730-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc3740478730-6">6</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc3740478730-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc3740478730-8">8</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc3740478730-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc3740478730-10">10</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc3740478730-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc3740478730-12">12</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc3740478730-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc3740478730-14">14</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc3740478730-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc3740478730-16">16</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc3740478730-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc3740478730-18">18</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc3740478730-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc3740478730-20">20</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc3740478730-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc3740478730-22">22</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc3740478730-23">23</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e09bc3740478730-1"><span class="crayon-p"># Multiple Outputs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc3740478730-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">plot_model</span></div><div class="crayon-line" id="crayon-5c0ca43e09bc3740478730-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc3740478730-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Input</span></div><div class="crayon-line" id="crayon-5c0ca43e09bc3740478730-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc3740478730-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">recurrent </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5c0ca43e09bc3740478730-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">wrappers </span><span class="crayon-e">import </span><span class="crayon-v">TimeDistributed</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc3740478730-8"><span class="crayon-p"># input layer</span></div><div class="crayon-line" id="crayon-5c0ca43e09bc3740478730-9"><span class="crayon-v">visible</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc3740478730-10"><span class="crayon-p"># feature extraction</span></div><div class="crayon-line" id="crayon-5c0ca43e09bc3740478730-11"><span class="crayon-v">extract</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">visible</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc3740478730-12"><span class="crayon-p"># classification output</span></div><div class="crayon-line" id="crayon-5c0ca43e09bc3740478730-13"><span class="crayon-v">class11</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">extract</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc3740478730-14"><span class="crayon-v">class12</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">class11</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09bc3740478730-15"><span class="crayon-v">output1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">class12</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc3740478730-16"><span class="crayon-p"># sequence output</span></div><div class="crayon-line" id="crayon-5c0ca43e09bc3740478730-17"><span class="crayon-v">output2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">TimeDistributed</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'linear'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">extract</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc3740478730-18"><span class="crayon-p"># output</span></div><div class="crayon-line" id="crayon-5c0ca43e09bc3740478730-19"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-v">visible</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">output1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">output2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc3740478730-20"><span class="crayon-p"># summarize layers</span></div><div class="crayon-line" id="crayon-5c0ca43e09bc3740478730-21"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc3740478730-22"><span class="crayon-p"># plot graph</span></div><div class="crayon-line" id="crayon-5c0ca43e09bc3740478730-23"><span class="crayon-e">plot_model</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">to_file</span><span class="crayon-o">=</span><span class="crayon-s">'multiple_outputs.png'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>Running the example summarizes the model layers.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e09bc6963680809" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to
====================================================================================================
input_1 (InputLayer)             (None, 100, 1)        0
____________________________________________________________________________________________________
lstm_1 (LSTM)                    (None, 100, 10)       480         input_1[0][0]
____________________________________________________________________________________________________
lstm_2 (LSTM)                    (None, 10)            840         lstm_1[0][0]
____________________________________________________________________________________________________
dense_1 (Dense)                  (None, 10)            110         lstm_2[0][0]
____________________________________________________________________________________________________
dense_2 (Dense)                  (None, 1)             11          dense_1[0][0]
____________________________________________________________________________________________________
time_distributed_1 (TimeDistribu (None, 100, 1)        11          lstm_1[0][0]
====================================================================================================
Total params: 1,452
Trainable params: 1,452
Non-trainable params: 0
____________________________________________________________________________________________________</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e09bc6963680809-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc6963680809-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc6963680809-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc6963680809-4">4</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc6963680809-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc6963680809-6">6</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc6963680809-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc6963680809-8">8</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc6963680809-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc6963680809-10">10</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc6963680809-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc6963680809-12">12</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc6963680809-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc6963680809-14">14</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc6963680809-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc6963680809-16">16</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc6963680809-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc6963680809-18">18</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc6963680809-19">19</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e09bc6963680809-1">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc6963680809-2">Layer (type)                     Output Shape          Param #     Connected to</div><div class="crayon-line" id="crayon-5c0ca43e09bc6963680809-3">====================================================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc6963680809-4">input_1 (InputLayer)             (None, 100, 1)        0</div><div class="crayon-line" id="crayon-5c0ca43e09bc6963680809-5">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc6963680809-6">lstm_1 (LSTM)                    (None, 100, 10)       480         input_1[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bc6963680809-7">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc6963680809-8">lstm_2 (LSTM)                    (None, 10)            840         lstm_1[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bc6963680809-9">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc6963680809-10">dense_1 (Dense)                  (None, 10)            110         lstm_2[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bc6963680809-11">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc6963680809-12">dense_2 (Dense)                  (None, 1)             11          dense_1[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bc6963680809-13">____________________________________________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc6963680809-14">time_distributed_1 (TimeDistribu (None, 100, 1)        11          lstm_1[0][0]</div><div class="crayon-line" id="crayon-5c0ca43e09bc6963680809-15">====================================================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc6963680809-16">Total params: 1,452</div><div class="crayon-line" id="crayon-5c0ca43e09bc6963680809-17">Trainable params: 1,452</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc6963680809-18">Non-trainable params: 0</div><div class="crayon-line" id="crayon-5c0ca43e09bc6963680809-19">____________________________________________________________________________________________________</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>A plot of the model graph is also created and saved to file.</p>
<div class="wp-caption aligncenter" id="attachment_4399" style="width: 611px"><img alt="Neural Network Graph With Multiple Outputs" class="size-full wp-image-4399" height="449" sizes="(max-width: 601px) 100vw, 601px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/multiple_outputs.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/multiple_outputs.png 601w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/08/multiple_outputs-300x224.png 300w" width="601"/><p class="wp-caption-text">Neural Network Graph With Multiple Outputs</p></div>
<h2>6. Best Practices</h2>
<p>In this section, I want to give you some tips to get the most out of the functional API when you are defining your own models.</p>
<ul>
<li><strong>Consistent Variable Names</strong>. Use the same variable name for the input (visible) and output layers (output) and perhaps even the hidden layers (hidden1, hidden2). It will help to connect things together correctly.</li>
<li><strong>Review Layer Summary</strong>. Always print the model summary and review the layer outputs to ensure that the model was connected together as you expected.</li>
<li><strong>Review Graph Plots</strong>. Always create a plot of the model graph and review it to ensure that everything was put together as you intended.</li>
<li><strong>Name the layers</strong>. You can assign names to layers that are used when reviewing summaries and plots of the model graph. For example: Dense(1, name=’hidden1′).</li>
<li><strong>Separate Submodels</strong>. Consider separating out the development of submodels and combine the submodels together at the end.</li>
</ul>
<p>Do you have your own best practice tips when using the functional API?<br/>
Let me know in the comments.</p>
<h2>7. Note on the Functional API Python Syntax</h2>
<p>If you are new or new-ish to Python the syntax used in the functional API may be confusing.</p>
<p>For example, given:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e09bc8079408674" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
...
dense1 = Dense(32)(input)
...</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e09bc8079408674-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bc8079408674-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e09bc8079408674-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e09bc8079408674-1"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bc8079408674-2"><span class="crayon-v">dense1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">input</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09bc8079408674-3"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p><strong>What does the double bracket syntax do? </strong></p>
<p><strong>What does it mean?</strong></p>
<p>It looks confusing, but it is not a special python thing, just one line doing two things.</p>
<p>The first bracket “<em>(32)</em>” creates the layer via the class constructor, the second bracket “<em>(input)</em>” is a function with no name implemented via the <em>__call__()</em> function, that when called will connect the layers.</p>
<p>The <a href="https://docs.python.org/3/reference/datamodel.html#object.__call__">__call__()</a> function is a default function on all Python objects that can be overridden and is used to “<em>call</em>” an instantiated object. Just like the <a href="https://docs.python.org/3/reference/datamodel.html#object.__init__">__init__()</a> function is a default function on all objects called just after instantiating an object to initialize it.</p>
<p>We can do the same thing in two lines:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e09bcb626492331" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# create layer
dense1 = Dense(32)
# connect layer to previous layer
dense1(input)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e09bcb626492331-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bcb626492331-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e09bcb626492331-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bcb626492331-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e09bcb626492331-1"><span class="crayon-p"># create layer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bcb626492331-2"><span class="crayon-v">dense1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09bcb626492331-3"><span class="crayon-p"># connect layer to previous layer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bcb626492331-4"><span class="crayon-e">dense1</span><span class="crayon-sy">(</span><span class="crayon-v">input</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>I guess we could also call the <em>__call__()</em> function on the object explicitly, although I have never tried:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e09bcd896306850" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# create layer
dense1 = Dense(32)
# connect layer to previous layer
dense1.__call_(input)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e09bcd896306850-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bcd896306850-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e09bcd896306850-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e09bcd896306850-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e09bcd896306850-1"><span class="crayon-p"># create layer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bcd896306850-2"><span class="crayon-v">dense1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e09bcd896306850-3"><span class="crayon-p"># connect layer to previous layer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e09bcd896306850-4"><span class="crayon-v">dense1</span><span class="crayon-sy">.</span><span class="crayon-e">__call_</span><span class="crayon-sy">(</span><span class="crayon-v">input</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<h2>Further Reading</h2>
<p>This section provides more resources on the topic if you are looking go deeper.</p>
<ul>
<li><a href="https://keras.io/models/model/">The Sequential model API</a></li>
<li><a href="https://keras.io/models/model/">Getting started with the Keras Sequential model</a></li>
<li><a href="https://keras.io/models/model/">Getting started with the Keras functional API</a></li>
<li><a href="https://keras.io/models/model/">Model class Functional API</a></li>
</ul>
<h2>Summary</h2>
<p>In this tutorial, you discovered how to use the functional API in Keras for defining simple and complex deep learning models.</p>
<p>Specifically, you learned:</p>
<ul>
<li>The difference between the Sequential and Functional APIs.</li>
<li>How to define simple Multilayer Perceptron, Convolutional Neural Network, and Recurrent Neural Network models using the functional API.</li>
<li>How to define more complex models with shared layers and multiple inputs and outputs.</li>
</ul>
<p>Do you have any questions?<br/>
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="awac-wrapper"><div class="awac widget text-35"> <div class="textwidget"><div class="woo-sc-hr"></div>
<h2 style="text-align: center;">Frustrated With Your Progress In Deep Learning?</h2>
<p><a href="/deep-learning-with-python/"><img align="left" alt="Deep Learning with Python" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/DeepLearningWithPython-220.png" style="border: 0;"/></a></p>
<h4 style="text-align: center;"> What If You Could Develop A Network in Minutes</h4>
<p style="text-align: center;">…with just a few lines of Python</p>
<p style="text-align: center;">Discover how in my new Ebook: <a href="https://machinelearningmastery.com/deep-learning-with-python/">Deep Learning With Python</a></p>
<p style="text-align: center;">It covers <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> on topics like:<br/>
<em>Multilayer Perceptrons</em>, <em>Convolutional Nets</em> and <em>Recurrent Neural Nets</em>, and more…</p>
<h4 style="text-align: center;">Finally Bring Deep Learning To<br/>
Your Own Projects</h4>
<p style="text-align: center;">Skip the Academics. Just Results.</p>
<p style="text-align: center;"><a href="https://machinelearningmastery.com/deep-learning-with-python/">Click to learn more</a>.</p>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-4392 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Use+the+Keras+Functional+API+for+Deep+Learning&amp;url=https://machinelearningmastery.com/keras-functional-api-deep-learning/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/keras-functional-api-deep-learning/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/keras-functional-api-deep-learning/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/keras-functional-api-deep-learning/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
</section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/define-encoder-decoder-sequence-sequence-model-neural-machine-translation-keras/" rel="prev"><i class="fa fa-angle-left"></i> How to Define an Encoder-Decoder Sequence-to-Sequence Model for Neural Machine Translation in Keras</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/" rel="next">How to Develop a Word Embedding Model for Predicting Movie Review Sentiment <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">140 Responses to <em>How to Use the Keras Functional API for Deep Learning</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-418060">
<div class="comment-container" id="li-comment-418060">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/039d8252526c3344cd360dcd347be76c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/039d8252526c3344cd360dcd347be76c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Salameh</span>
<span class="date">October 27, 2017 at 5:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418060" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you<br/>
I have been waiting fir this tutorial</p>
<div class="reply">
<a aria-label="Reply to Salameh" class="comment-reply-link" href="#comment-418060" onclick='return addComment.moveForm( "comment-418060", "418060", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418101">
<div class="comment-container" id="li-comment-418101">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 27, 2017 at 2:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418101" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, I hope it helps!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-418101" onclick='return addComment.moveForm( "comment-418101", "418101", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-418066">
<div class="comment-container" id="li-comment-418066">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Thabet Ali</span>
<span class="date">October 27, 2017 at 7:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418066" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re awesome Jason!</p>
<p>I just can’t wait to see more from you on this wonderful blog, where did you hide all of this 😉<br/>
Can you please write a book where you implement more of the functional API?<br/>
I’m sure the book will be a real success</p>
<p>Best regards<br/>
Thabet</p>
<div class="reply">
<a aria-label="Reply to Thabet Ali" class="comment-reply-link" href="#comment-418066" onclick='return addComment.moveForm( "comment-418066", "418066", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-418095">
<div class="comment-container" id="li-comment-418095">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d6e53cd310d401852858089d556ce04a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d6e53cd310d401852858089d556ce04a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tom</span>
<span class="date">October 27, 2017 at 12:18 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418095" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I agree with Thabet Ali, need a book on advance functional API part.</p>
<div class="reply">
<a aria-label="Reply to Tom" class="comment-reply-link" href="#comment-418095" onclick='return addComment.moveForm( "comment-418095", "418095", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-3" id="comment-418108">
<div class="comment-container" id="li-comment-418108">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 27, 2017 at 2:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418108" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What aspects of the functional API do you need more help with Tom?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-418108" onclick='return addComment.moveForm( "comment-418108", "418108", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418104">
<div class="comment-container" id="li-comment-418104">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 27, 2017 at 2:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418104" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks!</p>
<p>What problems are you having with the functional API?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-418104" onclick='return addComment.moveForm( "comment-418104", "418104", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-418126">
<div class="comment-container" id="li-comment-418126">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Thabet</span>
<span class="date">October 27, 2017 at 7:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418126" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would like to know more on how to implement autoencoders on multi input time series signals with a single output categorical classification, using the functional API</p>
<div class="reply">
<a aria-label="Reply to Thabet" class="comment-reply-link" href="#comment-418126" onclick='return addComment.moveForm( "comment-418126", "418126", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-418167">
<div class="comment-container" id="li-comment-418167">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 28, 2017 at 5:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418167" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<p>LSTMs, for example, can take multiple time series directly and don’t require parallel input models.</p>
<p>Why do you want to use autoencoders for time series?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-418167" onclick='return addComment.moveForm( "comment-418167", "418167", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-418189">
<div class="comment-container" id="li-comment-418189">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Thabet</span>
<span class="date">October 28, 2017 at 8:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418189" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes I think it’s because the output sequence is shorter than the input sequence<br/>
Like seen in this dataset:</p>
<p><a href="https://archive.ics.uci.edu/ml/datasets/human+activity+recognition+using+smartphones" rel="nofollow">https://archive.ics.uci.edu/ml/datasets/human+activity+recognition+using+smartphones</a></p>
<p>Where there are three time series inputs and 5 different classes as output</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="comment-435381">
<div class="comment-container" id="li-comment-435381">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1b3b04ffee3cfc4f6395f3127d36304b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1b3b04ffee3cfc4f6395f3127d36304b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Franco</span>
<span class="date">April 19, 2018 at 5:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-435381" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, are you asking for a wish list? 🙂<br/>
– Autoencoders / Anomaly detection with Keras’s API</p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Franco" class="comment-reply-link" href="#comment-435381" onclick='return addComment.moveForm( "comment-435381", "435381", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-435402">
<div class="comment-container" id="li-comment-435402">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 19, 2018 at 6:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-435402" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435402" onclick='return addComment.moveForm( "comment-435402", "435402", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-435380">
<div class="comment-container" id="li-comment-435380">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1b3b04ffee3cfc4f6395f3127d36304b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1b3b04ffee3cfc4f6395f3127d36304b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Franco</span>
<span class="date">April 19, 2018 at 5:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-435380" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, totally agree.</p>
<div class="reply">
<a aria-label="Reply to Franco" class="comment-reply-link" href="#comment-435380" onclick='return addComment.moveForm( "comment-435380", "435380", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-418125">
<div class="comment-container" id="li-comment-418125">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a8a404e3ddf6be55ef21c4f4a1b5f77c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a8a404e3ddf6be55ef21c4f4a1b5f77c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alexander</span>
<span class="date">October 27, 2017 at 6:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418125" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, thank you for very interest blog. Beautiful article which can open new doors.</p>
<div class="reply">
<a aria-label="Reply to Alexander" class="comment-reply-link" href="#comment-418125" onclick='return addComment.moveForm( "comment-418125", "418125", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418164">
<div class="comment-container" id="li-comment-418164">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 28, 2017 at 5:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418164" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Alexander.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-418164" onclick='return addComment.moveForm( "comment-418164", "418164", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-418223">
<div class="comment-container" id="li-comment-418223">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a7649fe4efabb5c624ecfba7c28e72dd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a7649fe4efabb5c624ecfba7c28e72dd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Leon</span>
<span class="date">October 28, 2017 at 5:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418223" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dr. Brownlee,<br/>
How do you study mathematics behind so many algorithms that you implement?<br/>
regards<br/>
Leon</p>
<div class="reply">
<a aria-label="Reply to Leon" class="comment-reply-link" href="#comment-418223" onclick='return addComment.moveForm( "comment-418223", "418223", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418287">
<div class="comment-container" id="li-comment-418287">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 29, 2017 at 5:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418287" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I read a lot 🙂</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-418287" onclick='return addComment.moveForm( "comment-418287", "418287", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-418955">
<div class="comment-container" id="li-comment-418955">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8e1b745128d324ae58800448c40f5df6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex</span>
<span class="date">November 4, 2017 at 5:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418955" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can I consider the initial_state of an LSTM layer as an input branch of the architecture? Say that for each data I have a sequence s1, s2, s3 and a context feature X. I define an LSTM with 128 neurons, for each batch I want to map X to a 128 dimensional feature through a Dense(128) layer and set the initial_state for that batch training, meanwhile the sequence s1, s2,s3 is fed to the LSTM as the input sequence.</p>
<div class="reply">
<a aria-label="Reply to Alex" class="comment-reply-link" href="#comment-418955" onclick='return addComment.moveForm( "comment-418955", "418955", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418958">
<div class="comment-container" id="li-comment-418958">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 4, 2017 at 5:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-418958" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry Alex, I’m not sure I follow. If you have some ideas, perhaps design an experiment to test them?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-418958" onclick='return addComment.moveForm( "comment-418958", "418958", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-419145">
<div class="comment-container" id="li-comment-419145">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3300cae8ccaeba68b768bafc5cd605ab?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3300cae8ccaeba68b768bafc5cd605ab?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://jithurjacob.in" rel="external nofollow">Jithu R Jacob</a></span>
<span class="date">November 6, 2017 at 8:38 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-419145" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for the awesome tutorial. </p>
<p>For anyone wants to directly visualize in Jupyter Notebooks use the following lines.</p>
<p>from IPython.display import SVG<br/>
from keras.utils.vis_utils import model_to_dot</p>
<p>SVG(model_to_dot(model).create(prog=’dot’, format=’svg’))</p>
<div class="reply">
<a aria-label="Reply to Jithu R Jacob" class="comment-reply-link" href="#comment-419145" onclick='return addComment.moveForm( "comment-419145", "419145", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-419196">
<div class="comment-container" id="li-comment-419196">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 7, 2017 at 9:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-419196" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Awesome, thanks for the tip!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-419196" onclick='return addComment.moveForm( "comment-419196", "419196", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-419166">
<div class="comment-container" id="li-comment-419166">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c442e5fec2ad69d4f2995af55cbdd45f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c442e5fec2ad69d4f2995af55cbdd45f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Luis</span>
<span class="date">November 7, 2017 at 2:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-419166" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for this blog. It is really helpful and well explained.</p>
<div class="reply">
<a aria-label="Reply to Luis" class="comment-reply-link" href="#comment-419166" onclick='return addComment.moveForm( "comment-419166", "419166", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-419203">
<div class="comment-container" id="li-comment-419203">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 7, 2017 at 9:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-419203" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Luis, I’m glad to hear that. I appreciate your support!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-419203" onclick='return addComment.moveForm( "comment-419203", "419203", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-419687">
<div class="comment-container" id="li-comment-419687">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/977ae5464383586a39323e6192561e8f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/977ae5464383586a39323e6192561e8f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Cal Almodovar</span>
<span class="date">November 11, 2017 at 8:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-419687" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason – I am wondering if the code should be:</p>
<p>visible = Input(image_file, shape=( height, width, color channels)) </p>
<p>if not, I wonder how the code references the image in question….</p>
<p>Surprised no one else asked this…</p>
<p>YOU ROCK JASON!</p>
<div class="reply">
<a aria-label="Reply to Cal Almodovar" class="comment-reply-link" href="#comment-419687" onclick='return addComment.moveForm( "comment-419687", "419687", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-421119">
<div class="comment-container" id="li-comment-421119">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/da0eb62236eeacad969362f77b31642e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/da0eb62236eeacad969362f77b31642e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">joe</span>
<span class="date">November 25, 2017 at 5:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-421119" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In section 1 you write that “the shape tuple is always defined with a hanging last dimension”, but when you define the convolutional network, you define it as such:</p>
<p>visible = Input(shape=(64,64,1))</p>
<p>without any hanging last dimension. Am I missing something here?</p>
<div class="reply">
<a aria-label="Reply to joe" class="comment-reply-link" href="#comment-421119" onclick='return addComment.moveForm( "comment-421119", "421119", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-421145">
<div class="comment-container" id="li-comment-421145">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 25, 2017 at 10:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-421145" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, I was incorrect. This is only the case for 1D input. I have updated the post, thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-421145" onclick='return addComment.moveForm( "comment-421145", "421145", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-421865">
<div class="comment-container" id="li-comment-421865">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8c9b091c3faea6e882a6da0c55a4a2f5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8c9b091c3faea6e882a6da0c55a4a2f5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Franek</span>
<span class="date">December 1, 2017 at 9:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-421865" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, I’ve been reading about keras and AI for some time and I always find your articles more clear and straightforward than all the other stuff on the net 🙂<br/>
Thanks!</p>
<div class="reply">
<a aria-label="Reply to Franek" class="comment-reply-link" href="#comment-421865" onclick='return addComment.moveForm( "comment-421865", "421865", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-421910">
<div class="comment-container" id="li-comment-421910">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 2, 2017 at 8:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-421910" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Franek.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-421910" onclick='return addComment.moveForm( "comment-421910", "421910", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-421867">
<div class="comment-container" id="li-comment-421867">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8c9b091c3faea6e882a6da0c55a4a2f5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8c9b091c3faea6e882a6da0c55a4a2f5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Franek</span>
<span class="date">December 1, 2017 at 9:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-421867" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, for some reasons I need to know the output tensors of the layers in my model. I’ve tried to experiment with the layer.get_output, get_output_et etc following the keras documentation, but I always fail to get anything sensible.</p>
<p>I tried to look for this subject on your blog, but I couldn’t find anything. Are you planning to write a post on this? 🙂 That would really help!</p>
<div class="reply">
<a aria-label="Reply to Franek" class="comment-reply-link" href="#comment-421867" onclick='return addComment.moveForm( "comment-421867", "421867", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-421911">
<div class="comment-container" id="li-comment-421911">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 2, 2017 at 8:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-421911" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have good advice for getting the output tensor. Perhaps post to the keras google group or slack channel?</p>
<p>See here:<br/>
<a href="https://machinelearningmastery.com/get-help-with-keras/" rel="nofollow">https://machinelearningmastery.com/get-help-with-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-421911" onclick='return addComment.moveForm( "comment-421911", "421911", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-421879">
<div class="comment-container" id="li-comment-421879">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ac4a6c04cc463e0a52c5e43382ecbdfd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ac4a6c04cc463e0a52c5e43382ecbdfd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nicola</span>
<span class="date">December 2, 2017 at 12:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-421879" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, yet another great post.<br/>
Using one of your past posts I created an LSTM that, using multiple time series, predicts several step ahead of a specific time series. Currently I have this structure:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e0cf76922668751" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
#reshape the time series
x_tr, y_tr = get_data(training, back, ahead)
	
n_samples = x_tr.shape[0]
features = x_tr.shape[2]

hidden = 50

#LSTM
model = Sequential()
model.add(LSTM(input_dim=features, output_dim=hidden,  return_sequences=True))
model.add(Dropout(0.2))
model.add(LSTM(50))
model.add(Dropout(0.2))
model.add(Dense(input_dim=hidden, output_dim=ahead))
model.add(Activation('linear'))
model.compile(loss='mae', optimizer='adam')
model.fit(x_tr, y_tr)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e0cf76922668751-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e0cf76922668751-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e0cf76922668751-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e0cf76922668751-4">4</div><div class="crayon-num" data-line="crayon-5c0ca43e0cf76922668751-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e0cf76922668751-6">6</div><div class="crayon-num" data-line="crayon-5c0ca43e0cf76922668751-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e0cf76922668751-8">8</div><div class="crayon-num" data-line="crayon-5c0ca43e0cf76922668751-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e0cf76922668751-10">10</div><div class="crayon-num" data-line="crayon-5c0ca43e0cf76922668751-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e0cf76922668751-12">12</div><div class="crayon-num" data-line="crayon-5c0ca43e0cf76922668751-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e0cf76922668751-14">14</div><div class="crayon-num" data-line="crayon-5c0ca43e0cf76922668751-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e0cf76922668751-16">16</div><div class="crayon-num" data-line="crayon-5c0ca43e0cf76922668751-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e0cf76922668751-18">18</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e0cf76922668751-1"><span class="crayon-p">#reshape the time series</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e0cf76922668751-2"><span class="crayon-v">x_tr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_tr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_data</span><span class="crayon-sy">(</span><span class="crayon-v">training</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ahead</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e0cf76922668751-3"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e0cf76922668751-4"><span class="crayon-v">n_samples</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_tr</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca43e0cf76922668751-5"><span class="crayon-v">features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x_tr</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e0cf76922668751-6"> </div><div class="crayon-line" id="crayon-5c0ca43e0cf76922668751-7"><span class="crayon-v">hidden</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">50</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e0cf76922668751-8"> </div><div class="crayon-line" id="crayon-5c0ca43e0cf76922668751-9"><span class="crayon-p">#LSTM</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e0cf76922668751-10"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e0cf76922668751-11"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-v">features</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">output_dim</span><span class="crayon-o">=</span><span class="crayon-v">hidden</span><span class="crayon-sy">,</span><span class="crayon-h">  </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e0cf76922668751-12"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e0cf76922668751-13"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e0cf76922668751-14"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e0cf76922668751-15"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-v">hidden</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">output_dim</span><span class="crayon-o">=</span><span class="crayon-v">ahead</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e0cf76922668751-16"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Activation</span><span class="crayon-sy">(</span><span class="crayon-s">'linear'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e0cf76922668751-17"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mae'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e0cf76922668751-18"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">x_tr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_tr</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0011 seconds] -->
<p></p>
<p>where:<br/>
– x_tr has (440, 7, 6) dimensions (440 samples, 7 past time steps, 6 variables/time series)<br/>
– y_tr has (440, 21) dimensions, that is 440 samples and 21 ahead predicted values.</p>
<p>Now, I’d like to extend my network so that it predicts the (multi-step ahead) values of two time series. I tried this code:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e0cf7a973839597" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
inputs = Input(shape=(7,6)) # 7 steps ahead and 6 variables
m = Dense(64,activation='relu')(inputs)
m = Dense(64,activation='relu')(m)
outputA = Dense(1,activation='tanh')(m)
outputB = Dense(1,activation='tanh')(m)

m = Model(inputs=[inputs], outputs=[outputA, outputB])
m.fit(x,[y1,y2])</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e0cf7a973839597-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e0cf7a973839597-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e0cf7a973839597-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e0cf7a973839597-4">4</div><div class="crayon-num" data-line="crayon-5c0ca43e0cf7a973839597-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e0cf7a973839597-6">6</div><div class="crayon-num" data-line="crayon-5c0ca43e0cf7a973839597-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e0cf7a973839597-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e0cf7a973839597-1"><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-p"># 7 steps ahead and 6 variables</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e0cf7a973839597-2"><span class="crayon-v">m</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e0cf7a973839597-3"><span class="crayon-v">m</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">m</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e0cf7a973839597-4"><span class="crayon-v">outputA</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'tanh'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">m</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e0cf7a973839597-5"><span class="crayon-v">outputB</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'tanh'</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">m</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e0cf7a973839597-6"> </div><div class="crayon-line" id="crayon-5c0ca43e0cf7a973839597-7"><span class="crayon-v">m</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Model</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">inputs</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">outputA</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">outputB</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e0cf7a973839597-8"><span class="crayon-v">m</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-sy">[</span><span class="crayon-v">y1</span><span class="crayon-sy">,</span><span class="crayon-v">y2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0008 seconds] -->
<p></p>
<p>where y1 and y2 both have (440, 21) dimensions, but I have this error:</p>
<p>“Error when checking target: expected dense_4 to have 3 dimensions, but got array with shape (440, 21)”.</p>
<p>How should I reshape y1 and y2 so that they fit with the network?</p>
<div class="reply">
<a aria-label="Reply to Nicola" class="comment-reply-link" href="#comment-421879" onclick='return addComment.moveForm( "comment-421879", "421879", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-421919">
<div class="comment-container" id="li-comment-421919">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 2, 2017 at 9:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-421919" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I cannot debug your code for you, perhaps post to stack overflow?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-421919" onclick='return addComment.moveForm( "comment-421919", "421919", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-424355">
<div class="comment-container" id="li-comment-424355">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1426482080549d9648a26ee5d3907fd1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1426482080549d9648a26ee5d3907fd1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Davor</span>
<span class="date">December 22, 2017 at 3:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-424355" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great tutorial, it really helped me understand Model API better! THANKS!</p>
<div class="reply">
<a aria-label="Reply to Davor" class="comment-reply-link" href="#comment-424355" onclick='return addComment.moveForm( "comment-424355", "424355", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-424379">
<div class="comment-container" id="li-comment-424379">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 22, 2017 at 5:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-424379" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad to hear that.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-424379" onclick='return addComment.moveForm( "comment-424379", "424379", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-425641">
<div class="comment-container" id="li-comment-425641">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/eb705225085798eef63d5bf88b60410b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/eb705225085798eef63d5bf88b60410b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Debarati Bhattacharjee</span>
<span class="date">January 5, 2018 at 2:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-425641" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hii Jason, this was a great post, specially for beginners to learn the Functional API. Would you mind to write a post to explain the code for a image segmentation problem step by step for beginners?</p>
<div class="reply">
<a aria-label="Reply to Debarati Bhattacharjee" class="comment-reply-link" href="#comment-425641" onclick='return addComment.moveForm( "comment-425641", "425641", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425668">
<div class="comment-container" id="li-comment-425668">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 5, 2018 at 5:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-425668" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425668" onclick='return addComment.moveForm( "comment-425668", "425668", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-425788">
<div class="comment-container" id="li-comment-425788">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/490c857f70772dacd0be50b97fc5bb29?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/490c857f70772dacd0be50b97fc5bb29?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Harminder</span>
<span class="date">January 6, 2018 at 10:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-425788" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thank you for such a great post. It helped me a lot to understand functional API’s in keras.<br/>
Could you please explain how we define the model.compile statement in multiple output case where each sub-model has a different objective function. For example, one output might be regression and the other classification as you mentioned in this post.</p>
<div class="reply">
<a aria-label="Reply to Harminder" class="comment-reply-link" href="#comment-425788" onclick='return addComment.moveForm( "comment-425788", "425788", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425807">
<div class="comment-container" id="li-comment-425807">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 7, 2018 at 5:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-425807" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I believe you must have one objective function for the whole model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425807" onclick='return addComment.moveForm( "comment-425807", "425807", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-427345">
<div class="comment-container" id="li-comment-427345">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/82ff31024175945960705b96f7187970?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/82ff31024175945960705b96f7187970?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Harry Garrison</span>
<span class="date">January 23, 2018 at 7:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-427345" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Splendid tutorial as always!</p>
<p>Do you think you could make a tutorial about siamese neural nets in the future? It would be particularly interesting to see how a triplet loss model can be created in keras, one that recognizes faces, for example. The functional API must be the way to go, but I can’t imagine exactly how the layers should be connected.</p>
<div class="reply">
<a aria-label="Reply to Harry Garrison" class="comment-reply-link" href="#comment-427345" onclick='return addComment.moveForm( "comment-427345", "427345", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-427430">
<div class="comment-container" id="li-comment-427430">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 24, 2018 at 9:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-427430" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion Harry.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-427430" onclick='return addComment.moveForm( "comment-427430", "427430", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-427735">
<div class="comment-container" id="li-comment-427735">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/52f9e0690534a8ca86030875038ae4d0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/52f9e0690534a8ca86030875038ae4d0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://gitlab.com/" rel="external nofollow">Akhtar Ali</a></span>
<span class="date">January 27, 2018 at 8:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-427735" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good tutorial<br/>
Thanks alot</p>
<div class="reply">
<a aria-label="Reply to Akhtar Ali" class="comment-reply-link" href="#comment-427735" onclick='return addComment.moveForm( "comment-427735", "427735", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-427771">
<div class="comment-container" id="li-comment-427771">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 28, 2018 at 8:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-427771" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-427771" onclick='return addComment.moveForm( "comment-427771", "427771", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-428143">
<div class="comment-container" id="li-comment-428143">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/13c0c7298b0d38345465cf8a24bb68f0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/13c0c7298b0d38345465cf8a24bb68f0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Paul the Student</span>
<span class="date">February 2, 2018 at 2:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-428143" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you very much for your tutorial! He helped me a lot!</p>
<p>I have a question about cost functions. I have one request and several documents: 1 relevant and 4 irrelevant. I would like a cost function that both maximizes SCORE(Q, D+) and minimizes SCORE(Q, D-). So, I could have Delta = SUM{ Score(Q,D+) – Score(Q,Di-) } for i in (1..4)<br/>
Using the Hinge Loss cost function, I have L = max(0, 4 – Delta)</p>
<p>I wanted to know if taking the 4 documents, calculating their score with the NN and sending everything in the cost function is a good practice?</p>
<div class="reply">
<a aria-label="Reply to Paul the Student" class="comment-reply-link" href="#comment-428143" onclick='return addComment.moveForm( "comment-428143", "428143", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-429514">
<div class="comment-container" id="li-comment-429514">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/63539c57814dd294314f43287136eb51?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/63539c57814dd294314f43287136eb51?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Joseph</span>
<span class="date">February 15, 2018 at 3:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-429514" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I was wondering if was possible to have two separate layers as inputs to the output layer, without concatenating them in a new layer and then having the concatenated layer project to the output layer. If you can’t do this with Keras, could you suggest another library that allows you to do this? I am new to neural networks, so would prefer a library that is suitable for newbies.</p>
<div class="reply">
<a aria-label="Reply to Joseph" class="comment-reply-link" href="#comment-429514" onclick='return addComment.moveForm( "comment-429514", "429514", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-429556">
<div class="comment-container" id="li-comment-429556">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 15, 2018 at 8:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-429556" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>There are a host of merge layers to choose from besides concat.</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-429556" onclick='return addComment.moveForm( "comment-429556", "429556", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-429620">
<div class="comment-container" id="li-comment-429620">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bb8c9bbf28d4f76b8aaec9b84df53056?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bb8c9bbf28d4f76b8aaec9b84df53056?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vinayakumar r</span>
<span class="date">February 16, 2018 at 12:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-429620" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have two images, first image and its label is good, second images and its label is bad. I want to pass both images at a time to deep learning model for training. While testing I will have two images (unlabelled) and I want to detect which one is good and which one is bad. Could you please tell how to do it?</p>
<div class="reply">
<a aria-label="Reply to vinayakumar r" class="comment-reply-link" href="#comment-429620" onclick='return addComment.moveForm( "comment-429620", "429620", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-429650">
<div class="comment-container" id="li-comment-429650">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 16, 2018 at 8:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-429650" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You will need a model with two inputs, one for each image.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-429650" onclick='return addComment.moveForm( "comment-429650", "429650", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-430429">
<div class="comment-container" id="li-comment-430429">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bb8c9bbf28d4f76b8aaec9b84df53056?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bb8c9bbf28d4f76b8aaec9b84df53056?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vinayakumar r</span>
<span class="date">February 24, 2018 at 5:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-430429" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Any examples you have to give two inputs to a model</p>
<div class="reply">
<a aria-label="Reply to vinayakumar r" class="comment-reply-link" href="#comment-430429" onclick='return addComment.moveForm( "comment-430429", "430429", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-430456">
<div class="comment-container" id="li-comment-430456">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 25, 2018 at 7:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-430456" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, see this caption example for inputting a photo and text:<br/>
<a href="https://machinelearningmastery.com/develop-a-deep-learning-caption-generation-model-in-python/" rel="nofollow">https://machinelearningmastery.com/develop-a-deep-learning-caption-generation-model-in-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430456" onclick='return addComment.moveForm( "comment-430456", "430456", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-430451">
<div class="comment-container" id="li-comment-430451">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6d6d53a191eb81b255d98d943f7a54ea?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6d6d53a191eb81b255d98d943f7a54ea?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">John</span>
<span class="date">February 25, 2018 at 7:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-430451" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks so much for the tutorial! It is much appreciated.</p>
<p>Where I am confused is for a model with multiple inputs and multiple outputs. To make it simple, lets say we have two input layers, some shared layers, and two output layers. I was able to build this in Keras and get a model printout that looks as expected, but when I go to fit the model Keras complains: ValueError: All input arrays (x) should have the same number of samples</p>
<p>Is it not possible to feed in inputs of different sizes?</p>
<div class="reply">
<a aria-label="Reply to John" class="comment-reply-link" href="#comment-430451" onclick='return addComment.moveForm( "comment-430451", "430451", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-430465">
<div class="comment-container" id="li-comment-430465">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 25, 2018 at 7:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-430465" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Correct. Inputs must be padded to the same length.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430465" onclick='return addComment.moveForm( "comment-430465", "430465", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-431561">
<div class="comment-container" id="li-comment-431561">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b2b7da4e8ef1c42fa2ffe03d98c553b6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b2b7da4e8ef1c42fa2ffe03d98c553b6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">saira</span>
<span class="date">March 8, 2018 at 6:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-431561" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>In the start of the post, you talked about hanging dimension to entertain the mini batch size. Could you kindly explain this a little.<br/>
My feature Matrix is a numpy N-d Array, in one -hot -encoded form: (6000,200) , and my batch size = 150.</p>
<p>Does this mean, I should give shape=(200,) ?</p>
<div class="reply">
<a aria-label="Reply to saira" class="comment-reply-link" href="#comment-431561" onclick='return addComment.moveForm( "comment-431561", "431561", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-431562">
<div class="comment-container" id="li-comment-431562">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b2b7da4e8ef1c42fa2ffe03d98c553b6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b2b7da4e8ef1c42fa2ffe03d98c553b6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">saira</span>
<span class="date">March 8, 2018 at 6:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-431562" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>* batch size = 50.</p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to saira" class="comment-reply-link" href="#comment-431562" onclick='return addComment.moveForm( "comment-431562", "431562", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-431582">
<div class="comment-container" id="li-comment-431582">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 8, 2018 at 2:53 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-431582" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, it means a numpy array where there is really only 1D of data with the second dimension not specified.</p>
<p>For example:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e0cc09101815455" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from numpy import array
a = array([1,2,3])
print(a.shape)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e0cc09101815455-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca43e0cc09101815455-2">2</div><div class="crayon-num" data-line="crayon-5c0ca43e0cc09101815455-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e0cc09101815455-1"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca43e0cc09101815455-2"><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca43e0cc09101815455-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p>Results in:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca43e0cc11543412297" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
(3,)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca43e0cc11543412297-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca43e0cc11543412297-1"><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<p>It’s 1D, but looks confusing to beginners.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-431582" onclick='return addComment.moveForm( "comment-431582", "431582", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-431594">
<div class="comment-container" id="li-comment-431594">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b2b7da4e8ef1c42fa2ffe03d98c553b6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b2b7da4e8ef1c42fa2ffe03d98c553b6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">saira</span>
<span class="date">March 8, 2018 at 5:09 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-431594" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This means I should use shape(200,).</p>
<p>Thanks a lot for the prompt reply !!!</p>
<div class="reply">
<a aria-label="Reply to saira" class="comment-reply-link" href="#comment-431594" onclick='return addComment.moveForm( "comment-431594", "431594", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-431616">
<div class="comment-container" id="li-comment-431616">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0b24a5263ea8dd65ca8aaf5710ba94b8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0b24a5263ea8dd65ca8aaf5710ba94b8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">H Hua</span>
<span class="date">March 9, 2018 at 1:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-431616" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>how to do a case with multi-input and multi-output cases</p>
<div class="reply">
<a aria-label="Reply to H Hua" class="comment-reply-link" href="#comment-431616" onclick='return addComment.moveForm( "comment-431616", "431616", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-431639">
<div class="comment-container" id="li-comment-431639">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 9, 2018 at 6:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-431639" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Simply combine some of the examples from this post.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-431639" onclick='return addComment.moveForm( "comment-431639", "431639", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-431627">
<div class="comment-container" id="li-comment-431627">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0963a3fc7cd2d7c2b4d6c8a705180db2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0963a3fc7cd2d7c2b4d6c8a705180db2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kieu My</span>
<span class="date">March 9, 2018 at 5:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-431627" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thank you very much for your blog, it’s easy to understand via some examples, I recognize that learning from some example is one of the fast way to learn new things.<br/>
In your post, I have a little confuse that in case multi input. If you have 1 image but you want get RGB 32x32x3 version and 64x64x1 gray-scale version for each Conv branch. How can the network know that. Because when we define the network we only said the input_shape, we don’t say which kind of image we want to led into the Conv in branch 1 or branch 2? In fit method we also have to said input and output, not give the detail. And if I want in the gray-scale version is: 32x32x3 (3 because I want to channel-wise, triple gray-scale version). And how can the network recognize the first branch is for gray-scale. Sorry for my question if is there any easy thing I don’t know. Thanks again for your post. I always follow your post.</p>
<div class="reply">
<a aria-label="Reply to Kieu My" class="comment-reply-link" href="#comment-431627" onclick='return addComment.moveForm( "comment-431627", "431627", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-431644">
<div class="comment-container" id="li-comment-431644">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 9, 2018 at 6:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-431644" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You could run all images through one input and pad the smaller image to the dimensions of the larger image. Or you can use a multiple input model and define two separate input shapes.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-431644" onclick='return addComment.moveForm( "comment-431644", "431644", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-431685">
<div class="comment-container" id="li-comment-431685">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b2b7da4e8ef1c42fa2ffe03d98c553b6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b2b7da4e8ef1c42fa2ffe03d98c553b6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">saira</span>
<span class="date">March 9, 2018 at 5:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-431685" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>When I run this functional API in model for k fold cross validation, the numbers in the naming the dense layer is increasing in the return fitted model of each fold.<br/>
Like in first fold it’s “dense_2_acc”, then in 2nd fold its “dense_5_acc”.</p>
<p>By my model summary shows my model is correct. Could you kindly tell why is it changing the names in the fitted model “history” object of each fold?</p>
<p>regards,</p>
<div class="reply">
<a aria-label="Reply to saira" class="comment-reply-link" href="#comment-431685" onclick='return addComment.moveForm( "comment-431685", "431685", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-431732">
<div class="comment-container" id="li-comment-431732">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 10, 2018 at 6:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-431732" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, i have not seen this behavior. Perhaps it’s a fault? You could try posting to the keras list:<br/>
<a href="https://machinelearningmastery.com/get-help-with-keras/" rel="nofollow">https://machinelearningmastery.com/get-help-with-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-431732" onclick='return addComment.moveForm( "comment-431732", "431732", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-432347">
<div class="comment-container" id="li-comment-432347">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e347f21e07d6526ca5309fcd0c4e2626?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e347f21e07d6526ca5309fcd0c4e2626?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jane</span>
<span class="date">March 16, 2018 at 4:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-432347" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This was a fantastic and concise beginner tutorial for building neural networks with Keras. Great job !</p>
<div class="reply">
<a aria-label="Reply to Jane" class="comment-reply-link" href="#comment-432347" onclick='return addComment.moveForm( "comment-432347", "432347", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-432400">
<div class="comment-container" id="li-comment-432400">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 17, 2018 at 8:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-432400" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, I’m glad to hear that.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-432400" onclick='return addComment.moveForm( "comment-432400", "432400", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-432614">
<div class="comment-container" id="li-comment-432614">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/64afc3115b126a3bb9a304498891ff80?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/64afc3115b126a3bb9a304498891ff80?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://www.linkedin.com/in/harisankarh/" rel="external nofollow">HARISANKAR HARIDAS</a></span>
<span class="date">March 19, 2018 at 10:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-432614" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the tutorial. </p>
<p>“When input data is one-dimensional, such as for a multilayer Perceptron, the shape must explicitly leave room for the shape of the mini-batch size used when splitting the data when training the network. </p>
<p>Therefore, the shape tuple is always defined with a hanging last dimension when the input is one-dimensional (2,)</p>
<p>…<br/>
visible = Input(shape=(2,))</p>
<p>”</p>
<p>I was a bit confused at first after reading these 2 sentences. </p>
<p>regarding trailing comma: A trailing comma is always required when we have a tuple with a single element. Otherwise (2)  returns only the value 2, not a tuple with the value 2. <a href="https://docs.python.org/3/reference/expressions.html#expression-lists" rel="nofollow">https://docs.python.org/3/reference/expressions.html#expression-lists</a></p>
<p>As the shape parameter for Input should be a tuple ( <a href="https://keras.io/layers/core/#input" rel="nofollow">https://keras.io/layers/core/#input</a> ), we do not have any option other than to add a comma when we have a single element to be passed.</p>
<p>So, I’m not able to get the meaning implied in “the shape must explicitly leave room for the shape of the mini-batch size … Therefore, the shape tuple is always defined with a hanging last dimension”</p>
<div class="reply">
<a aria-label="Reply to HARISANKAR HARIDAS" class="comment-reply-link" href="#comment-432614" onclick='return addComment.moveForm( "comment-432614", "432614", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-433303">
<div class="comment-container" id="li-comment-433303">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d2d8454ce3a963a81430cc0e54ce8e9f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d2d8454ce3a963a81430cc0e54ce8e9f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jeremy</span>
<span class="date">March 27, 2018 at 2:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-433303" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks so much for such a great post. </p>
<p>So, in your case in shared input layers section, you have the same CNN models for feature extraction, and the output can be concated since both features produced binary classification result.</p>
<p>But what if we have separate categorical classification model (for sequence classification) and regression model (for time series) which relies on the same input data. So is it possible to concate categorical classification model (which produces more than two classes) with a regression model, and the final result after model concatenation is binary classification?</p>
<p>Your opinion, in this case, is much appreciated.</p>
<p>Thank you.</p>
<div class="reply">
<a aria-label="Reply to Jeremy" class="comment-reply-link" href="#comment-433303" onclick='return addComment.moveForm( "comment-433303", "433303", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-433324">
<div class="comment-container" id="li-comment-433324">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 27, 2018 at 6:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-433324" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not sure I follow. Perhaps try it and as many variations as you can think of, and see.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-433324" onclick='return addComment.moveForm( "comment-433324", "433324", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-436448">
<div class="comment-container" id="li-comment-436448">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6647c9ad16c2b864077718426aa01d1d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6647c9ad16c2b864077718426aa01d1d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Dhruv</span>
<span class="date">May 2, 2018 at 1:59 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-436448" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thanks for the neat post.</p>
<div class="reply">
<a aria-label="Reply to Dhruv" class="comment-reply-link" href="#comment-436448" onclick='return addComment.moveForm( "comment-436448", "436448", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-436504">
<div class="comment-container" id="li-comment-436504">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 3, 2018 at 6:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-436504" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome, I’m glad it helped.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436504" onclick='return addComment.moveForm( "comment-436504", "436504", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-436680">
<div class="comment-container" id="li-comment-436680">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f4d0c1a10e6a8febc0b2d706d1525cd8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f4d0c1a10e6a8febc0b2d706d1525cd8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Wayne Satz</span>
<span class="date">May 5, 2018 at 8:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-436680" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason, great and helpful post<br/>
Can you go over combining wide and deep models using th functional api?</p>
<div class="reply">
<a aria-label="Reply to Wayne Satz" class="comment-reply-link" href="#comment-436680" onclick='return addComment.moveForm( "comment-436680", "436680", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-436723">
<div class="comment-container" id="li-comment-436723">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 6, 2018 at 6:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-436723" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion.</p>
<p>Do you have a specific question or concern with the approach?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436723" onclick='return addComment.moveForm( "comment-436723", "436723", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-437598">
<div class="comment-container" id="li-comment-437598">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3c3e90e689839d9b8ac8ae1e7ba6a5a4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3c3e90e689839d9b8ac8ae1e7ba6a5a4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ankush Chandna</span>
<span class="date">May 15, 2018 at 11:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-437598" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason, </p>
<p>Your articles are the best and the consistency across articles is something to be admired. </p>
<p>Can you also explain residual nets using functional api.</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Ankush Chandna" class="comment-reply-link" href="#comment-437598" onclick='return addComment.moveForm( "comment-437598", "437598", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-437631">
<div class="comment-container" id="li-comment-437631">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 16, 2018 at 6:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-437631" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, and thanks for the suggestion.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437631" onclick='return addComment.moveForm( "comment-437631", "437631", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-438627">
<div class="comment-container" id="li-comment-438627">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d1e13f02a53b6720a60cf02222d05978?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d1e13f02a53b6720a60cf02222d05978?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">mina</span>
<span class="date">May 25, 2018 at 7:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-438627" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you so much for your great post.<br/>
though I have one question, I use the Multiple Input and Output Models with same network for my inputs. I wanna share the weights between them, can you please point out how should I address that?</p>
<div class="reply">
<a aria-label="Reply to mina" class="comment-reply-link" href="#comment-438627" onclick='return addComment.moveForm( "comment-438627", "438627", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-438678">
<div class="comment-container" id="li-comment-438678">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 26, 2018 at 5:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-438678" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Copy them between layers or use a wrapper that lets you reuse a layer, e.g. like timedistributed.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-438678" onclick='return addComment.moveForm( "comment-438678", "438678", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-440398">
<div class="comment-container" id="li-comment-440398">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8eddc729e38e4210e6c1ddfb9ec2a54d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8eddc729e38e4210e6c1ddfb9ec2a54d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ahmed Sahlol</span>
<span class="date">June 11, 2018 at 1:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-440398" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>All ur posts r awesome. God bless u 🙂</p>
<div class="reply">
<a aria-label="Reply to Ahmed Sahlol" class="comment-reply-link" href="#comment-440398" onclick='return addComment.moveForm( "comment-440398", "440398", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-440426">
<div class="comment-container" id="li-comment-440426">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 11, 2018 at 6:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-440426" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hanks, I’m glad they help.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-440426" onclick='return addComment.moveForm( "comment-440426", "440426", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-440440">
<div class="comment-container" id="li-comment-440440">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8eddc729e38e4210e6c1ddfb9ec2a54d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8eddc729e38e4210e6c1ddfb9ec2a54d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ahmed Sahlol</span>
<span class="date">June 11, 2018 at 9:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-440440" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Really, amazing tutorial.<br/>
Why don’t u complete it with the testing step “predict”?<br/>
Thanks again 🙂</p>
<div class="reply">
<a aria-label="Reply to Ahmed Sahlol" class="comment-reply-link" href="#comment-440440" onclick='return addComment.moveForm( "comment-440440", "440440", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-440452">
<div class="comment-container" id="li-comment-440452">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 11, 2018 at 1:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-440452" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion.</p>
<p>I explain how to make predictions here:<br/>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" rel="nofollow">https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-440452" onclick='return addComment.moveForm( "comment-440452", "440452", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-440496">
<div class="comment-container" id="li-comment-440496">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8eddc729e38e4210e6c1ddfb9ec2a54d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8eddc729e38e4210e6c1ddfb9ec2a54d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ahmed Sahlol</span>
<span class="date">June 12, 2018 at 1:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-440496" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The “Shared Input Layer” is very interesting. I wonder if the 2 convolutional structures can be replaced by 2 pre-trained models (let’s say VGG16 and Inception). What do u think?</p>
<div class="reply">
<a aria-label="Reply to Ahmed Sahlol" class="comment-reply-link" href="#comment-440496" onclick='return addComment.moveForm( "comment-440496", "440496", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-440529">
<div class="comment-container" id="li-comment-440529">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 12, 2018 at 6:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-440529" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure, try it.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-440529" onclick='return addComment.moveForm( "comment-440529", "440529", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-440586">
<div class="comment-container" id="li-comment-440586">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4ce3a6623bf55817603162ab08da2948?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4ce3a6623bf55817603162ab08da2948?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shardul Singh</span>
<span class="date">June 12, 2018 at 7:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-440586" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This question is with reference to your older post on “Multilayer Perceptron Using the Window Method” : <a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/" rel="nofollow">https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/</a></p>
<p>In your code there, you have successfully created a model using a multidimensional array input, without having to flatten it.<br/>
Is it possible to do this with the keras functional API as well? Every solution i find seems like it requires flattening of data, however i’m trying to do a time series analysis and flattening would lead to loss of information.</p>
<div class="reply">
<a aria-label="Reply to Shardul Singh" class="comment-reply-link" href="#comment-440586" onclick='return addComment.moveForm( "comment-440586", "440586", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-440635">
<div class="comment-container" id="li-comment-440635">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 13, 2018 at 6:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-440635" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The shape of the input is unrelated to use the use of the functional API.</p>
<p>You can use either API regardless of the shape of the data.</p>
<p>Time series data must be transformed into a supervised learning problem:<br/>
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-440635" onclick='return addComment.moveForm( "comment-440635", "440635", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-440811">
<div class="comment-container" id="li-comment-440811">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ebaa2f9cf9c5eb10ca56ebfe4cbd5ebd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ebaa2f9cf9c5eb10ca56ebfe4cbd5ebd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Joshna</span>
<span class="date">June 14, 2018 at 3:09 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-440811" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey,<br/>
Thanks for the blog. I want to know how can I extract features form intermediate layer in Alexnet model . I am using functional api .</p>
<div class="reply">
<a aria-label="Reply to Joshna" class="comment-reply-link" href="#comment-440811" onclick='return addComment.moveForm( "comment-440811", "440811", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-440819">
<div class="comment-container" id="li-comment-440819">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 14, 2018 at 4:09 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-440819" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can create a new model that ends at the layer of interest, then use a forward propagation (e.g. call predict()) to get the features.</p>
<p>I give an example for VGG in the image captioning tutorial:<br/>
<a href="https://machinelearningmastery.com/develop-a-deep-learning-caption-generation-model-in-python/" rel="nofollow">https://machinelearningmastery.com/develop-a-deep-learning-caption-generation-model-in-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-440819" onclick='return addComment.moveForm( "comment-440819", "440819", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-440911">
<div class="comment-container" id="li-comment-440911">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d9f9b658fbc2029d13aed5057afbf45a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d9f9b658fbc2029d13aed5057afbf45a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.pacmed.ai/en/" rel="external nofollow">joost zeeuw</a></span>
<span class="date">June 15, 2018 at 6:13 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-440911" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason!</p>
<p>Great blog once again, thank you. I have a question regarding the current research on multi-input models.</p>
<p>I’m building a model that combines text-sequences and patient-characteristics. For this I’m using an LSTM ‘branch’ that i concat with a normal ‘branch’ in a neural network. I was wondering whether you came across some nice papers/articles that go a little deeper into such architectures, possibly giving me some insights in how to optimize this model and understand it thoroughly.</p>
<p>With kind regards,<br/>
Joost Zeeuw</p>
<div class="reply">
<a aria-label="Reply to joost zeeuw" class="comment-reply-link" href="#comment-440911" onclick='return addComment.moveForm( "comment-440911", "440911", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-440964">
<div class="comment-container" id="li-comment-440964">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 16, 2018 at 7:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-440964" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not off hand. I recommend experimenting a lot with the architecture and see what works best for your dataset.</p>
<p>I’d love to hear how to you go.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-440964" onclick='return addComment.moveForm( "comment-440964", "440964", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-442544">
<div class="comment-container" id="li-comment-442544">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e4fdef6e8c306f4ef09e046f6f5af5f4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e4fdef6e8c306f4ef09e046f6f5af5f4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Isaac</span>
<span class="date">July 3, 2018 at 6:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-442544" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason! Really great blog!</p>
<p>My question is: how to feed this kind of models with a generator? Well two generators actually, one for test, and one for train. I’m trying to do phoneme classification BTW</p>
<p>I have tried something like:<br/>
<code><br/>
#model<br/>
input_data = Input(name='the_input', shape=(None, self.n_feats))</code></p>
<p>x = Bidirectional(LSTM(20, return_sequences=False, dropout=0.3), merge_mode='sum')(input_data)<br/>
y_pred = Dense(39, activation="softmax"), name="out")(x)</p>
<p>labels = Input(name='the_labels', shape=[39], dtype='int32') # not sure of this but how to compare labels otherwise??<br/>
self.model = Model(inputs=[input_data, labels], outputs=y_pred)<br/>
...<br/>
# I'm gonna omit the optimization and compile steps for simplicty</p>
<p>my generator yields something like this:</p>
<p>return ({'the_input':data_x, 'the_labels':labels},{'out':np.zeros([batch_size, np.max(seq_lens), num_classes])})</p>
<p><br/>
Also, just to be sure for sequence classification (many-to-one) I should use return_sequences=False in recurrent layers and Dense instead of TimeDistributed rigth?</p>
<p>Thanks!<br/>
Isaac</p>
<div class="reply">
<a aria-label="Reply to Isaac" class="comment-reply-link" href="#comment-442544" onclick='return addComment.moveForm( "comment-442544", "442544", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-442553">
<div class="comment-container" id="li-comment-442553">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 3, 2018 at 6:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-442553" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have an example of using a generator here (under progressive loading):<br/>
<a href="https://machinelearningmastery.com/develop-a-deep-learning-caption-generation-model-in-python/" rel="nofollow">https://machinelearningmastery.com/develop-a-deep-learning-caption-generation-model-in-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442553" onclick='return addComment.moveForm( "comment-442553", "442553", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-443165">
<div class="comment-container" id="li-comment-443165">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7088c56439a944a30f0a6c4707d344ba?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7088c56439a944a30f0a6c4707d344ba?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://www.linkedin.com/in/priya-arora-0814b017/" rel="external nofollow">priya</a></span>
<span class="date">July 11, 2018 at 3:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-443165" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for the blog. It is very interesting. After reading your blog, I got one doubt if you can help me out in solving that – what if one wants to extract feature from an intermediate layer from a fine-tuned Siamese network which is pre-trained with a feed-forward multi-layer perceptron. </p>
<p>Is there any lead that you can provide. It would be very helpful to me.</p>
<div class="reply">
<a aria-label="Reply to priya" class="comment-reply-link" href="#comment-443165" onclick='return addComment.moveForm( "comment-443165", "443165", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-443184">
<div class="comment-container" id="li-comment-443184">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 11, 2018 at 6:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-443184" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can get the weights for a network via layer.get_weights()</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443184" onclick='return addComment.moveForm( "comment-443184", "443184", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-443609">
<div class="comment-container" id="li-comment-443609">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d34f88ace6fa5777154aa3e43c0456c7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d34f88ace6fa5777154aa3e43c0456c7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hee</span>
<span class="date">July 16, 2018 at 5:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-443609" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Thanks for your article.<br/>
I have one question.<br/>
What is the more efficient way to combine discrete and continuous features layers?</p>
<div class="reply">
<a aria-label="Reply to Hee" class="comment-reply-link" href="#comment-443609" onclick='return addComment.moveForm( "comment-443609", "443609", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-443654">
<div class="comment-container" id="li-comment-443654">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 17, 2018 at 6:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-443654" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Often an integer encoding, one hot encoding or an embedding layer are effective for categorical variables.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443654" onclick='return addComment.moveForm( "comment-443654", "443654", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-443677">
<div class="comment-container" id="li-comment-443677">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ed6ec33e8d6dbaf8cfa0d8c155f26ab1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ed6ec33e8d6dbaf8cfa0d8c155f26ab1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vivek</span>
<span class="date">July 17, 2018 at 7:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-443677" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason your blog is very good. I want to add custom layer in keras. Can you please explain how can I do?</p>
<div class="reply">
<a aria-label="Reply to Vivek" class="comment-reply-link" href="#comment-443677" onclick='return addComment.moveForm( "comment-443677", "443677", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-443687">
<div class="comment-container" id="li-comment-443687">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 17, 2018 at 2:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-443687" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<p>I hope to cover that topic in the future.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443687" onclick='return addComment.moveForm( "comment-443687", "443687", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-443970">
<div class="comment-container" id="li-comment-443970">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2d7e5ae11907fd39a3d4129d17e5a778?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2d7e5ae11907fd39a3d4129d17e5a778?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Matt</span>
<span class="date">July 20, 2018 at 3:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-443970" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for the excellent post. I attempted to implement a 1 hidden layer with 2 neurons followed by an output layer, both dense with sigmoid activation to train on XOR input – classical problem, that of course has a solution. However, without specifying a particular initialisation, I was unable to train this minimal neuron network toward a solution (with high enough number of neurons, I think it is working independent of initialisation). Could you include such a simple example as a test case of Keras machinery and perhaps comment on the pitfalls where presumably the loss function has multiple critical points?</p>
<p>Cheers,<br/>
Matt</p>
<div class="reply">
<a aria-label="Reply to Matt" class="comment-reply-link" href="#comment-443970" onclick='return addComment.moveForm( "comment-443970", "443970", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-444016">
<div class="comment-container" id="li-comment-444016">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 21, 2018 at 6:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-444016" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion.</p>
<p>XOR is really only an academic exercise anyway, perhaps focus on some real datasets?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444016" onclick='return addComment.moveForm( "comment-444016", "444016", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-444109">
<div class="comment-container" id="li-comment-444109">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c91a514de6164a7ee468c1a927c92dcf?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c91a514de6164a7ee468c1a927c92dcf?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sola</span>
<span class="date">July 22, 2018 at 10:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-444109" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for your excellent tutorials. I am trying to use Keras Functional API for my problem. I have two different sets of input which I am trying to use a two input – one output model.<br/>
My model looks like your “Multiple Input Model” example and as you mentioned I am doing the same thing as :<br/>
model = Model(inputs=[visible1, visible2], outputs=output)<br/>
and I am fitting the model with this code:<br/>
model.fit([XTrain1, XTrain2], [YTrain1, YTrain2], validation_split=0.33, epochs=100, batch_size=150, verbose=2), but I’m receiving error regarding the size mismatching.<br/>
The output TensorShape has a dimension of 3 and YTrain1 and YTrain2 has also the shape of (–, 3). Do you have any suggestion on how to resolve this error? I would be really thankful.</p>
<div class="reply">
<a aria-label="Reply to Sola" class="comment-reply-link" href="#comment-444109" onclick='return addComment.moveForm( "comment-444109", "444109", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-444163">
<div class="comment-container" id="li-comment-444163">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 23, 2018 at 6:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-444163" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If the model has one output, you only need to specify one yTrain.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444163" onclick='return addComment.moveForm( "comment-444163", "444163", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-445709">
<div class="comment-container" id="li-comment-445709">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c91a514de6164a7ee468c1a927c92dcf?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c91a514de6164a7ee468c1a927c92dcf?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sola</span>
<span class="date">August 10, 2018 at 5:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-445709" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi </p>
<p>Thank you for your reply.<br/>
I have another question which I will be grateful if you could help me with that.<br/>
In your Multilayer Perceptron example, which the input data is 1-D, if I add a reshape module at the end of the Dense4 to reshape the output into a 2D object, then is it possible to see this 2D feature space as an image?<br/>
Is there any syntax to plot this 2D tensor object?<br/>
Thanks</p>
<div class="reply">
<a aria-label="Reply to Sola" class="comment-reply-link" href="#comment-445709" onclick='return addComment.moveForm( "comment-445709", "445709", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-445729">
<div class="comment-container" id="li-comment-445729">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 10, 2018 at 6:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-445729" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If you fit an MLP on an image, the image pixels must be flattened to 1D before being provided as input.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-445729" onclick='return addComment.moveForm( "comment-445729", "445729", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-444376">
<div class="comment-container" id="li-comment-444376">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b48e5f20785431fc23149e123a29c46d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b48e5f20785431fc23149e123a29c46d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">tuan anh</span>
<span class="date">July 25, 2018 at 5:45 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-444376" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, Jason<br/>
Can you give me an example of how to combine Conv1D =&gt; BiLSTM =&gt; Dense<br/>
I try to do but can’t figure out how to combine them</p>
<div class="reply">
<a aria-label="Reply to tuan anh" class="comment-reply-link" href="#comment-444376" onclick='return addComment.moveForm( "comment-444376", "444376", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-444405">
<div class="comment-container" id="li-comment-444405">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 26, 2018 at 7:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-444405" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This will help as a start:<br/>
<a href="https://machinelearningmastery.com/cnn-long-short-term-memory-networks/" rel="nofollow">https://machinelearningmastery.com/cnn-long-short-term-memory-networks/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444405" onclick='return addComment.moveForm( "comment-444405", "444405", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-444427">
<div class="comment-container" id="li-comment-444427">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/69c703d41df5ef99fb938b4155be5110?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/69c703d41df5ef99fb938b4155be5110?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">tuan anh</span>
<span class="date">July 26, 2018 at 12:24 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-444427" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you so much for quick reply Jason, I read this article, very useful!</p>
<p>But when I apply, I face that it has a very strange thing, I don’t know why:</p>
<p>Let see my program, it runs normally, but the val_acc, I don’t know why it always .] – ETA: 0s – loss: 0.2195 – acc: 0.8978<br/>
Epoch 00046: loss improved from 0.22164 to 0.21951, </p>
<p>40420/40420 [==============================] – 386s – loss: 0.2195 – acc: 0.8978 – val_loss: 5.2004 – val_acc: 0.2399<br/>
Epoch 48/100<br/>
40416/40420 [============================&gt;.] – ETA: 0s – loss: 0.2161 – acc: 0.9010<br/>
Epoch 00047: loss improved from 0.21951 to 0.21610, </p>
<p>40420/40420 [==============================] – 390s – loss: 0.2161 – acc: 0.9010 – val_loss: 5.0661 – val_acc: 0.2369<br/>
Epoch 49/100<br/>
40416/40420 [============================&gt;.] – ETA: 0s – loss: 0.2274 – acc: 0.8965<br/>
Epoch 00048: loss did not improve<br/>
40420/40420 [==============================] – 393s – loss: 0.2276 – acc: 0.8964 – val_loss: 5.1333 – val_acc: 0.2412<br/>
Epoch 50/100<br/>
40416/40420 [============================&gt;.] – ETA: 0s – loss: 0.2145 – acc: 0.9028<br/>
Epoch 00049: loss improved from 0.21610 to 0.21455, </p>
<p>40420/40420 [==============================] – 395s – loss: 0.2146 – acc: 0.9027 – val_loss: 5.3898 – val_acc: 0.2344<br/>
Epoch 51/100<br/>
40416/40420 [============================&gt;.] – ETA: 0s – loss: 0.2100 – acc: 0.9051<br/>
Epoch 00050: loss improved from 0.21455 to 0.20999,</p>
<div class="reply">
<a aria-label="Reply to tuan anh" class="comment-reply-link" href="#comment-444427" onclick='return addComment.moveForm( "comment-444427", "444427", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-444437">
<div class="comment-container" id="li-comment-444437">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 26, 2018 at 2:25 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-444437" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You may need to tune the network to your problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444437" onclick='return addComment.moveForm( "comment-444437", "444437", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-444443">
<div class="comment-container" id="li-comment-444443">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/69c703d41df5ef99fb938b4155be5110?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/69c703d41df5ef99fb938b4155be5110?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">tuan anh</span>
<span class="date">July 26, 2018 at 3:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-444443" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I tried many times, but even it overfits all database, val_acc still low.<br/>
I know it overfits all because I use predict program to predict all database, acc high as training acc.<br/>
Thank you</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-444486">
<div class="comment-container" id="li-comment-444486">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 27, 2018 at 5:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-444486" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps try adding some regularization like dropout?</p>
<p>Perhaps getting more data?</p>
<p>Perhaps try reducing the number of training epochs?</p>
<p>Perhaps try reducing the size of the model?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-444778">
<div class="comment-container" id="li-comment-444778">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/69c703d41df5ef99fb938b4155be5110?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/69c703d41df5ef99fb938b4155be5110?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">tuan anh</span>
<span class="date">July 30, 2018 at 12:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-444778" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thank you, Jason,<br/>
– I am trying to test by adding some dropout layers,<br/>
– the number of epochs when training doesn’t need to reduce because I observe it frequently myself,<br/>
– about the size of the model, I am training 4 programs in parallel to check it.<br/>
– the last one, getting more data, I will do if all of above have better results</p>
<div class="reply">
<a aria-label="Reply to tuan anh" class="comment-reply-link" href="#comment-444778" onclick='return addComment.moveForm( "comment-444778", "444778", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-444789">
<div class="comment-container" id="li-comment-444789">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 30, 2018 at 2:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-444789" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sounds great.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444789" onclick='return addComment.moveForm( "comment-444789", "444789", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-447514">
<div class="comment-container" id="li-comment-447514">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a8ee2861776c4c8888b1278ec7dd8e37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a8ee2861776c4c8888b1278ec7dd8e37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sahand</span>
<span class="date">September 1, 2018 at 10:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-447514" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi Jason tnx for this awesome post<br/>
really helpful</p>
<p>when i run this code:</p>
<p>    l_input = Input(shape=(336, 25))<br/>
    adense = GRU(256)(l_input)<br/>
    bdense = Dense(64, activation=’relu’)(adense)<br/>
    .<br/>
    .<br/>
    .</p>
<p>i’ll get this error:</p>
<p>ValueError: Invalid reduction dimension 2 for input with 2 dimensions. for ‘model_1/gru_1/Sum’ (op: ‘Sum’) with input shapes: [?,336], [2] and with computed input tensors: input[1] = .</p>
<p>i’m really exhausted and i didn’t find the answer anywhere.<br/>
what should i do?<br/>
i appreciate your help</p>
<div class="reply">
<a aria-label="Reply to sahand" class="comment-reply-link" href="#comment-447514" onclick='return addComment.moveForm( "comment-447514", "447514", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-447544">
<div class="comment-container" id="li-comment-447544">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 2, 2018 at 5:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-447544" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sounds like the data and expectations of the model do not match. Perhaps change the data or the model?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-447544" onclick='return addComment.moveForm( "comment-447544", "447544", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-448844">
<div class="comment-container" id="li-comment-448844">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fd2fde41c230cf8decdb1560c4d6175c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fd2fde41c230cf8decdb1560c4d6175c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bradley Elfman</span>
<span class="date">September 15, 2018 at 5:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-448844" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is a particularly helpful tutorial, but I cannot begin to use without data source.</p>
<div class="reply">
<a aria-label="Reply to Bradley Elfman" class="comment-reply-link" href="#comment-448844" onclick='return addComment.moveForm( "comment-448844", "448844", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-448875">
<div class="comment-container" id="li-comment-448875">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 15, 2018 at 6:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-448875" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-448875" onclick='return addComment.moveForm( "comment-448875", "448875", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-448846">
<div class="comment-container" id="li-comment-448846">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fd2fde41c230cf8decdb1560c4d6175c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fd2fde41c230cf8decdb1560c4d6175c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bradley Elfman</span>
<span class="date">September 15, 2018 at 6:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-448846" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I left a previous reply about needing data sources, I see other readers not having this problem, but seems I am still at the stage where I don’t see what data to input or how to preprocess for these examples. I am also confused, as looks like a png is common source.</p>
<p>I am particularly interested in example that takes text and question and returns an answer – where would I find such input and how to fit into your code?</p>
<div class="reply">
<a aria-label="Reply to Bradley Elfman" class="comment-reply-link" href="#comment-448846" onclick='return addComment.moveForm( "comment-448846", "448846", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-448947">
<div class="comment-container" id="li-comment-448947">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fd2fde41c230cf8decdb1560c4d6175c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fd2fde41c230cf8decdb1560c4d6175c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bradley Elfman</span>
<span class="date">September 15, 2018 at 10:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-448947" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason,  What dataset from your github datasets would be good for this LSTM tutorial? Or is there an online dataset you could recommend. I am interested in both LSTM for text processing (not IMDB) and Keras functional API</p>
<div class="reply">
<a aria-label="Reply to Bradley Elfman" class="comment-reply-link" href="#comment-448947" onclick='return addComment.moveForm( "comment-448947", "448947", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-448999">
<div class="comment-container" id="li-comment-448999">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 16, 2018 at 6:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-448999" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not sure I follow what you are trying to achieve?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-448999" onclick='return addComment.moveForm( "comment-448999", "448999", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-450492">
<div class="comment-container" id="li-comment-450492">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d681ef92e041486c92e05f8c0bae82fa?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d681ef92e041486c92e05f8c0bae82fa?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mark</span>
<span class="date">October 2, 2018 at 5:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-450492" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Any chance of a tutorial on this using some real/toy data as a vehicle</p>
<div class="reply">
<a aria-label="Reply to Mark" class="comment-reply-link" href="#comment-450492" onclick='return addComment.moveForm( "comment-450492", "450492", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-450524">
<div class="comment-container" id="li-comment-450524">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 3, 2018 at 6:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-450524" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have many deep learning tutorials on real dataset, you can get started here:<br/>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow">https://machinelearningmastery.com/start-here/#deeplearning</a></p>
<p>And here:<br/>
<a href="https://machinelearningmastery.com/start-here/#nlp" rel="nofollow">https://machinelearningmastery.com/start-here/#nlp</a></p>
<p>And here:<br/>
<a href="https://machinelearningmastery.com/start-here/#deep_learning_time_series" rel="nofollow">https://machinelearningmastery.com/start-here/#deep_learning_time_series</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-450524" onclick='return addComment.moveForm( "comment-450524", "450524", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-450687">
<div class="comment-container" id="li-comment-450687">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/035664284016e618ce9d7cb8af143d4b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/035664284016e618ce9d7cb8af143d4b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">rim</span>
<span class="date">October 4, 2018 at 9:25 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-450687" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Mr.Jason,</p>
<p>Can you help me to predict solar radiation using kalman filter?</p>
<p>Have you a matlab code about kalman filter for solar radiation prediction.</p>
<p>Best regards</p>
<div class="reply">
<a aria-label="Reply to rim" class="comment-reply-link" href="#comment-450687" onclick='return addComment.moveForm( "comment-450687", "450687", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-450728">
<div class="comment-container" id="li-comment-450728">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 5, 2018 at 5:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-450728" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have examples in matlab nor an example of a kalman filter.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-450728" onclick='return addComment.moveForm( "comment-450728", "450728", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-450877">
<div class="comment-container" id="li-comment-450877">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1ee16e306d34cfc9ee929185bb787bba?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1ee16e306d34cfc9ee929185bb787bba?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Gledson</span>
<span class="date">October 7, 2018 at 3:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-450877" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello how are you? Sorry for the inconvenience. I’m following up on his explanations of Keras using neural networks and convolutional neural networks. I’m trying to perform a convolution using a set of images that three channels each image and another set of images that has one channel each image. When I run a CNN with Keras for each type of image, I get a result. So I have two inputs and one output. The entries are X_train1 with size of (24484,227,227,1) and X_train2 with size of (24484,227,227,3). So I perform a convolution separately for each input and then I use the “merge” command from KERAS, then I apply the “merge” on a CNN. However, I get the following error:<br/>
ValueError: could not broadcast input array from shape (24484,227,227,1) into shape (24484,227,227).</p>
<p>I already tried to take the number 1 and so stick with the shape (24484,227,227). So it looks like it’s right. But the error happens again in X_train2 with the following warning:<br/>
ValueError: could not broadcast input array from shape (24484,227,227,3) into shape (24484,227,227).<br/>
However, I can not delete the number “3”.</p>
<p>Could you help me to eliminate this error?</p>
<p>My code is:</p>
<p>X_train1: shape of (24484,227,227,1)<br/>
X_train2: shape of (24484,227,227,3)<br/>
X_val1: shape of (2000,227,227,1)<br/>
X_val2: shape of (2000,227,227,3)</p>
<p>batch_size=64<br/>
num_epochs=30<br/>
DROPOUT = 0.5</p>
<p>model_input1 = Input(shape = (img_width, img_height, 1))<br/>
DM = Convolution2D(filters = 64, kernel_size = (1,1), strides = (1,1), activation = “relu”)(model_input1)<br/>
DM = Convolution2D(filters = 64, kernel_size = (1,1), strides = (1,1), activation = “relu”)(DM)</p>
<p>model_input2 = Input(shape = (img_width, img_height, 3))<br/>
RGB = Convolution2D(filters = 64, kernel_size = (1,1), strides = (1,1), activation = “relu”)(model_input2)<br/>
RGB = Convolution2D(filters = 64, kernel_size = (1,1), strides = (1,1), activation = “relu”)(RGB)</p>
<p>merge = concatenate([DM, RGB])</p>
<p># First convolutional Layer<br/>
z = Convolution2D(filters = 96, kernel_size = (11,11), strides = (4,4), activation = “relu”)(merge)<br/>
z = BatchNormalization()(z)<br/>
z = MaxPooling2D(pool_size = (3,3), strides=(2,2))(z)</p>
<p># Second convolutional Layer<br/>
z = ZeroPadding2D(padding = (2,2))(z)<br/>
z = Convolution2D(filters = 256, kernel_size = (5,5), strides = (1,1), activation = “relu”)(z)<br/>
z = BatchNormalization()(z)<br/>
z = MaxPooling2D(pool_size = (3,3), strides=(2,2))(z)</p>
<p># Rest 3 convolutional layers<br/>
z = ZeroPadding2D(padding = (1,1))(z)<br/>
z = Convolution2D(filters = 384, kernel_size = (3,3), strides = (1,1), activation = “relu”)(z)</p>
<p>z = ZeroPadding2D(padding = (1,1))(z)<br/>
z = Convolution2D(filters = 384, kernel_size = (3,3), strides = (1,1), activation = “relu”)(z)</p>
<p>z = ZeroPadding2D(padding = (1,1))(z)<br/>
z = Convolution2D(filters = 256, kernel_size = (3,3), strides = (1,1), activation = “relu”)(z)</p>
<p>z = MaxPooling2D(pool_size = (3,3), strides=(2,2))(z)<br/>
z = Flatten()(z)</p>
<p>z = Dense(4096, activation=”relu”)(z)<br/>
z = Dropout(DROPOUT)(z)</p>
<p>z = Dense(4096, activation=”relu”)(z)<br/>
z = Dropout(DROPOUT)(z)</p>
<p>model_output = Dense(num_classes, activation=’softmax’)(z)<br/>
model = Model([model_input1,model_input2], model_output)<br/>
model.summary()</p>
<p>sgd = SGD(lr=0.001, decay=1e-6, momentum=0.9, nesterov=True)<br/>
model.compile(loss=’categorical_crossentropy’,<br/>
              optimizer=sgd,<br/>
              metrics=[‘accuracy’])</p>
<p>print(‘RGB_D’)</p>
<p>datagen_train = ImageDataGenerator(rescale=1./255)<br/>
datagen_val = ImageDataGenerator(rescale=1./255)</p>
<p>print(“fit_generator”)<br/>
# Train the model using the training set…<br/>
Results_Train = model.fit_generator(datagen_train.flow([X_train1,X_train2], [Y_train1,Y_train2], batch_size = batch_size),<br/>
                                    steps_per_epoch = nb_train_samples//batch_size,<br/>
                                    epochs = num_epochs,<br/>
                                    validation_data = datagen_val.flow([X_val1,X_val1],                                [Y_val1,Y_val2],batch_size = batch_size),<br/>
                                    shuffle=True,<br/>
                                    verbose=1)</p>
<p>print(Results_Train.history)</p>
<div class="reply">
<a aria-label="Reply to Gledson" class="comment-reply-link" href="#comment-450877" onclick='return addComment.moveForm( "comment-450877", "450877", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-450899">
<div class="comment-container" id="li-comment-450899">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 7, 2018 at 7:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-450899" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Looks like a mismatch between your data and your model. You can reshape your data or change the expectations of your model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-450899" onclick='return addComment.moveForm( "comment-450899", "450899", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-451018">
<div class="comment-container" id="li-comment-451018">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7b51654d7ea90f5b5706052b759bbf0c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7b51654d7ea90f5b5706052b759bbf0c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Leeor</span>
<span class="date">October 9, 2018 at 12:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-451018" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason.<br/>
Do you know of a way to combine models each with a different loss function?</p>
<p>Leeor.</p>
<div class="reply">
<a aria-label="Reply to Leeor" class="comment-reply-link" href="#comment-451018" onclick='return addComment.moveForm( "comment-451018", "451018", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-451057">
<div class="comment-container" id="li-comment-451057">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 9, 2018 at 8:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-451057" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, as an ensemble after they are trained.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-451057" onclick='return addComment.moveForm( "comment-451057", "451057", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-453361">
<div class="comment-container" id="li-comment-453361">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c2e38e2564d097ab29d7856df7cf7c79?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c2e38e2564d097ab29d7856df7cf7c79?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Konstantin</span>
<span class="date">November 1, 2018 at 11:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-453361" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
thank you for your wonderful tutorials!</p>
<p>I just wonder about the “Convolutional Neural Network” example. Isn’t there a Flatten layer missing between max_pooling2d_2 and dense_1?</p>
<p>Something like:<br/>
    pool2 = MaxPooling2D(pool_size=(2, 2))(conv2)<br/>
    flatt = Flatten()(pool2)<br/>
    hidden1 = Dense(10, activation=’relu’)(flatt)</p>
<p>Beste regards</p>
<div class="reply">
<a aria-label="Reply to Konstantin" class="comment-reply-link" href="#comment-453361" onclick='return addComment.moveForm( "comment-453361", "453361", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-453396">
<div class="comment-container" id="li-comment-453396">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 2, 2018 at 5:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-453396" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I think you’re right! Fixed.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453396" onclick='return addComment.moveForm( "comment-453396", "453396", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-453844">
<div class="comment-container" id="li-comment-453844">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0aadeba45863d24c8962c868d57957e7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0aadeba45863d24c8962c868d57957e7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nada</span>
<span class="date">November 6, 2018 at 3:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-453844" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason</p>
<p>In Multiple Input Model, How did you naming the layers?</p>
<p>____________________________________________________________________________________________________<br/>
Layer (type)                     Output Shape          Param #     Connected to<br/>
====================================================================================================<br/>
input_1 (InputLayer)             (None, 64, 64, 1)     0<br/>
____________________________________________________________________________________________________<br/>
conv2d_1 (Conv2D)                (None, 61, 61, 32)    544         input_1[0][0]<br/>
____________________________________________________________________________________________________<br/>
conv2d_2 (Conv2D)                (None, 57, 57, 16)    1040        input_1[0][0]<br/>
____________________________________________________________________________________________________<br/>
max_pooling2d_1 (MaxPooling2D)   (None, 30, 30, 32)    0           conv2d_1[0][0]<br/>
____________________________________________________________________________________________________<br/>
max_pooling2d_2 (MaxPooling2D)   (None, 28, 28, 16)    0           conv2d_2[0][0]<br/>
____________________________________________________________________________________________________<br/>
flatten_1 (Flatten)              (None, 28800)         0           max_pooling2d_1[0][0]<br/>
____________________________________________________________________________________________________<br/>
flatten_2 (Flatten)              (None, 12544)         0           max_pooling2d_2[0][0]<br/>
____________________________________________________________________________________________________<br/>
concatenate_1 (Concatenate)      (None, 41344)         0           flatten_1[0][0]<br/>
                                                                   flatten_2[0][0]<br/>
____________________________________________________________________________________________________<br/>
dense_1 (Dense)                  (None, 10)            413450      concatenate_1[0][0]<br/>
____________________________________________________________________________________________________<br/>
dense_2 (Dense)                  (None, 1)             11          dense_1[0][0]<br/>
====================================================================================================<br/>
Total params: 415,045<br/>
Trainable params: 415,045<br/>
Non-trainable params: 0<br/>
____________________________________________________________________________________________________</p>
<div class="reply">
<a aria-label="Reply to Nada" class="comment-reply-link" href="#comment-453844" onclick='return addComment.moveForm( "comment-453844", "453844", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-453902">
<div class="comment-container" id="li-comment-453902">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 7, 2018 at 5:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-453902" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If the model is built at one time, the default names are fine.</p>
<p>If the models are built at different times, I give arbitrary names to each head, like: name = ‘head_1_’ + name</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453902" onclick='return addComment.moveForm( "comment-453902", "453902", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-453872">
<div class="comment-container" id="li-comment-453872">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cc95425fae9d348713bc412ab9663644?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cc95425fae9d348713bc412ab9663644?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://stayhere.co.il" rel="external nofollow">Or Bennatan</a></span>
<span class="date">November 6, 2018 at 10:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-453872" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Very good insight into Keras.<br/>
I also read your Deep_Learning_Time_Series_Forcasting and it was very helpful</p>
<div class="reply">
<a aria-label="Reply to Or Bennatan" class="comment-reply-link" href="#comment-453872" onclick='return addComment.moveForm( "comment-453872", "453872", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-453912">
<div class="comment-container" id="li-comment-453912">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 7, 2018 at 6:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-453912" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<p>It was your email that prompted me to update this post with the Python syntax explanation!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453912" onclick='return addComment.moveForm( "comment-453912", "453912", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-454007">
<div class="comment-container" id="li-comment-454007">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8d3c906af38c39e9862194930433a11b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8d3c906af38c39e9862194930433a11b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jonathan Roy</span>
<span class="date">November 8, 2018 at 2:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-454007" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Wow thank a lot for all your post, you save me a lot of time in my learning and prototyping experience!</p>
<p>I use an LSTM layer and want to use the ouput to feed a Dense layer to get an first predictive value ans insert this new value to the first LSTM output and feed an new LSTM layer. Im stuck with the dimension problem… </p>
<p>    main_inputs = Input(shape=(train_X.shape[1], train_X.shape[2]), name=’main_inputs’)</p>
<p>    ly1 = LSTM(100, return_sequences=False)(main_inputs)<br/>
    auxiliary_output = Dense(1, activation=’softmax’, name=’aux_output’)(ly1)</p>
<p>    merged_input = concatenate([main_inputs, auxiliary_output])</p>
<p>    ly2 = LSTM(100, return_sequences=True)(merged_input)<br/>
    main_output = Dense(1, activation= ‘softmax’, name=’main_output’)(ly2)  </p>
<p>Any suggestion is welcome</p>
<div class="reply">
<a aria-label="Reply to Jonathan Roy" class="comment-reply-link" href="#comment-454007" onclick='return addComment.moveForm( "comment-454007", "454007", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-454026">
<div class="comment-container" id="li-comment-454026">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 8, 2018 at 6:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-454026" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What’s the problem exactly?</p>
<p>I don’t have the capacity to debug your code, perhaps post to stackoverflow?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-454026" onclick='return addComment.moveForm( "comment-454026", "454026", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-454355">
<div class="comment-container" id="li-comment-454355">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b79a64ff83219b21eebffdb634f35622?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b79a64ff83219b21eebffdb634f35622?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alaya</span>
<span class="date">November 11, 2018 at 5:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-454355" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason for the post 🙂 </p>
<p>In the multi-input CNN model example, does the two images enter to the model at the same time has the same index?</p>
<p>does the two images enter to the model at the same time has the same class?</p>
<p>In training, does each black image enters to the model many times (with all colored images) or each black image enters to the model one time (with only one colored image)?</p>
<p>Thanks..</p>
<div class="reply">
<a aria-label="Reply to Alaya" class="comment-reply-link" href="#comment-454355" onclick='return addComment.moveForm( "comment-454355", "454355", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-454378">
<div class="comment-container" id="li-comment-454378">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 11, 2018 at 6:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-454378" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Both images are provided to the model at the same time.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-454378" onclick='return addComment.moveForm( "comment-454378", "454378", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-454388">
<div class="comment-container" id="li-comment-454388">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b79a64ff83219b21eebffdb634f35622?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b79a64ff83219b21eebffdb634f35622?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alaya</span>
<span class="date">November 11, 2018 at 8:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-454388" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>does the two images enter to the model at the same time has the same class?</p>
<div class="reply">
<a aria-label="Reply to Alaya" class="comment-reply-link" href="#comment-454388" onclick='return addComment.moveForm( "comment-454388", "454388", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-454468">
<div class="comment-container" id="li-comment-454468">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 12, 2018 at 5:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-454468" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It really depends on the problem that you are solving.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-454468" onclick='return addComment.moveForm( "comment-454468", "454468", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-454686">
<div class="comment-container" id="li-comment-454686">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fd4b07b2c0eec65774fcd0c3689d7637?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fd4b07b2c0eec65774fcd0c3689d7637?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Meiling</span>
<span class="date">November 14, 2018 at 2:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-454686" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, now I want to use a 1-D data like wave.shape=(360,) as input, and 3-D data like velocity.shape=(560,7986,3) as output. I want to ask if this problem can be solved by multilayers perceptron to tain these data? I have tried, but the shape problem is not solved, it shows “ValueError: Error when checking target: expected dense_3 to have 2 dimensions, but got array with shape (560, 7986, 3)”</p>
<div class="reply">
<a aria-label="Reply to Meiling" class="comment-reply-link" href="#comment-454686" onclick='return addComment.moveForm( "comment-454686", "454686", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-454724">
<div class="comment-container" id="li-comment-454724">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 14, 2018 at 7:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-454724" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps, it really comes down to what the data represents.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-454724" onclick='return addComment.moveForm( "comment-454724", "454724", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-456852">
<div class="comment-container" id="li-comment-456852">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/10440b2dbc20f97ab47eab71d945888a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/10440b2dbc20f97ab47eab71d945888a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">CHYOO</span>
<span class="date">December 2, 2018 at 12:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-456852" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, thank you for sharing the contents 🙂<br/>
Is it same that the ‘Multi-output’ case with ‘multi-task deep learning’ ?</p>
<p>I am trying to build up the multi-task deep learning model and found here.<br/>
Thank you again.</p>
<div class="reply">
<a aria-label="Reply to CHYOO" class="comment-reply-link" href="#comment-456852" onclick='return addComment.moveForm( "comment-456852", "456852", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-456899">
<div class="comment-container" id="li-comment-456899">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 2, 2018 at 6:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-456899" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, it can be.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-456899" onclick='return addComment.moveForm( "comment-456899", "456899", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-457820">
<div class="comment-container" id="li-comment-457820">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/aeb63f6f73e0c09bd4f311cf6103f87f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/aeb63f6f73e0c09bd4f311cf6103f87f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Antonio</span>
<span class="date">December 7, 2018 at 11:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-457820" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, a very modest contribution for now. Just a typo. In,</p>
<p>…Shared Feature Extraction Layer<br/>
In this section, we will two parallel submodels to interpret the output…</p>
<p>it looks like we are missing a verb or something in the sentence, it sounds strange.<br/>
If it sounds OK to you, just disregard, it must be me being tired.</p>
<p>I hope to support more substantially in the future this extraordinary site.</p>
<p>(You don’t need to post this comment)</p>
<p>Regards<br/>
Antonio</p>
<div class="reply">
<a aria-label="Reply to Antonio" class="comment-reply-link" href="#comment-457820" onclick='return addComment.moveForm( "comment-457820", "457820", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-457869">
<div class="comment-container" id="li-comment-457869">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 8, 2018 at 7:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/#comment-457869" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, fixed!</p>
<p>(I like to keep these comments in there, to show that everything is a work in progress and getting incrementally better)</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-457869" onclick='return addComment.moveForm( "comment-457869", "457869", "respond", "4392" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/keras-functional-api-deep-learning/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="4392"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="b5f648a069"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="62"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery!</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Jason Brownlee, PhD
<br/>
I write tutorials to help developers (<i>like you</i>) get results with machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-6"> <div class="textwidget"><p></p><center><br/>
<strong>Deep Learning with Python</strong><br/>
No math, just tutorials and working code.
<p><a href="/deep-learning-with-python/">Click to Get Started Now!</a><br/>
<a href="/deep-learning-with-python/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/DeepLearningWithPython-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch"><img alt="How to Develop a Neural Machine Translation System in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/01/How-to-Develop-a-Neural-Machine-Translation-System-in-Keras-150x150.jpg" title="How to Develop a Neural Machine Translation System from Scratch" width="45"/></a> <a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch">How to Develop a Neural Machine Translation System from Scratch</a>
<span class="meta">January 10, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning"><img alt="Difference Between Classification and Regression in Machine Learning" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/Difference-Between-Classification-and-Regression-in-Machine-Learning-150x150.jpg" title="Difference Between Classification and Regression in Machine Learning" width="45"/></a> <a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning">Difference Between Classification and Regression in Machine Learning</a>
<span class="meta">December 11, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem..."><img alt="So, You are Working on a Machine Learning Problem..." class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/So-You-are-Working-on-a-Machine-Learning-Problem...-150x150.jpg" title="So, You are Working on a Machine Learning Problem..." width="45"/></a> <a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem…">So, You are Working on a Machine Learning Problem…</a>
<span class="meta">April 4, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis"><img alt="Plot of the Multichannel Convolutional Neural Network For Text" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-150x150.png" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis" width="45"/></a> <a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis">How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis</a>
<span class="meta">January 12, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras"><img alt="How to Make Classification and Regression Predictions for Deep Learning Models in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/How-to-Make-Classification-and-Regression-Predictions-for-Deep-Learning-Models-in-Keras-150x150.jpg" title="How to Make Predictions with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras">How to Make Predictions with Keras</a>
<span class="meta">April 9, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)"><img alt="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/11-Classical-Time-Series-Forecasting-Methods-in-Python-Cheat-Sheet-150x150.jpg" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)">11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)</a>
<span class="meta">August 6, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras"><img alt="How to Visualize a Deep Learning Neural Network Model in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/How-to-Visualize-a-Deep-Learning-Neural-Network-Model-in-Keras-150x150.jpg" title="How to Visualize a Deep Learning Neural Network Model in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras">How to Visualize a Deep Learning Neural Network Model in Keras</a>
<span class="meta">December 13, 2017</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> <div class="widget_text widget widget_custom_html" id="custom_html-2"><h3>You might also like…</h3><div class="textwidget custom-html-widget"><ul>
<li><a href="/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Install Python for Machine Learning</a></li>
<li><a href="/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python</a></li>
<li><a href="/tutorial-first-neural-network-python-keras/">Your First Neural Network in Python</a></li>
<li><a href="/how-to-run-your-first-classifier-in-weka/">Your First Classifier in Weka</a></li>
<li><a href="/arima-for-time-series-forecasting-with-python/">Your First Time Series Forecasting Project</a></li>
</ul></div></div></aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/disclaimer/">Disclaimer</a> | 
<a href="/terms-of-service/">Terms</a> | 
<a href="/contact/">Contact</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.8" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.0.5" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.8" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.1" type="text/javascript"></script>
</body>
</html>