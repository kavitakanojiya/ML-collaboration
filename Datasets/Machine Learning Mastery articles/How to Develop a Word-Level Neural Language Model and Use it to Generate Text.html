<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v9.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>How to Develop a Word-Level Neural Language Model and Use it to Generate Text</title>
<link href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="How to Develop a Word-Level Neural Language Model and Use it to Generate Text" property="og:title"/>
<meta content="A language model can predict the probability of the next word in the sequence, based on the words already observed in the sequence. Neural network models are a preferred method for developing statistical language models because they can use a distributed representation where different words with similar meanings have similar representation and because they can …" property="og:description"/>
<meta content="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="https://www.facebook.com/jason.brownlee.39" property="article:author"/>
<meta content="Deep Learning for Natural Language Processing" property="article:section"/>
<meta content="2017-11-09T18:00:12+00:00" property="article:published_time"/>
<meta content="2018-04-23T20:29:38+00:00" property="article:modified_time"/>
<meta content="2018-04-23T20:29:38+00:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/11/How-to-Develop-a-Word-Level-Neural-Language-Model-and-Use-it-to-Generate-Text.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/11/How-to-Develop-a-Word-Level-Neural-Language-Model-and-Use-it-to-Generate-Text.jpg" property="og:image:secure_url"/>
<meta content="480" property="og:image:width"/>
<meta content="640" property="og:image:height"/>
<meta content="How to Develop a Word-Level Neural Language Model and Use it to Generate Text" property="og:image:alt"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"https:\/\/machinelearningmastery.com\/#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/feed/" rel="alternate" title="Machine Learning Mastery » How to Develop a Word-Level Neural Language Model and Use it to Generate Text Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<style media="all" type="text/css">
.wpautoterms-footer{background-color:#ffffff;text-align:center;}
.wpautoterms-footer a{color:#000000;font-family:Arial, sans-serif;font-size:14px;}
.wpautoterms-footer .separator{color:#cccccc;font-family:Arial, sans-serif;font-size:14px;}</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/auto-terms-of-service-and-privacy-policy/css/wpautoterms.css?ver=4.9.8" id="wpautoterms_css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.0.5" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/css/front.css?ver=2.0.20" id="ssb-front-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/ewd-ufaq-styles.css?ver=4.9.8" id="ewd-ufaq-style-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/rrssb-min.css?ver=4.9.8" id="ewd-ufaq-rrssb-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.8" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=2.0.20" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.8" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.8" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=4422" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fhow-to-develop-a-word-level-neural-language-model-in-keras%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fhow-to-develop-a-word-level-neural-language-model-in-keras%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<style media="screen">

        .simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
      margin: ;
    }
         /*inline margin*/
    
  
  
  
  
  
          .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
         margin: ;
     }

          /*margin-digbar*/

  
  
  
  
 
   
   

</style>
<script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#4c89bf; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#4c89bf;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#4c89bf!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#ffffff;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-4422 single-format-standard safari alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/icon-100x100.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-44"> <div class="textwidget"><p>Want help with deep learning for text? <a href="https://machinelearningmastery.lpages.co/dlfnlp-mini-course/">Take the FREE Mini-Course</a></p>
</div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<input name="post_type" type="hidden" value="post"/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Main Menu</h3><ul class="nav fl" id="main-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503" id="menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Start Here</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501" id="menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506" id="menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508" id="menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (Keras)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511" id="menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509" id="menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6515" id="menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">Deep Learning for NLP</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512" id="menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Understand Algorithms</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507" id="menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms (Python)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6513" id="menu-item-6513"><a href="https://machinelearningmastery.com/category/machine-learning-process/">Machine Learning Process</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516" id="menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517" id="menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522" id="menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6518" id="menu-item-6518"><a href="https://machinelearningmastery.com/category/start-machine-learning/">Getting Started</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510" id="menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519" id="menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistical Methods</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520" id="menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Time Series (introductory)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523" id="menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6514" id="menu-item-6514"><a href="https://machinelearningmastery.com/category/machine-learning-resources/">Resources</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502" id="menu-item-6502"><a href="https://machinelearningmastery.com/products/">Ebooks</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500" id="menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504" id="menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505" id="menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-4422 post type-post status-publish format-standard has-post-thumbnail hentry category-natural-language-processing">
<header>
<h1 class="title entry-title">How to Develop a Word-Level Neural Language Model and Use it to Generate Text</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2017-11-10T05:00:12+1100">November 10, 2017</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/natural-language-processing/" title="View all items in Deep Learning for Natural Language Processing">Deep Learning for Natural Language Processing</a></span> </div>
<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-4422 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Develop+a+Word-Level+Neural+Language+Model+and+Use+it+to+Generate+Text&amp;url=https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
<p>A language model can predict the probability of the next word in the sequence, based on the words already observed in the sequence.</p>
<p>Neural network models are a preferred method for developing statistical language models because they can use a distributed representation where different words with similar meanings have similar representation and because they can use a large context of recently observed words when making predictions.</p>
<p>In this tutorial, you will discover how to develop a statistical language model using deep learning in Python.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>How to prepare text for developing a word-based language model.</li>
<li>How to design and fit a neural language model with a learned embedding and an LSTM hidden layer.</li>
<li>How to use the learned language model to generate new text with similar statistical properties as the source text.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Apr/2018</strong>: Fixed mismatch between 100 input words in description of the model and 50 in the actual model.</li>
</ul>
<div class="wp-caption aligncenter" id="attachment_4424" style="width: 490px"><img alt="How to Develop a Word-Level Neural Language Model and Use it to Generate Text" class="size-full wp-image-4424" height="640" sizes="(max-width: 480px) 100vw, 480px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/11/How-to-Develop-a-Word-Level-Neural-Language-Model-and-Use-it-to-Generate-Text.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/11/How-to-Develop-a-Word-Level-Neural-Language-Model-and-Use-it-to-Generate-Text.jpg 480w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/11/How-to-Develop-a-Word-Level-Neural-Language-Model-and-Use-it-to-Generate-Text-225x300.jpg 225w" width="480"/><p class="wp-caption-text">How to Develop a Word-Level Neural Language Model and Use it to Generate Text<br/>Photo by <a href="https://www.flickr.com/photos/70125105@N06/32512473990/">Carlo Raso</a>, some rights reserved.</p></div>
<h2>Tutorial Overview</h2>
<p>This tutorial is divided into 4 parts; they are:</p>
<ol>
<li>The Republic by Plato</li>
<li>Data Preparation</li>
<li>Train Language Model</li>
<li>Use Language Model</li>
</ol>
<h2>The Republic by Plato</h2>
<p><a href="https://en.wikipedia.org/wiki/Republic_(Plato)">The Republic</a> is the classical Greek philosopher Plato’s most famous work.</p>
<p>It is structured as a dialog (e.g. conversation) on the topic of order and justice within a city state</p>
<p>The entire text is available for free in the public domain. It is available on the <a href="https://www.gutenberg.org/ebooks/1497">Project Gutenberg website</a> in a number of formats.</p>
<p>You can download the ASCII text version of the entire book (or books) here:</p>
<ul>
<li><a href="http://www.gutenberg.org/cache/epub/1497/pg1497.txt">Download The Republic by Plato</a></li>
</ul>
<p>Download the book text and place it in your current working directly with the filename ‘<em>republic.txt</em>‘</p>
<p>Open the file in a text editor and delete the front and back matter. This includes details about the book at the beginning, a long analysis, and license information at the end.</p>
<p>The text should begin with:</p>
<blockquote><p>BOOK I.</p>
<p>I went down yesterday to the Piraeus with Glaucon the son of Ariston,<br/>
…</p></blockquote>
<p>And end with</p>
<blockquote><p>…<br/>
And it shall be well with us both in this life and in the pilgrimage of a thousand years which we have been describing.</p></blockquote>
<p>Save the cleaned version as ‘<em>republic_clean.</em>txt’ in your current working directory. The file should be about 15,802 lines of text.</p>
<p>Now we can develop a language model from this text.</p>
<p></p><div class="woo-sc-hr"></div>
<center>
<h3>Need help with Deep Learning for Text Data?</h3>
<p>Take my free 7-day email crash course now (with code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.lpages.co/leadbox/144855173f72a2%3A164f8be4f346dc/5655638436741120/" rel="noopener" style="background: #ffce0a; color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.25) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.5) 0px 1px 3px inset, rgba(0, 0, 0, 0.5) 0px 1px 3px;" target="_blank">Start Your FREE Crash-Course Now</a><script data-config="%7B%7D" data-leadbox="144855173f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.lpages.co/leadbox/144855173f72a2%3A164f8be4f346dc/5655638436741120/" src="https://machinelearningmastery.lpages.co/leadbox-1509466860.js" type="text/javascript"></script></p>
</center>
<p></p><div class="woo-sc-hr"></div>
<h2>Data Preparation</h2>
<p>We will start by preparing the data for modeling.</p>
<p>The first step is to look at the data.</p>
<h3>Review the Text</h3>
<p>Open the text in an editor and just look at the text data.</p>
<p>For example, here is the first piece of dialog:</p>
<blockquote><p>BOOK I.</p>
<p>I went down yesterday to the Piraeus with Glaucon the son of Ariston,<br/>
that I might offer up my prayers to the goddess (Bendis, the Thracian<br/>
Artemis.); and also because I wanted to see in what manner they would<br/>
celebrate the festival, which was a new thing. I was delighted with the<br/>
procession of the inhabitants; but that of the Thracians was equally,<br/>
if not more, beautiful. When we had finished our prayers and viewed the<br/>
spectacle, we turned in the direction of the city; and at that instant<br/>
Polemarchus the son of Cephalus chanced to catch sight of us from a<br/>
distance as we were starting on our way home, and told his servant to<br/>
run and bid us wait for him. The servant took hold of me by the cloak<br/>
behind, and said: Polemarchus desires you to wait.</p>
<p>I turned round, and asked him where his master was.</p>
<p>There he is, said the youth, coming after you, if you will only wait.</p>
<p>Certainly we will, said Glaucon; and in a few minutes Polemarchus<br/>
appeared, and with him Adeimantus, Glaucon’s brother, Niceratus the son<br/>
of Nicias, and several others who had been at the procession.</p>
<p>Polemarchus said to me: I perceive, Socrates, that you and your<br/>
companion are already on your way to the city.</p>
<p>You are not far wrong, I said.</p>
<p>…</p></blockquote>
<p>What do you see that we will need to handle in preparing the data?</p>
<p>Here’s what I see from a quick look:</p>
<ul>
<li>Book/Chapter headings (e.g. “BOOK I.”).</li>
<li>British English spelling (e.g. “honoured”)</li>
<li>Lots of punctuation (e.g. “–“, “;–“, “?–“, and more)</li>
<li>Strange names (e.g. “Polemarchus”).</li>
<li>Some long monologues that go on for hundreds of lines.</li>
<li>Some quoted dialog (e.g. ‘…’)</li>
</ul>
<p>These observations, and more, suggest at ways that we may wish to prepare the text data.</p>
<p>The specific way we prepare the data really depends on how we intend to model it, which in turn depends on how we intend to use it.</p>
<h3>Language Model Design</h3>
<p>In this tutorial, we will develop a model of the text that we can then use to generate new sequences of text.</p>
<p>The language model will be statistical and will predict the probability of each word given an input sequence of text. The predicted word will be fed in as input to in turn generate the next word.</p>
<p>A key design decision is how long the input sequences should be. They need to be long enough to allow the model to learn the context for the words to predict. This input length will also define the length of seed text used to generate new sequences when we use the model.</p>
<p>There is no correct answer. With enough time and resources, we could explore the ability of the model to learn with differently sized input sequences.</p>
<p>Instead, we will pick a length of 50 words for the length of the input sequences, somewhat arbitrarily.</p>
<p>We could process the data so that the model only ever deals with self-contained sentences and pad or truncate the text to meet this requirement for each input sequence. You could explore this as an extension to this tutorial.</p>
<p>Instead, to keep the example brief, we will let all of the text flow together and train the model to predict the next word across sentences, paragraphs, and even books or chapters in the text.</p>
<p>Now that we have a model design, we can look at transforming the raw text into sequences of 50 input words to 1 output word, ready to fit a model.</p>
<h3>Load Text</h3>
<p>The first step is to load the text into memory.</p>
<p>We can develop a small function to load the entire text file into memory and return it. The function is called <em>load_doc()</em> and is listed below. Given a filename, it returns a sequence of loaded text.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9c1550883761" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load doc into memory
def load_doc(filename):
	# open the file as read only
	file = open(filename, 'r')
	# read all text
	text = file.read()
	# close the file
	file.close()
	return text</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9c1550883761-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9c1550883761-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9c1550883761-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9c1550883761-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9c1550883761-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9c1550883761-6">6</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9c1550883761-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9c1550883761-8">8</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9c1550883761-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9c1550883761-1"><span class="crayon-p"># load doc into memory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9c1550883761-2"><span class="crayon-e">def </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9c1550883761-3"><span class="crayon-h"> </span><span class="crayon-p"># open the file as read only</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9c1550883761-4"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9c1550883761-5"><span class="crayon-h"> </span><span class="crayon-p"># read all text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9c1550883761-6"><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9c1550883761-7"><span class="crayon-h"> </span><span class="crayon-p"># close the file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9c1550883761-8"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9c1550883761-9"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">text</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>Using this function, we can load the cleaner version of the document in the file ‘<em>republic_clean.txt</em>‘ as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9ca402344270" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load document
in_filename = 'republic_clean.txt'
doc = load_doc(in_filename)
print(doc[:200])</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ca402344270-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9ca402344270-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ca402344270-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9ca402344270-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9ca402344270-1"><span class="crayon-p"># load document</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9ca402344270-2"><span class="crayon-v">in_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'republic_clean.txt'</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9ca402344270-3"><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">in_filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9ca402344270-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">200</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Running this snippet loads the document and prints the first 200 characters as a sanity check.</p>
<blockquote><p>BOOK I.</p>
<p>I went down yesterday to the Piraeus with Glaucon the son of Ariston,<br/>
that I might offer up my prayers to the goddess (Bendis, the Thracian<br/>
Artemis.); and also because I wanted to see in what</p></blockquote>
<p>So far, so good. Next, let’s clean the text.</p>
<h3>Clean Text</h3>
<p>We need to transform the raw text into a sequence of tokens or words that we can use as a source to train the model.</p>
<p>Based on reviewing the raw text (above), below are some specific operations we will perform to clean the text. You may want to explore more cleaning operations yourself as an extension.</p>
<ul>
<li>Replace ‘–‘ with a white space so we can split words better.</li>
<li>Split words based on white space.</li>
<li>Remove all punctuation from words to reduce the vocabulary size (e.g. ‘What?’ becomes ‘What’).</li>
<li>Remove all words that are not alphabetic to remove standalone punctuation tokens.</li>
<li>Normalize all words to lowercase to reduce the vocabulary size.</li>
</ul>
<p>Vocabulary size is a big deal with language modeling. A smaller vocabulary results in a smaller model that trains faster.</p>
<p>We can implement each of these cleaning operations in this order in a function. Below is the function <em>clean_doc()</em> that takes a loaded document as an argument and returns an array of clean tokens.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9cc786123252" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
import string

# turn a doc into clean tokens
def clean_doc(doc):
	# replace '--' with a space ' '
	doc = doc.replace('--', ' ')
	# split into tokens by white space
	tokens = doc.split()
	# remove punctuation from each token
	table = str.maketrans('', '', string.punctuation)
	tokens = [w.translate(table) for w in tokens]
	# remove remaining tokens that are not alphabetic
	tokens = [word for word in tokens if word.isalpha()]
	# make lower case
	tokens = [word.lower() for word in tokens]
	return tokens</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9cc786123252-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9cc786123252-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9cc786123252-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9cc786123252-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9cc786123252-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9cc786123252-6">6</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9cc786123252-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9cc786123252-8">8</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9cc786123252-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9cc786123252-10">10</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9cc786123252-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9cc786123252-12">12</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9cc786123252-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9cc786123252-14">14</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9cc786123252-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9cc786123252-16">16</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9cc786123252-1"><span class="crayon-e">import </span><span class="crayon-t">string</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9cc786123252-2"> </div><div class="crayon-line" id="crayon-5c0ca7a9ce9cc786123252-3"><span class="crayon-p"># turn a doc into clean tokens</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9cc786123252-4"><span class="crayon-e">def </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9cc786123252-5"><span class="crayon-h"> </span><span class="crayon-p"># replace '--' with a space ' '</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9cc786123252-6"><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-s">'--'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">' '</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9cc786123252-7"><span class="crayon-h"> </span><span class="crayon-p"># split into tokens by white space</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9cc786123252-8"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9cc786123252-9"><span class="crayon-h"> </span><span class="crayon-p"># remove punctuation from each token</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9cc786123252-10"><span class="crayon-h"> </span><span class="crayon-v">table</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">str</span><span class="crayon-sy">.</span><span class="crayon-e">maketrans</span><span class="crayon-sy">(</span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">string</span><span class="crayon-sy">.</span><span class="crayon-v">punctuation</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9cc786123252-11"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">w</span><span class="crayon-sy">.</span><span class="crayon-e">translate</span><span class="crayon-sy">(</span><span class="crayon-v">table</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9cc786123252-12"><span class="crayon-h"> </span><span class="crayon-p"># remove remaining tokens that are not alphabetic</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9cc786123252-13"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-sy">.</span><span class="crayon-e">isalpha</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9cc786123252-14"><span class="crayon-h"> </span><span class="crayon-p"># make lower case</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9cc786123252-15"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-sy">.</span><span class="crayon-e">lower</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9cc786123252-16"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>We can run this cleaning operation on our loaded document and print out some of the tokens and statistics as a sanity check.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9ce655939087" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# clean document
tokens = clean_doc(doc)
print(tokens[:200])
print('Total Tokens: %d' % len(tokens))
print('Unique Tokens: %d' % len(set(tokens)))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ce655939087-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9ce655939087-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ce655939087-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9ce655939087-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ce655939087-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9ce655939087-1"><span class="crayon-p"># clean document</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9ce655939087-2"><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9ce655939087-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">200</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9ce655939087-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Total Tokens: %d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9ce655939087-5"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Unique Tokens: %d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>First, we can see a nice list of tokens that look cleaner than the raw text. We could remove the ‘<em>Book I</em>‘ chapter markers and more, but this is a good start.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9cf608501305" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
['book', 'i', 'i', 'went', 'down', 'yesterday', 'to', 'the', 'piraeus', 'with', 'glaucon', 'the', 'son', 'of', 'ariston', 'that', 'i', 'might', 'offer', 'up', 'my', 'prayers', 'to', 'the', 'goddess', 'bendis', 'the', 'thracian', 'artemis', 'and', 'also', 'because', 'i', 'wanted', 'to', 'see', 'in', 'what', 'manner', 'they', 'would', 'celebrate', 'the', 'festival', 'which', 'was', 'a', 'new', 'thing', 'i', 'was', 'delighted', 'with', 'the', 'procession', 'of', 'the', 'inhabitants', 'but', 'that', 'of', 'the', 'thracians', 'was', 'equally', 'if', 'not', 'more', 'beautiful', 'when', 'we', 'had', 'finished', 'our', 'prayers', 'and', 'viewed', 'the', 'spectacle', 'we', 'turned', 'in', 'the', 'direction', 'of', 'the', 'city', 'and', 'at', 'that', 'instant', 'polemarchus', 'the', 'son', 'of', 'cephalus', 'chanced', 'to', 'catch', 'sight', 'of', 'us', 'from', 'a', 'distance', 'as', 'we', 'were', 'starting', 'on', 'our', 'way', 'home', 'and', 'told', 'his', 'servant', 'to', 'run', 'and', 'bid', 'us', 'wait', 'for', 'him', 'the', 'servant', 'took', 'hold', 'of', 'me', 'by', 'the', 'cloak', 'behind', 'and', 'said', 'polemarchus', 'desires', 'you', 'to', 'wait', 'i', 'turned', 'round', 'and', 'asked', 'him', 'where', 'his', 'master', 'was', 'there', 'he', 'is', 'said', 'the', 'youth', 'coming', 'after', 'you', 'if', 'you', 'will', 'only', 'wait', 'certainly', 'we', 'will', 'said', 'glaucon', 'and', 'in', 'a', 'few', 'minutes', 'polemarchus', 'appeared', 'and', 'with', 'him', 'adeimantus', 'glaucons', 'brother', 'niceratus', 'the', 'son', 'of', 'nicias', 'and', 'several', 'others', 'who', 'had', 'been', 'at', 'the', 'procession', 'polemarchus', 'said']</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9cf608501305-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9cf608501305-1">['book', 'i', 'i', 'went', 'down', 'yesterday', 'to', 'the', 'piraeus', 'with', 'glaucon', 'the', 'son', 'of', 'ariston', 'that', 'i', 'might', 'offer', 'up', 'my', 'prayers', 'to', 'the', 'goddess', 'bendis', 'the', 'thracian', 'artemis', 'and', 'also', 'because', 'i', 'wanted', 'to', 'see', 'in', 'what', 'manner', 'they', 'would', 'celebrate', 'the', 'festival', 'which', 'was', 'a', 'new', 'thing', 'i', 'was', 'delighted', 'with', 'the', 'procession', 'of', 'the', 'inhabitants', 'but', 'that', 'of', 'the', 'thracians', 'was', 'equally', 'if', 'not', 'more', 'beautiful', 'when', 'we', 'had', 'finished', 'our', 'prayers', 'and', 'viewed', 'the', 'spectacle', 'we', 'turned', 'in', 'the', 'direction', 'of', 'the', 'city', 'and', 'at', 'that', 'instant', 'polemarchus', 'the', 'son', 'of', 'cephalus', 'chanced', 'to', 'catch', 'sight', 'of', 'us', 'from', 'a', 'distance', 'as', 'we', 'were', 'starting', 'on', 'our', 'way', 'home', 'and', 'told', 'his', 'servant', 'to', 'run', 'and', 'bid', 'us', 'wait', 'for', 'him', 'the', 'servant', 'took', 'hold', 'of', 'me', 'by', 'the', 'cloak', 'behind', 'and', 'said', 'polemarchus', 'desires', 'you', 'to', 'wait', 'i', 'turned', 'round', 'and', 'asked', 'him', 'where', 'his', 'master', 'was', 'there', 'he', 'is', 'said', 'the', 'youth', 'coming', 'after', 'you', 'if', 'you', 'will', 'only', 'wait', 'certainly', 'we', 'will', 'said', 'glaucon', 'and', 'in', 'a', 'few', 'minutes', 'polemarchus', 'appeared', 'and', 'with', 'him', 'adeimantus', 'glaucons', 'brother', 'niceratus', 'the', 'son', 'of', 'nicias', 'and', 'several', 'others', 'who', 'had', 'been', 'at', 'the', 'procession', 'polemarchus', 'said']</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We also get some statistics about the clean document.</p>
<p>We can see that there are just under 120,000 words in the clean text and a vocabulary of just under 7,500 words. This is smallish and models fit on this data should be manageable on modest hardware.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9d1856140935" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Total Tokens: 118684
Unique Tokens: 7409</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d1856140935-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d1856140935-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9d1856140935-1">Total Tokens: 118684</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d1856140935-2">Unique Tokens: 7409</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Next, we can look at shaping the tokens into sequences and saving them to file.</p>
<h3>Save Clean Text</h3>
<p>We can organize the long list of tokens into sequences of 50 input words and 1 output word.</p>
<p>That is, sequences of 51 words.</p>
<p>We can do this by iterating over the list of tokens from token 51 onwards and taking the prior 50 tokens as a sequence, then repeating this process to the end of the list of tokens.</p>
<p>We will transform the tokens into space-separated strings for later storage in a file.</p>
<p>The code to split the list of clean tokens into sequences with a length of 51 tokens is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9d3840849090" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# organize into sequences of tokens
length = 50 + 1
sequences = list()
for i in range(length, len(tokens)):
	# select sequence of tokens
	seq = tokens[i-length:i]
	# convert into a line
	line = ' '.join(seq)
	# store
	sequences.append(line)
print('Total Sequences: %d' % len(sequences))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d3840849090-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d3840849090-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d3840849090-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d3840849090-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d3840849090-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d3840849090-6">6</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d3840849090-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d3840849090-8">8</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d3840849090-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d3840849090-10">10</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d3840849090-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9d3840849090-1"><span class="crayon-p"># organize into sequences of tokens</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d3840849090-2"><span class="crayon-v">length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d3840849090-3"><span class="crayon-v">sequences</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d3840849090-4"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d3840849090-5"><span class="crayon-h"> </span><span class="crayon-p"># select sequence of tokens</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d3840849090-6"><span class="crayon-h"> </span><span class="crayon-v">seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">-</span><span class="crayon-v">length</span><span class="crayon-o">:</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d3840849090-7"><span class="crayon-h"> </span><span class="crayon-p"># convert into a line</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d3840849090-8"><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">' '</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">seq</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d3840849090-9"><span class="crayon-h"> </span><span class="crayon-p"># store</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d3840849090-10"><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">line</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d3840849090-11"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Total Sequences: %d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>Running this piece creates a long list of lines.</p>
<p>Printing statistics on the list, we can see that we will have exactly 118,633 training patterns to fit our model.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9d4122893080" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Total Sequences: 118633</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d4122893080-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9d4122893080-1">Total Sequences: 118633</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Next, we can save the sequences to a new file for later loading.</p>
<p>We can define a new function for saving lines of text to a file. This new function is called <em>save_doc()</em> and is listed below. It takes as input a list of lines and a filename. The lines are written, one per line, in ASCII format.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9d6014133908" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# save tokens to file, one dialog per line
def save_doc(lines, filename):
	data = '\n'.join(lines)
	file = open(filename, 'w')
	file.write(data)
	file.close()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d6014133908-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d6014133908-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d6014133908-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d6014133908-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d6014133908-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d6014133908-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9d6014133908-1"><span class="crayon-p"># save tokens to file, one dialog per line</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d6014133908-2"><span class="crayon-e">def </span><span class="crayon-e">save_doc</span><span class="crayon-sy">(</span><span class="crayon-v">lines</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d6014133908-3"><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'\n'</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">lines</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d6014133908-4"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'w'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d6014133908-5"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d6014133908-6"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>We can call this function and save our training sequences to the file ‘<em>republic_sequences.txt</em>‘.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9d8959790913" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# save sequences to file
out_filename = 'republic_sequences.txt'
save_doc(sequences, out_filename)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d8959790913-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d8959790913-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d8959790913-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9d8959790913-1"><span class="crayon-p"># save sequences to file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d8959790913-2"><span class="crayon-v">out_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'republic_sequences.txt'</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d8959790913-3"><span class="crayon-e">save_doc</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">out_filename</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Take a look at the file with your text editor.</p>
<p>You will see that each line is shifted along one word, with a new word at the end to be predicted; for example, here are the first 3 lines in truncated form:</p>
<blockquote><p>book i i … catch sight of<br/>
i i went … sight of us<br/>
i went down … of us from<br/>
…</p></blockquote>
<h3>Complete Example</h3>
<p>Tying all of this together, the complete code listing is provided below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9d9049879384" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
import string

# load doc into memory
def load_doc(filename):
	# open the file as read only
	file = open(filename, 'r')
	# read all text
	text = file.read()
	# close the file
	file.close()
	return text

# turn a doc into clean tokens
def clean_doc(doc):
	# replace '--' with a space ' '
	doc = doc.replace('--', ' ')
	# split into tokens by white space
	tokens = doc.split()
	# remove punctuation from each token
	table = str.maketrans('', '', string.punctuation)
	tokens = [w.translate(table) for w in tokens]
	# remove remaining tokens that are not alphabetic
	tokens = [word for word in tokens if word.isalpha()]
	# make lower case
	tokens = [word.lower() for word in tokens]
	return tokens

# save tokens to file, one dialog per line
def save_doc(lines, filename):
	data = '\n'.join(lines)
	file = open(filename, 'w')
	file.write(data)
	file.close()

# load document
in_filename = 'republic_clean.txt'
doc = load_doc(in_filename)
print(doc[:200])

# clean document
tokens = clean_doc(doc)
print(tokens[:200])
print('Total Tokens: %d' % len(tokens))
print('Unique Tokens: %d' % len(set(tokens)))

# organize into sequences of tokens
length = 50 + 1
sequences = list()
for i in range(length, len(tokens)):
	# select sequence of tokens
	seq = tokens[i-length:i]
	# convert into a line
	line = ' '.join(seq)
	# store
	sequences.append(line)
print('Total Sequences: %d' % len(sequences))

# save sequences to file
out_filename = 'republic_sequences.txt'
save_doc(sequences, out_filename)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-6">6</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-8">8</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-10">10</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-12">12</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-14">14</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-16">16</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-18">18</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-20">20</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-22">22</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-24">24</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-26">26</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-28">28</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-30">30</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-32">32</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-34">34</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-36">36</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-38">38</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-40">40</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-42">42</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-44">44</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-46">46</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-48">48</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-50">50</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-52">52</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-54">54</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-56">56</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-58">58</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9d9049879384-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9d9049879384-60">60</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-1"><span class="crayon-e">import </span><span class="crayon-t">string</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-2"> </div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-3"><span class="crayon-p"># load doc into memory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-4"><span class="crayon-e">def </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-5"><span class="crayon-h"> </span><span class="crayon-p"># open the file as read only</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-6"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-7"><span class="crayon-h"> </span><span class="crayon-p"># read all text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-8"><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-9"><span class="crayon-h"> </span><span class="crayon-p"># close the file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-10"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-11"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-12"> </div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-13"><span class="crayon-p"># turn a doc into clean tokens</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-14"><span class="crayon-e">def </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-15"><span class="crayon-h"> </span><span class="crayon-p"># replace '--' with a space ' '</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-16"><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">.</span><span class="crayon-e">replace</span><span class="crayon-sy">(</span><span class="crayon-s">'--'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">' '</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-17"><span class="crayon-h"> </span><span class="crayon-p"># split into tokens by white space</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-18"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-19"><span class="crayon-h"> </span><span class="crayon-p"># remove punctuation from each token</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-20"><span class="crayon-h"> </span><span class="crayon-v">table</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">str</span><span class="crayon-sy">.</span><span class="crayon-e">maketrans</span><span class="crayon-sy">(</span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">string</span><span class="crayon-sy">.</span><span class="crayon-v">punctuation</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-21"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">w</span><span class="crayon-sy">.</span><span class="crayon-e">translate</span><span class="crayon-sy">(</span><span class="crayon-v">table</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-22"><span class="crayon-h"> </span><span class="crayon-p"># remove remaining tokens that are not alphabetic</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-23"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-sy">.</span><span class="crayon-e">isalpha</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-24"><span class="crayon-h"> </span><span class="crayon-p"># make lower case</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-25"><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-sy">.</span><span class="crayon-e">lower</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-26"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-27"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-28"><span class="crayon-p"># save tokens to file, one dialog per line</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-29"><span class="crayon-e">def </span><span class="crayon-e">save_doc</span><span class="crayon-sy">(</span><span class="crayon-v">lines</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-30"><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'\n'</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">lines</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-31"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'w'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-32"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-33"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-34"> </div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-35"><span class="crayon-p"># load document</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-36"><span class="crayon-v">in_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'republic_clean.txt'</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-37"><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">in_filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-38"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">200</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-39"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-40"><span class="crayon-p"># clean document</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-41"><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-42"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">200</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-43"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Total Tokens: %d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-44"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Unique Tokens: %d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-45"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-46"><span class="crayon-p"># organize into sequences of tokens</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-47"><span class="crayon-v">length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-48"><span class="crayon-v">sequences</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-49"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-50"><span class="crayon-h"> </span><span class="crayon-p"># select sequence of tokens</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-51"><span class="crayon-h"> </span><span class="crayon-v">seq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">-</span><span class="crayon-v">length</span><span class="crayon-o">:</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-52"><span class="crayon-h"> </span><span class="crayon-p"># convert into a line</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-53"><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">' '</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">seq</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-54"><span class="crayon-h"> </span><span class="crayon-p"># store</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-55"><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">line</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-56"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Total Sequences: %d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-57"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-58"><span class="crayon-p"># save sequences to file</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9d9049879384-59"><span class="crayon-v">out_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'republic_sequences.txt'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9d9049879384-60"><span class="crayon-e">save_doc</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">out_filename</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0024 seconds] -->
<p>You should now have training data stored in the file ‘<em>republic_sequences.txt</em>‘ in your current working directory.</p>
<p>Next, let’s look at how to fit a language model to this data.</p>
<h2>Train Language Model</h2>
<p>We can now train a statistical language model from the prepared data.</p>
<p>The model we will train is a neural language model. It has a few unique characteristics:</p>
<ul>
<li>It uses a distributed representation for words so that different words with similar meanings will have a similar representation.</li>
<li>It learns the representation at the same time as learning the model.</li>
<li>It learns to predict the probability for the next word using the context of the last 100 words.</li>
</ul>
<p>Specifically, we will use an Embedding Layer to learn the representation of words, and a Long Short-Term Memory (LSTM) recurrent neural network to learn to predict words based on their context.</p>
<p>Let’s start by loading our training data.</p>
<h3>Load Sequences</h3>
<p>We can load our training data using the <em>load_doc()</em> function we developed in the previous section.</p>
<p>Once loaded, we can split the data into separate training sequences by splitting based on new lines.</p>
<p>The snippet below will load the ‘<em>republic_sequences.txt</em>‘ data file from the current working directory.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9e0351903850" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load doc into memory
def load_doc(filename):
	# open the file as read only
	file = open(filename, 'r')
	# read all text
	text = file.read()
	# close the file
	file.close()
	return text

# load
in_filename = 'republic_sequences.txt'
doc = load_doc(in_filename)
lines = doc.split('\n')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9e0351903850-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9e0351903850-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9e0351903850-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9e0351903850-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9e0351903850-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9e0351903850-6">6</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9e0351903850-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9e0351903850-8">8</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9e0351903850-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9e0351903850-10">10</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9e0351903850-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9e0351903850-12">12</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9e0351903850-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9e0351903850-14">14</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9e0351903850-1"><span class="crayon-p"># load doc into memory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9e0351903850-2"><span class="crayon-e">def </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9e0351903850-3"><span class="crayon-h"> </span><span class="crayon-p"># open the file as read only</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9e0351903850-4"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9e0351903850-5"><span class="crayon-h"> </span><span class="crayon-p"># read all text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9e0351903850-6"><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9e0351903850-7"><span class="crayon-h"> </span><span class="crayon-p"># close the file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9e0351903850-8"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9e0351903850-9"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9e0351903850-10"> </div><div class="crayon-line" id="crayon-5c0ca7a9ce9e0351903850-11"><span class="crayon-p"># load</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9e0351903850-12"><span class="crayon-v">in_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'republic_sequences.txt'</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9e0351903850-13"><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">in_filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9e0351903850-14"><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">'\n'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Next, we can encode the training data.</p>
<h3>Encode Sequences</h3>
<p>The word embedding layer expects input sequences to be comprised of integers.</p>
<p>We can map each word in our vocabulary to a unique integer and encode our input sequences. Later, when we make predictions, we can convert the prediction to numbers and look up their associated words in the same mapping.</p>
<p>To do this encoding, we will use the <a href="https://keras.io/preprocessing/text/#tokenizer">Tokenizer class</a> in the Keras API.</p>
<p>First, the Tokenizer must be trained on the entire training dataset, which means it finds all of the unique words in the data and assigns each a unique integer.</p>
<p>We can then use the fit Tokenizer to encode all of the training sequences, converting each sequence from a list of words to a list of integers.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9e3302257536" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# integer encode sequences of words
tokenizer = Tokenizer()
tokenizer.fit_on_texts(lines)
sequences = tokenizer.texts_to_sequences(lines)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9e3302257536-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9e3302257536-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9e3302257536-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9e3302257536-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9e3302257536-1"><span class="crayon-p"># integer encode sequences of words</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9e3302257536-2"><span class="crayon-v">tokenizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Tokenizer</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9e3302257536-3"><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">fit_on_texts</span><span class="crayon-sy">(</span><span class="crayon-v">lines</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9e3302257536-4"><span class="crayon-v">sequences</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">lines</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>We can access the mapping of words to integers as a dictionary attribute called word_index on the Tokenizer object.</p>
<p>We need to know the size of the vocabulary for defining the embedding layer later. We can determine the vocabulary by calculating the size of the mapping dictionary.</p>
<p>Words are assigned values from 1 to the total number of words (e.g. 7,409). The Embedding layer needs to allocate a vector representation for each word in this vocabulary from index 1 to the largest index and because indexing of arrays is zero-offset, the index of the word at the end of the vocabulary will be 7,409; that means the array must be 7,409 + 1 in length.</p>
<p>Therefore, when specifying the vocabulary size to the Embedding layer, we specify it as 1 larger than the actual vocabulary.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9e5841950340" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# vocabulary size
vocab_size = len(tokenizer.word_index) + 1</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9e5841950340-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9e5841950340-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9e5841950340-1"><span class="crayon-p"># vocabulary size</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9e5841950340-2"><span class="crayon-v">vocab_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-v">word_index</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h3>Sequence Inputs and Output</h3>
<p>Now that we have encoded the input sequences, we need to separate them into input (<em>X</em>) and output (<em>y</em>) elements.</p>
<p>We can do this with array slicing.</p>
<p>After separating, we need to one hot encode the output word. This means converting it from an integer to a vector of 0 values, one for each word in the vocabulary, with a 1 to indicate the specific word at the index of the words integer value.</p>
<p>This is so that the model learns to predict the probability distribution for the next word and the ground truth from which to learn from is 0 for all words except the actual word that comes next.</p>
<p>Keras provides the <em>to_categorical()</em> that can be used to one hot encode the output words for each input-output sequence pair.</p>
<p>Finally, we need to specify to the Embedding layer how long input sequences are. We know that there are 50 words because we designed the model, but a good generic way to specify that is to use the second dimension (number of columns) of the input data’s shape. That way, if you change the length of sequences when preparing data, you do not need to change this data loading code; it is generic.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9e6969643242" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# separate into input and output
sequences = array(sequences)
X, y = sequences[:,:-1], sequences[:,-1]
y = to_categorical(y, num_classes=vocab_size)
seq_length = X.shape[1]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9e6969643242-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9e6969643242-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9e6969643242-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9e6969643242-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9e6969643242-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9e6969643242-1"><span class="crayon-p"># separate into input and output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9e6969643242-2"><span class="crayon-v">sequences</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9e6969643242-3"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9e6969643242-4"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">num_classes</span><span class="crayon-o">=</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9e6969643242-5"><span class="crayon-v">seq_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<h3>Fit Model</h3>
<p>We can now define and fit our language model on the training data.</p>
<p>The learned embedding needs to know the size of the vocabulary and the length of input sequences as previously discussed. It also has a parameter to specify how many dimensions will be used to represent each word. That is, the size of the embedding vector space.</p>
<p>Common values are 50, 100, and 300. We will use 50 here, but consider testing smaller or larger values.</p>
<p>We will use a two LSTM hidden layers with 100 memory cells each. More memory cells and a deeper network may achieve better results.</p>
<p>A dense fully connected layer with 100 neurons connects to the LSTM hidden layers to interpret the features extracted from the sequence. The output layer predicts the next word as a single vector the size of the vocabulary with a probability for each word in the vocabulary. A softmax activation function is used to ensure the outputs have the characteristics of normalized probabilities.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9e8506853158" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# define model
model = Sequential()
model.add(Embedding(vocab_size, 50, input_length=seq_length))
model.add(LSTM(100, return_sequences=True))
model.add(LSTM(100))
model.add(Dense(100, activation='relu'))
model.add(Dense(vocab_size, activation='softmax'))
print(model.summary())</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9e8506853158-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9e8506853158-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9e8506853158-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9e8506853158-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9e8506853158-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9e8506853158-6">6</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9e8506853158-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9e8506853158-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9e8506853158-1"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9e8506853158-2"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9e8506853158-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">seq_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9e8506853158-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9e8506853158-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9e8506853158-6"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9e8506853158-7"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9e8506853158-8"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>A summary of the defined network is printed as a sanity check to ensure we have constructed what we intended.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9ea658986965" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
embedding_1 (Embedding)      (None, 50, 50)            370500
_________________________________________________________________
lstm_1 (LSTM)                (None, 50, 100)           60400
_________________________________________________________________
lstm_2 (LSTM)                (None, 100)               80400
_________________________________________________________________
dense_1 (Dense)              (None, 100)               10100
_________________________________________________________________
dense_2 (Dense)              (None, 7410)              748410
=================================================================
Total params: 1,269,810
Trainable params: 1,269,810
Non-trainable params: 0
_________________________________________________________________</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ea658986965-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9ea658986965-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ea658986965-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9ea658986965-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ea658986965-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9ea658986965-6">6</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ea658986965-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9ea658986965-8">8</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ea658986965-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9ea658986965-10">10</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ea658986965-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9ea658986965-12">12</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ea658986965-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9ea658986965-14">14</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ea658986965-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9ea658986965-16">16</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ea658986965-17">17</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9ea658986965-1">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9ea658986965-2">Layer (type)                 Output Shape              Param #</div><div class="crayon-line" id="crayon-5c0ca7a9ce9ea658986965-3">=================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9ea658986965-4">embedding_1 (Embedding)      (None, 50, 50)            370500</div><div class="crayon-line" id="crayon-5c0ca7a9ce9ea658986965-5">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9ea658986965-6">lstm_1 (LSTM)                (None, 50, 100)           60400</div><div class="crayon-line" id="crayon-5c0ca7a9ce9ea658986965-7">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9ea658986965-8">lstm_2 (LSTM)                (None, 100)               80400</div><div class="crayon-line" id="crayon-5c0ca7a9ce9ea658986965-9">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9ea658986965-10">dense_1 (Dense)              (None, 100)               10100</div><div class="crayon-line" id="crayon-5c0ca7a9ce9ea658986965-11">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9ea658986965-12">dense_2 (Dense)              (None, 7410)              748410</div><div class="crayon-line" id="crayon-5c0ca7a9ce9ea658986965-13">=================================================================</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9ea658986965-14">Total params: 1,269,810</div><div class="crayon-line" id="crayon-5c0ca7a9ce9ea658986965-15">Trainable params: 1,269,810</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9ea658986965-16">Non-trainable params: 0</div><div class="crayon-line" id="crayon-5c0ca7a9ce9ea658986965-17">_________________________________________________________________</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Next, the model is compiled specifying the categorical cross entropy loss needed to fit the model. Technically, the model is learning a multi-class classification and this is the suitable loss function for this type of problem. The efficient Adam implementation to mini-batch gradient descent is used and accuracy is evaluated of the model.</p>
<p>Finally, the model is fit on the data for 100 training epochs with a modest batch size of 128 to speed things up.</p>
<p>Training may take a few hours on modern hardware without GPUs. You can speed it up with a larger batch size and/or fewer training epochs.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9ec001730097" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# compile model
model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])
# fit model
model.fit(X, y, batch_size=128, epochs=100)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ec001730097-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9ec001730097-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ec001730097-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9ec001730097-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9ec001730097-1"><span class="crayon-p"># compile model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9ec001730097-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9ec001730097-3"><span class="crayon-p"># fit model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9ec001730097-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>During training, you will see a summary of performance, including the loss and accuracy evaluated from the training data at the end of each batch update.</p>
<p>You will get different results, but perhaps an accuracy of just over 50% of predicting the next word in the sequence, which is not bad. We are not aiming for 100% accuracy (e.g. a model that memorized the text), but rather a model that captures the essence of the text.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9ee926202442" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
...
Epoch 96/100
118633/118633 [==============================] - 265s - loss: 2.0324 - acc: 0.5187
Epoch 97/100
118633/118633 [==============================] - 265s - loss: 2.0136 - acc: 0.5247
Epoch 98/100
118633/118633 [==============================] - 267s - loss: 1.9956 - acc: 0.5262
Epoch 99/100
118633/118633 [==============================] - 266s - loss: 1.9812 - acc: 0.5291
Epoch 100/100
118633/118633 [==============================] - 270s - loss: 1.9709 - acc: 0.5315</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ee926202442-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9ee926202442-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ee926202442-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9ee926202442-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ee926202442-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9ee926202442-6">6</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ee926202442-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9ee926202442-8">8</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ee926202442-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9ee926202442-10">10</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ee926202442-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9ee926202442-1">...</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9ee926202442-2">Epoch 96/100</div><div class="crayon-line" id="crayon-5c0ca7a9ce9ee926202442-3">118633/118633 [==============================] - 265s - loss: 2.0324 - acc: 0.5187</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9ee926202442-4">Epoch 97/100</div><div class="crayon-line" id="crayon-5c0ca7a9ce9ee926202442-5">118633/118633 [==============================] - 265s - loss: 2.0136 - acc: 0.5247</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9ee926202442-6">Epoch 98/100</div><div class="crayon-line" id="crayon-5c0ca7a9ce9ee926202442-7">118633/118633 [==============================] - 267s - loss: 1.9956 - acc: 0.5262</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9ee926202442-8">Epoch 99/100</div><div class="crayon-line" id="crayon-5c0ca7a9ce9ee926202442-9">118633/118633 [==============================] - 266s - loss: 1.9812 - acc: 0.5291</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9ee926202442-10">Epoch 100/100</div><div class="crayon-line" id="crayon-5c0ca7a9ce9ee926202442-11">118633/118633 [==============================] - 270s - loss: 1.9709 - acc: 0.5315</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p></p>
<h3>Save Model</h3>
<p>At the end of the run, the trained model is saved to file.</p>
<p>Here, we use the Keras model API to save the model to the file ‘<em>model.h5</em>‘ in the current working directory.</p>
<p>Later, when we load the model to make predictions, we will also need the mapping of words to integers. This is in the Tokenizer object, and we can save that too using Pickle.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9f0366716758" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# save the model to file
model.save('model.h5')
# save the tokenizer
dump(tokenizer, open('tokenizer.pkl', 'wb'))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f0366716758-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f0366716758-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f0366716758-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f0366716758-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9f0366716758-1"><span class="crayon-p"># save the model to file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f0366716758-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">save</span><span class="crayon-sy">(</span><span class="crayon-s">'model.h5'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f0366716758-3"><span class="crayon-p"># save the tokenizer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f0366716758-4"><span class="crayon-e">dump</span><span class="crayon-sy">(</span><span class="crayon-v">tokenizer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">'tokenizer.pkl'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'wb'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<h3>Complete Example</h3>
<p>We can put all of this together; the complete example for fitting the language model is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9f2796154524" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from numpy import array
from pickle import dump
from keras.preprocessing.text import Tokenizer
from keras.utils import to_categorical
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
from keras.layers import Embedding

# load doc into memory
def load_doc(filename):
	# open the file as read only
	file = open(filename, 'r')
	# read all text
	text = file.read()
	# close the file
	file.close()
	return text

# load
in_filename = 'republic_sequences.txt'
doc = load_doc(in_filename)
lines = doc.split('\n')

# integer encode sequences of words
tokenizer = Tokenizer()
tokenizer.fit_on_texts(lines)
sequences = tokenizer.texts_to_sequences(lines)
# vocabulary size
vocab_size = len(tokenizer.word_index) + 1

# separate into input and output
sequences = array(sequences)
X, y = sequences[:,:-1], sequences[:,-1]
y = to_categorical(y, num_classes=vocab_size)
seq_length = X.shape[1]

# define model
model = Sequential()
model.add(Embedding(vocab_size, 50, input_length=seq_length))
model.add(LSTM(100, return_sequences=True))
model.add(LSTM(100))
model.add(Dense(100, activation='relu'))
model.add(Dense(vocab_size, activation='softmax'))
print(model.summary())
# compile model
model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])
# fit model
model.fit(X, y, batch_size=128, epochs=100)

# save the model to file
model.save('model.h5')
# save the tokenizer
dump(tokenizer, open('tokenizer.pkl', 'wb'))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-6">6</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-8">8</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-10">10</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-12">12</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-14">14</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-16">16</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-18">18</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-20">20</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-22">22</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-24">24</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-26">26</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-28">28</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-30">30</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-32">32</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-34">34</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-36">36</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-38">38</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-40">40</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-42">42</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-44">44</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-46">46</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-48">48</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-50">50</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-52">52</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f2796154524-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f2796154524-54">54</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-1"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-2"><span class="crayon-e">from </span><span class="crayon-e">pickle </span><span class="crayon-e">import </span><span class="crayon-e">dump</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">text </span><span class="crayon-e">import </span><span class="crayon-e">Tokenizer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">to_categorical</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-v">Embedding</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-9"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-10"><span class="crayon-p"># load doc into memory</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-11"><span class="crayon-e">def </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-12"><span class="crayon-h"> </span><span class="crayon-p"># open the file as read only</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-13"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-14"><span class="crayon-h"> </span><span class="crayon-p"># read all text</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-15"><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-16"><span class="crayon-h"> </span><span class="crayon-p"># close the file</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-17"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-18"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">text</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-19"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-20"><span class="crayon-p"># load</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-21"><span class="crayon-v">in_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'republic_sequences.txt'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-22"><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">in_filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-23"><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">'\n'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-24"> </div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-25"><span class="crayon-p"># integer encode sequences of words</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-26"><span class="crayon-v">tokenizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Tokenizer</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-27"><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">fit_on_texts</span><span class="crayon-sy">(</span><span class="crayon-v">lines</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-28"><span class="crayon-v">sequences</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">lines</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-29"><span class="crayon-p"># vocabulary size</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-30"><span class="crayon-v">vocab_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-v">word_index</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-31"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-32"><span class="crayon-p"># separate into input and output</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-33"><span class="crayon-v">sequences</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">sequences</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-34"><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sequences</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-35"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">num_classes</span><span class="crayon-o">=</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-36"><span class="crayon-v">seq_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-37"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-38"><span class="crayon-p"># define model</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-39"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-40"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">seq_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-41"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-42"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-43"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-44"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-45"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-46"><span class="crayon-p"># compile model</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-47"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-48"><span class="crayon-p"># fit model</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-49"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-50"> </div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-51"><span class="crayon-p"># save the model to file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-52"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">save</span><span class="crayon-sy">(</span><span class="crayon-s">'model.h5'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f2796154524-53"><span class="crayon-p"># save the tokenizer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f2796154524-54"><span class="crayon-e">dump</span><span class="crayon-sy">(</span><span class="crayon-v">tokenizer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">'tokenizer.pkl'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'wb'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0023 seconds] -->
<p></p>
<h2>Use Language Model</h2>
<p>Now that we have a trained language model, we can use it.</p>
<p>In this case, we can use it to generate new sequences of text that have the same statistical properties as the source text.</p>
<p>This is not practical, at least not for this example, but it gives a concrete example of what the language model has learned.</p>
<p>We will start by loading the training sequences again.</p>
<h3>Load Data</h3>
<p>We can use the same code from the previous section to load the training data sequences of text.</p>
<p>Specifically, the <em>load_doc()</em> function.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9f3030291214" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load doc into memory
def load_doc(filename):
	# open the file as read only
	file = open(filename, 'r')
	# read all text
	text = file.read()
	# close the file
	file.close()
	return text

# load cleaned text sequences
in_filename = 'republic_sequences.txt'
doc = load_doc(in_filename)
lines = doc.split('\n')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f3030291214-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f3030291214-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f3030291214-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f3030291214-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f3030291214-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f3030291214-6">6</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f3030291214-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f3030291214-8">8</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f3030291214-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f3030291214-10">10</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f3030291214-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f3030291214-12">12</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f3030291214-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f3030291214-14">14</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9f3030291214-1"><span class="crayon-p"># load doc into memory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f3030291214-2"><span class="crayon-e">def </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f3030291214-3"><span class="crayon-h"> </span><span class="crayon-p"># open the file as read only</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f3030291214-4"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f3030291214-5"><span class="crayon-h"> </span><span class="crayon-p"># read all text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f3030291214-6"><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f3030291214-7"><span class="crayon-h"> </span><span class="crayon-p"># close the file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f3030291214-8"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f3030291214-9"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f3030291214-10"> </div><div class="crayon-line" id="crayon-5c0ca7a9ce9f3030291214-11"><span class="crayon-p"># load cleaned text sequences</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f3030291214-12"><span class="crayon-v">in_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'republic_sequences.txt'</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9f3030291214-13"><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">in_filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f3030291214-14"><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">'\n'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>We need the text so that we can choose a source sequence as input to the model for generating a new sequence of text.</p>
<p>The model will require 100 words as input.</p>
<p>Later, we will need to specify the expected length of input. We can determine this from the input sequences by calculating the length of one line of the loaded data and subtracting 1 for the expected output word that is also on the same line.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9f5432387530" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
seq_length = len(lines[0].split()) - 1</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f5432387530-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9f5432387530-1"><span class="crayon-v">seq_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">lines</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<h3>Load Model</h3>
<p>We can now load the model from file.</p>
<p>Keras provides the <em>load_model()</em> function for loading the model, ready for use.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9f7521381015" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load the model
model = load_model('model.h5')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f7521381015-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f7521381015-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9f7521381015-1"><span class="crayon-p"># load the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f7521381015-2"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_model</span><span class="crayon-sy">(</span><span class="crayon-s">'model.h5'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can also load the tokenizer from file using the Pickle API.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9f8938894297" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load the tokenizer
tokenizer = load(open('tokenizer.pkl', 'rb'))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9f8938894297-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9f8938894297-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9f8938894297-1"><span class="crayon-p"># load the tokenizer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9f8938894297-2"><span class="crayon-v">tokenizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">'tokenizer.pkl'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'rb'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We are ready to use the loaded model.</p>
<h3>Generate Text</h3>
<p>The first step in generating text is preparing a seed input.</p>
<p>We will select a random line of text from the input text for this purpose. Once selected, we will print it so that we have some idea of what was used.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9fa665194464" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# select a seed text
seed_text = lines[randint(0,len(lines))]
print(seed_text + '\n')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9fa665194464-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9fa665194464-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9fa665194464-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9fa665194464-1"><span class="crayon-p"># select a seed text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9fa665194464-2"><span class="crayon-v">seed_text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-sy">[</span><span class="crayon-e">randint</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">lines</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9fa665194464-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">seed_text</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'\n'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Next, we can generate new words, one at a time.</p>
<p>First, the seed text must be encoded to integers using the same tokenizer that we used when training the model.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9fb535055016" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
encoded = tokenizer.texts_to_sequences([seed_text])[0]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9fb535055016-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9fb535055016-1"><span class="crayon-v">encoded</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_sequences</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">seed_text</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The model can predict the next word directly by calling <em>model.predict_classes()</em> that will return the index of the word with the highest probability.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9fd651757097" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# predict probabilities for each word
yhat = model.predict_classes(encoded, verbose=0)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9fd651757097-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9fd651757097-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9fd651757097-1"><span class="crayon-p"># predict probabilities for each word</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9fd651757097-2"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict_classes</span><span class="crayon-sy">(</span><span class="crayon-v">encoded</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>We can then look up the index in the Tokenizers mapping to get the associated word.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9ce9ff108143335" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
out_word = ''
for word, index in tokenizer.word_index.items():
	if index == yhat:
		out_word = word
		break</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ff108143335-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9ff108143335-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ff108143335-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9ce9ff108143335-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7a9ce9ff108143335-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9ce9ff108143335-1"><span class="crayon-v">out_word</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">''</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9ff108143335-2"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">index </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-v">word_index</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9ff108143335-3"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9ce9ff108143335-4"><span class="crayon-h"> </span><span class="crayon-v">out_word</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">word</span></div><div class="crayon-line" id="crayon-5c0ca7a9ce9ff108143335-5"><span class="crayon-h"> </span><span class="crayon-st">break</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>We can then append this word to the seed text and repeat the process.</p>
<p>Importantly, the input sequence is going to get too long. We can truncate it to the desired length after the input sequence has been encoded to integers. Keras provides the <em>pad_sequences()</em> function that we can use to perform this truncation.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9cea00484761780" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
encoded = pad_sequences([encoded], maxlen=seq_length, truncating='pre')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9cea00484761780-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9cea00484761780-1"><span class="crayon-v">encoded</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">encoded</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">seq_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">truncating</span><span class="crayon-o">=</span><span class="crayon-s">'pre'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>We can wrap all of this into a function called <em>generate_seq()</em> that takes as input the model, the tokenizer, input sequence length, the seed text, and the number of words to generate. It then returns a sequence of words generated by the model.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9cea02191070798" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# generate a sequence from a language model
def generate_seq(model, tokenizer, seq_length, seed_text, n_words):
	result = list()
	in_text = seed_text
	# generate a fixed number of words
	for _ in range(n_words):
		# encode the text as integer
		encoded = tokenizer.texts_to_sequences([in_text])[0]
		# truncate sequences to a fixed length
		encoded = pad_sequences([encoded], maxlen=seq_length, truncating='pre')
		# predict probabilities for each word
		yhat = model.predict_classes(encoded, verbose=0)
		# map predicted word index to word
		out_word = ''
		for word, index in tokenizer.word_index.items():
			if index == yhat:
				out_word = word
				break
		# append to input
		in_text += ' ' + out_word
		result.append(out_word)
	return ' '.join(result)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9cea02191070798-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea02191070798-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea02191070798-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea02191070798-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea02191070798-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea02191070798-6">6</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea02191070798-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea02191070798-8">8</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea02191070798-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea02191070798-10">10</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea02191070798-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea02191070798-12">12</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea02191070798-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea02191070798-14">14</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea02191070798-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea02191070798-16">16</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea02191070798-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea02191070798-18">18</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea02191070798-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea02191070798-20">20</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea02191070798-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea02191070798-22">22</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9cea02191070798-1"><span class="crayon-p"># generate a sequence from a language model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea02191070798-2"><span class="crayon-e">def </span><span class="crayon-e">generate_seq</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seed_text</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_words</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea02191070798-3"><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea02191070798-4"><span class="crayon-h"> </span><span class="crayon-v">in_text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">seed_text</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea02191070798-5"><span class="crayon-h"> </span><span class="crayon-p"># generate a fixed number of words</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea02191070798-6"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_words</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea02191070798-7"><span class="crayon-h"> </span><span class="crayon-p"># encode the text as integer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea02191070798-8"><span class="crayon-h"> </span><span class="crayon-v">encoded</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_sequences</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">in_text</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea02191070798-9"><span class="crayon-h"> </span><span class="crayon-p"># truncate sequences to a fixed length</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea02191070798-10"><span class="crayon-h"> </span><span class="crayon-v">encoded</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">encoded</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">seq_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">truncating</span><span class="crayon-o">=</span><span class="crayon-s">'pre'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea02191070798-11"><span class="crayon-h"> </span><span class="crayon-p"># predict probabilities for each word</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea02191070798-12"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict_classes</span><span class="crayon-sy">(</span><span class="crayon-v">encoded</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea02191070798-13"><span class="crayon-h"> </span><span class="crayon-p"># map predicted word index to word</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea02191070798-14"><span class="crayon-h"> </span><span class="crayon-v">out_word</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">''</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea02191070798-15"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">index </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-v">word_index</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea02191070798-16"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea02191070798-17"><span class="crayon-h"> </span><span class="crayon-v">out_word</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">word</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea02191070798-18"><span class="crayon-h"> </span><span class="crayon-st">break</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea02191070798-19"><span class="crayon-h"> </span><span class="crayon-p"># append to input</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea02191070798-20"><span class="crayon-h"> </span><span class="crayon-v">in_text</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">' '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">out_word</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea02191070798-21"><span class="crayon-e"> </span><span class="crayon-v">result</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">out_word</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea02191070798-22"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">' '</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>We are now ready to generate a sequence of new words given some seed text.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9cea03367989793" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# generate new text
generated = generate_seq(model, tokenizer, seq_length, seed_text, 50)
print(generated)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9cea03367989793-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea03367989793-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea03367989793-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9cea03367989793-1"><span class="crayon-p"># generate new text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea03367989793-2"><span class="crayon-v">generated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_seq</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seed_text</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea03367989793-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">generated</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Putting this all together, the complete code listing for generating text from the learned-language model is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9cea05775077370" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from random import randint
from pickle import load
from keras.models import load_model
from keras.preprocessing.sequence import pad_sequences

# load doc into memory
def load_doc(filename):
	# open the file as read only
	file = open(filename, 'r')
	# read all text
	text = file.read()
	# close the file
	file.close()
	return text

# generate a sequence from a language model
def generate_seq(model, tokenizer, seq_length, seed_text, n_words):
	result = list()
	in_text = seed_text
	# generate a fixed number of words
	for _ in range(n_words):
		# encode the text as integer
		encoded = tokenizer.texts_to_sequences([in_text])[0]
		# truncate sequences to a fixed length
		encoded = pad_sequences([encoded], maxlen=seq_length, truncating='pre')
		# predict probabilities for each word
		yhat = model.predict_classes(encoded, verbose=0)
		# map predicted word index to word
		out_word = ''
		for word, index in tokenizer.word_index.items():
			if index == yhat:
				out_word = word
				break
		# append to input
		in_text += ' ' + out_word
		result.append(out_word)
	return ' '.join(result)

# load cleaned text sequences
in_filename = 'republic_sequences.txt'
doc = load_doc(in_filename)
lines = doc.split('\n')
seq_length = len(lines[0].split()) - 1

# load the model
model = load_model('model.h5')

# load the tokenizer
tokenizer = load(open('tokenizer.pkl', 'rb'))

# select a seed text
seed_text = lines[randint(0,len(lines))]
print(seed_text + '\n')

# generate new text
generated = generate_seq(model, tokenizer, seq_length, seed_text, 50)
print(generated)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-6">6</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-8">8</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-10">10</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-12">12</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-14">14</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-16">16</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-18">18</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-20">20</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-22">22</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-24">24</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-26">26</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-28">28</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-30">30</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-32">32</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-34">34</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-36">36</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-38">38</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-40">40</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-42">42</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-44">44</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-46">46</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-48">48</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-50">50</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-52">52</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-54">54</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9cea05775077370-56">56</div><div class="crayon-num" data-line="crayon-5c0ca7a9cea05775077370-57">57</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-1"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randint</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-2"><span class="crayon-e">from </span><span class="crayon-e">pickle </span><span class="crayon-e">import </span><span class="crayon-e">load</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">load_model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">sequence </span><span class="crayon-e">import </span><span class="crayon-v">pad_sequences</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-5"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-6"><span class="crayon-p"># load doc into memory</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-7"><span class="crayon-e">def </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-8"><span class="crayon-h"> </span><span class="crayon-p"># open the file as read only</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-9"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-10"><span class="crayon-h"> </span><span class="crayon-p"># read all text</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-11"><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-12"><span class="crayon-h"> </span><span class="crayon-p"># close the file</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-13"><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-14"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">text</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-15"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-16"><span class="crayon-p"># generate a sequence from a language model</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-17"><span class="crayon-e">def </span><span class="crayon-e">generate_seq</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seed_text</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_words</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-18"><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-19"><span class="crayon-h"> </span><span class="crayon-v">in_text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">seed_text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-20"><span class="crayon-h"> </span><span class="crayon-p"># generate a fixed number of words</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-21"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_words</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-22"><span class="crayon-h"> </span><span class="crayon-p"># encode the text as integer</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-23"><span class="crayon-h"> </span><span class="crayon-v">encoded</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_sequences</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">in_text</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-24"><span class="crayon-h"> </span><span class="crayon-p"># truncate sequences to a fixed length</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-25"><span class="crayon-h"> </span><span class="crayon-v">encoded</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">encoded</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">seq_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">truncating</span><span class="crayon-o">=</span><span class="crayon-s">'pre'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-26"><span class="crayon-h"> </span><span class="crayon-p"># predict probabilities for each word</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-27"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict_classes</span><span class="crayon-sy">(</span><span class="crayon-v">encoded</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-28"><span class="crayon-h"> </span><span class="crayon-p"># map predicted word index to word</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-29"><span class="crayon-h"> </span><span class="crayon-v">out_word</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">''</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-30"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">index </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-v">word_index</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-31"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-32"><span class="crayon-h"> </span><span class="crayon-v">out_word</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">word</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-33"><span class="crayon-h"> </span><span class="crayon-st">break</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-34"><span class="crayon-h"> </span><span class="crayon-p"># append to input</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-35"><span class="crayon-h"> </span><span class="crayon-v">in_text</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-s">' '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">out_word</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-36"><span class="crayon-e"> </span><span class="crayon-v">result</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">out_word</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-37"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">' '</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-38"> </div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-39"><span class="crayon-p"># load cleaned text sequences</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-40"><span class="crayon-v">in_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'republic_sequences.txt'</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-41"><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">in_filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-42"><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">'\n'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-43"><span class="crayon-v">seq_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">lines</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-44"> </div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-45"><span class="crayon-p"># load the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-46"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_model</span><span class="crayon-sy">(</span><span class="crayon-s">'model.h5'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-47"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-48"><span class="crayon-p"># load the tokenizer</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-49"><span class="crayon-v">tokenizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">'tokenizer.pkl'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'rb'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-50"> </div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-51"><span class="crayon-p"># select a seed text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-52"><span class="crayon-v">seed_text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-sy">[</span><span class="crayon-e">randint</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">lines</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-53"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">seed_text</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'\n'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-54"> </div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-55"><span class="crayon-p"># generate new text</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9cea05775077370-56"><span class="crayon-v">generated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">generate_seq</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seq_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">seed_text</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7a9cea05775077370-57"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">generated</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0023 seconds] -->
<p>Running the example first prints the seed text.</p>
<blockquote><p>when he said that a man when he grows old may learn many things for he can no more learn much than he can run much youth is the time for any extraordinary toil of course and therefore calculation and geometry and all the other elements of instruction which are a</p></blockquote>
<p>Then 50 words of generated text are printed.</p>
<blockquote><p>preparation for dialectic should be presented to the name of idle spendthrifts of whom the other is the manifold and the unjust and is the best and the other which delighted to be the opening of the soul of the soul and the embroiderer will have to be said at</p></blockquote>
<p>You will get different results. Try running the generation piece a few times.</p>
<p>You can see that the text seems reasonable. In fact, the addition of concatenation would help in interpreting the seed and the generated text. Nevertheless, the generated text gets the right kind of words in the right kind of order.</p>
<p>Try running the example a few times to see other examples of generated text. Let me know in the comments below if you see anything interesting.</p>
<h2>Extensions</h2>
<p>This section lists some ideas for extending the tutorial that you may wish to explore.</p>
<ul>
<li><strong>Sentence-Wise Model</strong>. Split the raw data based on sentences and pad each sentence to a fixed length (e.g. the longest sentence length).</li>
<li><strong>Simplify Vocabulary</strong>. Explore a simpler vocabulary, perhaps with stemmed words or stop words removed.</li>
<li><strong>Tune Model</strong>. Tune the model, such as the size of the embedding or number of memory cells in the hidden layer, to see if you can develop a better model.</li>
<li><strong>Deeper Model</strong>. Extend the model to have multiple LSTM hidden layers, perhaps with dropout to see if you can develop a better model.</li>
<li><strong>Pre-Trained Word Embedding</strong>. Extend the model to use pre-trained word2vec or GloVe vectors to see if it results in a better model.</li>
</ul>
<h2>Further Reading</h2>
<p>This section provides more resources on the topic if you are looking go deeper.</p>
<ul>
<li><a href="https://www.gutenberg.org/">Project Gutenberg</a></li>
<li><a href="https://www.gutenberg.org/ebooks/1497">The Republic by Plato on Project Gutenberg</a></li>
<li><a href="https://en.wikipedia.org/wiki/Republic_(Plato)">Republic (Plato) on Wikipedia</a></li>
<li><a href="https://en.wikipedia.org/wiki/Language_model">Language model on Wikipedia</a></li>
</ul>
<h2>Summary</h2>
<p>In this tutorial, you discovered how to develop a word-based language model using a word embedding and a recurrent neural network.</p>
<p>Specifically, you learned:</p>
<ul>
<li>How to prepare text for developing a word-based language model.</li>
<li>How to design and fit a neural language model with a learned embedding and an LSTM hidden layer.</li>
<li>How to use the learned language model to generate new text with similar statistical properties as the source text.</li>
</ul>
<p>Do you have any questions?<br/>
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="awac-wrapper"><div class="awac widget text-42"> <div class="textwidget"><p></p><center><br/>
<div class="woo-sc-hr"></div>
<h2>Develop Deep Learning models for Text Data Today!</h2>
<p><a href="/deep-learning-for-nlp/"><img align="left" alt="Deep Learning for Natural Language Processing" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/11/DLFNLP-Cover-220.png" style="border: 0;"/></a></p>
<h4>Develop Your Own Text models in Minutes</h4>
<p>…with just a few lines of python code</p>
<p>Discover how in my new Ebook:<br/>
<a href="/deep-learning-for-nlp/">Deep Learning for Natural Language Processing</a></p>
<p>It provides <strong>self-study tutorials</strong> on topics like:<br/>
<em>Bag-of-Words, Word Embedding, Language Models, Caption Generation, Text Translation</em> and much more…</p>
<h4>Finally Bring Deep Learning to your Natural Language Processing Projects</h4>
<p>Skip the Academics. Just Results.</p>
<p><a href="/deep-learning-for-nlp/">Click to learn more</a>.<br/>
</p><div class="woo-sc-hr"></div><br/>
</center>
</div>
</div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-4422 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Develop+a+Word-Level+Neural+Language+Model+and+Use+it+to+Generate+Text&amp;url=https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
</section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/use-pre-trained-vgg-model-classify-objects-photographs/" rel="prev"><i class="fa fa-angle-left"></i> How to Use The Pre-Trained VGG Model to Classify Objects in Photographs</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/how-to-caption-photos-with-deep-learning/" rel="next">How to Automatically Generate Textual Descriptions for Photographs with Deep Learning <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">108 Responses to <em>How to Develop a Word-Level Neural Language Model and Use it to Generate Text</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-419601">
<div class="comment-container" id="li-comment-419601">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8883b85d75154d13baedd0fbaa58237e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8883b85d75154d13baedd0fbaa58237e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">nike</span>
<span class="date">November 10, 2017 at 12:59 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-419601" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for providing this blog,  have u use rnn to do recommend ? like use rnn recommend  movies ,use the user consume movies sequences</p>
<div class="reply">
<a aria-label="Reply to nike" class="comment-reply-link" href="#comment-419601" onclick='return addComment.moveForm( "comment-419601", "419601", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-419690">
<div class="comment-container" id="li-comment-419690">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 11, 2017 at 9:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-419690" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have not used RNNs for recommender systems, sorry.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-419690" onclick='return addComment.moveForm( "comment-419690", "419690", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-419666">
<div class="comment-container" id="li-comment-419666">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/310ec5cc18a21241cb80e0eeeb8f81a4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/310ec5cc18a21241cb80e0eeeb8f81a4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Stuart</span>
<span class="date">November 11, 2017 at 6:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-419666" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Outstanding article, thank you!  Two questions:</p>
<p>1.  How much benefit is gained by removing punctuation?  Wouldn’t a few more punctuation-based tokens be a fairly trivial addition to several thousand word tokens?</p>
<p>2.  Based on your experience, which method would you say is better at generating meaningful text on modest hardware (the cheaper gpu AWS options) in a reasonable amount of time (within several hours):  word-level or character-level generation?</p>
<p>Also it would be great if you could include your hardware setup, python/keras versions, and how long it took to generate your example text output.</p>
<div class="reply">
<a aria-label="Reply to Stuart" class="comment-reply-link" href="#comment-419666" onclick='return addComment.moveForm( "comment-419666", "419666", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-419705">
<div class="comment-container" id="li-comment-419705">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 11, 2017 at 9:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-419705" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good questions.</p>
<p>Test and see, I expect the vocab drops by close to half.</p>
<p>AWS is good value for money for one-off models. I strongly recommend it:<br/>
<a href="https://machinelearningmastery.com/develop-evaluate-large-deep-learning-models-keras-amazon-web-services/" rel="nofollow">https://machinelearningmastery.com/develop-evaluate-large-deep-learning-models-keras-amazon-web-services/</a></p>
<p>I have a big i7 imac for local dev and run large models/experiments on AWS.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-419705" onclick='return addComment.moveForm( "comment-419705", "419705", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-419714">
<div class="comment-container" id="li-comment-419714">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/310ec5cc18a21241cb80e0eeeb8f81a4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/310ec5cc18a21241cb80e0eeeb8f81a4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Stuart</span>
<span class="date">November 11, 2017 at 10:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-419714" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>what do you mean “vocab drops by close to half” ?</p>
<div class="reply">
<a aria-label="Reply to Stuart" class="comment-reply-link" href="#comment-419714" onclick='return addComment.moveForm( "comment-419714", "419714", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-419788">
<div class="comment-container" id="li-comment-419788">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 12, 2017 at 8:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-419788" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I mean that removing punctuation such as full stops and commas from the end of words will mean that we have fewer tokens to model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-419788" onclick='return addComment.moveForm( "comment-419788", "419788", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-419835">
<div class="comment-container" id="li-comment-419835">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ee5b75a7806ae6b47b552a9fc8954a7c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ee5b75a7806ae6b47b552a9fc8954a7c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://-" rel="external nofollow">Raoul</a></span>
<span class="date">November 12, 2017 at 11:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-419835" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great tutorial and thank you for sharing!</p>
<p>Am I correct in assuming that the model always spits out the same output text given a specific seed text?</p>
<div class="reply">
<a aria-label="Reply to Raoul" class="comment-reply-link" href="#comment-419835" onclick='return addComment.moveForm( "comment-419835", "419835", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-419874">
<div class="comment-container" id="li-comment-419874">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 13, 2017 at 10:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-419874" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>A trained model will, yes. The model will be different each time it is trained though:<br/>
<a href="https://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">https://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-419874" onclick='return addComment.moveForm( "comment-419874", "419874", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-419839">
<div class="comment-container" id="li-comment-419839">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3eb036cdf682692db6b33f584908a35b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3eb036cdf682692db6b33f584908a35b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sarang</span>
<span class="date">November 13, 2017 at 1:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-419839" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason,</p>
<p>Thanks for the excellent blogs, what do you think about the future of deep learning?<br/>
Do you think deep learning is here to stay for another 10 years?</p>
<div class="reply">
<a aria-label="Reply to Sarang" class="comment-reply-link" href="#comment-419839" onclick='return addComment.moveForm( "comment-419839", "419839", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-419877">
<div class="comment-container" id="li-comment-419877">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 13, 2017 at 10:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-419877" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes. The results are too valuable across a wide set of domains.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-419877" onclick='return addComment.moveForm( "comment-419877", "419877", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-425531">
<div class="comment-container" id="li-comment-425531">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/efb9055581b295947992c3eb1f119e76?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/efb9055581b295947992c3eb1f119e76?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Roger</span>
<span class="date">January 3, 2018 at 8:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-425531" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, great blog!<br/>
Still, I got a question when running “model.add(LSTM(100, return_sequences=True))”.<br/>
TypeError: Expected int32, got list containing Tensors of type ‘_Message’ instead.<br/>
Could you please help? Thanks.</p>
<div class="reply">
<a aria-label="Reply to Roger" class="comment-reply-link" href="#comment-425531" onclick='return addComment.moveForm( "comment-425531", "425531", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-425532">
<div class="comment-container" id="li-comment-425532">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/efb9055581b295947992c3eb1f119e76?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/efb9055581b295947992c3eb1f119e76?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Roger</span>
<span class="date">January 3, 2018 at 9:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-425532" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>by the way I am using os system, py3.5</p>
<div class="reply">
<a aria-label="Reply to Roger" class="comment-reply-link" href="#comment-425532" onclick='return addComment.moveForm( "comment-425532", "425532", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-425633">
<div class="comment-container" id="li-comment-425633">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dde46a6564ea1473ed34e07a2dc5bf3c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dde46a6564ea1473ed34e07a2dc5bf3c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kirstie</span>
<span class="date">January 5, 2018 at 1:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-425633" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Roger.  I had the same issue, updating Tensorflow with pip install –upgrade Tensorflow worked for me.</p>
<div class="reply">
<a aria-label="Reply to Kirstie" class="comment-reply-link" href="#comment-425633" onclick='return addComment.moveForm( "comment-425633", "425633", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-425577">
<div class="comment-container" id="li-comment-425577">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 4, 2018 at 8:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-425577" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry I have not seen this error before. Perhaps try posting to stackoverflow?</p>
<p>It may be the version of your libraries? Ensure everything is up to date.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425577" onclick='return addComment.moveForm( "comment-425577", "425577", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-425882">
<div class="comment-container" id="li-comment-425882">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/efb9055581b295947992c3eb1f119e76?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/efb9055581b295947992c3eb1f119e76?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Roger</span>
<span class="date">January 8, 2018 at 6:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-425882" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Is it possible to use your codes above as a language model instead of predicting next word?<br/>
What I want is to judge “I am eating an apple” is more commonly used than “I an apple am eating”.<br/>
For short sentence, may be I don’t have 50 words as input.<br/>
Also, is it possible for Keras to output the probability with its index like the biggest probability for next word is “republic” and I want to get the index for “republic” which can be matched in tokenizer.word_index.<br/>
Thanks!</p>
<div class="reply">
<a aria-label="Reply to Roger" class="comment-reply-link" href="#comment-425882" onclick='return addComment.moveForm( "comment-425882", "425882", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-425887">
<div class="comment-container" id="li-comment-425887">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/efb9055581b295947992c3eb1f119e76?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/efb9055581b295947992c3eb1f119e76?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Roger</span>
<span class="date">January 8, 2018 at 8:53 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-425887" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>do you have any suggestions if I want to use 3 previous words as input to predict next word? Thanks.</p>
<div class="reply">
<a aria-label="Reply to Roger" class="comment-reply-link" href="#comment-425887" onclick='return addComment.moveForm( "comment-425887", "425887", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-3" id="comment-425914">
<div class="comment-container" id="li-comment-425914">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 9, 2018 at 5:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-425914" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can frame your problem, prepare the data and train the model.</p>
<p>3 words as input might not be enough.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425914" onclick='return addComment.moveForm( "comment-425914", "425914", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-425911">
<div class="comment-container" id="li-comment-425911">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 9, 2018 at 5:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-425911" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not sure about your application sorry.</p>
<p>Keras can predict probabilities across the vocabulary and you can use argmax() to get the index of the word with the largest probability.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425911" onclick='return addComment.moveForm( "comment-425911", "425911", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-429362">
<div class="comment-container" id="li-comment-429362">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/64f838c10447e148ed7ccf078414dcea?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/64f838c10447e148ed7ccf078414dcea?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Cid</span>
<span class="date">February 14, 2018 at 3:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-429362" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,<br/>
Thanks for the post. I noticed in the extensions part you mention Sentence-Wise Modelling.<br/>
I understand the technique of padding (after reading your other blog post). But how does it incorporate a full stop when generating text. Is it a matter of post-processing the text? Could it be possible/more convenient to tokenize a full stop prior to embedding?</p>
<div class="reply">
<a aria-label="Reply to Cid" class="comment-reply-link" href="#comment-429362" onclick='return addComment.moveForm( "comment-429362", "429362", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-429392">
<div class="comment-container" id="li-comment-429392">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 14, 2018 at 8:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-429392" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I generally recommend removing punctuation. It balloons the size of the vocab and in turn slows down modeling.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-429392" onclick='return addComment.moveForm( "comment-429392", "429392", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-429467">
<div class="comment-container" id="li-comment-429467">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/64f838c10447e148ed7ccf078414dcea?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/64f838c10447e148ed7ccf078414dcea?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Cid</span>
<span class="date">February 14, 2018 at 8:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-429467" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>OK thanks for the advise, how could I incorporate a sentence structure into my model then?</p>
<div class="reply">
<a aria-label="Reply to Cid" class="comment-reply-link" href="#comment-429467" onclick='return addComment.moveForm( "comment-429467", "429467", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-429543">
<div class="comment-container" id="li-comment-429543">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 15, 2018 at 8:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-429543" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Each sentence could be one “sample” or sequence of words as input.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-429543" onclick='return addComment.moveForm( "comment-429543", "429543", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-429712">
<div class="comment-container" id="li-comment-429712">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7e1498a61f0eb8794da962fbd2a3c241?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7e1498a61f0eb8794da962fbd2a3c241?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Maria</span>
<span class="date">February 16, 2018 at 10:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-429712" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, I tried to use your model and train it with a corpus I had, everything seemed to work fine, but at the and I have this error:<br/>
34 sequences = array(sequences)<br/>
     35 #print(sequences)<br/>
—&gt; 36 X, y = sequences[:,:-1], sequences[:,-1]<br/>
     37 # print(sequences[:,:-1])<br/>
     38 # X, y = sequences[:-1], sequences[-1]</p>
<p>IndexError: too many indices for array</p>
<p>regarding the sliding of the sequences. Do you know how to fix it?<br/>
Thanks so much!</p>
<div class="reply">
<a aria-label="Reply to Maria" class="comment-reply-link" href="#comment-429712" onclick='return addComment.moveForm( "comment-429712", "429712", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-429753">
<div class="comment-container" id="li-comment-429753">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 17, 2018 at 8:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-429753" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps double check your loaded data has the shape that you expect?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-429753" onclick='return addComment.moveForm( "comment-429753", "429753", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-430799">
<div class="comment-container" id="li-comment-430799">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/80e7eae9c688acb983543c9cb1ffce8d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/80e7eae9c688acb983543c9cb1ffce8d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ray</span>
<span class="date">March 1, 2018 at 7:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-430799" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason and Maria.<br/>
I am having the exact same problem too.<br/>
I was hoping Jason might have better suggestion<br/>
here is the error:</p>
<p>IndexError                                Traceback (most recent call last)<br/>
 in ()<br/>
      1 # separate into input and output<br/>
      2 sequences = array(sequences)<br/>
—-&gt; 3 X, y = sequences[:,:-1], sequences[:,-1]<br/>
      4 y = to_categorical(y, num_classes=vocab_size)<br/>
      5 seq_length = X.shape[1]</p>
<p>IndexError: too many indices for array</p>
<div class="reply">
<a aria-label="Reply to Ray" class="comment-reply-link" href="#comment-430799" onclick='return addComment.moveForm( "comment-430799", "430799", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-430816">
<div class="comment-container" id="li-comment-430816">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 1, 2018 at 3:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-430816" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Are you able to confirm that your Python 3 environment is up to date, including Keras and tensorflow?</p>
<p>For example, here are the current versions I’m running with:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7a9d1127935701457" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
python: 3.6.4
scipy: 1.0.0
numpy: 1.14.0
matplotlib: 2.1.1
pandas: 0.22.0
statsmodels: 0.8.0
sklearn: 0.19.1
nltk: 3.2.5
gensim: 3.3.0
xgboost 0.6
tensorflow: 1.5.0
theano: 1.0.1
keras: 2.1.4</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7a9d1127935701457-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9d1127935701457-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7a9d1127935701457-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9d1127935701457-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7a9d1127935701457-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9d1127935701457-6">6</div><div class="crayon-num" data-line="crayon-5c0ca7a9d1127935701457-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9d1127935701457-8">8</div><div class="crayon-num" data-line="crayon-5c0ca7a9d1127935701457-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9d1127935701457-10">10</div><div class="crayon-num" data-line="crayon-5c0ca7a9d1127935701457-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7a9d1127935701457-12">12</div><div class="crayon-num" data-line="crayon-5c0ca7a9d1127935701457-13">13</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7a9d1127935701457-1"><span class="crayon-v">python</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">3.6.4</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9d1127935701457-2"><span class="crayon-v">scipy</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1.0.0</span></div><div class="crayon-line" id="crayon-5c0ca7a9d1127935701457-3"><span class="crayon-v">numpy</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1.14.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9d1127935701457-4"><span class="crayon-v">matplotlib</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">2.1.1</span></div><div class="crayon-line" id="crayon-5c0ca7a9d1127935701457-5"><span class="crayon-v">pandas</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.22.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9d1127935701457-6"><span class="crayon-v">statsmodels</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.8.0</span></div><div class="crayon-line" id="crayon-5c0ca7a9d1127935701457-7"><span class="crayon-v">sklearn</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.19.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9d1127935701457-8"><span class="crayon-v">nltk</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">3.2.5</span></div><div class="crayon-line" id="crayon-5c0ca7a9d1127935701457-9"><span class="crayon-v">gensim</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">3.3.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9d1127935701457-10"><span class="crayon-i">xgboost</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span></div><div class="crayon-line" id="crayon-5c0ca7a9d1127935701457-11"><span class="crayon-v">tensorflow</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1.5.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7a9d1127935701457-12"><span class="crayon-v">theano</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1.0.1</span></div><div class="crayon-line" id="crayon-5c0ca7a9d1127935701457-13"><span class="crayon-v">keras</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">2.1.4</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430816" onclick='return addComment.moveForm( "comment-430816", "430816", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-432680">
<div class="comment-container" id="li-comment-432680">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9835aa8b741e1e7f0a6e61fe9001856b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9835aa8b741e1e7f0a6e61fe9001856b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://bedoron.com" rel="external nofollow">Doron Ben Elazar</a></span>
<span class="date">March 20, 2018 at 8:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-432680" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It means that your input is not even and np.array doesn’t parse it properly (the author created paragraphs of 50 tokens each), a possible fix would be:</p>
<p>    original_sequences = tokenizer.texts_to_sequences(text_chunk)</p>
<p>    vocab_size = len(tokenizer.word_index) + 1</p>
<p>    aligned_sequneces = []<br/>
    for sequence in original_sequences:<br/>
        aligned_sequence = np.zeros(max_len, dtype=np.int64)<br/>
        aligned_sequence[:len(sequence)] = np.array(sequence, dtype=np.int64)<br/>
        aligned_sequneces.append(aligned_sequence)</p>
<p>    sequences = np.array(aligned_sequneces)</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-4" id="comment-442253">
<div class="comment-container" id="li-comment-442253">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3cbe20903f1ff78b9f7c184442ea30e0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3cbe20903f1ff78b9f7c184442ea30e0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Basil</span>
<span class="date">June 28, 2018 at 6:36 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-442253" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Don’t know if it too late to respond. the issue arises because u have by mistake typed</p>
<p>tokenizer.fit_on_sequences before instead of tokenizer.texts_to_sequences.  </p>
<p>Hope this helps others who come to this page in the future!</p>
<p>Thanks Jason.</p>
<div class="reply">
<a aria-label="Reply to Basil" class="comment-reply-link" href="#comment-442253" onclick='return addComment.moveForm( "comment-442253", "442253", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-442287">
<div class="comment-container" id="li-comment-442287">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 29, 2018 at 5:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-442287" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the note.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-5" id="comment-445439">
<div class="comment-container" id="li-comment-445439">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a3b1c385451df9205dfe5156e96fc429?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a3b1c385451df9205dfe5156e96fc429?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">JC Ulundo</span>
<span class="date">August 7, 2018 at 12:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-445439" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Basil I tried your suggestion but still encountering the same error.<br/>
Did anyone go through this error and got it fixed?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-445448">
<div class="comment-container" id="li-comment-445448">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 7, 2018 at 2:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-445448" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have some suggestions here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-452954">
<div class="comment-container" id="li-comment-452954">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b62631911b6124474aa79cdd9cc6e755?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b62631911b6124474aa79cdd9cc6e755?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Naetmul</span>
<span class="date">October 28, 2018 at 1:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-452954" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The main problem is that <code>tokenizer.texts_to_sequences(lines)</code> returns List of List, not a guaranteed rectangular 2D list,<br/>
which means that <code>sequences</code> may have this form:<br/>
[[1, 2, 3], [2, 3, 4, 5]]<br/>
but the example in this article assumes that <code>sequences</code> should be a rectangular shaped list like:<br/>
[[1, 2, 3, 4], [2, 3, 4, 5]]</p>
<p>If you used a custom <code>clean_doc</code> function, you may need to use custom filter parameter for the Tokenizer(), like <code>tokenizer = Tokenizer(filters='\n')</code>.</p>
<p>The constructor of Tokenizer() has an optional parameter<br/>
filters: a string where each element is a character that will be filtered from the texts. The default is all punctuation, plus tabs and line breaks, minus the ‘ character.</p>
<p>The example already removed all the punctuation and whitespaces, so it will be not a problem in the example.<br/>
However, if you used a custom one, then it can be a problem.</p>
<div class="reply">
<a aria-label="Reply to Naetmul" class="comment-reply-link" href="#comment-452954" onclick='return addComment.moveForm( "comment-452954", "452954", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-431223">
<div class="comment-container" id="li-comment-431223">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7fc04f718ccda8281da64705dc552388?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7fc04f718ccda8281da64705dc552388?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vikas dixit</span>
<span class="date">March 5, 2018 at 9:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-431223" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sir, i have a vocabulary size of 12000 and when i use to_categorical system throws Memory Error as shown below:</p>
<p>/usr/local/lib/python2.7/dist-packages/keras/utils/np_utils.pyc in to_categorical(y, num_classes)<br/>
     22         num_classes = np.max(y) + 1<br/>
     23     n = y.shape[0]<br/>
—&gt; 24     categorical = np.zeros((n, num_classes))<br/>
     25     categorical[np.arange(n), y] = 1<br/>
     26     return categorical</p>
<p>MemoryError: </p>
<p>How to solve this error??</p>
<div class="reply">
<a aria-label="Reply to vikas dixit" class="comment-reply-link" href="#comment-431223" onclick='return addComment.moveForm( "comment-431223", "431223", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-431275">
<div class="comment-container" id="li-comment-431275">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 6, 2018 at 6:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-431275" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps try running the code on a machine with more RAM, such as on S3?</p>
<p>Perhaps try mapping the vocab to integers manually with more memory efficient code?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-431275" onclick='return addComment.moveForm( "comment-431275", "431275", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-431429">
<div class="comment-container" id="li-comment-431429">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1b7396d428ac3dfa54e232f1e0d92de9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1b7396d428ac3dfa54e232f1e0d92de9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Eli Mshomi</span>
<span class="date">March 7, 2018 at 9:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-431429" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can you generate a article based on the other related articles which and be human readable ?</p>
<div class="reply">
<a aria-label="Reply to Eli Mshomi" class="comment-reply-link" href="#comment-431429" onclick='return addComment.moveForm( "comment-431429", "431429", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-431451">
<div class="comment-container" id="li-comment-431451">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 7, 2018 at 3:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-431451" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, I believe so. The model will have to be large and carefully trained.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-431451" onclick='return addComment.moveForm( "comment-431451", "431451", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-431947">
<div class="comment-container" id="li-comment-431947">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3350bdb52c9705ff6fb14ada392e94c5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3350bdb52c9705ff6fb14ada392e94c5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Adam</span>
<span class="date">March 12, 2018 at 9:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-431947" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I just tried out your code here with my own text sample (blog posts from a tumblr blog) and trained it and it’s now gotten to the point where text is no longer “generated”, but rather just sent back verbatim.<br/>
The sample set I’m using is rather small (each individual post is fairly small, so I made each sequence 10 input 1 output) giving me around 25,000 sequences. Everything else was kept the same code from your tutorial – after around 150 epochs, the accuracy was around 0.99 so I cut it off to try generation.</p>
<p>When I change the seed text from something to the sample to something else from the vocabulary (ie not a full line but a “random” line) then the text is fairly random which is what I wanted. When the seed text is changed to something outside of the vocabulary, the same text is generated each time.</p>
<p>What should I do if I want something more random? Should I change something like the memory cells in the LSTM layers? Reduce the sequence length? Just stop training at a higher loss/lower accuracy?</p>
<p>Thanks a ton for your tutorials, I’ve learned a lot through them.</p>
<div class="reply">
<a aria-label="Reply to Adam" class="comment-reply-link" href="#comment-431947" onclick='return addComment.moveForm( "comment-431947", "431947", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-431975">
<div class="comment-container" id="li-comment-431975">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 13, 2018 at 6:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-431975" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps the model is overfit and could be trained less?</p>
<p>Perhaps a larger dataset is required?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-431975" onclick='return addComment.moveForm( "comment-431975", "431975", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-431990">
<div class="comment-container" id="li-comment-431990">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3350bdb52c9705ff6fb14ada392e94c5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3350bdb52c9705ff6fb14ada392e94c5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Adam</span>
<span class="date">March 13, 2018 at 9:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-431990" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I think it might just be overfit. Sadly, there isn’t more data that I can grab (at least that i know of currently) so I can’t grab much more data which sucks – that’s why I reduced the sequence length to 10.</p>
<p>I checkpointed every epoch so that I can play around with what gives the best results. Thanks for your advice!</p>
<div class="reply">
<a aria-label="Reply to Adam" class="comment-reply-link" href="#comment-431990" onclick='return addComment.moveForm( "comment-431990", "431990", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-432010">
<div class="comment-container" id="li-comment-432010">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 13, 2018 at 3:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-432010" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps also try a blend/ensemble of some of the checkpointed models or models from multiple runs to see if it can give a small lift.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-432010" onclick='return addComment.moveForm( "comment-432010", "432010", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-433691">
<div class="comment-container" id="li-comment-433691">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/eafc1fcdb5ead0c9b6fda0b503a8363d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/eafc1fcdb5ead0c9b6fda0b503a8363d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Prateek</span>
<span class="date">March 30, 2018 at 4:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-433691" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I check the amount of accuracy and loss on Tensorflow. I would like to know what exactly do you means in accuracy in NLP? </p>
<p>In computer vision, if we wish to predict cat and the predicted out of the model is cat then we can say that the accuracy of the model is greater than 95%.</p>
<p>I want to understand physically what do we mean by accuracy in NLP models. Can you please explain?</p>
<div class="reply">
<a aria-label="Reply to Prateek" class="comment-reply-link" href="#comment-433691" onclick='return addComment.moveForm( "comment-433691", "433691", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-433737">
<div class="comment-container" id="li-comment-433737">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 31, 2018 at 6:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-433737" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend using BLEU instead of accuracy. Accuracy does not have any useful meaning.</p>
<p>Learn more about BLEU here:<br/>
<a href="https://machinelearningmastery.com/calculate-bleu-score-for-text-python/" rel="nofollow">https://machinelearningmastery.com/calculate-bleu-score-for-text-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-433737" onclick='return addComment.moveForm( "comment-433737", "433737", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-434994">
<div class="comment-container" id="li-comment-434994">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/52b1e04ebda32c0d51a3e04cf4601986?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/52b1e04ebda32c0d51a3e04cf4601986?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jin Zhou</span>
<span class="date">April 14, 2018 at 12:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-434994" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, I have a question about evaluating this model. As I know,  perplexity is a very popular method. For BLEU and perplexity, which one do you think is better? Could you give an example about how to evaluate this model in keras.</p>
<div class="reply">
<a aria-label="Reply to Jin Zhou" class="comment-reply-link" href="#comment-434994" onclick='return addComment.moveForm( "comment-434994", "434994", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-435039">
<div class="comment-container" id="li-comment-435039">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 15, 2018 at 6:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-435039" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Both are good. I don’t have a favorite.</p>
<p>I cover how to calculate BLEU here:<br/>
<a href="https://machinelearningmastery.com/calculate-bleu-score-for-text-python/" rel="nofollow">https://machinelearningmastery.com/calculate-bleu-score-for-text-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435039" onclick='return addComment.moveForm( "comment-435039", "435039", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-435714">
<div class="comment-container" id="li-comment-435714">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/52b1e04ebda32c0d51a3e04cf4601986?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/52b1e04ebda32c0d51a3e04cf4601986?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jin</span>
<span class="date">April 23, 2018 at 7:11 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-435714" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, I am a little confused, you told us that we need 100 words as input, but your X_train is only 50 words per line. Could you explain that a little?</p>
<div class="reply">
<a aria-label="Reply to Jin" class="comment-reply-link" href="#comment-435714" onclick='return addComment.moveForm( "comment-435714", "435714", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-435761">
<div class="comment-container" id="li-comment-435761">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 24, 2018 at 6:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-435761" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, that was a typo. Fixed.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435761" onclick='return addComment.moveForm( "comment-435761", "435761", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-436361">
<div class="comment-container" id="li-comment-436361">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b32cf90586f47118347021c197d55eff?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b32cf90586f47118347021c197d55eff?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">jason</span>
<span class="date">May 1, 2018 at 9:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-436361" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason,</p>
<p>You have an embedding layer as the part of the model. The embedding weights will be trained along with other layers. Why not separate and train it independently? In other words, first using Embedding alone to train word vectors/embedding weights. Then run your model with embedding layer initializer with embedding weights and setting trainable=false. I see most people use your approach to train a model. But this is kind of against the purpose of embedding because the output is not word context but 0/1 labels. Why not replace embedding with an ordinary layer with linear activation?</p>
<p>Another jason</p>
<div class="reply">
<a aria-label="Reply to jason" class="comment-reply-link" href="#comment-436361" onclick='return addComment.moveForm( "comment-436361", "436361", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-436409">
<div class="comment-container" id="li-comment-436409">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 2, 2018 at 5:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-436409" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can train them separately. I give examples on the blog.</p>
<p>Often, I find the model has better skill when the embedding is trained with the net.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436409" onclick='return addComment.moveForm( "comment-436409", "436409", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-436437">
<div class="comment-container" id="li-comment-436437">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b32cf90586f47118347021c197d55eff?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b32cf90586f47118347021c197d55eff?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">jason</span>
<span class="date">May 2, 2018 at 9:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-436437" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>“I give examples on the blog.” I guess you mean there are other posts in your blog talking about “train them separately”.</p>
<div class="reply">
<a aria-label="Reply to jason" class="comment-reply-link" href="#comment-436437" onclick='return addComment.moveForm( "comment-436437", "436437", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-436499">
<div class="comment-container" id="li-comment-436499">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 3, 2018 at 6:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-436499" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, you can search here:<br/>
<a href="https://machinelearningmastery.com/site-search/" rel="nofollow">https://machinelearningmastery.com/site-search/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436499" onclick='return addComment.moveForm( "comment-436499", "436499", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-437904">
<div class="comment-container" id="li-comment-437904">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/998de180d3bf5db66c027934d6680361?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/998de180d3bf5db66c027934d6680361?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">johhnybravo</span>
<span class="date">May 19, 2018 at 2:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-437904" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>ValueError: Error when checking : expected embedding_1_input to have shape (50,) but got array with shape (1,) while predicting output</p>
<div class="reply">
<a aria-label="Reply to johhnybravo" class="comment-reply-link" href="#comment-437904" onclick='return addComment.moveForm( "comment-437904", "437904", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-437931">
<div class="comment-container" id="li-comment-437931">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 19, 2018 at 7:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-437931" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This might help:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437931" onclick='return addComment.moveForm( "comment-437931", "437931", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-439553">
<div class="comment-container" id="li-comment-439553">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a1b351cd9a149a9cdf7a224373691e22?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a1b351cd9a149a9cdf7a224373691e22?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tanaya</span>
<span class="date">June 2, 2018 at 11:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-439553" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi. Did you get a solution to the problem? I am getting the same error.</p>
<div class="reply">
<a aria-label="Reply to Tanaya" class="comment-reply-link" href="#comment-439553" onclick='return addComment.moveForm( "comment-439553", "439553", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-452083">
<div class="comment-container" id="li-comment-452083">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d6cead19640ff1c177dff31d1511c8cf?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d6cead19640ff1c177dff31d1511c8cf?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ervin</span>
<span class="date">October 19, 2018 at 9:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-452083" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I solved it by following this post: </p>
<p><a href="https://stackoverflow.com/questions/39950311/keras-error-on-predict" rel="nofollow">https://stackoverflow.com/questions/39950311/keras-error-on-predict</a></p>
<div class="reply">
<a aria-label="Reply to Ervin" class="comment-reply-link" href="#comment-452083" onclick='return addComment.moveForm( "comment-452083", "452083", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-439142">
<div class="comment-container" id="li-comment-439142">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/47b1ab471d2768aa38d3eb3fd0d1f115?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/47b1ab471d2768aa38d3eb3fd0d1f115?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.scholarsguru.com" rel="external nofollow">Nitin Mukesh</a></span>
<span class="date">May 30, 2018 at 6:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-439142" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, I want to develop Image Captioning in keras. What are the pre requisite for this? I have done your tutorials for object detection using CNN. What should I do next?</p>
<div class="reply">
<a aria-label="Reply to Nitin Mukesh" class="comment-reply-link" href="#comment-439142" onclick='return addComment.moveForm( "comment-439142", "439142", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-439183">
<div class="comment-container" id="li-comment-439183">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 31, 2018 at 6:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-439183" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can follow this tutorial:<br/>
<a href="https://machinelearningmastery.com/develop-a-deep-learning-caption-generation-model-in-python/" rel="nofollow">https://machinelearningmastery.com/develop-a-deep-learning-caption-generation-model-in-python/</a></p>
<p>Or I lay out all the required prior knowledge in this book:<br/>
<a href="https://machinelearningmastery.com/deep-learning-for-nlp/" rel="nofollow">https://machinelearningmastery.com/deep-learning-for-nlp/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-439183" onclick='return addComment.moveForm( "comment-439183", "439183", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-439285">
<div class="comment-container" id="li-comment-439285">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8ad58176c90e7771b38ac6288f0692e7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8ad58176c90e7771b38ac6288f0692e7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">mel_dagh</span>
<span class="date">June 1, 2018 at 1:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-439285" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>1.) Can we use this approach to predict if a word in a given sequence of the training data is highly odd..i.e. that it does not occur in that position of the sequence with high probability. </p>
<p>2.) Is there a way to integrate pre-trained word embeddings (glove/word2vec) in the embedding layer?</p>
<div class="reply">
<a aria-label="Reply to mel_dagh" class="comment-reply-link" href="#comment-439285" onclick='return addComment.moveForm( "comment-439285", "439285", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-439334">
<div class="comment-container" id="li-comment-439334">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 1, 2018 at 8:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-439334" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It is more about generating new sequences than predicting words.</p>
<p>Here are examples of working with pre-trained word embeddings:<br/>
<a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/" rel="nofollow">https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-439334" onclick='return addComment.moveForm( "comment-439334", "439334", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-440212">
<div class="comment-container" id="li-comment-440212">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a1b351cd9a149a9cdf7a224373691e22?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a1b351cd9a149a9cdf7a224373691e22?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tanaya</span>
<span class="date">June 8, 2018 at 7:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-440212" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, this is simply an amazing post for beginners in NLP like me.</p>
<p>I have generated a language model, which is further generating text like I want it to.<br/>
My question is, after this generation, how do I filter out all the text that does not make sense, syntactically or semantically?</p>
<div class="reply">
<a aria-label="Reply to Tanaya" class="comment-reply-link" href="#comment-440212" onclick='return addComment.moveForm( "comment-440212", "440212", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-440267">
<div class="comment-container" id="li-comment-440267">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 9, 2018 at 6:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-440267" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<p>You might need another model to classify text, correct text, or filter text prior to using it.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-440267" onclick='return addComment.moveForm( "comment-440267", "440267", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-440581">
<div class="comment-container" id="li-comment-440581">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a1b351cd9a149a9cdf7a224373691e22?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a1b351cd9a149a9cdf7a224373691e22?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tanaya</span>
<span class="date">June 12, 2018 at 4:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-440581" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Will this also be using Keras? Do you recommend using nltk or SpaCy?</p>
<div class="reply">
<a aria-label="Reply to Tanaya" class="comment-reply-link" href="#comment-440581" onclick='return addComment.moveForm( "comment-440581", "440581", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-440634">
<div class="comment-container" id="li-comment-440634">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 13, 2018 at 6:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-440634" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps, I was trying not to be specific.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-440634" onclick='return addComment.moveForm( "comment-440634", "440634", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-440507">
<div class="comment-container" id="li-comment-440507">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c952c4dad2c433b567a1d6d0088519fe?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c952c4dad2c433b567a1d6d0088519fe?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Venkat</span>
<span class="date">June 12, 2018 at 4:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-440507" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for the amazing post.</p>
<p>I’m working on words correction in a sentence. Ideally the model should generate number of output words equal to input words with correction of error word in the sentence.</p>
<p>Does language model help me for the same.? if it does please leave some hints on the model.</p>
<div class="reply">
<a aria-label="Reply to Venkat" class="comment-reply-link" href="#comment-440507" onclick='return addComment.moveForm( "comment-440507", "440507", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-440533">
<div class="comment-container" id="li-comment-440533">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 12, 2018 at 6:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-440533" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sounds like a fun project. A language model might be useful. Sorry, I don’t have a worked example. I recommend checking the literature.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-440533" onclick='return addComment.moveForm( "comment-440533", "440533", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-441443">
<div class="comment-container" id="li-comment-441443">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f7b2cd54970ac1aa4febd2a6b92d538b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f7b2cd54970ac1aa4febd2a6b92d538b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Amar</span>
<span class="date">June 20, 2018 at 8:53 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-441443" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I am working on a highly imbalanced text classification problem.<br/>
Ex :  Classify a “Genuine Email ”  vs “SPAM ” based on text in body of email.</p>
<p>Genuine email text = 30 k lines<br/>
Spam email text = 1k lines</p>
<p>I need to classify whether the next email is Genuine or SPAM.</p>
<p>I train the model using the same example as above.<br/>
The training data I feed to the model is only “Genuine text”.</p>
<p>Will I be able to classify the next sentence I feed to the model, from the generated text and probability of words :  as “GENUINE Email” vs “SPAM”?</p>
<p>(I am assuming that the model has never seen SPAM data, and hence the probability of the generated text will be very less.)</p>
<p>Do you see any way I can achieve this with Language model? What would be an alternative otherwise when it comes to rare event scenario for NLP use cases.</p>
<p>Thank you!!</p>
<div class="reply">
<a aria-label="Reply to Amar" class="comment-reply-link" href="#comment-441443" onclick='return addComment.moveForm( "comment-441443", "441443", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-441489">
<div class="comment-container" id="li-comment-441489">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 21, 2018 at 6:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-441489" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend using a CNN model for text classification, for example:<br/>
<a href="https://machinelearningmastery.com/best-practices-document-classification-deep-learning/" rel="nofollow">https://machinelearningmastery.com/best-practices-document-classification-deep-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-441489" onclick='return addComment.moveForm( "comment-441489", "441489", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-441534">
<div class="comment-container" id="li-comment-441534">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f7b2cd54970ac1aa4febd2a6b92d538b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f7b2cd54970ac1aa4febd2a6b92d538b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Amar</span>
<span class="date">June 21, 2018 at 4:25 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-441534" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Jason!!</p>
<div class="reply">
<a aria-label="Reply to Amar" class="comment-reply-link" href="#comment-441534" onclick='return addComment.moveForm( "comment-441534", "441534", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-441545">
<div class="comment-container" id="li-comment-441545">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 21, 2018 at 5:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-441545" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-441545" onclick='return addComment.moveForm( "comment-441545", "441545", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-442278">
<div class="comment-container" id="li-comment-442278">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8ad58176c90e7771b38ac6288f0692e7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8ad58176c90e7771b38ac6288f0692e7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">musa</span>
<span class="date">June 29, 2018 at 2:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-442278" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Could you comment on overfitting when training language models. I’ve built a sentence based LSTM language model and have split training: validation into a 80:20 split. I’m not seeing any imrovments in my validation data whilst the accuracy of the model seems to be improving.</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to musa" class="comment-reply-link" href="#comment-442278" onclick='return addComment.moveForm( "comment-442278", "442278", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-442304">
<div class="comment-container" id="li-comment-442304">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 29, 2018 at 6:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-442304" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Overfitting a language model really only matters in the context of the problem for which you are using the model.</p>
<p>A language model used alone is not really that useful, so overfitting doesn’t matter. It may be purely a descriptive model rather than predictive.</p>
<p>Often, they are used in the input or output of another model, in which case, overfitting may limit predictive skill.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442304" onclick='return addComment.moveForm( "comment-442304", "442304", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-442393">
<div class="comment-container" id="li-comment-442393">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/78f422f35688e61368f4a64f5b9cb2cb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/78f422f35688e61368f4a64f5b9cb2cb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Marc</span>
<span class="date">June 30, 2018 at 8:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-442393" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Would would the implications of returning the hidden and cell states be here? </p>
<p>I’d imagine if the input sequence was long enough it wouldn’t matter too much as the temporal relationships would be captured, but if we had shorter sequences or really long documents we would consider doing this to improve the model’s ability to learn.. am I thinking about this correctly? </p>
<p>What would the drawback be to returning the hidden sequence and cell state and piping that into the next observation?</p>
<div class="reply">
<a aria-label="Reply to Marc" class="comment-reply-link" href="#comment-442393" onclick='return addComment.moveForm( "comment-442393", "442393", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-442422">
<div class="comment-container" id="li-comment-442422">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 1, 2018 at 6:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-442422" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t follow, why would you return the cell state externally at all? It has no meaning outside of the network.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442422" onclick='return addComment.moveForm( "comment-442422", "442422", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-442679">
<div class="comment-container" id="li-comment-442679">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cdc08769d1fd11b353aa9ea0d5f1bea5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cdc08769d1fd11b353aa9ea0d5f1bea5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">star</span>
<span class="date">July 5, 2018 at 2:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-442679" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hope you are doing well. I have a question which returns to my understanding from embedding vectors.<br/>
For example if  I have this sentence “ the weather is nice” and the goal of my model is predicting “nice”, when I want to use pre trained google word embedding model, I must search embedding google matrix and find the embedding vector related to words “the” “weather” “is” “nice” and feed them as input to my model? Am I right?</p>
<div class="reply">
<a aria-label="Reply to star" class="comment-reply-link" href="#comment-442679" onclick='return addComment.moveForm( "comment-442679", "442679", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-442711">
<div class="comment-container" id="li-comment-442711">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 5, 2018 at 8:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-442711" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Why would you do that?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442711" onclick='return addComment.moveForm( "comment-442711", "442711", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-442588">
<div class="comment-container" id="li-comment-442588">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cdc08769d1fd11b353aa9ea0d5f1bea5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cdc08769d1fd11b353aa9ea0d5f1bea5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Fatemeh</span>
<span class="date">July 4, 2018 at 2:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-442588" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, Thank you for nice description. I want to use pre-trained google word embedding vectors, So I think I don’t need to do sequence encoding, for example if I want to create sequences with the length 10, I have to search embedding matrix and find the equivalence embedding vector for each of the 10 words, right?</p>
<div class="reply">
<a aria-label="Reply to Fatemeh" class="comment-reply-link" href="#comment-442588" onclick='return addComment.moveForm( "comment-442588", "442588", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-442615">
<div class="comment-container" id="li-comment-442615">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 4, 2018 at 8:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-442615" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Correct. You must map each word to its distributed representation when preparing the embedding or the encoding.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442615" onclick='return addComment.moveForm( "comment-442615", "442615", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-442681">
<div class="comment-container" id="li-comment-442681">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cdc08769d1fd11b353aa9ea0d5f1bea5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cdc08769d1fd11b353aa9ea0d5f1bea5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Fatemeh</span>
<span class="date">July 5, 2018 at 2:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-442681" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you, do you have sample code for that in your book? I purchased your professional package</p>
<div class="reply">
<a aria-label="Reply to Fatemeh" class="comment-reply-link" href="#comment-442681" onclick='return addComment.moveForm( "comment-442681", "442681", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-442712">
<div class="comment-container" id="li-comment-442712">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 5, 2018 at 8:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-442712" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>All sample code is provided with the PDF in the code/ directory.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442712" onclick='return addComment.moveForm( "comment-442712", "442712", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-442753">
<div class="comment-container" id="li-comment-442753">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cdc08769d1fd11b353aa9ea0d5f1bea5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cdc08769d1fd11b353aa9ea0d5f1bea5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">fatemeh</span>
<span class="date">July 6, 2018 at 1:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-442753" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you. when I want to use model.fit , I have to specify X and y and I have used pre trained google embedidng matrix. so every word has mapped to a a vector, and my inputs are actually the sentences (with the length 4). now I don’t understand the equivalent values for X. for example imagine the first sentence is “the weather is nice”  so the X will be “the weather is” and the y is “nice”. When I want to convert X to integers, every word in X will be mapped to one vector? for example if the equivalent vectors for the words in sentence in google model are :”the”= 0.9,0.6,0.8 and “weather”=0.6,0.5,0.2 and “is”=0.3,0.1,0.5 ,  and “nice”=0.4,0.3,0.5 the input X will be :[[0.9,0.6,0.8],[0.6,0.5,0.2],[0.3,0.1,0.5]]  and the  output y will be [0.4,0.3,0.5]?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-442781">
<div class="comment-container" id="li-comment-442781">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 6, 2018 at 6:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-442781" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can specify or learn the mapping, but after that the model will map integers to their vectors.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-442683">
<div class="comment-container" id="li-comment-442683">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/27a3ecb5b31b043f366dfcb777dc75cb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/27a3ecb5b31b043f366dfcb777dc75cb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">mh</span>
<span class="date">July 5, 2018 at 4:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-442683" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason, why you didn’t convert X input to hot vector format? you only did this dot y output.</p>
<div class="reply">
<a aria-label="Reply to mh" class="comment-reply-link" href="#comment-442683" onclick='return addComment.moveForm( "comment-442683", "442683", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-442713">
<div class="comment-container" id="li-comment-442713">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 5, 2018 at 8:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-442713" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>We don’t need to as we use a word embedding.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442713" onclick='return addComment.moveForm( "comment-442713", "442713", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-442747">
<div class="comment-container" id="li-comment-442747">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/92e2c55e58ca0d2dbf51d0dda31f959f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/92e2c55e58ca0d2dbf51d0dda31f959f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anshuman Mahapatra</span>
<span class="date">July 5, 2018 at 10:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-442747" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi..First of all would like to thank for the detailed explaination on the concept. I was executing this model step by step to have a better understanding but am stuck while doing the predictions<br/>
yhat = model.predict_classes(encoded, verbose=0)<br/>
I am getting the below error:-<br/>
ValueError: Error when checking input: expected embedding_1_input to have shape (50,) but got array with shape (1,)</p>
<div class="reply">
<a aria-label="Reply to Anshuman Mahapatra" class="comment-reply-link" href="#comment-442747" onclick='return addComment.moveForm( "comment-442747", "442747", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-442777">
<div class="comment-container" id="li-comment-442777">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 6, 2018 at 6:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-442777" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have some suggestions here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442777" onclick='return addComment.moveForm( "comment-442777", "442777", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-452418">
<div class="comment-container" id="li-comment-452418">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d6cead19640ff1c177dff31d1511c8cf?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d6cead19640ff1c177dff31d1511c8cf?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ervin</span>
<span class="date">October 23, 2018 at 9:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-452418" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>i fixed this problem following this post</p>
<p><a href="https://stackoverflow.com/questions/39950311/keras-error-on-predict" rel="nofollow">https://stackoverflow.com/questions/39950311/keras-error-on-predict</a></p>
<div class="reply">
<a aria-label="Reply to ervin" class="comment-reply-link" href="#comment-452418" onclick='return addComment.moveForm( "comment-452418", "452418", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-445153">
<div class="comment-container" id="li-comment-445153">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4e7687090278d32912ea8126691dac9f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4e7687090278d32912ea8126691dac9f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">NLP_enthusiast</span>
<span class="date">August 3, 2018 at 5:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-445153" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, nice tutorial!</p>
<p>When callling:<br/>
model.fit(X, y, batch_size=128, epochs=100)<br/>
what is X.shape and y.shape at this point?</p>
<p>I’m getting the error:<br/>
Error when checking input: expected embedding_1_input to have shape (500,) but got array with shape (1,)</p>
<p>In my case:<br/>
X.shape  = (500,)  # 500 samples i my case<br/>
y.shape = (500, 200)  # this is after y= to_categorical(y, num_classes=vocab_size)</p>
<p>Using Theano backend.</p>
<div class="reply">
<a aria-label="Reply to NLP_enthusiast" class="comment-reply-link" href="#comment-445153" onclick='return addComment.moveForm( "comment-445153", "445153", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-445193">
<div class="comment-container" id="li-comment-445193">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 4, 2018 at 6:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-445193" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have some suggestions here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-445193" onclick='return addComment.moveForm( "comment-445193", "445193", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-445210">
<div class="comment-container" id="li-comment-445210">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4e7687090278d32912ea8126691dac9f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4e7687090278d32912ea8126691dac9f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">NLP_enthusiast</span>
<span class="date">August 4, 2018 at 7:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-445210" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thank you. Potentially useful to others: X.shape should be of the form (a, b) where a is the length of “sequences” and b is the input sequence length to make forward predictions. Note that modification/omission of string.maketrans() is likely necessary if using Python 2.x (instead of Python 3.x) and that Theanos backend may also alleviate potential dimension errors from Tensorflow.</p>
<div class="reply">
<a aria-label="Reply to NLP_enthusiast" class="comment-reply-link" href="#comment-445210" onclick='return addComment.moveForm( "comment-445210", "445210", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-445253">
<div class="comment-container" id="li-comment-445253">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 5, 2018 at 5:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-445253" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>THanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-445253" onclick='return addComment.moveForm( "comment-445253", "445253", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-447790">
<div class="comment-container" id="li-comment-447790">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/82995422a2c052895dad6e0555350e71?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/82995422a2c052895dad6e0555350e71?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">usman</span>
<span class="date">September 4, 2018 at 5:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-447790" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>@NLP_enthusiast How did you solve this error?</p>
<div class="reply">
<a aria-label="Reply to usman" class="comment-reply-link" href="#comment-447790" onclick='return addComment.moveForm( "comment-447790", "447790", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-455594">
<div class="comment-container" id="li-comment-455594">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6661f7aa9c441cce21b9395d11472240?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6661f7aa9c441cce21b9395d11472240?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Carlos Aguayo</span>
<span class="date">November 20, 2018 at 10:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-455594" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can just replace these:</p>
<p>	table = string.maketrans(string.punctuation, ‘ ‘)<br/>
	tokens = [‘w.translate(table)’ for w in tokens]</p>
<p>with this:</p>
<p>        tokens = [‘ ‘ if w in string.punctuation else w for w in tokens]</p>
<div class="reply">
<a aria-label="Reply to Carlos Aguayo" class="comment-reply-link" href="#comment-455594" onclick='return addComment.moveForm( "comment-455594", "455594", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-455616">
<div class="comment-container" id="li-comment-455616">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 20, 2018 at 2:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-455616" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Very nice!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-455616" onclick='return addComment.moveForm( "comment-455616", "455616", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-446538">
<div class="comment-container" id="li-comment-446538">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d64a1babd81b459c470b5844240c7af8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d64a1babd81b459c470b5844240c7af8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Eric</span>
<span class="date">August 20, 2018 at 9:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-446538" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Does anyone have an example of how predict based on a user provided text string instead of random sample data. I’m kind of new to this so my apologies in advance for such a simple question. Thank you!</p>
<div class="reply">
<a aria-label="Reply to Eric" class="comment-reply-link" href="#comment-446538" onclick='return addComment.moveForm( "comment-446538", "446538", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-446580">
<div class="comment-container" id="li-comment-446580">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 21, 2018 at 6:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-446580" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The new input data must be prepared in the same way as the training data for the model.</p>
<p>E.g. the same data preparation steps and tokenizer.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-446580" onclick='return addComment.moveForm( "comment-446580", "446580", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-446592">
<div class="comment-container" id="li-comment-446592">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/815ca59309234d46d4ebcb649d7b8fc9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/815ca59309234d46d4ebcb649d7b8fc9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Santosh</span>
<span class="date">August 21, 2018 at 6:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-446592" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can we implement this thing in Android platform to run trained model for given set of words from user.</p>
<div class="reply">
<a aria-label="Reply to Santosh" class="comment-reply-link" href="#comment-446592" onclick='return addComment.moveForm( "comment-446592", "446592", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-446595">
<div class="comment-container" id="li-comment-446595">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 21, 2018 at 6:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-446595" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Maybe, I don’t have any examples on Android, sorry.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-446595" onclick='return addComment.moveForm( "comment-446595", "446595", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-447445">
<div class="comment-container" id="li-comment-447445">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c6783c2e8e30a5d49b71deac5f6c6ff1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c6783c2e8e30a5d49b71deac5f6c6ff1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">anirban</span>
<span class="date">August 31, 2018 at 11:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-447445" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
One of the extensions suggested in the blog is<br/>
Sentence-Wise Model. Split the raw data based on sentences and pad each sentence to a fixed length (e.g. the longest sentence length).<br/>
So if I do a sentence wise splitting then do I  retain the punctuations or  remove it?</p>
<div class="reply">
<a aria-label="Reply to anirban" class="comment-reply-link" href="#comment-447445" onclick='return addComment.moveForm( "comment-447445", "447445", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-447472">
<div class="comment-container" id="li-comment-447472">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 1, 2018 at 6:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-447472" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sounds like a good start.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-447472" onclick='return addComment.moveForm( "comment-447472", "447472", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-448004">
<div class="comment-container" id="li-comment-448004">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0d3535e03b66ffa7c992c9636574bde6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0d3535e03b66ffa7c992c9636574bde6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">wu.zheng</span>
<span class="date">September 6, 2018 at 1:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-448004" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p># separate into input and output<br/>
sequences = array(sequences)<br/>
X, y = sequences[:,:-1], sequences[:,-1]</p>
<p>is this model only use the 50 words before to predict  last world ? </p>
<p>the context length is fixed ?</p>
<div class="reply">
<a aria-label="Reply to wu.zheng" class="comment-reply-link" href="#comment-448004" onclick='return addComment.moveForm( "comment-448004", "448004", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-448016">
<div class="comment-container" id="li-comment-448016">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 6, 2018 at 2:13 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-448016" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In this example we use 50 words as input.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-448016" onclick='return addComment.moveForm( "comment-448016", "448016", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-450586">
<div class="comment-container" id="li-comment-450586">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/30fccb3c5ea0c1f6362668882e0f907c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/30fccb3c5ea0c1f6362668882e0f907c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anshul Patel</span>
<span class="date">October 3, 2018 at 5:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-450586" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason, I am working on word predictor using RNN’s too. However I have been encountering the same problem faced by many others i.e. INDEXERROR : Too many Indices</p>
<p>lines = training_set.split(‘\n’)<br/>
tokenizer = Tokenizer()<br/>
tokenizer.fit_on_sequences(lines)<br/>
tokenizer.fit_on_texts(lines)<br/>
sequences = tokenizer.texts_to_sequences(lines)</p>
<p>vocab_size = len(tokenizer.word_index) + 1</p>
<p>sequences = array(sequences)<br/>
X_train = sequences[:, :-1]<br/>
y_train = sequences[:,-1]</p>
<p>I have went through all the comments related to this error, However none of them solve my issue. I wonder if there is any problem with the text I imported it is Pride and Prejudice book from Gutenberg.</p>
<p>Please help me : THANKS in Advance !!!</p>
<div class="reply">
<a aria-label="Reply to Anshul Patel" class="comment-reply-link" href="#comment-450586" onclick='return addComment.moveForm( "comment-450586", "450586", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-450634">
<div class="comment-container" id="li-comment-450634">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 4, 2018 at 6:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-450634" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have not seen this error, are you able to confirm that your libraries are up to date and that you copied all of the code from the tutorial?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-450634" onclick='return addComment.moveForm( "comment-450634", "450634", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-451777">
<div class="comment-container" id="li-comment-451777">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/91d2606daae2de55269c2c9b2caa7adb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/91d2606daae2de55269c2c9b2caa7adb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Andrew</span>
<span class="date">October 16, 2018 at 4:51 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-451777" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Very nice article.</p>
<p>How long did it take to train model like this on 118633 sequences of 50 symbols from 7410 elements dictionary?</p>
<p>Can you share on what machine did you train the model? ram, cpu, os?</p>
<div class="reply">
<a aria-label="Reply to Andrew" class="comment-reply-link" href="#comment-451777" onclick='return addComment.moveForm( "comment-451777", "451777", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-451836">
<div class="comment-container" id="li-comment-451836">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 17, 2018 at 6:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-451836" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Just a normal workstation without GPU.</p>
<p>If you have machine problems, perhaps try an EC2 instance, I show how here:<br/>
<a href="https://machinelearningmastery.com/develop-evaluate-large-deep-learning-models-keras-amazon-web-services/" rel="nofollow">https://machinelearningmastery.com/develop-evaluate-large-deep-learning-models-keras-amazon-web-services/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-451836" onclick='return addComment.moveForm( "comment-451836", "451836", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-452154">
<div class="comment-container" id="li-comment-452154">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d6cead19640ff1c177dff31d1511c8cf?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d6cead19640ff1c177dff31d1511c8cf?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ervin</span>
<span class="date">October 20, 2018 at 3:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-452154" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great article! </p>
<p>2 questions:</p>
<p>1.  In your ‘Extension’ section — you mentioned to try dropout. Since there is not validation/holdout set, why should we use dropout? Isn’t that just a regularization technique and doesn’t help with training data accuracy?</p>
<p>2. Speaking of accuracy — I trained my model to 99% accuracy. When I generate text and use exact lines from PLATO as seed text, I should be getting almost an exact replica of PLATO right? Since my model has 99% of getting the next word right in my seed text. I’m finding that this is not the case. Am I interpreting this 99% accuracy right? What’s keeping it from making a replica.</p>
<div class="reply">
<a aria-label="Reply to ervin" class="comment-reply-link" href="#comment-452154" onclick='return addComment.moveForm( "comment-452154", "452154", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-452166">
<div class="comment-container" id="li-comment-452166">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 20, 2018 at 5:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-452166" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, it is a regularization method. Yes, it can help as the model is trained using supervised learning.</p>
<p>Accuracy is not a valid measure for a language model.</p>
<p>We don’t want the model to memorize Plato, we want the model to learn how to make Plato-like text.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-452166" onclick='return addComment.moveForm( "comment-452166", "452166", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-456618">
<div class="comment-container" id="li-comment-456618">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/457127c4162d427b07863056bb5de8f5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/457127c4162d427b07863056bb5de8f5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">OkRo</span>
<span class="date">November 29, 2018 at 9:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-456618" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi , Great article!<br/>
I have a question – How can I use the mode to get probability of a word in a sentence?<br/>
e.g. P(Piraeus| went down yesterday to the?</p>
<div class="reply">
<a aria-label="Reply to OkRo" class="comment-reply-link" href="#comment-456618" onclick='return addComment.moveForm( "comment-456618", "456618", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-456666">
<div class="comment-container" id="li-comment-456666">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 30, 2018 at 6:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/#comment-456666" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t think the model can be used in this way.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-456666" onclick='return addComment.moveForm( "comment-456666", "456666", "respond", "4422" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/how-to-develop-a-word-level-neural-language-model-in-keras/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="4422"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="4a8bfe48f8"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="154"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery!</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Jason Brownlee, PhD
<br/>
I write tutorials to help developers (<i>like you</i>) get results with machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-43"> <div class="textwidget"><p></p><center><br/>
<strong>Deep Learning for NLP</strong><br/>
Develop deep learning models for text data.
<p><a href="/deep-learning-for-nlp/">Click to Get Started Now!</a><br/>
<a href="/deep-learning-for-nlp/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/11/DLFNLP-Cover-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch"><img alt="How to Develop a Neural Machine Translation System in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/01/How-to-Develop-a-Neural-Machine-Translation-System-in-Keras-150x150.jpg" title="How to Develop a Neural Machine Translation System from Scratch" width="45"/></a> <a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch">How to Develop a Neural Machine Translation System from Scratch</a>
<span class="meta">January 10, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning"><img alt="Difference Between Classification and Regression in Machine Learning" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/Difference-Between-Classification-and-Regression-in-Machine-Learning-150x150.jpg" title="Difference Between Classification and Regression in Machine Learning" width="45"/></a> <a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning">Difference Between Classification and Regression in Machine Learning</a>
<span class="meta">December 11, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem..."><img alt="So, You are Working on a Machine Learning Problem..." class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/So-You-are-Working-on-a-Machine-Learning-Problem...-150x150.jpg" title="So, You are Working on a Machine Learning Problem..." width="45"/></a> <a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem…">So, You are Working on a Machine Learning Problem…</a>
<span class="meta">April 4, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis"><img alt="Plot of the Multichannel Convolutional Neural Network For Text" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-150x150.png" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis" width="45"/></a> <a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis">How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis</a>
<span class="meta">January 12, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras"><img alt="How to Make Classification and Regression Predictions for Deep Learning Models in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/How-to-Make-Classification-and-Regression-Predictions-for-Deep-Learning-Models-in-Keras-150x150.jpg" title="How to Make Predictions with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras">How to Make Predictions with Keras</a>
<span class="meta">April 9, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)"><img alt="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/11-Classical-Time-Series-Forecasting-Methods-in-Python-Cheat-Sheet-150x150.jpg" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)">11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)</a>
<span class="meta">August 6, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras"><img alt="How to Visualize a Deep Learning Neural Network Model in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/How-to-Visualize-a-Deep-Learning-Neural-Network-Model-in-Keras-150x150.jpg" title="How to Visualize a Deep Learning Neural Network Model in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras">How to Visualize a Deep Learning Neural Network Model in Keras</a>
<span class="meta">December 13, 2017</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> <div class="widget_text widget widget_custom_html" id="custom_html-2"><h3>You might also like…</h3><div class="textwidget custom-html-widget"><ul>
<li><a href="/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Install Python for Machine Learning</a></li>
<li><a href="/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python</a></li>
<li><a href="/tutorial-first-neural-network-python-keras/">Your First Neural Network in Python</a></li>
<li><a href="/how-to-run-your-first-classifier-in-weka/">Your First Classifier in Weka</a></li>
<li><a href="/arima-for-time-series-forecasting-with-python/">Your First Time Series Forecasting Project</a></li>
</ul></div></div></aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/disclaimer/">Disclaimer</a> | 
<a href="/terms-of-service/">Terms</a> | 
<a href="/contact/">Contact</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.8" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.0.5" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.8" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.1" type="text/javascript"></script>
</body>
</html>