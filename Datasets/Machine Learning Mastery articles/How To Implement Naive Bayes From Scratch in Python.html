<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v9.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Naive Bayes Classifier From Scratch in Python</title>
<link href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="Naive Bayes Classifier From Scratch in Python" property="og:title"/>
<meta content="The Naive Bayes algorithm is simple and effective and should be one of the first methods you try on a classification problem. In this tutorial you are going to learn about the Naive Bayes algorithm including how it works and how to implement it from scratch in Python. Update: Check out the follow-up on tips for …" property="og:description"/>
<meta content="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="https://www.facebook.com/jason.brownlee.39" property="article:author"/>
<meta content="Code Machine Learning Algorithms From Scratch" property="article:section"/>
<meta content="2014-12-07T18:00:15+00:00" property="article:published_time"/>
<meta content="2018-08-31T20:18:38+00:00" property="article:modified_time"/>
<meta content="2018-08-31T20:18:38+00:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/12/naive-bayes-classifier.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/12/naive-bayes-classifier.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="410" property="og:image:height"/>
<meta content="naive bayes classifier" property="og:image:alt"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"https:\/\/machinelearningmastery.com\/#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/feed/" rel="alternate" title="Machine Learning Mastery » How To Implement Naive Bayes From Scratch in Python Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<style media="all" type="text/css">
.wpautoterms-footer{background-color:#ffffff;text-align:center;}
.wpautoterms-footer a{color:#000000;font-family:Arial, sans-serif;font-size:14px;}
.wpautoterms-footer .separator{color:#cccccc;font-family:Arial, sans-serif;font-size:14px;}</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/auto-terms-of-service-and-privacy-policy/css/wpautoterms.css?ver=4.9.8" id="wpautoterms_css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.0.5" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/css/front.css?ver=2.0.20" id="ssb-front-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/ewd-ufaq-styles.css?ver=4.9.8" id="ewd-ufaq-style-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/rrssb-min.css?ver=4.9.8" id="ewd-ufaq-rrssb-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.8" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=2.0.20" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.8" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.8" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=1945" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fnaive-bayes-classifier-scratch-python%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fnaive-bayes-classifier-scratch-python%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<style media="screen">

        .simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
      margin: ;
    }
         /*inline margin*/
    
  
  
  
  
  
          .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
         margin: ;
     }

          /*margin-digbar*/

  
  
  
  
 
   
   

</style>
<script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#4c89bf; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#4c89bf;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#4c89bf!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#ffffff;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-1945 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/icon-100x100.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-18"> <div class="textwidget"><p>Want help with machine learning? <a href="https://machinelearningmastery.leadpages.co/machine-learning-resource-guide/">Take the FREE Crash-Course</a>.</p>
</div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<input name="post_type" type="hidden" value="post"/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Main Menu</h3><ul class="nav fl" id="main-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503" id="menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Start Here</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501" id="menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506" id="menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508" id="menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (Keras)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511" id="menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509" id="menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515" id="menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">Deep Learning for NLP</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512" id="menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Understand Algorithms</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6507" id="menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms (Python)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6513" id="menu-item-6513"><a href="https://machinelearningmastery.com/category/machine-learning-process/">Machine Learning Process</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516" id="menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517" id="menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522" id="menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6518" id="menu-item-6518"><a href="https://machinelearningmastery.com/category/start-machine-learning/">Getting Started</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510" id="menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519" id="menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistical Methods</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520" id="menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Time Series (introductory)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523" id="menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6514" id="menu-item-6514"><a href="https://machinelearningmastery.com/category/machine-learning-resources/">Resources</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502" id="menu-item-6502"><a href="https://machinelearningmastery.com/products/">Ebooks</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500" id="menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504" id="menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505" id="menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-1945 post type-post status-publish format-standard has-post-thumbnail hentry category-algorithms-from-scratch">
<header>
<h1 class="title entry-title">How To Implement Naive Bayes From Scratch in Python</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2014-12-08T05:00:15+1100">December 8, 2014</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/" title="View all items in Code Machine Learning Algorithms From Scratch">Code Machine Learning Algorithms From Scratch</a></span> </div>
<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-1945 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+To+Implement+Naive+Bayes+From+Scratch+in+Python&amp;url=https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
<p>The Naive Bayes algorithm is simple and effective and should be one of the first methods you try on a classification problem.</p>
<p>In this tutorial you are going to learn about the Naive Bayes algorithm including how it works and how to implement it from scratch in Python.</p>
<ul>
<li><strong>Update</strong>: Check out the follow-up on tips for using the naive bayes algorithm titled: “<a href="http://machinelearningmastery.com/better-naive-bayes/" title="Better Naive Bayes: 12 Tips To Get The Most From The Naive Bayes Algorithm">Better Naive Bayes: 12 Tips To Get The Most From The Naive Bayes Algorithm</a>“.</li>
<li><strong>Update March/2018</strong>: Added alternate link to download the dataset as the original appears to have been taken down.</li>
</ul>
<div class="wp-caption aligncenter" id="attachment_1947" style="width: 650px"><a href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/12/naive-bayes-classifier.jpg"><img alt="naive bayes classifier" class="size-full wp-image-1947" height="410" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/12/naive-bayes-classifier.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/12/naive-bayes-classifier.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2014/12/naive-bayes-classifier-300x192.jpg 300w" width="640"/></a><p class="wp-caption-text">Naive Bayes Classifier<br/>Photo by <a href="https://www.flickr.com/photos/mattbuck007/3676624894">Matt Buck</a>, some rights reserved</p></div>
<h2>About Naive Bayes</h2>
<p>The Naive Bayes algorithm is an intuitive method that uses the probabilities of each attribute belonging to each class to make a prediction. It is the supervised learning approach you would come up with if you wanted to model a predictive modeling problem probabilistically.</p>
<p>Naive bayes simplifies the calculation of probabilities by assuming that the probability of each attribute belonging to a given class value is independent of all other attributes. This is a strong assumption but results in a fast and effective method.</p>
<p>The probability of a class value given a value of an attribute is called the conditional probability. By multiplying the conditional probabilities together for each attribute for a given class value, we have a probability of a data instance belonging to that class.</p>
<p>To make a prediction we can calculate probabilities of the instance belonging to each class and select the class value with the highest probability.</p>
<p>Naive bases is often described using categorical data because it is easy to describe and calculate using ratios. A more useful version of the algorithm for our purposes supports numeric attributes and assumes the values of each numerical attribute are normally distributed (fall somewhere on a bell curve). Again, this is a strong assumption, but still gives robust results.</p>
<h2 style="text-align: center;">Get your FREE Algorithms Mind Map</h2>
<div class="wp-caption alignleft" id="attachment_2021" style="width: 395px"><img alt="Machine Learning Algorithms Mind Map" class="wp-image-2021 size-full" height="248" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2013/11/Machine-Learning-Algorithms-Mindmap-Sample.png" width="385"/><p class="wp-caption-text">Sample of the handy machine learning algorithms mind map.</p></div>
<p>I've created a handy mind map of 60+ algorithms organized by type.</p>
<p>Download it, print it and use it. </p>
<center><a href="https://machinelearningmastery.leadpages.co/leadbox/147764973f72a2%3A164f8be4f346dc/5752754626625536/" style="color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.247059) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.498039) 0px 1px 3px inset, rgba(0, 0, 0, 0.498039) 0px 1px 3px; background: #ffce0a;" target="_blank">Download For Free</a>
<p><br/>Also get exclusive access to the machine learning algorithms email mini-course.</p>
</center>
<p> </p>
<p> </p>
<h2>Predict the Onset of Diabetes</h2>
<p style="text-align: left;">The test problem we will use in this tutorial is the <a href="https://archive.ics.uci.edu/ml/datasets/Pima+Indians+Diabetes">Pima Indians Diabetes problem</a>.</p>
<p>This problem is comprised of 768 observations of medical details for Pima indians patents. The records describe instantaneous measurements taken from the patient such as their age, the number of times pregnant and blood workup. All patients are women aged 21 or older. All attributes are numeric, and their units vary from attribute to attribute.</p>
<p>Each record has a class value that indicates whether the patient suffered an onset of diabetes within 5 years of when the measurements were taken (1) or not (0).</p>
<p>This is a standard dataset that has been studied a lot in machine learning literature. A good prediction accuracy is 70%-76%.</p>
<p>Below is a sample from the <em>pima-indians.data.csv</em> file to get a sense of the data we will be working with (update: <a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/pima-indians-diabetes.data.csv">download from here</a>).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45506056553298" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Sample from the pima-indians.data.csv file</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
6,148,72,35,0,33.6,0.627,50,1
1,85,66,29,0,26.6,0.351,31,0
8,183,64,0,0,23.3,0.672,32,1
1,89,66,23,94,28.1,0.167,21,0
0,137,40,35,168,43.1,2.288,33,1</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45506056553298-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45506056553298-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe45506056553298-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45506056553298-4">4</div><div class="crayon-num" data-line="crayon-5c0ca9fe45506056553298-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45506056553298-1"><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-cn">148</span><span class="crayon-sy">,</span><span class="crayon-cn">72</span><span class="crayon-sy">,</span><span class="crayon-cn">35</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">33.6</span><span class="crayon-sy">,</span><span class="crayon-cn">0.627</span><span class="crayon-sy">,</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45506056553298-2"><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">85</span><span class="crayon-sy">,</span><span class="crayon-cn">66</span><span class="crayon-sy">,</span><span class="crayon-cn">29</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">26.6</span><span class="crayon-sy">,</span><span class="crayon-cn">0.351</span><span class="crayon-sy">,</span><span class="crayon-cn">31</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-5c0ca9fe45506056553298-3"><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-cn">183</span><span class="crayon-sy">,</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">23.3</span><span class="crayon-sy">,</span><span class="crayon-cn">0.672</span><span class="crayon-sy">,</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45506056553298-4"><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">89</span><span class="crayon-sy">,</span><span class="crayon-cn">66</span><span class="crayon-sy">,</span><span class="crayon-cn">23</span><span class="crayon-sy">,</span><span class="crayon-cn">94</span><span class="crayon-sy">,</span><span class="crayon-cn">28.1</span><span class="crayon-sy">,</span><span class="crayon-cn">0.167</span><span class="crayon-sy">,</span><span class="crayon-cn">21</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-5c0ca9fe45506056553298-5"><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">137</span><span class="crayon-sy">,</span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-cn">35</span><span class="crayon-sy">,</span><span class="crayon-cn">168</span><span class="crayon-sy">,</span><span class="crayon-cn">43.1</span><span class="crayon-sy">,</span><span class="crayon-cn">2.288</span><span class="crayon-sy">,</span><span class="crayon-cn">33</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p></p>
<h2>Naive Bayes Algorithm Tutorial</h2>
<p>This tutorial is broken down into the following steps:</p>
<ol>
<li><strong>Handle Data</strong>: Load the data from CSV file and split it into training and test datasets.</li>
<li><strong>Summarize Data</strong>: summarize the properties in the training dataset so that we can calculate probabilities and make predictions.</li>
<li><strong>Make a Prediction</strong>: Use the summaries of the dataset to generate a single prediction.</li>
<li><strong>Make Predictions</strong>: Generate predictions given a test dataset and a summarized training dataset.</li>
<li><strong>Evaluate Accuracy</strong>: Evaluate the accuracy of predictions made for a test dataset as the percentage correct out of all predictions made.</li>
<li><strong>Tie it Together</strong>: Use all of the code elements to present a complete and standalone implementation of the Naive Bayes algorithm.</li>
</ol>
<h3>1. Handle Data</h3>
<p>The first thing we need to do is load our data file. The data is in CSV format without a header line or any quotes. We can open the file with the open function and read the data lines using the reader function in the csv module.</p>
<p>We also need to convert the attributes that were loaded as strings into numbers that we can work with them. Below is the <strong>loadCsv()</strong> function for loading the Pima indians dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45514279647793" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Load a CSV file of scalars into memory</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
import csv
def loadCsv(filename):
	lines = csv.reader(open(filename, "rb"))
	dataset = list(lines)
	for i in range(len(dataset)):
		dataset[i] = [float(x) for x in dataset[i]]
	return dataset</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45514279647793-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45514279647793-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe45514279647793-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45514279647793-4">4</div><div class="crayon-num" data-line="crayon-5c0ca9fe45514279647793-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45514279647793-6">6</div><div class="crayon-num" data-line="crayon-5c0ca9fe45514279647793-7">7</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45514279647793-1"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">csv</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45514279647793-2"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">loadCsv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe45514279647793-3"><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">csv</span><span class="crayon-sy">.</span><span class="crayon-e">reader</span><span class="crayon-sy">(</span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"rb"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45514279647793-4"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">list</span><span class="crayon-sy">(</span><span class="crayon-v">lines</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe45514279647793-5"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45514279647793-6"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-k ">float</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca9fe45514279647793-7"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0021 seconds] -->
<p>We can test this function by loading the pima indians dataset and printing the number of data instances that were loaded.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45518043099240" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Test the loadCsv() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
filename = 'pima-indians-diabetes.data.csv'
dataset = loadCsv(filename)
print('Loaded data file {0} with {1} rows').format(filename, len(dataset))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45518043099240-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45518043099240-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe45518043099240-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45518043099240-1"><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'pima-indians-diabetes.data.csv'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45518043099240-2"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">loadCsv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe45518043099240-3"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Loaded data file {0} with {1} rows'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Running this test, you should see something like:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe4551b827462235" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Example output of testing the loadCsv() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Loaded data file pima-indians-diabetes.data.csv rows</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe4551b827462235-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe4551b827462235-1"><span class="crayon-e">Loaded </span><span class="crayon-e">data </span><span class="crayon-e">file </span><span class="crayon-v">pima</span><span class="crayon-o">-</span><span class="crayon-v">indians</span><span class="crayon-o">-</span><span class="crayon-v">diabetes</span><span class="crayon-sy">.</span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">csv </span><span class="crayon-v">rows</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Next we need to split the data into a training dataset that Naive Bayes can use to make predictions and a test dataset that we can use to evaluate the accuracy of the model. We need to split the data set randomly into train and datasets with a ratio of 67% train and 33% test (this is a common ratio for testing an algorithm on a dataset).</p>
<p>Below is the <strong>splitDataset()</strong> function that will split a given dataset into a given split ratio.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe4551e573637464" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Split a loaded dataset into a train and test datasets</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
import random
def splitDataset(dataset, splitRatio):
	trainSize = int(len(dataset) * splitRatio)
	trainSet = []
	copy = list(dataset)
	while len(trainSet) &lt; trainSize:
		index = random.randrange(len(copy))
		trainSet.append(copy.pop(index))
	return [trainSet, copy]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe4551e573637464-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4551e573637464-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe4551e573637464-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4551e573637464-4">4</div><div class="crayon-num" data-line="crayon-5c0ca9fe4551e573637464-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4551e573637464-6">6</div><div class="crayon-num" data-line="crayon-5c0ca9fe4551e573637464-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4551e573637464-8">8</div><div class="crayon-num" data-line="crayon-5c0ca9fe4551e573637464-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe4551e573637464-1"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">random</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4551e573637464-2"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">splitDataset</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">splitRatio</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe4551e573637464-3"><span class="crayon-h"> </span><span class="crayon-v">trainSize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">int</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">splitRatio</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4551e573637464-4"><span class="crayon-h"> </span><span class="crayon-v">trainSet</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca9fe4551e573637464-5"><span class="crayon-h"> </span><span class="crayon-k ">copy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">list</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4551e573637464-6"><span class="crayon-h"> </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">trainSet</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">trainSize</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe4551e573637464-7"><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-k ">copy</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4551e573637464-8"><span class="crayon-h"> </span><span class="crayon-v">trainSet</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-k ">copy</span><span class="crayon-sy">.</span><span class="crayon-e">pop</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe4551e573637464-9"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">trainSet</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">copy</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>We can test this out by defining a mock dataset with 5 instances, split it into training and testing datasets and print them out to see which data instances ended up where.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45521721567060" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Test the splitDataset() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
dataset = [[1], [2], [3], [4], [5]]
splitRatio = 0.67
train, test = splitDataset(dataset, splitRatio)
print('Split {0} rows into train with {1} and test with {2}').format(len(dataset), train, test)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45521721567060-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45521721567060-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe45521721567060-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45521721567060-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45521721567060-1"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">5</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45521721567060-2"><span class="crayon-v">splitRatio</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.67</span></div><div class="crayon-line" id="crayon-5c0ca9fe45521721567060-3"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">splitDataset</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">splitRatio</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45521721567060-4"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Split {0} rows into train with {1} and test with {2}'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">test</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Running this test, you should see something like:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45524255852504" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Example output from testing the splitDataset() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Split 5 rows into train with [[4], [3], [5]] and test with [[1], [2]]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45524255852504-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45524255852504-1"><span class="crayon-i">Split</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-h"> </span><span class="crayon-e">rows </span><span class="crayon-e">into </span><span class="crayon-e">train </span><span class="crayon-i">with</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">5</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-e">test </span><span class="crayon-i">with</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<h3>2. Summarize Data</h3>
<p>The naive bayes model is comprised of a summary of the data in the training dataset. This summary is then used when making predictions.</p>
<p>The summary of the training data collected involves the mean and the standard deviation for each attribute, by class value. For example, if there are two class values and 7 numerical attributes, then we need a mean and standard deviation for each attribute (7) and class value (2) combination, that is 14 attribute summaries.</p>
<p>These are required when making predictions to calculate the probability of specific attribute values belonging to each class value.</p>
<p>We can break the preparation of this summary data down into the following sub-tasks:</p>
<ol>
<li>Separate Data By Class</li>
<li>Calculate Mean</li>
<li>Calculate Standard Deviation</li>
<li>Summarize Dataset</li>
<li>Summarize Attributes By Class</li>
</ol>
<h4>Separate Data By Class</h4>
<p>The first task is to separate the training dataset instances by class value so that we can calculate statistics for each class. We can do that by creating a map of each class value to a list of instances that belong to that class and sort the entire dataset of instances into the appropriate lists.</p>
<p>The <strong>separateByClass()</strong> function below does just this.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45529203067115" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">The separateByClass() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
def separateByClass(dataset):
	separated = {}
	for i in range(len(dataset)):
		vector = dataset[i]
		if (vector[-1] not in separated):
			separated[vector[-1]] = []
		separated[vector[-1]].append(vector)
	return separated</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45529203067115-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45529203067115-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe45529203067115-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45529203067115-4">4</div><div class="crayon-num" data-line="crayon-5c0ca9fe45529203067115-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45529203067115-6">6</div><div class="crayon-num" data-line="crayon-5c0ca9fe45529203067115-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45529203067115-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45529203067115-1"><span class="crayon-e">def </span><span class="crayon-e">separateByClass</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45529203067115-2"><span class="crayon-h"> </span><span class="crayon-v">separated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5c0ca9fe45529203067115-3"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45529203067115-4"><span class="crayon-h"> </span><span class="crayon-v">vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca9fe45529203067115-5"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">vector</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">separated</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45529203067115-6"><span class="crayon-h"> </span><span class="crayon-v">separated</span><span class="crayon-sy">[</span><span class="crayon-v">vector</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca9fe45529203067115-7"><span class="crayon-h"> </span><span class="crayon-v">separated</span><span class="crayon-sy">[</span><span class="crayon-v">vector</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">vector</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45529203067115-8"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">separated</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>You can see that the function assumes that the last attribute (-1) is the class value. The function returns a map of class values to lists of data instances.</p>
<p>We can test this function with some sample data, as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe4552d758121709" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Testing the separateByClass() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
dataset = [[1,20,1], [2,21,0], [3,22,1]]
separated = separateByClass(dataset)
print('Separated instances: {0}').format(separated)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe4552d758121709-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4552d758121709-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe4552d758121709-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe4552d758121709-1"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">21</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">22</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4552d758121709-2"><span class="crayon-v">separated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">separateByClass</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe4552d758121709-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Separated instances: {0}'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">format</span><span class="crayon-sy">(</span><span class="crayon-v">separated</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Running this test, you should see something like:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45530197797501" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Output when testing the separateByClass() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Separated instances: {0: [[2, 21, 0]], 1: [[1, 20, 1], [3, 22, 1]]}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45530197797501-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45530197797501-1"><span class="crayon-e">Separated </span><span class="crayon-v">instances</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">22</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<h4>Calculate Mean</h4>
<p>We need to calculate the mean of each attribute for a class value. The mean is the central middle or central tendency of the data, and we will use it as the middle of our gaussian distribution when calculating probabilities.</p>
<p>We also need to calculate the standard deviation of each attribute for a class value. The standard deviation describes the variation of spread of the data, and we will use it to characterize the expected spread of each attribute in our Gaussian distribution when calculating probabilities.</p>
<p>The standard deviation is calculated as the square root of the variance. The variance is calculated as the average of the squared differences for each attribute value from the mean. Note we are using the N-1 method, which subtracts 1 from the number of attribute values when calculating the variance.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45533699422333" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Functions to calculate the mean and standard deviations of attributes</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
import math
def mean(numbers):
	return sum(numbers)/float(len(numbers))

def stdev(numbers):
	avg = mean(numbers)
	variance = sum([pow(x-avg,2) for x in numbers])/float(len(numbers)-1)
	return math.sqrt(variance)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45533699422333-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45533699422333-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe45533699422333-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45533699422333-4">4</div><div class="crayon-num" data-line="crayon-5c0ca9fe45533699422333-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45533699422333-6">6</div><div class="crayon-num" data-line="crayon-5c0ca9fe45533699422333-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45533699422333-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45533699422333-1"><span class="crayon-e">import </span><span class="crayon-e">math</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45533699422333-2"><span class="crayon-e">def </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">numbers</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe45533699422333-3"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">numbers</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">numbers</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45533699422333-4"> </div><div class="crayon-line" id="crayon-5c0ca9fe45533699422333-5"><span class="crayon-e">def </span><span class="crayon-e">stdev</span><span class="crayon-sy">(</span><span class="crayon-v">numbers</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45533699422333-6"><span class="crayon-h"> </span><span class="crayon-v">avg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">numbers</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe45533699422333-7"><span class="crayon-h"> </span><span class="crayon-v">variance</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">pow</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-o">-</span><span class="crayon-v">avg</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">numbers</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">numbers</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45533699422333-8"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">variance</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>We can test this by taking the mean of the numbers from 1 to 5.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45536204092526" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Code to test the mean() and stdev() functions</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
numbers = [1,2,3,4,5]
print('Summary of {0}: mean={1}, stdev={2}').format(numbers, mean(numbers), stdev(numbers))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45536204092526-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45536204092526-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45536204092526-1"><span class="crayon-v">numbers</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45536204092526-2"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Summary of {0}: mean={1}, stdev={2}'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">format</span><span class="crayon-sy">(</span><span class="crayon-v">numbers</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">numbers</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">stdev</span><span class="crayon-sy">(</span><span class="crayon-v">numbers</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Running this test, you should see something like:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45538898724567" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Output of testing the mean() and stdev() functions</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Summary of [1, 2, 3, 4, 5]: mean=3.0, stdev=1.58113883008</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45538898724567-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45538898724567-1"><span class="crayon-e">Summary </span><span class="crayon-i">of</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">]</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-o">=</span><span class="crayon-cn">3.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-o">=</span><span class="crayon-cn">1.58113883008</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<h4>Summarize Dataset</h4>
<p>Now we have the tools to summarize a dataset. For a given list of instances (for a class value) we can calculate the mean and the standard deviation for each attribute.</p>
<p>The zip function groups the values for each attribute across our data instances into their own lists so that we can compute the mean and standard deviation values for the attribute.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe4553b677192953" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">The summarize() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
def summarize(dataset):
	summaries = [(mean(attribute), stdev(attribute)) for attribute in zip(*dataset)]
	del summaries[-1]
	return summaries</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe4553b677192953-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4553b677192953-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe4553b677192953-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4553b677192953-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe4553b677192953-1"><span class="crayon-e">def </span><span class="crayon-e">summarize</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4553b677192953-2"><span class="crayon-h"> </span><span class="crayon-v">summaries</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">attribute</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">stdev</span><span class="crayon-sy">(</span><span class="crayon-v">attribute</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">attribute </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-o">*</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca9fe4553b677192953-3"><span class="crayon-h"> </span><span class="crayon-e">del </span><span class="crayon-v">summaries</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4553b677192953-4"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">summaries</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>We can test this <strong>summarize()</strong> function with some test data that shows markedly different mean and standard deviation values for the first and second data attributes.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe4553e534770292" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Code to test the summarize() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
dataset = [[1,20,0], [2,21,1], [3,22,0]]
summary = summarize(dataset)
print('Attribute summaries: {0}').format(summary)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe4553e534770292-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4553e534770292-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe4553e534770292-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe4553e534770292-1"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">21</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">22</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4553e534770292-2"><span class="crayon-v">summary</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">summarize</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe4553e534770292-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Attribute summaries: {0}'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">format</span><span class="crayon-sy">(</span><span class="crayon-v">summary</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Running this test, you should see something like:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45541177461554" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Output of testing the summarize() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Attribute summaries: [(2.0, 1.0), (21.0, 1.0)]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45541177461554-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45541177461554-1"><span class="crayon-e">Attribute </span><span class="crayon-v">summaries</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-cn">2.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">21.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<h4>Summarize Attributes By Class</h4>
<p>We can pull it all together by first separating our training dataset into instances grouped by class. Then calculate the summaries for each attribute.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45544169613244" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">The summarizeByClass() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
def summarizeByClass(dataset):
	separated = separateByClass(dataset)
	summaries = {}
	for classValue, instances in separated.iteritems():
		summaries[classValue] = summarize(instances)
	return summaries</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45544169613244-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45544169613244-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe45544169613244-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45544169613244-4">4</div><div class="crayon-num" data-line="crayon-5c0ca9fe45544169613244-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45544169613244-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45544169613244-1"><span class="crayon-e">def </span><span class="crayon-e">summarizeByClass</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45544169613244-2"><span class="crayon-h"> </span><span class="crayon-v">separated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">separateByClass</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe45544169613244-3"><span class="crayon-h"> </span><span class="crayon-v">summaries</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45544169613244-4"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">classValue</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">instances </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">separated</span><span class="crayon-sy">.</span><span class="crayon-e">iteritems</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe45544169613244-5"><span class="crayon-h"> </span><span class="crayon-v">summaries</span><span class="crayon-sy">[</span><span class="crayon-v">classValue</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">summarize</span><span class="crayon-sy">(</span><span class="crayon-v">instances</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45544169613244-6"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">summaries</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>We can test this <strong>summarizeByClass()</strong> function with a small test dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45547844278420" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Code to test the summarizeByClass() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
dataset = [[1,20,1], [2,21,0], [3,22,1], [4,22,0]]
summary = summarizeByClass(dataset)
print('Summary by class value: {0}').format(summary)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45547844278420-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45547844278420-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe45547844278420-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45547844278420-1"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">21</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">22</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-cn">22</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45547844278420-2"><span class="crayon-v">summary</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">summarizeByClass</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe45547844278420-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Summary by class value: {0}'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">format</span><span class="crayon-sy">(</span><span class="crayon-v">summary</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>Running this test, you should see something like:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe4554a790555827" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Output from testing the summarizeByClass() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Summary by class value: 
{0: [(3.0, 1.4142135623730951), (21.5, 0.7071067811865476)], 
1: [(2.0, 1.4142135623730951), (21.0, 1.4142135623730951)]}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe4554a790555827-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4554a790555827-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe4554a790555827-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe4554a790555827-1"><span class="crayon-e">Summary </span><span class="crayon-e">by </span><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">:</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4554a790555827-2"><span class="crayon-sy">{</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-cn">3.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.4142135623730951</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">21.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7071067811865476</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5c0ca9fe4554a790555827-3"><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-cn">2.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.4142135623730951</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">21.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.4142135623730951</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<h3>3. Make Prediction</h3>
<p>We are now ready to make predictions using the summaries prepared from our training data. Making predictions involves calculating the probability that a given data instance belongs to each class, then selecting the class with the largest probability as the prediction.</p>
<p>We can divide this part into the following tasks:</p>
<ol>
<li>Calculate Gaussian Probability Density Function</li>
<li>Calculate Class Probabilities</li>
<li>Make a Prediction</li>
<li>Estimate Accuracy</li>
</ol>
<h4>Calculate Gaussian Probability Density Function</h4>
<p>We can use a Gaussian function to estimate the probability of a given attribute value, given the known mean and standard deviation for the attribute estimated from the training data.</p>
<p>Given that the attribute summaries where prepared for each attribute and class value, the result is the conditional probability of a given attribute value given a class value.</p>
<p>See the references for the details of this equation for the Gaussian probability density function. In summary we are plugging our known details into the Gaussian (attribute value, mean and standard deviation) and reading off the likelihood that our attribute value belongs to the class.</p>
<p>In the <strong>calculateProbability()</strong> function we calculate the exponent first, then calculate the main division. This lets us fit the equation nicely on two lines.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe4554d648686245" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">The calculateProbability() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
import math
def calculateProbability(x, mean, stdev):
	exponent = math.exp(-(math.pow(x-mean,2)/(2*math.pow(stdev,2))))
	return (1 / (math.sqrt(2*math.pi) * stdev)) * exponent</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe4554d648686245-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4554d648686245-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe4554d648686245-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4554d648686245-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe4554d648686245-1"><span class="crayon-e">import </span><span class="crayon-e">math</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4554d648686245-2"><span class="crayon-e">def </span><span class="crayon-e">calculateProbability</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe4554d648686245-3"><span class="crayon-h"> </span><span class="crayon-v">exponent</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-sy">(</span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">pow</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-o">-</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-o">*</span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">pow</span><span class="crayon-sy">(</span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4554d648686245-4"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-o">*</span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-v">pi</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">exponent</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>We can test this with some sample data, as follows.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45550416964453" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Code to test the calculateProbability() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
x = 71.5
mean = 73
stdev = 6.2
probability = calculateProbability(x, mean, stdev)
print('Probability of belonging to this class: {0}').format(probability)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45550416964453-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45550416964453-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe45550416964453-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45550416964453-4">4</div><div class="crayon-num" data-line="crayon-5c0ca9fe45550416964453-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45550416964453-1"><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">71.5</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45550416964453-2"><span class="crayon-v">mean</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">73</span></div><div class="crayon-line" id="crayon-5c0ca9fe45550416964453-3"><span class="crayon-v">stdev</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">6.2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45550416964453-4"><span class="crayon-v">probability</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">calculateProbability</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe45550416964453-5"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Probability of belonging to this class: {0}'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">format</span><span class="crayon-sy">(</span><span class="crayon-v">probability</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Running this test, you should see something like:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45552452473205" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Output from testing the calculateProbability() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Probability of belonging to this class: 0.0624896575937</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45552452473205-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45552452473205-1"><span class="crayon-e">Probability </span><span class="crayon-e">of </span><span class="crayon-e">belonging </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-r">this</span><span class="crayon-h"> </span><span class="crayon-t">class</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.0624896575937</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h4>Calculate Class Probabilities</h4>
<p>Now that we can calculate the probability of an attribute belonging to a class, we can combine the probabilities of all of the attribute values for a data instance and come up with a probability of the entire data instance belonging to the class.</p>
<p>We combine probabilities together by multiplying them. In the <strong>calculateClassProbabilities()</strong> below, the probability of a given data instance is calculated by multiplying together the attribute probabilities for each class. the result is a map of class values to probabilities.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45555605343240" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Code for the calculateClassProbabilities() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
def calculateClassProbabilities(summaries, inputVector):
	probabilities = {}
	for classValue, classSummaries in summaries.iteritems():
		probabilities[classValue] = 1
		for i in range(len(classSummaries)):
			mean, stdev = classSummaries[i]
			x = inputVector[i]
			probabilities[classValue] *= calculateProbability(x, mean, stdev)
	return probabilities</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45555605343240-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45555605343240-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe45555605343240-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45555605343240-4">4</div><div class="crayon-num" data-line="crayon-5c0ca9fe45555605343240-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45555605343240-6">6</div><div class="crayon-num" data-line="crayon-5c0ca9fe45555605343240-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45555605343240-8">8</div><div class="crayon-num" data-line="crayon-5c0ca9fe45555605343240-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45555605343240-1"><span class="crayon-e">def </span><span class="crayon-e">calculateClassProbabilities</span><span class="crayon-sy">(</span><span class="crayon-v">summaries</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputVector</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45555605343240-2"><span class="crayon-h"> </span><span class="crayon-v">probabilities</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5c0ca9fe45555605343240-3"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">classValue</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">classSummaries </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">summaries</span><span class="crayon-sy">.</span><span class="crayon-e">iteritems</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45555605343240-4"><span class="crayon-h"> </span><span class="crayon-v">probabilities</span><span class="crayon-sy">[</span><span class="crayon-v">classValue</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5c0ca9fe45555605343240-5"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">classSummaries</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45555605343240-6"><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">classSummaries</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca9fe45555605343240-7"><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">inputVector</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45555605343240-8"><span class="crayon-h"> </span><span class="crayon-v">probabilities</span><span class="crayon-sy">[</span><span class="crayon-v">classValue</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*=</span><span class="crayon-h"> </span><span class="crayon-e">calculateProbability</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe45555605343240-9"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">probabilities</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>We can test the <strong>calculateClassProbabilities()</strong> function.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45558854810361" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Code to test the calculateClassProbabilities() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
summaries = {0:[(1, 0.5)], 1:[(20, 5.0)]}
inputVector = [1.1, '?']
probabilities = calculateClassProbabilities(summaries, inputVector)
print('Probabilities for each class: {0}').format(probabilities)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45558854810361-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45558854810361-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe45558854810361-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45558854810361-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45558854810361-1"><span class="crayon-v">summaries</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5.0</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45558854810361-2"><span class="crayon-v">inputVector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'?'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca9fe45558854810361-3"><span class="crayon-v">probabilities</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">calculateClassProbabilities</span><span class="crayon-sy">(</span><span class="crayon-v">summaries</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputVector</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45558854810361-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Probabilities for each class: {0}'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">format</span><span class="crayon-sy">(</span><span class="crayon-v">probabilities</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>Running this test, you should see something like:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe4555a916802334" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Output from testing the calculateClassProbabilities() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Probabilities for each class: {0: 0.7820853879509118, 1: 6.298736258150442e-05}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe4555a916802334-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe4555a916802334-1"><span class="crayon-e">Probabilities </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-st">each</span><span class="crayon-h"> </span><span class="crayon-t">class</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.7820853879509118</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">6.298736258150442e</span><span class="crayon-o">-</span><span class="crayon-cn">05</span><span class="crayon-sy">}</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<h4>Make a Prediction</h4>
<p>Now that can calculate the probability of a data instance belonging to each class value, we can look for the largest probability and return the associated class.</p>
<p>The <strong>predict()</strong> function belong does just that.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe4555d762567003" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Implementation of the predict() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
def predict(summaries, inputVector):
	probabilities = calculateClassProbabilities(summaries, inputVector)
	bestLabel, bestProb = None, -1
	for classValue, probability in probabilities.iteritems():
		if bestLabel is None or probability &gt; bestProb:
			bestProb = probability
			bestLabel = classValue
	return bestLabel</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe4555d762567003-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4555d762567003-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe4555d762567003-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4555d762567003-4">4</div><div class="crayon-num" data-line="crayon-5c0ca9fe4555d762567003-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4555d762567003-6">6</div><div class="crayon-num" data-line="crayon-5c0ca9fe4555d762567003-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4555d762567003-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe4555d762567003-1"><span class="crayon-e">def </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">summaries</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputVector</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4555d762567003-2"><span class="crayon-h"> </span><span class="crayon-v">probabilities</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">calculateClassProbabilities</span><span class="crayon-sy">(</span><span class="crayon-v">summaries</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputVector</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe4555d762567003-3"><span class="crayon-h"> </span><span class="crayon-v">bestLabel</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">bestProb</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4555d762567003-4"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">classValue</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">probability </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">probabilities</span><span class="crayon-sy">.</span><span class="crayon-e">iteritems</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe4555d762567003-5"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">bestLabel </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-e">None </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-v">probability</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">bestProb</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4555d762567003-6"><span class="crayon-h"> </span><span class="crayon-v">bestProb</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">probability</span></div><div class="crayon-line" id="crayon-5c0ca9fe4555d762567003-7"><span class="crayon-e"> </span><span class="crayon-v">bestLabel</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">classValue</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4555d762567003-8"><span class="crayon-e"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">bestLabel</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>We can test the <strong>predict()</strong> function as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45560695882904" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Code to test the predict() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
summaries = {'A':[(1, 0.5)], 'B':[(20, 5.0)]}
inputVector = [1.1, '?']
result = predict(summaries, inputVector)
print('Prediction: {0}').format(result)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45560695882904-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45560695882904-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe45560695882904-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45560695882904-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45560695882904-1"><span class="crayon-v">summaries</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'A'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'B'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5.0</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45560695882904-2"><span class="crayon-v">inputVector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'?'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca9fe45560695882904-3"><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">summaries</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputVector</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45560695882904-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Prediction: {0}'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">format</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>Running this test, you should see something like:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45562717014228" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Output of testing the predict() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Prediction: A</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45562717014228-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45562717014228-1"><span class="crayon-v">Prediction</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">A</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h3>4. Make Predictions</h3>
<p>Finally, we can estimate the accuracy of the model by making predictions for each data instance in our test dataset. The <strong>getPredictions()</strong> will do this and return a list of predictions for each test instance.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45565195379080" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Code for the getPredictions() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
def getPredictions(summaries, testSet):
	predictions = []
	for i in range(len(testSet)):
		result = predict(summaries, testSet[i])
		predictions.append(result)
	return predictions</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45565195379080-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45565195379080-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe45565195379080-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45565195379080-4">4</div><div class="crayon-num" data-line="crayon-5c0ca9fe45565195379080-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45565195379080-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45565195379080-1"><span class="crayon-e">def </span><span class="crayon-e">getPredictions</span><span class="crayon-sy">(</span><span class="crayon-v">summaries</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testSet</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45565195379080-2"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca9fe45565195379080-3"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">testSet</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45565195379080-4"><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">summaries</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testSet</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe45565195379080-5"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45565195379080-6"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>We can test the <strong>getPredictions()</strong> function.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45568591442392" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Code to test the getPredictions() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
summaries = {'A':[(1, 0.5)], 'B':[(20, 5.0)]}
testSet = [[1.1, '?'], [19.1, '?']]
predictions = getPredictions(summaries, testSet)
print('Predictions: {0}').format(predictions)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45568591442392-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45568591442392-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe45568591442392-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45568591442392-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45568591442392-1"><span class="crayon-v">summaries</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'A'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'B'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5.0</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45568591442392-2"><span class="crayon-v">testSet</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">1.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'?'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">19.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'?'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca9fe45568591442392-3"><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">getPredictions</span><span class="crayon-sy">(</span><span class="crayon-v">summaries</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testSet</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45568591442392-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Predictions: {0}'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">format</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Running this test, you should see something like:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe4556b982408373" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Output from testing the getPredictions() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Predictions: ['A', 'B']</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe4556b982408373-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe4556b982408373-1"><span class="crayon-v">Predictions</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'A'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'B'</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h3>5. Get Accuracy</h3>
<p>The predictions can be compared to the class values in the test dataset and a classification accuracy can be calculated as an accuracy ratio between 0&amp; and 100%. The <strong>getAccuracy()</strong> will calculate this accuracy ratio.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe4556e391324022" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Code for the getAccuracy() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
def getAccuracy(testSet, predictions):
	correct = 0
	for x in range(len(testSet)):
		if testSet[x][-1] == predictions[x]:
			correct += 1
	return (correct/float(len(testSet))) * 100.0</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe4556e391324022-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4556e391324022-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe4556e391324022-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4556e391324022-4">4</div><div class="crayon-num" data-line="crayon-5c0ca9fe4556e391324022-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4556e391324022-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe4556e391324022-1"><span class="crayon-e">def </span><span class="crayon-e">getAccuracy</span><span class="crayon-sy">(</span><span class="crayon-v">testSet</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4556e391324022-2"><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-5c0ca9fe4556e391324022-3"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">testSet</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4556e391324022-4"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">testSet</span><span class="crayon-sy">[</span><span class="crayon-v">x</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">[</span><span class="crayon-v">x</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe4556e391324022-5"><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4556e391324022-6"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">correct</span><span class="crayon-o">/</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">testSet</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">100.0</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>We can test the <strong>getAccuracy()</strong> function using the sample code below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45571291748259" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Code to test the getAccuracy() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
testSet = [[1,1,1,'a'], [2,2,2,'a'], [3,3,3,'b']]
predictions = ['a', 'a', 'a']
accuracy = getAccuracy(testSet, predictions)
print('Accuracy: {0}').format(accuracy)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45571291748259-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45571291748259-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe45571291748259-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45571291748259-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45571291748259-1"><span class="crayon-v">testSet</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-s">'a'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-s">'a'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-s">'b'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45571291748259-2"><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'a'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'a'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'a'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca9fe45571291748259-3"><span class="crayon-v">accuracy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">getAccuracy</span><span class="crayon-sy">(</span><span class="crayon-v">testSet</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45571291748259-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy: {0}'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">format</span><span class="crayon-sy">(</span><span class="crayon-v">accuracy</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Running this test, you should see something like:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45574521555218" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Output from testing the getAccuracy() function</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Accuracy: 66.6666666667</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45574521555218-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45574521555218-1"><span class="crayon-v">Accuracy</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">66.6666666667</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h3>6. Tie it Together</h3>
<p>Finally, we need to tie it all together.</p>
<p>Below provides the full code listing for Naive Bayes implemented from scratch in Python.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe45576588210293" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Complete code for implementing Naive Bayes from scratch in Python</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Example of Naive Bayes implemented from Scratch in Python
import csv
import random
import math

def loadCsv(filename):
	lines = csv.reader(open(filename, "rb"))
	dataset = list(lines)
	for i in range(len(dataset)):
		dataset[i] = [float(x) for x in dataset[i]]
	return dataset

def splitDataset(dataset, splitRatio):
	trainSize = int(len(dataset) * splitRatio)
	trainSet = []
	copy = list(dataset)
	while len(trainSet) &lt; trainSize:
		index = random.randrange(len(copy))
		trainSet.append(copy.pop(index))
	return [trainSet, copy]

def separateByClass(dataset):
	separated = {}
	for i in range(len(dataset)):
		vector = dataset[i]
		if (vector[-1] not in separated):
			separated[vector[-1]] = []
		separated[vector[-1]].append(vector)
	return separated

def mean(numbers):
	return sum(numbers)/float(len(numbers))

def stdev(numbers):
	avg = mean(numbers)
	variance = sum([pow(x-avg,2) for x in numbers])/float(len(numbers)-1)
	return math.sqrt(variance)

def summarize(dataset):
	summaries = [(mean(attribute), stdev(attribute)) for attribute in zip(*dataset)]
	del summaries[-1]
	return summaries

def summarizeByClass(dataset):
	separated = separateByClass(dataset)
	summaries = {}
	for classValue, instances in separated.iteritems():
		summaries[classValue] = summarize(instances)
	return summaries

def calculateProbability(x, mean, stdev):
	exponent = math.exp(-(math.pow(x-mean,2)/(2*math.pow(stdev,2))))
	return (1 / (math.sqrt(2*math.pi) * stdev)) * exponent

def calculateClassProbabilities(summaries, inputVector):
	probabilities = {}
	for classValue, classSummaries in summaries.iteritems():
		probabilities[classValue] = 1
		for i in range(len(classSummaries)):
			mean, stdev = classSummaries[i]
			x = inputVector[i]
			probabilities[classValue] *= calculateProbability(x, mean, stdev)
	return probabilities
			
def predict(summaries, inputVector):
	probabilities = calculateClassProbabilities(summaries, inputVector)
	bestLabel, bestProb = None, -1
	for classValue, probability in probabilities.iteritems():
		if bestLabel is None or probability &gt; bestProb:
			bestProb = probability
			bestLabel = classValue
	return bestLabel

def getPredictions(summaries, testSet):
	predictions = []
	for i in range(len(testSet)):
		result = predict(summaries, testSet[i])
		predictions.append(result)
	return predictions

def getAccuracy(testSet, predictions):
	correct = 0
	for i in range(len(testSet)):
		if testSet[i][-1] == predictions[i]:
			correct += 1
	return (correct/float(len(testSet))) * 100.0

def main():
	filename = 'pima-indians-diabetes.data.csv'
	splitRatio = 0.67
	dataset = loadCsv(filename)
	trainingSet, testSet = splitDataset(dataset, splitRatio)
	print('Split {0} rows into train={1} and test={2} rows').format(len(dataset), len(trainingSet), len(testSet))
	# prepare model
	summaries = summarizeByClass(trainingSet)
	# test model
	predictions = getPredictions(summaries, testSet)
	accuracy = getAccuracy(testSet, predictions)
	print('Accuracy: {0}%').format(accuracy)

main()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-4">4</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-6">6</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-8">8</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-10">10</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-12">12</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-14">14</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-16">16</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-18">18</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-20">20</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-22">22</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-24">24</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-26">26</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-28">28</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-30">30</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-32">32</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-34">34</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-36">36</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-38">38</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-40">40</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-42">42</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-44">44</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-46">46</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-48">48</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-50">50</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-52">52</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-54">54</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-56">56</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-58">58</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-60">60</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-62">62</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-64">64</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-66">66</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-68">68</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-70">70</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-72">72</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-74">74</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-76">76</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-78">78</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-80">80</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-82">82</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-84">84</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-86">86</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-88">88</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-90">90</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-92">92</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-94">94</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-96">96</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-98">98</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe45576588210293-100">100</div><div class="crayon-num" data-line="crayon-5c0ca9fe45576588210293-101">101</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-1"><span class="crayon-c"># Example of Naive Bayes implemented from Scratch in Python</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-2"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">csv</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">random</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-4"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">math</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-5"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-6"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">loadCsv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-7"><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">csv</span><span class="crayon-sy">.</span><span class="crayon-e">reader</span><span class="crayon-sy">(</span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"rb"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-8"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">list</span><span class="crayon-sy">(</span><span class="crayon-v">lines</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-9"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-10"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-k ">float</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-11"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-12"> </div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-13"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">splitDataset</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">splitRatio</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-14"><span class="crayon-h"> </span><span class="crayon-v">trainSize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">int</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">splitRatio</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-15"><span class="crayon-h"> </span><span class="crayon-v">trainSet</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-16"><span class="crayon-h"> </span><span class="crayon-k ">copy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">list</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-17"><span class="crayon-h"> </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">trainSet</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">trainSize</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-18"><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-k ">copy</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-19"><span class="crayon-h"> </span><span class="crayon-v">trainSet</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-k ">copy</span><span class="crayon-sy">.</span><span class="crayon-e">pop</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-20"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">trainSet</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">copy</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-21"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-22"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">separateByClass</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-23"><span class="crayon-h"> </span><span class="crayon-v">separated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-24"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-25"><span class="crayon-h"> </span><span class="crayon-v">vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-26"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">vector</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">separated</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-27"><span class="crayon-h"> </span><span class="crayon-v">separated</span><span class="crayon-sy">[</span><span class="crayon-v">vector</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-28"><span class="crayon-h"> </span><span class="crayon-v">separated</span><span class="crayon-sy">[</span><span class="crayon-v">vector</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">vector</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-29"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">separated</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-30"> </div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-31"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-k ">numbers</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-32"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-k ">numbers</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-k ">float</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-k ">numbers</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-33"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-34"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">stdev</span><span class="crayon-sy">(</span><span class="crayon-k ">numbers</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-35"><span class="crayon-h"> </span><span class="crayon-v">avg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-k ">numbers</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-36"><span class="crayon-h"> </span><span class="crayon-v">variance</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-k ">pow</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-o">-</span><span class="crayon-v">avg</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">numbers</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-k ">float</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-k ">numbers</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-37"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-k ">math</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">variance</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-38"> </div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-39"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">summarize</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-40"><span class="crayon-h"> </span><span class="crayon-v">summaries</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">attribute</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">stdev</span><span class="crayon-sy">(</span><span class="crayon-v">attribute</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">attribute </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">zip</span><span class="crayon-sy">(</span><span class="crayon-o">*</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-41"><span class="crayon-h"> </span><span class="crayon-r">del</span><span class="crayon-h"> </span><span class="crayon-v">summaries</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-42"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">summaries</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-43"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-44"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">summarizeByClass</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-45"><span class="crayon-h"> </span><span class="crayon-v">separated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">separateByClass</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-46"><span class="crayon-h"> </span><span class="crayon-v">summaries</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-47"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">classValue</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">instances </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">separated</span><span class="crayon-sy">.</span><span class="crayon-e">iteritems</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-48"><span class="crayon-h"> </span><span class="crayon-v">summaries</span><span class="crayon-sy">[</span><span class="crayon-v">classValue</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">summarize</span><span class="crayon-sy">(</span><span class="crayon-v">instances</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-49"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">summaries</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-50"> </div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-51"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">calculateProbability</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-52"><span class="crayon-h"> </span><span class="crayon-v">exponent</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">math</span><span class="crayon-sy">.</span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-sy">(</span><span class="crayon-k ">math</span><span class="crayon-sy">.</span><span class="crayon-k ">pow</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-o">-</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-o">*</span><span class="crayon-k ">math</span><span class="crayon-sy">.</span><span class="crayon-k ">pow</span><span class="crayon-sy">(</span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-53"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-k ">math</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-o">*</span><span class="crayon-k ">math</span><span class="crayon-sy">.</span><span class="crayon-v">pi</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">exponent</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-54"> </div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-55"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">calculateClassProbabilities</span><span class="crayon-sy">(</span><span class="crayon-v">summaries</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputVector</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-56"><span class="crayon-h"> </span><span class="crayon-v">probabilities</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-57"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">classValue</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">classSummaries </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">summaries</span><span class="crayon-sy">.</span><span class="crayon-e">iteritems</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-58"><span class="crayon-h"> </span><span class="crayon-v">probabilities</span><span class="crayon-sy">[</span><span class="crayon-v">classValue</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-59"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">classSummaries</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-60"><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">classSummaries</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-61"><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">inputVector</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-62"><span class="crayon-h"> </span><span class="crayon-v">probabilities</span><span class="crayon-sy">[</span><span class="crayon-v">classValue</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*=</span><span class="crayon-h"> </span><span class="crayon-e">calculateProbability</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-63"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">probabilities</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-64"><span class="crayon-e"> </span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-65"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">summaries</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputVector</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-66"><span class="crayon-h"> </span><span class="crayon-v">probabilities</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">calculateClassProbabilities</span><span class="crayon-sy">(</span><span class="crayon-v">summaries</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputVector</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-67"><span class="crayon-h"> </span><span class="crayon-v">bestLabel</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">bestProb</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">None</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-68"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">classValue</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">probability </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">probabilities</span><span class="crayon-sy">.</span><span class="crayon-e">iteritems</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-69"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">bestLabel </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-t">None</span><span class="crayon-h"> </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-v">probability</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">bestProb</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-70"><span class="crayon-h"> </span><span class="crayon-v">bestProb</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">probability</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-71"><span class="crayon-e"> </span><span class="crayon-v">bestLabel</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">classValue</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-72"><span class="crayon-e"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">bestLabel</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-73"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-74"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">getPredictions</span><span class="crayon-sy">(</span><span class="crayon-v">summaries</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testSet</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-75"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-76"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">testSet</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-77"><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">summaries</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testSet</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-78"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-79"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">predictions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-80"> </div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-81"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">getAccuracy</span><span class="crayon-sy">(</span><span class="crayon-v">testSet</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-82"><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-83"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">testSet</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-84"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">testSet</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-85"><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-86"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">correct</span><span class="crayon-o">/</span><span class="crayon-k ">float</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">testSet</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">100.0</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-87"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-88"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-89"><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'pima-indians-diabetes.data.csv'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-90"><span class="crayon-h"> </span><span class="crayon-v">splitRatio</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.67</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-91"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">loadCsv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-92"><span class="crayon-h"> </span><span class="crayon-v">trainingSet</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testSet</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">splitDataset</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">splitRatio</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-93"><span class="crayon-h"> </span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Split {0} rows into train={1} and test={2} rows'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">trainingSet</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">testSet</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-94"><span class="crayon-h"> </span><span class="crayon-c"># prepare model</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-95"><span class="crayon-h"> </span><span class="crayon-v">summaries</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">summarizeByClass</span><span class="crayon-sy">(</span><span class="crayon-v">trainingSet</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-96"><span class="crayon-h"> </span><span class="crayon-c"># test model</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-97"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">getPredictions</span><span class="crayon-sy">(</span><span class="crayon-v">summaries</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testSet</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-98"><span class="crayon-h"> </span><span class="crayon-v">accuracy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">getAccuracy</span><span class="crayon-sy">(</span><span class="crayon-v">testSet</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-99"><span class="crayon-h"> </span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy: {0}%'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">accuracy</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe45576588210293-100"> </div><div class="crayon-line" id="crayon-5c0ca9fe45576588210293-101"><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0109 seconds] -->
<p>Running the example provides output like the following:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe4557a821790860" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">Output from running the final code</span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Split 768 rows into train=514 and test=254 rows
Accuracy: 76.3779527559%</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe4557a821790860-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4557a821790860-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe4557a821790860-1"><span class="crayon-i">Split</span><span class="crayon-h"> </span><span class="crayon-cn">768</span><span class="crayon-h"> </span><span class="crayon-e">rows </span><span class="crayon-e">into </span><span class="crayon-v">train</span><span class="crayon-o">=</span><span class="crayon-cn">514</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-o">=</span><span class="crayon-cn">254</span><span class="crayon-h"> </span><span class="crayon-e">rows</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4557a821790860-2"><span class="crayon-v">Accuracy</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">76.3779527559</span><span class="crayon-o">%</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<h2>Implementation Extensions</h2>
<p>This section provides you with ideas for extensions that you could apply and investigate with the Python code you have implemented as part of this tutorial.</p>
<p>You have implemented your own version of Gaussian Naive Bayes in python from scratch.</p>
<p>You can extend the implementation further.</p>
<ul>
<li><strong>Calculate Class Probabilities</strong>: Update the example to summarize the probabilities of a data instance belonging to each class as a ratio. This can be calculated as the probability of a data instance belonging to one class, divided by the sum of the probabilities of the data instance belonging to each class. For example an instance had the probability of 0.02 for class A and 0.001 for class B, the likelihood of the instance belonging to class A is (0.02/(0.02+0.001))*100 which is about 95.23%.</li>
<li><strong>Log Probabilities</strong>: The conditional probabilities for each class given an attribute value are small. When they are multiplied together they result in very small values, which can lead to floating point underflow (numbers too small to represent in Python). A common fix for this is to combine the log of the probabilities together. Research and implement this improvement.</li>
<li><strong>Nominal Attributes</strong>: Update the implementation to support nominal attributes. This is much similar and the summary information you can collect for each attribute is the ratio of category values for each class. Dive into the references for more information.</li>
<li><strong>Different Density Function</strong> (<em>bernoulli</em> or <em>multinomial</em>): We have looked at Gaussian Naive Bayes, but you can also look at other distributions. Implement a different distribution such as multinomial, bernoulli or kernel naive bayes that make different assumptions about the distribution of attribute values and/or their relationship with the class value.</li>
</ul>
<h2>Resources and Further Reading</h2>
<p>This section will provide some resources that you can use to learn more about the Naive Bayes algorithm in terms of both theory of how and why it works and practical concerns for implementing it in code.</p>
<h3>Problem</h3>
<p>More resources for learning about the problem of predicting the onset of diabetes.</p>
<ul>
<li><a href="https://archive.ics.uci.edu/ml/datasets/Pima+Indians+Diabetes">Pima Indians Diabetes Data Set</a>: This page provides access to the dataset files, describes the attributes and lists papers that use the dataset.</li>
<li><a href="https://archive.ics.uci.edu/ml/machine-learning-databases/pima-indians-diabetes/pima-indians-diabetes.data">Dataset File</a>: The dataset file.</li>
<li><a href="https://archive.ics.uci.edu/ml/machine-learning-databases/pima-indians-diabetes/pima-indians-diabetes.names">Dataset Summary</a>: Description of the dataset attributes.</li>
<li><a href="http://www.is.umk.pl/projects/datasets.html#Diabetes">Diabetes Dataset Results</a>: The accuracy of many standard algorithms on this dataset.</li>
</ul>
<h3>Code</h3>
<p>This section links to open source implementations of Naive Bayes in popular machine learning libraries. Review these if you are considering implementing your own version of the method for operational use.</p>
<ul>
<li><a href="https://github.com/scikit-learn/scikit-learn/blob/master/sklearn/naive_bayes.py">Naive Bayes in Scikit-Learn</a>: Implementation of naive bayes in the scikit-learn library.</li>
<li><a href="http://scikit-learn.org/stable/modules/naive_bayes.html">Naive Bayes documentation</a>: Scikit-Learn documentation and sample code for Naive Bayes</li>
</ul>
<h3>Books</h3>
<p>You may have one or more books on applied machine learning. This section highlights the sections or chapters in common applied books on machine learning that refer to Naive Bayes.</p>
<ul>
<li><a class="easyazon-link" href="http://www.amazon.com/dp/1461468485?tag=inspiredalgor-20">Applied Predictive Modeling</a>, page 353</li>
<li><a class="easyazon-link" href="http://www.amazon.com/dp/0123748569?tag=inspiredalgor-20">Data Mining: Practical Machine Learning Tools and Techniques</a>, page 94</li>
<li><a class="easyazon-link" href="http://www.amazon.com/dp/1449303714?tag=inspiredalgor-20">Machine Learning for Hackers</a>, page 78</li>
<li><a class="easyazon-link" href="http://www.amazon.com/dp/1461471370?tag=inspiredalgor-20">An Introduction to Statistical Learning: with Applications in R</a>, page 138</li>
<li><a class="easyazon-link" href="http://www.amazon.com/dp/1420067184?tag=inspiredalgor-20">Machine Learning: An Algorithmic Perspective</a>, page 171</li>
<li><a class="easyazon-link" href="http://www.amazon.com/dp/1617290181?tag=inspiredalgor-20">Machine Learning in Action</a>, page 61 (Chapter 4)</li>
<li><a class="easyazon-link" href="http://www.amazon.com/dp/0070428077?tag=inspiredalgor-20">Machine Learning</a>, page 177 (chapter 6)</li>
</ul>
<h2>Next Step</h2>
<p>Take action.</p>
<p>Follow the tutorial and implement Naive Bayes from scratch. Adapt the example to another problem. Follow the extensions and improve upon the implementation.</p>
<p>Leave a comment and share your experiences.</p>
<p><strong>Update</strong>: Check out the follow-up on tips for using the naive bayes algorithm titled: “<a href="http://machinelearningmastery.com/better-naive-bayes/" title="Better Naive Bayes: 12 Tips To Get The Most From The Naive Bayes Algorithm">Better Naive Bayes: 12 Tips To Get The Most From The Naive Bayes Algorithm</a>“</p>
<div class="awac-wrapper"><div class="awac widget text-37"> <div class="textwidget"><p></p><div class="woo-sc-hr"></div><br/>
<center>
<h2 style="text-align: center;">Want to Code Algorithms in Python Without Math?</h2>
<p><a href="/machine-learning-algorithms-from-scratch/"><img align="left" alt="Machine Learning Algorithms From Scratch" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningAlgorithmsFromScratch-220.png" style="border: 0;"/></a></p>
<h4>Code Your First Algorithm in Minutes</h4>
<p style="text-align: center;">…with step-by-step tutorials on real-world datasets</p>
<p style="text-align: center;">Discover how in my new Ebook:<br/>
<a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Machine Learning Algorithms From Scratch</a></p>
<p style="text-align: center;">It covers <strong>18 tutorials</strong> with all the code for <strong>12 top algorithms</strong>, like:<br/>Linear Regression, k-Nearest Neighbors, Stochastic Gradient Descent and much more…</p>
<h4>Finally, Pull Back the Curtain on <br/>Machine Learning Algorithms</h4>
<p style="text-align: center;">Skip the Academics. Just Results.</p>
<p style="text-align: center;"><a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Click to learn more</a>.</p>
<p></p></center><br/>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-1945 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+To+Implement+Naive+Bayes+From+Scratch+in+Python&amp;url=https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
</section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/lessons-learned-building-machine-learning-systems/" rel="prev"><i class="fa fa-angle-left"></i> Lessons Learned from Building Machine Learning Systems</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/better-naive-bayes/" rel="next">Better Naive Bayes: 12 Tips To Get The Most From The Naive Bayes Algorithm <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">201 Responses to <em>How To Implement Naive Bayes From Scratch in Python</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-170909">
<div class="comment-container" id="li-comment-170909">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/db0cdb0313f8be2959f7afc68636f937?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/db0cdb0313f8be2959f7afc68636f937?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">david jensen</span>
<span class="date">December 12, 2014 at 3:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-170909" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Statistical methods should be developed from scratch because of misunderstandings. Thank you.</p>
<div class="reply">
<a aria-label="Reply to david jensen" class="comment-reply-link" href="#comment-170909" onclick='return addComment.moveForm( "comment-170909", "170909", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-175649">
<div class="comment-container" id="li-comment-175649">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a283536208d5eccfde4c40624a93825f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a283536208d5eccfde4c40624a93825f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://anuragkulkarni.in" rel="external nofollow">Anurag</a></span>
<span class="date">December 14, 2014 at 1:11 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-175649" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is a wonderful article. Your blog is one of those blogs that I visit everyday. Thanks for sharing this stuff. I had a question about the programming language that should be used for building these algorithms from scratch. I know that Python is widely used because it’s easy to write code by importing useful libraries that are already available. Nevertheless, I am a C++ guy. Although I am a beginner in practical ML, I have tried to write efficient codes before I started learning and implementing ML. Now I am aware of the complexities involved in coding if you’re using C++: more coding is to be done than what is required in Python. Considering that, what language is your preference and under what situations? I know that it’s lame to ask about preferences of programming language as it is essentially a personal choice. But still I’d like you to share your take on this. Also try to share the trade-offs while choosing these programming languages. </p>
<p>Thank you.</p>
<div class="reply">
<a aria-label="Reply to Anurag" class="comment-reply-link" href="#comment-175649" onclick='return addComment.moveForm( "comment-175649", "175649", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-177124">
<div class="comment-container" id="li-comment-177124">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 15, 2014 at 7:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-177124" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Anurag</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-177124" onclick='return addComment.moveForm( "comment-177124", "177124", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-435170">
<div class="comment-container" id="li-comment-435170">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0a9627e47be62dbde8c75f5cdc7f75ac?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0a9627e47be62dbde8c75f5cdc7f75ac?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">SHRUTI</span>
<span class="date">April 17, 2018 at 12:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-435170" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am getting error while I try to implement this in my own dataset.<br/>
 for classValue, classSummaries in summaries.iteritems():</p>
<p>AttributeError: ‘list’ object has no attribute ‘iteritems’<br/>
When I try to run it,with your csv file,it says<br/>
ataset = list(lines)</p>
<p>Error: iterator should return strings, not bytes (did you open the file in text mode?)<br/>
What to do?</p>
<div class="reply">
<a aria-label="Reply to SHRUTI" class="comment-reply-link" href="#comment-435170" onclick='return addComment.moveForm( "comment-435170", "435170", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-435193">
<div class="comment-container" id="li-comment-435193">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 17, 2018 at 6:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-435193" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The code was written for Python 2.7. Perhaps you’re using Python 3?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435193" onclick='return addComment.moveForm( "comment-435193", "435193", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-453569">
<div class="comment-container" id="li-comment-453569">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/57c60e18c068f39275421ceff9e288d5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/57c60e18c068f39275421ceff9e288d5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chathu Raaksha</span>
<span class="date">November 3, 2018 at 9:36 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-453569" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>i m using python 3.6 do you have the updated code?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-453601">
<div class="comment-container" id="li-comment-453601">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 4, 2018 at 6:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-453601" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The version of naive bayes in the book supports Py2.7 and Py3.<br/>
<a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/" rel="nofollow">https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/</a></p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-4" id="comment-436223">
<div class="comment-container" id="li-comment-436223">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/db4a69d57b33983741f03d5ed29d0d06?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/db4a69d57b33983741f03d5ed29d0d06?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">fatih_conqueror</span>
<span class="date">April 29, 2018 at 6:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-436223" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>use items instead of iteritems. when you write  erorro message to google, you can find lots of resolve like stackoverflow.</p>
<div class="reply">
<a aria-label="Reply to fatih_conqueror" class="comment-reply-link" href="#comment-436223" onclick='return addComment.moveForm( "comment-436223", "436223", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-219677">
<div class="comment-container" id="li-comment-219677">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a439357fd7dcbb8bb477e3fde5beb1b5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a439357fd7dcbb8bb477e3fde5beb1b5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alcides Schulz</span>
<span class="date">January 15, 2015 at 12:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-219677" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, found your website and read it in one day. Thank you, it really helped me to understand ML and what to do.<br/>
I did the 2 examples here and I think I will take a look at scikit-learn now.<br/>
I have a personal project that I want to use ML, and I’ll keep you posted on the progress.</p>
<p>One small note on this post, is on the “1. Handle data” you refer to iris.data from previous post. </p>
<p>Thank you so much, example is really good to show how to do it. Please keep it coming.</p>
<div class="reply">
<a aria-label="Reply to Alcides Schulz" class="comment-reply-link" href="#comment-219677" onclick='return addComment.moveForm( "comment-219677", "219677", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-219959">
<div class="comment-container" id="li-comment-219959">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 15, 2015 at 7:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-219959" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the kind words Alcides.</p>
<p>Fixed the reference to the iris dataset.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-219959" onclick='return addComment.moveForm( "comment-219959", "219959", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-422219">
<div class="comment-container" id="li-comment-422219">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ef3bf013096c5d53e0ca8fe725faa62e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ef3bf013096c5d53e0ca8fe725faa62e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vivek</span>
<span class="date">December 5, 2017 at 9:45 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-422219" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi jason im not able to run the code and get the Output it says “No such file or directory: ‘pima-indians-diabetes.data.csv'”</p>
<div class="reply">
<a aria-label="Reply to vivek" class="comment-reply-link" href="#comment-422219" onclick='return addComment.moveForm( "comment-422219", "422219", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-422247">
<div class="comment-container" id="li-comment-422247">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 6, 2017 at 9:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-422247" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ensure you are running the code from the command line and that the data file and code file are in the same directory.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-422247" onclick='return addComment.moveForm( "comment-422247", "422247", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-447495">
<div class="comment-container" id="li-comment-447495">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c46e8a5b844bf219258d2035f46f6b05?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c46e8a5b844bf219258d2035f46f6b05?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">priya</span>
<span class="date">September 1, 2018 at 2:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-447495" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>is thetre any data file available</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-226308">
<div class="comment-container" id="li-comment-226308">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4a5f3734b60494cafde31590f20a1be7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4a5f3734b60494cafde31590f20a1be7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">toolate</span>
<span class="date">January 22, 2015 at 2:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-226308" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, still one more note on your post, is on the  “1. Handle data” the flower measures that you refer to iris.data.</p>
<div class="reply">
<a aria-label="Reply to toolate" class="comment-reply-link" href="#comment-226308" onclick='return addComment.moveForm( "comment-226308", "226308", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-226448">
<div class="comment-container" id="li-comment-226448">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 22, 2015 at 5:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-226448" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, fixed!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-226448" onclick='return addComment.moveForm( "comment-226448", "226448", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-238660">
<div class="comment-container" id="li-comment-238660">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b93f762f7f249cf8b2446212735edf92?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b93f762f7f249cf8b2446212735edf92?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tamilselvan</span>
<span class="date">February 4, 2015 at 11:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-238660" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great Article. Learned a Lot. Thanks. Thanks.</p>
<div class="reply">
<a aria-label="Reply to Tamilselvan" class="comment-reply-link" href="#comment-238660" onclick='return addComment.moveForm( "comment-238660", "238660", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-249322">
<div class="comment-container" id="li-comment-249322">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4350412bf3d53501ec820fc9228ba09f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4350412bf3d53501ec820fc9228ba09f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Abhinav kumar</span>
<span class="date">February 23, 2015 at 8:13 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-249322" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thank u</p>
<div class="reply">
<a aria-label="Reply to Abhinav kumar" class="comment-reply-link" href="#comment-249322" onclick='return addComment.moveForm( "comment-249322", "249322", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-249493">
<div class="comment-container" id="li-comment-249493">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 24, 2015 at 7:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-249493" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-249493" onclick='return addComment.moveForm( "comment-249493", "249493", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-257596">
<div class="comment-container" id="li-comment-257596">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5c17b263886ffde9ce61ee62e05157ae?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5c17b263886ffde9ce61ee62e05157ae?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://atopintelligence.com" rel="external nofollow">Roy</a></span>
<span class="date">March 7, 2015 at 2:53 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-257596" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for your nice article. I really appreciate the step by step instructions.</p>
<div class="reply">
<a aria-label="Reply to Roy" class="comment-reply-link" href="#comment-257596" onclick='return addComment.moveForm( "comment-257596", "257596", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-267885">
<div class="comment-container" id="li-comment-267885">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/08fee8409d86aa5ec51c95ac1348a9e8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/08fee8409d86aa5ec51c95ac1348a9e8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://google" rel="external nofollow">malini</a></span>
<span class="date">March 17, 2015 at 7:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-267885" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hello sir, plz tell me how to compare the data set using naive Bayes algorithm.</p>
<div class="reply">
<a aria-label="Reply to malini" class="comment-reply-link" href="#comment-267885" onclick='return addComment.moveForm( "comment-267885", "267885", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-272438">
<div class="comment-container" id="li-comment-272438">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cda89a341606584673820db6550829e7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cda89a341606584673820db6550829e7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Isha</span>
<span class="date">March 21, 2015 at 5:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-272438" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Why does the accuracy change every time you run this code?<br/>
when i tried running this code every time it gave me different accuracy percentage in the range from 70-78%<br/>
Why is it so?<br/>
Why is it not giving a constant accuracy percent?</p>
<div class="reply">
<a aria-label="Reply to Isha" class="comment-reply-link" href="#comment-272438" onclick='return addComment.moveForm( "comment-272438", "272438", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-288176">
<div class="comment-container" id="li-comment-288176">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ea919ca2b3f12bf3417173b52a834a34?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ea919ca2b3f12bf3417173b52a834a34?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Harry</span>
<span class="date">April 9, 2015 at 8:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-288176" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>As Splitting of dataset into testdata and traindata is done using a random function accuracy varies.</p>
<div class="reply">
<a aria-label="Reply to Harry" class="comment-reply-link" href="#comment-288176" onclick='return addComment.moveForm( "comment-288176", "288176", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-418111">
<div class="comment-container" id="li-comment-418111">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/74415d70439f4879f2c4cf4da07ca939?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/74415d70439f4879f2c4cf4da07ca939?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nitin Ramesh</span>
<span class="date">October 27, 2017 at 4:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-418111" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m extremely new to this concept so please help me with this query.</p>
<p>The algorithm splits the dataset into the same top 67% and bottom 33% every single time.<br/>
The test-set is same on every single run.</p>
<p> So even though we use a random function on the top 67%(training set) to randomly index them.<br/>
A calculation like<br/>
((4+2)/6) and ((2+4)/6) will yield same result every-time.How is this yielding different result?</p>
<p>Is this something to do with the order of calculation in the Gaussian probability density function?</p>
<div class="reply">
<a aria-label="Reply to Nitin Ramesh" class="comment-reply-link" href="#comment-418111" onclick='return addComment.moveForm( "comment-418111", "418111", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-4" id="comment-424446">
<div class="comment-container" id="li-comment-424446">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/23f055d37e66c3203fcaf41bc27555d7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/23f055d37e66c3203fcaf41bc27555d7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://gratatatata" rel="external nofollow">Abdul Salam</a></span>
<span class="date">December 22, 2017 at 10:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-424446" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>well.. the math calculations would come under to the view if you had the same sample taken again and again..</p>
<p>but the point here is.. we are taking the random data itself.. like.. the variables will not be same in every row right.. so if u change the rows randomly… at the end the accuracy will change… taken that into consideration.. you can take average of accuracy for each run to get what is the “UN-fluctuated accuracy” just in case if you want…</p>
<p>hope it helps..</p>
<div class="reply">
<a aria-label="Reply to Abdul Salam" class="comment-reply-link" href="#comment-424446" onclick='return addComment.moveForm( "comment-424446", "424446", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-276998">
<div class="comment-container" id="li-comment-276998">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d256ddaef31d8f825591cacc50a076bf?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d256ddaef31d8f825591cacc50a076bf?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sheepsy90</span>
<span class="date">March 25, 2015 at 8:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-276998" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey nice article – one question – why do you use the N-1 in the STD Deviation Process?</p>
<div class="reply">
<a aria-label="Reply to Sheepsy90" class="comment-reply-link" href="#comment-276998" onclick='return addComment.moveForm( "comment-276998", "276998", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-277362">
<div class="comment-container" id="li-comment-277362">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 26, 2015 at 5:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-277362" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks!</p>
<p>N-1 is the sample (corrected or unbiased) standard deviation. <a href="http://en.wikipedia.org/wiki/Standard_deviation#Corrected_sample_standard_deviation" rel="nofollow">See this wiki page</a>.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-277362" onclick='return addComment.moveForm( "comment-277362", "277362", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-287843">
<div class="comment-container" id="li-comment-287843">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6c056022b5a319a4bead1b84bd87c583?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6c056022b5a319a4bead1b84bd87c583?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vaishali</span>
<span class="date">April 8, 2015 at 6:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-287843" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey! Thanks a ton! This was very useful.<br/>
It would be great if you give an idea on how other metrics like precision and recall can be calculated.</p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Vaishali" class="comment-reply-link" href="#comment-287843" onclick='return addComment.moveForm( "comment-287843", "287843", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-293704">
<div class="comment-container" id="li-comment-293704">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5ee49f006023b148a634a6315d1059ae?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5ee49f006023b148a634a6315d1059ae?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://abes.ac.in" rel="external nofollow">Ashwin Perti</a></span>
<span class="date">April 24, 2015 at 5:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-293704" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sir</p>
<p>When I am running the same code in IDLE (python 2.7) – the code is working fine, but when I run the same code in eclipse. the error coming is:</p>
<p>1) warning – unused variable dataset<br/>
2) undefined variable dataset in for loop</p>
<p>Why this difference.</p>
<div class="reply">
<a aria-label="Reply to Ashwin Perti" class="comment-reply-link" href="#comment-293704" onclick='return addComment.moveForm( "comment-293704", "293704", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-299521">
<div class="comment-container" id="li-comment-299521">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9881d6ed67746c8623f40625d5fce94b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9881d6ed67746c8623f40625d5fce94b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Melvin Tjon Akon</span>
<span class="date">May 21, 2015 at 1:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-299521" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great post, Jason.<br/>
For a MBA/LLM, it makes naive bayes very easy to understand and to implement in legal coding. Looking forward to read more. Best, Melvin</p>
<div class="reply">
<a aria-label="Reply to Melvin Tjon Akon" class="comment-reply-link" href="#comment-299521" onclick='return addComment.moveForm( "comment-299521", "299521", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-302988">
<div class="comment-container" id="li-comment-302988">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a7b0942404ce68d34e79382e9a1874b6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a7b0942404ce68d34e79382e9a1874b6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Igor Balabine</span>
<span class="date">June 10, 2015 at 11:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-302988" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason,</p>
<p>Great example. Thanks! One nit: “calculateProbability” is not a good name for a function which actually calculates Gaussian probability density – pdf value may be greater than 1.</p>
<p>Cheers,</p>
<p>-Igor</p>
<div class="reply">
<a aria-label="Reply to Igor Balabine" class="comment-reply-link" href="#comment-302988" onclick='return addComment.moveForm( "comment-302988", "302988", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-372327">
<div class="comment-container" id="li-comment-372327">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cc6eef798eb541299129b82fd2b9b180?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cc6eef798eb541299129b82fd2b9b180?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">- Ruud -</span>
<span class="date">November 26, 2016 at 2:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-372327" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good point, thanks!</p>
<div class="reply">
<a aria-label="Reply to - Ruud -" class="comment-reply-link" href="#comment-372327" onclick='return addComment.moveForm( "comment-372327", "372327", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-306431">
<div class="comment-container" id="li-comment-306431">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4d036cc4679dcd40717fe640a33fba85?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4d036cc4679dcd40717fe640a33fba85?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex Ubot</span>
<span class="date">July 2, 2015 at 10:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-306431" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Fantastic post. I really learnt a lot. However I do have a question? Why don’ t you use the P(y) value in your calculateClassProbabilities() ?<br/>
If I understood the model correctly, everything is based on the bayes theorem :<br/>
P(y|x1….xn) = P(x1…..xn|y) * P(y) / P(x1……xn)<br/>
P(x1……xn) will be a constant so we can get rid of it.<br/>
Your post explain very well how to calculate P(x1……xn|y) (assumption made that x1…..xn are all independent we then have<br/>
P(x1……xn|y) = P(x1|y) * …. P(xn|y) )<br/>
How about p(y) ? I assume that we should calculate the frequency of the observation y in the training set and then multiply it to probabilities[classValue] so that we have :<br/>
P(y|x1…..xn) = frequency(classValue) * probabilities[classValue] </p>
<p>Otherwise let’ s assume that in a training set of 500 lines, we have two class 0 and 1 but observed 100 times 0 et 400 times 1. If we do not compute the frequency, then the probability may be biased, right ? Did I misunderstand something ? Hopefully my post is clear. I really hope that you will reply because I am a bit confused.</p>
<p>Thanks<br/>
Alex</p>
<div class="reply">
<a aria-label="Reply to Alex Ubot" class="comment-reply-link" href="#comment-306431" onclick='return addComment.moveForm( "comment-306431", "306431", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-342247">
<div class="comment-container" id="li-comment-342247">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7a6c28810e7ea47bb5b651dc99dd39eb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7a6c28810e7ea47bb5b651dc99dd39eb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://microsoft.com" rel="external nofollow">Babu</a></span>
<span class="date">February 28, 2016 at 7:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-342247" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have the same question – why is multiplying by p(y) is omitted?</p>
<div class="reply">
<a aria-label="Reply to Babu" class="comment-reply-link" href="#comment-342247" onclick='return addComment.moveForm( "comment-342247", "342247", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-343194">
<div class="comment-container" id="li-comment-343194">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7a6c28810e7ea47bb5b651dc99dd39eb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7a6c28810e7ea47bb5b651dc99dd39eb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://microsoft.com" rel="external nofollow">Babu</a></span>
<span class="date">March 10, 2016 at 2:09 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-343194" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No Answer yet – no one on internet has answer to this.</p>
<p>Just don’t want to accept answers without understanding it.</p>
<div class="reply">
<a aria-label="Reply to Babu" class="comment-reply-link" href="#comment-343194" onclick='return addComment.moveForm( "comment-343194", "343194", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-4" id="comment-346707">
<div class="comment-container" id="li-comment-346707">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b54e36b624d01b077c2e8c737adc8032?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b54e36b624d01b077c2e8c737adc8032?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://no" rel="external nofollow">frong</a></span>
<span class="date">April 3, 2016 at 3:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-346707" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>yeah，I have the same question too, maybe the P(y) is nessary ,but why the  accuracy is not so low when P(y) is missing? is it proving that bayes model is powerful?</p>
<div class="reply">
<a aria-label="Reply to frong" class="comment-reply-link" href="#comment-346707" onclick='return addComment.moveForm( "comment-346707", "346707", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-347195">
<div class="comment-container" id="li-comment-347195">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/62d73be498741e6bd51d298e1259d054?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/62d73be498741e6bd51d298e1259d054?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">gd</span>
<span class="date">April 7, 2016 at 2:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-347195" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi,</p>
<p>I believe this is because P(y) = 1 as classes are already segregated before calculating P(x1…xn|Y).</p>
<p>Can experts comment on this please?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-5" id="comment-351783">
<div class="comment-container" id="li-comment-351783">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7a6c28810e7ea47bb5b651dc99dd39eb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7a6c28810e7ea47bb5b651dc99dd39eb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Babu</span>
<span class="date">May 23, 2016 at 7:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-351783" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>There is huge bug in this implementation;</p>
<p>First of all the implementation using GaussianNB  gives totally a different answer.<br/>
Why is no one is replying even after 2 months of this.</p>
<p>My concern is, there are so many more bad bayesians in a wrong concept.<br/>
My lead read this article and now he thinks I am wrong </p>
<p>At least the parameters are correct – something wrong with calculating probs. </p>
<p>def SplitXy(Xy):<br/>
    Xy10=Xy[0:8]<br/>
    Xy10 = Xy;<br/>
    #print Xy10<br/>
    #print “========”<br/>
    zXy10=list(zip(*Xy10))<br/>
    y= zXy10[-1]<br/>
    del zXy10[-1]<br/>
    z1=zip(*zXy10)<br/>
    X=[list(t) for t in z1]<br/>
    return X,y</p>
<p>from sklearn.naive_bayes import GaussianNB<br/>
X,y = SplitXy(trainingSet)<br/>
Xt,yt = SplitXy(testSet)</p>
<p>model = GaussianNB()<br/>
model.fit(X, y)</p>
<p>### Compare the models built by Python</p>
<p>print (“Class: 0”)<br/>
for i,j in enumerate(model.theta_[0]):<br/>
    print (“({:8.2f} {:9.2f} {:7.2f} )”.format(j, model.sigma_[0][i], sqrt(model.sigma_[0][i])) , end=””)<br/>
    print (“==&gt; “, summaries[0][i])</p>
<p>print (“Class: 1”)<br/>
for i,j in enumerate(model.theta_[1]):<br/>
    print (“({:8.2f} {:9.2f} {:7.2f} )”.format(j, model.sigma_[1][i], sqrt(model.sigma_[1][i])) , end=””)<br/>
    print (“==&gt; “, summaries[1][i])</p>
<p>”’<br/>
Class: 0<br/>
(    3.18      9.06    3.01 )==&gt;  (3.1766467065868262, 3.0147673799630748)<br/>
(  109.12    699.16   26.44 )==&gt;  (109.11976047904191, 26.481293163857107)<br/>
(   68.71    286.46   16.93 )==&gt;  (68.712574850299404, 16.950414098038465)<br/>
(   19.74    228.74   15.12 )==&gt;  (19.742514970059879, 15.146913806453629)<br/>
(   68.64  10763.69  103.75 )==&gt;  (68.640718562874255, 103.90387227315443)<br/>
(   30.71     58.05    7.62 )==&gt;  (30.710778443113771, 7.630215185470916)<br/>
(    0.42      0.09    0.29 )==&gt;  (0.42285928143712581, 0.29409299864249266)<br/>
(   30.66    118.36   10.88 )==&gt;  (30.658682634730539, 10.895778423248444)<br/>
Class: 1<br/>
(    4.76     12.44    3.53 )==&gt;  (4.7611111111111111, 3.5365037952376928)<br/>
(  139.17   1064.54   32.63 )==&gt;  (139.17222222222222, 32.71833930500929)<br/>
(   69.27    525.24   22.92 )==&gt;  (69.272222222222226, 22.98209907114023)<br/>
(   22.64    309.59   17.60 )==&gt;  (22.638888888888889, 17.644143437447358)<br/>
(  101.13  20409.91  142.86 )==&gt;  (101.12777777777778, 143.2617649699204)<br/>
(   34.99     57.18    7.56 )==&gt;  (34.99388888888889, 7.5825893182809425)<br/>
(    0.54      0.14    0.37 )==&gt;  (0.53544444444444439, 0.3702077209795522)<br/>
(   36.73    112.86   10.62 )==&gt;  (36.727777777777774, 10.653417924304598)<br/>
”’</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-351710">
<div class="comment-container" id="li-comment-351710">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5309588ad289cf9e3fd33610724f3a33?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5309588ad289cf9e3fd33610724f3a33?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">EL YAMANI</span>
<span class="date">May 22, 2016 at 8:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-351710" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello,</p>
<p>Thanks for this article , it is very helpful .  I just have a remark about the probabilty that you are calculating which is  P(x|Ck) and then you make predictions, the result will be biased since you don’t multiply by P(Ck) ,  P(x) can be omitted since it’s only a normalisation constant.</p>
<div class="reply">
<a aria-label="Reply to EL YAMANI" class="comment-reply-link" href="#comment-351710" onclick='return addComment.moveForm( "comment-351710", "351710", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-308262">
<div class="comment-container" id="li-comment-308262">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a4c051e3f03f061660211f76bd145236?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a4c051e3f03f061660211f76bd145236?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.asmind.com" rel="external nofollow">Anand</a></span>
<span class="date">July 20, 2015 at 9:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-308262" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks a lot for this tutorial, Jason.</p>
<p>I have a quick question if you can help.</p>
<p>In the <code>separateByClass()</code> definition, I could not understand how <code>vector[-1]</code> is a right usage when <code>vector</code> is an <code>int</code> type object. </p>
<p>If I try the same commands one by one outside the function, the line of code with <code>vector[-1]</code> obviously throws a <code>TypeError: 'int' object has no attribute '__getitem__'</code>. </p>
<p>Then how is it working inside the function?</p>
<p>I am sorry for my ignorance. I am new to python. Thank you.</p>
<div class="reply">
<a aria-label="Reply to Anand" class="comment-reply-link" href="#comment-308262" onclick='return addComment.moveForm( "comment-308262", "308262", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-312764">
<div class="comment-container" id="li-comment-312764">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4220bf04024ae5c9a53d0dabb56abceb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4220bf04024ae5c9a53d0dabb56abceb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sarah</span>
<span class="date">August 26, 2015 at 5:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-312764" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason! I just wanted to leave a message to say thank you for the website. I am preparing for a job in this field and it has helped me so much. Keep up the amazing work!! 🙂</p>
<div class="reply">
<a aria-label="Reply to Sarah" class="comment-reply-link" href="#comment-312764" onclick='return addComment.moveForm( "comment-312764", "312764", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-312768">
<div class="comment-container" id="li-comment-312768">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 26, 2015 at 6:56 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-312768" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome! Thanks for leaving such a kind comment, you really made my day 🙂</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-312768" onclick='return addComment.moveForm( "comment-312768", "312768", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-314062">
<div class="comment-container" id="li-comment-314062">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4569fa38bd2a350b3dd24f9a5b62acc9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4569fa38bd2a350b3dd24f9a5b62acc9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jaime Lopez</span>
<span class="date">September 7, 2015 at 8:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-314062" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Very easy to follow your classifier. I try it and works well on your data, but is important to note that it works just on numerical databases, so maybe one have to transform your data from categorical to numerical format. </p>
<p>Another thing, when I transformed one database, sometimes the algorithm find division by zero error, although I avoided to use that number on features and classes.</p>
<p>Any suggestion Jason?</p>
<p>Thanks, Jaime</p>
<div class="reply">
<a aria-label="Reply to Jaime Lopez" class="comment-reply-link" href="#comment-314062" onclick='return addComment.moveForm( "comment-314062", "314062", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-347923">
<div class="comment-container" id="li-comment-347923">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3435643fd2949f714ca3fe438f57a56d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3435643fd2949f714ca3fe438f57a56d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">syed belgam</span>
<span class="date">April 11, 2016 at 2:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-347923" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to syed belgam" class="comment-reply-link" href="#comment-347923" onclick='return addComment.moveForm( "comment-347923", "347923", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-318047">
<div class="comment-container" id="li-comment-318047">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b6c2681c611a70e6670d9f4d6897e731?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b6c2681c611a70e6670d9f4d6897e731?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://ingenierobeta.com" rel="external nofollow">eduardo</a></span>
<span class="date">September 28, 2015 at 1:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-318047" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It is by far the best material I’ve found , please continue helping the community!</p>
<div class="reply">
<a aria-label="Reply to eduardo" class="comment-reply-link" href="#comment-318047" onclick='return addComment.moveForm( "comment-318047", "318047", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-318157">
<div class="comment-container" id="li-comment-318157">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 29, 2015 at 5:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-318157" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks eduardo!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-318157" onclick='return addComment.moveForm( "comment-318157", "318157", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-318276">
<div class="comment-container" id="li-comment-318276">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7f0977a656d3296f02f5e56e9a658579?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7f0977a656d3296f02f5e56e9a658579?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Thibroll</span>
<span class="date">September 29, 2015 at 9:11 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-318276" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello. </p>
<p>This is all well explained, and depicts well the steps of machine learning. But the way you calculate your P(y|X) here is false, and may lead to unwanted error.</p>
<p>Here, in theory, using the Bayes law, we know that : P(y|X) = P(y).P(X|y)/P(X). As we want to maximize P(y|X) with a given X, we can ignore P(X) and pick the result for the maximized value of P(y).P(X|y)</p>
<p>2 points remain inconsistent :<br/>
– First, you pick a gaussian distribution to estimate P(X|y). But here, you calculateProbability calculates the DENSITY of the function to the specific points X, y, with associated mean and deviation, and not the actual probability.<br/>
– The second point is that you don’t take into consideration the calculation of P(y) to estimate P(y|X). Your model (with the correct probability calculation) may work only if all samples have same amount in every value of y (considering y is discret), or if you are lucky enough.</p>
<p>Anyway, despite those mathematical issue, this is a good work, and a god introduction to machine learning.</p>
<div class="reply">
<a aria-label="Reply to Thibroll" class="comment-reply-link" href="#comment-318276" onclick='return addComment.moveForm( "comment-318276", "318276", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-320624">
<div class="comment-container" id="li-comment-320624">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7283c2eaf1870364c60526e7cab429ed?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7283c2eaf1870364c60526e7cab429ed?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://emmanueldetrinidad.wordpress.com" rel="external nofollow">mondet</a></span>
<span class="date">October 6, 2015 at 10:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-320624" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason for all this great material. One thing that i adore from you is the intellectual honesty, the spirit of collaboration and the parsimony. </p>
<p>In my opinion you are one of the best didactics exponents in the ML. </p>
<p>Thanks to Thibroll too. But i would like to have a real example of the problem in R, python or any other language. </p>
<p>Regards, </p>
<p>Emmanuel:.</p>
<div class="reply">
<a aria-label="Reply to mondet" class="comment-reply-link" href="#comment-320624" onclick='return addComment.moveForm( "comment-320624", "320624", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-324024">
<div class="comment-container" id="li-comment-324024">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0c941358a57eb178787668e940bb0187?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0c941358a57eb178787668e940bb0187?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Erika</span>
<span class="date">October 15, 2015 at 10:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-324024" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I have trying to get started with machine learning and your article has given me the much needed first push towards that. Thank you for your efforts! 🙂</p>
<div class="reply">
<a aria-label="Reply to Erika" class="comment-reply-link" href="#comment-324024" onclick='return addComment.moveForm( "comment-324024", "324024", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-329703">
<div class="comment-container" id="li-comment-329703">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f9996e4ea1d7831c92f6613316e94944?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f9996e4ea1d7831c92f6613316e94944?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Swagath</span>
<span class="date">November 9, 2015 at 5:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-329703" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>i need this code in java.. please help me//</p>
<div class="reply">
<a aria-label="Reply to Swagath" class="comment-reply-link" href="#comment-329703" onclick='return addComment.moveForm( "comment-329703", "329703", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-330391">
<div class="comment-container" id="li-comment-330391">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/874d1e2ec4ab0b00d88a8a1084304975?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/874d1e2ec4ab0b00d88a8a1084304975?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sarah</span>
<span class="date">November 16, 2015 at 11:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-330391" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am working with this code – tweaking it here or there – have found it very helpful as I implement a NB from scratch. I am trying to take the next step and add in categorical data. Any suggestions on where I can head to get ideas for how to add this? Or any particular functions/methods in Python you can recommend? I’ve brought in all the attributes and split them into two datasets for continuous vs. categorical so that I can work on them separately before bringing their probabilities back together. I’ve got the categorical in the same dictionary where the key is the class and the values are lists of attributes for each instance. I’m not sure how to go through the values to count frequencies and then how to store this back up so that I have the attribute values along with their frequencies/probabilities. A dictionary within a dictionary? Should I be going in another direction and not using a similar format?</p>
<div class="reply">
<a aria-label="Reply to Sarah" class="comment-reply-link" href="#comment-330391" onclick='return addComment.moveForm( "comment-330391", "330391", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-330870">
<div class="comment-container" id="li-comment-330870">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/56af6bf65b33462932f1f19c594851a4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/56af6bf65b33462932f1f19c594851a4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Emmanuel Nuakoh</span>
<span class="date">November 19, 2015 at 6:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-330870" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Jason, this tutorial is helping me with my implementation of NB algorithm for my PhD Dissertation. Very elaborate.</p>
<div class="reply">
<a aria-label="Reply to Emmanuel Nuakoh" class="comment-reply-link" href="#comment-330870" onclick='return addComment.moveForm( "comment-330870", "330870", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-338476">
<div class="comment-container" id="li-comment-338476">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4546027130a2afa97de6babcc59f91f9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4546027130a2afa97de6babcc59f91f9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anna</span>
<span class="date">January 14, 2016 at 2:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-338476" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi! thank you! Have you tried to do the same for the textual datasets, for example 20Newsgroups <a href="http://qwone.com/~jason/20Newsgroups/" rel="nofollow">http://qwone.com/~jason/20Newsgroups/</a> ? Would appreciate some hints or ideas )</p>
<div class="reply">
<a aria-label="Reply to Anna" class="comment-reply-link" href="#comment-338476" onclick='return addComment.moveForm( "comment-338476", "338476", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-338845">
<div class="comment-container" id="li-comment-338845">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/158fdbe5e85161a5fc1af9b39fbbcc6c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/158fdbe5e85161a5fc1af9b39fbbcc6c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Randy</span>
<span class="date">January 16, 2016 at 4:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-338845" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great article, but as others pointed out there are some mathematical mistakes like using the probability density function for single value probabilities.</p>
<div class="reply">
<a aria-label="Reply to Randy" class="comment-reply-link" href="#comment-338845" onclick='return addComment.moveForm( "comment-338845", "338845", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-341072">
<div class="comment-container" id="li-comment-341072">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/daafb9225bbfa01e1b1ac2da780bcd75?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/daafb9225bbfa01e1b1ac2da780bcd75?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Meghna</span>
<span class="date">February 7, 2016 at 7:45 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-341072" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for this amazing article!! I implemented the same for wine and MNIST data set and these tutorials helped me so much!! 🙂</p>
<div class="reply">
<a aria-label="Reply to Meghna" class="comment-reply-link" href="#comment-341072" onclick='return addComment.moveForm( "comment-341072", "341072", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-341080">
<div class="comment-container" id="li-comment-341080">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9cd1ebe113e086948593d70cbd28ce35?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9cd1ebe113e086948593d70cbd28ce35?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://wethepeople.be" rel="external nofollow">David</a></span>
<span class="date">February 7, 2016 at 11:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-341080" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I got an error with the first print statement, because your parenthesis are closing the call to print (which returns None) before you’re calling format, so instead of </p>
<p>print(‘Split {0} rows into train with {1} and test with {2}’).format(len(dataset), train, test)</p>
<p>it should be</p>
<p>print(‘Split {0} rows into train with {1} and test with {2}’.format(len(dataset), train, test))</p>
<p>Anyway, thanks for this tutorial, it was really useful, cheers!</p>
<div class="reply">
<a aria-label="Reply to David" class="comment-reply-link" href="#comment-341080" onclick='return addComment.moveForm( "comment-341080", "341080", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-341369">
<div class="comment-container" id="li-comment-341369">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cc0c611fc53ff89b5fa1820e76d65c93?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cc0c611fc53ff89b5fa1820e76d65c93?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kumar Ramanathan</span>
<span class="date">February 12, 2016 at 12:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-341369" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sincere gratitude for this most excellent site. Yes, I never learn until I write code for the algorithm. It is such an important exercise, to get concepts embedded into one’s brain. Brilliant effort, truly !</p>
<div class="reply">
<a aria-label="Reply to Kumar Ramanathan" class="comment-reply-link" href="#comment-341369" onclick='return addComment.moveForm( "comment-341369", "341369", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-341706">
<div class="comment-container" id="li-comment-341706">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3c621d628434be2a456b02eade4c2148?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3c621d628434be2a456b02eade4c2148?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Syed</span>
<span class="date">February 18, 2016 at 8:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-341706" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Just to test the algorithm, i change the class of few of the data to something else i.e 3 or 4, (last digit in a line) and i get divide by zero error while calculating the variance. I am not sure why. does it mean that this particular program works only for 2 classess? cant see anything which restricts it to that.</p>
<div class="reply">
<a aria-label="Reply to Syed" class="comment-reply-link" href="#comment-341706" onclick='return addComment.moveForm( "comment-341706", "341706", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-344441">
<div class="comment-container" id="li-comment-344441">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/883fe0b0614267325bf6e562e9d4848a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/883fe0b0614267325bf6e562e9d4848a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Takuma Udagawa</span>
<span class="date">March 20, 2016 at 1:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-344441" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, I’m a student in Japan.<br/>
It seems to me that you are calculating p(X1|Ck)*p(X2|Ck)*…*p(Xm|Ck) and choosing Ck such that this value would be maximum.<br/>
However, when I looked in the Wikipedia, you are supposed to calculate p(X1|Ck)*p(X2|Ck)*…*p(Xm|Ck)*p(Ck).<br/>
I don’t understand when you calculated p(Ck).<br/>
Would you tell me about it?</p>
<div class="reply">
<a aria-label="Reply to Takuma Udagawa" class="comment-reply-link" href="#comment-344441" onclick='return addComment.moveForm( "comment-344441", "344441", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-371850">
<div class="comment-container" id="li-comment-371850">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7471174c4bd60b547af44f336d7885b2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7471174c4bd60b547af44f336d7885b2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">jessie</span>
<span class="date">November 24, 2016 at 1:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-371850" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Had the same thought, where’s the prior calculated?</p>
<div class="reply">
<a aria-label="Reply to jessie" class="comment-reply-link" href="#comment-371850" onclick='return addComment.moveForm( "comment-371850", "371850", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-425940">
<div class="comment-container" id="li-comment-425940">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/019d5544b8b797ad24b36fef4e429e9c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/019d5544b8b797ad24b36fef4e429e9c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jorge</span>
<span class="date">January 9, 2018 at 12:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-425940" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Its seems it is a bug of this implementation.</p>
<p>I looked for the implementation of scikitlearn and they seem to have the right formula,</p>
<p>reference:<br/>
<a href="https://github.com/scikit-learn/scikit-learn/blob/e41c4d5e3944083328fd69aeacb590cbb78484da/sklearn/naive_bayes.py#L432" rel="nofollow">https://github.com/scikit-learn/scikit-learn/blob/e41c4d5e3944083328fd69aeacb590cbb78484da/sklearn/naive_bayes.py#L432</a></p>
<div class="reply">
<a aria-label="Reply to Jorge" class="comment-reply-link" href="#comment-425940" onclick='return addComment.moveForm( "comment-425940", "425940", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-425958">
<div class="comment-container" id="li-comment-425958">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 9, 2018 at 3:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-425958" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can add the prior easily. I left it out because it was a constant for this dataset.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425958" onclick='return addComment.moveForm( "comment-425958", "425958", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-351784">
<div class="comment-container" id="li-comment-351784">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7a6c28810e7ea47bb5b651dc99dd39eb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7a6c28810e7ea47bb5b651dc99dd39eb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Babu</span>
<span class="date">May 23, 2016 at 7:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-351784" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is the same question as Alex Ubot above.</p>
<p>Calculating the parameters are correct.<br/>
but prediction  implementation is incorrect.</p>
<p>Unfortunately this article comes up high and everyone is learning incorrect way of doing things I think</p>
<div class="reply">
<a aria-label="Reply to Babu" class="comment-reply-link" href="#comment-351784" onclick='return addComment.moveForm( "comment-351784", "351784", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-353250">
<div class="comment-container" id="li-comment-353250">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d41591cfd869c204f62e3e9010f453e3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d41591cfd869c204f62e3e9010f453e3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Swapnil</span>
<span class="date">June 10, 2016 at 1:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-353250" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Really nice tutorial. Can you post a detailed implementation of RandomForest as well ? It will be very helpful for us if you do so.</p>
<p>Thanks!!</p>
<div class="reply">
<a aria-label="Reply to Swapnil" class="comment-reply-link" href="#comment-353250" onclick='return addComment.moveForm( "comment-353250", "353250", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-353754">
<div class="comment-container" id="li-comment-353754">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 14, 2016 at 8:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-353754" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great idea Swapnil.</p>
<p>You may find this post useful:<br/>
<a href="http://machinelearningmastery.com/bagging-and-random-forest-ensemble-algorithms-for-machine-learning/" rel="nofollow">http://machinelearningmastery.com/bagging-and-random-forest-ensemble-algorithms-for-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-353754" onclick='return addComment.moveForm( "comment-353754", "353754", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-357652">
<div class="comment-container" id="li-comment-357652">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/34525e578658c03e1248c8032f896be5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/34525e578658c03e1248c8032f896be5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sourena maroofi</span>
<span class="date">July 22, 2016 at 12:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-357652" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thanks Jason…very nice tutorial.</p>
<div class="reply">
<a aria-label="Reply to sourena maroofi" class="comment-reply-link" href="#comment-357652" onclick='return addComment.moveForm( "comment-357652", "357652", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-358168">
<div class="comment-container" id="li-comment-358168">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ace9cdd9c22fbf62278ab24313fa8834?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ace9cdd9c22fbf62278ab24313fa8834?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Gary</span>
<span class="date">July 27, 2016 at 5:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-358168" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
I was interested in this Naive Bayes example and downloaded the .csv data and the code to process it.</p>
<p>However, when I try to run it in Pycharm IDE using Python 3.5 I get no end of run-time errors.</p>
<p>Has anyone else run the code successfully? And if so, what IDE/environment did they use?</p>
<p>Thanks</p>
<p>Gary</p>
<div class="reply">
<a aria-label="Reply to Gary" class="comment-reply-link" href="#comment-358168" onclick='return addComment.moveForm( "comment-358168", "358168", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-359404">
<div class="comment-container" id="li-comment-359404">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c6d9a08dc49feea738204d03775b9247?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c6d9a08dc49feea738204d03775b9247?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sudarshan</span>
<span class="date">August 10, 2016 at 5:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-359404" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Gary,</p>
<p>You might want to run it using Python 2.7.</p>
<div class="reply">
<a aria-label="Reply to Sudarshan" class="comment-reply-link" href="#comment-359404" onclick='return addComment.moveForm( "comment-359404", "359404", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-359403">
<div class="comment-container" id="li-comment-359403">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c6d9a08dc49feea738204d03775b9247?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c6d9a08dc49feea738204d03775b9247?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sudarshan</span>
<span class="date">August 10, 2016 at 5:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-359403" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, </p>
<p>Thanks for the excellent tutorial. I’ve attempted to implement the same in Go.</p>
<p>Here is a link for anyone that’s interested interested.</p>
<p><a href="https://github.com/sudsred/gBay" rel="nofollow">https://github.com/sudsred/gBay</a></p>
<div class="reply">
<a aria-label="Reply to Sudarshan" class="comment-reply-link" href="#comment-359403" onclick='return addComment.moveForm( "comment-359403", "359403", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-359807">
<div class="comment-container" id="li-comment-359807">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b516d8cb95c9d282962b8c21e2327c7f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b516d8cb95c9d282962b8c21e2327c7f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Atlas</span>
<span class="date">August 13, 2016 at 6:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-359807" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is AWESOME!!! Thank you Jason.</p>
<p>Where can I find more of this?</p>
<div class="reply">
<a aria-label="Reply to Atlas" class="comment-reply-link" href="#comment-359807" onclick='return addComment.moveForm( "comment-359807", "359807", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-360628">
<div class="comment-container" id="li-comment-360628">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ce0bbf2e2db2f72276ce11b95d7df6a9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ce0bbf2e2db2f72276ce11b95d7df6a9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://gildedhonour.com" rel="external nofollow">Alex</a></span>
<span class="date">August 20, 2016 at 4:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-360628" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That can be implemented in any language because there’re no special libraries involved.</p>
<div class="reply">
<a aria-label="Reply to Alex" class="comment-reply-link" href="#comment-360628" onclick='return addComment.moveForm( "comment-360628", "360628", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-362075">
<div class="comment-container" id="li-comment-362075">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/65fdaf2fc1645a58be010a77e72467d0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/65fdaf2fc1645a58be010a77e72467d0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">SAFA</span>
<span class="date">August 28, 2016 at 1:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-362075" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello,<br/>
there is some errors in “def splitDataset”<br/>
in machine learning algorithm , split a dataset into trainning and testing must be done without repetition (duplication) , so the index = random.randrange(len(copy)) generate duplicate data<br/>
for example ” index = 0 192  1  2  0  14 34 56 1 ………<br/>
the spliting method must be done without duplication of data.</p>
<div class="reply">
<a aria-label="Reply to SAFA" class="comment-reply-link" href="#comment-362075" onclick='return addComment.moveForm( "comment-362075", "362075", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-364283">
<div class="comment-container" id="li-comment-364283">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/63ce9a29cb108f5f1a051c18a20702f8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/63ce9a29cb108f5f1a051c18a20702f8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Krati Jain</span>
<span class="date">September 12, 2016 at 2:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-364283" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is a highly informative and detailed explained article. Although I think that this is suitable for Python 2.x versions for 3.x, we don’t have ‘iteritems’ function in a dict object, we currently have ‘items’ in dict object. Secondly, format function is called on lot of print functions, which should have been on string in the print funciton but it has been somehow called on print function, which throws an error, can you please look into it.</p>
<div class="reply">
<a aria-label="Reply to Krati Jain" class="comment-reply-link" href="#comment-364283" onclick='return addComment.moveForm( "comment-364283", "364283", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-364653">
<div class="comment-container" id="li-comment-364653">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/82f9b1c8bef84fbf03e3bd655005614d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/82f9b1c8bef84fbf03e3bd655005614d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">upen</span>
<span class="date">September 16, 2016 at 5:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-364653" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hey Jason<br/>
thanks for such a great tutorial im newbie to the concept and want to try naive bayes approach on movie-review on the review of a single movie that i have collected in a text file<br/>
can you please provide some hint on the topic how to load my  file and perform positve or negative review on it</p>
<div class="reply">
<a aria-label="Reply to upen" class="comment-reply-link" href="#comment-364653" onclick='return addComment.moveForm( "comment-364653", "364653", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-364700">
<div class="comment-container" id="li-comment-364700">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 17, 2016 at 9:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-364700" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You might find some benefit in this tutorial as a template:<br/>
<a href="http://machinelearningmastery.com/machine-learning-in-python-step-by-step/" rel="nofollow">http://machinelearningmastery.com/machine-learning-in-python-step-by-step/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-364700" onclick='return addComment.moveForm( "comment-364700", "364700", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-364996">
<div class="comment-container" id="li-comment-364996">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4f010d205ba7aa1b44efb4eb4b79e0ec?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4f010d205ba7aa1b44efb4eb4b79e0ec?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Abhis</span>
<span class="date">September 20, 2016 at 3:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-364996" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Would you please help me how i can implement naive bayes to predict student performance using their marks and feedback</p>
<div class="reply">
<a aria-label="Reply to Abhis" class="comment-reply-link" href="#comment-364996" onclick='return addComment.moveForm( "comment-364996", "364996", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-365034">
<div class="comment-container" id="li-comment-365034">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 20, 2016 at 8:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-365034" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m sorry, I am happy to answer your questions, but I cannot help you with your project. I just don’t have the capacity.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-365034" onclick='return addComment.moveForm( "comment-365034", "365034", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-367058">
<div class="comment-container" id="li-comment-367058">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9a5bd8d4b616a79f0670392cf8b76fc1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9a5bd8d4b616a79f0670392cf8b76fc1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vinay</span>
<span class="date">October 13, 2016 at 2:18 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-367058" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,</p>
<p>Thanks a lot for such a nice article, helped a lot in understanding the implementations,</p>
<p>i have a problem while running the script.<br/>
I get the below error</p>
<p>”<br/>
if (vector[-1] not in separated):<br/>
IndexError: list index out of range<br/>
”</p>
<p>can you please help me in getting it right?</p>
<div class="reply">
<a aria-label="Reply to Vinay" class="comment-reply-link" href="#comment-367058" onclick='return addComment.moveForm( "comment-367058", "367058", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-367111">
<div class="comment-container" id="li-comment-367111">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 14, 2016 at 8:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-367111" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Vinay.</p>
<p>Check that the data was loaded successfully. Perhaps there are empty lines or columns in your loaded data?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-367111" onclick='return addComment.moveForm( "comment-367111", "367111", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-367639">
<div class="comment-container" id="li-comment-367639">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/84b39afd14b07f2cd3c55bc90c589667?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/84b39afd14b07f2cd3c55bc90c589667?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Viji</span>
<span class="date">October 20, 2016 at 8:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-367639" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thank you for the wonderful article. U have used the ‘?'(testSet = [[1.1, ‘?’], [19.1, ‘?’]]) in the test set. can u please tell me what it specifies</p>
<div class="reply">
<a aria-label="Reply to Viji" class="comment-reply-link" href="#comment-367639" onclick='return addComment.moveForm( "comment-367639", "367639", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-370663">
<div class="comment-container" id="li-comment-370663">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/992a0029cb310a72056d74c68aa34522?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/992a0029cb310a72056d74c68aa34522?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">jeni</span>
<span class="date">November 15, 2016 at 9:11 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-370663" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>please send me a code in text classification using naive bayes classifier in python . the data set classifies +ve,-ve or neutral</p>
<div class="reply">
<a aria-label="Reply to jeni" class="comment-reply-link" href="#comment-370663" onclick='return addComment.moveForm( "comment-370663", "370663", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-370787">
<div class="comment-container" id="li-comment-370787">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 16, 2016 at 9:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-370787" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi jeni, sorry I don’t have such an example prepared.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-370787" onclick='return addComment.moveForm( "comment-370787", "370787", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-372713">
<div class="comment-container" id="li-comment-372713">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c6d7e520359a5c47b1753727cb82a508?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c6d7e520359a5c47b1753727cb82a508?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">MLNewbie</span>
<span class="date">November 28, 2016 at 1:21 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-372713" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am a newbie to ML and I found your website today. It is one of the greatest ML resources available on the Internet. I bookmarked it and thanks for everything Jason and I will visit your website everyday going forward.</p>
<div class="reply">
<a aria-label="Reply to MLNewbie" class="comment-reply-link" href="#comment-372713" onclick='return addComment.moveForm( "comment-372713", "372713", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-372813">
<div class="comment-container" id="li-comment-372813">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 29, 2016 at 8:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-372813" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, I’m glad you like it.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-372813" onclick='return addComment.moveForm( "comment-372813", "372813", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-380848">
<div class="comment-container" id="li-comment-380848">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/123c47bebe433f4d2ca3e230776b0c4c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/123c47bebe433f4d2ca3e230776b0c4c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anne</span>
<span class="date">January 7, 2017 at 6:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-380848" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>def predict(summaries, inputVector):<br/>
	probabilities = calculateClassProbabilities(summaries, inputVector)<br/>
	bestLabel, bestProb = None, -1<br/>
	for classValue, probability in probabilities.iteritems():<br/>
		if bestLabel is None or probability &gt; bestProb:<br/>
			bestProb = probability<br/>
			bestLabel = classValue<br/>
	return bestLabel</p>
<p>why is the prediction different for these<br/>
summaries = {‘A’ : [(1, 0.5)], ‘B’: [(20, 5.0)]} –predicts A<br/>
summaries = {‘0’ : [(1, 0.5)], ‘1’: [(20, 5.0)]} — predicts 0<br/>
summaries = {0 : [(1, 0.5)], 1: [(20, 5.0)]} — predicts 1</p>
<div class="reply">
<a aria-label="Reply to Anne" class="comment-reply-link" href="#comment-380848" onclick='return addComment.moveForm( "comment-380848", "380848", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-382796">
<div class="comment-container" id="li-comment-382796">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/79594a13ac4d1dd0bf2ab0ac1f6bfa5c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/79594a13ac4d1dd0bf2ab0ac1f6bfa5c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ML704</span>
<span class="date">January 18, 2017 at 6:16 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-382796" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, can someone please explain the code snippet below:</p>
<p>def separateByClass(dataset):<br/>
	separated = {}<br/>
	for i in range(len(dataset)):<br/>
		vector = dataset[i]<br/>
		if (vector[-1] not in separated):<br/>
			separated[vector[-1]] = []<br/>
		separated[vector[-1]].append(vector)<br/>
	return separated</p>
<p>What do curly brackets mean in separated = {}?<br/>
vector[-1] ?</p>
<p>Massive thanks!</p>
<div class="reply">
<a aria-label="Reply to ML704" class="comment-reply-link" href="#comment-382796" onclick='return addComment.moveForm( "comment-382796", "382796", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-382894">
<div class="comment-container" id="li-comment-382894">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 19, 2017 at 7:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-382894" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Curly brackets are a set or dictionary in Python, you can learn more about sets in Python here:<br/>
<a href="https://docs.python.org/3/tutorial/datastructures.html#sets" rel="nofollow">https://docs.python.org/3/tutorial/datastructures.html#sets</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-382894" onclick='return addComment.moveForm( "comment-382894", "382894", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-390340">
<div class="comment-container" id="li-comment-390340">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/493072a7d51a68be58221a1ef2d3f686?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/493072a7d51a68be58221a1ef2d3f686?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">S</span>
<span class="date">February 27, 2017 at 8:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-390340" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am trying to create an Android app which works as follows:</p>
<p>1) On opening the App, the user types a data in a textbox &amp; clicks on search</p>
<p>2) The app then searches about the entered data via internet and returns some answer (Using machine learning algorithms)</p>
<p>I have a dataset of around 17000 things.</p>
<p>Can you suggest the approach? Python/Java/etc…? Which technology to use for implementing machine learning algorithm &amp; for connecting to dataset? How to include the dataset so that android app size is not increased?</p>
<p>Basically, I am trying to implement an app described in a research paper.</p>
<p>I can implement machine learning(ML) algorithms in Python on my laptop for simple ML examples. But, I want to develop an Android app in which the data entered by user is checked from a web site and then from a “data set (using ML)” and result is displayed in app based on both the comparisons. The problem is that the data is of 40 MB &amp; how to reflect the ML results from laptop to android app?? By the way, the dataset is also available online. Shall I need a server? Or, can I use localhost using WAMP server?</p>
<p>Which python server should I use? I would also need to check the data entered from a live website. Can I connect my Android app to live server and localhost simultaneously? Is such a scenario obvious for my app? What do you suggest? Is Anaconda software sufficient?</p>
<div class="reply">
<a aria-label="Reply to S" class="comment-reply-link" href="#comment-390340" onclick='return addComment.moveForm( "comment-390340", "390340", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-390481">
<div class="comment-container" id="li-comment-390481">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 28, 2017 at 8:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-390481" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry I cannot make any good suggestions, I think you need to talk to some app engineers, not ML people.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-390481" onclick='return addComment.moveForm( "comment-390481", "390481", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-390664">
<div class="comment-container" id="li-comment-390664">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1fcfbf4a56d9b8e47976927e78fb75fb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1fcfbf4a56d9b8e47976927e78fb75fb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Roy</span>
<span class="date">March 1, 2017 at 4:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-390664" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>lines = csv.reader(open(filename, “rb”))<br/>
IOError: [Errno 2] No such file or directory: ‘pima-indians-diabetes.data.csv’</p>
<p>I have the csv file downloaded and its in the same folder as my code.</p>
<p>What should I do about this?</p>
<div class="reply">
<a aria-label="Reply to Roy" class="comment-reply-link" href="#comment-390664" onclick='return addComment.moveForm( "comment-390664", "390664", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-390715">
<div class="comment-container" id="li-comment-390715">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 1, 2017 at 8:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-390715" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Roy,</p>
<p>Confirm that the file name in your directory exactly matches the expectation of the script.</p>
<p>Confirm you are running from the command line and both the script and the data file are in the same directory and you are running from that directory.</p>
<p>If using Python 3, consider changing the ‘rb’ to ‘rt’ (text instead of binary).</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-390715" onclick='return addComment.moveForm( "comment-390715", "390715", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-390801">
<div class="comment-container" id="li-comment-390801">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3257b8566458f858a3a5cc7af8217b99?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3257b8566458f858a3a5cc7af8217b99?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jordan</span>
<span class="date">March 1, 2017 at 8:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-390801" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason. Great Tutorial! But, why did you leave the P(Y) in calculateClassProbability() ? The prediction produces in my machine is fine… But some people up there have mentioned it too that what you actually calculate is probability density function. And you don’t even answer their question.</p>
<div class="reply">
<a aria-label="Reply to Jordan" class="comment-reply-link" href="#comment-390801" onclick='return addComment.moveForm( "comment-390801", "390801", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391590">
<div class="comment-container" id="li-comment-391590">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/42d7200618153d10587511f6183bfa3f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/42d7200618153d10587511f6183bfa3f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ali</span>
<span class="date">March 7, 2017 at 6:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-391590" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Can you please help me fixing below error, The split is working but accuracy giving error</p>
<p>Split 769 rows into train=515 and test=254 rows<br/>
Traceback (most recent call last):<br/>
  File “indian.py”, line 100, in<br/>
    main()<br/>
  File “indian.py”, line 95, in main<br/>
    summaries = summarizeByClass(trainingSet)<br/>
  File “indian.py”, line 45, in summarizeByClass<br/>
    separated = separateByClass(dataset)<br/>
  File “indian.py”, line 26, in separateByClass<br/>
    if (vector[-1] not in separated):<br/>
IndexError: list index out of range</p>
<div class="reply">
<a aria-label="Reply to Ali" class="comment-reply-link" href="#comment-391590" onclick='return addComment.moveForm( "comment-391590", "391590", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-392516">
<div class="comment-container" id="li-comment-392516">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a7cac4dc00b2d3cf6f790e2dcec84d61?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a7cac4dc00b2d3cf6f790e2dcec84d61?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">shankru Guggari</span>
<span class="date">March 13, 2017 at 9:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-392516" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Class wise selection of  training and testing data<br/>
For Example<br/>
In Iris Dataset :  Species Column we have classes called Setosa,  versicolor and virginica</p>
<p>I want to select 80% of data from each class values. </p>
<p>Advance thanks<br/>
Shankru<br/>
<a href="mailto:shankar286@gmail.Com">shankar286@gmail.Com</a></p>
<div class="reply">
<a aria-label="Reply to shankru Guggari" class="comment-reply-link" href="#comment-392516" onclick='return addComment.moveForm( "comment-392516", "392516", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-392583">
<div class="comment-container" id="li-comment-392583">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 14, 2017 at 8:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-392583" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can take a random sample or use a stratified sample to ensure the same mixture of classes in train and test sets.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-392583" onclick='return addComment.moveForm( "comment-392583", "392583", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-393306">
<div class="comment-container" id="li-comment-393306">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/88675483e91836f009c1ef37a72d75a6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/88675483e91836f009c1ef37a72d75a6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Namrata</span>
<span class="date">March 19, 2017 at 5:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-393306" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>error in Naive Bayes code<br/>
IndexError:list index out of range</p>
<div class="reply">
<a aria-label="Reply to Namrata" class="comment-reply-link" href="#comment-393306" onclick='return addComment.moveForm( "comment-393306", "393306", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-394457">
<div class="comment-container" id="li-comment-394457">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bd4a49cee8cc7f0a56d4e177fb4f3b7c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bd4a49cee8cc7f0a56d4e177fb4f3b7c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">velu</span>
<span class="date">March 28, 2017 at 4:25 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-394457" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hai guys<br/>
i am velmurugan iam studying annauniversity tindivanam<br/>
i have a code for summarization for english description in java</p>
<div class="reply">
<a aria-label="Reply to velu" class="comment-reply-link" href="#comment-394457" onclick='return addComment.moveForm( "comment-394457", "394457", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-394578">
<div class="comment-container" id="li-comment-394578">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/34289281bcf015ad6b50b93af170109b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/34289281bcf015ad6b50b93af170109b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kamal</span>
<span class="date">March 29, 2017 at 10:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-394578" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>This example works. really good for Naive Bayes, but I was wondering what the approach would be like for joint probability distributions. Given a dataset, how to construct a bayesian network in Python or R?</p>
<div class="reply">
<a aria-label="Reply to Kamal" class="comment-reply-link" href="#comment-394578" onclick='return addComment.moveForm( "comment-394578", "394578", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-394764">
<div class="comment-container" id="li-comment-394764">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/473a3958eb8c203748d4cfdd07aa2fc3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/473a3958eb8c203748d4cfdd07aa2fc3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Joelon johnson</span>
<span class="date">March 30, 2017 at 7:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-394764" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>Joelon here. I am new to python and machine learning. I keep getting a run-time error after compiling the above script. Is it possible I send you screenshots of the error so we walk through step by step?</p>
<div class="reply">
<a aria-label="Reply to Joelon johnson" class="comment-reply-link" href="#comment-394764" onclick='return addComment.moveForm( "comment-394764", "394764", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-394836">
<div class="comment-container" id="li-comment-394836">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 31, 2017 at 5:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-394836" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What problem are you getting exactly?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-394836" onclick='return addComment.moveForm( "comment-394836", "394836", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-395168">
<div class="comment-container" id="li-comment-395168">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9b14d0834538dc1b09240aa2d3e576ac?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9b14d0834538dc1b09240aa2d3e576ac?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bill</span>
<span class="date">April 2, 2017 at 10:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-395168" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason !</p>
<p>Thank you for this tutorial.<br/>
I have a question: what if our x to predict is a vector? How can we calculate the probability to be in a class (in the function calculateProbability for example) ?</p>
<p>Thank you</p>
<div class="reply">
<a aria-label="Reply to Bill" class="comment-reply-link" href="#comment-395168" onclick='return addComment.moveForm( "comment-395168", "395168", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-395323">
<div class="comment-container" id="li-comment-395323">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 4, 2017 at 9:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-395323" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not sure I understand Bill. Perhaps you can give an example?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-395323" onclick='return addComment.moveForm( "comment-395323", "395323", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-395766">
<div class="comment-container" id="li-comment-395766">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c715c04108d7a6294a433aeef84e52ae?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c715c04108d7a6294a433aeef84e52ae?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Asmita Singh</span>
<span class="date">April 9, 2017 at 12:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-395766" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>HI Jason,<br/>
 Thanks for such a wonderful article. Your efforts are priceless. One quick question about handling cases with single value probabilities. Which part of code requires any smoothening.</p>
<div class="reply">
<a aria-label="Reply to Asmita Singh" class="comment-reply-link" href="#comment-395766" onclick='return addComment.moveForm( "comment-395766", "395766", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-395829">
<div class="comment-container" id="li-comment-395829">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 9, 2017 at 3:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-395829" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I’m not sure I understand your question. Perhaps you can restate it?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-395829" onclick='return addComment.moveForm( "comment-395829", "395829", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-396006">
<div class="comment-container" id="li-comment-396006">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/873651c4eab449511699bcdf89761858?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/873651c4eab449511699bcdf89761858?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mohammed Ehteramuddin</span>
<span class="date">April 11, 2017 at 12:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-396006" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,<br/>
First of all I thank you very much for such a nice tutorial. </p>
<p>I have a quick question for you if you could find some of your precious time to answer it.</p>
<p>Question: Why is that summarizeByClass(dataset) works only with a particular pattern of the dataset like the dataset in your example and does not work with the different pattern like my example dataset = [[2,3,1], [9,7,3], [12,9,0],[29,0,0]]</p>
<p>I guess it has to work for all the different possible datasets.</p>
<p>Thanks,<br/>
Mohammed Ehteramuddin</p>
<div class="reply">
<a aria-label="Reply to Mohammed Ehteramuddin" class="comment-reply-link" href="#comment-396006" onclick='return addComment.moveForm( "comment-396006", "396006", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-396042">
<div class="comment-container" id="li-comment-396042">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 11, 2017 at 9:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-396042" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It should work with any dataset as long as the last variable is the class variable.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-396042" onclick='return addComment.moveForm( "comment-396042", "396042", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-396218">
<div class="comment-container" id="li-comment-396218">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/873651c4eab449511699bcdf89761858?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/873651c4eab449511699bcdf89761858?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mohammed Ehteramuddin</span>
<span class="date">April 12, 2017 at 7:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-396218" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Oh! you  mean the last variable of the dataset (input) can not be other that the two values that we desire to classify the data into, in our case it should either be 0 or 1.</p>
<p>Thanks you very much.</p>
<div class="reply">
<a aria-label="Reply to Mohammed Ehteramuddin" class="comment-reply-link" href="#comment-396218" onclick='return addComment.moveForm( "comment-396218", "396218", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-396282">
<div class="comment-container" id="li-comment-396282">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 13, 2017 at 9:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-396282" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-396282" onclick='return addComment.moveForm( "comment-396282", "396282", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-396867">
<div class="comment-container" id="li-comment-396867">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5cab32cfa7384296318a7cf866dbc221?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5cab32cfa7384296318a7cf866dbc221?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Salihins Gund</span>
<span class="date">April 19, 2017 at 6:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-396867" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What is <code>correct</code> variable refers in getAccuracy function? Can you elaborate it more?</p>
<div class="reply">
<a aria-label="Reply to Salihins Gund" class="comment-reply-link" href="#comment-396867" onclick='return addComment.moveForm( "comment-396867", "396867", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-396868">
<div class="comment-container" id="li-comment-396868">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5cab32cfa7384296318a7cf866dbc221?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5cab32cfa7384296318a7cf866dbc221?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Salihins Gund</span>
<span class="date">April 19, 2017 at 7:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-396868" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry that was wrong question. </p>
<p>Edit:<br/>
Ideally the Gaussian Naive Bayes has lambda (threshold) value to set boundary. I was wondering which part of this code include the threshold?</p>
<div class="reply">
<a aria-label="Reply to Salihins Gund" class="comment-reply-link" href="#comment-396868" onclick='return addComment.moveForm( "comment-396868", "396868", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-396882">
<div class="comment-container" id="li-comment-396882">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 19, 2017 at 7:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-396882" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I do not include threshold.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-396882" onclick='return addComment.moveForm( "comment-396882", "396882", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-397064">
<div class="comment-container" id="li-comment-397064">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3fcafed9958b22537ea68556274546fb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3fcafed9958b22537ea68556274546fb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">way win</span>
<span class="date">April 21, 2017 at 3:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-397064" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can you provide an extension to the data. I can not downloand it for some reason. Thank you!</p>
<div class="reply">
<a aria-label="Reply to way win" class="comment-reply-link" href="#comment-397064" onclick='return addComment.moveForm( "comment-397064", "397064", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-397101">
<div class="comment-container" id="li-comment-397101">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 21, 2017 at 8:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-397101" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Here is a direct link to the data file:<br/>
<a href="https://archive.ics.uci.edu/ml/machine-learning-databases/pima-indians-diabetes/pima-indians-diabetes.data" rel="nofollow">https://archive.ics.uci.edu/ml/machine-learning-databases/pima-indians-diabetes/pima-indians-diabetes.data</a></p>
<p>Sometimes the UCI ML repo will go down for a few hours.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-397101" onclick='return addComment.moveForm( "comment-397101", "397101", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-397111">
<div class="comment-container" id="li-comment-397111">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3fcafed9958b22537ea68556274546fb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3fcafed9958b22537ea68556274546fb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">way win</span>
<span class="date">April 21, 2017 at 10:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-397111" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I trying running the program but it keeps saying<br/>
  File “nb.py”, line 102, in<br/>
    main()<br/>
  File “nb.py”, line 92, in main<br/>
    dataset = loadCsv(filename)<br/>
  File “nb.py”, line 11, in loadCsv<br/>
    dataset[i] = [float(x) for x in dataset[i]]<br/>
ValueError: invalid literal for float(): 1,85,66,29,0,26.6,0.351,31,0</p>
<div class="reply">
<a aria-label="Reply to way win" class="comment-reply-link" href="#comment-397111" onclick='return addComment.moveForm( "comment-397111", "397111", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-399107">
<div class="comment-container" id="li-comment-399107">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/24bc547be8bbfb0edea0ff1df89547f1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/24bc547be8bbfb0edea0ff1df89547f1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mian Saeed Akbar</span>
<span class="date">May 9, 2017 at 10:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-399107" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason…!<br/>
Thank You so much for coding the problem in a very clear way. As I am new in machine learning and also I have not used Python before therefore I feel some difficulties in modifying it. I want to include the serial number of in data set and then show which testing example (e.g. example # 110) got how much probability form class 0 and for 1.</p>
<div class="reply">
<a aria-label="Reply to Mian Saeed Akbar" class="comment-reply-link" href="#comment-399107" onclick='return addComment.moveForm( "comment-399107", "399107", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-399246">
<div class="comment-container" id="li-comment-399246">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 10, 2017 at 8:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-399246" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You might be better off using Weka:<br/>
<a href="http://machinelearningmastery.com/start-here/#weka" rel="nofollow">http://machinelearningmastery.com/start-here/#weka</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-399246" onclick='return addComment.moveForm( "comment-399246", "399246", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-400648">
<div class="comment-container" id="li-comment-400648">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/60a7f98f41246a62428c0fd2d2959771?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/60a7f98f41246a62428c0fd2d2959771?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Blazej</span>
<span class="date">May 27, 2017 at 9:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-400648" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I encountered a problem at the beginning. After loading the file and running this test:</p>
<p>filename = ‘pima-indians-diabetes.data.csv’<br/>
dataset = loadCsv(filename)<br/>
print(‘Loaded data file {0} with {1} rows’).format(filename, len(dataset))</p>
<p>I get the Error: “iterator should return strings, not bytes (did you open the file in text mode?)”</p>
<p>btw i am using python 3.6</p>
<p>thank you for the help</p>
<div class="reply">
<a aria-label="Reply to Blazej" class="comment-reply-link" href="#comment-400648" onclick='return addComment.moveForm( "comment-400648", "400648", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-401152">
<div class="comment-container" id="li-comment-401152">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 12:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-401152" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Change the loading of the file from binary to text (e.g. ‘rt’)</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401152" onclick='return addComment.moveForm( "comment-401152", "401152", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-402091">
<div class="comment-container" id="li-comment-402091">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9d628bf6b0874b019711f438c18ae4cd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9d628bf6b0874b019711f438c18ae4cd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Marcus</span>
<span class="date">June 10, 2017 at 9:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-402091" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This code is not working with Python 3.16 :S</p>
<div class="reply">
<a aria-label="Reply to Marcus" class="comment-reply-link" href="#comment-402091" onclick='return addComment.moveForm( "comment-402091", "402091", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-402092">
<div class="comment-container" id="li-comment-402092">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9d628bf6b0874b019711f438c18ae4cd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9d628bf6b0874b019711f438c18ae4cd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Marcus</span>
<span class="date">June 10, 2017 at 9:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-402092" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>3.6</p>
<div class="reply">
<a aria-label="Reply to Marcus" class="comment-reply-link" href="#comment-402092" onclick='return addComment.moveForm( "comment-402092", "402092", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-402170">
<div class="comment-container" id="li-comment-402170">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 11, 2017 at 8:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-402170" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Marcus.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-402170" onclick='return addComment.moveForm( "comment-402170", "402170", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-402368">
<div class="comment-container" id="li-comment-402368">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9d628bf6b0874b019711f438c18ae4cd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9d628bf6b0874b019711f438c18ae4cd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Marcus</span>
<span class="date">June 13, 2017 at 10:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-402368" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Is there a way you can try to fix and make it work with 3.6 maybe Jason?</p>
<div class="reply">
<a aria-label="Reply to Marcus" class="comment-reply-link" href="#comment-402368" onclick='return addComment.moveForm( "comment-402368", "402368", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-4" id="comment-402542">
<div class="comment-container" id="li-comment-402542">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9d628bf6b0874b019711f438c18ae4cd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9d628bf6b0874b019711f438c18ae4cd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Marcus</span>
<span class="date">June 15, 2017 at 2:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-402542" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason can you explain what this code does?</p>
<div class="reply">
<a aria-label="Reply to Marcus" class="comment-reply-link" href="#comment-402542" onclick='return addComment.moveForm( "comment-402542", "402542", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-402579">
<div class="comment-container" id="li-comment-402579">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 15, 2017 at 8:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-402579" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, see here:<br/>
<a href="http://machinelearningmastery.com/naive-bayes-for-machine-learning/" rel="nofollow">http://machinelearningmastery.com/naive-bayes-for-machine-learning/</a></p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-4" id="comment-423022">
<div class="comment-container" id="li-comment-423022">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a58ca9845691e76fa082ce78658d7baa?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a58ca9845691e76fa082ce78658d7baa?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Darmawan Utomo</span>
<span class="date">December 13, 2017 at 9:16 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-423022" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I run the code in python 3.6.3 and here are the corrections:<br/>
—————————————————————————-<br/>
1. change the “rb” to  “rt”</p>
<p>2. print(‘Split {0} rows into train={1} and test={2} rows’.format(len(dataset), len(trainingSet), len(testSet)))</p>
<p>3. change for each .iteritems() to .items() </p>
<p>4.  print(‘Accuracy: {0}%’.format(accuracy))</p>
<p>Here are some of the results:</p>
<p>Split 768 rows into train=514 and test=254 rows<br/>
Accuracy: 71.25984251968504%</p>
<p>Split 768 rows into train=514 and test=254 rows<br/>
Accuracy: 76.77165354330708%</p>
<div class="reply">
<a aria-label="Reply to Darmawan Utomo" class="comment-reply-link" href="#comment-423022" onclick='return addComment.moveForm( "comment-423022", "423022", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-423059">
<div class="comment-container" id="li-comment-423059">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 14, 2017 at 5:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-423059" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the tips.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-402434">
<div class="comment-container" id="li-comment-402434">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7bfc7d4d2d8ff8e2c59a4689dac94fbf?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7bfc7d4d2d8ff8e2c59a4689dac94fbf?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Guy Person</span>
<span class="date">June 14, 2017 at 4:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-402434" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The code in this tutorial is riddled with error after error… The string output formatting isn’t even done right for gods sakes!</p>
<div class="reply">
<a aria-label="Reply to Guy Person" class="comment-reply-link" href="#comment-402434" onclick='return addComment.moveForm( "comment-402434", "402434", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-402563">
<div class="comment-container" id="li-comment-402563">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9d524e4d4e6d7b62d04982d8f50e351a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9d524e4d4e6d7b62d04982d8f50e351a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Person Guy</span>
<span class="date">June 15, 2017 at 7:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-402563" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This was written in 2014, the python documentation has changed drastically as the versions have been updated</p>
<div class="reply">
<a aria-label="Reply to Person Guy" class="comment-reply-link" href="#comment-402563" onclick='return addComment.moveForm( "comment-402563", "402563", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-402564">
<div class="comment-container" id="li-comment-402564">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e42b0d2bbe7ef0120b56c46a9307b3f5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e42b0d2bbe7ef0120b56c46a9307b3f5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">J Wang</span>
<span class="date">June 15, 2017 at 8:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-402564" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason, I really enjoyed the read as it was very thorough and even for a beginner programmer like myself understandable overall. However, like Marcus asked, is it at all possible for you to rewrite or point out how to edit the parts that have new syntax in python 3? </p>
<p>Also, this version utilized the Gaussian probability density function, how would we use the other ones, would the math be different or the code?</p>
<div class="reply">
<a aria-label="Reply to J Wang" class="comment-reply-link" href="#comment-402564" onclick='return addComment.moveForm( "comment-402564", "402564", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-405618">
<div class="comment-container" id="li-comment-405618">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/62dfb5e8a0ecb526f0ed7771b2ba980f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/62dfb5e8a0ecb526f0ed7771b2ba980f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Giselle</span>
<span class="date">July 12, 2017 at 10:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-405618" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thank you for this post it’s super informative, I just started college and this is really easy to follow! I was wondering how this could be done with a mixture of binary and categorical data. For example, if I wanted to create a model to determine whether or not a car would break down and one category had a list of names of 10 car parts while another category simply asked if the car overheated (yes or no). Thanks again!</p>
<div class="reply">
<a aria-label="Reply to Giselle" class="comment-reply-link" href="#comment-405618" onclick='return addComment.moveForm( "comment-405618", "405618", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-405713">
<div class="comment-container" id="li-comment-405713">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 13, 2017 at 9:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-405713" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Absolutely.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-405713" onclick='return addComment.moveForm( "comment-405713", "405713", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-405813">
<div class="comment-container" id="li-comment-405813">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/62dfb5e8a0ecb526f0ed7771b2ba980f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/62dfb5e8a0ecb526f0ed7771b2ba980f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Giselle</span>
<span class="date">July 14, 2017 at 3:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-405813" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Would the categorical data have to be preprocessed?</p>
<div class="reply">
<a aria-label="Reply to Giselle" class="comment-reply-link" href="#comment-405813" onclick='return addComment.moveForm( "comment-405813", "405813", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-405850">
<div class="comment-container" id="li-comment-405850">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 14, 2017 at 8:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-405850" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No. Naive Bayes is much simpler on categorical data:<br/>
<a href="http://machinelearningmastery.com/naive-bayes-tutorial-for-machine-learning/" rel="nofollow">http://machinelearningmastery.com/naive-bayes-tutorial-for-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-405850" onclick='return addComment.moveForm( "comment-405850", "405850", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-405837">
<div class="comment-container" id="li-comment-405837">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6a2551db1dde7743cd32b73697b3057e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6a2551db1dde7743cd32b73697b3057e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Thomas</span>
<span class="date">July 14, 2017 at 7:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-405837" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi! Thanks for this helpful article. I had a quick question:  in your calculateProbability() function, should the denominator be multiplied by the variance instead of the standard deviation?</p>
<p>i.e. should </p>
<p><code>return (1 / (math.sqrt(2 * math.pi) * stdev)) * exponent</code></p>
<p>instead be:</p>
<p><code>return (1 / (math.sqrt(2 * math.pi) * math.pow(stdev, 2))) * exponent</code></p>
<div class="reply">
<a aria-label="Reply to Thomas" class="comment-reply-link" href="#comment-405837" onclick='return addComment.moveForm( "comment-405837", "405837", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-408739">
<div class="comment-container" id="li-comment-408739">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/429d7df219db9ebd29e91f3948a85553?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/429d7df219db9ebd29e91f3948a85553?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rezaul Karim</span>
<span class="date">August 6, 2017 at 5:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-408739" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason. I visited ur site several times. This is really helpful. I look for SVM implementation in python from scratch like the way you implemented Naive Bayes here. Can u provide me SVM code??</p>
<div class="reply">
<a aria-label="Reply to Rezaul Karim" class="comment-reply-link" href="#comment-408739" onclick='return addComment.moveForm( "comment-408739", "408739", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-408799">
<div class="comment-container" id="li-comment-408799">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 7, 2017 at 8:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-408799" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, I provide it in my book here:<br/>
<a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/" rel="nofollow">https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-408799" onclick='return addComment.moveForm( "comment-408799", "408799", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-409973">
<div class="comment-container" id="li-comment-409973">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4ef39a17f1403b63946520f6d68ba240?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4ef39a17f1403b63946520f6d68ba240?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Charmaine Ponay</span>
<span class="date">August 17, 2017 at 10:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-409973" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you so much Mr. Brownlee. I would like to ask your permission if I can show my students your implementations? They are very easy to understand and follow. Thank you very much again 🙂</p>
<div class="reply">
<a aria-label="Reply to Charmaine Ponay" class="comment-reply-link" href="#comment-409973" onclick='return addComment.moveForm( "comment-409973", "409973", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-410013">
<div class="comment-container" id="li-comment-410013">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 18, 2017 at 6:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-410013" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No problem as long as you credit the source and link back to my website.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-410013" onclick='return addComment.moveForm( "comment-410013", "410013", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-410559">
<div class="comment-container" id="li-comment-410559">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4ef39a17f1403b63946520f6d68ba240?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4ef39a17f1403b63946520f6d68ba240?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Charmaine Ponay</span>
<span class="date">August 22, 2017 at 3:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-410559" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thank you very much 🙂</p>
<div class="reply">
<a aria-label="Reply to Charmaine Ponay" class="comment-reply-link" href="#comment-410559" onclick='return addComment.moveForm( "comment-410559", "410559", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-413143">
<div class="comment-container" id="li-comment-413143">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/04d824dc13048691b93ea152f78a25a9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/04d824dc13048691b93ea152f78a25a9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">THAMILSELVAM B</span>
<span class="date">September 9, 2017 at 2:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-413143" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Very good basic tutorial. Thank you.</p>
<div class="reply">
<a aria-label="Reply to THAMILSELVAM B" class="comment-reply-link" href="#comment-413143" onclick='return addComment.moveForm( "comment-413143", "413143", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-413231">
<div class="comment-container" id="li-comment-413231">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 9, 2017 at 11:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-413231" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-413231" onclick='return addComment.moveForm( "comment-413231", "413231", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-414792">
<div class="comment-container" id="li-comment-414792">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/44d3cc5cdc87cc924d814fc503f54fcf?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/44d3cc5cdc87cc924d814fc503f54fcf?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chandar</span>
<span class="date">September 25, 2017 at 10:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-414792" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
    I would have exported my model using joblib and as I have converted the categorical data to numeric in the training data-set to develop the model and now I have no clue on how to convert the a new categorical data to predict using the trained model.</p>
<div class="reply">
<a aria-label="Reply to Chandar" class="comment-reply-link" href="#comment-414792" onclick='return addComment.moveForm( "comment-414792", "414792", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-414811">
<div class="comment-container" id="li-comment-414811">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 26, 2017 at 5:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-414811" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>New data must be prepared using the same methods as data used to train the model.</p>
<p>Sometimes this might mean keeping objects/coefficients used to scale or encode input data along with the model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-414811" onclick='return addComment.moveForm( "comment-414811", "414811", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-422081">
<div class="comment-container" id="li-comment-422081">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/91e985c4d81b55f6224a073ffa2961ed?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/91e985c4d81b55f6224a073ffa2961ed?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Narendra</span>
<span class="date">December 4, 2017 at 3:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-422081" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>where/what is learning in this code. I think it is just naive bayes classification. Please specify the learning.</p>
<div class="reply">
<a aria-label="Reply to Narendra" class="comment-reply-link" href="#comment-422081" onclick='return addComment.moveForm( "comment-422081", "422081", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-422104">
<div class="comment-container" id="li-comment-422104">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 4, 2017 at 7:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-422104" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good question, the probabilities are “learned” from data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-422104" onclick='return addComment.moveForm( "comment-422104", "422104", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-423647">
<div class="comment-container" id="li-comment-423647">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4666684ea0933ad120182269de0b95b2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4666684ea0933ad120182269de0b95b2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Christian</span>
<span class="date">December 18, 2017 at 1:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-423647" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great example. You are doing a great work thanks. Please am working on this example but i am confused on how to determine attribute relevance analysis. That is how do i determine which attribute is (will) be relevant for my model.</p>
<div class="reply">
<a aria-label="Reply to Christian" class="comment-reply-link" href="#comment-423647" onclick='return addComment.moveForm( "comment-423647", "423647", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-423675">
<div class="comment-container" id="li-comment-423675">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 18, 2017 at 5:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-423675" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps you could look at the independent probabilities for each variable?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-423675" onclick='return addComment.moveForm( "comment-423675", "423675", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-423709">
<div class="comment-container" id="li-comment-423709">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4666684ea0933ad120182269de0b95b2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4666684ea0933ad120182269de0b95b2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Christian</span>
<span class="date">December 18, 2017 at 3:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-423709" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thanks very much. Grateful</p>
<div class="reply">
<a aria-label="Reply to Christian" class="comment-reply-link" href="#comment-423709" onclick='return addComment.moveForm( "comment-423709", "423709", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-424745">
<div class="comment-container" id="li-comment-424745">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e5aa28711584c358d85cc41fc8a58d12?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e5aa28711584c358d85cc41fc8a58d12?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://google" rel="external nofollow">SUIMEE</a></span>
<span class="date">December 25, 2017 at 10:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-424745" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can you please send me the code for pedestrian detection using HOG and NAIVE BAYES?</p>
<div class="reply">
<a aria-label="Reply to SUIMEE" class="comment-reply-link" href="#comment-424745" onclick='return addComment.moveForm( "comment-424745", "424745", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-424764">
<div class="comment-container" id="li-comment-424764">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 26, 2017 at 5:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-424764" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I cannot.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-424764" onclick='return addComment.moveForm( "comment-424764", "424764", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-427571">
<div class="comment-container" id="li-comment-427571">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5344673af6d2de69c962a37b10e3e1e3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5344673af6d2de69c962a37b10e3e1e3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jasper</span>
<span class="date">January 25, 2018 at 1:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-427571" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>what does this block of code do </p>
<p>    while len(trainSet) &lt; trainSize:<br/>
        index = random.randrange(len(copy))<br/>
        trainSet.append(copy.pop(index))<br/>
    return [trainSet, copy]</p>
<div class="reply">
<a aria-label="Reply to Jasper" class="comment-reply-link" href="#comment-427571" onclick='return addComment.moveForm( "comment-427571", "427571", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-427608">
<div class="comment-container" id="li-comment-427608">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 26, 2018 at 5:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-427608" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Selects random rows from the dataset copy and adds them to the training set.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-427608" onclick='return addComment.moveForm( "comment-427608", "427608", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-427717">
<div class="comment-container" id="li-comment-427717">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/34f3f1907359dfad4d6c96c21a6f044f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/34f3f1907359dfad4d6c96c21a6f044f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Scott</span>
<span class="date">January 27, 2018 at 9:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-427717" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason:</p>
<p>I am very happy with this implementation! I used it as inspiration for an R counterpart. I am unclear about one thing. I understand the training set mean and sd are parameters used to evaluate the test set, but I don’t know why that works lol. </p>
<p>How does evaluating the GPDF with the training set data and the test set instance attributes “train” the model? I may be confusing myself by interpreting “train” too literally. </p>
<p>I think of train as repetitiously doing something multiple times with improvement from each iteration, and these iterations ultimately produce some catalyst for higher predictions. It seems that there is only one iteration of defining the training set’s mean and sd. Not sure if this question makes sense and I apologize if that is the case.</p>
<p>Any help is truly, genuinely appreciated!</p>
<p>Scott Bishop</p>
<div class="reply">
<a aria-label="Reply to Scott" class="comment-reply-link" href="#comment-427717" onclick='return addComment.moveForm( "comment-427717", "427717", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-427765">
<div class="comment-container" id="li-comment-427765">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 28, 2018 at 8:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-427765" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Here, the training data provides the basis for estimating the probabilities used by the model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-427765" onclick='return addComment.moveForm( "comment-427765", "427765", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-428384">
<div class="comment-container" id="li-comment-428384">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e9e9cc7ccca556f2f7b003d0f69f9d04?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e9e9cc7ccca556f2f7b003d0f69f9d04?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">som</span>
<span class="date">February 5, 2018 at 4:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-428384" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Sometimes I am getting the “ZeroDivisionError: float division by zero” when I am running the program</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe4b076823930958" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# -*- coding: utf-8 -*-
"""
Created on Sun Feb  4 07:30:57 2018

@author: SONAM
"""

# Example of Naive Bayes implemented from Scratch in Python
from __future__ import division
import csv
import random
import math


def loadCsv(filename):
	lines = csv.reader(open(filename, "rt"))
	dataset = list(lines)
	for i in range(len(dataset)):
		dataset[i] = [float(x) for x in dataset[i]]
	return dataset

def splitDataset(dataset, splitRatio):
	trainSize = int(len(dataset) * splitRatio)
	trainSet = []
	copy = list(dataset)
	while len(trainSet)  bestProb:
			bestProb = probability
			bestLabel = classValue
	return bestLabel

def getPredictions(summaries, testSet):
	predictions = []
	for i in range(len(testSet)):
		result = predict(summaries, testSet[i])
		predictions.append(result)
	return predictions

def getAccuracy(testSet, predictions):
	correct = 0
	for i in range(len(testSet)):
		if testSet[i][-1] == predictions[i]:
			correct += 1
	return (correct/float(len(testSet))) * 100.0

def main():
	filename = 'Data.csv'
	splitRatio = 0.67
	dataset = loadCsv(filename)
	trainingSet, testSet = splitDataset(dataset, splitRatio)
	print('Split {0} rows into train={1} and test={2} rows'.format(len(dataset), len(trainingSet), len(testSet)))
	# prepare model
	summaries = summarizeByClass(trainingSet)
	# test model
	predictions = getPredictions(summaries, testSet)
	accuracy = getAccuracy(testSet, predictions)
	print('Accuracy: {0}%'.format(accuracy))
    

main()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-4">4</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-6">6</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-8">8</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-10">10</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-12">12</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-14">14</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-16">16</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-18">18</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-20">20</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-22">22</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-24">24</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-26">26</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-28">28</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-30">30</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-32">32</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-34">34</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-36">36</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-38">38</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-40">40</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-42">42</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-44">44</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-46">46</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-48">48</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-50">50</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-52">52</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-54">54</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-56">56</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4b076823930958-58">58</div><div class="crayon-num" data-line="crayon-5c0ca9fe4b076823930958-59">59</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-1"><span class="crayon-p"># -*- coding: utf-8 -*-</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-2"><span class="crayon-s">""</span><span class="crayon-s">"</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-3"><span class="crayon-s">Created on Sun Feb  4 07:30:57 2018</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-4"> </div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-5"><span class="crayon-s">@author: SONAM</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-6"><span class="crayon-s">"</span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-7"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-8"><span class="crayon-p"># Example of Naive Bayes implemented from Scratch in Python</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-9"><span class="crayon-e">from </span><span class="crayon-e">__future__ </span><span class="crayon-e">import </span><span class="crayon-e">division</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-10"><span class="crayon-e">import </span><span class="crayon-e">csv</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-11"><span class="crayon-e">import </span><span class="crayon-e">random</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-12"><span class="crayon-e">import </span><span class="crayon-e">math</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-13"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-14"> </div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-15"><span class="crayon-e">def </span><span class="crayon-e">loadCsv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-16"><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">csv</span><span class="crayon-sy">.</span><span class="crayon-e">reader</span><span class="crayon-sy">(</span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"rt"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-17"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">lines</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-18"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-19"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-20"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">dataset</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-21"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-22"><span class="crayon-e">def </span><span class="crayon-e">splitDataset</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">splitRatio</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-23"><span class="crayon-h"> </span><span class="crayon-v">trainSize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">splitRatio</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-24"><span class="crayon-h"> </span><span class="crayon-v">trainSet</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-25"><span class="crayon-h"> </span><span class="crayon-v">copy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-26"><span class="crayon-h"> </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">trainSet</span><span class="crayon-sy">)</span><span class="crayon-h">  </span><span class="crayon-v">bestProb</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-27"><span class="crayon-h"> </span><span class="crayon-v">bestProb</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">probability</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-28"><span class="crayon-e"> </span><span class="crayon-v">bestLabel</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">classValue</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-29"><span class="crayon-e"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">bestLabel</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-30"> </div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-31"><span class="crayon-e">def </span><span class="crayon-e">getPredictions</span><span class="crayon-sy">(</span><span class="crayon-v">summaries</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testSet</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-32"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-33"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">testSet</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-34"><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">summaries</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testSet</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-35"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">result</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-36"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">predictions</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-37"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-38"><span class="crayon-e">def </span><span class="crayon-e">getAccuracy</span><span class="crayon-sy">(</span><span class="crayon-v">testSet</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-39"><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-40"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">testSet</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-41"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">testSet</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-42"><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-43"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">correct</span><span class="crayon-o">/</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">testSet</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">100.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-44"> </div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-45"><span class="crayon-e">def </span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-46"><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Data.csv'</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-47"><span class="crayon-h"> </span><span class="crayon-v">splitRatio</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.67</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-48"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">loadCsv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-49"><span class="crayon-h"> </span><span class="crayon-v">trainingSet</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testSet</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">splitDataset</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">splitRatio</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-50"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Split {0} rows into train={1} and test={2} rows'</span><span class="crayon-sy">.</span><span class="crayon-e">format</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">trainingSet</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">testSet</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-51"><span class="crayon-h"> </span><span class="crayon-p"># prepare model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-52"><span class="crayon-h"> </span><span class="crayon-v">summaries</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">summarizeByClass</span><span class="crayon-sy">(</span><span class="crayon-v">trainingSet</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-53"><span class="crayon-h"> </span><span class="crayon-p"># test model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-54"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">getPredictions</span><span class="crayon-sy">(</span><span class="crayon-v">summaries</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testSet</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-55"><span class="crayon-h"> </span><span class="crayon-v">accuracy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">getAccuracy</span><span class="crayon-sy">(</span><span class="crayon-v">testSet</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-56"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy: {0}%'</span><span class="crayon-sy">.</span><span class="crayon-e">format</span><span class="crayon-sy">(</span><span class="crayon-v">accuracy</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-57"><span class="crayon-h">    </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4b076823930958-58"> </div><div class="crayon-line" id="crayon-5c0ca9fe4b076823930958-59"><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0026 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to som" class="comment-reply-link" href="#comment-428384" onclick='return addComment.moveForm( "comment-428384", "428384", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-430268">
<div class="comment-container" id="li-comment-430268">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c9ff1be649aaa89b8c036b693c9c8020?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c9ff1be649aaa89b8c036b693c9c8020?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">shadhana</span>
<span class="date">February 23, 2018 at 4:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-430268" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>is there a way to get the elements that fall under each class after the classification is done</p>
<div class="reply">
<a aria-label="Reply to shadhana" class="comment-reply-link" href="#comment-430268" onclick='return addComment.moveForm( "comment-430268", "430268", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-430313">
<div class="comment-container" id="li-comment-430313">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 23, 2018 at 12:03 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-430313" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Do you mean a confusion matrix:<br/>
<a href="https://machinelearningmastery.com/confusion-matrix-machine-learning/" rel="nofollow">https://machinelearningmastery.com/confusion-matrix-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430313" onclick='return addComment.moveForm( "comment-430313", "430313", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-430931">
<div class="comment-container" id="li-comment-430931">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e48ae807193624610bf72ce14d9d1b15?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e48ae807193624610bf72ce14d9d1b15?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Christian Post</span>
<span class="date">March 3, 2018 at 12:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-430931" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I added this function:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe4af81288647245" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
def confusionMatrix(testSet, predictions):
    #TP = true positive, FP = false positive
    #TN = true negative, FN = false negative
    TP, FP, TN, FN = 0,0,0,0 
    for i in range(len(testSet)):
        if testSet[i][-1] == 1:
            if testSet[i][-1] == predictions[i]:
                TP +=1
            else: 
                FP +=1
        else:
            if testSet[i][-1] == predictions[i]:
                TN +=1
            else: 
                FN +=1
    return[TP, FP, TN, FN]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe4af81288647245-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4af81288647245-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe4af81288647245-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4af81288647245-4">4</div><div class="crayon-num" data-line="crayon-5c0ca9fe4af81288647245-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4af81288647245-6">6</div><div class="crayon-num" data-line="crayon-5c0ca9fe4af81288647245-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4af81288647245-8">8</div><div class="crayon-num" data-line="crayon-5c0ca9fe4af81288647245-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4af81288647245-10">10</div><div class="crayon-num" data-line="crayon-5c0ca9fe4af81288647245-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4af81288647245-12">12</div><div class="crayon-num" data-line="crayon-5c0ca9fe4af81288647245-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4af81288647245-14">14</div><div class="crayon-num" data-line="crayon-5c0ca9fe4af81288647245-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4af81288647245-16">16</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe4af81288647245-1"><span class="crayon-e">def </span><span class="crayon-e">confusionMatrix</span><span class="crayon-sy">(</span><span class="crayon-v">testSet</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4af81288647245-2"><span class="crayon-h">    </span><span class="crayon-p">#TP = true positive, FP = false positive</span></div><div class="crayon-line" id="crayon-5c0ca9fe4af81288647245-3"><span class="crayon-h">    </span><span class="crayon-p">#TN = true negative, FN = false negative</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4af81288647245-4"><span class="crayon-h">    </span><span class="crayon-v">TP</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">FP</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">TN</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">FN</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5c0ca9fe4af81288647245-5"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">testSet</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4af81288647245-6"><span class="crayon-h">        </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">testSet</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe4af81288647245-7"><span class="crayon-h">            </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">testSet</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4af81288647245-8"><span class="crayon-h">                </span><span class="crayon-v">TP</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5c0ca9fe4af81288647245-9"><span class="crayon-h">            </span><span class="crayon-st">else</span><span class="crayon-o">:</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4af81288647245-10"><span class="crayon-h">                </span><span class="crayon-v">FP</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5c0ca9fe4af81288647245-11"><span class="crayon-h">        </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4af81288647245-12"><span class="crayon-h">            </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">testSet</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca9fe4af81288647245-13"><span class="crayon-h">                </span><span class="crayon-v">TN</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4af81288647245-14"><span class="crayon-h">            </span><span class="crayon-st">else</span><span class="crayon-o">:</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5c0ca9fe4af81288647245-15"><span class="crayon-h">                </span><span class="crayon-v">FN</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4af81288647245-16"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-sy">[</span><span class="crayon-v">TP</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">FP</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">TN</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">FN</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0010 seconds] -->
<p>There is probably a more elegant way to write this code, but I’m new to Python 🙂</p>
<p>The returning array lets you calculate all sorts of criteria, such as sensitivity, specifity, predictive value, likelihood ratio etc.</p>
<div class="reply">
<a aria-label="Reply to Christian Post" class="comment-reply-link" href="#comment-430931" onclick='return addComment.moveForm( "comment-430931", "430931", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-431617">
<div class="comment-container" id="li-comment-431617">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e48ae807193624610bf72ce14d9d1b15?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e48ae807193624610bf72ce14d9d1b15?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Christian Post</span>
<span class="date">March 9, 2018 at 2:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-431617" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Whoops I realized I mixed something up. FP and FN have to be the other way round since the outer if-clause checks the true condition. I hope no one has copied that and got in trouble…<br/>
Anyways, looks like the confusion matrix lives up to its name.</p>
<div class="reply">
<a aria-label="Reply to Christian Post" class="comment-reply-link" href="#comment-431617" onclick='return addComment.moveForm( "comment-431617", "431617", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-430932">
<div class="comment-container" id="li-comment-430932">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e48ae807193624610bf72ce14d9d1b15?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e48ae807193624610bf72ce14d9d1b15?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Christian Post</span>
<span class="date">March 3, 2018 at 12:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-430932" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason, </p>
<p>first of all, thanks for this blog. I learned a lot both on python (which I am pretty new to) and also this specific classifier.</p>
<p>I tested this algorithm on a sample database with cholesterol, age and heart desease, and got better results than with a logistic regression.<br/>
However, since age is clearly not normally distributed, I am not sure if this result is even legit.<br/>
Could you explain how I can change the calculateProbability function to a different distribution?</p>
<p>Oh, and also: How can I add code tags to my replies so that it becomes more readable?</p>
<div class="reply">
<a aria-label="Reply to Christian Post" class="comment-reply-link" href="#comment-430932" onclick='return addComment.moveForm( "comment-430932", "430932", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-430969">
<div class="comment-container" id="li-comment-430969">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 3, 2018 at 8:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-430969" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This code is for learning purposes, I would recommend using the built-in functions in scikit-learn for real projects:<br/>
<a href="https://machinelearningmastery.com/start-here/#python" rel="nofollow">https://machinelearningmastery.com/start-here/#python</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430969" onclick='return addComment.moveForm( "comment-430969", "430969", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-431472">
<div class="comment-container" id="li-comment-431472">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b7d93b68858e06c3ddd8e40665260f03?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b7d93b68858e06c3ddd8e40665260f03?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nil</span>
<span class="date">March 7, 2018 at 8:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-431472" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi DR. Jason,</p>
<p>It is a very good post.<br/>
I did not see the K Fold Cross Validation in this post like I saw in your post of Neural Network from scratch. Does it mean that Naive Bayes does not need K Fold Cross Validation? Or does not work with K Fold CV?<br/>
It is because I am trying to use K Fold CV with Naive Bayes from scratch but I find it difficult since we need to split data by class to make some calculations, we find there two datasets if we have two class classification dataset (but we have one K Fold CV function).<br/>
I am facing serious difficulties to understand K Fold CV it seams that the implementation from scratch depends on the classifier we are using.   </p>
<p>If you have some answer or tips to this approach (validation on Naive Bayes with K Fold CV – from scratch – ) please let me know.</p>
<p>Regards.</p>
<div class="reply">
<a aria-label="Reply to Nil" class="comment-reply-link" href="#comment-431472" onclick='return addComment.moveForm( "comment-431472", "431472", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-431537">
<div class="comment-container" id="li-comment-431537">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 8, 2018 at 6:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-431537" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It is a good idea to use CV to evaluate algorithms including naive bayes.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-431537" onclick='return addComment.moveForm( "comment-431537", "431537", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-435728">
<div class="comment-container" id="li-comment-435728">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/762aede82e7053118af9885306d22c06?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/762aede82e7053118af9885306d22c06?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">y</span>
<span class="date">April 23, 2018 at 11:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-435728" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If the variance is equal to 0, how to deal with？</p>
<div class="reply">
<a aria-label="Reply to y" class="comment-reply-link" href="#comment-435728" onclick='return addComment.moveForm( "comment-435728", "435728", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-435766">
<div class="comment-container" id="li-comment-435766">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 24, 2018 at 6:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-435766" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If the variance is 0, then all data in your sample has the same value.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435766" onclick='return addComment.moveForm( "comment-435766", "435766", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-435886">
<div class="comment-container" id="li-comment-435886">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/762aede82e7053118af9885306d22c06?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/762aede82e7053118af9885306d22c06?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">y</span>
<span class="date">April 25, 2018 at 5:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-435886" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca9fe4ad0a111554004" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
def calculateProbability(x, mean, stdev):
	exponent = math.exp(-(math.pow(x-mean,2)/(2*math.pow(stdev,2))))
	return (1 / (math.sqrt(2*math.pi) * stdev)) * exponent</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca9fe4ad0a111554004-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca9fe4ad0a111554004-2">2</div><div class="crayon-num" data-line="crayon-5c0ca9fe4ad0a111554004-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca9fe4ad0a111554004-1"><span class="crayon-e">def </span><span class="crayon-e">calculateProbability</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca9fe4ad0a111554004-2"><span class="crayon-h"> </span><span class="crayon-v">exponent</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-sy">(</span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">pow</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-o">-</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-o">*</span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">pow</span><span class="crayon-sy">(</span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca9fe4ad0a111554004-3"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-o">*</span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-v">pi</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">exponent</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>if ‘stdev’ is 0 , how to deal with it?</p>
<div class="reply">
<a aria-label="Reply to y" class="comment-reply-link" href="#comment-435886" onclick='return addComment.moveForm( "comment-435886", "435886", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-435954">
<div class="comment-container" id="li-comment-435954">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 26, 2018 at 6:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-435954" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If stdev is 0 it means all values are the same and that feature should be removed.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435954" onclick='return addComment.moveForm( "comment-435954", "435954", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-439002">
<div class="comment-container" id="li-comment-439002">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7e86fd1fa5ad5746953d4732859e5414?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7e86fd1fa5ad5746953d4732859e5414?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">kk</span>
<span class="date">May 29, 2018 at 4:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-439002" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How can I retrain my model, without training it from scratch again?<br/>
Like if I got some new label for instances, how to approach it then?</p>
<div class="reply">
<a aria-label="Reply to kk" class="comment-reply-link" href="#comment-439002" onclick='return addComment.moveForm( "comment-439002", "439002", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-439063">
<div class="comment-container" id="li-comment-439063">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 30, 2018 at 6:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-439063" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Many models can be updated with new data.</p>
<p>With naive bayes, you can keep track of the frequency and likelihood of obs for discrete values or the PDF/mass function for continuous values and update them with new data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-439063" onclick='return addComment.moveForm( "comment-439063", "439063", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-440093">
<div class="comment-container" id="li-comment-440093">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/321d02ed66eda44aedfadae7ef0569ff?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/321d02ed66eda44aedfadae7ef0569ff?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Manoj</span>
<span class="date">June 7, 2018 at 7:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-440093" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Very good Program, its working correctly, how to construct the bayesian network taking this pima diabetes csv file.</p>
<div class="reply">
<a aria-label="Reply to Manoj" class="comment-reply-link" href="#comment-440093" onclick='return addComment.moveForm( "comment-440093", "440093", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-440150">
<div class="comment-container" id="li-comment-440150">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 8, 2018 at 6:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-440150" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-440150" onclick='return addComment.moveForm( "comment-440150", "440150", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-442249">
<div class="comment-container" id="li-comment-442249">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6d5d1e0491852a53007be123deb75727?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6d5d1e0491852a53007be123deb75727?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Yashvardhan</span>
<span class="date">June 28, 2018 at 5:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-442249" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey can I ask why didn’t you use a MLE estimate for the prior?</p>
<div class="reply">
<a aria-label="Reply to Yashvardhan" class="comment-reply-link" href="#comment-442249" onclick='return addComment.moveForm( "comment-442249", "442249", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-442286">
<div class="comment-container" id="li-comment-442286">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 29, 2018 at 5:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-442286" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>MLE?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442286" onclick='return addComment.moveForm( "comment-442286", "442286", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-443033">
<div class="comment-container" id="li-comment-443033">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/84a5e962d3cbb5dafecd2703ed08c696?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/84a5e962d3cbb5dafecd2703ed08c696?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vinayak Tyagi</span>
<span class="date">July 9, 2018 at 6:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-443033" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It’s  a  Navie-bayes-classifiation but insted of using Navies-bayes therom  we are using Gaussian Probability Density Function Why ?????</p>
<div class="reply">
<a aria-label="Reply to Vinayak Tyagi" class="comment-reply-link" href="#comment-443033" onclick='return addComment.moveForm( "comment-443033", "443033", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-443078">
<div class="comment-container" id="li-comment-443078">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 10, 2018 at 6:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-443078" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>To summarise a probability distribution.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443078" onclick='return addComment.moveForm( "comment-443078", "443078", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-443233">
<div class="comment-container" id="li-comment-443233">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/acfa84d01c96eb21bc3b5ee671db8707?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/acfa84d01c96eb21bc3b5ee671db8707?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Prajna p n</span>
<span class="date">July 11, 2018 at 10:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-443233" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>why input vector is [1.1,”?”] ? and it works fine I try with [1.1] . Why did we choose the number 1.1 as the parameter for input vector?</p>
<div class="reply">
<a aria-label="Reply to Prajna p n" class="comment-reply-link" href="#comment-443233" onclick='return addComment.moveForm( "comment-443233", "443233", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-443833">
<div class="comment-container" id="li-comment-443833">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5dddb917942905ff475b9382d486e433?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5dddb917942905ff475b9382d486e433?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Zhenduo Wang</span>
<span class="date">July 19, 2018 at 1:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-443833" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It seems that your code is using GaussianNB without prior. The prior is obtained with MLE estimator of the training set. It is simply a constant multiplied by the computed likelihood probability. I tried both (with/without prior) and found that predicting with prior would give better results most of the time.</p>
<div class="reply">
<a aria-label="Reply to Zhenduo Wang" class="comment-reply-link" href="#comment-443833" onclick='return addComment.moveForm( "comment-443833", "443833", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-443863">
<div class="comment-container" id="li-comment-443863">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 19, 2018 at 7:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-443863" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443863" onclick='return addComment.moveForm( "comment-443863", "443863", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-444818">
<div class="comment-container" id="li-comment-444818">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/64bc917c1e7f72a26e33450b0bb66d31?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/64bc917c1e7f72a26e33450b0bb66d31?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ken stonecipher</span>
<span class="date">July 31, 2018 at 2:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-444818" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, why do I get the error messate<br/>
AttributeError: ‘dict’ object has no attribute ‘iteritems’ when I am trying the run the<br/>
# Split the dataset by class values, returns a dictionary in the Naïve Bayes example in Chapter 12 of the Algorithms from Scratch in Python tutorial?</p>
<p>Thanks</p>
<p>Ken</p>
<div class="reply">
<a aria-label="Reply to ken stonecipher" class="comment-reply-link" href="#comment-444818" onclick='return addComment.moveForm( "comment-444818", "444818", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-444842">
<div class="comment-container" id="li-comment-444842">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 31, 2018 at 6:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-444842" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sounds like you are using Python 3 for Python 2.7 code.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444842" onclick='return addComment.moveForm( "comment-444842", "444842", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-444819">
<div class="comment-container" id="li-comment-444819">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/64bc917c1e7f72a26e33450b0bb66d31?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/64bc917c1e7f72a26e33450b0bb66d31?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ken stonecipher</span>
<span class="date">July 31, 2018 at 2:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-444819" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, I figured it out.  In Py 3.X does not understand the .interitem function so when I changed that to Py 2.7 .item it worked fine.  Version difference between 3.X and 2.7</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to ken stonecipher" class="comment-reply-link" href="#comment-444819" onclick='return addComment.moveForm( "comment-444819", "444819", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-444843">
<div class="comment-container" id="li-comment-444843">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 31, 2018 at 6:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-444843" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear it.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444843" onclick='return addComment.moveForm( "comment-444843", "444843", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-444916">
<div class="comment-container" id="li-comment-444916">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fde73af4f7c257e9b4144994d4ac8b86?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fde73af4f7c257e9b4144994d4ac8b86?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">tommy</span>
<span class="date">July 31, 2018 at 11:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-444916" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>Thank you for the helpful post.<br/>
When i ran the code in python 3.6 i encountered the<br/>
“ZeroDivisionError: float division by zero” ERROR<br/>
any advise on this?</p>
<div class="reply">
<a aria-label="Reply to tommy" class="comment-reply-link" href="#comment-444916" onclick='return addComment.moveForm( "comment-444916", "444916", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-444958">
<div class="comment-container" id="li-comment-444958">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 1, 2018 at 7:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-444958" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The code was written for Py2.7</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444958" onclick='return addComment.moveForm( "comment-444958", "444958", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-445058">
<div class="comment-container" id="li-comment-445058">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/189573ac1e26289dd40ac984f0988ab2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/189573ac1e26289dd40ac984f0988ab2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">jitesh pahwa</span>
<span class="date">August 2, 2018 at 4:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-445058" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thank you Jason for your awesome post.</p>
<div class="reply">
<a aria-label="Reply to jitesh pahwa" class="comment-reply-link" href="#comment-445058" onclick='return addComment.moveForm( "comment-445058", "445058", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-445103">
<div class="comment-container" id="li-comment-445103">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 3, 2018 at 5:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-445103" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m happy it helped.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-445103" onclick='return addComment.moveForm( "comment-445103", "445103", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-446926">
<div class="comment-container" id="li-comment-446926">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/38c8dc24a155144d2172d9e4d39ba030?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/38c8dc24a155144d2172d9e4d39ba030?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sheshank Kumar</span>
<span class="date">August 25, 2018 at 2:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-446926" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I want to calculate the F1 Score. I can do this for binary classification problem. I am confused how to do it for multi class classification. I have calculated the confusion matrix for my data set. my data set contains three different classValue.</p>
<p>Kindly suggest.</p>
<div class="reply">
<a aria-label="Reply to Sheshank Kumar" class="comment-reply-link" href="#comment-446926" onclick='return addComment.moveForm( "comment-446926", "446926", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-446974">
<div class="comment-container" id="li-comment-446974">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 26, 2018 at 6:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-446974" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The sklearn library may support this, more here:<br/>
<a href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.f1_score.html" rel="nofollow">http://scikit-learn.org/stable/modules/generated/sklearn.metrics.f1_score.html</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-446974" onclick='return addComment.moveForm( "comment-446974", "446974", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-447428">
<div class="comment-container" id="li-comment-447428">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/70216cd5afefa9969e8a1cb36ce5ba2d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/70216cd5afefa9969e8a1cb36ce5ba2d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://joinwitraj.com/" rel="external nofollow">Rajkumar</a></span>
<span class="date">August 31, 2018 at 7:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-447428" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the awesome work. P.S external link to the weka for naive bayes shown 404. </p>
<p>Kind Regards</p>
<div class="reply">
<a aria-label="Reply to Rajkumar" class="comment-reply-link" href="#comment-447428" onclick='return addComment.moveForm( "comment-447428", "447428", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-447466">
<div class="comment-container" id="li-comment-447466">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 1, 2018 at 6:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-447466" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-447466" onclick='return addComment.moveForm( "comment-447466", "447466", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-450259">
<div class="comment-container" id="li-comment-450259">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/70c92773a6e12a36659eb008fc7b0d9f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/70c92773a6e12a36659eb008fc7b0d9f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sajida</span>
<span class="date">September 29, 2018 at 10:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-450259" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Sir</p>
<p>Great example. You are doing a great great work thanks. kindly also upload similar post related to hidden markov model</p>
<div class="reply">
<a aria-label="Reply to Sajida" class="comment-reply-link" href="#comment-450259" onclick='return addComment.moveForm( "comment-450259", "450259", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-450291">
<div class="comment-container" id="li-comment-450291">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 30, 2018 at 6:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-450291" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-450291" onclick='return addComment.moveForm( "comment-450291", "450291", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-450505">
<div class="comment-container" id="li-comment-450505">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/42d46c62a1c62e711f2fe6b88485f5ef?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/42d46c62a1c62e711f2fe6b88485f5ef?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Javier Lazaro</span>
<span class="date">October 3, 2018 at 12:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-450505" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for posting this nice algorithm explained. Nevertheless I struggled a lot until I found out that it is a Gaussian Naive Bayes version. I expected calculations of probabilities counting the prior, posterior, etc. It took me a while to figure it out. I have learnt a lot through it, though 🙂</p>
<div class="reply">
<a aria-label="Reply to Javier Lazaro" class="comment-reply-link" href="#comment-450505" onclick='return addComment.moveForm( "comment-450505", "450505", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-450529">
<div class="comment-container" id="li-comment-450529">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 3, 2018 at 6:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-450529" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-450529" onclick='return addComment.moveForm( "comment-450529", "450529", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-452026">
<div class="comment-container" id="li-comment-452026">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7557b860f14f243f3e140ac9b577a7ec?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7557b860f14f243f3e140ac9b577a7ec?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">roba</span>
<span class="date">October 18, 2018 at 10:11 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-452026" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How we fix this error in python 2.7</p>
<p>return sum(numbers) / (len(numbers))<br/>
TypeError: unsupported operand type(s) for +: ‘int’ and ‘str’</p>
<p>thank you for your awesome post…</p>
<div class="reply">
<a aria-label="Reply to roba" class="comment-reply-link" href="#comment-452026" onclick='return addComment.moveForm( "comment-452026", "452026", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-452286">
<div class="comment-container" id="li-comment-452286">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f7039f7c5a7dd72113fd4685b3d9ac45?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f7039f7c5a7dd72113fd4685b3d9ac45?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mustajab Hussain</span>
<span class="date">October 21, 2018 at 10:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-452286" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason. I am getting this error while running your code<br/>
 File “C:/Users/Mustajab/Desktop/ML Assignment/Naive Bayes.py”, line 191, in loadCsv<br/>
    dataset = list(lines)</p>
<p>Error: iterator should return strings, not bytes (did you open the file in text mode?)</p>
<p>How can I fix this error?</p>
<div class="reply">
<a aria-label="Reply to Mustajab Hussain" class="comment-reply-link" href="#comment-452286" onclick='return addComment.moveForm( "comment-452286", "452286", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-455354">
<div class="comment-container" id="li-comment-455354">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f1680c78e6ba569a6a4f5ffa7ae985a7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f1680c78e6ba569a6a4f5ffa7ae985a7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">dingusagar</span>
<span class="date">November 18, 2018 at 11:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-455354" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>P(A/B) = (P(B/A)P(A))  /  P(B))</p>
<p>This is the formula..</p>
<p>In RHS of the formula we use only numerator because denominators are same for every class and doen’t add any extra info as to determine which probability is bigger.</p>
<p>But I don’t thing the numerator is correctly implemented in the function.<br/>
Specifically P(A) needs to be multiplied with the product of the conditional probabilities of the individual features belonging to a particular class.</p>
<p>P(A) here is our class probability. That term is not multiplied to the final product inside the calculateClassProbabilities() function.</p>
<div class="reply">
<a aria-label="Reply to dingusagar" class="comment-reply-link" href="#comment-455354" onclick='return addComment.moveForm( "comment-455354", "455354", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-456302">
<div class="comment-container" id="li-comment-456302">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c4d111e3ed1737b5d5fa57bda1fa5af7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c4d111e3ed1737b5d5fa57bda1fa5af7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kody</span>
<span class="date">November 27, 2018 at 9:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-456302" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Something seems off here. Your inputs to the calculateProbability() function are x=71.5, mean=73.0, stdev=6.2. Some simple math will tell you that x is 0.24 standard deviations away from the mean. In a Gaussian distribution, you can’t get much closer than that. Yet the probability of belonging to that distribution is only 6%? Shouldn’t this be something more like 94%?</p>
<div class="reply">
<a aria-label="Reply to Kody" class="comment-reply-link" href="#comment-456302" onclick='return addComment.moveForm( "comment-456302", "456302", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-456958">
<div class="comment-container" id="li-comment-456958">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/38a7b35e3f57967211aa09a16b060c7a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/38a7b35e3f57967211aa09a16b060c7a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">mathis</span>
<span class="date">December 2, 2018 at 3:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-456958" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hello Jason, I try to run this code with my own file but I get “ValueError: could not convert string to float: wtdeer”. do you know How can I fix it ?<br/>
thank you so much</p>
<div class="reply">
<a aria-label="Reply to mathis" class="comment-reply-link" href="#comment-456958" onclick='return addComment.moveForm( "comment-456958", "456958", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-457039">
<div class="comment-container" id="li-comment-457039">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 3, 2018 at 6:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-457039" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps try using the scikit-learn library as a starting point:<br/>
<a href="https://machinelearningmastery.com/start-here/#python" rel="nofollow">https://machinelearningmastery.com/start-here/#python</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-457039" onclick='return addComment.moveForm( "comment-457039", "457039", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-457530">
<div class="comment-container" id="li-comment-457530">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ed70b3892f1d7d84139cd9c104816980?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ed70b3892f1d7d84139cd9c104816980?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">FAW</span>
<span class="date">December 6, 2018 at 9:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-457530" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice tutorials Jason, however needs your attention for the typo in print statements, hope it will be fixed soon. </p>
<p>Thanks anyways once again for providing such a nice explanation!</p>
<div class="reply">
<a aria-label="Reply to FAW" class="comment-reply-link" href="#comment-457530" onclick='return addComment.moveForm( "comment-457530", "457530", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-457555">
<div class="comment-container" id="li-comment-457555">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 6, 2018 at 1:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/naive-bayes-classifier-scratch-python/#comment-457555" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-457555" onclick='return addComment.moveForm( "comment-457555", "457555", "respond", "1945" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/naive-bayes-classifier-scratch-python/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="1945"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="58b0039111"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="57"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery!</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Jason Brownlee, PhD
<br/>
I write tutorials to help developers (<i>like you</i>) get results with machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-19"> <div class="textwidget"><p></p><center><br/>
<strong>Code Algorithms From Scratch</strong><br/>
No libraries, just simple Python code.
<p><a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Click to Get Started Now!</a><br/>
<a href="/machine-learning-algorithms-from-scratch/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningAlgorithmsFromScratch-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch"><img alt="How to Develop a Neural Machine Translation System in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/01/How-to-Develop-a-Neural-Machine-Translation-System-in-Keras-150x150.jpg" title="How to Develop a Neural Machine Translation System from Scratch" width="45"/></a> <a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch">How to Develop a Neural Machine Translation System from Scratch</a>
<span class="meta">January 10, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning"><img alt="Difference Between Classification and Regression in Machine Learning" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/Difference-Between-Classification-and-Regression-in-Machine-Learning-150x150.jpg" title="Difference Between Classification and Regression in Machine Learning" width="45"/></a> <a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning">Difference Between Classification and Regression in Machine Learning</a>
<span class="meta">December 11, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem..."><img alt="So, You are Working on a Machine Learning Problem..." class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/So-You-are-Working-on-a-Machine-Learning-Problem...-150x150.jpg" title="So, You are Working on a Machine Learning Problem..." width="45"/></a> <a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem…">So, You are Working on a Machine Learning Problem…</a>
<span class="meta">April 4, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis"><img alt="Plot of the Multichannel Convolutional Neural Network For Text" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-150x150.png" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis" width="45"/></a> <a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis">How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis</a>
<span class="meta">January 12, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras"><img alt="How to Make Classification and Regression Predictions for Deep Learning Models in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/How-to-Make-Classification-and-Regression-Predictions-for-Deep-Learning-Models-in-Keras-150x150.jpg" title="How to Make Predictions with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras">How to Make Predictions with Keras</a>
<span class="meta">April 9, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)"><img alt="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/11-Classical-Time-Series-Forecasting-Methods-in-Python-Cheat-Sheet-150x150.jpg" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)">11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)</a>
<span class="meta">August 6, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras"><img alt="How to Visualize a Deep Learning Neural Network Model in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/How-to-Visualize-a-Deep-Learning-Neural-Network-Model-in-Keras-150x150.jpg" title="How to Visualize a Deep Learning Neural Network Model in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras">How to Visualize a Deep Learning Neural Network Model in Keras</a>
<span class="meta">December 13, 2017</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> <div class="widget_text widget widget_custom_html" id="custom_html-2"><h3>You might also like…</h3><div class="textwidget custom-html-widget"><ul>
<li><a href="/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Install Python for Machine Learning</a></li>
<li><a href="/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python</a></li>
<li><a href="/tutorial-first-neural-network-python-keras/">Your First Neural Network in Python</a></li>
<li><a href="/how-to-run-your-first-classifier-in-weka/">Your First Classifier in Weka</a></li>
<li><a href="/arima-for-time-series-forecasting-with-python/">Your First Time Series Forecasting Project</a></li>
</ul></div></div></aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/disclaimer/">Disclaimer</a> | 
<a href="/terms-of-service/">Terms</a> | 
<a href="/contact/">Contact</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.8" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.0.5" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.8" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.1" type="text/javascript"></script>
</body>
</html>