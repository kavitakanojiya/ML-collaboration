<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v9.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>How to Implement Random Forest From Scratch in Python</title>
<link href="https://machinelearningmastery.com/implement-random-forest-scratch-python/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="How to Implement Random Forest From Scratch in Python" property="og:title"/>
<meta content="Decision trees can suffer from high variance which makes their results fragile to the specific training data used. Building multiple models from samples of your training data, called bagging, can reduce this variance, but the trees are highly correlated. Random Forest is an extension of bagging that in addition to building trees based on multiple …" property="og:description"/>
<meta content="https://machinelearningmastery.com/implement-random-forest-scratch-python/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="https://www.facebook.com/jason.brownlee.39" property="article:author"/>
<meta content="Code Machine Learning Algorithms From Scratch" property="article:section"/>
<meta content="2016-11-13T18:00:42+00:00" property="article:published_time"/>
<meta content="2018-08-27T22:13:00+00:00" property="article:modified_time"/>
<meta content="2018-08-27T22:13:00+00:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-Random-Forest-From-Scratch-in-Python.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-Random-Forest-From-Scratch-in-Python.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="426" property="og:image:height"/>
<meta content="How to Implement Random Forest From Scratch in Python" property="og:image:alt"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"https:\/\/machinelearningmastery.com\/#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/implement-random-forest-scratch-python/feed/" rel="alternate" title="Machine Learning Mastery » How to Implement Random Forest From Scratch in Python Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<style media="all" type="text/css">
.wpautoterms-footer{background-color:#ffffff;text-align:center;}
.wpautoterms-footer a{color:#000000;font-family:Arial, sans-serif;font-size:14px;}
.wpautoterms-footer .separator{color:#cccccc;font-family:Arial, sans-serif;font-size:14px;}</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/auto-terms-of-service-and-privacy-policy/css/wpautoterms.css?ver=4.9.8" id="wpautoterms_css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.0.5" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/css/front.css?ver=2.0.20" id="ssb-front-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/ewd-ufaq-styles.css?ver=4.9.8" id="ewd-ufaq-style-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/rrssb-min.css?ver=4.9.8" id="ewd-ufaq-rrssb-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.8" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=2.0.20" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.8" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.8" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=3360" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-random-forest-scratch-python%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-random-forest-scratch-python%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<style media="screen">

        .simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
      margin: ;
    }
         /*inline margin*/
    
  
  
  
  
  
          .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
         margin: ;
     }

          /*margin-digbar*/

  
  
  
  
 
   
   

</style>
<script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#4c89bf; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#4c89bf;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#4c89bf!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#ffffff;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-3360 single-format-standard safari alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/icon-100x100.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-18"> <div class="textwidget"><p>Want help with machine learning? <a href="https://machinelearningmastery.leadpages.co/machine-learning-resource-guide/">Take the FREE Crash-Course</a>.</p>
</div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<input name="post_type" type="hidden" value="post"/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Main Menu</h3><ul class="nav fl" id="main-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503" id="menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Start Here</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501" id="menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506" id="menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508" id="menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (Keras)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511" id="menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509" id="menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515" id="menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">Deep Learning for NLP</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512" id="menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Understand Algorithms</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6507" id="menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms (Python)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6513" id="menu-item-6513"><a href="https://machinelearningmastery.com/category/machine-learning-process/">Machine Learning Process</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516" id="menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517" id="menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522" id="menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6518" id="menu-item-6518"><a href="https://machinelearningmastery.com/category/start-machine-learning/">Getting Started</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510" id="menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519" id="menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistical Methods</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520" id="menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Time Series (introductory)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523" id="menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6514" id="menu-item-6514"><a href="https://machinelearningmastery.com/category/machine-learning-resources/">Resources</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502" id="menu-item-6502"><a href="https://machinelearningmastery.com/products/">Ebooks</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500" id="menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504" id="menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505" id="menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-3360 post type-post status-publish format-standard has-post-thumbnail hentry category-algorithms-from-scratch">
<header>
<h1 class="title entry-title">How to Implement Random Forest From Scratch in Python</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-11-14T05:00:42+1100">November 14, 2016</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/" title="View all items in Code Machine Learning Algorithms From Scratch">Code Machine Learning Algorithms From Scratch</a></span> </div>
<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-3360 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Implement+Random+Forest+From+Scratch+in+Python&amp;url=https://machinelearningmastery.com/implement-random-forest-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-random-forest-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/implement-random-forest-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/implement-random-forest-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
<p>Decision trees can suffer from high variance which makes their results fragile to the specific training data used.</p>
<p>Building multiple models from samples of your training data, called bagging, can reduce this variance, but the trees are highly correlated.</p>
<p>Random Forest is an extension of bagging that in addition to building trees based on multiple samples of your training data, it also constrains the features that can be used to build the trees, forcing trees to be different. This, in turn, can give a lift in performance.</p>
<p>In this tutorial, you will discover how to implement the Random Forest algorithm from scratch in Python.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>The difference between bagged decision trees and the random forest algorithm.</li>
<li>How to construct bagged decision trees with more variance.</li>
<li>How to apply the random forest algorithm to a predictive modeling problem.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Jan/2017</strong>: Changed the calculation of fold_size in cross_validation_split() to always be an integer. Fixes issues with Python 3.</li>
<li><strong>Update Feb/2017</strong>: Fixed a bug in build_tree.</li>
<li><strong>Update Aug/2017</strong>: Fixed a bug in Gini calculation, added the missing weighting of group Gini scores by group size (thanks Michael!).</li>
<li><strong>Update Aug/2018</strong>: Tested and updated to work with Python 3.6.</li>
</ul>
<div class="wp-caption aligncenter" id="attachment_3361" style="width: 650px"><img alt="How to Implement Random Forest From Scratch in Python" class="size-full wp-image-3361" height="426" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-Random-Forest-From-Scratch-in-Python.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-Random-Forest-From-Scratch-in-Python.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-Random-Forest-From-Scratch-in-Python-300x200.jpg 300w" width="640"/><p class="wp-caption-text">How to Implement Random Forest From Scratch in Python<br/>Photo by <a href="https://www.flickr.com/photos/inspirefatephotography/7569736320/">InspireFate Photography</a>, some rights reserved.</p></div>
<h2>Description</h2>
<p>This section provides a brief introduction to the Random Forest algorithm and the Sonar dataset used in this tutorial.</p>
<h3>Random Forest Algorithm</h3>
<p>Decision trees involve the greedy selection of the best split point from the dataset at each step.</p>
<p>This algorithm makes decision trees susceptible to high variance if they are not pruned. This high variance can be harnessed and reduced by creating multiple trees with different samples of the training dataset (different views of the problem) and combining their predictions. This approach is called bootstrap aggregation or bagging for short.</p>
<p>A limitation of bagging is that the same greedy algorithm is used to create each tree, meaning that it is likely that the same or very similar split points will be chosen in each tree making the different trees very similar (trees will be correlated). This, in turn, makes their predictions similar, mitigating the variance originally sought.</p>
<p>We can force the decision trees to be different by limiting the features (rows) that the greedy algorithm can evaluate at each split point when creating the tree. This is called the Random Forest algorithm.</p>
<p>Like bagging, multiple samples of the training dataset are taken and a different tree trained on each. The difference is that at each point a split is made in the data and added to the tree, only a fixed subset of attributes can be considered.</p>
<p>For classification problems, the type of problems we will look at in this tutorial, the number of attributes to be considered for the split is limited to the square root of the number of input features.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7180c96b982681114" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
num_features_for_split = sqrt(total_input_features)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7180c96b982681114-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7180c96b982681114-1">num_features_for_split = sqrt(total_input_features)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The result of this one small change are trees that are more different from each other (uncorrelated) resulting predictions that are more diverse and a combined prediction that often has better performance that single tree or bagging alone.</p>
<h3>Sonar Dataset</h3>
<p>The dataset we will use in this tutorial is the Sonar dataset.</p>
<p>This is a dataset that describes sonar chirp returns bouncing off different surfaces. The 60 input variables are the strength of the returns at different angles. It is a binary classification problem that requires a model to differentiate rocks from metal cylinders. There are 208 observations.</p>
<p>It is a well-understood dataset. All of the variables are continuous and generally in the range of 0 to 1. The output variable is a string “M” for mine and “R” for rock, which will need to be converted to integers 1 and 0.</p>
<p>By predicting the class with the most observations in the dataset (M or mines) the Zero Rule Algorithm can achieve an accuracy of 53%.</p>
<p>You can learn more about this dataset at the <a href="https://archive.ics.uci.edu/ml/datasets/Connectionist+Bench+(Sonar,+Mines+vs.+Rocks)">UCI Machine Learning repository</a>.</p>
<p>Download the dataset for free and place it in your working directory with the filename <strong>sonar.all-data.csv</strong>.</p>
<h2>Tutorial</h2>
<p>This tutorial is broken down into 2 steps.</p>
<ol>
<li>Calculating Splits.</li>
<li>Sonar Dataset Case Study.</li>
</ol>
<p>These steps provide the foundation that you need to implement and apply the Random Forest algorithm to your own predictive modeling problems.</p>
<h3>1. Calculating Splits</h3>
<p>In a decision tree, split points are chosen by finding the attribute and the value of that attribute that results in the lowest cost.</p>
<p>For classification problems, this cost function is often the Gini index, that calculates the purity of the groups of data created by the split point. A Gini index of 0 is perfect purity where class values are perfectly separated into two groups, in the case of a two-class classification problem.</p>
<p>Finding the best split point in a decision tree involves evaluating the cost of each value in the training dataset for each input variable.</p>
<p>For bagging and random forest, this procedure is executed upon a sample of the training dataset, made with replacement. Sampling with replacement means that the same row may be chosen and added to the sample more than once.</p>
<p>We can update this procedure for Random Forest. Instead of enumerating all values for input attributes in search if the split with the lowest cost, we can create a sample of the input attributes to consider.</p>
<p>This sample of input attributes can be chosen randomly and without replacement, meaning that each input attribute needs only be considered once when looking for the split point with the lowest cost.</p>
<p>Below is a function name <strong>get_split()</strong> that implements this procedure. It takes a dataset and a fixed number of input features from to evaluate as input arguments, where the dataset may be a sample of the actual training dataset.</p>
<p>The helper function <strong>test_split()</strong> is used to split the dataset by a candidate split point and <strong>gini_index()</strong> is used to evaluate the cost of a given split by the groups of rows created.</p>
<p>We can see that a list of features is created by randomly selecting feature indices and adding them to a list (called <strong>features</strong>), this list of features is then enumerated and specific values in the training dataset evaluated as split points.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7180c974374702228" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Select the best split point for a dataset
def get_split(dataset, n_features):
	class_values = list(set(row[-1] for row in dataset))
	b_index, b_value, b_score, b_groups = 999, 999, 999, None
	features = list()
	while len(features) &lt; n_features:
		index = randrange(len(dataset[0])-1)
		if index not in features:
			features.append(index)
	for index in features:
		for row in dataset:
			groups = test_split(index, row[index], dataset)
			gini = gini_index(groups, class_values)
			if gini &lt; b_score:
				b_index, b_value, b_score, b_groups = index, row[index], gini, groups
	return {'index':b_index, 'value':b_value, 'groups':b_groups}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7180c974374702228-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c974374702228-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7180c974374702228-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c974374702228-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7180c974374702228-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c974374702228-6">6</div><div class="crayon-num" data-line="crayon-5c0ca7180c974374702228-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c974374702228-8">8</div><div class="crayon-num" data-line="crayon-5c0ca7180c974374702228-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c974374702228-10">10</div><div class="crayon-num" data-line="crayon-5c0ca7180c974374702228-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c974374702228-12">12</div><div class="crayon-num" data-line="crayon-5c0ca7180c974374702228-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c974374702228-14">14</div><div class="crayon-num" data-line="crayon-5c0ca7180c974374702228-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c974374702228-16">16</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7180c974374702228-1"><span class="crayon-p"># Select the best split point for a dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c974374702228-2"><span class="crayon-e">def </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c974374702228-3"><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c974374702228-4"><span class="crayon-h"> </span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5c0ca7180c974374702228-5"><span class="crayon-e"> </span><span class="crayon-v">features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c974374702228-6"><span class="crayon-h"> </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">features</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c974374702228-7"><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c974374702228-8"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">index </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">features</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c974374702228-9"><span class="crayon-h"> </span><span class="crayon-v">features</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c974374702228-10"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">index </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">features</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c974374702228-11"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c974374702228-12"><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">test_split</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c974374702228-13"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">gini_index</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c974374702228-14"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c974374702228-15"><span class="crayon-h"> </span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">groups</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c974374702228-16"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'index'</span><span class="crayon-o">:</span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'value'</span><span class="crayon-o">:</span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'groups'</span><span class="crayon-o">:</span><span class="crayon-v">b_groups</span><span class="crayon-sy">}</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0014 seconds] -->
<p>Now that we know how a decision tree algorithm can be modified for use with the Random Forest algorithm, we can piece this together with an implementation of bagging and apply it to a real-world dataset.</p>
<h3>2. Sonar Dataset Case Study</h3>
<p>In this section, we will apply the Random Forest algorithm to the Sonar dataset.</p>
<p>The example assumes that a CSV copy of the dataset is in the current working directory with the file name <strong>sonar.all-data.csv</strong>.</p>
<p>The dataset is first loaded, the string values converted to numeric and the output column is converted from strings to the integer values of 0 and 1. This is achieved with helper functions <strong>load_csv()</strong>, <strong>str_column_to_float()</strong> and <strong>str_column_to_int()</strong> to load and prepare the dataset.</p>
<p>We will use k-fold cross validation to estimate the performance of the learned model on unseen data. This means that we will construct and evaluate k models and estimate the performance as the mean model error. Classification accuracy will be used to evaluate each model. These behaviors are provided in the <strong>cross_validation_split()</strong>, <strong>accuracy_metric()</strong> and <strong>evaluate_algorithm()</strong> helper functions.</p>
<p>We will also use an implementation of the Classification and Regression Trees (CART) algorithm adapted for bagging including the helper functions <strong>test_split()</strong> to split a dataset into groups, <strong>gini_index()</strong> to evaluate a split point, our modified <strong>get_split()</strong> function discussed in the previous step, <strong>to_terminal()</strong>, <strong>split()</strong> and <strong>build_tree()</strong> used to create a single decision tree, <strong>predict()</strong> to make a prediction with a decision tree, <strong>subsample()</strong> to make a subsample of the training dataset and <strong>bagging_predict()</strong> to make a prediction with a list of decision trees.</p>
<p>A new function name <strong>random_forest()</strong> is developed that first creates a list of decision trees from subsamples of the training dataset and then uses them to make predictions.</p>
<p>As we stated above, the key difference between Random Forest and bagged decision trees is the one small change to the way that trees are created, here in the <strong>get_split()</strong> function.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7180c979192636846" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Random Forest Algorithm on Sonar Dataset
from random import seed
from random import randrange
from csv import reader
from math import sqrt

# Load a CSV file
def load_csv(filename):
	dataset = list()
	with open(filename, 'r') as file:
		csv_reader = reader(file)
		for row in csv_reader:
			if not row:
				continue
			dataset.append(row)
	return dataset

# Convert string column to float
def str_column_to_float(dataset, column):
	for row in dataset:
		row[column] = float(row[column].strip())

# Convert string column to integer
def str_column_to_int(dataset, column):
	class_values = [row[column] for row in dataset]
	unique = set(class_values)
	lookup = dict()
	for i, value in enumerate(unique):
		lookup[value] = i
	for row in dataset:
		row[column] = lookup[row[column]]
	return lookup

# Split a dataset into k folds
def cross_validation_split(dataset, n_folds):
	dataset_split = list()
	dataset_copy = list(dataset)
	fold_size = int(len(dataset) / n_folds)
	for i in range(n_folds):
		fold = list()
		while len(fold) &lt; fold_size:
			index = randrange(len(dataset_copy))
			fold.append(dataset_copy.pop(index))
		dataset_split.append(fold)
	return dataset_split

# Calculate accuracy percentage
def accuracy_metric(actual, predicted):
	correct = 0
	for i in range(len(actual)):
		if actual[i] == predicted[i]:
			correct += 1
	return correct / float(len(actual)) * 100.0

# Evaluate an algorithm using a cross validation split
def evaluate_algorithm(dataset, algorithm, n_folds, *args):
	folds = cross_validation_split(dataset, n_folds)
	scores = list()
	for fold in folds:
		train_set = list(folds)
		train_set.remove(fold)
		train_set = sum(train_set, [])
		test_set = list()
		for row in fold:
			row_copy = list(row)
			test_set.append(row_copy)
			row_copy[-1] = None
		predicted = algorithm(train_set, test_set, *args)
		actual = [row[-1] for row in fold]
		accuracy = accuracy_metric(actual, predicted)
		scores.append(accuracy)
	return scores

# Split a dataset based on an attribute and an attribute value
def test_split(index, value, dataset):
	left, right = list(), list()
	for row in dataset:
		if row[index] &lt; value:
			left.append(row)
		else:
			right.append(row)
	return left, right

# Calculate the Gini index for a split dataset
def gini_index(groups, classes):
	# count all samples at split point
	n_instances = float(sum([len(group) for group in groups]))
	# sum weighted Gini index for each group
	gini = 0.0
	for group in groups:
		size = float(len(group))
		# avoid divide by zero
		if size == 0:
			continue
		score = 0.0
		# score the group based on the score for each class
		for class_val in classes:
			p = [row[-1] for row in group].count(class_val) / size
			score += p * p
		# weight the group score by its relative size
		gini += (1.0 - score) * (size / n_instances)
	return gini

# Select the best split point for a dataset
def get_split(dataset, n_features):
	class_values = list(set(row[-1] for row in dataset))
	b_index, b_value, b_score, b_groups = 999, 999, 999, None
	features = list()
	while len(features) &lt; n_features:
		index = randrange(len(dataset[0])-1)
		if index not in features:
			features.append(index)
	for index in features:
		for row in dataset:
			groups = test_split(index, row[index], dataset)
			gini = gini_index(groups, class_values)
			if gini &lt; b_score:
				b_index, b_value, b_score, b_groups = index, row[index], gini, groups
	return {'index':b_index, 'value':b_value, 'groups':b_groups}

# Create a terminal node value
def to_terminal(group):
	outcomes = [row[-1] for row in group]
	return max(set(outcomes), key=outcomes.count)

# Create child splits for a node or make terminal
def split(node, max_depth, min_size, n_features, depth):
	left, right = node['groups']
	del(node['groups'])
	# check for a no split
	if not left or not right:
		node['left'] = node['right'] = to_terminal(left + right)
		return
	# check for max depth
	if depth &gt;= max_depth:
		node['left'], node['right'] = to_terminal(left), to_terminal(right)
		return
	# process left child
	if len(left) &lt;= min_size:
		node['left'] = to_terminal(left)
	else:
		node['left'] = get_split(left, n_features)
		split(node['left'], max_depth, min_size, n_features, depth+1)
	# process right child
	if len(right) &lt;= min_size:
		node['right'] = to_terminal(right)
	else:
		node['right'] = get_split(right, n_features)
		split(node['right'], max_depth, min_size, n_features, depth+1)

# Build a decision tree
def build_tree(train, max_depth, min_size, n_features):
	root = get_split(train, n_features)
	split(root, max_depth, min_size, n_features, 1)
	return root

# Make a prediction with a decision tree
def predict(node, row):
	if row[node['index']] &lt; node['value']:
		if isinstance(node['left'], dict):
			return predict(node['left'], row)
		else:
			return node['left']
	else:
		if isinstance(node['right'], dict):
			return predict(node['right'], row)
		else:
			return node['right']

# Create a random subsample from the dataset with replacement
def subsample(dataset, ratio):
	sample = list()
	n_sample = round(len(dataset) * ratio)
	while len(sample) &lt; n_sample:
		index = randrange(len(dataset))
		sample.append(dataset[index])
	return sample

# Make a prediction with a list of bagged trees
def bagging_predict(trees, row):
	predictions = [predict(tree, row) for tree in trees]
	return max(set(predictions), key=predictions.count)

# Random Forest Algorithm
def random_forest(train, test, max_depth, min_size, sample_size, n_trees, n_features):
	trees = list()
	for i in range(n_trees):
		sample = subsample(train, sample_size)
		tree = build_tree(sample, max_depth, min_size, n_features)
		trees.append(tree)
	predictions = [bagging_predict(trees, row) for row in test]
	return(predictions)

# Test the random forest algorithm
seed(2)
# load and prepare data
filename = 'sonar.all-data.csv'
dataset = load_csv(filename)
# convert string attributes to integers
for i in range(0, len(dataset[0])-1):
	str_column_to_float(dataset, i)
# convert class column to integers
str_column_to_int(dataset, len(dataset[0])-1)
# evaluate algorithm
n_folds = 5
max_depth = 10
min_size = 1
sample_size = 1.0
n_features = int(sqrt(len(dataset[0])-1))
for n_trees in [1, 5, 10]:
	scores = evaluate_algorithm(dataset, random_forest, n_folds, max_depth, min_size, sample_size, n_trees, n_features)
	print('Trees: %d' % n_trees)
	print('Scores: %s' % scores)
	print('Mean Accuracy: %.3f%%' % (sum(scores)/float(len(scores))))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-6">6</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-8">8</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-10">10</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-12">12</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-14">14</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-16">16</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-18">18</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-20">20</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-22">22</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-24">24</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-26">26</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-28">28</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-30">30</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-32">32</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-34">34</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-36">36</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-38">38</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-40">40</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-42">42</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-44">44</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-46">46</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-48">48</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-50">50</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-52">52</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-54">54</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-56">56</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-58">58</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-60">60</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-62">62</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-64">64</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-66">66</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-68">68</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-70">70</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-72">72</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-74">74</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-76">76</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-78">78</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-80">80</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-82">82</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-84">84</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-86">86</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-88">88</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-90">90</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-92">92</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-94">94</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-96">96</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-98">98</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-100">100</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-102">102</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-104">104</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-106">106</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-108">108</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-110">110</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-112">112</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-114">114</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-116">116</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-118">118</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-120">120</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-122">122</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-124">124</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-126">126</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-128">128</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-130">130</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-132">132</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-134">134</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-136">136</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-138">138</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-140">140</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-142">142</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-144">144</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-145">145</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-146">146</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-147">147</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-148">148</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-149">149</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-150">150</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-151">151</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-152">152</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-153">153</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-154">154</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-155">155</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-156">156</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-157">157</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-158">158</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-159">159</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-160">160</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-161">161</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-162">162</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-163">163</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-164">164</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-165">165</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-166">166</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-167">167</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-168">168</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-169">169</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-170">170</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-171">171</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-172">172</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-173">173</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-174">174</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-175">175</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-176">176</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-177">177</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-178">178</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-179">179</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-180">180</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-181">181</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-182">182</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-183">183</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-184">184</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-185">185</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-186">186</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-187">187</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-188">188</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-189">189</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-190">190</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-191">191</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-192">192</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-193">193</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-194">194</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-195">195</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-196">196</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-197">197</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-198">198</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-199">199</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-200">200</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-201">201</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-202">202</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-203">203</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-204">204</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-205">205</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-206">206</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-207">207</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-208">208</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-209">209</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-210">210</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-211">211</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-212">212</div><div class="crayon-num" data-line="crayon-5c0ca7180c979192636846-213">213</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c979192636846-214">214</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7180c979192636846-1"><span class="crayon-p"># Random Forest Algorithm on Sonar Dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-2"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">seed</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-3"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randrange</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-4"><span class="crayon-e">from </span><span class="crayon-e">csv </span><span class="crayon-e">import </span><span class="crayon-e">reader</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-5"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-v">sqrt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-6"> </div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-7"><span class="crayon-p"># Load a CSV file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-8"><span class="crayon-e">def </span><span class="crayon-e">load_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-9"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-10"><span class="crayon-h"> </span><span class="crayon-e">with </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-11"><span class="crayon-h"> </span><span class="crayon-v">csv_reader</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">reader</span><span class="crayon-sy">(</span><span class="crayon-v">file</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-12"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">csv_reader</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-13"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-14"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-15"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-16"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-17"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-18"><span class="crayon-p"># Convert string column to float</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-19"><span class="crayon-e">def </span><span class="crayon-e">str_column_to_float</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">column</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-20"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-21"><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">strip</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-22"> </div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-23"><span class="crayon-p"># Convert string column to integer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-24"><span class="crayon-e">def </span><span class="crayon-e">str_column_to_int</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">column</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-25"><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-26"><span class="crayon-h"> </span><span class="crayon-v">unique</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">class_values</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-27"><span class="crayon-h"> </span><span class="crayon-v">lookup</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-28"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">value </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">unique</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-29"><span class="crayon-h"> </span><span class="crayon-v">lookup</span><span class="crayon-sy">[</span><span class="crayon-v">value</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">i</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-30"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-31"><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lookup</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-32"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">lookup</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-33"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-34"><span class="crayon-p"># Split a dataset into k folds</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-35"><span class="crayon-e">def </span><span class="crayon-e">cross_validation_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-36"><span class="crayon-h"> </span><span class="crayon-v">dataset_split</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-37"><span class="crayon-h"> </span><span class="crayon-v">dataset_copy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-38"><span class="crayon-h"> </span><span class="crayon-v">fold_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-39"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-40"><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-41"><span class="crayon-h"> </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">fold_size</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-42"><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset_copy</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-43"><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">dataset_copy</span><span class="crayon-sy">.</span><span class="crayon-e">pop</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-44"><span class="crayon-h"> </span><span class="crayon-v">dataset_split</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-45"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">dataset_split</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-46"> </div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-47"><span class="crayon-p"># Calculate accuracy percentage</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-48"><span class="crayon-e">def </span><span class="crayon-e">accuracy_metric</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-49"><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-50"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-51"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">actual</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-52"><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-53"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">100.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-54"> </div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-55"><span class="crayon-p"># Evaluate an algorithm using a cross validation split</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-56"><span class="crayon-e">def </span><span class="crayon-e">evaluate_algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">algorithm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">args</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-57"><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_validation_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-58"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-59"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">fold </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-60"><span class="crayon-h"> </span><span class="crayon-v">train_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">folds</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-61"><span class="crayon-h"> </span><span class="crayon-v">train_set</span><span class="crayon-sy">.</span><span class="crayon-e">remove</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-62"><span class="crayon-h"> </span><span class="crayon-v">train_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">train_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-63"><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-64"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-65"><span class="crayon-h"> </span><span class="crayon-v">row_copy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-66"><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row_copy</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-67"><span class="crayon-h"> </span><span class="crayon-v">row_copy</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-68"><span class="crayon-e"> </span><span class="crayon-v">predicted</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">train_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">args</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-69"><span class="crayon-h"> </span><span class="crayon-v">actual</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-70"><span class="crayon-h"> </span><span class="crayon-v">accuracy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">accuracy_metric</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-71"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">accuracy</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-72"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-73"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-74"><span class="crayon-p"># Split a dataset based on an attribute and an attribute value</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-75"><span class="crayon-e">def </span><span class="crayon-e">test_split</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-76"><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-77"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-78"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">value</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-79"><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-80"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-81"><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-82"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">right</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-83"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-84"><span class="crayon-p"># Calculate the Gini index for a split dataset</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-85"><span class="crayon-e">def </span><span class="crayon-e">gini_index</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">classes</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-86"><span class="crayon-h"> </span><span class="crayon-p"># count all samples at split point</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-87"><span class="crayon-h"> </span><span class="crayon-v">n_instances</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">group </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-88"><span class="crayon-h"> </span><span class="crayon-p"># sum weighted Gini index for each group</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-89"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-90"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">group </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-91"><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-92"><span class="crayon-h"> </span><span class="crayon-p"># avoid divide by zero</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-93"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-94"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-95"><span class="crayon-h"> </span><span class="crayon-v">score</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-96"><span class="crayon-h"> </span><span class="crayon-p"># score the group based on the score for each class</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-97"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">class_val </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">classes</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-98"><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">group</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">count</span><span class="crayon-sy">(</span><span class="crayon-v">class_val</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e">size</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-99"><span class="crayon-e"> </span><span class="crayon-v">score</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">p *</span><span class="crayon-h"> </span><span class="crayon-v">p</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-100"><span class="crayon-h"> </span><span class="crayon-p"># weight the group score by its relative size</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-101"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">score</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_instances</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-102"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">gini</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-103"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-104"><span class="crayon-p"># Select the best split point for a dataset</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-105"><span class="crayon-e">def </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-106"><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-107"><span class="crayon-h"> </span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">999</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-108"><span class="crayon-e"> </span><span class="crayon-v">features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-109"><span class="crayon-h"> </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">features</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-110"><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-111"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">index </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">features</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-112"><span class="crayon-h"> </span><span class="crayon-v">features</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-113"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">index </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">features</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-114"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-115"><span class="crayon-h"> </span><span class="crayon-v">groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">test_split</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-116"><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">gini_index</span><span class="crayon-sy">(</span><span class="crayon-v">groups</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-117"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-118"><span class="crayon-h"> </span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_groups</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gini</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">groups</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-119"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'index'</span><span class="crayon-o">:</span><span class="crayon-v">b_index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'value'</span><span class="crayon-o">:</span><span class="crayon-v">b_value</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'groups'</span><span class="crayon-o">:</span><span class="crayon-v">b_groups</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-120"> </div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-121"><span class="crayon-p"># Create a terminal node value</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-122"><span class="crayon-e">def </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">group</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-123"><span class="crayon-h"> </span><span class="crayon-v">outcomes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">group</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-124"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">outcomes</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-v">outcomes</span><span class="crayon-sy">.</span><span class="crayon-v">count</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-125"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-126"><span class="crayon-p"># Create child splits for a node or make terminal</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-127"><span class="crayon-e">def </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-128"><span class="crayon-h"> </span><span class="crayon-v">left</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'groups'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-129"><span class="crayon-h"> </span><span class="crayon-e">del</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'groups'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-130"><span class="crayon-h"> </span><span class="crayon-p"># check for a no split</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-131"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">left </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-132"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">right</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-133"><span class="crayon-h"> </span><span class="crayon-st">return</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-134"><span class="crayon-h"> </span><span class="crayon-p"># check for max depth</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-135"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-136"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-137"><span class="crayon-h"> </span><span class="crayon-st">return</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-138"><span class="crayon-h"> </span><span class="crayon-p"># process left child</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-139"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-140"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-141"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-142"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">left</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-143"><span class="crayon-h"> </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-144"><span class="crayon-h"> </span><span class="crayon-p"># process right child</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-145"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-146"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_terminal</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-147"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-148"><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">right</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-149"><span class="crayon-h"> </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">depth</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-150"> </div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-151"><span class="crayon-p"># Build a decision tree</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-152"><span class="crayon-e">def </span><span class="crayon-e">build_tree</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-153"><span class="crayon-h"> </span><span class="crayon-v">root</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_split</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-154"><span class="crayon-h"> </span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-v">root</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-155"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">root</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-156"> </div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-157"><span class="crayon-p"># Make a prediction with a decision tree</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-158"><span class="crayon-e">def </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-159"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'index'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'value'</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-160"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">isinstance</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dict</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-161"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-162"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-163"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'left'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-164"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-165"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">isinstance</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dict</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-166"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-167"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-168"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">[</span><span class="crayon-s">'right'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-169"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-170"><span class="crayon-p"># Create a random subsample from the dataset with replacement</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-171"><span class="crayon-e">def </span><span class="crayon-e">subsample</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ratio</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-172"><span class="crayon-h"> </span><span class="crayon-v">sample</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-173"><span class="crayon-h"> </span><span class="crayon-v">n_sample</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">round</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">ratio</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-174"><span class="crayon-h"> </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sample</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">n_sample</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-175"><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-176"><span class="crayon-h"> </span><span class="crayon-v">sample</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-177"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">sample</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-178"> </div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-179"><span class="crayon-p"># Make a prediction with a list of bagged trees</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-180"><span class="crayon-e">def </span><span class="crayon-e">bagging_predict</span><span class="crayon-sy">(</span><span class="crayon-v">trees</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-181"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">tree</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">tree </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">trees</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-182"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-v">count</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-183"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-184"><span class="crayon-p"># Random Forest Algorithm</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-185"><span class="crayon-e">def </span><span class="crayon-e">random_forest</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sample_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_trees</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-186"><span class="crayon-h"> </span><span class="crayon-v">trees</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-187"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-188"><span class="crayon-h"> </span><span class="crayon-v">sample</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">subsample</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sample_size</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-189"><span class="crayon-h"> </span><span class="crayon-v">tree</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">build_tree</span><span class="crayon-sy">(</span><span class="crayon-v">sample</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-190"><span class="crayon-h"> </span><span class="crayon-v">trees</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">tree</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-191"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">bagging_predict</span><span class="crayon-sy">(</span><span class="crayon-v">trees</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-192"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-193"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-194"><span class="crayon-p"># Test the random forest algorithm</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-195"><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-196"><span class="crayon-p"># load and prepare data</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-197"><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'sonar.all-data.csv'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-198"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-199"><span class="crayon-p"># convert string attributes to integers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-200"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-201"><span class="crayon-h"> </span><span class="crayon-e">str_column_to_float</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-202"><span class="crayon-p"># convert class column to integers</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-203"><span class="crayon-e">str_column_to_int</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-204"><span class="crayon-p"># evaluate algorithm</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-205"><span class="crayon-v">n_folds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-206"><span class="crayon-v">max_depth</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-207"><span class="crayon-v">min_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-208"><span class="crayon-v">sample_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-209"><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-210"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">n_trees </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-211"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_forest</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_depth</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sample_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_trees</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-212"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Trees: %d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">n_trees</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7180c979192636846-213"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Scores: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c979192636846-214"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Mean Accuracy: %.3f%%'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0119 seconds] -->
<p>A k value of 5 was used for cross-validation, giving each fold 208/5 = 41.6 or just over 40 records to be evaluated upon each iteration.</p>
<p>Deep trees were constructed with a max depth of 10 and a minimum number of training rows at each node of 1. Samples of the training dataset were created with the same size as the original dataset, which is a default expectation for the Random Forest algorithm.</p>
<p>The number of features considered at each split point was set to sqrt(num_features) or sqrt(60)=7.74 rounded to 7 features.</p>
<p>A suite of 3 different numbers of trees were evaluated for comparison, showing the increasing skill as more trees are added.</p>
<p>Running the example prints the scores for each fold and mean score for each configuration.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7180c97d581333302" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Trees: 1
Scores: [56.09756097560976, 63.41463414634146, 60.97560975609756, 58.536585365853654, 73.17073170731707]
Mean Accuracy: 62.439%

Trees: 5
Scores: [70.73170731707317, 58.536585365853654, 85.36585365853658, 75.60975609756098, 63.41463414634146]
Mean Accuracy: 70.732%

Trees: 10
Scores: [75.60975609756098, 80.48780487804879, 92.6829268292683, 73.17073170731707, 70.73170731707317]
Mean Accuracy: 78.537%</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7180c97d581333302-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c97d581333302-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7180c97d581333302-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c97d581333302-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7180c97d581333302-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c97d581333302-6">6</div><div class="crayon-num" data-line="crayon-5c0ca7180c97d581333302-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c97d581333302-8">8</div><div class="crayon-num" data-line="crayon-5c0ca7180c97d581333302-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7180c97d581333302-10">10</div><div class="crayon-num" data-line="crayon-5c0ca7180c97d581333302-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7180c97d581333302-1">Trees: 1</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c97d581333302-2">Scores: [56.09756097560976, 63.41463414634146, 60.97560975609756, 58.536585365853654, 73.17073170731707]</div><div class="crayon-line" id="crayon-5c0ca7180c97d581333302-3">Mean Accuracy: 62.439%</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c97d581333302-4"> </div><div class="crayon-line" id="crayon-5c0ca7180c97d581333302-5">Trees: 5</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c97d581333302-6">Scores: [70.73170731707317, 58.536585365853654, 85.36585365853658, 75.60975609756098, 63.41463414634146]</div><div class="crayon-line" id="crayon-5c0ca7180c97d581333302-7">Mean Accuracy: 70.732%</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c97d581333302-8"> </div><div class="crayon-line" id="crayon-5c0ca7180c97d581333302-9">Trees: 10</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7180c97d581333302-10">Scores: [75.60975609756098, 80.48780487804879, 92.6829268292683, 73.17073170731707, 70.73170731707317]</div><div class="crayon-line" id="crayon-5c0ca7180c97d581333302-11">Mean Accuracy: 78.537%</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Extensions</h2>
<p>This section lists extensions to this tutorial that you may be interested in exploring.</p>
<ul>
<li><strong>Algorithm Tuning</strong>. The configuration used in the tutorial was found with a little trial and error but was not optimized. Experiment with larger numbers of trees, different numbers of features and even different tree configurations to improve performance.</li>
<li><strong>More Problems</strong>. Apply the technique to other classification problems and even adapt it for regression with a new cost function and a new method for combining the predictions from trees.</li>
</ul>
<p style="text-align: center;"><strong>Did you try any of these extensions?</strong><br/>
Share your experiences in the comments below.</p>
<h2>Review</h2>
<p>In this tutorial, you discovered how to implement the Random Forest algorithm from scratch.</p>
<p>Specifically, you learned:</p>
<ul>
<li>The difference between Random Forest and Bagged Decision Trees.</li>
<li>How to update the creation of decision trees to accommodate the Random Forest procedure.</li>
<li>How to apply the Random Forest algorithm to a real world predictive modeling problem.</li>
</ul>
<p style="text-align: center;"><strong>Do you have any questions?</strong><br/>
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="awac-wrapper"><div class="awac widget text-37"> <div class="textwidget"><p></p><div class="woo-sc-hr"></div><br/>
<center>
<h2 style="text-align: center;">Want to Code Algorithms in Python Without Math?</h2>
<p><a href="/machine-learning-algorithms-from-scratch/"><img align="left" alt="Machine Learning Algorithms From Scratch" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningAlgorithmsFromScratch-220.png" style="border: 0;"/></a></p>
<h4>Code Your First Algorithm in Minutes</h4>
<p style="text-align: center;">…with step-by-step tutorials on real-world datasets</p>
<p style="text-align: center;">Discover how in my new Ebook:<br/>
<a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Machine Learning Algorithms From Scratch</a></p>
<p style="text-align: center;">It covers <strong>18 tutorials</strong> with all the code for <strong>12 top algorithms</strong>, like:<br/>Linear Regression, k-Nearest Neighbors, Stochastic Gradient Descent and much more…</p>
<h4>Finally, Pull Back the Curtain on <br/>Machine Learning Algorithms</h4>
<p style="text-align: center;">Skip the Academics. Just Results.</p>
<p style="text-align: center;"><a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Click to learn more</a>.</p>
<p></p></center><br/>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-3360 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Implement+Random+Forest+From+Scratch+in+Python&amp;url=https://machinelearningmastery.com/implement-random-forest-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-random-forest-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/implement-random-forest-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/implement-random-forest-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
</section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/implement-bagging-scratch-python/" rel="prev"><i class="fa fa-angle-left"></i> How to Implement Bagging From Scratch With Python</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/implementing-stacking-scratch-python/" rel="next">How to Implement Stacked Generalization (Stacking) From Scratch With Python <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">82 Responses to <em>How to Implement Random Forest From Scratch in Python</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-373493">
<div class="comment-container" id="li-comment-373493">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/02f3d6d8d9076f4482fed2fed70c1b93?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/02f3d6d8d9076f4482fed2fed70c1b93?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Marco</span>
<span class="date">December 3, 2016 at 7:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-373493" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Firstly, thanks for your work on this site – I’m finding it to be a great resource to start my exploration in python machine learning!</p>
<p>Now, I’m working through your python machine learning mini course and I’m up to Lesson 09: spot checking algorithms. You suggest testing the random forest which has lead me to this blog post where I’m tyring to run the recipe but get thrown the following:</p>
<p>Traceback (most recent call last):<br/>
  File “test.py”, line 203, in<br/>
    scores = evaluate_algorithm(dataset, random_forest, n_folds, max_depth, min_size, sample_size, n_trees, n_features)<br/>
  File “test.py”, line 57, in evaluate_algorithm<br/>
    folds = cross_validation_split(dataset, n_folds)<br/>
  File “test.py”, line 42, in cross_validation_split<br/>
    index = randrange(len(dataset_copy))<br/>
  File “//anaconda/lib/python3.5/random.py”, line 186, in randrange<br/>
    raise ValueError(“empty range for randrange()”)<br/>
ValueError: empty range for randrange()</p>
<p>I’ve spent the better part of the last hour trying to work out what I may be doing wrong.. unfortunately I’m really new to coding so I’m finding it very difficult. I think i’ve narrowed to the following possibilities:<br/>
1. possibly a problem with the evaluate_algorithm function that has been defined..?<br/>
2. possibly an issue using randrange in python 3.5.2?<br/>
3. possibly a problem with the definition of “dataset”? </p>
<p>I think it’s either #1 because I can run the code without issue up until line 202 or #3 because dataset is the common thread in each of the returned lines from the error..?</p>
<p>Your guidance would be greatly appreciated!</p>
<p>thanks again!<br/>
marco</p>
<div class="reply">
<a aria-label="Reply to Marco" class="comment-reply-link" href="#comment-373493" onclick='return addComment.moveForm( "comment-373493", "373493", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-401392">
<div class="comment-container" id="li-comment-401392">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/06f2e5e0de675fdc19a095f4a1f0e1f7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/06f2e5e0de675fdc19a095f4a1f0e1f7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Dionysis</span>
<span class="date">June 4, 2017 at 4:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-401392" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>Is it simple to adapt this implementation in order to accommodate tuples of feature vectors?</p>
<p>Thanks,<br/>
D.</p>
<div class="reply">
<a aria-label="Reply to Dionysis" class="comment-reply-link" href="#comment-401392" onclick='return addComment.moveForm( "comment-401392", "401392", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-407618">
<div class="comment-container" id="li-comment-407618">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dfdf521b847f579a655b30c1e7e15133?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dfdf521b847f579a655b30c1e7e15133?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.bayesniffer.com" rel="external nofollow">Jeffrey Grover</a></span>
<span class="date">July 28, 2017 at 8:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-407618" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, I was able to get the code to run and got the results as posted on this page. My question what next? How do you use these results to make classification on new data?</p>
<p>Thanks Jeff</p>
<div class="reply">
<a aria-label="Reply to Jeffrey Grover" class="comment-reply-link" href="#comment-407618" onclick='return addComment.moveForm( "comment-407618", "407618", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-407633">
<div class="comment-container" id="li-comment-407633">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 28, 2017 at 8:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-407633" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can fit a final model on all training data and start making predictions.</p>
<p>See this post about developing a final model:<br/>
<a href="http://machinelearningmastery.com/train-final-machine-learning-model/" rel="nofollow">http://machinelearningmastery.com/train-final-machine-learning-model/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-407633" onclick='return addComment.moveForm( "comment-407633", "407633", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-373744">
<div class="comment-container" id="li-comment-373744">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/02f3d6d8d9076f4482fed2fed70c1b93?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/02f3d6d8d9076f4482fed2fed70c1b93?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Marco</span>
<span class="date">December 4, 2016 at 10:09 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-373744" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Figured it out! It was a problem with using Python 3.5.2. I switched to 2.7 and it worked!</p>
<p>thanks<br/>
marco</p>
<div class="reply">
<a aria-label="Reply to Marco" class="comment-reply-link" href="#comment-373744" onclick='return addComment.moveForm( "comment-373744", "373744", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-373805">
<div class="comment-container" id="li-comment-373805">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 5, 2016 at 6:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-373805" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear it Marco.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-373805" onclick='return addComment.moveForm( "comment-373805", "373805", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-374379">
<div class="comment-container" id="li-comment-374379">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/83d4fc6176762f49407effa7e5164e8b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/83d4fc6176762f49407effa7e5164e8b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">srikanth</span>
<span class="date">December 8, 2016 at 9:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-374379" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Traceback (most recent call last):<br/>
  File “rf2.py”, line 203, in<br/>
    scores = evaluate_algorithm(dataset, random_forest, n_folds, max_depth, min_size, sample_size, n_trees, n_features)<br/>
  File “rf2.py”, line 68, in evaluate_algorithm<br/>
    predicted = algorithm(train_set, test_set, *args)<br/>
  File “rf2.py”, line 181, in random_forest<br/>
    tree = build_tree(sample, max_depth, min_size, n_features)<br/>
  File “rf2.py”, line 146, in build_tree<br/>
    split(root, max_depth, min_size, n_features, 1)<br/>
  File “rf2.py”, line 120, in split<br/>
    left, right = node[‘groups’]<br/>
TypeError: ‘NoneType’ object is not iterable</p>
<div class="reply">
<a aria-label="Reply to srikanth" class="comment-reply-link" href="#comment-374379" onclick='return addComment.moveForm( "comment-374379", "374379", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-376572">
<div class="comment-container" id="li-comment-376572">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/074409150dd878a13833f9d727d237cb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/074409150dd878a13833f9d727d237cb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">beedotkiran</span>
<span class="date">December 21, 2016 at 7:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-376572" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Works in python 3.x also. The division in line 45 :<br/>
fold_size = len(dataset) / n_folds<br/>
renders a float which remains valid when length of dataset_copy goes to zero. randrange(0) gives this error.</p>
<p>Replacing this line with<br/>
fold_size = len(dataset) // n_folds<br/>
gives an integer and the loop executes properly</p>
<div class="reply">
<a aria-label="Reply to beedotkiran" class="comment-reply-link" href="#comment-376572" onclick='return addComment.moveForm( "comment-376572", "376572", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-376594">
<div class="comment-container" id="li-comment-376594">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 21, 2016 at 8:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-376594" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks beedotkiran.</p>
<p>I’d recommend casting the result, in case python beginners are not familiar with the double slash operator:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7180e990629152592" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
fold_size = int(len(dataset) / n_folds)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7180e990629152592-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7180e990629152592-1"><span class="crayon-v">fold_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-376594" onclick='return addComment.moveForm( "comment-376594", "376594", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-379659">
<div class="comment-container" id="li-comment-379659">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 3, 2017 at 9:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-379659" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have updated the cross_validation_split() function in the above example to address issues with Python 3.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-379659" onclick='return addComment.moveForm( "comment-379659", "379659", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-384702">
<div class="comment-container" id="li-comment-384702">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2dc60e46884298b2d45d667f6f8aac9d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2dc60e46884298b2d45d667f6f8aac9d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jake Rage</span>
<span class="date">January 28, 2017 at 1:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-384702" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This was a fantastic tutorial thanks you for taking the time to do this! I was wondering if you had any suggestions for serialization or the tree for use against other similar data sets, would pickling working for this structure? Thanks for you help!</p>
<div class="reply">
<a aria-label="Reply to Jake Rage" class="comment-reply-link" href="#comment-384702" onclick='return addComment.moveForm( "comment-384702", "384702", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-385379">
<div class="comment-container" id="li-comment-385379">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 1, 2017 at 10:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-385379" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jake, using pickle on the learned object would be a good starting point.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-385379" onclick='return addComment.moveForm( "comment-385379", "385379", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-389937">
<div class="comment-container" id="li-comment-389937">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9c1300e7f23b39406f14316f3f9e06b3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9c1300e7f23b39406f14316f3f9e06b3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alessandro</span>
<span class="date">February 25, 2017 at 12:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-389937" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, great tutorial! Just a question about the function build_tree: when you evaluate the root of the tree, shouldn’t you use the train sample and not the whole dataset? </p>
<p>I mean:</p>
<p>root = get_split(train, n_features) rather than<br/>
root = get_split(dataset, n_features)</p>
<p>Can I ask also what are the main differences of this algorithm if you want adapt it to a regression problem rather than classification?</p>
<p>Thank you very much! Best regards</p>
<div class="reply">
<a aria-label="Reply to Alessandro" class="comment-reply-link" href="#comment-389937" onclick='return addComment.moveForm( "comment-389937", "389937", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-389938">
<div class="comment-container" id="li-comment-389938">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9c1300e7f23b39406f14316f3f9e06b3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9c1300e7f23b39406f14316f3f9e06b3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alessandro</span>
<span class="date">February 25, 2017 at 12:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-389938" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry I didn’t see that you had already settled the change</p>
<div class="reply">
<a aria-label="Reply to Alessandro" class="comment-reply-link" href="#comment-389938" onclick='return addComment.moveForm( "comment-389938", "389938", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-3" id="comment-389974">
<div class="comment-container" id="li-comment-389974">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 25, 2017 at 5:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-389974" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No problem, nice catch!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-389974" onclick='return addComment.moveForm( "comment-389974", "389974", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-396010">
<div class="comment-container" id="li-comment-396010">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5f694b8d13164042cb82fc171da8b279?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5f694b8d13164042cb82fc171da8b279?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mike</span>
<span class="date">April 11, 2017 at 1:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-396010" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason  great approach. I’m wondering if you have any tips about transforming the above code in order to support multi-label classification.<br/>
Thank you very much !!!</p>
<div class="reply">
<a aria-label="Reply to Mike" class="comment-reply-link" href="#comment-396010" onclick='return addComment.moveForm( "comment-396010", "396010", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-396044">
<div class="comment-container" id="li-comment-396044">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 11, 2017 at 9:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-396044" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not off hand, sorry Mike. I would have to do some homework.</p>
<p>Consider a search on google scholar or consider some multi-label methods in sklearn:<br/>
<a href="http://scikit-learn.org/stable/modules/multiclass.html#multilabel-classification-format" rel="nofollow">http://scikit-learn.org/stable/modules/multiclass.html#multilabel-classification-format</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-396044" onclick='return addComment.moveForm( "comment-396044", "396044", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-398416">
<div class="comment-container" id="li-comment-398416">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/05b9e51769ab76adda97e521e2f8dbf8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/05b9e51769ab76adda97e521e2f8dbf8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Steve</span>
<span class="date">May 3, 2017 at 4:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-398416" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason, I like the approach that allows a person to ‘look under the hood’ of these machine learning methods.  I look forward to learning more of the machine learning methods this way.  </p>
<p>Random forest is completely new to me.  I have a dataset that could use random forest regression.  I would like to know what changes are needed to make random forest classification code (above) into random forest regression.  This was asked earlier by Alessandro but I didn’t understand the reply.  Random forest regression is not explained well as far as I can tell.  </p>
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Steve" class="comment-reply-link" href="#comment-398416" onclick='return addComment.moveForm( "comment-398416", "398416", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-398488">
<div class="comment-container" id="li-comment-398488">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 4, 2017 at 8:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-398488" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Steve.</p>
<p>As a start, consider using random forest regression in the sklearn library:<br/>
<a href="http://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/" rel="nofollow">http://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-398488" onclick='return addComment.moveForm( "comment-398488", "398488", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-401962">
<div class="comment-container" id="li-comment-401962">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/05b9e51769ab76adda97e521e2f8dbf8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/05b9e51769ab76adda97e521e2f8dbf8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Steve Hansen</span>
<span class="date">June 9, 2017 at 10:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-401962" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, </p>
<p>    Thanks for the advice with random forest regression.  </p>
<p>    On the sonar dataset, I plotted a 60 x 60 correlation matrix from the data.  Many of the successive rows, and even not so close rows, are highly correlated. For instance, row 17 and column 18 have the following correlation: </p>
<p>Number of Observations:              131<br/>
Number of Degrees of Freedom:   2</p>
<p>R-squared:           0.870<br/>
Rmse:                  0.1046<br/>
F statistic             863.</p>
<p>and columns 14 and 15 have the correlation </p>
<p>Number of Observations:         131<br/>
Number of Degrees of Freedom:   2</p>
<p>R-squared:          0.8554<br/>
Rmse:                 0.0708<br/>
F statistic            763. </p>
<p>What impact does this correlation have on the use of random forest?  What can be done to remove or measure the effect of the correlation?  </p>
<p>Also, for this dataset I was able to get the following results:  </p>
<p>n_folds = 5<br/>
max_depth = 12<br/>
min_size = 1<br/>
sample_size = 0.75<br/>
for n_trees in [1, 5, 19]: </p>
<p> 71.875%,  73.438%,  82.031%</p>
<p>Thanks for the great work.  I am trying to absorb it all.</p>
<div class="reply">
<a aria-label="Reply to Steve Hansen" class="comment-reply-link" href="#comment-401962" onclick='return addComment.moveForm( "comment-401962", "401962", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-402065">
<div class="comment-container" id="li-comment-402065">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 10, 2017 at 8:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-402065" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice results.</p>
<p>I don’t think RF is too affected by highly corrected features. Nevertheless, try removing some and see how it impacts model skill. I’d love to hear what you discover.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-402065" onclick='return addComment.moveForm( "comment-402065", "402065", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-427956">
<div class="comment-container" id="li-comment-427956">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/18f971bc4dce505219f5b2388ae27ffe?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/18f971bc4dce505219f5b2388ae27ffe?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">dhrumil</span>
<span class="date">January 30, 2018 at 7:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-427956" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>how did you find correlation and why would it create a problem.I am kinda new to this so I would like to know these things from experts like you.Thank you.</p>
<div class="reply">
<a aria-label="Reply to dhrumil" class="comment-reply-link" href="#comment-427956" onclick='return addComment.moveForm( "comment-427956", "427956", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-402787">
<div class="comment-container" id="li-comment-402787">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/18f971bc4dce505219f5b2388ae27ffe?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/18f971bc4dce505219f5b2388ae27ffe?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">danniel</span>
<span class="date">June 17, 2017 at 12:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-402787" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,thanks for awesome tutorial,can you please explain following things&gt;<br/>
1.what is function of this line : row_copy[-1] = None : because it works perfectly without this line<br/>
2.When i tried n_trees=[3,5,10] it  returned following result in which accuracy decreases with more trees&gt;<br/>
Trees: 3<br/>
Scores: [63.41463414634146, 51.21951219512195, 68.29268292682927, 68.29268292682927, 63.41463414634146]<br/>
Mean Accuracy: 62.927%<br/>
Trees: 5<br/>
Scores: [65.85365853658537, 60.97560975609756, 60.97560975609756, 60.97560975609756, 58.536585365853654]<br/>
Mean Accuracy: 61.463%<br/>
Trees: 10<br/>
Scores: [48.78048780487805, 60.97560975609756, 58.536585365853654, 70.73170731707317, 53.65853658536586]<br/>
Mean Accuracy: 58.537%</p>
<div class="reply">
<a aria-label="Reply to danniel" class="comment-reply-link" href="#comment-402787" onclick='return addComment.moveForm( "comment-402787", "402787", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-402841">
<div class="comment-container" id="li-comment-402841">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 17, 2017 at 7:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-402841" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>1. To clear the output value so the algorithm/developer cannot accidentally cheat.<br/>
2. Yes, it is important to tune an algorithm to a problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-402841" onclick='return addComment.moveForm( "comment-402841", "402841", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-402900">
<div class="comment-container" id="li-comment-402900">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/18f971bc4dce505219f5b2388ae27ffe?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/18f971bc4dce505219f5b2388ae27ffe?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Danniel</span>
<span class="date">June 17, 2017 at 9:39 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-402900" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Would you like to help me?I am a student and I am using this for a problem that I found online &gt;<a href="https://github.com/barotdhrumil21/road_sign_prediction_using_random_forest_classifier/tree/master" rel="nofollow">https://github.com/barotdhrumil21/road_sign_prediction_using_random_forest_classifier/tree/master</a></p>
<div class="reply">
<a aria-label="Reply to Danniel" class="comment-reply-link" href="#comment-402900" onclick='return addComment.moveForm( "comment-402900", "402900", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-402939">
<div class="comment-container" id="li-comment-402939">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 18, 2017 at 6:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-402939" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend contacting the author of that code.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-402939" onclick='return addComment.moveForm( "comment-402939", "402939", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-402912">
<div class="comment-container" id="li-comment-402912">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/18f971bc4dce505219f5b2388ae27ffe?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/18f971bc4dce505219f5b2388ae27ffe?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">danniel</span>
<span class="date">June 18, 2017 at 12:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-402912" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>how do you suggest I should use this :<a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/learn/random_forest_mnist.py" rel="nofollow">https://github.com/tensorflow/tensorflow/blob/master/tensorflow/examples/learn/random_forest_mnist.py</a><br/>
or can I use it and is it same what you’ve done?</p>
<div class="reply">
<a aria-label="Reply to danniel" class="comment-reply-link" href="#comment-402912" onclick='return addComment.moveForm( "comment-402912", "402912", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-402943">
<div class="comment-container" id="li-comment-402943">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 18, 2017 at 6:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-402943" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Use whatever code you like.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-402943" onclick='return addComment.moveForm( "comment-402943", "402943", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-403063">
<div class="comment-container" id="li-comment-403063">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d08dfcd489b53fc2a5efec5ec42ec924?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d08dfcd489b53fc2a5efec5ec42ec924?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">chris</span>
<span class="date">June 19, 2017 at 7:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-403063" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>nice job! what kind of cost function should i use when doing regression problems?</p>
<div class="reply">
<a aria-label="Reply to chris" class="comment-reply-link" href="#comment-403063" onclick='return addComment.moveForm( "comment-403063", "403063", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-403122">
<div class="comment-container" id="li-comment-403122">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 20, 2017 at 6:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-403122" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question, consider mean squared error or mean absolute error.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-403122" onclick='return addComment.moveForm( "comment-403122", "403122", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-403076">
<div class="comment-container" id="li-comment-403076">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ea972a81d67c37285925d19836e9ad8f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ea972a81d67c37285925d19836e9ad8f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">joe</span>
<span class="date">June 20, 2017 at 12:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-403076" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>test_split has return two values but here groups = test_split(index, row[index], dataset) just one variable, can anyone explain that, please, thanks a lot</p>
<div class="reply">
<a aria-label="Reply to joe" class="comment-reply-link" href="#comment-403076" onclick='return addComment.moveForm( "comment-403076", "403076", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-403126">
<div class="comment-container" id="li-comment-403126">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 20, 2017 at 6:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-403126" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The returned array is assigned a variable named groups.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-403126" onclick='return addComment.moveForm( "comment-403126", "403126", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-404930">
<div class="comment-container" id="li-comment-404930">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f90ab8fc9665e1f3e97171454d0f9f26?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f90ab8fc9665e1f3e97171454d0f9f26?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chiky</span>
<span class="date">July 6, 2017 at 5:13 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-404930" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I am trying to learn RF through your sample example. But while running the code I am getting an error. I am using Ipython Notebook. </p>
<p> in split(node, max_depth, min_size, n_features, depth)<br/>
      6 # Create child splits for a node or make terminal<br/>
      7 def split(node, max_depth, min_size, n_features, depth):<br/>
—-&gt; 8         left, right = node[‘groups’]<br/>
      9         del(node[‘groups’])<br/>
     10         # check for a no split</p>
<p>TypeError: ‘NoneType’ object is not iterable</p>
<p>Please help.</p>
<div class="reply">
<a aria-label="Reply to Chiky" class="comment-reply-link" href="#comment-404930" onclick='return addComment.moveForm( "comment-404930", "404930", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-404932">
<div class="comment-container" id="li-comment-404932">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f90ab8fc9665e1f3e97171454d0f9f26?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f90ab8fc9665e1f3e97171454d0f9f26?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chiky</span>
<span class="date">July 6, 2017 at 5:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-404932" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The chain error list:</p>
<p>TypeError                                 Traceback (most recent call last)<br/>
 in ()<br/>
     16 n_features = int(sqrt(len(dataset[0])-1))<br/>
     17 for n_trees in [1, 5, 10]:<br/>
—&gt; 18         scores = evaluate_algorithm(dataset, random_forest, n_folds, max_depth, min_size, sample_size, n_trees, n_features)<br/>
     19         print(‘Trees: %d’ % n_trees)<br/>
     20         print(‘Scores: %s’ % scores)</p>
<p> in evaluate_algorithm(dataset, algorithm, n_folds, *args)<br/>
     12                         test_set.append(row_copy)<br/>
     13                         row_copy[-1] = None<br/>
—&gt; 14                 predicted = algorithm(train_set, test_set, *args)<br/>
     15                 actual = [row[-1] for row in fold]<br/>
     16                 accuracy = accuracy_metric(actual, predicted)</p>
<p> in random_forest(train, test, max_depth, min_size, sample_size, n_trees, n_features)<br/>
     18         for i in range(n_trees):<br/>
     19                 sample = subsample(train, sample_size)<br/>
—&gt; 20                 tree = build_tree(sample, max_depth, min_size, n_features)<br/>
     21                 trees.append(tree)<br/>
     22         predictions = [bagging_predict(trees, row) for row in test]</p>
<p> in build_tree(train, max_depth, min_size, n_features)<br/>
      2 def build_tree(train, max_depth, min_size, n_features):<br/>
      3         root = get_split(train, n_features)<br/>
—-&gt; 4         split(root, max_depth, min_size, n_features, 1)<br/>
      5         return root<br/>
      6 </p>
<p> in split(node, max_depth, min_size, n_features, depth)<br/>
      6 # Create child splits for a node or make terminal<br/>
      7 def split(node, max_depth, min_size, n_features, depth):<br/>
—-&gt; 8         left, right = node[‘groups’]<br/>
      9         del(node[‘groups’])<br/>
     10         # check for a no split</p>
<p>TypeError: ‘NoneType’ object is not iterable</p>
<div class="reply">
<a aria-label="Reply to Chiky" class="comment-reply-link" href="#comment-404932" onclick='return addComment.moveForm( "comment-404932", "404932", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-405223">
<div class="comment-container" id="li-comment-405223">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 9, 2017 at 10:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-405223" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t use notebooks. Confirm Python version 2.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-405223" onclick='return addComment.moveForm( "comment-405223", "405223", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-405790">
<div class="comment-container" id="li-comment-405790">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f9edfc296710adc888cdadf05e04f817?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f9edfc296710adc888cdadf05e04f817?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Danny Shterman</span>
<span class="date">July 13, 2017 at 11:53 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-405790" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Shouldn’t dataset be sorted by a feature before calculating gini?</p>
<div class="reply">
<a aria-label="Reply to Danny Shterman" class="comment-reply-link" href="#comment-405790" onclick='return addComment.moveForm( "comment-405790", "405790", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-405865">
<div class="comment-container" id="li-comment-405865">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cf0e13dcede2713259247b35592c01d7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cf0e13dcede2713259247b35592c01d7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tatiana</span>
<span class="date">July 14, 2017 at 9:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-405865" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, Jason<br/>
Thank you very much for your lessons. You code worked perfectly.<br/>
Now I am trying to use different dataset, which has also string values. And having difficulty with it. Is it even possible? I keep getting errors that cannot convert string to integer.</p>
<div class="reply">
<a aria-label="Reply to Tatiana" class="comment-reply-link" href="#comment-405865" onclick='return addComment.moveForm( "comment-405865", "405865", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-405989">
<div class="comment-container" id="li-comment-405989">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 15, 2017 at 9:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-405989" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<p>You must convert the strings to integers or real values. Perhaps you need to use a one hot encoding?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-405989" onclick='return addComment.moveForm( "comment-405989", "405989", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-406216">
<div class="comment-container" id="li-comment-406216">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f9edfc296710adc888cdadf05e04f817?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f9edfc296710adc888cdadf05e04f817?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Danny</span>
<span class="date">July 17, 2017 at 5:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-406216" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
is there a need to perform a sum of the the weighted gini indexes for each split?<br/>
Thanks<br/>
Danny</p>
<div class="reply">
<a aria-label="Reply to Danny" class="comment-reply-link" href="#comment-406216" onclick='return addComment.moveForm( "comment-406216", "406216", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-407727">
<div class="comment-container" id="li-comment-407727">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dfdf521b847f579a655b30c1e7e15133?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dfdf521b847f579a655b30c1e7e15133?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.bayesniffer.com" rel="external nofollow">Jeffrey Grover</a></span>
<span class="date">July 29, 2017 at 6:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-407727" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, I have posted this protocol on YouTube as a reference @ <a href="https://youtu.be/Appc0Hpnado" rel="nofollow">https://youtu.be/Appc0Hpnado</a></p>
<p>Thanks for taking the time to teach us this method!</p>
<p>Jeff</p>
<div class="reply">
<a aria-label="Reply to Jeffrey Grover" class="comment-reply-link" href="#comment-407727" onclick='return addComment.moveForm( "comment-407727", "407727", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-407760">
<div class="comment-container" id="li-comment-407760">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 29, 2017 at 8:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-407760" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice one Jeffrey!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-407760" onclick='return addComment.moveForm( "comment-407760", "407760", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-411892">
<div class="comment-container" id="li-comment-411892">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/19ccc80306b2244a52f51c58c81ccf7c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/19ccc80306b2244a52f51c58c81ccf7c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Wells</span>
<span class="date">August 31, 2017 at 2:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-411892" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, your implementation helps me a lot! However, I have a question here: on each split, the algorithm randomly selects a subset of features from the total features and then pick the best feature with the best gini score. Then, is it possible for a tree that a single feature is used repeatedly during different splits? since in get_split(), the line index = randrange(len(dataset[0])-1) basically pick features from the whole pool. Could you explain this? Thanks!</p>
<div class="reply">
<a aria-label="Reply to Wells" class="comment-reply-link" href="#comment-411892" onclick='return addComment.moveForm( "comment-411892", "411892", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-411987">
<div class="comment-container" id="li-comment-411987">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 1, 2017 at 6:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-411987" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It does not choose the best split, but a random split from among the best.</p>
<p>You can split a single feature many times, if it makes sense from a gini-score perspective.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-411987" onclick='return addComment.moveForm( "comment-411987", "411987", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-412036">
<div class="comment-container" id="li-comment-412036">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/19ccc80306b2244a52f51c58c81ccf7c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/19ccc80306b2244a52f51c58c81ccf7c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Wells</span>
<span class="date">September 1, 2017 at 1:36 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-412036" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yeah I realized this point. Thanks!</p>
<div class="reply">
<a aria-label="Reply to Wells" class="comment-reply-link" href="#comment-412036" onclick='return addComment.moveForm( "comment-412036", "412036", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-414516">
<div class="comment-container" id="li-comment-414516">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7dcfe94c4077997262ebbce8ec419b44?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7dcfe94c4077997262ebbce8ec419b44?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ria</span>
<span class="date">September 22, 2017 at 10:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-414516" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>rf_model = training(training_data2,RandomForestClassifier())<br/>
    print rf_model<br/>
    test(rf_model,test_data2)</p>
<p>RandomForestClassifier(bootstrap=True, class_weight=None, criterion=’gini’,<br/>
            max_depth=None, max_features=’auto’, max_leaf_nodes=None,<br/>
            min_impurity_split=1e-07, min_samples_leaf=1,<br/>
            min_samples_split=2, min_weight_fraction_leaf=0.0,<br/>
            n_estimators=10, n_jobs=1, oob_score=False, random_state=None,<br/>
            verbose=0, warm_start=False)<br/>
I tried using number of trees =1,5,10 as per your example but not working could you pls say  me where shld i need to make changes and moreover when i set randomstate = none each time i execute my accuracy keeps on changing but when i set a value for the random state giving me same accuracy.</p>
<div class="reply">
<a aria-label="Reply to Ria" class="comment-reply-link" href="#comment-414516" onclick='return addComment.moveForm( "comment-414516", "414516", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-416713">
<div class="comment-container" id="li-comment-416713">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7c9ab621ed6dbd257e09566f88c0cb57?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7c9ab621ed6dbd257e09566f88c0cb57?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">DATAEXPERT</span>
<span class="date">October 15, 2017 at 4:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-416713" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
I would like to change the code so it will work for 90% of data for train and 10% for test, with no folds. If I use n_folds = 1, I get an error. How can I change the code so it will work?</p>
<div class="reply">
<a aria-label="Reply to DATAEXPERT" class="comment-reply-link" href="#comment-416713" onclick='return addComment.moveForm( "comment-416713", "416713", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-416729">
<div class="comment-container" id="li-comment-416729">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 15, 2017 at 5:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-416729" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps you would be better served by using scikit-learn to fit your model:<br/>
<a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/" rel="nofollow">https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-416729" onclick='return addComment.moveForm( "comment-416729", "416729", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-416743">
<div class="comment-container" id="li-comment-416743">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7c9ab621ed6dbd257e09566f88c0cb57?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7c9ab621ed6dbd257e09566f88c0cb57?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">DATAEXPERT</span>
<span class="date">October 15, 2017 at 6:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-416743" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks a lot. I would like to use your code since I made another internal change of the algorithm that can’t be done using scikit-learn. I think the major (may be the only) change is in the evaluate_algorithm function.</p>
<div class="reply">
<a aria-label="Reply to DATAEXPERT" class="comment-reply-link" href="#comment-416743" onclick='return addComment.moveForm( "comment-416743", "416743", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-418151">
<div class="comment-container" id="li-comment-418151">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6480cb5d0e6d727aee31fe77bbc004f0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6480cb5d0e6d727aee31fe77bbc004f0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ali</span>
<span class="date">October 28, 2017 at 2:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-418151" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can we implement random forest using fitctree in matlab?</p>
<p>There is a function call TreeBagger that can implement random forest. However, if we use this function, we have no control on each individual tree. Can we use the MATLAB function fitctree, which build a decision tree, to implement random forest? Thanks a lot.</p>
<div class="reply">
<a aria-label="Reply to Ali" class="comment-reply-link" href="#comment-418151" onclick='return addComment.moveForm( "comment-418151", "418151", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418174">
<div class="comment-container" id="li-comment-418174">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 28, 2017 at 5:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-418174" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have material on matlab.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-418174" onclick='return addComment.moveForm( "comment-418174", "418174", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-420834">
<div class="comment-container" id="li-comment-420834">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bc5ff4cf949f6b7718a5125cebd2ba64?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bc5ff4cf949f6b7718a5125cebd2ba64?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kuber Jain</span>
<span class="date">November 22, 2017 at 12:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-420834" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I am trying to solve classification problem using RF, and each time I run RandomForestClassifier on my training data, feature importance shows different features everytime I run it. How can I make sure it gives me same top 5 features everytime I run the model ? Please let me know.</p>
<p>model_rc = RandomForestClassifier(n_estimators=10,max_depth=None,min_samples_split=2,random_state=0)<br/>
rc_fit=model_rc.fit(X_train, y_train.values.ravel())</p>
<div class="reply">
<a aria-label="Reply to Kuber Jain" class="comment-reply-link" href="#comment-420834" onclick='return addComment.moveForm( "comment-420834", "420834", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-420937">
<div class="comment-container" id="li-comment-420937">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 23, 2017 at 10:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-420937" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, this is a feature of the algorithm.</p>
<p>See this post:<br/>
<a href="https://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">https://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-420937" onclick='return addComment.moveForm( "comment-420937", "420937", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-425465">
<div class="comment-container" id="li-comment-425465">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a46be7cbc707eee613708ac44faa7b1b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a46be7cbc707eee613708ac44faa7b1b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Khin</span>
<span class="date">January 3, 2018 at 2:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-425465" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would like to know the difference between sklearn randomforest and random forest algorithm implemented by oneself.  Is there any weakness or something in sklearn randomforest?</p>
<div class="reply">
<a aria-label="Reply to Khin" class="comment-reply-link" href="#comment-425465" onclick='return addComment.moveForm( "comment-425465", "425465", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-425485">
<div class="comment-container" id="li-comment-425485">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 3, 2018 at 5:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-425485" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend only implementing the algorithm yourself for learning, I would expect the sklearn implementation will be more robust and efficient.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425485" onclick='return addComment.moveForm( "comment-425485", "425485", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-425521">
<div class="comment-container" id="li-comment-425521">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7a730211e0f3422072853d5dd3b6740e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7a730211e0f3422072853d5dd3b6740e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">PSN</span>
<span class="date">January 3, 2018 at 5:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-425521" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Could you implement rotation forest algorithm ?</p>
<div class="reply">
<a aria-label="Reply to PSN" class="comment-reply-link" href="#comment-425521" onclick='return addComment.moveForm( "comment-425521", "425521", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-425571">
<div class="comment-container" id="li-comment-425571">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 4, 2018 at 8:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-425571" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425571" onclick='return addComment.moveForm( "comment-425571", "425571", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-425595">
<div class="comment-container" id="li-comment-425595">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/240b0d2a70f82d50adeb46629e3b6e53?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/240b0d2a70f82d50adeb46629e3b6e53?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sterling</span>
<span class="date">January 4, 2018 at 11:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-425595" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Your blogs and tutorials have aided me throughout my PhD. Thank you for putting so much time and effort into sharing this information.</p>
<div class="reply">
<a aria-label="Reply to Sterling" class="comment-reply-link" href="#comment-425595" onclick='return addComment.moveForm( "comment-425595", "425595", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-425602">
<div class="comment-container" id="li-comment-425602">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 4, 2018 at 3:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-425602" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, I’m really glad to hear that!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425602" onclick='return addComment.moveForm( "comment-425602", "425602", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-428381">
<div class="comment-container" id="li-comment-428381">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ba439ffa79ae6eabdcbdd0d5d5400d85?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ba439ffa79ae6eabdcbdd0d5d5400d85?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ioannis</span>
<span class="date">February 5, 2018 at 3:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-428381" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,</p>
<p>thank you very much for this implementation, fantastic work!</p>
<p>Is it possible to know which features are most discriminative<br/>
for the task at hand and maybe the degree of importance<br/>
for each of these features?</p>
<p>Many thanks in advance !!!</p>
<div class="reply">
<a aria-label="Reply to Ioannis" class="comment-reply-link" href="#comment-428381" onclick='return addComment.moveForm( "comment-428381", "428381", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-428410">
<div class="comment-container" id="li-comment-428410">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 5, 2018 at 7:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-428410" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, you can use feature selection methods:<br/>
<a href="http://machinelearningmastery.com/an-introduction-to-feature-selection/" rel="nofollow">http://machinelearningmastery.com/an-introduction-to-feature-selection/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-428410" onclick='return addComment.moveForm( "comment-428410", "428410", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-430712">
<div class="comment-container" id="li-comment-430712">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/036028875617fd01e952f061e6de7985?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/036028875617fd01e952f061e6de7985?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">K</span>
<span class="date">February 28, 2018 at 4:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-430712" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>Thanks for sharing! I wonder how fast is your implementation. (I guess I should try it out myself. 🙂 </p>
<p>I was a master student in biostatistics and doing a thesis project which applied a modified random forest (no existing implementation) to solve a problem. I was and still I am only comfortable with R. I implemented the modified random forest from scratch in R. Although I tried hard to improve my code and implement some parts in C++ (via Rcpp package), it was still so slow… I noticed random forests packages in R or Python were all calling codes writing in C at its core. </p>
<p>So, would you mind estimate how fast is your implementation comparing to mainstream implementation (e.g. 10 times slower than Scikit-learn) ?<br/>
I am new to Python.  I should really try it myself but just can’t help ask for a quick answer for this to inspire me to learn Python! 🙂</p>
<p>Thanks!</p>
<p>Kehao</p>
<div class="reply">
<a aria-label="Reply to K" class="comment-reply-link" href="#comment-430712" onclick='return addComment.moveForm( "comment-430712", "430712", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-430781">
<div class="comment-container" id="li-comment-430781">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 1, 2018 at 6:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-430781" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It is slow. It is for learning purposes only.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430781" onclick='return addComment.moveForm( "comment-430781", "430781", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-432991">
<div class="comment-container" id="li-comment-432991">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8d1deac0c795fee7c04fd28681b03c73?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8d1deac0c795fee7c04fd28681b03c73?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kirtika Bhatt</span>
<span class="date">March 23, 2018 at 6:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-432991" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am new to python and doing a mini project for self learning. It will be helpful if you guide that how can I use this algorithm to predict the class of some test data.</p>
<div class="reply">
<a aria-label="Reply to Kirtika Bhatt" class="comment-reply-link" href="#comment-432991" onclick='return addComment.moveForm( "comment-432991", "432991", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-432999">
<div class="comment-container" id="li-comment-432999">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 23, 2018 at 8:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-432999" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>A good place to start is here:<br/>
<a href="https://machinelearningmastery.com/start-here/#python" rel="nofollow">https://machinelearningmastery.com/start-here/#python</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-432999" onclick='return addComment.moveForm( "comment-432999", "432999", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-434323">
<div class="comment-container" id="li-comment-434323">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/698a516444f4c70773782ea7c9c6b50b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/698a516444f4c70773782ea7c9c6b50b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">niloofar</span>
<span class="date">April 6, 2018 at 7:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-434323" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I might send another message but I am not sure if it had sent or not.<br/>
I just wanted to say thank you for your informative website.<br/>
this post was also and very comprehensive with full of integrated ideas and topics.<br/>
If the python project is available I would appreciate if you send it.</p>
<p>best regards,<br/>
niloofar</p>
<div class="reply">
<a aria-label="Reply to niloofar" class="comment-reply-link" href="#comment-434323" onclick='return addComment.moveForm( "comment-434323", "434323", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-434359">
<div class="comment-container" id="li-comment-434359">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 7, 2018 at 6:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-434359" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, I’m glad it helped!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-434359" onclick='return addComment.moveForm( "comment-434359", "434359", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-438495">
<div class="comment-container" id="li-comment-438495">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/41aa0db62d179a1cc0bb4492e86ed25b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/41aa0db62d179a1cc0bb4492e86ed25b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">samiha</span>
<span class="date">May 24, 2018 at 10:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-438495" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi<br/>
please how can i evaluate the algorithme !?</p>
<div class="reply">
<a aria-label="Reply to samiha" class="comment-reply-link" href="#comment-438495" onclick='return addComment.moveForm( "comment-438495", "438495", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-438561">
<div class="comment-container" id="li-comment-438561">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 25, 2018 at 9:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-438561" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question, I answer it here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-evaluate-a-machine-learning-algorithm" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-evaluate-a-machine-learning-algorithm</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-438561" onclick='return addComment.moveForm( "comment-438561", "438561", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-439149">
<div class="comment-container" id="li-comment-439149">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/72e090449cc3ee929942dc07e13c96d0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/72e090449cc3ee929942dc07e13c96d0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Adeola</span>
<span class="date">May 30, 2018 at 9:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-439149" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good Dr Brownlee, </p>
<p>Kudos for the good work sir, I have a quick question sir. How long did it take you to write such a wonderful piece of code up and what are the resources you used to help you sir?<br/>
Thank you sir and kind regards.</p>
<div class="reply">
<a aria-label="Reply to Adeola" class="comment-reply-link" href="#comment-439149" onclick='return addComment.moveForm( "comment-439149", "439149", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-439186">
<div class="comment-container" id="li-comment-439186">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 31, 2018 at 6:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-439186" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps a day or two. I used some textbooks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-439186" onclick='return addComment.moveForm( "comment-439186", "439186", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-442397">
<div class="comment-container" id="li-comment-442397">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/af3a0d0d298ee679c0184d7df3af3923?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/af3a0d0d298ee679c0184d7df3af3923?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Piyasi Choudhury</span>
<span class="date">June 30, 2018 at 12:16 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-442397" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great work Jason..wonder if I can use this to conceptualize a 3 way split tree – a tree that can have 3 classes, instead of binary?</p>
<div class="reply">
<a aria-label="Reply to Piyasi Choudhury" class="comment-reply-link" href="#comment-442397" onclick='return addComment.moveForm( "comment-442397", "442397", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-442424">
<div class="comment-container" id="li-comment-442424">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 1, 2018 at 6:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-442424" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t see why not.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442424" onclick='return addComment.moveForm( "comment-442424", "442424", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-449690">
<div class="comment-container" id="li-comment-449690">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/76ff8373c9797a009a6e396904289725?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/76ff8373c9797a009a6e396904289725?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Then</span>
<span class="date">September 24, 2018 at 6:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-449690" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi…<br/>
How can I implement this code for multiclass classification?.</p>
<div class="reply">
<a aria-label="Reply to Then" class="comment-reply-link" href="#comment-449690" onclick='return addComment.moveForm( "comment-449690", "449690", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-449723">
<div class="comment-container" id="li-comment-449723">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 25, 2018 at 6:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-449723" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps this tutorial is a bit advanced, I would recommend using scikit-learn to get started:<br/>
<a href="https://machinelearningmastery.com/start-here/#python" rel="nofollow">https://machinelearningmastery.com/start-here/#python</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-449723" onclick='return addComment.moveForm( "comment-449723", "449723", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-449765">
<div class="comment-container" id="li-comment-449765">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/76ff8373c9797a009a6e396904289725?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/76ff8373c9797a009a6e396904289725?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Then</span>
<span class="date">September 25, 2018 at 4:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-449765" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi!<br/>
How can I implement your code for multi-class classification?<br/>
Thanks.</p>
<div class="reply">
<a aria-label="Reply to Then" class="comment-reply-link" href="#comment-449765" onclick='return addComment.moveForm( "comment-449765", "449765", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-449801">
<div class="comment-container" id="li-comment-449801">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 26, 2018 at 6:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-449801" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would encourage you to use scikit-learn instead, as modifying this example for multi-class classification is not for beginners.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-449801" onclick='return addComment.moveForm( "comment-449801", "449801", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-452491">
<div class="comment-container" id="li-comment-452491">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8f28e9d690453fcf4639ae993083e21d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8f28e9d690453fcf4639ae993083e21d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Fraser</span>
<span class="date">October 24, 2018 at 2:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-452491" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>You might never see this because its been so long since posted this article.</p>
<p>I am running your code with python 3.6 in PyCharm and I noticed that if I comment out the</p>
<p>def str_column_to_int(dataset, column)</p>
<p>function then the code runs just fine but the accuracy scores change to this:</p>
<p>Trees: 1<br/>
Scores: [56.09756097560976, 63.41463414634146, 60.97560975609756, 58.536585365853654, 73.17073170731707]<br/>
Mean Accuracy: 62.439%<br/>
Trees: 5<br/>
Scores: [70.73170731707317, 58.536585365853654, 85.36585365853658, 75.60975609756098, 63.41463414634146]<br/>
Mean Accuracy: 70.732%<br/>
Trees: 10<br/>
Scores: [82.92682926829268, 75.60975609756098, 97.5609756097561, 80.48780487804879, 68.29268292682927]<br/>
Mean Accuracy: 80.976%</p>
<p>Process finished with exit code 0</p>
<p>The accuracy increases for the 10 trees.</p>
<p>Any idea whats going on?</p>
<div class="reply">
<a aria-label="Reply to Fraser" class="comment-reply-link" href="#comment-452491" onclick='return addComment.moveForm( "comment-452491", "452491", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-452525">
<div class="comment-container" id="li-comment-452525">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 24, 2018 at 6:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-452525" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>More trees is better for this problem!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-452525" onclick='return addComment.moveForm( "comment-452525", "452525", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-452510">
<div class="comment-container" id="li-comment-452510">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7c292a08be638d7c52ac4e643476438a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7c292a08be638d7c52ac4e643476438a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shipika Singh</span>
<span class="date">October 24, 2018 at 6:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-452510" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi,<br/>
very nice explanation! but I am thinking what if I create a random forest from a dataset and then pass a single document to test it. what will be the method to pass a single document in the clf of random forest?</p>
<div class="reply">
<a aria-label="Reply to Shipika Singh" class="comment-reply-link" href="#comment-452510" onclick='return addComment.moveForm( "comment-452510", "452510", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-452528">
<div class="comment-container" id="li-comment-452528">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 24, 2018 at 6:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-452528" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This tutorial is for learning how random forest works. If you are working on a project, I’d recommend that you use random forest in sklearn.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-452528" onclick='return addComment.moveForm( "comment-452528", "452528", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-452555">
<div class="comment-container" id="li-comment-452555">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/67c8397aadb7dc9b363e8cbf309c8a0a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/67c8397aadb7dc9b363e8cbf309c8a0a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Elizabeth</span>
<span class="date">October 24, 2018 at 12:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-452555" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>HI Jason,<br/>
This is a great tutorial. I’ve been working on a random forest project in R and have been reading alot about using this method. I’m confused because some articles note that RF will NOT overfit, yet there seems to be a constant discussion about overfitting with RF in stackoverflow. Do RF models overfit? My second question pertains to the Gini decrease scores–are these impacted by correlated variables ? (I know RF handles correlated predictor variables fairly well). Final question– if using CV in caret, is train/test sample necessary? I have a very unbalanced outcome classifier and not a ton of data, so I didn’t want to split it further, unless absolutely necessary.<br/>
Thank you!</p>
<div class="reply">
<a aria-label="Reply to Elizabeth" class="comment-reply-link" href="#comment-452555" onclick='return addComment.moveForm( "comment-452555", "452555", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-452581">
<div class="comment-container" id="li-comment-452581">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 24, 2018 at 2:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-random-forest-scratch-python/#comment-452581" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Generally, bagged trees don’t overfit. I’ve read this and observed this, it might even be true.</p>
<p>Trees are invariant to correlated inputs.</p>
<p>Probability just CV or train/test would be sufficient, probably not both.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-452581" onclick='return addComment.moveForm( "comment-452581", "452581", "respond", "3360" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/implement-random-forest-scratch-python/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="3360"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="0da6f55dfa"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="37"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery!</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Jason Brownlee, PhD
<br/>
I write tutorials to help developers (<i>like you</i>) get results with machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-19"> <div class="textwidget"><p></p><center><br/>
<strong>Code Algorithms From Scratch</strong><br/>
No libraries, just simple Python code.
<p><a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Click to Get Started Now!</a><br/>
<a href="/machine-learning-algorithms-from-scratch/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningAlgorithmsFromScratch-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch"><img alt="How to Develop a Neural Machine Translation System in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/01/How-to-Develop-a-Neural-Machine-Translation-System-in-Keras-150x150.jpg" title="How to Develop a Neural Machine Translation System from Scratch" width="45"/></a> <a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch">How to Develop a Neural Machine Translation System from Scratch</a>
<span class="meta">January 10, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning"><img alt="Difference Between Classification and Regression in Machine Learning" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/Difference-Between-Classification-and-Regression-in-Machine-Learning-150x150.jpg" title="Difference Between Classification and Regression in Machine Learning" width="45"/></a> <a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning">Difference Between Classification and Regression in Machine Learning</a>
<span class="meta">December 11, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem..."><img alt="So, You are Working on a Machine Learning Problem..." class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/So-You-are-Working-on-a-Machine-Learning-Problem...-150x150.jpg" title="So, You are Working on a Machine Learning Problem..." width="45"/></a> <a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem…">So, You are Working on a Machine Learning Problem…</a>
<span class="meta">April 4, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis"><img alt="Plot of the Multichannel Convolutional Neural Network For Text" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-150x150.png" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis" width="45"/></a> <a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis">How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis</a>
<span class="meta">January 12, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras"><img alt="How to Make Classification and Regression Predictions for Deep Learning Models in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/How-to-Make-Classification-and-Regression-Predictions-for-Deep-Learning-Models-in-Keras-150x150.jpg" title="How to Make Predictions with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras">How to Make Predictions with Keras</a>
<span class="meta">April 9, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)"><img alt="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/11-Classical-Time-Series-Forecasting-Methods-in-Python-Cheat-Sheet-150x150.jpg" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)">11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)</a>
<span class="meta">August 6, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras"><img alt="How to Visualize a Deep Learning Neural Network Model in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/How-to-Visualize-a-Deep-Learning-Neural-Network-Model-in-Keras-150x150.jpg" title="How to Visualize a Deep Learning Neural Network Model in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras">How to Visualize a Deep Learning Neural Network Model in Keras</a>
<span class="meta">December 13, 2017</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> <div class="widget_text widget widget_custom_html" id="custom_html-2"><h3>You might also like…</h3><div class="textwidget custom-html-widget"><ul>
<li><a href="/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Install Python for Machine Learning</a></li>
<li><a href="/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python</a></li>
<li><a href="/tutorial-first-neural-network-python-keras/">Your First Neural Network in Python</a></li>
<li><a href="/how-to-run-your-first-classifier-in-weka/">Your First Classifier in Weka</a></li>
<li><a href="/arima-for-time-series-forecasting-with-python/">Your First Time Series Forecasting Project</a></li>
</ul></div></div></aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/disclaimer/">Disclaimer</a> | 
<a href="/terms-of-service/">Terms</a> | 
<a href="/contact/">Contact</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.8" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.0.5" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.8" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.1" type="text/javascript"></script>
</body>
</html>