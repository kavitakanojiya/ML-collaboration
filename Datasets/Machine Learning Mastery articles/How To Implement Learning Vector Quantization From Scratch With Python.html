<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v9.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>How To Implement Learning Vector Quantization From Scratch With Python</title>
<link href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="How To Implement Learning Vector Quantization From Scratch With Python" property="og:title"/>
<meta content="A limitation of k-Nearest Neighbors is that you must keep a large database of training examples in order to make predictions. The Learning Vector Quantization algorithm addresses this by learning a much smaller subset of patterns that best represent the training data. In this tutorial, you will discover how to implement the Learning Vector Quantization …" property="og:description"/>
<meta content="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="https://www.facebook.com/jason.brownlee.39" property="article:author"/>
<meta content="Code Machine Learning Algorithms From Scratch" property="article:section"/>
<meta content="2016-11-03T18:00:41+00:00" property="article:published_time"/>
<meta content="2018-08-27T22:07:43+00:00" property="article:modified_time"/>
<meta content="2018-08-27T22:07:43+00:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-To-Implement-Learning-Vector-Quantization-From-Scratch-With-Python.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-To-Implement-Learning-Vector-Quantization-From-Scratch-With-Python.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="424" property="og:image:height"/>
<meta content="How To Implement Learning Vector Quantization From Scratch With Python" property="og:image:alt"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"https:\/\/machinelearningmastery.com\/#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/feed/" rel="alternate" title="Machine Learning Mastery » How To Implement Learning Vector Quantization From Scratch With Python Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<style media="all" type="text/css">
.wpautoterms-footer{background-color:#ffffff;text-align:center;}
.wpautoterms-footer a{color:#000000;font-family:Arial, sans-serif;font-size:14px;}
.wpautoterms-footer .separator{color:#cccccc;font-family:Arial, sans-serif;font-size:14px;}</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/auto-terms-of-service-and-privacy-policy/css/wpautoterms.css?ver=4.9.8" id="wpautoterms_css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.0.5" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/css/front.css?ver=2.0.20" id="ssb-front-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/ewd-ufaq-styles.css?ver=4.9.8" id="ewd-ufaq-style-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/rrssb-min.css?ver=4.9.8" id="ewd-ufaq-rrssb-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.8" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=2.0.20" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.8" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.8" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=3346" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-learning-vector-quantization-scratch-python%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-learning-vector-quantization-scratch-python%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<style media="screen">

        .simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
      margin: ;
    }
         /*inline margin*/
    
  
  
  
  
  
          .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
         margin: ;
     }

          /*margin-digbar*/

  
  
  
  
 
   
   

</style>
<script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#4c89bf; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#4c89bf;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#4c89bf!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#ffffff;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-3346 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/icon-100x100.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-18"> <div class="textwidget"><p>Want help with machine learning? <a href="https://machinelearningmastery.leadpages.co/machine-learning-resource-guide/">Take the FREE Crash-Course</a>.</p>
</div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<input name="post_type" type="hidden" value="post"/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Main Menu</h3><ul class="nav fl" id="main-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503" id="menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Start Here</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501" id="menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506" id="menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508" id="menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (Keras)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511" id="menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509" id="menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515" id="menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">Deep Learning for NLP</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512" id="menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Understand Algorithms</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6507" id="menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms (Python)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6513" id="menu-item-6513"><a href="https://machinelearningmastery.com/category/machine-learning-process/">Machine Learning Process</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516" id="menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517" id="menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522" id="menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6518" id="menu-item-6518"><a href="https://machinelearningmastery.com/category/start-machine-learning/">Getting Started</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510" id="menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519" id="menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistical Methods</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520" id="menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Time Series (introductory)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523" id="menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6514" id="menu-item-6514"><a href="https://machinelearningmastery.com/category/machine-learning-resources/">Resources</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502" id="menu-item-6502"><a href="https://machinelearningmastery.com/products/">Ebooks</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500" id="menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504" id="menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505" id="menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-3346 post type-post status-publish format-standard has-post-thumbnail hentry category-algorithms-from-scratch">
<header>
<h1 class="title entry-title">How To Implement Learning Vector Quantization From Scratch With Python</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-11-04T05:00:41+1100">November 4, 2016</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/" title="View all items in Code Machine Learning Algorithms From Scratch">Code Machine Learning Algorithms From Scratch</a></span> </div>
<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-3346 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+To+Implement+Learning+Vector+Quantization+From+Scratch+With+Python&amp;url=https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
<p>A limitation of <a href="http://machinelearningmastery.com/k-nearest-neighbors-for-machine-learning/">k-Nearest Neighbors</a> is that you must keep a large database of training examples in order to make predictions.</p>
<p>The <a href="http://machinelearningmastery.com/learning-vector-quantization-for-machine-learning/">Learning Vector Quantization</a> algorithm addresses this by learning a much smaller subset of patterns that best represent the training data.</p>
<p>In this tutorial, you will discover how to implement the Learning Vector Quantization algorithm from scratch with Python.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>How to learn a set of codebook vectors from a training data set.</li>
<li>How to make predictions using learned codebook vectors.</li>
<li>How to apply Learning Vector Quantization to a real predictive modeling problem.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Jan/2017</strong>: Changed the calculation of fold_size in cross_validation_split() to always be an integer. Fixes issues with Python 3.</li>
<li><strong>Update Aug/2018</strong>: Tested and updated to work with Python 3.6.</li>
</ul>
<div class="wp-caption aligncenter" id="attachment_3347" style="width: 650px"><img alt="How To Implement Learning Vector Quantization From Scratch With Python" class="size-full wp-image-3347" height="424" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-To-Implement-Learning-Vector-Quantization-From-Scratch-With-Python.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-To-Implement-Learning-Vector-Quantization-From-Scratch-With-Python.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-To-Implement-Learning-Vector-Quantization-From-Scratch-With-Python-300x199.jpg 300w" width="640"/><p class="wp-caption-text">How To Implement Learning Vector Quantization From Scratch With Python<br/>Photo by <a href="https://www.flickr.com/photos/tonyfaiola/10303914233/">Tony Faiola</a>, some rights reserved.</p></div>
<h2>Description</h2>
<p>This section provides a brief introduction to the Learning Vector Quantization algorithm and the Ionosphere classification problem that we will use in this tutorial</p>
<h3>Learning Vector Quantization</h3>
<p>The Learning Vector Quantization (LVQ) algorithm is a lot like k-Nearest Neighbors.</p>
<p>Predictions are made by finding the best match among a library of patterns. The difference is that the library of patterns is learned from training data, rather than using the training patterns themselves.</p>
<p>The library of patterns are called codebook vectors and each pattern is called a codebook. The codebook vectors are initialized to randomly selected values from the training dataset. Then, over a number of epochs, they are adapted to best summarize the training data using a learning algorithm.</p>
<p>The learning algorithm shows one training record at a time, finds the best matching unit among the codebook vectors and moves it closer to the training record if they have the same class, or further away if they have different classes.</p>
<p>Once prepared, the codebook vectors are used to make predictions using the k-Nearest Neighbors algorithm where k=1.</p>
<p>The algorithm was developed for classification predictive modeling problems, but can be adapted for use with regression problems.</p>
<h3>Ionosphere Dataset</h3>
<p>The Ionosphere dataset predicts the structure of the ionosphere given radar return data.</p>
<p>Each instance describes the properties of radar returns from the atmosphere and the task is to predict whether or not there is structure in the ionosphere.</p>
<p>There are 351 instances and 34 numerical input variables, 17 pairs of 2 for each radar pulse that generally have the same scale of 0-1. The class value is a string with a value of either a “g” for good return or “b” for a bad return.</p>
<p>Using the Zero Rule Algorithm that predicts the class with the most observations, a baseline accuracy of 64.286% can be achieved.</p>
<p>You can learn more and download the dataset from the <a href="https://archive.ics.uci.edu/ml/datasets/Ionosphere">UCI Machine Learning Repository</a>.</p>
<p>Download the dataset and place it in your current working directory with the name <strong>ionosphere.csv</strong>.</p>
<h2>Tutorial</h2>
<p>This tutorial is broken down into 4 parts:</p>
<ol>
<li>Euclidean Distance.</li>
<li>Best Matching Unit.</li>
<li>Training Codebook Vectors.</li>
<li>Ionosphere Case Study.</li>
</ol>
<p>These steps will lay the foundation for implementing and applying the LVQ algorithm to your own predictive modeling problems.</p>
<h3>1. Euclidean Distance</h3>
<p>The first step needed is to calculate the distance between two rows in a dataset.</p>
<p>Rows of data are mostly made up of numbers and an easy way to calculate the distance between two rows or vectors of numbers is to draw a straight line. This makes sense in 2D or 3D and scales nicely to higher dimensions.</p>
<p>We can calculate the straight line distance between two vectors using the Euclidean distance measure. It is calculated as the square root of the sum of the squared differences between the two vectors.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cabd04597a253340389" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
distance = sqrt( sum( (x1_i - x2_i)^2 )</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cabd04597a253340389-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cabd04597a253340389-1">distance = sqrt( sum( (x1_i - x2_i)^2 )</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Where <strong>x1</strong> is the first row of data, <strong>x2</strong> is the second row of data and <strong>i</strong> is the index for a specific column as we sum across all columns.</p>
<p>With Euclidean distance, the smaller the value, the more similar two records will be. A value of 0 means that there is no difference between two records.</p>
<p>Below is a function named <strong>euclidean_distance()</strong> that implements this in Python.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cabd045982562335215" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# calculate the Euclidean distance between two vectors
def euclidean_distance(row1, row2):
	distance = 0.0
	for i in range(len(row1)-1):
		distance += (row1[i] - row2[i])**2
	return sqrt(distance)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cabd045982562335215-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045982562335215-2">2</div><div class="crayon-num" data-line="crayon-5c0cabd045982562335215-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045982562335215-4">4</div><div class="crayon-num" data-line="crayon-5c0cabd045982562335215-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045982562335215-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cabd045982562335215-1"><span class="crayon-p"># calculate the Euclidean distance between two vectors</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045982562335215-2"><span class="crayon-e">def </span><span class="crayon-e">euclidean_distance</span><span class="crayon-sy">(</span><span class="crayon-v">row1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row2</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd045982562335215-3"><span class="crayon-h"> </span><span class="crayon-v">distance</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045982562335215-4"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">row1</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd045982562335215-5"><span class="crayon-h"> </span><span class="crayon-v">distance</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">row1</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">row2</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045982562335215-6"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">distance</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>You can see that the function assumes that the last column in each row is an output value which is ignored from the distance calculation.</p>
<p>We can test this distance function with a small contrived classification dataset. We will use this dataset a few times as we construct the elements needed for the LVQ algorithm.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cabd045985254647932" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
X1			X2			Y
2.7810836		2.550537003		0
1.465489372		2.362125076		0
3.396561688		4.400293529		0
1.38807019		1.850220317		0
3.06407232		3.005305973		0
7.627531214		2.759262235		1
5.332441248		2.088626775		1
6.922596716		1.77106367		1
8.675418651		-0.242068655		1
7.673756466		3.508563011		1</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cabd045985254647932-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045985254647932-2">2</div><div class="crayon-num" data-line="crayon-5c0cabd045985254647932-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045985254647932-4">4</div><div class="crayon-num" data-line="crayon-5c0cabd045985254647932-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045985254647932-6">6</div><div class="crayon-num" data-line="crayon-5c0cabd045985254647932-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045985254647932-8">8</div><div class="crayon-num" data-line="crayon-5c0cabd045985254647932-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045985254647932-10">10</div><div class="crayon-num" data-line="crayon-5c0cabd045985254647932-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cabd045985254647932-1">X1			X2			Y</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045985254647932-2">2.7810836		2.550537003		0</div><div class="crayon-line" id="crayon-5c0cabd045985254647932-3">1.465489372		2.362125076		0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045985254647932-4">3.396561688		4.400293529		0</div><div class="crayon-line" id="crayon-5c0cabd045985254647932-5">1.38807019		1.850220317		0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045985254647932-6">3.06407232		3.005305973		0</div><div class="crayon-line" id="crayon-5c0cabd045985254647932-7">7.627531214		2.759262235		1</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045985254647932-8">5.332441248		2.088626775		1</div><div class="crayon-line" id="crayon-5c0cabd045985254647932-9">6.922596716		1.77106367		1</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045985254647932-10">8.675418651		-0.242068655		1</div><div class="crayon-line" id="crayon-5c0cabd045985254647932-11">7.673756466		3.508563011		1</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Putting this all together, we can write a small example to test our distance function by printing the distance between the first row and all other rows. We would expect the distance between the first row and itself to be 0, a good thing to look out for.</p>
<p>The full example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cabd045986652842433" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from math import sqrt

# calculate the Euclidean distance between two vectors
def euclidean_distance(row1, row2):
	distance = 0.0
	for i in range(len(row1)-1):
		distance += (row1[i] - row2[i])**2
	return sqrt(distance)

# Test distance function
dataset = [[2.7810836,2.550537003,0],
	[1.465489372,2.362125076,0],
	[3.396561688,4.400293529,0],
	[1.38807019,1.850220317,0],
	[3.06407232,3.005305973,0],
	[7.627531214,2.759262235,1],
	[5.332441248,2.088626775,1],
	[6.922596716,1.77106367,1],
	[8.675418651,-0.242068655,1],
	[7.673756466,3.508563011,1]]

row0 = dataset[0]
for row in dataset:
	distance = euclidean_distance(row0, row)
	print(distance)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cabd045986652842433-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045986652842433-2">2</div><div class="crayon-num" data-line="crayon-5c0cabd045986652842433-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045986652842433-4">4</div><div class="crayon-num" data-line="crayon-5c0cabd045986652842433-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045986652842433-6">6</div><div class="crayon-num" data-line="crayon-5c0cabd045986652842433-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045986652842433-8">8</div><div class="crayon-num" data-line="crayon-5c0cabd045986652842433-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045986652842433-10">10</div><div class="crayon-num" data-line="crayon-5c0cabd045986652842433-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045986652842433-12">12</div><div class="crayon-num" data-line="crayon-5c0cabd045986652842433-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045986652842433-14">14</div><div class="crayon-num" data-line="crayon-5c0cabd045986652842433-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045986652842433-16">16</div><div class="crayon-num" data-line="crayon-5c0cabd045986652842433-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045986652842433-18">18</div><div class="crayon-num" data-line="crayon-5c0cabd045986652842433-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045986652842433-20">20</div><div class="crayon-num" data-line="crayon-5c0cabd045986652842433-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045986652842433-22">22</div><div class="crayon-num" data-line="crayon-5c0cabd045986652842433-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045986652842433-24">24</div><div class="crayon-num" data-line="crayon-5c0cabd045986652842433-25">25</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cabd045986652842433-1"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-v">sqrt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045986652842433-2"> </div><div class="crayon-line" id="crayon-5c0cabd045986652842433-3"><span class="crayon-p"># calculate the Euclidean distance between two vectors</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045986652842433-4"><span class="crayon-e">def </span><span class="crayon-e">euclidean_distance</span><span class="crayon-sy">(</span><span class="crayon-v">row1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row2</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd045986652842433-5"><span class="crayon-h"> </span><span class="crayon-v">distance</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045986652842433-6"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">row1</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd045986652842433-7"><span class="crayon-h"> </span><span class="crayon-v">distance</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">row1</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">row2</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045986652842433-8"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">distance</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd045986652842433-9"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045986652842433-10"><span class="crayon-p"># Test distance function</span></div><div class="crayon-line" id="crayon-5c0cabd045986652842433-11"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">2.7810836</span><span class="crayon-sy">,</span><span class="crayon-cn">2.550537003</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045986652842433-12"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1.465489372</span><span class="crayon-sy">,</span><span class="crayon-cn">2.362125076</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0cabd045986652842433-13"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3.396561688</span><span class="crayon-sy">,</span><span class="crayon-cn">4.400293529</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045986652842433-14"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1.38807019</span><span class="crayon-sy">,</span><span class="crayon-cn">1.850220317</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0cabd045986652842433-15"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3.06407232</span><span class="crayon-sy">,</span><span class="crayon-cn">3.005305973</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045986652842433-16"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">7.627531214</span><span class="crayon-sy">,</span><span class="crayon-cn">2.759262235</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0cabd045986652842433-17"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">5.332441248</span><span class="crayon-sy">,</span><span class="crayon-cn">2.088626775</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045986652842433-18"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">6.922596716</span><span class="crayon-sy">,</span><span class="crayon-cn">1.77106367</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0cabd045986652842433-19"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">8.675418651</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">0.242068655</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045986652842433-20"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">7.673756466</span><span class="crayon-sy">,</span><span class="crayon-cn">3.508563011</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0cabd045986652842433-21"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045986652842433-22"><span class="crayon-v">row0</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0cabd045986652842433-23"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045986652842433-24"><span class="crayon-h"> </span><span class="crayon-v">distance</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">euclidean_distance</span><span class="crayon-sy">(</span><span class="crayon-v">row0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd045986652842433-25"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">distance</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>Running this example prints the distances between the first row and every row in the dataset, including itself.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cabd045988713486896" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
0.0
1.32901739153
1.94946466557
1.55914393855
0.535628072194
4.85094018699
2.59283375995
4.21422704263
6.52240998823
4.98558538245</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cabd045988713486896-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045988713486896-2">2</div><div class="crayon-num" data-line="crayon-5c0cabd045988713486896-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045988713486896-4">4</div><div class="crayon-num" data-line="crayon-5c0cabd045988713486896-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045988713486896-6">6</div><div class="crayon-num" data-line="crayon-5c0cabd045988713486896-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045988713486896-8">8</div><div class="crayon-num" data-line="crayon-5c0cabd045988713486896-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045988713486896-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cabd045988713486896-1">0.0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045988713486896-2">1.32901739153</div><div class="crayon-line" id="crayon-5c0cabd045988713486896-3">1.94946466557</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045988713486896-4">1.55914393855</div><div class="crayon-line" id="crayon-5c0cabd045988713486896-5">0.535628072194</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045988713486896-6">4.85094018699</div><div class="crayon-line" id="crayon-5c0cabd045988713486896-7">2.59283375995</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045988713486896-8">4.21422704263</div><div class="crayon-line" id="crayon-5c0cabd045988713486896-9">6.52240998823</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045988713486896-10">4.98558538245</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Now it is time to use the distance calculation to locate the best matching unit within a dataset.</p>
<h3>2. Best Matching Unit</h3>
<p>The Best Matching Unit or BMU is the codebook vector that is most similar to a new piece of data.</p>
<p>To locate the BMU for a new piece of data within a dataset we must first calculate the distance between each codebook to the new piece of data. We can do this using our distance function above.</p>
<p>Once distances are calculated, we must sort all of the codebooks by their distance to the new data. We can then return the first or most similar codebook vector.</p>
<p>We can do this by keeping track of the distance for each record in the dataset as a tuple, sort the list of tuples by the distance (in descending order) and then retrieve the BMU.</p>
<p>Below is a function named <strong>get_best_matching_unit()</strong> that implements this.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cabd04598a804623874" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Locate the best matching unit
def get_best_matching_unit(codebooks, test_row):
	distances = list()
	for codebook in codebooks:
		dist = euclidean_distance(codebook, test_row)
		distances.append((codebook, dist))
	distances.sort(key=lambda tup: tup[1])
	return distances[0][0]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cabd04598a804623874-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04598a804623874-2">2</div><div class="crayon-num" data-line="crayon-5c0cabd04598a804623874-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04598a804623874-4">4</div><div class="crayon-num" data-line="crayon-5c0cabd04598a804623874-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04598a804623874-6">6</div><div class="crayon-num" data-line="crayon-5c0cabd04598a804623874-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04598a804623874-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cabd04598a804623874-1"><span class="crayon-p"># Locate the best matching unit</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04598a804623874-2"><span class="crayon-e">def </span><span class="crayon-e">get_best_matching_unit</span><span class="crayon-sy">(</span><span class="crayon-v">codebooks</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd04598a804623874-3"><span class="crayon-h"> </span><span class="crayon-v">distances</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04598a804623874-4"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">codebook </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">codebooks</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd04598a804623874-5"><span class="crayon-h"> </span><span class="crayon-v">dist</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">euclidean_distance</span><span class="crayon-sy">(</span><span class="crayon-v">codebook</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04598a804623874-6"><span class="crayon-h"> </span><span class="crayon-v">distances</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">codebook</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dist</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd04598a804623874-7"><span class="crayon-h"> </span><span class="crayon-v">distances</span><span class="crayon-sy">.</span><span class="crayon-e">sort</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-e">lambda </span><span class="crayon-v">tup</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">tup</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04598a804623874-8"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">distances</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>You can see that the <strong>euclidean_distance()</strong> function developed in the previous step is used to calculate the distance between each codebook and the new <strong>test_row</strong>.</p>
<p>The list of codebook and distance tuples is sorted where a custom key is used ensuring that the second item in the tuple (<strong>tup[1]</strong>) is used in the sorting operation.</p>
<p>Finally, the top or most similar codebook vector is returned as the BMU.</p>
<p>We can test this function with the small contrived dataset prepared in the previous section.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cabd04598c609816704" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from math import sqrt

# calculate the Euclidean distance between two vectors
def euclidean_distance(row1, row2):
	distance = 0.0
	for i in range(len(row1)-1):
		distance += (row1[i] - row2[i])**2
	return sqrt(distance)

# Locate the best matching unit
def get_best_matching_unit(codebooks, test_row):
	distances = list()
	for codebook in codebooks:
		dist = euclidean_distance(codebook, test_row)
		distances.append((codebook, dist))
	distances.sort(key=lambda tup: tup[1])
	return distances[0][0]

# Test best matching unit function
dataset = [[2.7810836,2.550537003,0],
	[1.465489372,2.362125076,0],
	[3.396561688,4.400293529,0],
	[1.38807019,1.850220317,0],
	[3.06407232,3.005305973,0],
	[7.627531214,2.759262235,1],
	[5.332441248,2.088626775,1],
	[6.922596716,1.77106367,1],
	[8.675418651,-0.242068655,1],
	[7.673756466,3.508563011,1]]
test_row = dataset[0]
bmu = get_best_matching_unit(dataset, test_row)
print(bmu)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cabd04598c609816704-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04598c609816704-2">2</div><div class="crayon-num" data-line="crayon-5c0cabd04598c609816704-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04598c609816704-4">4</div><div class="crayon-num" data-line="crayon-5c0cabd04598c609816704-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04598c609816704-6">6</div><div class="crayon-num" data-line="crayon-5c0cabd04598c609816704-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04598c609816704-8">8</div><div class="crayon-num" data-line="crayon-5c0cabd04598c609816704-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04598c609816704-10">10</div><div class="crayon-num" data-line="crayon-5c0cabd04598c609816704-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04598c609816704-12">12</div><div class="crayon-num" data-line="crayon-5c0cabd04598c609816704-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04598c609816704-14">14</div><div class="crayon-num" data-line="crayon-5c0cabd04598c609816704-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04598c609816704-16">16</div><div class="crayon-num" data-line="crayon-5c0cabd04598c609816704-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04598c609816704-18">18</div><div class="crayon-num" data-line="crayon-5c0cabd04598c609816704-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04598c609816704-20">20</div><div class="crayon-num" data-line="crayon-5c0cabd04598c609816704-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04598c609816704-22">22</div><div class="crayon-num" data-line="crayon-5c0cabd04598c609816704-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04598c609816704-24">24</div><div class="crayon-num" data-line="crayon-5c0cabd04598c609816704-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04598c609816704-26">26</div><div class="crayon-num" data-line="crayon-5c0cabd04598c609816704-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04598c609816704-28">28</div><div class="crayon-num" data-line="crayon-5c0cabd04598c609816704-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04598c609816704-30">30</div><div class="crayon-num" data-line="crayon-5c0cabd04598c609816704-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04598c609816704-32">32</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cabd04598c609816704-1"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-v">sqrt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04598c609816704-2"> </div><div class="crayon-line" id="crayon-5c0cabd04598c609816704-3"><span class="crayon-p"># calculate the Euclidean distance between two vectors</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04598c609816704-4"><span class="crayon-e">def </span><span class="crayon-e">euclidean_distance</span><span class="crayon-sy">(</span><span class="crayon-v">row1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row2</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd04598c609816704-5"><span class="crayon-h"> </span><span class="crayon-v">distance</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04598c609816704-6"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">row1</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd04598c609816704-7"><span class="crayon-h"> </span><span class="crayon-v">distance</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">row1</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">row2</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04598c609816704-8"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">distance</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd04598c609816704-9"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04598c609816704-10"><span class="crayon-p"># Locate the best matching unit</span></div><div class="crayon-line" id="crayon-5c0cabd04598c609816704-11"><span class="crayon-e">def </span><span class="crayon-e">get_best_matching_unit</span><span class="crayon-sy">(</span><span class="crayon-v">codebooks</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04598c609816704-12"><span class="crayon-h"> </span><span class="crayon-v">distances</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd04598c609816704-13"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">codebook </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">codebooks</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04598c609816704-14"><span class="crayon-h"> </span><span class="crayon-v">dist</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">euclidean_distance</span><span class="crayon-sy">(</span><span class="crayon-v">codebook</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd04598c609816704-15"><span class="crayon-h"> </span><span class="crayon-v">distances</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">codebook</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dist</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04598c609816704-16"><span class="crayon-h"> </span><span class="crayon-v">distances</span><span class="crayon-sy">.</span><span class="crayon-e">sort</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-e">lambda </span><span class="crayon-v">tup</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">tup</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd04598c609816704-17"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">distances</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04598c609816704-18"> </div><div class="crayon-line" id="crayon-5c0cabd04598c609816704-19"><span class="crayon-p"># Test best matching unit function</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04598c609816704-20"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">2.7810836</span><span class="crayon-sy">,</span><span class="crayon-cn">2.550537003</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0cabd04598c609816704-21"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1.465489372</span><span class="crayon-sy">,</span><span class="crayon-cn">2.362125076</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04598c609816704-22"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3.396561688</span><span class="crayon-sy">,</span><span class="crayon-cn">4.400293529</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0cabd04598c609816704-23"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1.38807019</span><span class="crayon-sy">,</span><span class="crayon-cn">1.850220317</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04598c609816704-24"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3.06407232</span><span class="crayon-sy">,</span><span class="crayon-cn">3.005305973</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0cabd04598c609816704-25"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">7.627531214</span><span class="crayon-sy">,</span><span class="crayon-cn">2.759262235</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04598c609816704-26"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">5.332441248</span><span class="crayon-sy">,</span><span class="crayon-cn">2.088626775</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0cabd04598c609816704-27"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">6.922596716</span><span class="crayon-sy">,</span><span class="crayon-cn">1.77106367</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04598c609816704-28"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">8.675418651</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">0.242068655</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0cabd04598c609816704-29"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">7.673756466</span><span class="crayon-sy">,</span><span class="crayon-cn">3.508563011</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04598c609816704-30"><span class="crayon-v">test_row</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0cabd04598c609816704-31"><span class="crayon-v">bmu</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_best_matching_unit</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04598c609816704-32"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">bmu</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0018 seconds] -->
<p>Running this example prints the BMU in the dataset to the first record. As expected, the first record is the most similar to itself and is at the top of the list.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cabd04598e271449475" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
[2.7810836, 2.550537003, 0]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cabd04598e271449475-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cabd04598e271449475-1">[2.7810836, 2.550537003, 0]</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Make predictions with a set of codebook vectors is the same thing.</p>
<p>We use the 1-nearest neighbor algorithm. That is, for each new pattern we wish to make a prediction for, we locate the most similar codebook vector in the set and return its associated class value.</p>
<p>Now that we know how to get the best matching unit from a set of codebook vectors, we need to learn how to train them.</p>
<h3>3. Training Codebook Vectors</h3>
<p>The first step in training a set of codebook vectors is to initialize the set.</p>
<p>We can initialize it with patterns constructed from random features in the training dataset.</p>
<p>Below is a function named <strong>random_codebook()</strong> that implements this. Random input and output features are selected from the training data.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cabd045994479055977" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Create a random codebook vector
def random_codebook(train):
	n_records = len(train)
	n_features = len(train[0])
	codebook = [train[randrange(n_records)][i] for i in range(n_features)]
	return codebook</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cabd045994479055977-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045994479055977-2">2</div><div class="crayon-num" data-line="crayon-5c0cabd045994479055977-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045994479055977-4">4</div><div class="crayon-num" data-line="crayon-5c0cabd045994479055977-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045994479055977-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cabd045994479055977-1"><span class="crayon-p"># Create a random codebook vector</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045994479055977-2"><span class="crayon-e">def </span><span class="crayon-e">random_codebook</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd045994479055977-3"><span class="crayon-h"> </span><span class="crayon-v">n_records</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045994479055977-4"><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd045994479055977-5"><span class="crayon-h"> </span><span class="crayon-v">codebook</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-v">n_records</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045994479055977-6"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">codebook</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>After the codebook vectors are initialized to a random set, they must be adapted to best summarize the training data.</p>
<p>This is done iteratively.</p>
<ol>
<li><strong>Epochs</strong>: At the top level, the process is repeated for a fixed number of epochs or exposures of the training data.</li>
<li><strong>Training Dataset</strong>: Within an epoch, each training pattern is used one at a time to update the set of codebook vectors.</li>
<li><strong>Pattern Features</strong>: For a given training pattern, each feature of a best matching codebook vector is updated to move it closer or further away.</li>
</ol>
<p>The best matching unit is found for each training pattern and only this best matching unit is updated. The difference between the training pattern and the BMU is calculated as the error. The class values (assumed to be the last value in the list) are compared. If they match, the error is added to the BMU to bring it closer to the training pattern, otherwise, it is subtracted to push it further away.</p>
<p>The amount that the BMU is adjusted is controlled by a learning rate. This is a weighting on the amount of change made to all BMUs. For example, a learning rate of 0.3 means that BMUs are only moved by 30% of the error or difference between training patterns and BMUs.</p>
<p>Further, the learning rate is adjusted so that it has maximum effect in the first epoch and less effect as training continues until it has a minimal effect in the final epoch. This is called a linear decay learning rate schedule and can also be used in artificial neural networks.</p>
<p>We can summarize this decay in learning rate by epoch number as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cabd045996119623193" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
rate = learning_rate * (1.0 - (epoch/total_epochs))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cabd045996119623193-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cabd045996119623193-1">rate = learning_rate * (1.0 - (epoch/total_epochs))</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can test this equation by assuming a learning rate of 0.3 and 10 epochs. The learning rate each epoch would be as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cabd045998594518593" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Epoch		Effective Learning Rate
0		0.3
1		0.27
2		0.24
3		0.21
4		0.18
5		0.15
6		0.12
7		0.09
8		0.06
9		0.03</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cabd045998594518593-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045998594518593-2">2</div><div class="crayon-num" data-line="crayon-5c0cabd045998594518593-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045998594518593-4">4</div><div class="crayon-num" data-line="crayon-5c0cabd045998594518593-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045998594518593-6">6</div><div class="crayon-num" data-line="crayon-5c0cabd045998594518593-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045998594518593-8">8</div><div class="crayon-num" data-line="crayon-5c0cabd045998594518593-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd045998594518593-10">10</div><div class="crayon-num" data-line="crayon-5c0cabd045998594518593-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cabd045998594518593-1">Epoch		Effective Learning Rate</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045998594518593-2">0		0.3</div><div class="crayon-line" id="crayon-5c0cabd045998594518593-3">1		0.27</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045998594518593-4">2		0.24</div><div class="crayon-line" id="crayon-5c0cabd045998594518593-5">3		0.21</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045998594518593-6">4		0.18</div><div class="crayon-line" id="crayon-5c0cabd045998594518593-7">5		0.15</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045998594518593-8">6		0.12</div><div class="crayon-line" id="crayon-5c0cabd045998594518593-9">7		0.09</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd045998594518593-10">8		0.06</div><div class="crayon-line" id="crayon-5c0cabd045998594518593-11">9		0.03</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can put all of this together. Below is a function named <strong>train_codebooks()</strong> that implements the procedure for training a set of codebook vectors given a training dataset.</p>
<p>The function takes 3 additional arguments to the training dataset, the number of codebook vectors to create and train, the initial learning rate and the number of epochs for which to train the codebook vectors.</p>
<p>You can also see that the function keeps track of the sum squared error each epoch and prints a message showing the epoch number, effective learning rate and sum squared error score. This is helpful when debugging the training function or the specific configuration for a given prediction problem.</p>
<p>You can see the use of the <strong>random_codebook()</strong> to initialize the codebook vectors and the <strong>get_best_matching_unit()</strong> function to find the BMU for each training pattern within an epoch.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cabd04599a503784667" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Train a set of codebook vectors
def train_codebooks(train, n_codebooks, lrate, epochs):
	codebooks = [random_codebook(train) for i in range(n_codebooks)]
	for epoch in range(epochs):
		rate = lrate * (1.0-(epoch/float(epochs)))
		sum_error = 0.0
		for row in train:
			bmu = get_best_matching_unit(codebooks, row)
			for i in range(len(row)-1):
				error = row[i] - bmu[i]
				sum_error += error**2
				if bmu[-1] == row[-1]:
					bmu[i] += rate * error
				else:
					bmu[i] -= rate * error
		print('&gt;epoch=%d, lrate=%.3f, error=%.3f' % (epoch, rate, sum_error))
	return codebooks</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cabd04599a503784667-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599a503784667-2">2</div><div class="crayon-num" data-line="crayon-5c0cabd04599a503784667-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599a503784667-4">4</div><div class="crayon-num" data-line="crayon-5c0cabd04599a503784667-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599a503784667-6">6</div><div class="crayon-num" data-line="crayon-5c0cabd04599a503784667-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599a503784667-8">8</div><div class="crayon-num" data-line="crayon-5c0cabd04599a503784667-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599a503784667-10">10</div><div class="crayon-num" data-line="crayon-5c0cabd04599a503784667-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599a503784667-12">12</div><div class="crayon-num" data-line="crayon-5c0cabd04599a503784667-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599a503784667-14">14</div><div class="crayon-num" data-line="crayon-5c0cabd04599a503784667-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599a503784667-16">16</div><div class="crayon-num" data-line="crayon-5c0cabd04599a503784667-17">17</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cabd04599a503784667-1"><span class="crayon-p"># Train a set of codebook vectors</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599a503784667-2"><span class="crayon-e">def </span><span class="crayon-e">train_codebooks</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_codebooks</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lrate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd04599a503784667-3"><span class="crayon-h"> </span><span class="crayon-v">codebooks</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">random_codebook</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_codebooks</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599a503784667-4"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">epoch </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">epochs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd04599a503784667-5"><span class="crayon-h"> </span><span class="crayon-v">rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e ">lrate *</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-o">-</span><span class="crayon-sy">(</span><span class="crayon-v">epoch</span><span class="crayon-o">/</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">epochs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599a503784667-6"><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5c0cabd04599a503784667-7"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599a503784667-8"><span class="crayon-h"> </span><span class="crayon-v">bmu</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_best_matching_unit</span><span class="crayon-sy">(</span><span class="crayon-v">codebooks</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd04599a503784667-9"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599a503784667-10"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">bmu</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0cabd04599a503784667-11"><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">error*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599a503784667-12"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">bmu</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd04599a503784667-13"><span class="crayon-h"> </span><span class="crayon-v">bmu</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">rate *</span><span class="crayon-h"> </span><span class="crayon-e">error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599a503784667-14"><span class="crayon-e"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd04599a503784667-15"><span class="crayon-h"> </span><span class="crayon-v">bmu</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-=</span><span class="crayon-h"> </span><span class="crayon-e ">rate *</span><span class="crayon-h"> </span><span class="crayon-e">error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599a503784667-16"><span class="crayon-e"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;epoch=%d, lrate=%.3f, error=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd04599a503784667-17"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">codebooks</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0013 seconds] -->
<p>We can put this together with the examples above and learn a set of codebook vectors for our contrived dataset.</p>
<p>Below is the complete example.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cabd04599c202231739" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from math import sqrt
from random import randrange
from random import seed

# calculate the Euclidean distance between two vectors
def euclidean_distance(row1, row2):
	distance = 0.0
	for i in range(len(row1)-1):
		distance += (row1[i] - row2[i])**2
	return sqrt(distance)

# Locate the best matching unit
def get_best_matching_unit(codebooks, test_row):
	distances = list()
	for codebook in codebooks:
		dist = euclidean_distance(codebook, test_row)
		distances.append((codebook, dist))
	distances.sort(key=lambda tup: tup[1])
	return distances[0][0]

# Create a random codebook vector
def random_codebook(train):
	n_records = len(train)
	n_features = len(train[0])
	codebook = [train[randrange(n_records)][i] for i in range(n_features)]
	return codebook

# Train a set of codebook vectors
def train_codebooks(train, n_codebooks, lrate, epochs):
	codebooks = [random_codebook(train) for i in range(n_codebooks)]
	for epoch in range(epochs):
		rate = lrate * (1.0-(epoch/float(epochs)))
		sum_error = 0.0
		for row in train:
			bmu = get_best_matching_unit(codebooks, row)
			for i in range(len(row)-1):
				error = row[i] - bmu[i]
				sum_error += error**2
				if bmu[-1] == row[-1]:
					bmu[i] += rate * error
				else:
					bmu[i] -= rate * error
		print('&gt;epoch=%d, lrate=%.3f, error=%.3f' % (epoch, rate, sum_error))
	return codebooks

# Test the training function
seed(1)
dataset = [[2.7810836,2.550537003,0],
	[1.465489372,2.362125076,0],
	[3.396561688,4.400293529,0],
	[1.38807019,1.850220317,0],
	[3.06407232,3.005305973,0],
	[7.627531214,2.759262235,1],
	[5.332441248,2.088626775,1],
	[6.922596716,1.77106367,1],
	[8.675418651,-0.242068655,1],
	[7.673756466,3.508563011,1]]
learn_rate = 0.3
n_epochs = 10
n_codebooks = 2
codebooks = train_codebooks(dataset, n_codebooks, learn_rate, n_epochs)
print('Codebooks: %s' % codebooks)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-2">2</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-4">4</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-6">6</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-8">8</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-10">10</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-12">12</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-14">14</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-16">16</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-18">18</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-20">20</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-22">22</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-24">24</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-26">26</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-28">28</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-30">30</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-32">32</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-34">34</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-36">36</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-38">38</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-40">40</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-42">42</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-44">44</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-46">46</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-48">48</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-50">50</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-52">52</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-54">54</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-56">56</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-58">58</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-60">60</div><div class="crayon-num" data-line="crayon-5c0cabd04599c202231739-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599c202231739-62">62</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cabd04599c202231739-1"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-e">sqrt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-2"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randrange</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-3"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-v">seed</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-4"> </div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-5"><span class="crayon-p"># calculate the Euclidean distance between two vectors</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-6"><span class="crayon-e">def </span><span class="crayon-e">euclidean_distance</span><span class="crayon-sy">(</span><span class="crayon-v">row1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row2</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-7"><span class="crayon-h"> </span><span class="crayon-v">distance</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-8"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">row1</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-9"><span class="crayon-h"> </span><span class="crayon-v">distance</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">row1</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">row2</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-10"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">distance</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-11"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-12"><span class="crayon-p"># Locate the best matching unit</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-13"><span class="crayon-e">def </span><span class="crayon-e">get_best_matching_unit</span><span class="crayon-sy">(</span><span class="crayon-v">codebooks</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-14"><span class="crayon-h"> </span><span class="crayon-v">distances</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-15"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">codebook </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">codebooks</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-16"><span class="crayon-h"> </span><span class="crayon-v">dist</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">euclidean_distance</span><span class="crayon-sy">(</span><span class="crayon-v">codebook</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-17"><span class="crayon-h"> </span><span class="crayon-v">distances</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">codebook</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dist</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-18"><span class="crayon-h"> </span><span class="crayon-v">distances</span><span class="crayon-sy">.</span><span class="crayon-e">sort</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-e">lambda </span><span class="crayon-v">tup</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">tup</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-19"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">distances</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-20"> </div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-21"><span class="crayon-p"># Create a random codebook vector</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-22"><span class="crayon-e">def </span><span class="crayon-e">random_codebook</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-23"><span class="crayon-h"> </span><span class="crayon-v">n_records</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-24"><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-25"><span class="crayon-h"> </span><span class="crayon-v">codebook</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-v">n_records</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-26"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">codebook</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-27"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-28"><span class="crayon-p"># Train a set of codebook vectors</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-29"><span class="crayon-e">def </span><span class="crayon-e">train_codebooks</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_codebooks</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lrate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-30"><span class="crayon-h"> </span><span class="crayon-v">codebooks</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">random_codebook</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_codebooks</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-31"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">epoch </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">epochs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-32"><span class="crayon-h"> </span><span class="crayon-v">rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e ">lrate *</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-o">-</span><span class="crayon-sy">(</span><span class="crayon-v">epoch</span><span class="crayon-o">/</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">epochs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-33"><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-34"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-35"><span class="crayon-h"> </span><span class="crayon-v">bmu</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_best_matching_unit</span><span class="crayon-sy">(</span><span class="crayon-v">codebooks</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-36"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-37"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">bmu</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-38"><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">error*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-39"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">bmu</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-40"><span class="crayon-h"> </span><span class="crayon-v">bmu</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">rate *</span><span class="crayon-h"> </span><span class="crayon-e">error</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-41"><span class="crayon-e"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-42"><span class="crayon-h"> </span><span class="crayon-v">bmu</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-=</span><span class="crayon-h"> </span><span class="crayon-e ">rate *</span><span class="crayon-h"> </span><span class="crayon-e">error</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-43"><span class="crayon-e"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;epoch=%d, lrate=%.3f, error=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-44"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">codebooks</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-45"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-46"><span class="crayon-p"># Test the training function</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-47"><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-48"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">2.7810836</span><span class="crayon-sy">,</span><span class="crayon-cn">2.550537003</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-49"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1.465489372</span><span class="crayon-sy">,</span><span class="crayon-cn">2.362125076</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-50"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3.396561688</span><span class="crayon-sy">,</span><span class="crayon-cn">4.400293529</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-51"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1.38807019</span><span class="crayon-sy">,</span><span class="crayon-cn">1.850220317</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-52"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3.06407232</span><span class="crayon-sy">,</span><span class="crayon-cn">3.005305973</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-53"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">7.627531214</span><span class="crayon-sy">,</span><span class="crayon-cn">2.759262235</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-54"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">5.332441248</span><span class="crayon-sy">,</span><span class="crayon-cn">2.088626775</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-55"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">6.922596716</span><span class="crayon-sy">,</span><span class="crayon-cn">1.77106367</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-56"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">8.675418651</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">0.242068655</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-57"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">7.673756466</span><span class="crayon-sy">,</span><span class="crayon-cn">3.508563011</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-58"><span class="crayon-v">learn_rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-59"><span class="crayon-v">n_epochs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-60"><span class="crayon-v">n_codebooks</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line" id="crayon-5c0cabd04599c202231739-61"><span class="crayon-v">codebooks</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">train_codebooks</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_codebooks</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">learn_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epochs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599c202231739-62"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Codebooks: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">codebooks</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0034 seconds] -->
<p>Running this example trains a set of 2 codebook vectors for 10 epochs with an initial learning rate of 0.3. The details are printed each epoch and the set of 2 codebook vectors learned from the training data is displayed.</p>
<p>We can see that the changes to learning rate meet our expectations explored above for each epoch. We can also see that the sum squared error each epoch does continue to drop at the end of training and that there may be an opportunity to tune the example further to achieve less error.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cabd04599f643230154" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
&gt;epoch=0, lrate=0.300, error=43.270
&gt;epoch=1, lrate=0.270, error=30.403
&gt;epoch=2, lrate=0.240, error=27.146
&gt;epoch=3, lrate=0.210, error=26.301
&gt;epoch=4, lrate=0.180, error=25.537
&gt;epoch=5, lrate=0.150, error=24.789
&gt;epoch=6, lrate=0.120, error=24.058
&gt;epoch=7, lrate=0.090, error=23.346
&gt;epoch=8, lrate=0.060, error=22.654
&gt;epoch=9, lrate=0.030, error=21.982
Codebooks: [[2.432316086217663, 2.839821664184211, 0], [7.319592257892681, 1.97013382654341, 1]]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cabd04599f643230154-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599f643230154-2">2</div><div class="crayon-num" data-line="crayon-5c0cabd04599f643230154-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599f643230154-4">4</div><div class="crayon-num" data-line="crayon-5c0cabd04599f643230154-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599f643230154-6">6</div><div class="crayon-num" data-line="crayon-5c0cabd04599f643230154-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599f643230154-8">8</div><div class="crayon-num" data-line="crayon-5c0cabd04599f643230154-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd04599f643230154-10">10</div><div class="crayon-num" data-line="crayon-5c0cabd04599f643230154-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cabd04599f643230154-1">&gt;epoch=0, lrate=0.300, error=43.270</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599f643230154-2">&gt;epoch=1, lrate=0.270, error=30.403</div><div class="crayon-line" id="crayon-5c0cabd04599f643230154-3">&gt;epoch=2, lrate=0.240, error=27.146</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599f643230154-4">&gt;epoch=3, lrate=0.210, error=26.301</div><div class="crayon-line" id="crayon-5c0cabd04599f643230154-5">&gt;epoch=4, lrate=0.180, error=25.537</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599f643230154-6">&gt;epoch=5, lrate=0.150, error=24.789</div><div class="crayon-line" id="crayon-5c0cabd04599f643230154-7">&gt;epoch=6, lrate=0.120, error=24.058</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599f643230154-8">&gt;epoch=7, lrate=0.090, error=23.346</div><div class="crayon-line" id="crayon-5c0cabd04599f643230154-9">&gt;epoch=8, lrate=0.060, error=22.654</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd04599f643230154-10">&gt;epoch=9, lrate=0.030, error=21.982</div><div class="crayon-line" id="crayon-5c0cabd04599f643230154-11">Codebooks: [[2.432316086217663, 2.839821664184211, 0], [7.319592257892681, 1.97013382654341, 1]]</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Now that we know how to train a set of codebook vectors, let’s see how we can use this algorithm on a real dataset.</p>
<h3>4. Ionosphere Case Study</h3>
<p>In this section, we will apply the Learning Vector Quantization algorithm to the Ionosphere dataset.</p>
<p>The first step is to load the dataset and convert the loaded data to numbers that we can use with the Euclidean distance calculation. For this we will use the helper function <strong>load_csv()</strong> to load the file, <strong>str_column_to_float()</strong> to convert string numbers to floats and <strong>str_column_to_int()</strong> to convert the class column to integer values.</p>
<p>We will evaluate the algorithm using k-fold cross-validation with 5 folds. This means that 351/5=70.2 or just over 70 records will be in each fold. We will use the helper functions <strong>evaluate_algorithm()</strong> to evaluate the algorithm with cross-validation and <strong>accuracy_metric()</strong> to calculate the accuracy of predictions.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cabd0459a1422169750" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# LVQ for the Ionosphere Dataset
from random import seed
from random import randrange
from csv import reader
from math import sqrt

# Load a CSV file
def load_csv(filename):
	dataset = list()
	with open(filename, 'r') as file:
		csv_reader = reader(file)
		for row in csv_reader:
			if not row:
				continue
			dataset.append(row)
	return dataset

# Convert string column to float
def str_column_to_float(dataset, column):
	for row in dataset:
		row[column] = float(row[column].strip())

# Convert string column to integer
def str_column_to_int(dataset, column):
	class_values = [row[column] for row in dataset]
	unique = set(class_values)
	lookup = dict()
	for i, value in enumerate(unique):
		lookup[value] = i
	for row in dataset:
		row[column] = lookup[row[column]]
	return lookup

# Split a dataset into k folds
def cross_validation_split(dataset, n_folds):
	dataset_split = list()
	dataset_copy = list(dataset)
	fold_size = int(len(dataset) / n_folds)
	for i in range(n_folds):
		fold = list()
		while len(fold) &lt; fold_size:
			index = randrange(len(dataset_copy))
			fold.append(dataset_copy.pop(index))
		dataset_split.append(fold)
	return dataset_split

# Calculate accuracy percentage
def accuracy_metric(actual, predicted):
	correct = 0
	for i in range(len(actual)):
		if actual[i] == predicted[i]:
			correct += 1
	return correct / float(len(actual)) * 100.0

# Evaluate an algorithm using a cross validation split
def evaluate_algorithm(dataset, algorithm, n_folds, *args):
	folds = cross_validation_split(dataset, n_folds)
	scores = list()
	for fold in folds:
		train_set = list(folds)
		train_set.remove(fold)
		train_set = sum(train_set, [])
		test_set = list()
		for row in fold:
			row_copy = list(row)
			test_set.append(row_copy)
			row_copy[-1] = None
		predicted = algorithm(train_set, test_set, *args)
		actual = [row[-1] for row in fold]
		accuracy = accuracy_metric(actual, predicted)
		scores.append(accuracy)
	return scores

# calculate the Euclidean distance between two vectors
def euclidean_distance(row1, row2):
	distance = 0.0
	for i in range(len(row1)-1):
		distance += (row1[i] - row2[i])**2
	return sqrt(distance)

# Locate the best matching unit
def get_best_matching_unit(codebooks, test_row):
	distances = list()
	for codebook in codebooks:
		dist = euclidean_distance(codebook, test_row)
		distances.append((codebook, dist))
	distances.sort(key=lambda tup: tup[1])
	return distances[0][0]

# Make a prediction with codebook vectors
def predict(codebooks, test_row):
	bmu = get_best_matching_unit(codebooks, test_row)
	return bmu[-1]

# Create a random codebook vector
def random_codebook(train):
	n_records = len(train)
	n_features = len(train[0])
	codebook = [train[randrange(n_records)][i] for i in range(n_features)]
	return codebook

# Train a set of codebook vectors
def train_codebooks(train, n_codebooks, lrate, epochs):
	codebooks = [random_codebook(train) for i in range(n_codebooks)]
	for epoch in range(epochs):
		rate = lrate * (1.0-(epoch/float(epochs)))
		for row in train:
			bmu = get_best_matching_unit(codebooks, row)
			for i in range(len(row)-1):
				error = row[i] - bmu[i]
				if bmu[-1] == row[-1]:
					bmu[i] += rate * error
				else:
					bmu[i] -= rate * error
	return codebooks

# LVQ Algorithm
def learning_vector_quantization(train, test, n_codebooks, lrate, epochs):
	codebooks = train_codebooks(train, n_codebooks, lrate, epochs)
	predictions = list()
	for row in test:
		output = predict(codebooks, row)
		predictions.append(output)
	return(predictions)

# Test LVQ on Ionosphere dataset
seed(1)
# load and prepare data
filename = 'ionosphere.csv'
dataset = load_csv(filename)
for i in range(len(dataset[0])-1):
	str_column_to_float(dataset, i)
# convert class column to integers
str_column_to_int(dataset, len(dataset[0])-1)
# evaluate algorithm
n_folds = 5
learn_rate = 0.3
n_epochs = 50
n_codebooks = 20
scores = evaluate_algorithm(dataset, learning_vector_quantization, n_folds, n_codebooks, learn_rate, n_epochs)
print('Scores: %s' % scores)
print('Mean Accuracy: %.3f%%' % (sum(scores)/float(len(scores))))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-2">2</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-4">4</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-6">6</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-8">8</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-10">10</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-12">12</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-14">14</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-16">16</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-18">18</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-20">20</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-22">22</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-24">24</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-26">26</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-28">28</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-30">30</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-32">32</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-34">34</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-36">36</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-38">38</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-40">40</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-42">42</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-44">44</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-46">46</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-48">48</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-50">50</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-52">52</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-54">54</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-56">56</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-58">58</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-60">60</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-62">62</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-64">64</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-66">66</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-68">68</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-70">70</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-72">72</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-74">74</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-76">76</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-78">78</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-80">80</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-82">82</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-84">84</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-86">86</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-88">88</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-90">90</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-92">92</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-94">94</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-96">96</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-98">98</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-100">100</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-102">102</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-104">104</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-106">106</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-108">108</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-110">110</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-112">112</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-114">114</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-116">116</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-118">118</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-120">120</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-122">122</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-124">124</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-126">126</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-128">128</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-130">130</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-132">132</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-134">134</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-136">136</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-138">138</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-140">140</div><div class="crayon-num" data-line="crayon-5c0cabd0459a1422169750-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a1422169750-142">142</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-1"><span class="crayon-p"># LVQ for the Ionosphere Dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-2"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">seed</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-3"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randrange</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-4"><span class="crayon-e">from </span><span class="crayon-e">csv </span><span class="crayon-e">import </span><span class="crayon-e">reader</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-5"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-v">sqrt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-6"> </div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-7"><span class="crayon-p"># Load a CSV file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-8"><span class="crayon-e">def </span><span class="crayon-e">load_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-9"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-10"><span class="crayon-h"> </span><span class="crayon-e">with </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-11"><span class="crayon-h"> </span><span class="crayon-v">csv_reader</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">reader</span><span class="crayon-sy">(</span><span class="crayon-v">file</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-12"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">csv_reader</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-13"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-14"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-15"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-16"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-17"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-18"><span class="crayon-p"># Convert string column to float</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-19"><span class="crayon-e">def </span><span class="crayon-e">str_column_to_float</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">column</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-20"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-21"><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">strip</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-22"> </div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-23"><span class="crayon-p"># Convert string column to integer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-24"><span class="crayon-e">def </span><span class="crayon-e">str_column_to_int</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">column</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-25"><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-26"><span class="crayon-h"> </span><span class="crayon-v">unique</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">class_values</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-27"><span class="crayon-h"> </span><span class="crayon-v">lookup</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-28"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">value </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">unique</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-29"><span class="crayon-h"> </span><span class="crayon-v">lookup</span><span class="crayon-sy">[</span><span class="crayon-v">value</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">i</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-30"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-31"><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lookup</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-32"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">lookup</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-33"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-34"><span class="crayon-p"># Split a dataset into k folds</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-35"><span class="crayon-e">def </span><span class="crayon-e">cross_validation_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-36"><span class="crayon-h"> </span><span class="crayon-v">dataset_split</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-37"><span class="crayon-h"> </span><span class="crayon-v">dataset_copy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-38"><span class="crayon-h"> </span><span class="crayon-v">fold_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-39"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-40"><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-41"><span class="crayon-h"> </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">fold_size</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-42"><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset_copy</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-43"><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">dataset_copy</span><span class="crayon-sy">.</span><span class="crayon-e">pop</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-44"><span class="crayon-h"> </span><span class="crayon-v">dataset_split</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-45"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">dataset_split</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-46"> </div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-47"><span class="crayon-p"># Calculate accuracy percentage</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-48"><span class="crayon-e">def </span><span class="crayon-e">accuracy_metric</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-49"><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-50"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-51"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">actual</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-52"><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-53"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">100.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-54"> </div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-55"><span class="crayon-p"># Evaluate an algorithm using a cross validation split</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-56"><span class="crayon-e">def </span><span class="crayon-e">evaluate_algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">algorithm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">args</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-57"><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_validation_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-58"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-59"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">fold </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-60"><span class="crayon-h"> </span><span class="crayon-v">train_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">folds</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-61"><span class="crayon-h"> </span><span class="crayon-v">train_set</span><span class="crayon-sy">.</span><span class="crayon-e">remove</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-62"><span class="crayon-h"> </span><span class="crayon-v">train_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">train_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-63"><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-64"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-65"><span class="crayon-h"> </span><span class="crayon-v">row_copy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-66"><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row_copy</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-67"><span class="crayon-h"> </span><span class="crayon-v">row_copy</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-68"><span class="crayon-e"> </span><span class="crayon-v">predicted</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">train_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">args</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-69"><span class="crayon-h"> </span><span class="crayon-v">actual</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-70"><span class="crayon-h"> </span><span class="crayon-v">accuracy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">accuracy_metric</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-71"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">accuracy</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-72"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-73"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-74"><span class="crayon-p"># calculate the Euclidean distance between two vectors</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-75"><span class="crayon-e">def </span><span class="crayon-e">euclidean_distance</span><span class="crayon-sy">(</span><span class="crayon-v">row1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row2</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-76"><span class="crayon-h"> </span><span class="crayon-v">distance</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-77"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">row1</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-78"><span class="crayon-h"> </span><span class="crayon-v">distance</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">row1</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">row2</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-79"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">distance</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-80"> </div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-81"><span class="crayon-p"># Locate the best matching unit</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-82"><span class="crayon-e">def </span><span class="crayon-e">get_best_matching_unit</span><span class="crayon-sy">(</span><span class="crayon-v">codebooks</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-83"><span class="crayon-h"> </span><span class="crayon-v">distances</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-84"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">codebook </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">codebooks</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-85"><span class="crayon-h"> </span><span class="crayon-v">dist</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">euclidean_distance</span><span class="crayon-sy">(</span><span class="crayon-v">codebook</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-86"><span class="crayon-h"> </span><span class="crayon-v">distances</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">codebook</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dist</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-87"><span class="crayon-h"> </span><span class="crayon-v">distances</span><span class="crayon-sy">.</span><span class="crayon-e">sort</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-o">=</span><span class="crayon-e">lambda </span><span class="crayon-v">tup</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">tup</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-88"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">distances</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-89"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-90"><span class="crayon-p"># Make a prediction with codebook vectors</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-91"><span class="crayon-e">def </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">codebooks</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-92"><span class="crayon-h"> </span><span class="crayon-v">bmu</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_best_matching_unit</span><span class="crayon-sy">(</span><span class="crayon-v">codebooks</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-93"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">bmu</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-94"> </div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-95"><span class="crayon-p"># Create a random codebook vector</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-96"><span class="crayon-e">def </span><span class="crayon-e">random_codebook</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-97"><span class="crayon-h"> </span><span class="crayon-v">n_records</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-98"><span class="crayon-h"> </span><span class="crayon-v">n_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-99"><span class="crayon-h"> </span><span class="crayon-v">codebook</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-v">n_records</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_features</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-100"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">codebook</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-101"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-102"><span class="crayon-p"># Train a set of codebook vectors</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-103"><span class="crayon-e">def </span><span class="crayon-e">train_codebooks</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_codebooks</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lrate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-104"><span class="crayon-h"> </span><span class="crayon-v">codebooks</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">random_codebook</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_codebooks</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-105"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">epoch </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">epochs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-106"><span class="crayon-h"> </span><span class="crayon-v">rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e ">lrate *</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-o">-</span><span class="crayon-sy">(</span><span class="crayon-v">epoch</span><span class="crayon-o">/</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">epochs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-107"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-108"><span class="crayon-h"> </span><span class="crayon-v">bmu</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_best_matching_unit</span><span class="crayon-sy">(</span><span class="crayon-v">codebooks</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-109"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-110"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">bmu</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-111"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">bmu</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-112"><span class="crayon-h"> </span><span class="crayon-v">bmu</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">rate *</span><span class="crayon-h"> </span><span class="crayon-e">error</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-113"><span class="crayon-e"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-114"><span class="crayon-h"> </span><span class="crayon-v">bmu</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-=</span><span class="crayon-h"> </span><span class="crayon-e ">rate *</span><span class="crayon-h"> </span><span class="crayon-e">error</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-115"><span class="crayon-e"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">codebooks</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-116"> </div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-117"><span class="crayon-p"># LVQ Algorithm</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-118"><span class="crayon-e">def </span><span class="crayon-e">learning_vector_quantization</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_codebooks</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lrate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-119"><span class="crayon-h"> </span><span class="crayon-v">codebooks</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">train_codebooks</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_codebooks</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lrate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-120"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-121"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-122"><span class="crayon-h"> </span><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">codebooks</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-123"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-124"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-125"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-126"><span class="crayon-p"># Test LVQ on Ionosphere dataset</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-127"><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-128"><span class="crayon-p"># load and prepare data</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-129"><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'ionosphere.csv'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-130"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-131"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-132"><span class="crayon-h"> </span><span class="crayon-e">str_column_to_float</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-133"><span class="crayon-p"># convert class column to integers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-134"><span class="crayon-e">str_column_to_int</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-135"><span class="crayon-p"># evaluate algorithm</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-136"><span class="crayon-v">n_folds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-137"><span class="crayon-v">learn_rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-138"><span class="crayon-v">n_epochs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">50</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-139"><span class="crayon-v">n_codebooks</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">20</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-140"><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">learning_vector_quantization</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_codebooks</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">learn_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epochs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabd0459a1422169750-141"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Scores: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a1422169750-142"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Mean Accuracy: %.3f%%'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0073 seconds] -->
<p>Running this example prints the classification accuracy on each fold and the mean classification accuracy across all folds.</p>
<p>We can see that the accuracy of 87.143% is better than the baseline of 64.286%. We can also see that our library of 20 codebook vectors is far fewer than holding the entire training dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cabd0459a4972390373" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Scores: [90.0, 88.57142857142857, 84.28571428571429, 87.14285714285714, 85.71428571428571]
Mean Accuracy: 87.143%</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cabd0459a4972390373-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabd0459a4972390373-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cabd0459a4972390373-1">Scores: [90.0, 88.57142857142857, 84.28571428571429, 87.14285714285714, 85.71428571428571]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabd0459a4972390373-2">Mean Accuracy: 87.143%</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p></p>
<h2>Extensions</h2>
<p>This section lists extensions to the tutorial that you may wish to explore.</p>
<ul>
<li><strong>Tune Parameters</strong>. The parameters in the above example were not tuned, try different values to improve the classification accuracy.</li>
<li><strong>Different Distance Measures</strong>. Experiment with different distance measures such as Manhattan distance and Minkowski distance.</li>
<li><strong>Multiple-Pass LVQ</strong>. The codebook vectors may be updated by multiple training runs. Experiment by training with large learning rates followed by a large number of epochs with smaller learning rates to fine tune the codebooks.</li>
<li><strong>Update More BMUs</strong>. Experiment with selecting more than one BMU when training and pushing and pulling them away from the training data.</li>
<li><strong>More Problems</strong>. Apply LVQ to more classification problems on the UCI Machine Learning Repository.</li>
</ul>
<p style="text-align: center;"><strong>Did you explore any of these extensions?</strong><br/>
Share your experiences in the comments below.</p>
<h2>Review</h2>
<p>In this tutorial, you discovered how to implement the learning vector quantization algorithm from scratch in Python.</p>
<p>Specifically, you learned:</p>
<ul>
<li>How to calculate the distance between patterns and locate the best matching unit.</li>
<li>How to train a set of codebook vectors to best summarize the training dataset.</li>
<li>How to apply the learning vector quantization algorithm to a real predictive modeling problem.</li>
</ul>
<p style="text-align: center;"><strong>Do you have any questions?</strong><br/>
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="awac-wrapper"><div class="awac widget text-37"> <div class="textwidget"><p></p><div class="woo-sc-hr"></div><br/>
<center>
<h2 style="text-align: center;">Want to Code Algorithms in Python Without Math?</h2>
<p><a href="/machine-learning-algorithms-from-scratch/"><img align="left" alt="Machine Learning Algorithms From Scratch" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningAlgorithmsFromScratch-220.png" style="border: 0;"/></a></p>
<h4>Code Your First Algorithm in Minutes</h4>
<p style="text-align: center;">…with step-by-step tutorials on real-world datasets</p>
<p style="text-align: center;">Discover how in my new Ebook:<br/>
<a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Machine Learning Algorithms From Scratch</a></p>
<p style="text-align: center;">It covers <strong>18 tutorials</strong> with all the code for <strong>12 top algorithms</strong>, like:<br/>Linear Regression, k-Nearest Neighbors, Stochastic Gradient Descent and much more…</p>
<h4>Finally, Pull Back the Curtain on <br/>Machine Learning Algorithms</h4>
<p style="text-align: center;">Skip the Academics. Just Results.</p>
<p style="text-align: center;"><a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Click to learn more</a>.</p>
<p></p></center><br/>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-3346 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+To+Implement+Learning+Vector+Quantization+From+Scratch+With+Python&amp;url=https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
</section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/implement-perceptron-algorithm-scratch-python/" rel="prev"><i class="fa fa-angle-left"></i> How To Implement The Perceptron Algorithm From Scratch In Python</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" rel="next">How to Implement the Backpropagation Algorithm From Scratch In Python <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">45 Responses to <em>How To Implement Learning Vector Quantization From Scratch With Python</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-372801">
<div class="comment-container" id="li-comment-372801">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/46040c38d1cbe8ffcd3df6c8ba787951?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/46040c38d1cbe8ffcd3df6c8ba787951?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Glen</span>
<span class="date">November 29, 2016 at 6:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-372801" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Mr. Brownlee,<br/>
            I am used LVQ for my own dataset and it is giving me a Mean accuracy of 57.546%. Could you please suggest me the reasons for such low accuracy?</p>
<div class="reply">
<a aria-label="Reply to Glen" class="comment-reply-link" href="#comment-372801" onclick='return addComment.moveForm( "comment-372801", "372801", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-372824">
<div class="comment-container" id="li-comment-372824">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 29, 2016 at 8:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-372824" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, here are some generic suggestions to improve performance:<br/>
<a href="http://machinelearningmastery.com/machine-learning-performance-improvement-cheat-sheet/" rel="nofollow">http://machinelearningmastery.com/machine-learning-performance-improvement-cheat-sheet/</a></p>
<p>Here are some specific suggestions for LVQ (under Algorithm Usage Notes and Heuristics):<br/>
<a href="http://wekaclassalgos.sourceforge.net/" rel="nofollow">http://wekaclassalgos.sourceforge.net/</a></p>
<p>Also see:<br/>
<a href="http://cleveralgorithms.com/nature-inspired/neural/lvq.html" rel="nofollow">http://cleveralgorithms.com/nature-inspired/neural/lvq.html</a></p>
<p>I hope that helps as a start. The best source on this algorithm is Kohonen’s book.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-372824" onclick='return addComment.moveForm( "comment-372824", "372824", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-373294">
<div class="comment-container" id="li-comment-373294">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a2a2013604a2ae0123412245a6eaa202?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a2a2013604a2ae0123412245a6eaa202?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">barry</span>
<span class="date">December 2, 2016 at 1:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-373294" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I tried running it for the electricity data in this dataset: <a href="http://www.inescporto.pt/~jgama/ales/ales_5.html" rel="nofollow">http://www.inescporto.pt/~jgama/ales/ales_5.html</a></p>
<p>I have used the LVQ on an arff file and I am getting very bad performance from the algorithm. The accuracy is around 60%. Can you try to use the algorithm on this dataset and let me know your results or ways to improve it?</p>
<div class="reply">
<a aria-label="Reply to barry" class="comment-reply-link" href="#comment-373294" onclick='return addComment.moveForm( "comment-373294", "373294", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-373346">
<div class="comment-container" id="li-comment-373346">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 2, 2016 at 8:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-373346" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Here is a list of ideas you can try to improve performance:<br/>
<a href="http://machinelearningmastery.com/machine-learning-performance-improvement-cheat-sheet/" rel="nofollow">http://machinelearningmastery.com/machine-learning-performance-improvement-cheat-sheet/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-373346" onclick='return addComment.moveForm( "comment-373346", "373346", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-374414">
<div class="comment-container" id="li-comment-374414">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1bfa3b8d42a4ea4fd033769da2e521b6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1bfa3b8d42a4ea4fd033769da2e521b6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Curious_Kid</span>
<span class="date">December 9, 2016 at 4:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-374414" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, How can I use LVQ for doing the instance selection? Let’s say I want to select 5000 instances out of 15000 instances in the dataset? Please give some details.</p>
<div class="reply">
<a aria-label="Reply to Curious_Kid" class="comment-reply-link" href="#comment-374414" onclick='return addComment.moveForm( "comment-374414", "374414", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-374449">
<div class="comment-container" id="li-comment-374449">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 9, 2016 at 8:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-374449" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I’m not sure I understand your question, perhaps you could explain your intention or goal?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-374449" onclick='return addComment.moveForm( "comment-374449", "374449", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-374569">
<div class="comment-container" id="li-comment-374569">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/194aebb583ec43cd8f3e30009786a421?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/194aebb583ec43cd8f3e30009786a421?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Curious_Kid</span>
<span class="date">December 10, 2016 at 12:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-374569" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I wanted to know if we can use LVQ for instance selection. For e.g. if there are 15000 instances in my dataset and I only want to use 5000 of those instances as the training dataset. There are various ‘Instance Selection’ algorithms and I read that we can LVQ as well. But I am not sure how can I do that using the example that you have given above.</p>
<div class="reply">
<a aria-label="Reply to Curious_Kid" class="comment-reply-link" href="#comment-374569" onclick='return addComment.moveForm( "comment-374569", "374569", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-374614">
<div class="comment-container" id="li-comment-374614">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 10, 2016 at 8:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-374614" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I see, you mean to use LVQ as a data preparation or data cleaning method.</p>
<p>Perhaps. I have not done this, but I love the idea. Say use a threshold and only pick instances within a distance of codebook vectors.</p>
<p>Try it and see – you could be onto something very interesting there. Please share results if you get some!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-374614" onclick='return addComment.moveForm( "comment-374614", "374614", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-380165">
<div class="comment-container" id="li-comment-380165">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e2f6dbdc0b20b78b9df390884e21cfc3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e2f6dbdc0b20b78b9df390884e21cfc3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rahul</span>
<span class="date">January 5, 2017 at 2:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-380165" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Correct me if i am wrong.<br/>
What i understand from the question asked by curious_kid is :<br/>
Say we are given a dataset of 15000 instances..<br/>
example<br/>
0.000133,5,0.446809,0.089798,0.516662,0.003467,0.422915,0.414912,UP<br/>
0.000133,5,0.468085,0.047676,0.50476,0.003467,0.422915,0.414912,DOWN<br/>
0.000133,5,0.489362,0.146902,0.495537,0.003467,0.422915,0.414912,UP<br/>
0.000133,5,0.510638,0.193287,0.485272,0.003467,0.422915,0.414912,UP<br/>
.<br/>
.<br/>
.<br/>
………</p>
<p>Now he wants to use LVQ for instance selection(data pre processing). That means that the final result should have 5000 best instances which he can later use for classification.</p>
<p>Now as suggested by you, it could be done by taking some threshold and only pick instances within a distance of codebook vectors.</p>
<p>Doing this means that we are picking instances from the dataset on the basis of distance from the random codebooks generated. For e.g. in the function “get_best_matching_unit”, if we use this distance “distances.append((codebook, dist))”(line 86), then we won’t be training the codebooks as done in your code in the lines 109-114 and hence the main functionality of LVQ won’t be implemented(i.e. to train the random codebooks over epochs and adjusting bmu according to the error). If we do train the codebooks, then we will lose the distance values, because you are returning “distances[0][0]” in line 88. </p>
<p>The way I am thinking to approach this problem is by training the codebooks as done by you in the code and getting the final value of codebooks as done in line 115. Giving the value of n_codebooks as 5000, which will give us the best 5000 instances representing the data ( as one codebook represent an instance). And then use those 5000 instances for classification(using any classification algorithm). </p>
<p>Do you have any suggestions for this approach? I would be glad to know about it.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-380259">
<div class="comment-container" id="li-comment-380259">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 5, 2017 at 9:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-380259" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Interesting. Using LVQ this way is performing a type of outlier removal. </p>
<p>It will probably be quite effective at lower dimensions (in data without outlier observations) and fall apart at higher dimensions given the curse of dimensionality as distances and thresholds quickly become less meaningful. Generally LVQ and kNN breakdown at higher dimensions for the same reason:<br/>
<a href="https://en.wikipedia.org/wiki/Curse_of_dimensionality" rel="nofollow">https://en.wikipedia.org/wiki/Curse_of_dimensionality</a></p>
<p>Yes, the codebook vectors could be taken as centroids or a projection of the data. I would contrast this approach with projection methods like PCA, sammons mapping, tsne and others. Develop models from each projection and compare the performance on resulting models in a hold out dataset. </p>
<p>I’d love to hear about the results.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-374772">
<div class="comment-container" id="li-comment-374772">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/194aebb583ec43cd8f3e30009786a421?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/194aebb583ec43cd8f3e30009786a421?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Curious_Kid</span>
<span class="date">December 11, 2016 at 10:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-374772" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am thinking of using the euclidean distance between the codebook vectors and the new data and then calculate the mean of those distances which can act as the threshold. Then I am planning to select all those instances for which the euclidean distance is less than the calculated mean value. Does that sound good to you or do I need to think in a different way?</p>
<div class="reply">
<a aria-label="Reply to Curious_Kid" class="comment-reply-link" href="#comment-374772" onclick='return addComment.moveForm( "comment-374772", "374772", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-374873">
<div class="comment-container" id="li-comment-374873">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 12, 2016 at 6:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-374873" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Try and see.</p>
<p>It might be worth doing some simulations in 2d with contrived data.</p>
<p>Keep in mind that the more features – the higher the dimensionality and the curse of dimensionality will make the distances less and less meaningful.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-374873" onclick='return addComment.moveForm( "comment-374873", "374873", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-379475">
<div class="comment-container" id="li-comment-379475">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ce089e2af49fc021adefd673fd997348?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ce089e2af49fc021adefd673fd997348?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex</span>
<span class="date">January 2, 2017 at 3:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-379475" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I could not understand the functionality of “learning_vector_quantization” function. For e.g. where is it called in the code? And thus the “predict” function will not be called. I am getting the same result by commenting the predict function. Please correct me if I am wrong or if I am missing something here.</p>
<div class="reply">
<a aria-label="Reply to Alex" class="comment-reply-link" href="#comment-379475" onclick='return addComment.moveForm( "comment-379475", "379475", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-379623">
<div class="comment-container" id="li-comment-379623">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 3, 2017 at 7:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-379623" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Alex,</p>
<p>The “learning_vector_quantization” function is passed as an argument to the “evaluate_algorithm” function where it is called on line 68 of the final code listing.</p>
<p>Does that help? Try adding some print() debug statements to help you clarify further.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-379623" onclick='return addComment.moveForm( "comment-379623", "379623", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-380184">
<div class="comment-container" id="li-comment-380184">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ce089e2af49fc021adefd673fd997348?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ce089e2af49fc021adefd673fd997348?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex</span>
<span class="date">January 5, 2017 at 3:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-380184" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Jason. I understood it now. I have one more doubt. You have mentioned in your blog that once the codebook vectors are prepared, those codebook vectors are used to make predictions using 1-NN. But I am not able to understand that how are you doing it in your code. Please elaborate it a bit.</p>
<div class="reply">
<a aria-label="Reply to Alex" class="comment-reply-link" href="#comment-380184" onclick='return addComment.moveForm( "comment-380184", "380184", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-380266">
<div class="comment-container" id="li-comment-380266">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 5, 2017 at 9:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-380266" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Which part don’t you understand Alex?</p>
<p>The specific lines of code?</p>
<p>The kNN algorithm?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-380266" onclick='return addComment.moveForm( "comment-380266", "380266", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-387197">
<div class="comment-container" id="li-comment-387197">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4c5577772452883043b274fed3a32549?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4c5577772452883043b274fed3a32549?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Navin</span>
<span class="date">February 11, 2017 at 2:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-387197" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How can I implement this for large image databases. I have a folder full of images, how do I convert it into arrays so that I can implement lqv on it?</p>
<div class="reply">
<a aria-label="Reply to Navin" class="comment-reply-link" href="#comment-387197" onclick='return addComment.moveForm( "comment-387197", "387197", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-387340">
<div class="comment-container" id="li-comment-387340">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 12, 2017 at 5:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-387340" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry Navin, I do not have an example of working with raw images and LVQ.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-387340" onclick='return addComment.moveForm( "comment-387340", "387340", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-435328">
<div class="comment-container" id="li-comment-435328">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8c39d36692638df5111f9c6371a723a9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8c39d36692638df5111f9c6371a723a9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rahat</span>
<span class="date">April 18, 2018 at 5:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-435328" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Could you give any idea, how can I use your implementation for raw image.</p>
<div class="reply">
<a aria-label="Reply to Rahat" class="comment-reply-link" href="#comment-435328" onclick='return addComment.moveForm( "comment-435328", "435328", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-400386">
<div class="comment-container" id="li-comment-400386">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0d6dd87342050f7d6545e2e43edbca29?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0d6dd87342050f7d6545e2e43edbca29?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.inzarsalfikar.com" rel="external nofollow">inzar</a></span>
<span class="date">May 24, 2017 at 1:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-400386" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>can you share about kohonen Self-Organizing Maps metohod?<br/>
i really need to know how unsupervice learning in this methode work.<br/>
thanks, sorry about my bad english.</p>
<div class="reply">
<a aria-label="Reply to inzar" class="comment-reply-link" href="#comment-400386" onclick='return addComment.moveForm( "comment-400386", "400386", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-400406">
<div class="comment-container" id="li-comment-400406">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 24, 2017 at 4:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-400406" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, see here:<br/>
<a href="http://cleveralgorithms.com/nature-inspired/neural/som.html" rel="nofollow">http://cleveralgorithms.com/nature-inspired/neural/som.html</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-400406" onclick='return addComment.moveForm( "comment-400406", "400406", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-403184">
<div class="comment-container" id="li-comment-403184">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d7f84efb7555f271dc9ca9c88fb3bd2b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d7f84efb7555f271dc9ca9c88fb3bd2b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hugo</span>
<span class="date">June 20, 2017 at 5:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-403184" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I’ve created a LVQ network with trained data and two samples. It works, but how would I go about getting confidence values for untrained data? Ex. confidence of .98 means the sample is really close to the actual model of one of my samples.</p>
<div class="reply">
<a aria-label="Reply to Hugo" class="comment-reply-link" href="#comment-403184" onclick='return addComment.moveForm( "comment-403184", "403184", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-403257">
<div class="comment-container" id="li-comment-403257">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 21, 2017 at 8:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-403257" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good question, I don’t know. Off the cuff, I expect you could devise a confidence interval based on distance measures and the known extent of the domain.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-403257" onclick='return addComment.moveForm( "comment-403257", "403257", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-403407">
<div class="comment-container" id="li-comment-403407">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d7f84efb7555f271dc9ca9c88fb3bd2b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d7f84efb7555f271dc9ca9c88fb3bd2b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hugo</span>
<span class="date">June 22, 2017 at 1:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-403407" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for your reply. As I normalize all the values between 0 and 1, what would I use for a maximum? I tried using 1 – distance(bestUnitMatch, sample) and I get values of .96; and if that’s right I’m so amazed because I only trained the network with 30 samples for each 2 of the sets</p>
<div class="reply">
<a aria-label="Reply to Hugo" class="comment-reply-link" href="#comment-403407" onclick='return addComment.moveForm( "comment-403407", "403407", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-403491">
<div class="comment-container" id="li-comment-403491">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 23, 2017 at 6:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-403491" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps the largest distance between two points in your domain?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-403491" onclick='return addComment.moveForm( "comment-403491", "403491", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-417287">
<div class="comment-container" id="li-comment-417287">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8ec4f08d399db9d31ab58b6d6dc65986?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8ec4f08d399db9d31ab58b6d6dc65986?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Wija</span>
<span class="date">October 21, 2017 at 12:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-417287" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, I’m learning about LVQ right now on my studies, can you send me the whole code? so I can learn it better. It is for educational purpose. Thanks</p>
<div class="reply">
<a aria-label="Reply to Wija" class="comment-reply-link" href="#comment-417287" onclick='return addComment.moveForm( "comment-417287", "417287", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-417339">
<div class="comment-container" id="li-comment-417339">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 21, 2017 at 5:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-417339" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The whole code is available on the above post.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-417339" onclick='return addComment.moveForm( "comment-417339", "417339", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-418680">
<div class="comment-container" id="li-comment-418680">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4052858e67476ed2550f27adaa6abce4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4052858e67476ed2550f27adaa6abce4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sushanth Suresh</span>
<span class="date">November 1, 2017 at 4:24 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-418680" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>In the “train_codebooks()” function where is the “codebooks” variable getting updated?.Only the variable “bmu” is moved towards or away from the training vector which is  not used to update the “codebooks”  vector.</p>
<p>Please let me know if i am missing something.</p>
<p>Thank you</p>
<div class="reply">
<a aria-label="Reply to Sushanth Suresh" class="comment-reply-link" href="#comment-418680" onclick='return addComment.moveForm( "comment-418680", "418680", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-418725">
<div class="comment-container" id="li-comment-418725">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 2, 2017 at 5:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-418725" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Correct, only the BMU is being updated for each training pattern.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-418725" onclick='return addComment.moveForm( "comment-418725", "418725", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-418974">
<div class="comment-container" id="li-comment-418974">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4052858e67476ed2550f27adaa6abce4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4052858e67476ed2550f27adaa6abce4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sushanth Suresh</span>
<span class="date">November 4, 2017 at 8:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-418974" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I think that this updated BMU should be saved back into the codebooks to ensure the learning is taking place.</p>
<div class="reply">
<a aria-label="Reply to Sushanth Suresh" class="comment-reply-link" href="#comment-418974" onclick='return addComment.moveForm( "comment-418974", "418974", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-419030">
<div class="comment-container" id="li-comment-419030">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 5, 2017 at 5:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-419030" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No need, we have a copy of the reference to it.</p>
<p>Perhaps read up on “pass by reference” in modern programming languages?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-419030" onclick='return addComment.moveForm( "comment-419030", "419030", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-419052">
<div class="comment-container" id="li-comment-419052">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4052858e67476ed2550f27adaa6abce4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4052858e67476ed2550f27adaa6abce4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sushanth Suresh</span>
<span class="date">November 5, 2017 at 10:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-419052" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you clarifying it.<br/>
I was not aware of how “pass by reference” worked in python.</p>
<div class="reply">
<a aria-label="Reply to Sushanth Suresh" class="comment-reply-link" href="#comment-419052" onclick='return addComment.moveForm( "comment-419052", "419052", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-419104">
<div class="comment-container" id="li-comment-419104">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 6, 2017 at 4:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-419104" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No problem, it’s the same as most other languages.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-419104" onclick='return addComment.moveForm( "comment-419104", "419104", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-422444">
<div class="comment-container" id="li-comment-422444">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/eb8f6ba8c9c40ba96159ce3deafdf5f2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/eb8f6ba8c9c40ba96159ce3deafdf5f2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vinay</span>
<span class="date">December 8, 2017 at 1:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-422444" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Thank you for this lovely illustration. I am not a pro in python but have some questions.<br/>
On line 61, train_set.remove(fold) returns a funny error “ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()”<br/>
Is there any alternative around this. ? </p>
<p>Also i was wondering the reason for using lists and not numpy array like dataframe. Any particular reason?  </p>
<p>Thanks again.</p>
<div class="reply">
<a aria-label="Reply to Vinay" class="comment-reply-link" href="#comment-422444" onclick='return addComment.moveForm( "comment-422444", "422444", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-422463">
<div class="comment-container" id="li-comment-422463">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 8, 2017 at 5:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-422463" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I write the code using Python 2.7, perhaps double check your Python version?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-422463" onclick='return addComment.moveForm( "comment-422463", "422463", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-435893">
<div class="comment-container" id="li-comment-435893">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d099f93e362e51228120a2443e0e1d7b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d099f93e362e51228120a2443e0e1d7b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://fast.epizy.com" rel="external nofollow">m.ragab</a></span>
<span class="date">April 25, 2018 at 7:56 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-435893" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I get this errors when I run ? what I do ?</p>
<p>Python 3.6.3 (v3.6.3:2c5fed8, Oct  3 2017, 17:26:49) [MSC v.1900 32 bit (Intel)] on win32<br/>
Type “copyright”, “credits” or “license()” for more information.<br/>
&gt;&gt;&gt;<br/>
==== RESTART: H:/Ebooks/Ebooks/machine/project/New folder (3)/LVQ/lvq.py ====<br/>
Traceback (most recent call last):<br/>
  File “H:/Ebooks/Ebooks/machine/project/New folder (3)/LVQ/lvq.py”, line 140, in<br/>
    scores = evaluate_algorithm(dataset, learning_vector_quantization, n_folds, n_codebooks, learn_rate, n_epochs)<br/>
  File “H:/Ebooks/Ebooks/machine/project/New folder (3)/LVQ/lvq.py”, line 68, in evaluate_algorithm<br/>
    predicted = algorithm(train_set, test_set, *args)<br/>
  File “H:/Ebooks/Ebooks/machine/project/New folder (3)/LVQ/lvq.py”, line 119, in learning_vector_quantization<br/>
    codebooks = train_codebooks(train, n_codebooks, lrate, epochs)<br/>
  File “H:/Ebooks/Ebooks/machine/project/New folder (3)/LVQ/lvq.py”, line 110, in train_codebooks<br/>
    error = row[i] – bmu[i]<br/>
IndexError: list index out of range<br/>
&gt;&gt;&gt;</p>
<div class="reply">
<a aria-label="Reply to m.ragab" class="comment-reply-link" href="#comment-435893" onclick='return addComment.moveForm( "comment-435893", "435893", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-435958">
<div class="comment-container" id="li-comment-435958">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 26, 2018 at 6:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-435958" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The code assumes you are using Python version 2, you are using Python 3.</p>
<p>You can change your version of python or change the code.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435958" onclick='return addComment.moveForm( "comment-435958", "435958", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-435996">
<div class="comment-container" id="li-comment-435996">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d099f93e362e51228120a2443e0e1d7b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d099f93e362e51228120a2443e0e1d7b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://fast.epizy.com" rel="external nofollow">m.ragab</a></span>
<span class="date">April 26, 2018 at 2:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-435996" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I also get this error ! although I use python 2.7</p>
<p>Python 2.7.14 (v2.7.14:84471935ed, Sep 16 2017, 20:19:30) [MSC v.1500 32 bit (Intel)] on win32<br/>
Type “copyright”, “credits” or “license()” for more information.<br/>
&gt;&gt;&gt;<br/>
==== RESTART: H:/Ebooks/Ebooks/machine/project/New folder (3)/LVQ/lvq.py ====</p>
<p>Traceback (most recent call last):<br/>
  File “H:/Ebooks/Ebooks/machine/project/New folder (3)/LVQ/lvq.py”, line 140, in<br/>
    scores = evaluate_algorithm(dataset, learning_vector_quantization, n_folds, n_codebooks, learn_rate, n_epochs)<br/>
  File “H:/Ebooks/Ebooks/machine/project/New folder (3)/LVQ/lvq.py”, line 68, in evaluate_algorithm<br/>
    predicted = algorithm(train_set, test_set, *args)<br/>
  File “H:/Ebooks/Ebooks/machine/project/New folder (3)/LVQ/lvq.py”, line 119, in learning_vector_quantization<br/>
    codebooks = train_codebooks(train, n_codebooks, lrate, epochs)<br/>
  File “H:/Ebooks/Ebooks/machine/project/New folder (3)/LVQ/lvq.py”, line 110, in train_codebooks<br/>
    error = row[i] – bmu[i]<br/>
IndexError: list index out of range<br/>
&gt;&gt;&gt;</p>
<div class="reply">
<a aria-label="Reply to m.ragab" class="comment-reply-link" href="#comment-435996" onclick='return addComment.moveForm( "comment-435996", "435996", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-436004">
<div class="comment-container" id="li-comment-436004">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 26, 2018 at 3:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-436004" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Try these steps and let me know how you go:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436004" onclick='return addComment.moveForm( "comment-436004", "436004", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-436028">
<div class="comment-container" id="li-comment-436028">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c772af331fac8faa81d3e562f5597392?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c772af331fac8faa81d3e562f5597392?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">mo3az</span>
<span class="date">April 26, 2018 at 11:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-436028" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I can’t use the code without spaces and I can’t guess it as i’am not expert in python plz help me</p>
<div class="reply">
<a aria-label="Reply to mo3az" class="comment-reply-link" href="#comment-436028" onclick='return addComment.moveForm( "comment-436028", "436028", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-436059">
<div class="comment-container" id="li-comment-436059">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 27, 2018 at 6:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-436059" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This example will show you how to copy and paste code from the tutorial:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-copy-code-from-a-tutorial" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-copy-code-from-a-tutorial</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436059" onclick='return addComment.moveForm( "comment-436059", "436059", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-436379">
<div class="comment-container" id="li-comment-436379">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e20624f12254068c47a6ad9291dd53ca?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e20624f12254068c47a6ad9291dd53ca?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://fast.epizy.com/index.php" rel="external nofollow">m.ragab</a></span>
<span class="date">May 1, 2018 at 8:45 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-436379" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I get this error</p>
<p>    error = row[i] – bmu[i]<br/>
IndexError: list index out of range</p>
<div class="reply">
<a aria-label="Reply to m.ragab" class="comment-reply-link" href="#comment-436379" onclick='return addComment.moveForm( "comment-436379", "436379", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-436413">
<div class="comment-container" id="li-comment-436413">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 2, 2018 at 5:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-436413" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Are you using Python 2.7?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436413" onclick='return addComment.moveForm( "comment-436413", "436413", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-445060">
<div class="comment-container" id="li-comment-445060">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/72b6cec6b46ef04faf0aa0dc0fc43769?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/72b6cec6b46ef04faf0aa0dc0fc43769?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mahendhiran PD</span>
<span class="date">August 2, 2018 at 5:18 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-445060" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason</p>
<p>     I am Mahendhiran. I am trying to execute LVQ with audio data(MFCC). I am getting error like ‘row[column] = float(row[column].strip())</p>
<p>TypeError: ‘int’ object is not subscriptable’</p>
<p>   I request you to please help to solve this issue. I am using spyder(python 3.6).<br/>
Thanks in advance….</p>
<div class="reply">
<a aria-label="Reply to Mahendhiran PD" class="comment-reply-link" href="#comment-445060" onclick='return addComment.moveForm( "comment-445060", "445060", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-445104">
<div class="comment-container" id="li-comment-445104">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 3, 2018 at 5:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/#comment-445104" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The code was written for Python 2.7.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-445104" onclick='return addComment.moveForm( "comment-445104", "445104", "respond", "3346" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/implement-learning-vector-quantization-scratch-python/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="3346"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="6dfeb0bb3f"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="170"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery!</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Jason Brownlee, PhD
<br/>
I write tutorials to help developers (<i>like you</i>) get results with machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-19"> <div class="textwidget"><p></p><center><br/>
<strong>Code Algorithms From Scratch</strong><br/>
No libraries, just simple Python code.
<p><a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Click to Get Started Now!</a><br/>
<a href="/machine-learning-algorithms-from-scratch/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningAlgorithmsFromScratch-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch"><img alt="How to Develop a Neural Machine Translation System in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/01/How-to-Develop-a-Neural-Machine-Translation-System-in-Keras-150x150.jpg" title="How to Develop a Neural Machine Translation System from Scratch" width="45"/></a> <a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch">How to Develop a Neural Machine Translation System from Scratch</a>
<span class="meta">January 10, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning"><img alt="Difference Between Classification and Regression in Machine Learning" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/Difference-Between-Classification-and-Regression-in-Machine-Learning-150x150.jpg" title="Difference Between Classification and Regression in Machine Learning" width="45"/></a> <a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning">Difference Between Classification and Regression in Machine Learning</a>
<span class="meta">December 11, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem..."><img alt="So, You are Working on a Machine Learning Problem..." class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/So-You-are-Working-on-a-Machine-Learning-Problem...-150x150.jpg" title="So, You are Working on a Machine Learning Problem..." width="45"/></a> <a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem…">So, You are Working on a Machine Learning Problem…</a>
<span class="meta">April 4, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis"><img alt="Plot of the Multichannel Convolutional Neural Network For Text" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-150x150.png" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis" width="45"/></a> <a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis">How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis</a>
<span class="meta">January 12, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras"><img alt="How to Make Classification and Regression Predictions for Deep Learning Models in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/How-to-Make-Classification-and-Regression-Predictions-for-Deep-Learning-Models-in-Keras-150x150.jpg" title="How to Make Predictions with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras">How to Make Predictions with Keras</a>
<span class="meta">April 9, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)"><img alt="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/11-Classical-Time-Series-Forecasting-Methods-in-Python-Cheat-Sheet-150x150.jpg" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)">11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)</a>
<span class="meta">August 6, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras"><img alt="How to Visualize a Deep Learning Neural Network Model in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/How-to-Visualize-a-Deep-Learning-Neural-Network-Model-in-Keras-150x150.jpg" title="How to Visualize a Deep Learning Neural Network Model in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras">How to Visualize a Deep Learning Neural Network Model in Keras</a>
<span class="meta">December 13, 2017</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> <div class="widget_text widget widget_custom_html" id="custom_html-2"><h3>You might also like…</h3><div class="textwidget custom-html-widget"><ul>
<li><a href="/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Install Python for Machine Learning</a></li>
<li><a href="/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python</a></li>
<li><a href="/tutorial-first-neural-network-python-keras/">Your First Neural Network in Python</a></li>
<li><a href="/how-to-run-your-first-classifier-in-weka/">Your First Classifier in Weka</a></li>
<li><a href="/arima-for-time-series-forecasting-with-python/">Your First Time Series Forecasting Project</a></li>
</ul></div></div></aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/disclaimer/">Disclaimer</a> | 
<a href="/terms-of-service/">Terms</a> | 
<a href="/contact/">Contact</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.8" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.0.5" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.8" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.1" type="text/javascript"></script>
</body>
</html>