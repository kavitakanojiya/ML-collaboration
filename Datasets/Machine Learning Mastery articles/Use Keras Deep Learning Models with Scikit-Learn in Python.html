<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v9.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Use Keras Deep Learning Models with Scikit-Learn in Python</title>
<link href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="Use Keras Deep Learning Models with Scikit-Learn in Python" property="og:title"/>
<meta content="Keras is one of the most popular deep learning libraries in Python for research and development because of its simplicity and ease of use. The scikit-learn library is the most popular library for general machine learning in Python. In this post you will discover how you can use deep learning models from Keras with the …" property="og:description"/>
<meta content="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="https://www.facebook.com/jason.brownlee.39" property="article:author"/>
<meta content="Deep Learning" property="article:section"/>
<meta content="2016-05-30T19:00:28+00:00" property="article:published_time"/>
<meta content="2018-03-10T21:26:53+00:00" property="article:modified_time"/>
<meta content="2018-03-10T21:26:53+00:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Use-Keras-Deep-Learning-Models-with-Scikit-Learn-in-Python.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Use-Keras-Deep-Learning-Models-with-Scikit-Learn-in-Python.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="427" property="og:image:height"/>
<meta content="Use Keras Deep Learning Models with Scikit-Learn in Python" property="og:image:alt"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"https:\/\/machinelearningmastery.com\/#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/feed/" rel="alternate" title="Machine Learning Mastery » Use Keras Deep Learning Models with Scikit-Learn in Python Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<style media="all" type="text/css">
.wpautoterms-footer{background-color:#ffffff;text-align:center;}
.wpautoterms-footer a{color:#000000;font-family:Arial, sans-serif;font-size:14px;}
.wpautoterms-footer .separator{color:#cccccc;font-family:Arial, sans-serif;font-size:14px;}</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/auto-terms-of-service-and-privacy-policy/css/wpautoterms.css?ver=4.9.8" id="wpautoterms_css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.0.5" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/css/front.css?ver=2.0.20" id="ssb-front-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/ewd-ufaq-styles.css?ver=4.9.8" id="ewd-ufaq-style-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/rrssb-min.css?ver=4.9.8" id="ewd-ufaq-rrssb-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.8" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=2.0.20" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.8" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.8" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=2564" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fuse-keras-deep-learning-models-scikit-learn-python%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fuse-keras-deep-learning-models-scikit-learn-python%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<style media="screen">

        .simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
      margin: ;
    }
         /*inline margin*/
    
  
  
  
  
  
          .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
         margin: ;
     }

          /*margin-digbar*/

  
  
  
  
 
   
   

</style>
<script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#4c89bf; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#4c89bf;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#4c89bf!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#ffffff;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-2564 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/icon-100x100.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-32"> <div class="textwidget"><p>Want help with deep learning? <a href="https://machinelearningmastery.lpages.co/deep-learning-with-python-mini-course/">Take the FREE Mini-Course</a></p>
</div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<input name="post_type" type="hidden" value="post"/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Main Menu</h3><ul class="nav fl" id="main-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503" id="menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Start Here</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501" id="menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506" id="menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6508" id="menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (Keras)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511" id="menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509" id="menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515" id="menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">Deep Learning for NLP</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512" id="menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Understand Algorithms</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507" id="menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms (Python)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6513" id="menu-item-6513"><a href="https://machinelearningmastery.com/category/machine-learning-process/">Machine Learning Process</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516" id="menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517" id="menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522" id="menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6518" id="menu-item-6518"><a href="https://machinelearningmastery.com/category/start-machine-learning/">Getting Started</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510" id="menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519" id="menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistical Methods</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520" id="menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Time Series (introductory)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523" id="menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6514" id="menu-item-6514"><a href="https://machinelearningmastery.com/category/machine-learning-resources/">Resources</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502" id="menu-item-6502"><a href="https://machinelearningmastery.com/products/">Ebooks</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500" id="menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504" id="menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505" id="menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-2564 post type-post status-publish format-standard has-post-thumbnail hentry category-deep-learning">
<header>
<h1 class="title entry-title">Use Keras Deep Learning Models with Scikit-Learn in Python</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-05-31T05:00:28+1100">May 31, 2016</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/deep-learning/" title="View all items in Deep Learning">Deep Learning</a></span> </div>
<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-2564 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=Use+Keras+Deep+Learning+Models+with+Scikit-Learn+in+Python&amp;url=https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
<p>Keras is one of the most popular deep learning libraries in Python for research and development because of its simplicity and ease of use.</p>
<p>The <a href="http://machinelearningmastery.com/a-gentle-introduction-to-scikit-learn-a-python-machine-learning-library/">scikit-learn</a> library is the most popular library for general machine learning in Python.</p>
<p>In this post you will discover how you can use deep learning models from Keras with the scikit-learn library in Python.</p>
<p>This will allow you to leverage the power of the scikit-learn library for tasks like model evaluation and model hyper-parameter optimization.</p>
<p>Let’s get started.</p>
<ul>
<li><strong>Update</strong>: For a larger example of tuning hyperparameters with Keras, see the post:
<ul>
<li><a href="http://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/">How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras</a></li>
</ul>
</li>
<li><strong>Update Oct/2016</strong>: Updated examples for Keras 1.1.0 and scikit-learn v0.18.</li>
<li><strong>Update Jan/2017</strong>: Fixed a bug in printing the results of the grid search.</li>
<li><strong>Update Mar/2017</strong>: Updated example for Keras 2.0.2, TensorFlow 1.0.1 and Theano 0.9.0.</li>
<li><strong>Update Mar/2018</strong>: Added alternate link to download the dataset as the original appears to have been taken down.</li>
</ul>
<div class="wp-caption aligncenter" id="attachment_2566" style="width: 650px"><img alt="Use Keras Deep Learning Models with Scikit-Learn in Python" class="size-full wp-image-2566" height="427" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Use-Keras-Deep-Learning-Models-with-Scikit-Learn-in-Python.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Use-Keras-Deep-Learning-Models-with-Scikit-Learn-in-Python.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Use-Keras-Deep-Learning-Models-with-Scikit-Learn-in-Python-300x200.jpg 300w" width="640"/><p class="wp-caption-text">Use Keras Deep Learning Models with Scikit-Learn in Python<br/>Photo by <a href="https://www.flickr.com/photos/cogdog/7519589420/">Alan Levine</a>, some rights reserved.</p></div>
<h2>Overview</h2>
<p>Keras is a popular library for deep learning in Python, but the focus of the library is deep learning. In fact it strives for minimalism, focusing on only what you need to quickly and simply define and build deep learning models.</p>
<p>The scikit-learn library in Python is built upon the SciPy stack for efficient numerical computation. It is a fully featured library for general machine learning and provides many utilities that are useful in the development of deep learning models. Not least:</p>
<ul>
<li>Evaluation of models using resampling methods like k-fold cross validation.</li>
<li>Efficient search and evaluation of model hyper-parameters.</li>
</ul>
<p>The Keras library provides a convenient wrapper for deep learning models to be used as classification or regression estimators in scikit-learn.</p>
<p>In the next sections, we will work through examples of using the KerasClassifier wrapper for a classification neural network created in Keras and used in the scikit-learn library.</p>
<p>The test problem is the <a href="http://archive.ics.uci.edu/ml/datasets/Pima+Indians+Diabetes">Pima Indians onset of diabetes classification dataset</a>. This is a small dataset with all numerical attributes that is easy to work with. <a href="http://archive.ics.uci.edu/ml/machine-learning-databases/pima-indians-diabetes/pima-indians-diabetes.data">Download the dataset</a> and place it in your currently working directly with the name <strong>pima-indians-diabetes.csv </strong>(update: <a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/pima-indians-diabetes.data.csv">download from here</a>).</p>
<p>The following examples assume you have successfully installed Keras and scikit-learn.</p>
<p></p><div class="woo-sc-hr"></div>
<center>
<h3>Need help with Deep Learning in Python?</h3>
<p>Take my free 2-week email course and discover MLPs, CNNs and LSTMs (with code).</p>
<p>Click to sign-up now and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" rel="noopener" style="color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.247059) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.498039) 0px 1px 3px inset, rgba(0, 0, 0, 0.498039) 0px 1px 3px; background: #ffce0a;" target="_blank">Start Your FREE Mini-Course Now!</a> <script data-config="%7B%7D" data-leadbox="142d6e873f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" src="https://machinelearningmastery.leadpages.co/leadbox-1463166699.js" type="text/javascript"></script></p>
</center>
<p></p><div class="woo-sc-hr"></div>
<h2>Evaluate Deep Learning Models with Cross Validation</h2>
<p>The KerasClassifier and KerasRegressor classes in Keras take an argument <strong>build_fn</strong> which is the name of the function to call to get your model.</p>
<p>You must define a function called whatever you like that defines your model, compiles it and returns it.</p>
<p>In the example, below we define a function <strong>create_model()</strong> that create a simple multi-layer neural network for the problem.</p>
<p>We pass this function name to the KerasClassifier class by the <strong>build_fn</strong> argument. We also pass in additional arguments of <strong>nb_epoch=150</strong> and <strong>batch_size=10</strong>. These are automatically bundled up and passed on to the <strong>fit()</strong> function which is called internally by the KerasClassifier class.</p>
<p>In this example, we use the scikit-learn <a href="http://scikit-learn.org/stable/modules/generated/sklearn.cross_validation.StratifiedKFold.html">StratifiedKFold</a> to perform 10-fold stratified cross-validation. This is a resampling technique that can provide a robust estimate of the performance of a machine learning model on unseen data.</p>
<p>We use the scikit-learn function <strong>cross_val_score()</strong> to evaluate our model using the cross-validation scheme and print the results.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa24457cc860664182" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# MLP for Pima Indians Dataset with 10-fold cross validation via sklearn
from keras.models import Sequential
from keras.layers import Dense
from keras.wrappers.scikit_learn import KerasClassifier
from sklearn.model_selection import StratifiedKFold
from sklearn.model_selection import cross_val_score
import numpy

# Function to create model, required for KerasClassifier
def create_model():
	# create model
	model = Sequential()
	model.add(Dense(12, input_dim=8, activation='relu'))
	model.add(Dense(8, activation='relu'))
	model.add(Dense(1, activation='sigmoid'))
	# Compile model
	model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
	return model

# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)
# load pima indians dataset
dataset = numpy.loadtxt("pima-indians-diabetes.csv", delimiter=",")
# split into input (X) and output (Y) variables
X = dataset[:,0:8]
Y = dataset[:,8]
# create model
model = KerasClassifier(build_fn=create_model, epochs=150, batch_size=10, verbose=0)
# evaluate using 10-fold cross validation
kfold = StratifiedKFold(n_splits=10, shuffle=True, random_state=seed)
results = cross_val_score(model, X, Y, cv=kfold)
print(results.mean())</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa24457cc860664182-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457cc860664182-2">2</div><div class="crayon-num" data-line="crayon-5c0caa24457cc860664182-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457cc860664182-4">4</div><div class="crayon-num" data-line="crayon-5c0caa24457cc860664182-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457cc860664182-6">6</div><div class="crayon-num" data-line="crayon-5c0caa24457cc860664182-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457cc860664182-8">8</div><div class="crayon-num" data-line="crayon-5c0caa24457cc860664182-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457cc860664182-10">10</div><div class="crayon-num" data-line="crayon-5c0caa24457cc860664182-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457cc860664182-12">12</div><div class="crayon-num" data-line="crayon-5c0caa24457cc860664182-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457cc860664182-14">14</div><div class="crayon-num" data-line="crayon-5c0caa24457cc860664182-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457cc860664182-16">16</div><div class="crayon-num" data-line="crayon-5c0caa24457cc860664182-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457cc860664182-18">18</div><div class="crayon-num" data-line="crayon-5c0caa24457cc860664182-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457cc860664182-20">20</div><div class="crayon-num" data-line="crayon-5c0caa24457cc860664182-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457cc860664182-22">22</div><div class="crayon-num" data-line="crayon-5c0caa24457cc860664182-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457cc860664182-24">24</div><div class="crayon-num" data-line="crayon-5c0caa24457cc860664182-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457cc860664182-26">26</div><div class="crayon-num" data-line="crayon-5c0caa24457cc860664182-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457cc860664182-28">28</div><div class="crayon-num" data-line="crayon-5c0caa24457cc860664182-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457cc860664182-30">30</div><div class="crayon-num" data-line="crayon-5c0caa24457cc860664182-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457cc860664182-32">32</div><div class="crayon-num" data-line="crayon-5c0caa24457cc860664182-33">33</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa24457cc860664182-1"><span class="crayon-p"># MLP for Pima Indians Dataset with 10-fold cross validation via sklearn</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457cc860664182-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5c0caa24457cc860664182-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457cc860664182-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">wrappers</span><span class="crayon-sy">.</span><span class="crayon-e">scikit_learn </span><span class="crayon-e">import </span><span class="crayon-e">KerasClassifier</span></div><div class="crayon-line" id="crayon-5c0caa24457cc860664182-5"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">StratifiedKFold</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457cc860664182-6"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">cross_val_score</span></div><div class="crayon-line" id="crayon-5c0caa24457cc860664182-7"><span class="crayon-e">import </span><span class="crayon-v">numpy</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457cc860664182-8"> </div><div class="crayon-line" id="crayon-5c0caa24457cc860664182-9"><span class="crayon-p"># Function to create model, required for KerasClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457cc860664182-10"><span class="crayon-e">def </span><span class="crayon-e">create_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa24457cc860664182-11"><span class="crayon-h"> </span><span class="crayon-p"># create model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457cc860664182-12"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa24457cc860664182-13"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457cc860664182-14"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa24457cc860664182-15"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457cc860664182-16"><span class="crayon-h"> </span><span class="crayon-p"># Compile model</span></div><div class="crayon-line" id="crayon-5c0caa24457cc860664182-17"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457cc860664182-18"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div><div class="crayon-line" id="crayon-5c0caa24457cc860664182-19"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457cc860664182-20"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line" id="crayon-5c0caa24457cc860664182-21"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457cc860664182-22"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa24457cc860664182-23"><span class="crayon-p"># load pima indians dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457cc860664182-24"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">"pima-indians-diabetes.csv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">","</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa24457cc860664182-25"><span class="crayon-p"># split into input (X) and output (Y) variables</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457cc860664182-26"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa24457cc860664182-27"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457cc860664182-28"><span class="crayon-p"># create model</span></div><div class="crayon-line" id="crayon-5c0caa24457cc860664182-29"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">create_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">150</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457cc860664182-30"><span class="crayon-p"># evaluate using 10-fold cross validation</span></div><div class="crayon-line" id="crayon-5c0caa24457cc860664182-31"><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">StratifiedKFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_splits</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457cc860664182-32"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-v">kfold</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa24457cc860664182-33"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0017 seconds] -->
<p>Running the example displays the skill of the model for each epoch. A total of 10 models are created and evaluated and the final average accuracy is displayed.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa24457d5691231466" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
0.646838691487</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa24457d5691231466-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa24457d5691231466-1">0.646838691487</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p></p>
<h2>Grid Search Deep Learning Model Parameters</h2>
<p>The previous example showed how easy it is to wrap your deep learning model from Keras and use it in functions from the scikit-learn library.</p>
<p>In this example, we go a step further. The function that we specify to the <strong>build_fn</strong> argument when creating the KerasClassifier wrapper can take arguments. We can use these arguments to further customize the construction of the model. In addition, we know we can provide arguments to the <strong>fit()</strong> function.</p>
<p>In this example, we use a grid search to evaluate different configurations for our neural network model and report on the combination that provides the best-estimated performance.</p>
<p>The <strong>create_model()</strong> function is defined to take two arguments optimizer and init, both of which must have default values. This will allow us to evaluate the effect of using different optimization algorithms and weight initialization schemes for our network.</p>
<p>After creating our model, we define arrays of values for the parameter we wish to search, specifically:</p>
<ul>
<li>Optimizers for searching different weight values.</li>
<li>Initializers for preparing the network weights using different schemes.</li>
<li>Epochs for training the model for a different number of exposures to the training dataset.</li>
<li>Batches for varying the number of samples before a weight update.</li>
</ul>
<p>The options are specified into a dictionary and passed to the configuration of the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.grid_search.GridSearchCV.html">GridSearchCV</a> scikit-learn class. This class will evaluate a version of our neural network model for each combination of parameters (2 x 3 x 3 x 3 for the combinations of optimizers, initializations, epochs and batches). Each combination is then evaluated using the default of 3-fold stratified cross validation.</p>
<p>That is a lot of models and a lot of computation. This is not a scheme that you want to use lightly because of the time it will take. It may be useful for you to design small experiments with a smaller subset of your data that will complete in a reasonable time. This is reasonable in this case because of the small network and the small dataset (less than 1000 instances and 9 attributes).</p>
<p>Finally, the performance and combination of configurations for the best model are displayed, followed by the performance of all combinations of parameters.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa24457d8349554502" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# MLP for Pima Indians Dataset with grid search via sklearn
from keras.models import Sequential
from keras.layers import Dense
from keras.wrappers.scikit_learn import KerasClassifier
from sklearn.model_selection import GridSearchCV
import numpy

# Function to create model, required for KerasClassifier
def create_model(optimizer='rmsprop', init='glorot_uniform'):
	# create model
	model = Sequential()
	model.add(Dense(12, input_dim=8, kernel_initializer=init, activation='relu'))
	model.add(Dense(8, kernel_initializer=init, activation='relu'))
	model.add(Dense(1, kernel_initializer=init, activation='sigmoid'))
	# Compile model
	model.compile(loss='binary_crossentropy', optimizer=optimizer, metrics=['accuracy'])
	return model

# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)
# load pima indians dataset
dataset = numpy.loadtxt("pima-indians-diabetes.csv", delimiter=",")
# split into input (X) and output (Y) variables
X = dataset[:,0:8]
Y = dataset[:,8]
# create model
model = KerasClassifier(build_fn=create_model, verbose=0)
# grid search epochs, batch size and optimizer
optimizers = ['rmsprop', 'adam']
init = ['glorot_uniform', 'normal', 'uniform']
epochs = [50, 100, 150]
batches = [5, 10, 20]
param_grid = dict(optimizer=optimizers, epochs=epochs, batch_size=batches, init=init)
grid = GridSearchCV(estimator=model, param_grid=param_grid)
grid_result = grid.fit(X, Y)
# summarize results
print("Best: %f using %s" % (grid_result.best_score_, grid_result.best_params_))
means = grid_result.cv_results_['mean_test_score']
stds = grid_result.cv_results_['std_test_score']
params = grid_result.cv_results_['params']
for mean, stdev, param in zip(means, stds, params):
	print("%f (%f) with: %r" % (mean, stdev, param))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa24457d8349554502-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457d8349554502-2">2</div><div class="crayon-num" data-line="crayon-5c0caa24457d8349554502-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457d8349554502-4">4</div><div class="crayon-num" data-line="crayon-5c0caa24457d8349554502-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457d8349554502-6">6</div><div class="crayon-num" data-line="crayon-5c0caa24457d8349554502-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457d8349554502-8">8</div><div class="crayon-num" data-line="crayon-5c0caa24457d8349554502-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457d8349554502-10">10</div><div class="crayon-num" data-line="crayon-5c0caa24457d8349554502-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457d8349554502-12">12</div><div class="crayon-num" data-line="crayon-5c0caa24457d8349554502-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457d8349554502-14">14</div><div class="crayon-num" data-line="crayon-5c0caa24457d8349554502-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457d8349554502-16">16</div><div class="crayon-num" data-line="crayon-5c0caa24457d8349554502-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457d8349554502-18">18</div><div class="crayon-num" data-line="crayon-5c0caa24457d8349554502-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457d8349554502-20">20</div><div class="crayon-num" data-line="crayon-5c0caa24457d8349554502-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457d8349554502-22">22</div><div class="crayon-num" data-line="crayon-5c0caa24457d8349554502-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457d8349554502-24">24</div><div class="crayon-num" data-line="crayon-5c0caa24457d8349554502-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457d8349554502-26">26</div><div class="crayon-num" data-line="crayon-5c0caa24457d8349554502-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457d8349554502-28">28</div><div class="crayon-num" data-line="crayon-5c0caa24457d8349554502-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457d8349554502-30">30</div><div class="crayon-num" data-line="crayon-5c0caa24457d8349554502-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457d8349554502-32">32</div><div class="crayon-num" data-line="crayon-5c0caa24457d8349554502-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457d8349554502-34">34</div><div class="crayon-num" data-line="crayon-5c0caa24457d8349554502-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457d8349554502-36">36</div><div class="crayon-num" data-line="crayon-5c0caa24457d8349554502-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457d8349554502-38">38</div><div class="crayon-num" data-line="crayon-5c0caa24457d8349554502-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457d8349554502-40">40</div><div class="crayon-num" data-line="crayon-5c0caa24457d8349554502-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457d8349554502-42">42</div><div class="crayon-num" data-line="crayon-5c0caa24457d8349554502-43">43</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa24457d8349554502-1"><span class="crayon-p"># MLP for Pima Indians Dataset with grid search via sklearn</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457d8349554502-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5c0caa24457d8349554502-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457d8349554502-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">wrappers</span><span class="crayon-sy">.</span><span class="crayon-e">scikit_learn </span><span class="crayon-e">import </span><span class="crayon-e">KerasClassifier</span></div><div class="crayon-line" id="crayon-5c0caa24457d8349554502-5"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">GridSearchCV</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457d8349554502-6"><span class="crayon-e">import </span><span class="crayon-v">numpy</span></div><div class="crayon-line" id="crayon-5c0caa24457d8349554502-7"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457d8349554502-8"><span class="crayon-p"># Function to create model, required for KerasClassifier</span></div><div class="crayon-line" id="crayon-5c0caa24457d8349554502-9"><span class="crayon-e">def </span><span class="crayon-e">create_model</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'rmsprop'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">init</span><span class="crayon-o">=</span><span class="crayon-s">'glorot_uniform'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457d8349554502-10"><span class="crayon-h"> </span><span class="crayon-p"># create model</span></div><div class="crayon-line" id="crayon-5c0caa24457d8349554502-11"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457d8349554502-12"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa24457d8349554502-13"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457d8349554502-14"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa24457d8349554502-15"><span class="crayon-h"> </span><span class="crayon-p"># Compile model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457d8349554502-16"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">optimizer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa24457d8349554502-17"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457d8349554502-18"> </div><div class="crayon-line" id="crayon-5c0caa24457d8349554502-19"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457d8349554502-20"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line" id="crayon-5c0caa24457d8349554502-21"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457d8349554502-22"><span class="crayon-p"># load pima indians dataset</span></div><div class="crayon-line" id="crayon-5c0caa24457d8349554502-23"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">"pima-indians-diabetes.csv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">","</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457d8349554502-24"><span class="crayon-p"># split into input (X) and output (Y) variables</span></div><div class="crayon-line" id="crayon-5c0caa24457d8349554502-25"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457d8349554502-26"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa24457d8349554502-27"><span class="crayon-p"># create model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457d8349554502-28"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">create_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa24457d8349554502-29"><span class="crayon-p"># grid search epochs, batch size and optimizer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457d8349554502-30"><span class="crayon-v">optimizers</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'rmsprop'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'adam'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa24457d8349554502-31"><span class="crayon-v">init</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'glorot_uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'normal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'uniform'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457d8349554502-32"><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">150</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa24457d8349554502-33"><span class="crayon-v">batches</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457d8349554502-34"><span class="crayon-v">param_grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">optimizers</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-v">epochs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-v">batches</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">init</span><span class="crayon-o">=</span><span class="crayon-v">init</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa24457d8349554502-35"><span class="crayon-v">grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GridSearchCV</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-o">=</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param_grid</span><span class="crayon-o">=</span><span class="crayon-v">param_grid</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457d8349554502-36"><span class="crayon-v">grid_result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa24457d8349554502-37"><span class="crayon-p"># summarize results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457d8349554502-38"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Best: %f using %s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_score_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_params_</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa24457d8349554502-39"><span class="crayon-v">means</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'mean_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457d8349554502-40"><span class="crayon-v">stds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'std_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa24457d8349554502-41"><span class="crayon-v">params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'params'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457d8349554502-42"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">param </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-v">means</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">params</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa24457d8349554502-43"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%f (%f) with: %r"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0027 seconds] -->
<p>This might take about 5 minutes to complete on your workstation executed on the CPU (rather than CPU). running the example shows the results below.</p>
<p>We can see that the grid search discovered that using a uniform initialization scheme, rmsprop optimizer, 150 epochs and a batch size of 5 achieved the best cross-validation score of approximately 75% on this problem.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa24457db220565402" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Best: 0.752604 using {'init': 'uniform', 'optimizer': 'adam', 'batch_size': 5, 'epochs': 150}
0.707031 (0.025315) with: {'init': 'glorot_uniform', 'optimizer': 'rmsprop', 'batch_size': 5, 'epochs': 50}
0.589844 (0.147095) with: {'init': 'glorot_uniform', 'optimizer': 'adam', 'batch_size': 5, 'epochs': 50}
0.701823 (0.006639) with: {'init': 'normal', 'optimizer': 'rmsprop', 'batch_size': 5, 'epochs': 50}
0.714844 (0.019401) with: {'init': 'normal', 'optimizer': 'adam', 'batch_size': 5, 'epochs': 50}
0.718750 (0.016573) with: {'init': 'uniform', 'optimizer': 'rmsprop', 'batch_size': 5, 'epochs': 50}
0.688802 (0.032578) with: {'init': 'uniform', 'optimizer': 'adam', 'batch_size': 5, 'epochs': 50}
0.657552 (0.075566) with: {'init': 'glorot_uniform', 'optimizer': 'rmsprop', 'batch_size': 5, 'epochs': 100}
0.696615 (0.026557) with: {'init': 'glorot_uniform', 'optimizer': 'adam', 'batch_size': 5, 'epochs': 100}
0.727865 (0.022402) with: {'init': 'normal', 'optimizer': 'rmsprop', 'batch_size': 5, 'epochs': 100}
0.736979 (0.030647) with: {'init': 'normal', 'optimizer': 'adam', 'batch_size': 5, 'epochs': 100}
0.739583 (0.029635) with: {'init': 'uniform', 'optimizer': 'rmsprop', 'batch_size': 5, 'epochs': 100}
0.717448 (0.012075) with: {'init': 'uniform', 'optimizer': 'adam', 'batch_size': 5, 'epochs': 100}
0.692708 (0.036690) with: {'init': 'glorot_uniform', 'optimizer': 'rmsprop', 'batch_size': 5, 'epochs': 150}
0.697917 (0.028940) with: {'init': 'glorot_uniform', 'optimizer': 'adam', 'batch_size': 5, 'epochs': 150}
0.727865 (0.030647) with: {'init': 'normal', 'optimizer': 'rmsprop', 'batch_size': 5, 'epochs': 150}
0.747396 (0.016053) with: {'init': 'normal', 'optimizer': 'adam', 'batch_size': 5, 'epochs': 150}
0.729167 (0.007366) with: {'init': 'uniform', 'optimizer': 'rmsprop', 'batch_size': 5, 'epochs': 150}
0.752604 (0.017566) with: {'init': 'uniform', 'optimizer': 'adam', 'batch_size': 5, 'epochs': 150}
0.662760 (0.035132) with: {'init': 'glorot_uniform', 'optimizer': 'rmsprop', 'batch_size': 10, 'epochs': 50}
...</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa24457db220565402-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457db220565402-2">2</div><div class="crayon-num" data-line="crayon-5c0caa24457db220565402-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457db220565402-4">4</div><div class="crayon-num" data-line="crayon-5c0caa24457db220565402-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457db220565402-6">6</div><div class="crayon-num" data-line="crayon-5c0caa24457db220565402-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457db220565402-8">8</div><div class="crayon-num" data-line="crayon-5c0caa24457db220565402-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457db220565402-10">10</div><div class="crayon-num" data-line="crayon-5c0caa24457db220565402-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457db220565402-12">12</div><div class="crayon-num" data-line="crayon-5c0caa24457db220565402-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457db220565402-14">14</div><div class="crayon-num" data-line="crayon-5c0caa24457db220565402-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457db220565402-16">16</div><div class="crayon-num" data-line="crayon-5c0caa24457db220565402-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457db220565402-18">18</div><div class="crayon-num" data-line="crayon-5c0caa24457db220565402-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa24457db220565402-20">20</div><div class="crayon-num" data-line="crayon-5c0caa24457db220565402-21">21</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa24457db220565402-1">Best: 0.752604 using {'init': 'uniform', 'optimizer': 'adam', 'batch_size': 5, 'epochs': 150}</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457db220565402-2">0.707031 (0.025315) with: {'init': 'glorot_uniform', 'optimizer': 'rmsprop', 'batch_size': 5, 'epochs': 50}</div><div class="crayon-line" id="crayon-5c0caa24457db220565402-3">0.589844 (0.147095) with: {'init': 'glorot_uniform', 'optimizer': 'adam', 'batch_size': 5, 'epochs': 50}</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457db220565402-4">0.701823 (0.006639) with: {'init': 'normal', 'optimizer': 'rmsprop', 'batch_size': 5, 'epochs': 50}</div><div class="crayon-line" id="crayon-5c0caa24457db220565402-5">0.714844 (0.019401) with: {'init': 'normal', 'optimizer': 'adam', 'batch_size': 5, 'epochs': 50}</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457db220565402-6">0.718750 (0.016573) with: {'init': 'uniform', 'optimizer': 'rmsprop', 'batch_size': 5, 'epochs': 50}</div><div class="crayon-line" id="crayon-5c0caa24457db220565402-7">0.688802 (0.032578) with: {'init': 'uniform', 'optimizer': 'adam', 'batch_size': 5, 'epochs': 50}</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457db220565402-8">0.657552 (0.075566) with: {'init': 'glorot_uniform', 'optimizer': 'rmsprop', 'batch_size': 5, 'epochs': 100}</div><div class="crayon-line" id="crayon-5c0caa24457db220565402-9">0.696615 (0.026557) with: {'init': 'glorot_uniform', 'optimizer': 'adam', 'batch_size': 5, 'epochs': 100}</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457db220565402-10">0.727865 (0.022402) with: {'init': 'normal', 'optimizer': 'rmsprop', 'batch_size': 5, 'epochs': 100}</div><div class="crayon-line" id="crayon-5c0caa24457db220565402-11">0.736979 (0.030647) with: {'init': 'normal', 'optimizer': 'adam', 'batch_size': 5, 'epochs': 100}</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457db220565402-12">0.739583 (0.029635) with: {'init': 'uniform', 'optimizer': 'rmsprop', 'batch_size': 5, 'epochs': 100}</div><div class="crayon-line" id="crayon-5c0caa24457db220565402-13">0.717448 (0.012075) with: {'init': 'uniform', 'optimizer': 'adam', 'batch_size': 5, 'epochs': 100}</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457db220565402-14">0.692708 (0.036690) with: {'init': 'glorot_uniform', 'optimizer': 'rmsprop', 'batch_size': 5, 'epochs': 150}</div><div class="crayon-line" id="crayon-5c0caa24457db220565402-15">0.697917 (0.028940) with: {'init': 'glorot_uniform', 'optimizer': 'adam', 'batch_size': 5, 'epochs': 150}</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457db220565402-16">0.727865 (0.030647) with: {'init': 'normal', 'optimizer': 'rmsprop', 'batch_size': 5, 'epochs': 150}</div><div class="crayon-line" id="crayon-5c0caa24457db220565402-17">0.747396 (0.016053) with: {'init': 'normal', 'optimizer': 'adam', 'batch_size': 5, 'epochs': 150}</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457db220565402-18">0.729167 (0.007366) with: {'init': 'uniform', 'optimizer': 'rmsprop', 'batch_size': 5, 'epochs': 150}</div><div class="crayon-line" id="crayon-5c0caa24457db220565402-19">0.752604 (0.017566) with: {'init': 'uniform', 'optimizer': 'adam', 'batch_size': 5, 'epochs': 150}</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa24457db220565402-20">0.662760 (0.035132) with: {'init': 'glorot_uniform', 'optimizer': 'rmsprop', 'batch_size': 10, 'epochs': 50}</div><div class="crayon-line" id="crayon-5c0caa24457db220565402-21">...</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Summary</h2>
<p>In this post, you discovered how you can wrap your Keras deep learning models and use them in the scikit-learn general machine learning library.</p>
<p>You can see that using scikit-learn for standard machine learning operations such as model evaluation and model hyperparameter optimization can save a lot of time over implementing these schemes yourself.</p>
<p>Wrapping your model allowed you to leverage powerful tools from scikit-learn to fit your deep learning models into your general machine learning process.</p>
<p>Do you have any questions about using Keras models in scikit-learn or about this post? Ask your question in the comments and I will do my best to answer.</p>
<!-- Shortcoder conditions not met -->
<div class="awac-wrapper"><div class="awac widget text-35"> <div class="textwidget"><div class="woo-sc-hr"></div>
<h2 style="text-align: center;">Frustrated With Your Progress In Deep Learning?</h2>
<p><a href="/deep-learning-with-python/"><img align="left" alt="Deep Learning with Python" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/DeepLearningWithPython-220.png" style="border: 0;"/></a></p>
<h4 style="text-align: center;"> What If You Could Develop A Network in Minutes</h4>
<p style="text-align: center;">…with just a few lines of Python</p>
<p style="text-align: center;">Discover how in my new Ebook: <a href="https://machinelearningmastery.com/deep-learning-with-python/">Deep Learning With Python</a></p>
<p style="text-align: center;">It covers <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> on topics like:<br/>
<em>Multilayer Perceptrons</em>, <em>Convolutional Nets</em> and <em>Recurrent Neural Nets</em>, and more…</p>
<h4 style="text-align: center;">Finally Bring Deep Learning To<br/>
Your Own Projects</h4>
<p style="text-align: center;">Skip the Academics. Just Results.</p>
<p style="text-align: center;"><a href="https://machinelearningmastery.com/deep-learning-with-python/">Click to learn more</a>.</p>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-2564 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=Use+Keras+Deep+Learning+Models+with+Scikit-Learn+in+Python&amp;url=https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
</section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/spot-check-regression-machine-learning-algorithms-python-scikit-learn/" rel="prev"><i class="fa fa-angle-left"></i> Spot-Check Regression Machine Learning Algorithms in Python with scikit-learn</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/compare-machine-learning-algorithms-python-scikit-learn/" rel="next">How To Compare Machine Learning Algorithms in Python with scikit-learn <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">158 Responses to <em>Use Keras Deep Learning Models with Scikit-Learn in Python</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-352628">
<div class="comment-container" id="li-comment-352628">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/248b22f1f2538d8e0c3368fd86cb0e9f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/248b22f1f2538d8e0c3368fd86cb0e9f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shruthi</span>
<span class="date">June 2, 2016 at 6:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-352628" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>First, this is extremely helpful. Thanks a lot.</p>
<p>I’m new to keras and i was trying to optimize other parameters like dropout  and number of hidden neurons. The grid search works for the parameters listed above in your example. However, when i try to optimize for dropout the code errors out saying it’s not a legal parameter name. I thought specifying the name as it is in the create_model() function should be enough; obviously I’m wrong. </p>
<p>in short: if i had to optimize for dropout using GridSearchCV, how would the changes to your code look? </p>
<p>apologies if my question is naive, trying to learn keras, python and deep learning all at once. Thanks,</p>
<p>Shruthi</p>
<div class="reply">
<a aria-label="Reply to Shruthi" class="comment-reply-link" href="#comment-352628" onclick='return addComment.moveForm( "comment-352628", "352628", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-354760">
<div class="comment-container" id="li-comment-354760">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 23, 2016 at 10:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-354760" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question.</p>
<p>As you say, you simply add a new parameter to the create_model() function called dropout_rate then make use of that parameter when creating your dropout layers.</p>
<p>Below is an example of grid searching dropout values in Keras:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa2449042385960691" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Use scikit-learn to grid search the dropout rate
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import Dropout
from keras.optimizers import SGD
from keras.wrappers.scikit_learn import KerasClassifier
from sklearn.grid_search import GridSearchCV
import numpy
import pandas
# Function to create model, required for KerasClassifier
def create_model(dropout_rate=0.0):
	# create model
	model = Sequential()
	model.add(Dense(12, input_dim=8, activation='relu'))
	model.add(Dropout(dropout_rate))
	model.add(Dense(8, init='normal', activation='relu'))
	model.add(Dropout(dropout_rate))
	model.add(Dense(1, init='normal', activation='sigmoid'))
	# Compile model
	model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
	return model

# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)
# load dataset
dataset = numpy.loadtxt("pima-indians-diabetes.csv", delimiter=",")
# split into input (X) and output (Y) variables
X = dataset[:,0:8]
Y = dataset[:,8]
# create model
model = KerasClassifier(build_fn=create_model, nb_epoch=100, batch_size=5, verbose=0)
# grid search dropout rate
dropout_rate = [0.0, 0.2, 0.5]
param_grid = dict(dropout_rate=dropout_rate)
grid = GridSearchCV(estimator=model, param_grid=param_grid, cv=5)
grid_result = grid.fit(X, Y)
# summarize results
print("Best: %f using %s" % (grid_result.best_score_, grid_result.best_params_))
for params, mean_score, scores in grid_result.grid_scores_:
    print("%f (%f) with: %r" % (scores.mean(), scores.std(), params))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa2449042385960691-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2449042385960691-2">2</div><div class="crayon-num" data-line="crayon-5c0caa2449042385960691-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2449042385960691-4">4</div><div class="crayon-num" data-line="crayon-5c0caa2449042385960691-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2449042385960691-6">6</div><div class="crayon-num" data-line="crayon-5c0caa2449042385960691-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2449042385960691-8">8</div><div class="crayon-num" data-line="crayon-5c0caa2449042385960691-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2449042385960691-10">10</div><div class="crayon-num" data-line="crayon-5c0caa2449042385960691-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2449042385960691-12">12</div><div class="crayon-num" data-line="crayon-5c0caa2449042385960691-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2449042385960691-14">14</div><div class="crayon-num" data-line="crayon-5c0caa2449042385960691-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2449042385960691-16">16</div><div class="crayon-num" data-line="crayon-5c0caa2449042385960691-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2449042385960691-18">18</div><div class="crayon-num" data-line="crayon-5c0caa2449042385960691-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2449042385960691-20">20</div><div class="crayon-num" data-line="crayon-5c0caa2449042385960691-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2449042385960691-22">22</div><div class="crayon-num" data-line="crayon-5c0caa2449042385960691-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2449042385960691-24">24</div><div class="crayon-num" data-line="crayon-5c0caa2449042385960691-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2449042385960691-26">26</div><div class="crayon-num" data-line="crayon-5c0caa2449042385960691-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2449042385960691-28">28</div><div class="crayon-num" data-line="crayon-5c0caa2449042385960691-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2449042385960691-30">30</div><div class="crayon-num" data-line="crayon-5c0caa2449042385960691-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2449042385960691-32">32</div><div class="crayon-num" data-line="crayon-5c0caa2449042385960691-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2449042385960691-34">34</div><div class="crayon-num" data-line="crayon-5c0caa2449042385960691-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2449042385960691-36">36</div><div class="crayon-num" data-line="crayon-5c0caa2449042385960691-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2449042385960691-38">38</div><div class="crayon-num" data-line="crayon-5c0caa2449042385960691-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2449042385960691-40">40</div><div class="crayon-num" data-line="crayon-5c0caa2449042385960691-41">41</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa2449042385960691-1"><span class="crayon-p"># Use scikit-learn to grid search the dropout rate</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2449042385960691-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5c0caa2449042385960691-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2449042385960691-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dropout</span></div><div class="crayon-line" id="crayon-5c0caa2449042385960691-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">optimizers </span><span class="crayon-e">import </span><span class="crayon-e">SGD</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2449042385960691-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">wrappers</span><span class="crayon-sy">.</span><span class="crayon-e">scikit_learn </span><span class="crayon-e">import </span><span class="crayon-e">KerasClassifier</span></div><div class="crayon-line" id="crayon-5c0caa2449042385960691-7"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">grid_search </span><span class="crayon-e">import </span><span class="crayon-e">GridSearchCV</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2449042385960691-8"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5c0caa2449042385960691-9"><span class="crayon-e">import </span><span class="crayon-v">pandas</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2449042385960691-10"><span class="crayon-p"># Function to create model, required for KerasClassifier</span></div><div class="crayon-line" id="crayon-5c0caa2449042385960691-11"><span class="crayon-e">def </span><span class="crayon-e">create_model</span><span class="crayon-sy">(</span><span class="crayon-v">dropout_rate</span><span class="crayon-o">=</span><span class="crayon-cn">0.0</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2449042385960691-12"><span class="crayon-h"> </span><span class="crayon-p"># create model</span></div><div class="crayon-line" id="crayon-5c0caa2449042385960691-13"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2449042385960691-14"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa2449042385960691-15"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-v">dropout_rate</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2449042385960691-16"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">init</span><span class="crayon-o">=</span><span class="crayon-s">'normal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa2449042385960691-17"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-v">dropout_rate</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2449042385960691-18"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">init</span><span class="crayon-o">=</span><span class="crayon-s">'normal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa2449042385960691-19"><span class="crayon-h"> </span><span class="crayon-p"># Compile model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2449042385960691-20"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa2449042385960691-21"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2449042385960691-22"> </div><div class="crayon-line" id="crayon-5c0caa2449042385960691-23"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2449042385960691-24"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line" id="crayon-5c0caa2449042385960691-25"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2449042385960691-26"><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="crayon-5c0caa2449042385960691-27"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">"pima-indians-diabetes.csv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">","</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2449042385960691-28"><span class="crayon-p"># split into input (X) and output (Y) variables</span></div><div class="crayon-line" id="crayon-5c0caa2449042385960691-29"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2449042385960691-30"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa2449042385960691-31"><span class="crayon-p"># create model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2449042385960691-32"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">create_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nb_epoch</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa2449042385960691-33"><span class="crayon-p"># grid search dropout rate</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2449042385960691-34"><span class="crayon-v">dropout_rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa2449042385960691-35"><span class="crayon-v">param_grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-v">dropout_rate</span><span class="crayon-o">=</span><span class="crayon-v">dropout_rate</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2449042385960691-36"><span class="crayon-v">grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GridSearchCV</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-o">=</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param_grid</span><span class="crayon-o">=</span><span class="crayon-v">param_grid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa2449042385960691-37"><span class="crayon-v">grid_result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2449042385960691-38"><span class="crayon-p"># summarize results</span></div><div class="crayon-line" id="crayon-5c0caa2449042385960691-39"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Best: %f using %s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_score_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_params_</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2449042385960691-40"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">params</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mean_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">scores </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">grid_scores_</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caa2449042385960691-41"><span class="crayon-h">    </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%f (%f) with: %r"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">params</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0023 seconds] -->
<p></p>
<p>Running the example produces the following output:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa2449045074258680" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Best: 0.731771 using {'dropout_rate': 0.0}
0.731805 (0.049857) with: {'dropout_rate': 0.0}
0.716213 (0.030675) with: {'dropout_rate': 0.2}
0.671980 (0.051395) with: {'dropout_rate': 0.5}</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa2449045074258680-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2449045074258680-2">2</div><div class="crayon-num" data-line="crayon-5c0caa2449045074258680-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2449045074258680-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa2449045074258680-1"><span class="crayon-v">Best</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.731771</span><span class="crayon-h"> </span><span class="crayon-e">using</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'dropout_rate'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2449045074258680-2"><span class="crayon-cn">0.731805</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0.049857</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">with</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'dropout_rate'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5c0caa2449045074258680-3"><span class="crayon-cn">0.716213</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0.030675</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">with</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'dropout_rate'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2449045074258680-4"><span class="crayon-cn">0.671980</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0.051395</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">with</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'dropout_rate'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">}</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>
<p>I hope that helps</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-354760" onclick='return addComment.moveForm( "comment-354760", "354760", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-354714">
<div class="comment-container" id="li-comment-354714">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7d26f2fca3f799f18335c5529c7d2146?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7d26f2fca3f799f18335c5529c7d2146?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rish</span>
<span class="date">June 22, 2016 at 10:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-354714" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for the post, this is awesome. I’ve found the grid search very helpful.</p>
<p>One quick question: is there a way to incorporate early stopping into the grid search? With a particular model I am playing with, I find it can often over-train and consequently my validation loss suffers. Whilst I could incorporate an array of epoch parameters (like in your example), it seems more efficient to just have it stop if the validation accuracy increases over a small number of epochs. Unless you have a better idea?</p>
<p>Thanks again!</p>
<div class="reply">
<a aria-label="Reply to Rish" class="comment-reply-link" href="#comment-354714" onclick='return addComment.moveForm( "comment-354714", "354714", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-354737">
<div class="comment-container" id="li-comment-354737">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 23, 2016 at 5:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-354737" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great comment Rish and really nice idea.</p>
<p>I don’t think scikit-learn supports early stopping in it’s parameter searching. You would have to rig up your own parameter search and add an early stop clause to it, or consider modifying sklearn itself.</p>
<p>I also wonder whether you could hook-up Kears check-pointing and capture the best parameter combinations along the way to file (checkpoint callback) and allow you to kill the search at any time.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-354737" onclick='return addComment.moveForm( "comment-354737", "354737", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-357418">
<div class="comment-container" id="li-comment-357418">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7d26f2fca3f799f18335c5529c7d2146?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7d26f2fca3f799f18335c5529c7d2146?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rish</span>
<span class="date">July 19, 2016 at 12:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-357418" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the reply! 🙂 I wonder too!</p>
<div class="reply">
<a aria-label="Reply to Rish" class="comment-reply-link" href="#comment-357418" onclick='return addComment.moveForm( "comment-357418", "357418", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-4" id="comment-392430">
<div class="comment-container" id="li-comment-392430">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d46baa5e15300821c970db882b5811c3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d46baa5e15300821c970db882b5811c3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vadim</span>
<span class="date">March 13, 2017 at 8:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-392430" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason, </p>
<p>Awesome article. Did you by any chance find a way to hookup callback functions to grid search? In this case it would be possible to have Tensorboard aggregating and visualizing the grid search outcomes.</p>
<div class="reply">
<a aria-label="Reply to Vadim" class="comment-reply-link" href="#comment-392430" onclick='return addComment.moveForm( "comment-392430", "392430", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-360241">
<div class="comment-container" id="li-comment-360241">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/57a42a2766c6d1509b324aeab8a3ee62?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/57a42a2766c6d1509b324aeab8a3ee62?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rishabh</span>
<span class="date">August 17, 2016 at 3:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-360241" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Great Post. Thanks for this.</p>
<p>One problem that i have always faced with training a deep learning model (in H2O as well) is that predicted probability distribution is always flat (as in very less variation in probability across the sample). Any other ML model e.g. RF/GBM is easier to tune and gives good results in most cases. So the my doubt is two fold:</p>
<p>1. Except for lets say image data where CNN might be a good thing to try, in what scenarios should we try to fit a deep learning model.<br/>
2. I think the issues that i face with deep learning models is usually due to underfitting. Can you please give some tips on how to tune a deep learning model (other ML models are easier to tune)</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Rishabh" class="comment-reply-link" href="#comment-360241" onclick='return addComment.moveForm( "comment-360241", "360241", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-360273">
<div class="comment-container" id="li-comment-360273">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 17, 2016 at 9:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-360273" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Deep learning is good on raw data like images, text, audio and similar. It can work on complex tabular data, but often feature engineering + xgboost can do better in practice.</p>
<p>Keep adding layers/neurons (capacity) and training longer until performance flattens out.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-360273" onclick='return addComment.moveForm( "comment-360273", "360273", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-360304">
<div class="comment-container" id="li-comment-360304">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/57a42a2766c6d1509b324aeab8a3ee62?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/57a42a2766c6d1509b324aeab8a3ee62?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rishabh</span>
<span class="date">August 17, 2016 at 7:51 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-360304" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks. I will try to add more layers and add some regularization parameters as well</p>
<div class="reply">
<a aria-label="Reply to Rishabh" class="comment-reply-link" href="#comment-360304" onclick='return addComment.moveForm( "comment-360304", "360304", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-360353">
<div class="comment-container" id="li-comment-360353">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 18, 2016 at 7:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-360353" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good luck Rishabh, let me know how you go.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-360353" onclick='return addComment.moveForm( "comment-360353", "360353", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-364152">
<div class="comment-container" id="li-comment-364152">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/57a42a2766c6d1509b324aeab8a3ee62?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/57a42a2766c6d1509b324aeab8a3ee62?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rishabh</span>
<span class="date">September 10, 2016 at 11:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-364152" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, I was able to tune the model, thanks to your post although GBM had a better fit. I had included prelu layers which improved the fit.</p>
<p>One question, is there an optimal way to find number of hidden neurons and hidden layer count or grid search the only option?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-364255">
<div class="comment-container" id="li-comment-364255">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 12, 2016 at 8:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-364255" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Tuning (grid/random) is the best option I know of Rishabh.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-5" id="comment-364295">
<div class="comment-container" id="li-comment-364295">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/57a42a2766c6d1509b324aeab8a3ee62?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/57a42a2766c6d1509b324aeab8a3ee62?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rishabh</span>
<span class="date">September 12, 2016 at 5:03 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-364295" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks. Grid search takes a toll on my 16 GB laptop, hence searching for an optimal way.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-364345">
<div class="comment-container" id="li-comment-364345">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 13, 2016 at 8:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-364345" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It is punishing. Small grids are kinder on memory.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-364737">
<div class="comment-container" id="li-comment-364737">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7801e9e6b7329b6b04788eb29867c254?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7801e9e6b7329b6b04788eb29867c254?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">xiao</span>
<span class="date">September 17, 2016 at 10:59 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-364737" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thanks for the post. I’m a beginner about keras, and I met some problems using keras with sk-learn recently. If it’s convenient, could you do me a falvor?</p>
<p>Details here:<br/>
<a href="http://stackoverflow.com/questions/39467496/error-when-using-keras-sk-learn-api" rel="nofollow">http://stackoverflow.com/questions/39467496/error-when-using-keras-sk-learn-api</a></p>
<p>Thank you!!!</p>
<div class="reply">
<a aria-label="Reply to xiao" class="comment-reply-link" href="#comment-364737" onclick='return addComment.moveForm( "comment-364737", "364737", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-364842">
<div class="comment-container" id="li-comment-364842">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 18, 2016 at 8:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-364842" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ouch. Nothing comes to mind Xiao, sorry.</p>
<p>I would debug it by cutting it back to the simplest possible network/code that generates the problem then find the line that causes the problem, and go from there.</p>
<p>If you need a result fast, I would use the same decompositional approach to rapidly find a workaround.</p>
<p>Let me know how you go.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-364842" onclick='return addComment.moveForm( "comment-364842", "364842", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-364849">
<div class="comment-container" id="li-comment-364849">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7801e9e6b7329b6b04788eb29867c254?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7801e9e6b7329b6b04788eb29867c254?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">xiao</span>
<span class="date">September 18, 2016 at 10:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-364849" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks a lot, Jason.<br/>
I need the result fast if possible.</p>
<div class="reply">
<a aria-label="Reply to xiao" class="comment-reply-link" href="#comment-364849" onclick='return addComment.moveForm( "comment-364849", "364849", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="comment-365164">
<div class="comment-container" id="li-comment-365164">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7801e9e6b7329b6b04788eb29867c254?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7801e9e6b7329b6b04788eb29867c254?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">xiao</span>
<span class="date">September 21, 2016 at 12:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-365164" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason. Got any idea?</p>
<div class="reply">
<a aria-label="Reply to xiao" class="comment-reply-link" href="#comment-365164" onclick='return addComment.moveForm( "comment-365164", "365164", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-365229">
<div class="comment-container" id="li-comment-365229">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 22, 2016 at 8:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-365229" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, I gave you an approach to debug the problem in the previous comment Xiao. </p>
<p>I don’t know any more than that, sorry.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-365229" onclick='return addComment.moveForm( "comment-365229", "365229", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-365262">
<div class="comment-container" id="li-comment-365262">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7801e9e6b7329b6b04788eb29867c254?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7801e9e6b7329b6b04788eb29867c254?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">xiao</span>
<span class="date">September 22, 2016 at 4:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-365262" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, I’ll try it out.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-365203">
<div class="comment-container" id="li-comment-365203">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2b35215f361e6b6c6a180bd3ff9b590c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2b35215f361e6b6c6a180bd3ff9b590c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Josh</span>
<span class="date">September 22, 2016 at 12:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-365203" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, Thanks for the tutorial it saved me a lot of time. I am running a huge amount of data on a remote server from shell files. The output of the model is written to an additional shell file in case there is errors. However when I run my code, following how you approach above, it outputs the status of training, i.e. epoch number and accuracy, for every model in gridsearch. Is there a way to suppress this output? I tried to use “verbose=0” as an additional argument both in calling “fit” which created an error and GridsearchCV which did not do anything. </p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Josh" class="comment-reply-link" href="#comment-365203" onclick='return addComment.moveForm( "comment-365203", "365203", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-365237">
<div class="comment-container" id="li-comment-365237">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 22, 2016 at 8:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-365237" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question Josh.</p>
<p>Pass verbose=0 into the constructor of your classifier:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa2448e37048074321" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
KerasClassifier(build_fn=create_model, verbose=0)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa2448e37048074321-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa2448e37048074321-1"><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">create_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-365237" onclick='return addComment.moveForm( "comment-365237", "365237", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-366340">
<div class="comment-container" id="li-comment-366340">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/51c280230e9e6369028bd4cb4a6b8711?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/51c280230e9e6369028bd4cb4a6b8711?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tom</span>
<span class="date">October 5, 2016 at 9:09 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-366340" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,<br/>
First of all thank you so much for your guides and examples regarding Keras and deep learning!! Please keep on going 🙂<br/>
Question 1<br/>
Is it possible to save the best trained model with grid and set some callbacks (for early stopping as well)? I wanted to implement saving the best model by doing<br/>
checkpoint=ModelCheckpoint(filepath, monitor=’val_acc’, verbose=0, save_best_only=True, mode=’max’)<br/>
grid_result = grid.fit(X, Y, callbacks=[checkpoint])<br/>
but TypeError: fit() got an unexpected keyword argument ‘callbacks’<br/>
Question 2<br/>
Is there a way to visualize the trained weights and literaly seeing the created network? I want to make neural networks a bit more practical instead of only classification. I know you can plot the model:  plot(model, to_file=’model.png’) but I want to implement my data in this model.<br/>
Thanks in advance,<br/>
Tom</p>
<div class="reply">
<a aria-label="Reply to Tom" class="comment-reply-link" href="#comment-366340" onclick='return addComment.moveForm( "comment-366340", "366340", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-366394">
<div class="comment-container" id="li-comment-366394">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 6, 2016 at 9:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-366394" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Tom, I’m glad you’re finding my material valuable.</p>
<p>Sorry, I don’t know about call-backs in the grid search. Sounds like it might just make a big mess (i.e. not designed to do this).</p>
<p>I don’t know about built in ways to visualize the weights. Personally, I like to look at the weights for production models to see if something crazy is going on – but just the raw numbers.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-366394" onclick='return addComment.moveForm( "comment-366394", "366394", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-410565">
<div class="comment-container" id="li-comment-410565">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e17e2c8e2627f2a72a705346986f3516?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e17e2c8e2627f2a72a705346986f3516?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">David</span>
<span class="date">August 22, 2017 at 4:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-410565" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thanks for the very well written article! Very clear and easy to understand.<br/>
I have a callback that does different types of learning rate annealing. It has four parameters I’d like to optimise.<br/>
Based on your above comment I’m guessing the SciKit wrapper won’t work for optimising this?<br/>
Do you know how I would do this?<br/>
Many thanks for your help.<br/>
David</p>
<div class="reply">
<a aria-label="Reply to David" class="comment-reply-link" href="#comment-410565" onclick='return addComment.moveForm( "comment-410565", "410565", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-410645">
<div class="comment-container" id="li-comment-410645">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 23, 2017 at 6:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-410645" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You might have to write your own for loop David. In fact, I’d recommend it for the experience and control it offers.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-410645" onclick='return addComment.moveForm( "comment-410645", "410645", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-367404">
<div class="comment-container" id="li-comment-367404">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ffa50b2ca24453993f3a1aaefc6db603?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ffa50b2ca24453993f3a1aaefc6db603?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Soren Pallesen</span>
<span class="date">October 18, 2016 at 5:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-367404" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi there, thanks for all your inspiration. When running the above example i get a slightly different result:</p>
<p>Best: 0.751302 using {‘optimizer’: ‘rmsprop’, ‘batch_size’: 5, ‘init’: ‘normal’, ‘nb_epoch’: 150}</p>
<p>e.i. init: normal and not uniform as in your example.</p>
<p>Is it normal with these variations?</p>
<div class="reply">
<a aria-label="Reply to Soren Pallesen" class="comment-reply-link" href="#comment-367404" onclick='return addComment.moveForm( "comment-367404", "367404", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-367468">
<div class="comment-container" id="li-comment-367468">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 19, 2016 at 9:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-367468" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Soren,</p>
<p>Results can vary based on the initialization method. It is hard to predict how they will vary for a given problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-367468" onclick='return addComment.moveForm( "comment-367468", "367468", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-375330">
<div class="comment-container" id="li-comment-375330">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f2370f969143ef698dee9f970b26ccba?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f2370f969143ef698dee9f970b26ccba?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Saddam</span>
<span class="date">December 15, 2016 at 9:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-375330" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey am getting an error “ValueError: init is not a legal parameter”<br/>
code is as follows.<br/>
            init = [‘glorot_uniform’, ‘normal’, ‘uniform’]<br/>
            batches = numpy.array([50, 100, 150])<br/>
            param_grid = dict(init=init)<br/>
            print(str(self.model_comp.get_params()))<br/>
            grid = GridSearchCV(estimator=self.model_comp, param_grid=param_grid)<br/>
            grid_result = grid.fit(X_train, Y_train)</p>
<p>i can’t figure out what am doing wrong. Help me out here.</p>
<div class="reply">
<a aria-label="Reply to Saddam" class="comment-reply-link" href="#comment-375330" onclick='return addComment.moveForm( "comment-375330", "375330", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-375374">
<div class="comment-container" id="li-comment-375374">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 16, 2016 at 5:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-375374" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry Saddam, the cause does not seem obvious.</p>
<p>Perhaps post more of the error message or consider posting the question on stack overflow?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-375374" onclick='return addComment.moveForm( "comment-375374", "375374", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-382286">
<div class="comment-container" id="li-comment-382286">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d2079454ccf1c18b99a5fc2352e38063?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d2079454ccf1c18b99a5fc2352e38063?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://madoverdata.com/" rel="external nofollow">Palash Goyal</a></span>
<span class="date">January 15, 2017 at 11:36 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-382286" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Saddam and Jason,</p>
<p>The error is due to the init parameter ‘glorot_uniform’.<br/>
Seems like it has been deprecated or something, once you remove this from the possible values (i.e., init=[‘uniform’,’normal’]) your code will work.</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Palash Goyal" class="comment-reply-link" href="#comment-382286" onclick='return addComment.moveForm( "comment-382286", "382286", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-382382">
<div class="comment-container" id="li-comment-382382">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 16, 2017 at 10:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-382382" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It does not appear to be deprecated:<br/>
<a href="https://keras.io/initializations/" rel="nofollow">https://keras.io/initializations/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-382382" onclick='return addComment.moveForm( "comment-382382", "382382", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-383547">
<div class="comment-container" id="li-comment-383547">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b527203780041b2467494c62dafd74b0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b527203780041b2467494c62dafd74b0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nils Holgersson</span>
<span class="date">January 23, 2017 at 4:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-383547" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Don’t forget to add the parameter (related to parameters inside the creation of your model) that you want to iterate over as input parameter to the function that creates your model. </p>
<p>def create_model(init=’normal’):<br/>
  …</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-428812">
<div class="comment-container" id="li-comment-428812">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/467ed2b75cc6a781409b2afcc4805960?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/467ed2b75cc6a781409b2afcc4805960?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Fareed</span>
<span class="date">February 8, 2018 at 11:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-428812" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>check you have defined the ‘init’ as parameter in the function. if not define it as parameter in the function. once done, when you create the instance of KerasClassifier and call that in the GRidSearchCV(), it will not throw the error.</p>
<div class="reply">
<a aria-label="Reply to Fareed" class="comment-reply-link" href="#comment-428812" onclick='return addComment.moveForm( "comment-428812", "428812", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-376598">
<div class="comment-container" id="li-comment-376598">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/53a3f32466d3f6d3b359242de7909a09?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/53a3f32466d3f6d3b359242de7909a09?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tameru</span>
<span class="date">December 21, 2016 at 9:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-376598" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>recently, I tried to use K-fold cross validation  for Image classification problem and found the following error</p>
<p>training Image X  shape= (2041,64,64)<br/>
label y shape= (2041,2)</p>
<p>code: </p>
<p>model = KerasClassifier(build_fn=creat_model, nb_epoch=15, batch_size=10, verbose=0)</p>
<p># evaluate using 6-fold cross validation</p>
<p>kfold = StratifiedKFold(n_splits=6, shuffle=False, random_state=seed)</p>
<p>results = cross_val_score(model, x, y, cv=kfold)</p>
<p>print results</p>
<p>print ‘Mean=’,</p>
<p>print(results.mean())</p>
<p>an error:</p>
<p>IndexError                                Traceback (most recent call last)<br/>
 in ()<br/>
      2 # evaluate using 6-fold cross validation<br/>
      3 kfold = StratifiedKFold(n_splits=6, shuffle=False, random_state=seed)<br/>
—-&gt; 4 results = cross_val_score(model, x, y, cv=kfold)<br/>
      5 print results<br/>
      6 print ‘Mean=’,</p>
<p>IndexError: too many indices for array</p>
<p>I don’t understand what is wrong here?<br/>
Thanks,</p>
<div class="reply">
<a aria-label="Reply to Tameru" class="comment-reply-link" href="#comment-376598" onclick='return addComment.moveForm( "comment-376598", "376598", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-376722">
<div class="comment-container" id="li-comment-376722">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 22, 2016 at 6:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-376722" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry Tameru, I have not seen this error before. Perhaps try stack overflow?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-376722" onclick='return addComment.moveForm( "comment-376722", "376722", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-380364">
<div class="comment-container" id="li-comment-380364">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/721632ed658d1d7d994d2faa13906418?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/721632ed658d1d7d994d2faa13906418?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">coyan</span>
<span class="date">January 5, 2017 at 6:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-380364" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, I have the same problem. Do you have any easy way to solve it?</p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to coyan" class="comment-reply-link" href="#comment-380364" onclick='return addComment.moveForm( "comment-380364", "380364", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-380505">
<div class="comment-container" id="li-comment-380505">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 6, 2017 at 9:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-380505" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sounds like it could be a data issue.</p>
<p>Perhaps your data does not have enough observations in each class to split into 6 groups? </p>
<p>Ideas:<br/>
– Try different values of k.<br/>
– Try using KFold rather than StratifiedKFild<br/>
– Try a train/test split</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-380505" onclick='return addComment.moveForm( "comment-380505", "380505", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-4" id="comment-380962">
<div class="comment-container" id="li-comment-380962">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/53a3f32466d3f6d3b359242de7909a09?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/53a3f32466d3f6d3b359242de7909a09?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tameru</span>
<span class="date">January 8, 2017 at 7:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-380962" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>@ Coyan, I am still trying to solve it. let us try Jason’s advice. Thanks, Jason.</p>
<div class="reply">
<a aria-label="Reply to Tameru" class="comment-reply-link" href="#comment-380962" onclick='return addComment.moveForm( "comment-380962", "380962", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-383154">
<div class="comment-container" id="li-comment-383154">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/da0a550dfa61cb677b33e2c56d7ca33c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/da0a550dfa61cb677b33e2c56d7ca33c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">JiaMingLin</span>
<span class="date">January 20, 2017 at 8:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-383154" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi </p>
<p>I also encounter this problem, and I guess the scikit-learn k-fold functions do not accept the “one hot” vectors. You may try on StratifiedShuffleSplit with the list of “one hot” vectors.</p>
<p>And that means you can only evaluate Keras model with scikit-learn in the binary classification problem.</p>
<div class="reply">
<a aria-label="Reply to JiaMingLin" class="comment-reply-link" href="#comment-383154" onclick='return addComment.moveForm( "comment-383154", "383154", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-444287">
<div class="comment-container" id="li-comment-444287">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d621d8a8a3415b11a11b6fe034563569?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d621d8a8a3415b11a11b6fe034563569?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">quester</span>
<span class="date">July 24, 2018 at 6:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-444287" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Same error for me. I have 6 output classes that are one-hot encoded. So, how can we use cross_val_score for multi-class classification problems with Keras model?  Is there any other method? I also want to find the optimum number of nodes in hidden layer with cross_val. Any suggestions? @JiaingLin @Jason.</p>
<div class="reply">
<a aria-label="Reply to quester" class="comment-reply-link" href="#comment-444287" onclick='return addComment.moveForm( "comment-444287", "444287", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-444333">
<div class="comment-container" id="li-comment-444333">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 25, 2018 at 6:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-444333" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>More on how to configure a neural net for classification here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/how-can-i-change-a-neural-network-from-regression-to-classification" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-can-i-change-a-neural-network-from-regression-to-classification</a></p>
<p>More on how to configure the number of nodes and layers here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/how-many-layers-and-nodes-do-i-need-in-my-neural-network" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-many-layers-and-nodes-do-i-need-in-my-neural-network</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444333" onclick='return addComment.moveForm( "comment-444333", "444333", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-382252">
<div class="comment-container" id="li-comment-382252">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/19268d726cad0793110083c92939697d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/19268d726cad0793110083c92939697d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ali</span>
<span class="date">January 15, 2017 at 7:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-382252" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Dr. Brownlee,</p>
<p>Your results here are around 75%. My experiment with my data result in around 85%. Is this considered good result?</p>
<p>Because DNN and RNN are known for their great performances. I wonder if it’s normal and how we can improve the results.</p>
<p>Regards,</p>
<div class="reply">
<a aria-label="Reply to Ali" class="comment-reply-link" href="#comment-382252" onclick='return addComment.moveForm( "comment-382252", "382252", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-382381">
<div class="comment-container" id="li-comment-382381">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 16, 2017 at 10:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-382381" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Ali, I have some idea to improve performance here:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-382381" onclick='return addComment.moveForm( "comment-382381", "382381", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-382411">
<div class="comment-container" id="li-comment-382411">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/19268d726cad0793110083c92939697d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/19268d726cad0793110083c92939697d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ali</span>
<span class="date">January 16, 2017 at 2:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-382411" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for your reply.</p>
<div class="reply">
<a aria-label="Reply to Ali" class="comment-reply-link" href="#comment-382411" onclick='return addComment.moveForm( "comment-382411", "382411", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-385697">
<div class="comment-container" id="li-comment-385697">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/427c83aff18afa0a7b1751ac5d918ae8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/427c83aff18afa0a7b1751ac5d918ae8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://None" rel="external nofollow">Miriam</a></span>
<span class="date">February 3, 2017 at 1:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-385697" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I cannot tell you how awesome your tutorials are in terms of saving me time trying to understand Keras,</p>
<p>However, I have run into a conceptual wall re: training, validation and testing. I originally understood that wrapping Keras in Gridsearch helped me tune my hyperparameters. So with GridsearchCV, there is no separate training and validation sets. This I can live with as it is the case with any CV.</p>
<p>But then I want to use Keras to predict my outcomes on the model with optimized hyperparameters. Every example I see for model.fit/model.evaluate, uses the argument validation_data (or validation_split)  and I’m understand that we’re using our test set as a validation set — a real no no.</p>
<p>Please see <a href="https://github.com/fchollet/keras/issues/1753" rel="nofollow">https://github.com/fchollet/keras/issues/1753</a> for a discussion of this and proof that I am not theonly one confused.</p>
<p>SO MY QUESTION IS: In completing your wonderful cookbook how to’s for novices, after I have found all my hyperparameters, how do I run my test data?</p>
<p>If I use model.fit, won’t the test data be unlawfully used to retrain? What exactly is happening with the validation_data or _split argument in model.fit in keras????</p>
<div class="reply">
<a aria-label="Reply to Miriam" class="comment-reply-link" href="#comment-385697" onclick='return addComment.moveForm( "comment-385697", "385697", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-385763">
<div class="comment-container" id="li-comment-385763">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 3, 2017 at 10:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-385763" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Miriam,</p>
<p>Generally, you can hold out a separate validation set for evaluating a final model and set of parameters. This is recommended.</p>
<p>Model selection and tuning can be performed on the same test set using a suitable resampling method (k-fold cross validation with repeats). Ideally, separate datasets would be used for algorithm selection and parameter selection, but is often too expensive (in terms available data).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-385763" onclick='return addComment.moveForm( "comment-385763", "385763", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-391510">
<div class="comment-container" id="li-comment-391510">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/044a20f7e66e62c6b7f71293f8e58607?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/044a20f7e66e62c6b7f71293f8e58607?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">wenger</span>
<span class="date">March 6, 2017 at 5:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-391510" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>i follow the step ，but error  </p>
<p>ValueError: optimizer is not a legal parameter</p>
<p>i don’t konw how to deal with it</p>
<div class="reply">
<a aria-label="Reply to wenger" class="comment-reply-link" href="#comment-391510" onclick='return addComment.moveForm( "comment-391510", "391510", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-391614">
<div class="comment-container" id="li-comment-391614">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 7, 2017 at 9:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-391614" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m sorry to hear that wenger. Perhaps confirm that you have the latest versions of Keras and sklearn installed?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-391614" onclick='return addComment.moveForm( "comment-391614", "391614", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-428468">
<div class="comment-container" id="li-comment-428468">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/01829d17b83fafbdf8c6bacbf6294f4c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/01829d17b83fafbdf8c6bacbf6294f4c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Pedro Cadahia</span>
<span class="date">February 5, 2018 at 9:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-428468" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi wenger, that error is produced because there is an error of coding in the example shown below. you should change the function and pass it an argument called optimizer, like this create_model(optimizer), also in the same function you have to edit the model compile and change the optimized (which is fixed) that is wrong if you want to do a grid search… so a good solution would be change ‘adam’ and write again ‘optimizer=optimizer’, by doing this you would be able to run the code again and find the best solver.</p>
<p>Happy deep learning!</p>
<div class="reply">
<a aria-label="Reply to Pedro Cadahia" class="comment-reply-link" href="#comment-428468" onclick='return addComment.moveForm( "comment-428468", "428468", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-428140">
<div class="comment-container" id="li-comment-428140">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7e92460e62177734f0f6f7371efd6598?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7e92460e62177734f0f6f7371efd6598?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Xian Jing</span>
<span class="date">February 2, 2018 at 12:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-428140" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have met your problem, and I find that maybe you haven’t transmit the optimizer to the function model.</p>
<div class="reply">
<a aria-label="Reply to Xian Jing" class="comment-reply-link" href="#comment-428140" onclick='return addComment.moveForm( "comment-428140", "428140", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-394924">
<div class="comment-container" id="li-comment-394924">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b8e7ed43bdce56c298bbafd10378a419?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b8e7ed43bdce56c298bbafd10378a419?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">myk</span>
<span class="date">March 31, 2017 at 9:25 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-394924" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hello how can i implement SVM machine learning algorithm by using scikit library with keras</p>
<div class="reply">
<a aria-label="Reply to myk" class="comment-reply-link" href="#comment-394924" onclick='return addComment.moveForm( "comment-394924", "394924", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-394978">
<div class="comment-container" id="li-comment-394978">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 1, 2017 at 5:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-394978" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Keras is for deep learning, not SVM. You only need sklearn.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-394978" onclick='return addComment.moveForm( "comment-394978", "394978", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-395274">
<div class="comment-container" id="li-comment-395274">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5be76baed4eb05b0901e57283401ddcd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5be76baed4eb05b0901e57283401ddcd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ronen</span>
<span class="date">April 3, 2017 at 10:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-395274" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>As always very informative and skillfully written post.</p>
<p>In the face of an extremely unbalanced data set, how would pipeline under-sampling pre-processing step, in the example above.</p>
<p>Thanks !</p>
<div class="reply">
<a aria-label="Reply to Ronen" class="comment-reply-link" href="#comment-395274" onclick='return addComment.moveForm( "comment-395274", "395274", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-395334">
<div class="comment-container" id="li-comment-395334">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 4, 2017 at 9:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-395334" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t have an example, but this post will help:<br/>
<a href="http://machinelearningmastery.com/tactics-to-combat-imbalanced-classes-in-your-machine-learning-dataset/" rel="nofollow">http://machinelearningmastery.com/tactics-to-combat-imbalanced-classes-in-your-machine-learning-dataset/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-395334" onclick='return addComment.moveForm( "comment-395334", "395334", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-395358">
<div class="comment-container" id="li-comment-395358">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5be76baed4eb05b0901e57283401ddcd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5be76baed4eb05b0901e57283401ddcd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ronen</span>
<span class="date">April 4, 2017 at 3:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-395358" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>it’s a great one and very helpful, but i am looking for a python-keras recipe.</p>
<div class="reply">
<a aria-label="Reply to Ronen" class="comment-reply-link" href="#comment-395358" onclick='return addComment.moveForm( "comment-395358", "395358", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-396573">
<div class="comment-container" id="li-comment-396573">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a43f36bc69b5515518468eb041bd4358?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a43f36bc69b5515518468eb041bd4358?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jens</span>
<span class="date">April 16, 2017 at 6:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-396573" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason, </p>
<p>I played around with your code for my own project and encountered an issue that I get different results when using the pipeline (both without standardization)<br/>
I posted this also on crossvalidated:<br/>
<a href="https://stats.stackexchange.com/questions/273911/different-results-for-keras-sklearn-wrapper-with-and-without-use-of-pipline" rel="nofollow">https://stats.stackexchange.com/questions/273911/different-results-for-keras-sklearn-wrapper-with-and-without-use-of-pipline</a></p>
<p>Can you help me with that?<br/>
Thank you</p>
<div class="reply">
<a aria-label="Reply to Jens" class="comment-reply-link" href="#comment-396573" onclick='return addComment.moveForm( "comment-396573", "396573", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-396590">
<div class="comment-container" id="li-comment-396590">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 16, 2017 at 9:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-396590" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Neural networks are a stochastic algorithm that gives different results each time they are run (unless you fix the seed and make everything else the same).</p>
<p>See this post:<br/>
<a href="http://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">http://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-396590" onclick='return addComment.moveForm( "comment-396590", "396590", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-398056">
<div class="comment-container" id="li-comment-398056">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/881f4d46c6d1d1f458831cb7ae591b03?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/881f4d46c6d1d1f458831cb7ae591b03?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Carlton banks</span>
<span class="date">April 30, 2017 at 11:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-398056" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Could you provide an example in which data generator and fit_generator is being used..</p>
<div class="reply">
<a aria-label="Reply to Carlton banks" class="comment-reply-link" href="#comment-398056" onclick='return addComment.moveForm( "comment-398056", "398056", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-398127">
<div class="comment-container" id="li-comment-398127">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 1, 2017 at 5:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-398127" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This post might help with the data generator:<br/>
<a href="http://machinelearningmastery.com/image-augmentation-deep-learning-keras/" rel="nofollow">http://machinelearningmastery.com/image-augmentation-deep-learning-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-398127" onclick='return addComment.moveForm( "comment-398127", "398127", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-398429">
<div class="comment-container" id="li-comment-398429">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/69a73d80cf84e4406d3310bfadd6560d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/69a73d80cf84e4406d3310bfadd6560d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anni</span>
<span class="date">May 3, 2017 at 7:59 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-398429" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for the post, this is awesome. But i’m facing </p>
<p>ValueError: Can’t handle mix of multilabel-indicator and binary </p>
<p>when i set scoring function to precision, recall, or f1 in cross validation. But it works fine if i didn’t set scoring function just like you did. Do you have any easy way to solve it?</p>
<p>Big Thanks!</p>
<p>Here’s the code :<br/>
scores2=cross_val_score(model, X_train.as_matrix(), y_train, cv=10, scoring=’precision’)</p>
<div class="reply">
<a aria-label="Reply to Anni" class="comment-reply-link" href="#comment-398429" onclick='return addComment.moveForm( "comment-398429", "398429", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-398489">
<div class="comment-container" id="li-comment-398489">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 4, 2017 at 8:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-398489" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Is this happening with the dataset used in this tutorial?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-398489" onclick='return addComment.moveForm( "comment-398489", "398489", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-398563">
<div class="comment-container" id="li-comment-398563">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/69a73d80cf84e4406d3310bfadd6560d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/69a73d80cf84e4406d3310bfadd6560d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anni</span>
<span class="date">May 5, 2017 at 4:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-398563" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, actually its happening with breast cancer data set from UCI Machine Learning. I used train_test_split to split the data into training and testing. But when I tried to fit the model, i got </p>
<p>IndexError: indices are out-of-bounds. </p>
<p>So I tried to modify y_train by following code :</p>
<p>y_train = np_utils.to_categorical(y_train)</p>
<p>Do you have any idea ? i tried to solve this error for a week and still cannot fixed the problem.</p>
<div class="reply">
<a aria-label="Reply to Anni" class="comment-reply-link" href="#comment-398563" onclick='return addComment.moveForm( "comment-398563", "398563", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-398579">
<div class="comment-container" id="li-comment-398579">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 5, 2017 at 7:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-398579" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I believe all the variables in that dataset are categorical. </p>
<p>I expect you will need to use an integer encoding and a one hot encoding for each variable.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-398579" onclick='return addComment.moveForm( "comment-398579", "398579", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-398675">
<div class="comment-container" id="li-comment-398675">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/69a73d80cf84e4406d3310bfadd6560d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/69a73d80cf84e4406d3310bfadd6560d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anni</span>
<span class="date">May 5, 2017 at 10:24 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-398675" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Okay, I will try your suggestion. Thanks for your reply 🙂</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-444762">
<div class="comment-container" id="li-comment-444762">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f45e448049a62b5102eec70bc646205b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f45e448049a62b5102eec70bc646205b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">cass</span>
<span class="date">July 30, 2018 at 8:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-444762" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Anni</p>
<p>do you figure it out. I am kind of confused, since the output of neural network is probability, it cannot get like precision and recall directly….</p>
<div class="reply">
<a aria-label="Reply to cass" class="comment-reply-link" href="#comment-444762" onclick='return addComment.moveForm( "comment-444762", "444762", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-399431">
<div class="comment-container" id="li-comment-399431">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/875163e086ed54c30ce973cde9e5fbfe?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/875163e086ed54c30ce973cde9e5fbfe?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Edward</span>
<span class="date">May 12, 2017 at 7:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-399431" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason is there something in deep learning like feature_importance in xgboost?<br/>
For images it makes no sense though in this case it can be important</p>
<div class="reply">
<a aria-label="Reply to Edward" class="comment-reply-link" href="#comment-399431" onclick='return addComment.moveForm( "comment-399431", "399431", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-399453">
<div class="comment-container" id="li-comment-399453">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 12, 2017 at 7:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-399453" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>There may be, I’m not aware of it.</p>
<p>You could use a neural net within an RFE process.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-399453" onclick='return addComment.moveForm( "comment-399453", "399453", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-399454">
<div class="comment-container" id="li-comment-399454">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/875163e086ed54c30ce973cde9e5fbfe?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/875163e086ed54c30ce973cde9e5fbfe?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Edward</span>
<span class="date">May 12, 2017 at 7:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-399454" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for your reply, Jason! Your blog is GOLD 🙂</p>
<div class="reply">
<a aria-label="Reply to Edward" class="comment-reply-link" href="#comment-399454" onclick='return addComment.moveForm( "comment-399454", "399454", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-399523">
<div class="comment-container" id="li-comment-399523">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 13, 2017 at 6:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-399523" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Edward.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-399523" onclick='return addComment.moveForm( "comment-399523", "399523", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-400532">
<div class="comment-container" id="li-comment-400532">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cc38e3040c5238004b5c400f8fa9ebf8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cc38e3040c5238004b5c400f8fa9ebf8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Adrian</span>
<span class="date">May 26, 2017 at 12:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-400532" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Do you know how to save the hyperparameters with the TensorBoard callback?</p>
<div class="reply">
<a aria-label="Reply to Adrian" class="comment-reply-link" href="#comment-400532" onclick='return addComment.moveForm( "comment-400532", "400532", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401134">
<div class="comment-container" id="li-comment-401134">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 11:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-401134" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have an example or tutorial.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401134" onclick='return addComment.moveForm( "comment-401134", "401134", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-400690">
<div class="comment-container" id="li-comment-400690">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fb73797d05d4719f6dae10ff9f39be8b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fb73797d05d4719f6dae10ff9f39be8b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anisa</span>
<span class="date">May 28, 2017 at 6:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-400690" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason!</p>
<p>I’m doing grid search with my own scoring function, but I need to get result like accuracy and recall from training model. So, I use cross_val_score with best params that I get from grid search. But then cross_val_score produce different result with best score that I got from grid search. Do you have any idea to solve my problem?</p>
<p>Thanks,</p>
<div class="reply">
<a aria-label="Reply to Anisa" class="comment-reply-link" href="#comment-400690" onclick='return addComment.moveForm( "comment-400690", "400690", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401165">
<div class="comment-container" id="li-comment-401165">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 12:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-401165" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, deep learning algorithms are stochastic.</p>
<p>You need to repeat evaluation experiments many times and take the average, see this post:<br/>
<a href="http://machinelearningmastery.com/evaluate-skill-deep-learning-models/" rel="nofollow">http://machinelearningmastery.com/evaluate-skill-deep-learning-models/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401165" onclick='return addComment.moveForm( "comment-401165", "401165", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-400818">
<div class="comment-container" id="li-comment-400818">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ed26a3545eaf2f59e355489886c05377?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ed26a3545eaf2f59e355489886c05377?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shabran</span>
<span class="date">May 30, 2017 at 3:41 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-400818" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason!</p>
<p>I’m doin grid search with my own function as scoring function, but i need to reports other metrics from best param that I got from grid search. So, I’m doin cross validation with best params. But the problem is cross validation produce different result with best score from grid search. The different really significan. Do you have any idea to solve this problem?</p>
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Shabran" class="comment-reply-link" href="#comment-400818" onclick='return addComment.moveForm( "comment-400818", "400818", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401197">
<div class="comment-container" id="li-comment-401197">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 12:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-401197" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, you must re-run the algorithm evaluation multiple times and report the average performance.</p>
<p>See this post:<br/>
<a href="http://machinelearningmastery.com/evaluate-skill-deep-learning-models/" rel="nofollow">http://machinelearningmastery.com/evaluate-skill-deep-learning-models/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401197" onclick='return addComment.moveForm( "comment-401197", "401197", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-401619">
<div class="comment-container" id="li-comment-401619">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9d86ce043c560977af492717734fa9eb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9d86ce043c560977af492717734fa9eb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Szymon</span>
<span class="date">June 6, 2017 at 6:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-401619" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How could we use Keras with ensembles, let’s take Voting. When base models are from sklearn library everything works fine, but with Keras I’m getting ‘TypeError: cannot create ‘sys.flags’ instances’. Do you know any work around?</p>
<div class="reply">
<a aria-label="Reply to Szymon" class="comment-reply-link" href="#comment-401619" onclick='return addComment.moveForm( "comment-401619", "401619", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401641">
<div class="comment-container" id="li-comment-401641">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 6, 2017 at 10:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-401641" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can perform voting manually on the lists of predictions from each sub model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401641" onclick='return addComment.moveForm( "comment-401641", "401641", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-402494">
<div class="comment-container" id="li-comment-402494">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/10003d1b62c3224bb1c3bcf90f20f4e6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/10003d1b62c3224bb1c3bcf90f20f4e6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kirana</span>
<span class="date">June 14, 2017 at 3:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-402494" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m evaluating 3 algorithms (SVM-RBF, XGBoost, and MLP) against small datasets. Is it true if SVM and XGBoost are suitable for small datasets whereas deep learning require “relatively” large datasets to work well? Could you please explain to me?</p>
<p>Thanks a lot.</p>
<div class="reply">
<a aria-label="Reply to Kirana" class="comment-reply-link" href="#comment-402494" onclick='return addComment.moveForm( "comment-402494", "402494", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-402572">
<div class="comment-container" id="li-comment-402572">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 15, 2017 at 8:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-402572" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps, let the results and hard data drive your model selection.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-402572" onclick='return addComment.moveForm( "comment-402572", "402572", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-402798">
<div class="comment-container" id="li-comment-402798">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3e2996e3da1ad1710b2a9a77e1254aed?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3e2996e3da1ad1710b2a9a77e1254aed?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">James</span>
<span class="date">June 17, 2017 at 2:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-402798" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great article. It seems similar to what I am currently learning about. I’m using the sklearn wrapper for Keras; particularly the KerasClassifier and sklearn’s <code>cross_val_score()</code>. I am running into an issue with the <code>n_jobs</code> parameter for <code>cross_val_score</code>. I’d like to take advantage of the GPU on my Windows 10 machine, but am getting <code>Blas GEMM launch failed</code> when <code>n_jobs = -1</code> or any value above 1. Also getting different results if I run it from the shell prompt vs. the python interpreter. Any ideas what I can do to get this to work?</p>
<p>Windows 10<br/>
Geforce 1080 Ti<br/>
Tensorflow GPU<br/>
Python 3.6 via Anaconda<br/>
Keras 2.0.5</p>
<div class="reply">
<a aria-label="Reply to James" class="comment-reply-link" href="#comment-402798" onclick='return addComment.moveForm( "comment-402798", "402798", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-402843">
<div class="comment-container" id="li-comment-402843">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 17, 2017 at 7:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-402843" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry James, I don’t have good advice on setting up GPUs on windows for Keras.</p>
<p>Perhaps you can post on stackoverflow?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-402843" onclick='return addComment.moveForm( "comment-402843", "402843", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-402920">
<div class="comment-container" id="li-comment-402920">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dd1735fd8ca90869aa876e649e49636f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dd1735fd8ca90869aa876e649e49636f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://soulis.tech" rel="external nofollow">Anastasios Selalmazidis</a></span>
<span class="date">June 18, 2017 at 2:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-402920" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>when I run your first example, the one which uses StratifiedKFold, with a multiclass dataset of mine, I get an errorIsn’t it possible to run StratifiedKFold with multiclass ? I also have the same problem “”IndexError: too many indices for array”. when try to run a GridSearch with StritifiedKFold</p>
<div class="reply">
<a aria-label="Reply to Anastasios Selalmazidis" class="comment-reply-link" href="#comment-402920" onclick='return addComment.moveForm( "comment-402920", "402920", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-402944">
<div class="comment-container" id="li-comment-402944">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 18, 2017 at 6:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-402944" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Try changing it from StratifiedKFold to KFold.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-402944" onclick='return addComment.moveForm( "comment-402944", "402944", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-403987">
<div class="comment-container" id="li-comment-403987">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/468dd9e03924c6eb3cc4403eb1e777a0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/468dd9e03924c6eb3cc4403eb1e777a0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sean</span>
<span class="date">June 27, 2017 at 5:24 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-403987" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I follow your steps and the program takes more than 40 minutes to run. Therefore, I gave up waiting in the middle. Do you know if there is any way to speed up the GridSearchCV? Or is it normal to wait more than 40 minutes to run this code on a 2013 Mac? Thank you</p>
<div class="reply">
<a aria-label="Reply to Sean" class="comment-reply-link" href="#comment-403987" onclick='return addComment.moveForm( "comment-403987", "403987", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-404042">
<div class="comment-container" id="li-comment-404042">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 28, 2017 at 6:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-404042" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You could cut down the number of parameters that are being searched.</p>
<p>I often run grid searches that run for weeks on AWS.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-404042" onclick='return addComment.moveForm( "comment-404042", "404042", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-404004">
<div class="comment-container" id="li-comment-404004">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/158315164566e39b1ac18ade4aa05869?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/158315164566e39b1ac18ade4aa05869?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Clarence Wong</span>
<span class="date">June 27, 2017 at 8:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-404004" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>How do I save the model when wrapping a Keras Classifier in Scikit’s GridSearchCV? </p>
<p>Do I treat it as a scikit object and use pickle/joblib or do I use the model.save method native to Keras?</p>
<div class="reply">
<a aria-label="Reply to Clarence Wong" class="comment-reply-link" href="#comment-404004" onclick='return addComment.moveForm( "comment-404004", "404004", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-404046">
<div class="comment-container" id="li-comment-404046">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 28, 2017 at 6:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-404046" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I have not tried this. It may not be supported out of the box.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-404046" onclick='return addComment.moveForm( "comment-404046", "404046", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-406013">
<div class="comment-container" id="li-comment-406013">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e5826bde367f50d632b2184045ea038f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e5826bde367f50d632b2184045ea038f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Karthik</span>
<span class="date">July 15, 2017 at 11:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-406013" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I want to perform stratified K-fold cross-validation with a model that predicts a distance and not a binary label. Is it possible to provide a distance threshold to the cross-validation method in scikit-learn (or is there some other approach), i.e., distance &lt; 0.5 to be treated as a positive label (y=1) and a negative label (y=0) otherwise?</p>
<div class="reply">
<a aria-label="Reply to Karthik" class="comment-reply-link" href="#comment-406013" onclick='return addComment.moveForm( "comment-406013", "406013", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-406079">
<div class="comment-container" id="li-comment-406079">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 16, 2017 at 7:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-406079" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Stratification requires a class value.</p>
<p>Perhaps you can frame your problem so the outcome distances are thresholded class labels.</p>
<p>Note, this is a question of how you frame your prediction problem and prepare your data, not the sklearn library.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-406079" onclick='return addComment.moveForm( "comment-406079", "406079", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-406049">
<div class="comment-container" id="li-comment-406049">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c2f9508572917259dc0cc6d709295df5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c2f9508572917259dc0cc6d709295df5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Merco</span>
<span class="date">July 15, 2017 at 11:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-406049" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Very cool!! And you can use Recursive Feature Elimination sklearn function by this way too?</p>
<div class="reply">
<a aria-label="Reply to Merco" class="comment-reply-link" href="#comment-406049" onclick='return addComment.moveForm( "comment-406049", "406049", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-406084">
<div class="comment-container" id="li-comment-406084">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 16, 2017 at 7:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-406084" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-406084" onclick='return addComment.moveForm( "comment-406084", "406084", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-406485">
<div class="comment-container" id="li-comment-406485">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6617b43bc3ee16544f6612a7f024d1c1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6617b43bc3ee16544f6612a7f024d1c1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ambika</span>
<span class="date">July 19, 2017 at 4:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-406485" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Please could you tell me formula for relu function , i need it for regression.</p>
<div class="reply">
<a aria-label="Reply to ambika" class="comment-reply-link" href="#comment-406485" onclick='return addComment.moveForm( "comment-406485", "406485", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-406546">
<div class="comment-container" id="li-comment-406546">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 20, 2017 at 6:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-406546" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure, see here:<br/>
<a href="https://en.wikipedia.org/wiki/Rectifier_(neural_networks)" rel="nofollow">https://en.wikipedia.org/wiki/Rectifier_(neural_networks)</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-406546" onclick='return addComment.moveForm( "comment-406546", "406546", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-406756">
<div class="comment-container" id="li-comment-406756">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9803c5abe6e6268cd826bfc88d9de103?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9803c5abe6e6268cd826bfc88d9de103?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ds</span>
<span class="date">July 21, 2017 at 7:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-406756" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Is it possible to use your code with more complex model architectures? I have 3 different inputs and branches (with ConvLayers), which are concatenated at the end to form a dense layer.<br/>
I tried to call the grid.fit() function as follows:<br/>
grid_result = grid.fit({‘input_1’: train_input_1, ‘input_2’: train_input_2, ‘input_3’: train_input_3}, {‘main_output’: lebels_train})</p>
<p>I’m getting an error:<br/>
“ValueError: found input variables with inconsistent numbers of samples: [3, 1]”</p>
<p>Do you have any experience on that?</p>
<div class="reply">
<a aria-label="Reply to ds" class="comment-reply-link" href="#comment-406756" onclick='return addComment.moveForm( "comment-406756", "406756", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-406826">
<div class="comment-container" id="li-comment-406826">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 22, 2017 at 8:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-406826" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t sorry.</p>
<p>I would recommend using native Keras.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-406826" onclick='return addComment.moveForm( "comment-406826", "406826", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-416225">
<div class="comment-container" id="li-comment-416225">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6280aa5b0826f5cfc8745aad894b9486?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6280aa5b0826f5cfc8745aad894b9486?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nas</span>
<span class="date">October 10, 2017 at 4:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-416225" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>from keras.models import Sequential<br/>
from keras.layers import Dense<br/>
from keras.wrappers.scikit_learn import KerasClassifier<br/>
from sklearn.model_selection import StratifiedKFold<br/>
from sklearn.model_selection import cross_val_score<br/>
import numpy</p>
<p>def create_model():<br/>
	# create model<br/>
	model = Sequential()<br/>
	model.add(Dense(12, input_dim=8, activation=’relu’))<br/>
	model.add(Dense(8, activation=’relu’))<br/>
	model.add(Dense(1, activation=’sigmoid’))<br/>
	# Compile model<br/>
	model.compile(loss=’binary_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])<br/>
	return model</p>
<p>seed = 7<br/>
numpy.random.seed(seed)<br/>
dataset = numpy.loadtxt(“/home/nasrin/nslkdd/NSL_KDD-master/KDDTrain+.csv”, delimiter=”,”)<br/>
X = dataset[:,0:41]<br/>
Y = dataset[:,41]</p>
<p>model = KerasClassifier(build_fn=create_model, epochs=150, batch_size=10, verbose=0)<br/>
kfold = StratifiedKFold(n_splits=10, shuffle=True, random_state=seed)<br/>
results = cross_val_score(model, X, Y, cv=kfold)<br/>
print(results.mean())</p>
<p>Using TensorFlow backend.<br/>
Traceback (most recent call last):<br/>
  File “nsl2.py”, line 20, in<br/>
    dataset = numpy.loadtxt(“/home/nasrin/nslkdd/NSL_KDD-master/KDDTrain+.csv”, delimiter=”,”)<br/>
  File “/home/nasrin/.local/lib/python3.5/site-packages/numpy/lib/npyio.py”, line 1024, in loadtxt<br/>
    items = [conv(val) for (conv, val) in zip(converters, vals)]<br/>
  File “/home/nasrin/.local/lib/python3.5/site-packages/numpy/lib/npyio.py”, line 1024, in<br/>
    items = [conv(val) for (conv, val) in zip(converters, vals)]<br/>
  File “/home/nasrin/.local/lib/python3.5/site-packages/numpy/lib/npyio.py”, line 725, in floatconv<br/>
    return float(x)<br/>
ValueError: could not convert string to float: b’tcp’<br/>
sorry to bother you, what step i missed here.</p>
<div class="reply">
<a aria-label="Reply to Nas" class="comment-reply-link" href="#comment-416225" onclick='return addComment.moveForm( "comment-416225", "416225", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-416237">
<div class="comment-container" id="li-comment-416237">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 10, 2017 at 4:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-416237" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, the error is not clear.</p>
<p>I list a ton of place to get help with Keras here:<br/>
<a href="https://machinelearningmastery.com/get-help-with-keras/" rel="nofollow">https://machinelearningmastery.com/get-help-with-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-416237" onclick='return addComment.moveForm( "comment-416237", "416237", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-416450">
<div class="comment-container" id="li-comment-416450">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5270451fa101001824144cad5dab23bd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5270451fa101001824144cad5dab23bd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Piotr</span>
<span class="date">October 12, 2017 at 10:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-416450" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Do you know, how to do K.clear_session() inside cross_val_score(), between folds?</p>
<p>I have huge CNN networks, but they fits in my memory when I do just one training. The problem is, when I do cross-validation using sci-kit learn and cross_val_score function. I see that memory is increasing with each fold. Do you know hot to change that? After all, after each fold we have to remember just results, not huge model with all weights.</p>
<p>I’ve tried to use on_train_end callback from keras, but this doesn’t work as model is wiped out before evaluating. So do you know if exists other solution? Unfortunately I don’t see any callbacks in cross_val_score function…</p>
<p>I will be very glad for your help 🙂</p>
<div class="reply">
<a aria-label="Reply to Piotr" class="comment-reply-link" href="#comment-416450" onclick='return addComment.moveForm( "comment-416450", "416450", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-416488">
<div class="comment-container" id="li-comment-416488">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 13, 2017 at 5:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-416488" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, sorry.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-416488" onclick='return addComment.moveForm( "comment-416488", "416488", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-417920">
<div class="comment-container" id="li-comment-417920">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3a700bdb4760b3cc6c9fc60d05806bc6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3a700bdb4760b3cc6c9fc60d05806bc6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sanaz</span>
<span class="date">October 25, 2017 at 10:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-417920" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>So many thanks for such a helpful code! I have a problem, despite defining the init both in the model and the dictionary in the same way that you have defined it here, I get an error:</p>
<p> ‘{} is not a legal parameter’.format(params_name))</p>
<p>ValueError: init is not a legal parameter</p>
<p>Could you please help me with this problem?</p>
<div class="reply">
<a aria-label="Reply to Sanaz" class="comment-reply-link" href="#comment-417920" onclick='return addComment.moveForm( "comment-417920", "417920", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417964">
<div class="comment-container" id="li-comment-417964">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 26, 2017 at 5:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-417964" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps check your Python is installed correctly and that you copied the code exactly?</p>
<p>This tutorial can help you setup and test your environment:<br/>
<a href="http://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" rel="nofollow">http://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-417964" onclick='return addComment.moveForm( "comment-417964", "417964", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-419542">
<div class="comment-container" id="li-comment-419542">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/510d1208806132fc9e178c3452e10c7a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/510d1208806132fc9e178c3452e10c7a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ab</span>
<span class="date">November 9, 2017 at 9:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-419542" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
Thank for your nice paper.<br/>
I have tried to use AdaBoostClassifier( model,   n_estimators=2, learning_rate=1.5,    algorithm=”SAMME”)<br/>
and used CNN as ‘model’. However I get the following error:</p>
<p>  File “”, line 1, in<br/>
    runfile(‘/home/aboozar/Sphere_FE/adaboost/adaboost_CNN3.py’, wdir=’~/adaboost’)</p>
<p>  File “/usr/local/lib/python2.7/dist-packages/spyder/utils/site/sitecustomize.py”, line 688, in runfile<br/>
    execfile(filename, namespace)</p>
<p>  File “/usr/local/lib/python2.7/dist-packages/spyder/utils/site/sitecustomize.py”, line 93, in execfile<br/>
    builtins.execfile(filename, *where)</p>
<p>  File “/~/adaboost_CNN3.py”, line 234, in<br/>
    bdt_discrete.fit(X_train, y_train)</p>
<p>  File “/usr/local/lib/python2.7/dist-packages/sklearn/ensemble/weight_boosting.py”, line 413, in fit<br/>
    return super(AdaBoostClassifier, self).fit(X, y, sample_weight)</p>
<p>  File “/usr/local/lib/python2.7/dist-packages/sklearn/ensemble/weight_boosting.py”, line 130, in fit<br/>
    self._validate_estimator()</p>
<p>  File “/usr/local/lib/python2.7/dist-packages/sklearn/ensemble/weight_boosting.py”, line 431, in _validate_estimator<br/>
    % self.base_estimator_.__class__.__name__)</p>
<p>ValueError: KerasClassifier doesn’t support sample_weight.</p>
<p>Do you have any advice?</p>
<div class="reply">
<a aria-label="Reply to Ab" class="comment-reply-link" href="#comment-419542" onclick='return addComment.moveForm( "comment-419542", "419542", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-419581">
<div class="comment-container" id="li-comment-419581">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 10, 2017 at 10:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-419581" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, the cause of the fault is not clear, perhaps one of these resources will be helpful:<br/>
<a href="https://machinelearningmastery.com/get-help-with-keras/" rel="nofollow">https://machinelearningmastery.com/get-help-with-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-419581" onclick='return addComment.moveForm( "comment-419581", "419581", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-423241">
<div class="comment-container" id="li-comment-423241">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/05d8e6bd2a0a67a1b2e4dc8918057c03?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/05d8e6bd2a0a67a1b2e4dc8918057c03?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Arooj</span>
<span class="date">December 15, 2017 at 5:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-423241" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
I am new to keras. Just copied the above code with grid and executed it but getting this error: </p>
<p>“ValueError: init is not a legal parameter”</p>
<p>Your guidance is appreciated.</p>
<div class="reply">
<a aria-label="Reply to Arooj" class="comment-reply-link" href="#comment-423241" onclick='return addComment.moveForm( "comment-423241", "423241", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-423328">
<div class="comment-container" id="li-comment-423328">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 16, 2017 at 5:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-423328" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Double check that you copied all of the code with the same spacing.</p>
<p>Also double check you have the latest version of Keras and sklearn installed.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-423328" onclick='return addComment.moveForm( "comment-423328", "423328", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-423758">
<div class="comment-container" id="li-comment-423758">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b8f686d592a739f80c91b009426804d3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b8f686d592a739f80c91b009426804d3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">michele</span>
<span class="date">December 18, 2017 at 10:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-423758" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, great tutorial, so thanks! </p>
<p>I have a question: if I want to use KerasClassifier with my own score function, let’s say maximizing F1, instead of accuracy, in a grid search scenario or similar.<br/>
What should I do?</p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to michele" class="comment-reply-link" href="#comment-423758" onclick='return addComment.moveForm( "comment-423758", "423758", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-423788">
<div class="comment-container" id="li-comment-423788">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 19, 2017 at 5:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-423788" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can specify the scoring function used by sklearn when evaluating the model with CV or what have you, the “scoring” attribute.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-423788" onclick='return addComment.moveForm( "comment-423788", "423788", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-424006">
<div class="comment-container" id="li-comment-424006">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b8f686d592a739f80c91b009426804d3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b8f686d592a739f80c91b009426804d3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">michele</span>
<span class="date">December 20, 2017 at 12:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-424006" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thx for the answer. But, if I understood correctly, the score function of kerasclassifier must be differentiable, since it is used also as loss function, and F1 is not.</p>
<div class="reply">
<a aria-label="Reply to michele" class="comment-reply-link" href="#comment-424006" onclick='return addComment.moveForm( "comment-424006", "424006", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-424055">
<div class="comment-container" id="li-comment-424055">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 20, 2017 at 5:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-424055" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, that is the loss function of the keras model itself, a different thing from the sklearn’s evaluation of model predictions.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-424055" onclick='return addComment.moveForm( "comment-424055", "424055", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-423915">
<div class="comment-container" id="li-comment-423915">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/53d8ee584d5dcf0c9bba951fc0a0625a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/53d8ee584d5dcf0c9bba951fc0a0625a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ankur Singh</span>
<span class="date">December 19, 2017 at 3:24 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-423915" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, your blog is amazing. I have your Deep Learning book as well.</p>
<p>I have a question: I don’t want the stratified KFold in my code. I have my own validation data. Can I train my model on a given data and check the best scores on a different validation data using Grid Search?</p>
<div class="reply">
<a aria-label="Reply to Ankur Singh" class="comment-reply-link" href="#comment-423915" onclick='return addComment.moveForm( "comment-423915", "423915", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-423930">
<div class="comment-container" id="li-comment-423930">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 19, 2017 at 4:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-423930" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good question, I’m not sure off hand.</p>
<p>The “cv” argument says it can take an iterable, perhaps you can provide your pairs of train/test to it?<br/>
<a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html" rel="nofollow">http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-423930" onclick='return addComment.moveForm( "comment-423930", "423930", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-425464">
<div class="comment-container" id="li-comment-425464">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f3929ec355cde6fc0c66476d7fd46869?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f3929ec355cde6fc0c66476d7fd46869?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Claudio</span>
<span class="date">January 3, 2018 at 2:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-425464" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>HI Jason…<br/>
Thanks so much for for this set of article on Keras.. I thinks it’s simply awesome</p>
<p>I have a question on what is the best way to run the procedure about Grid Search Deep Learning Model Parameters on a Spark cluster.  Is it just a matter to port the code there without any change and the optimization is magically enabled ( run in parallel on different node any combination of parameter to test ) …. or should we import other libraries or apply some changes for enabling that?</p>
<p>thanks a lot in advance</p>
<div class="reply">
<a aria-label="Reply to Claudio" class="comment-reply-link" href="#comment-425464" onclick='return addComment.moveForm( "comment-425464", "425464", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-425484">
<div class="comment-container" id="li-comment-425484">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 3, 2018 at 5:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-425484" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I cannot give you good advice for tuning Keras model with Spark.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425484" onclick='return addComment.moveForm( "comment-425484", "425484", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-425625">
<div class="comment-container" id="li-comment-425625">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0a0b010a331a5372bc5e05f0fb1d5151?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0a0b010a331a5372bc5e05f0fb1d5151?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vikram singh</span>
<span class="date">January 4, 2018 at 11:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-425625" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How to cross validation when we have multi label classification problem ?<br/>
Whenever I pass the Y_train, I get ‘IndexError: too many indices for array’, how to resolve this ?</p>
<div class="reply">
<a aria-label="Reply to vikram singh" class="comment-reply-link" href="#comment-425625" onclick='return addComment.moveForm( "comment-425625", "425625", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-425664">
<div class="comment-container" id="li-comment-425664">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 5, 2018 at 5:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-425664" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>See this tutorial for an example:<br/>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425664" onclick='return addComment.moveForm( "comment-425664", "425664", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-425681">
<div class="comment-container" id="li-comment-425681">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4242436b9f5bfa9bd241c238ee97f5f4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4242436b9f5bfa9bd241c238ee97f5f4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sam Miller</span>
<span class="date">January 5, 2018 at 6:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-425681" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
How do you obtain the precision and recall scores from the model when using  k-folds with KerasClassifier? Is there a method of generating the sklearn.metrics classification report after applying cross_val_score?<br/>
I need these values as my dataset is imbalanced and I want to compare the results from before and after undersampling the data by generating a confusion matrix, ROC curve and precision-recall curve.</p>
<div class="reply">
<a aria-label="Reply to Sam Miller" class="comment-reply-link" href="#comment-425681" onclick='return addComment.moveForm( "comment-425681", "425681", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-425695">
<div class="comment-container" id="li-comment-425695">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 5, 2018 at 11:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-425695" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, change the “scoring” argument to one or a list of metrics to report.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425695" onclick='return addComment.moveForm( "comment-425695", "425695", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-425842">
<div class="comment-container" id="li-comment-425842">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d2455d51983198ffc840223b34937ff4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d2455d51983198ffc840223b34937ff4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">yerra</span>
<span class="date">January 8, 2018 at 2:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-425842" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi  Brownlee , </p>
<p>Thanks for wonderful material for Machine Learning and Deep Learning. As suggested I have dataset  which already split into training and test.   Using Keras  , How to train model and  then   predict the model on test data . ?</p>
<div class="reply">
<a aria-label="Reply to yerra" class="comment-reply-link" href="#comment-425842" onclick='return addComment.moveForm( "comment-425842", "425842", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-425854">
<div class="comment-container" id="li-comment-425854">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 8, 2018 at 5:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-425854" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Learn more about training a final model here:<br/>
<a href="https://machinelearningmastery.com/train-final-machine-learning-model/" rel="nofollow">https://machinelearningmastery.com/train-final-machine-learning-model/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425854" onclick='return addComment.moveForm( "comment-425854", "425854", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-427029">
<div class="comment-container" id="li-comment-427029">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ef6242f2d3776bfd2e505efb66225289?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ef6242f2d3776bfd2e505efb66225289?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Reed Guo</span>
<span class="date">January 21, 2018 at 1:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-427029" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason</p>
<p>How to find the best number of hidden layers and number of neurons?</p>
<p>Can you post the python code? I didn’t find any useful posts by Google.</p>
<p>Thank you very much.</p>
<div class="reply">
<a aria-label="Reply to Reed Guo" class="comment-reply-link" href="#comment-427029" onclick='return addComment.moveForm( "comment-427029", "427029", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-427055">
<div class="comment-container" id="li-comment-427055">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 21, 2018 at 9:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-427055" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question.</p>
<p>You must use trial and error with your specific model on your specific data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-427055" onclick='return addComment.moveForm( "comment-427055", "427055", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-427071">
<div class="comment-container" id="li-comment-427071">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2cc346d477c375bb63c8babd8e4b3d71?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2cc346d477c375bb63c8babd8e4b3d71?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Reed Guo</span>
<span class="date">January 21, 2018 at 7:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-427071" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason</p>
<p>Thanks for your response.</p>
<p>I still feel confused. I don’t know how to do? (use grid search or just try and try again?)</p>
<p>Can you provide a clip of python code for the example in this course?</p>
<div class="reply">
<a aria-label="Reply to Reed Guo" class="comment-reply-link" href="#comment-427071" onclick='return addComment.moveForm( "comment-427071", "427071", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-427088">
<div class="comment-container" id="li-comment-427088">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 22, 2018 at 4:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-427088" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This post may help:<br/>
<a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" rel="nofollow">https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-427088" onclick='return addComment.moveForm( "comment-427088", "427088", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-427292">
<div class="comment-container" id="li-comment-427292">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2cc346d477c375bb63c8babd8e4b3d71?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2cc346d477c375bb63c8babd8e4b3d71?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Reed Guo</span>
<span class="date">January 23, 2018 at 12:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-427292" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason</p>
<p>Thank you very very much.</p>
<div class="reply">
<a aria-label="Reply to Reed Guo" class="comment-reply-link" href="#comment-427292" onclick='return addComment.moveForm( "comment-427292", "427292", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-427417">
<div class="comment-container" id="li-comment-427417">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 24, 2018 at 9:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-427417" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-427417" onclick='return addComment.moveForm( "comment-427417", "427417", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-428152">
<div class="comment-container" id="li-comment-428152">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b76d66980edae7c4e66b31b2f72bbdc0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b76d66980edae7c4e66b31b2f72bbdc0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Magesh Rathnam</span>
<span class="date">February 2, 2018 at 3:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-428152" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason – thanks for the post. I was not aware of this wrapper. Do we have a similar wrapper for regressor too? I am new to ML and I was trying to do house price prediction problem. I see that it can be done with scikit random forest regressors. But I want to see if we can do the same with keras as well, since I started with keras and find it little easier. I tried with a simple sequential model, with multiple layers, but it did not work. Can you pls let me know how can I implement keras for my problem?</p>
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Magesh Rathnam" class="comment-reply-link" href="#comment-428152" onclick='return addComment.moveForm( "comment-428152", "428152", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-428186">
<div class="comment-container" id="li-comment-428186">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 2, 2018 at 8:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-428186" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, there is a wrapper for regression.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-428186" onclick='return addComment.moveForm( "comment-428186", "428186", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-428485">
<div class="comment-container" id="li-comment-428485">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e881e6bd88586863f987333fe36b9278?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e881e6bd88586863f987333fe36b9278?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Atefeh</span>
<span class="date">February 6, 2018 at 12:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-428485" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hello</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa2447e9f583696642" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
def create_model():
    model = Sequential()
    ...
    model.compile(...)
    return model
model = KerasClassifier(build_fn=create_model, epochs=150, batch_size=10)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa2447e9f583696642-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2447e9f583696642-2">2</div><div class="crayon-num" data-line="crayon-5c0caa2447e9f583696642-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2447e9f583696642-4">4</div><div class="crayon-num" data-line="crayon-5c0caa2447e9f583696642-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2447e9f583696642-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa2447e9f583696642-1"><span class="crayon-e">def </span><span class="crayon-e">create_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2447e9f583696642-2"><span class="crayon-h">    </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa2447e9f583696642-3"><span class="crayon-h">    </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2447e9f583696642-4"><span class="crayon-h">    </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa2447e9f583696642-5"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2447e9f583696642-6"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">create_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">150</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p>I face to the error:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa2447ea1924072067" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
NameError                                 Traceback (most recent call last)
 in ()
      4     model.compile(...)
      5     return model
----&gt; 6 model = KerasClassifier(build_fn=create_model, epochs=150, batch_size=10)

NameError: name 'KerasClassifier' is not defined</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa2447ea1924072067-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2447ea1924072067-2">2</div><div class="crayon-num" data-line="crayon-5c0caa2447ea1924072067-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2447ea1924072067-4">4</div><div class="crayon-num" data-line="crayon-5c0caa2447ea1924072067-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2447ea1924072067-6">6</div><div class="crayon-num" data-line="crayon-5c0caa2447ea1924072067-7">7</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa2447ea1924072067-1"><span class="crayon-e">NameError                                 </span><span class="crayon-e">Traceback</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">most </span><span class="crayon-e">recent </span><span class="crayon-e">call </span><span class="crayon-v">last</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2447ea1924072067-2"><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa2447ea1924072067-3"><span class="crayon-h">      </span><span class="crayon-cn">4</span><span class="crayon-h">     </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2447ea1924072067-4"><span class="crayon-h">      </span><span class="crayon-cn">5</span><span class="crayon-h">     </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div><div class="crayon-line" id="crayon-5c0caa2447ea1924072067-5"><span class="crayon-o">--</span><span class="crayon-o">--</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">create_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">150</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2447ea1924072067-6"> </div><div class="crayon-line" id="crayon-5c0caa2447ea1924072067-7"><span class="crayon-v">NameError</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">name</span><span class="crayon-h"> </span><span class="crayon-s">'KerasClassifier'</span><span class="crayon-h"> </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">defined</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>
<p>what is the problem?</p>
<div class="reply">
<a aria-label="Reply to Atefeh" class="comment-reply-link" href="#comment-428485" onclick='return addComment.moveForm( "comment-428485", "428485", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-428553">
<div class="comment-container" id="li-comment-428553">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 6, 2018 at 9:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-428553" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You may not have it imported?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-428553" onclick='return addComment.moveForm( "comment-428553", "428553", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-428590">
<div class="comment-container" id="li-comment-428590">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e881e6bd88586863f987333fe36b9278?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e881e6bd88586863f987333fe36b9278?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Atefeh</span>
<span class="date">February 6, 2018 at 5:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-428590" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hello</p>
<p>again after importing Kerasclassifier, for Kfold what should i import?</p>
<p>from keras.wrappers.scikit_learn import KerasClassifier<br/>
def create_model():<br/>
    model=Sequential()<br/>
    …<br/>
    model.compile(…)<br/>
    return model<br/>
model=KerasClassifier(build_fn=create_model, epochs=150, batch_size=10)<br/>
kfold = StratifiedKFold(n_splits=10, shuffle=True, random_state=seed)</p>
<p>NameError                                 Traceback (most recent call last)<br/>
 in ()<br/>
      6     return model<br/>
      7 model=KerasClassifier(build_fn=create_model, epochs=150, batch_size=10)<br/>
—-&gt; 8 kfold = StratifiedKFold(n_splits=10, shuffle=True, random_state=seed)</p>
<p>NameError: name ‘StratifiedKFold’ is not defined</p>
<p>thank you</p>
<div class="reply">
<a aria-label="Reply to Atefeh" class="comment-reply-link" href="#comment-428590" onclick='return addComment.moveForm( "comment-428590", "428590", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-428643">
<div class="comment-container" id="li-comment-428643">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 7, 2018 at 9:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-428643" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Looks like you are still missing some imports.</p>
<p>Consider using existing code from the blog post as a starting point?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-428643" onclick='return addComment.moveForm( "comment-428643", "428643", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-429339">
<div class="comment-container" id="li-comment-429339">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/96c32e2c295d7b6b42ffd9db119567ac?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/96c32e2c295d7b6b42ffd9db119567ac?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">K V Subrahmanyam</span>
<span class="date">February 13, 2018 at 8:41 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-429339" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi</p>
<p>Thanks for the brilliant post.I have one question. Why are we not passing epochs and batches as parameter to create_model function.  Can you please helping me in understanding this?</p>
<p>Regards<br/>
Subbu</p>
<div class="reply">
<a aria-label="Reply to K V Subrahmanyam" class="comment-reply-link" href="#comment-429339" onclick='return addComment.moveForm( "comment-429339", "429339", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-429386">
<div class="comment-container" id="li-comment-429386">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 14, 2018 at 8:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-429386" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Because we are passing them when we fit the model. The function is only used to define the model, not fit it.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-429386" onclick='return addComment.moveForm( "comment-429386", "429386", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-429817">
<div class="comment-container" id="li-comment-429817">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/67833effbeee017d966ff2397af21080?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/67833effbeee017d966ff2397af21080?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Janina</span>
<span class="date">February 18, 2018 at 9:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-429817" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, even though your post seems very straight-forward, still I struggle to implement this grid search approach. It does not give me any error message, BUT it just runs on and on forever without printing out anything. I deliberately tried it with very few epochs and very few hyperparameters to search. Without grid search, one epoch runs through extremely fast, so I don’t think that I just need to give it more time. It simply doesn’t do anything.</p>
<p>My code:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caa2447d7a403776131" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
def create_model(neurons):
        model = Sequential()
        model.add(Dense(neurons, input_shape=(max_len, len(alphabet)), kernel_regularizer=regularizers.l2(0.001)))
        model.add(Dropout(0.85))
        model.add(LSTM(neurons, input_shape=(neurons,))) 
        model.add(Dropout(0.85))
        model.add(Dense(num_output_classes, activation='softmax'))
    
        model.compile(loss='categorical_crossentropy',
                  optimizer=adam,
                  metrics=['accuracy'])	
        
        return model

seed = 7
np.random.seed(seed)

model = KerasClassifier(build_fn=create_model, epochs=50, batch_size=1, verbose=0)

neurons = [100,200]
param_grid = dict(neurons=neurons)
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1)
grid_result = grid.fit(train_data, train_labels)

print("Best: %f using %s" % (grid_result.best_score_, grid_result.best_params_))
means = grid_result.cv_results_['mean_test_score']
stds = grid_result.cv_results_['std_test_score']
params = grid_result.cv_results_['params']
for mean, stdev, param in zip(means, stds, params):
    print("%f (%f) with: %r" % (mean, stdev, param))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caa2447d7a403776131-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2447d7a403776131-2">2</div><div class="crayon-num" data-line="crayon-5c0caa2447d7a403776131-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2447d7a403776131-4">4</div><div class="crayon-num" data-line="crayon-5c0caa2447d7a403776131-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2447d7a403776131-6">6</div><div class="crayon-num" data-line="crayon-5c0caa2447d7a403776131-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2447d7a403776131-8">8</div><div class="crayon-num" data-line="crayon-5c0caa2447d7a403776131-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2447d7a403776131-10">10</div><div class="crayon-num" data-line="crayon-5c0caa2447d7a403776131-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2447d7a403776131-12">12</div><div class="crayon-num" data-line="crayon-5c0caa2447d7a403776131-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2447d7a403776131-14">14</div><div class="crayon-num" data-line="crayon-5c0caa2447d7a403776131-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2447d7a403776131-16">16</div><div class="crayon-num" data-line="crayon-5c0caa2447d7a403776131-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2447d7a403776131-18">18</div><div class="crayon-num" data-line="crayon-5c0caa2447d7a403776131-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2447d7a403776131-20">20</div><div class="crayon-num" data-line="crayon-5c0caa2447d7a403776131-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2447d7a403776131-22">22</div><div class="crayon-num" data-line="crayon-5c0caa2447d7a403776131-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2447d7a403776131-24">24</div><div class="crayon-num" data-line="crayon-5c0caa2447d7a403776131-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2447d7a403776131-26">26</div><div class="crayon-num" data-line="crayon-5c0caa2447d7a403776131-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2447d7a403776131-28">28</div><div class="crayon-num" data-line="crayon-5c0caa2447d7a403776131-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caa2447d7a403776131-30">30</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caa2447d7a403776131-1"><span class="crayon-e">def </span><span class="crayon-e">create_model</span><span class="crayon-sy">(</span><span class="crayon-v">neurons</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2447d7a403776131-2"><span class="crayon-h">        </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa2447d7a403776131-3"><span class="crayon-h">        </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">neurons</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">max_len</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">alphabet</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_regularizer</span><span class="crayon-o">=</span><span class="crayon-v">regularizers</span><span class="crayon-sy">.</span><span class="crayon-e">l2</span><span class="crayon-sy">(</span><span class="crayon-cn">0.001</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2447d7a403776131-4"><span class="crayon-h">        </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.85</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa2447d7a403776131-5"><span class="crayon-h">        </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-v">neurons</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">neurons</span><span class="crayon-sy">,</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2447d7a403776131-6"><span class="crayon-h">        </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.85</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa2447d7a403776131-7"><span class="crayon-h">        </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">num_output_classes</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2447d7a403776131-8"><span class="crayon-h">    </span></div><div class="crayon-line" id="crayon-5c0caa2447d7a403776131-9"><span class="crayon-h">        </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2447d7a403776131-10"><span class="crayon-h">                  </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">adam</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0caa2447d7a403776131-11"><span class="crayon-h">                  </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2447d7a403776131-12"><span class="crayon-h">        </span></div><div class="crayon-line" id="crayon-5c0caa2447d7a403776131-13"><span class="crayon-h">        </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2447d7a403776131-14"> </div><div class="crayon-line" id="crayon-5c0caa2447d7a403776131-15"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2447d7a403776131-16"><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa2447d7a403776131-17"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2447d7a403776131-18"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">create_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa2447d7a403776131-19"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2447d7a403776131-20"><span class="crayon-v">neurons</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-cn">200</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa2447d7a403776131-21"><span class="crayon-v">param_grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-v">neurons</span><span class="crayon-o">=</span><span class="crayon-v">neurons</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2447d7a403776131-22"><span class="crayon-v">grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GridSearchCV</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-o">=</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param_grid</span><span class="crayon-o">=</span><span class="crayon-v">param_grid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caa2447d7a403776131-23"><span class="crayon-v">grid_result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">train_data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train_labels</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2447d7a403776131-24"> </div><div class="crayon-line" id="crayon-5c0caa2447d7a403776131-25"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Best: %f using %s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_score_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_params_</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2447d7a403776131-26"><span class="crayon-v">means</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'mean_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa2447d7a403776131-27"><span class="crayon-v">stds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'std_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2447d7a403776131-28"><span class="crayon-v">params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'params'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0caa2447d7a403776131-29"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">param </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-v">means</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">params</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caa2447d7a403776131-30"><span class="crayon-h">    </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%f (%f) with: %r"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0021 seconds] -->
<p></p>
<p>Thanks a lot for any help!!</p>
<div class="reply">
<a aria-label="Reply to Janina" class="comment-reply-link" href="#comment-429817" onclick='return addComment.moveForm( "comment-429817", "429817", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-429891">
<div class="comment-container" id="li-comment-429891">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 19, 2018 at 8:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-429891" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps try using a smaller sample of your data?</p>
<p>Perhaps perform the grid search manually with your own for loop? or distributed across machines?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-429891" onclick='return addComment.moveForm( "comment-429891", "429891", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-430901">
<div class="comment-container" id="li-comment-430901">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9a90790b23621f509b7f9bbbcee4147f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9a90790b23621f509b7f9bbbcee4147f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://none" rel="external nofollow">Rishab Verma</a></span>
<span class="date">March 2, 2018 at 5:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-430901" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nothing can be more appreciated than looking at the replies that you have made to other people’s issues.</p>
<p>I also have an issue. I want to train a SVM classifier on the weights that I have already saved of a model that used fully connected layer of a ResNet. How do I feel in the values to the SVM classifier?<br/>
Any guidance is appreciated.</p>
<div class="reply">
<a aria-label="Reply to Rishab Verma" class="comment-reply-link" href="#comment-430901" onclick='return addComment.moveForm( "comment-430901", "430901", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-430954">
<div class="comment-container" id="li-comment-430954">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 3, 2018 at 8:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-430954" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t know how to load neural net weights into an SVM.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430954" onclick='return addComment.moveForm( "comment-430954", "430954", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-431328">
<div class="comment-container" id="li-comment-431328">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/413750cdce03a96735fff4360e27eda2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/413750cdce03a96735fff4360e27eda2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Choi</span>
<span class="date">March 6, 2018 at 2:09 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-431328" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thank you for your tutorials.<br/>
Is there any other ways not to use ‘KerasClassifier’ to fit the model?<br/>
Because I want to train the model with augmented data, which is achieved by using ‘ImageDataGenerator’.</p>
<p>More specifically,</p>
<p>You can change argument X_train, and Y_train with ‘fit()’ function as written below.</p>
<p>history = model.fit(X_train, Y_train, nb_epoch=nb_epoch, batch_size=batch_size, shuffle=True, verbose=1) </p>
<p>However, you can’t change argument X_train, and Y_train using ‘KerasClassifier’ function as written below, because there are no arguments for input data in this function.</p>
<p>model = KerasClassifier(build_fn=create_model, epochs=50, batch_size=1, verbose=0)</p>
<p>Thanks in advance!</p>
<div class="reply">
<a aria-label="Reply to Choi" class="comment-reply-link" href="#comment-431328" onclick='return addComment.moveForm( "comment-431328", "431328", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-431338">
<div class="comment-container" id="li-comment-431338">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 6, 2018 at 2:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-431338" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, you can use the Keras API directly:<br/>
<a href="https://machinelearningmastery.com/5-step-life-cycle-neural-network-models-keras/" rel="nofollow">https://machinelearningmastery.com/5-step-life-cycle-neural-network-models-keras/</a></p>
<p>Here is an example of data augmentation:<br/>
<a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/" rel="nofollow">https://machinelearningmastery.com/image-augmentation-deep-learning-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-431338" onclick='return addComment.moveForm( "comment-431338", "431338", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-435373">
<div class="comment-container" id="li-comment-435373">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/26507b31dad1a74517f5b4b7b21e4185?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/26507b31dad1a74517f5b4b7b21e4185?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Elena Markova</span>
<span class="date">April 19, 2018 at 1:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-435373" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thank you for the article<br/>
Can you explain how the kfold cross validation example with scikit is different from just using validation split = 1/k in keras, when fitting a model? Sorry, Im new to machine learning. Is the only difference is that the validation split opton in keras never changes or shuffles its validation data?</p>
<p>Thanks in advance!</p>
<div class="reply">
<a aria-label="Reply to Elena Markova" class="comment-reply-link" href="#comment-435373" onclick='return addComment.moveForm( "comment-435373", "435373", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-435397">
<div class="comment-container" id="li-comment-435397">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 19, 2018 at 6:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-435397" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>A validation split is a single split of the data. One model evaluated on one dataset.</p>
<p>k-fold cross-validation creates k models evaluated on k disjoint test sets. </p>
<p>It is a better estimate of the skill of the model trained on a random sample of data of a given size. But comes at an increased computational cost, especially for deep learning models that are really slow to train.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435397" onclick='return addComment.moveForm( "comment-435397", "435397", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-438757">
<div class="comment-container" id="li-comment-438757">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ceae233bfd3c9f1f7d8af855cf8897b8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ceae233bfd3c9f1f7d8af855cf8897b8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Saber</span>
<span class="date">May 27, 2018 at 12:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-438757" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have read in a few places that k-fold CV is not very common with DL models as they are computationally heavy. But k-fold CV is also used to pick an “optimal” decision/classification threshold for a desired FPR, FNR, etc. before going to the test data set. Do you have any suggestions on how to do “threshold optimization” with DL models? Is k-fold CV the only option?</p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Saber" class="comment-reply-link" href="#comment-438757" onclick='return addComment.moveForm( "comment-438757", "438757", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-438787">
<div class="comment-container" id="li-comment-438787">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 27, 2018 at 6:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-438787" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Makes sense.</p>
<p>Yes, each split you can estimate the threshold to use from the train data and test it on the hold out fold.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-438787" onclick='return addComment.moveForm( "comment-438787", "438787", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-438829">
<div class="comment-container" id="li-comment-438829">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7b42ece7268c65f87c0b4626b5b75d5f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7b42ece7268c65f87c0b4626b5b75d5f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sazid</span>
<span class="date">May 27, 2018 at 8:59 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-438829" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Which one give me good result keras scikit learn wraper class or general machine learning algorithms like as KNN , SVM,decession tree , random forest tree?<br/>
Please help me.I m in confusion.</p>
<div class="reply">
<a aria-label="Reply to Sazid" class="comment-reply-link" href="#comment-438829" onclick='return addComment.moveForm( "comment-438829", "438829", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-438872">
<div class="comment-container" id="li-comment-438872">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 28, 2018 at 5:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-438872" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>scikit-learn provides those algorithms.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-438872" onclick='return addComment.moveForm( "comment-438872", "438872", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-439441">
<div class="comment-container" id="li-comment-439441">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b6c41541502b7ba97ae180e1547108a8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b6c41541502b7ba97ae180e1547108a8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mik</span>
<span class="date">June 2, 2018 at 1:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-439441" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,</p>
<p>I’ve followed your blog for some time now and I find your posts on ML very useful, as it sort of fills out some of the holes that many documentation sites leave out. For example, your posts on Keras are lightyears ahead of Keras’ own documentation in terms of clarity. So, please keep up the fantastic work mate.</p>
<p>I have run into a periodic problem when using Keras. Far from every time, but occasionally (I’d say 1 in every 10 times or so), the code fails with this error: </p>
<p>Exception ignored in: &lt;bound method BaseSession.__del__ of &gt;<br/>
Traceback (most recent call last):<br/>
  File “/home/mede/virtualenv/lib/python3.5/site-packages/tensorflow/python/client/session.py”, line 707, in __del__</p>
<p>I believe it’s the same error that these stackoverflow posts describe:  <a href="https://stackoverflow.com/questions/40560795/tensorflow-attributeerror-nonetype-object-has-no-attribute-tf-deletestatus" rel="nofollow">https://stackoverflow.com/questions/40560795/tensorflow-attributeerror-nonetype-object-has-no-attribute-tf-deletestatus</a>  and  <a href="https://github.com/tensorflow/tensorflow/issues/3388" rel="nofollow">https://github.com/tensorflow/tensorflow/issues/3388</a>  Naturally, I have tried to apply the fixes that those posts suggest. However, since (as far as I can see) the error occurs within the loop that executes the grid search I cannot delete the Tensorflow session between each run. Do you know if there is, or can you think of, a workaround for this?</p>
<p>Thanks in advance!</p>
<div class="reply">
<a aria-label="Reply to Mik" class="comment-reply-link" href="#comment-439441" onclick='return addComment.moveForm( "comment-439441", "439441", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-439480">
<div class="comment-container" id="li-comment-439480">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2018 at 6:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-439480" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have not seen this before sorry.</p>
<p>Perhaps ensure that all libs and dependent libs are up to date?<br/>
Perhaps move to Py 3.6?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-439480" onclick='return addComment.moveForm( "comment-439480", "439480", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-439701">
<div class="comment-container" id="li-comment-439701">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b6c41541502b7ba97ae180e1547108a8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b6c41541502b7ba97ae180e1547108a8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mik</span>
<span class="date">June 4, 2018 at 7:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-439701" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>OK, I’ll give it a shot, thanks.</p>
<div class="reply">
<a aria-label="Reply to Mik" class="comment-reply-link" href="#comment-439701" onclick='return addComment.moveForm( "comment-439701", "439701", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-443187">
<div class="comment-container" id="li-comment-443187">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fcb602bae02582d516d11ced2f28bad2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fcb602bae02582d516d11ced2f28bad2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chase</span>
<span class="date">July 11, 2018 at 6:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-443187" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the great content!</p>
<p>I’m looking for some guidance on building learning curves that specifically show the training and test error of a sequential keras model as the training examples increases. I’ve put together some code already and have gotten hung up on an error that is making me rethink my approach. Any suggestions would be appreciated.</p>
<p>For reference this is the current error:</p>
<p>TypeError: Cannot clone object ” (type ): it does not seem to be a scikit-learn estimator as it does not implement a ‘get_params’ methods.</p>
<div class="reply">
<a aria-label="Reply to Chase" class="comment-reply-link" href="#comment-443187" onclick='return addComment.moveForm( "comment-443187", "443187", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-443210">
<div class="comment-container" id="li-comment-443210">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 11, 2018 at 2:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-443210" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Here is an example:<br/>
<a href="https://machinelearningmastery.com/display-deep-learning-model-training-history-in-keras/" rel="nofollow">https://machinelearningmastery.com/display-deep-learning-model-training-history-in-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443210" onclick='return addComment.moveForm( "comment-443210", "443210", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-443249">
<div class="comment-container" id="li-comment-443249">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fcb602bae02582d516d11ced2f28bad2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fcb602bae02582d516d11ced2f28bad2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chase</span>
<span class="date">July 12, 2018 at 4:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-443249" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason. I had actually seen that already and it was helpful. Since I’m looking at how the losses change as the number of training examples (not number of epochs) increase I need to train on several subsets of data. In your example mentioned, would you simply loop over what you have while passing the subsetted data? I’ve been trying to use scikit learns learning_curve function while creating a scorer to be used with the sequential model I’m passing.</p>
<p>Got a post at stack overflow if interested.</p>
<p><a href="https://stackoverflow.com/questions/51291980/using-sequential-model-as-estimator-in-learning-curve-function" rel="nofollow">https://stackoverflow.com/questions/51291980/using-sequential-model-as-estimator-in-learning-curve-function</a></p>
<div class="reply">
<a aria-label="Reply to Chase" class="comment-reply-link" href="#comment-443249" onclick='return addComment.moveForm( "comment-443249", "443249", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-444761">
<div class="comment-container" id="li-comment-444761">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f45e448049a62b5102eec70bc646205b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f45e448049a62b5102eec70bc646205b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">cass</span>
<span class="date">July 30, 2018 at 7:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-444761" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason</p>
<p>the first example of using KerasClassifier to do cross validation is only for accuracy. Is there any way to get f1 score or recall. </p>
<p>The neural network always return the probabilities. so for the binary classification, how the cross_val_score works(I tried, it does not work)</p>
<div class="reply">
<a aria-label="Reply to cass" class="comment-reply-link" href="#comment-444761" onclick='return addComment.moveForm( "comment-444761", "444761", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-444784">
<div class="comment-container" id="li-comment-444784">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 30, 2018 at 2:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-444784" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, you can specify any scoring metric you prefer.</p>
<p>Set the “scoring” argument to cross_val_score().</p>
<p>Learn more here:<br/>
<a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_score.html" rel="nofollow">http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_score.html</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444784" onclick='return addComment.moveForm( "comment-444784", "444784", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-447432">
<div class="comment-container" id="li-comment-447432">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ddbcb954c378ac476c084d1ae392530a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ddbcb954c378ac476c084d1ae392530a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Huda</span>
<span class="date">August 31, 2018 at 7:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-447432" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>How about if I have multiple models trained on same data. Can you give an example of using VotingClassifier with keras models??</p>
<p>Thaks!</p>
<div class="reply">
<a aria-label="Reply to Huda" class="comment-reply-link" href="#comment-447432" onclick='return addComment.moveForm( "comment-447432", "447432", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-447468">
<div class="comment-container" id="li-comment-447468">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 1, 2018 at 6:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-447468" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-447468" onclick='return addComment.moveForm( "comment-447468", "447468", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-447927">
<div class="comment-container" id="li-comment-447927">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/68f5f43aab9be0bdb1337aa1aa2d18bc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/68f5f43aab9be0bdb1337aa1aa2d18bc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">tequila rifa</span>
<span class="date">September 5, 2018 at 9:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-447927" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I’ve learnt a lot from your website and books. I really thank you for your help. </p>
<p>An observation I’ve made, looking inside the Ebook: Deep Learning With Python and other books from you.</p>
<p>most / nearly all chapters + code is available on your website as separate blogs, </p>
<p>so what’s the added advantage for someone who purchases the book?</p>
<div class="reply">
<a aria-label="Reply to tequila rifa" class="comment-reply-link" href="#comment-447927" onclick='return addComment.moveForm( "comment-447927", "447927", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-447952">
<div class="comment-container" id="li-comment-447952">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 6, 2018 at 5:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/use-keras-deep-learning-models-scikit-learn-python/#comment-447952" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks!</p>
<p>Yes, I explain more here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/how-are-your-books-different-from-the-blog" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-are-your-books-different-from-the-blog</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-447952" onclick='return addComment.moveForm( "comment-447952", "447952", "respond", "2564" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/use-keras-deep-learning-models-scikit-learn-python/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="2564"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="1ad2b3171e"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="174"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery!</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Jason Brownlee, PhD
<br/>
I write tutorials to help developers (<i>like you</i>) get results with machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-6"> <div class="textwidget"><p></p><center><br/>
<strong>Deep Learning with Python</strong><br/>
No math, just tutorials and working code.
<p><a href="/deep-learning-with-python/">Click to Get Started Now!</a><br/>
<a href="/deep-learning-with-python/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/DeepLearningWithPython-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch"><img alt="How to Develop a Neural Machine Translation System in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/01/How-to-Develop-a-Neural-Machine-Translation-System-in-Keras-150x150.jpg" title="How to Develop a Neural Machine Translation System from Scratch" width="45"/></a> <a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch">How to Develop a Neural Machine Translation System from Scratch</a>
<span class="meta">January 10, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning"><img alt="Difference Between Classification and Regression in Machine Learning" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/Difference-Between-Classification-and-Regression-in-Machine-Learning-150x150.jpg" title="Difference Between Classification and Regression in Machine Learning" width="45"/></a> <a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning">Difference Between Classification and Regression in Machine Learning</a>
<span class="meta">December 11, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem..."><img alt="So, You are Working on a Machine Learning Problem..." class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/So-You-are-Working-on-a-Machine-Learning-Problem...-150x150.jpg" title="So, You are Working on a Machine Learning Problem..." width="45"/></a> <a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem…">So, You are Working on a Machine Learning Problem…</a>
<span class="meta">April 4, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis"><img alt="Plot of the Multichannel Convolutional Neural Network For Text" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-150x150.png" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis" width="45"/></a> <a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis">How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis</a>
<span class="meta">January 12, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras"><img alt="How to Make Classification and Regression Predictions for Deep Learning Models in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/How-to-Make-Classification-and-Regression-Predictions-for-Deep-Learning-Models-in-Keras-150x150.jpg" title="How to Make Predictions with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras">How to Make Predictions with Keras</a>
<span class="meta">April 9, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)"><img alt="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/11-Classical-Time-Series-Forecasting-Methods-in-Python-Cheat-Sheet-150x150.jpg" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)">11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)</a>
<span class="meta">August 6, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras"><img alt="How to Visualize a Deep Learning Neural Network Model in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/How-to-Visualize-a-Deep-Learning-Neural-Network-Model-in-Keras-150x150.jpg" title="How to Visualize a Deep Learning Neural Network Model in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras">How to Visualize a Deep Learning Neural Network Model in Keras</a>
<span class="meta">December 13, 2017</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> <div class="widget_text widget widget_custom_html" id="custom_html-2"><h3>You might also like…</h3><div class="textwidget custom-html-widget"><ul>
<li><a href="/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Install Python for Machine Learning</a></li>
<li><a href="/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python</a></li>
<li><a href="/tutorial-first-neural-network-python-keras/">Your First Neural Network in Python</a></li>
<li><a href="/how-to-run-your-first-classifier-in-weka/">Your First Classifier in Weka</a></li>
<li><a href="/arima-for-time-series-forecasting-with-python/">Your First Time Series Forecasting Project</a></li>
</ul></div></div></aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/disclaimer/">Disclaimer</a> | 
<a href="/terms-of-service/">Terms</a> | 
<a href="/contact/">Contact</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.8" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.0.5" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.8" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.1" type="text/javascript"></script>
</body>
</html>