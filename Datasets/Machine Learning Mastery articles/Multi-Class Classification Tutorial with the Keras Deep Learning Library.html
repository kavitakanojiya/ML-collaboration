<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v9.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Multi-Class Classification Tutorial with the Keras Deep Learning Library</title>
<link href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="Multi-Class Classification Tutorial with the Keras Deep Learning Library" property="og:title"/>
<meta content="Keras is a Python library for deep learning that wraps the efficient numerical libraries Theano and TensorFlow. In this tutorial, you will discover how you can use Keras to develop and evaluate neural network models for multi-class classification problems. After completing this step-by-step tutorial, you will know: How to load data from CSV and make …" property="og:description"/>
<meta content="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="https://www.facebook.com/jason.brownlee.39" property="article:author"/>
<meta content="Deep Learning" property="article:section"/>
<meta content="2016-06-01T19:00:27+00:00" property="article:published_time"/>
<meta content="2017-06-15T05:02:56+00:00" property="article:modified_time"/>
<meta content="2017-06-15T05:02:56+00:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Learning-Library.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Learning-Library.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="427" property="og:image:height"/>
<meta content="Multi-Class Classification Tutorial with the Keras Deep Learning Library" property="og:image:alt"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"https:\/\/machinelearningmastery.com\/#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/feed/" rel="alternate" title="Machine Learning Mastery » Multi-Class Classification Tutorial with the Keras Deep Learning Library Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<style media="all" type="text/css">
.wpautoterms-footer{background-color:#ffffff;text-align:center;}
.wpautoterms-footer a{color:#000000;font-family:Arial, sans-serif;font-size:14px;}
.wpautoterms-footer .separator{color:#cccccc;font-family:Arial, sans-serif;font-size:14px;}</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/auto-terms-of-service-and-privacy-policy/css/wpautoterms.css?ver=4.9.8" id="wpautoterms_css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.0.5" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/css/front.css?ver=2.0.20" id="ssb-front-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/ewd-ufaq-styles.css?ver=4.9.8" id="ewd-ufaq-style-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/rrssb-min.css?ver=4.9.8" id="ewd-ufaq-rrssb-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.8" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=2.0.20" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.8" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.8" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=2567" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fmulti-class-classification-tutorial-keras-deep-learning-library%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fmulti-class-classification-tutorial-keras-deep-learning-library%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<style media="screen">

        .simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
      margin: ;
    }
         /*inline margin*/
    
  
  
  
  
  
          .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
         margin: ;
     }

          /*margin-digbar*/

  
  
  
  
 
   
   

</style>
<script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#4c89bf; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#4c89bf;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#4c89bf!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#ffffff;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-2567 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/icon-100x100.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-32"> <div class="textwidget"><p>Want help with deep learning? <a href="https://machinelearningmastery.lpages.co/deep-learning-with-python-mini-course/">Take the FREE Mini-Course</a></p>
</div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<input name="post_type" type="hidden" value="post"/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Main Menu</h3><ul class="nav fl" id="main-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503" id="menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Start Here</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501" id="menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506" id="menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6508" id="menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (Keras)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511" id="menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509" id="menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515" id="menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">Deep Learning for NLP</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512" id="menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Understand Algorithms</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507" id="menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms (Python)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6513" id="menu-item-6513"><a href="https://machinelearningmastery.com/category/machine-learning-process/">Machine Learning Process</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516" id="menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517" id="menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522" id="menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6518" id="menu-item-6518"><a href="https://machinelearningmastery.com/category/start-machine-learning/">Getting Started</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510" id="menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519" id="menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistical Methods</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520" id="menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Time Series (introductory)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523" id="menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6514" id="menu-item-6514"><a href="https://machinelearningmastery.com/category/machine-learning-resources/">Resources</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502" id="menu-item-6502"><a href="https://machinelearningmastery.com/products/">Ebooks</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500" id="menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504" id="menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505" id="menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-2567 post type-post status-publish format-standard has-post-thumbnail hentry category-deep-learning">
<header>
<h1 class="title entry-title">Multi-Class Classification Tutorial with the Keras Deep Learning Library</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-06-02T05:00:27+1100">June 2, 2016</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/deep-learning/" title="View all items in Deep Learning">Deep Learning</a></span> </div>
<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-2567 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=Multi-Class+Classification+Tutorial+with+the+Keras+Deep+Learning+Library&amp;url=https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
<p>Keras is a Python library for deep learning that wraps the efficient numerical libraries Theano and TensorFlow.</p>
<p>In this tutorial, you will discover how you can use Keras to develop and evaluate neural network models for multi-class classification problems.</p>
<p>After completing this step-by-step tutorial, you will know:</p>
<ul>
<li>How to load data from CSV and make it available to Keras.</li>
<li>How to prepare multi-class classification data for modeling with neural networks.</li>
<li>How to evaluate Keras neural network models with scikit-learn.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Oct/2016</strong>: Updated examples for Keras 1.1.0 and scikit-learn v0.18.</li>
<li><strong>Update Mar/2017</strong>: Updated example for Keras 2.0.2, TensorFlow 1.0.1 and Theano 0.9.0.</li>
<li><strong>Update Jun/2017</strong>: Updated example to use softmax activation in output layer, larger hidden layer, default weight initialization.</li>
</ul>
<div class="wp-caption aligncenter" id="attachment_2568" style="width: 650px"><img alt="Multi-Class Classification Tutorial with the Keras Deep Learning Library" class="size-full wp-image-2568" height="427" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Learning-Library.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Learning-Library.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/Multi-Class-Classification-Tutorial-with-the-Keras-Deep-Learning-Library-300x200.jpg 300w" width="640"/><p class="wp-caption-text">Multi-Class Classification Tutorial with the Keras Deep Learning Library<br/>Photo by <a href="https://www.flickr.com/photos/hourou/8922014724/">houroumono</a>, some rights reserved.</p></div>
<h2>1. Problem Description</h2>
<p>In this tutorial, we will use the standard machine learning problem called the <a href="http://archive.ics.uci.edu/ml/datasets/Iris">iris flowers dataset</a>.</p>
<p>This dataset is well studied and is a good problem for practicing on neural networks because all of the 4 input variables are numeric and have the same scale in centimeters. Each instance describes the properties of an observed flower measurements and the output variable is specific iris species.</p>
<p>This is a multi-class classification problem, meaning that there are more than two classes to be predicted, in fact there are three flower species. This is an important type of problem on which to practice with neural networks because the three class values require specialized handling.</p>
<p>The iris flower dataset is a well-studied problem and a such we can <a href="http://www.is.umk.pl/projects/rules.html#Iris">expect to achieve a model accuracy</a> in the range of 95% to 97%. This provides a good target to aim for when developing our models.</p>
<p>You can <a href="http://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data">download the iris flowers dataset</a> from the UCI Machine Learning repository and place it in your current working directory with the filename “<em>iris.csv</em>“.</p>
<p></p><div class="woo-sc-hr"></div>
<center>
<h3>Need help with Deep Learning in Python?</h3>
<p>Take my free 2-week email course and discover MLPs, CNNs and LSTMs (with code).</p>
<p>Click to sign-up now and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" rel="noopener" style="color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.247059) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.498039) 0px 1px 3px inset, rgba(0, 0, 0, 0.498039) 0px 1px 3px; background: #ffce0a;" target="_blank">Start Your FREE Mini-Course Now!</a> <script data-config="%7B%7D" data-leadbox="142d6e873f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" src="https://machinelearningmastery.leadpages.co/leadbox-1463166699.js" type="text/javascript"></script></p>
</center>
<p></p><div class="woo-sc-hr"></div>
<h2>2. Import Classes and Functions</h2>
<p>We can begin by importing all of the classes and functions we will need in this tutorial.</p>
<p>This includes both the functionality we require from Keras, but also data loading from <a href="http://pandas.pydata.org/">pandas</a> as well as data preparation and model evaluation from <a href="http://scikit-learn.org/">scikit-learn</a>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7b88b898662291841" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
import numpy
import pandas
from keras.models import Sequential
from keras.layers import Dense
from keras.wrappers.scikit_learn import KerasClassifier
from keras.utils import np_utils
from sklearn.model_selection import cross_val_score
from sklearn.model_selection import KFold
from sklearn.preprocessing import LabelEncoder
from sklearn.pipeline import Pipeline</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7b88b898662291841-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b88b898662291841-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7b88b898662291841-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b88b898662291841-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7b88b898662291841-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b88b898662291841-6">6</div><div class="crayon-num" data-line="crayon-5c0ca7b88b898662291841-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b88b898662291841-8">8</div><div class="crayon-num" data-line="crayon-5c0ca7b88b898662291841-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b88b898662291841-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7b88b898662291841-1"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b88b898662291841-2"><span class="crayon-e">import </span><span class="crayon-e">pandas</span></div><div class="crayon-line" id="crayon-5c0ca7b88b898662291841-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b88b898662291841-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line" id="crayon-5c0ca7b88b898662291841-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">wrappers</span><span class="crayon-sy">.</span><span class="crayon-e">scikit_learn </span><span class="crayon-e">import </span><span class="crayon-e">KerasClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b88b898662291841-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">np_utils</span></div><div class="crayon-line" id="crayon-5c0ca7b88b898662291841-7"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">cross_val_score</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b88b898662291841-8"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">KFold</span></div><div class="crayon-line" id="crayon-5c0ca7b88b898662291841-9"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">LabelEncoder</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b88b898662291841-10"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">pipeline </span><span class="crayon-e">import </span><span class="crayon-v">Pipeline</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>
<h2>3. Initialize Random Number Generator</h2>
<p>Next, we need to initialize the random number generator to a constant value (7).</p>
<p>This is important to ensure that the results we achieve from this model can be achieved again precisely. It ensures that the stochastic process of training a neural network model can be reproduced.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7b88b8a0347652727" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7b88b8a0347652727-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b88b8a0347652727-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7b88b8a0347652727-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7b88b8a0347652727-1"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b88b8a0347652727-2"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line" id="crayon-5c0ca7b88b8a0347652727-3"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<h2>4. Load The Dataset</h2>
<p>The dataset can be loaded directly. Because the output variable contains strings, it is easiest to load the data using pandas. We can then split the attributes (columns) into input variables (X) and output variables (Y).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7b88b8a2325441054" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load dataset
dataframe = pandas.read_csv("iris.csv", header=None)
dataset = dataframe.values
X = dataset[:,0:4].astype(float)
Y = dataset[:,4]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7b88b8a2325441054-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b88b8a2325441054-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7b88b8a2325441054-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b88b8a2325441054-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7b88b8a2325441054-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7b88b8a2325441054-1"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b88b8a2325441054-2"><span class="crayon-v">dataframe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pandas</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">"iris.csv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-v">None</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b88b8a2325441054-3"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-i">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b88b8a2325441054-4"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-t">float</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b88b8a2325441054-5"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<h2>5. Encode The Output Variable</h2>
<p>The output variable contains three different string values.</p>
<p>When modeling multi-class classification problems using neural networks, it is good practice to reshape the output attribute from a vector that contains values for each class value to be a matrix with a boolean for each class value and whether or not a given instance has that class value or not.</p>
<p>This is called <a href="https://en.wikipedia.org/wiki/One-hot">one hot encoding</a> or creating dummy variables from a categorical variable.</p>
<p>For example, in this problem three class values are Iris-setosa, Iris-versicolor and Iris-virginica. If we had the observations:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7b88b8a4952812914" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Iris-setosa
Iris-versicolor
Iris-virginica</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7b88b8a4952812914-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b88b8a4952812914-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7b88b8a4952812914-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7b88b8a4952812914-1">Iris-setosa</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b88b8a4952812914-2">Iris-versicolor</div><div class="crayon-line" id="crayon-5c0ca7b88b8a4952812914-3">Iris-virginica</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can turn this into a one-hot encoded binary matrix for each data instance that would look as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7b88b8a6296259190" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Iris-setosa,	Iris-versicolor,	Iris-virginica
1,		0,			0
0,		1, 			0
0, 		0, 			1</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7b88b8a6296259190-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b88b8a6296259190-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7b88b8a6296259190-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b88b8a6296259190-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7b88b8a6296259190-1">Iris-setosa,	Iris-versicolor,	Iris-virginica</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b88b8a6296259190-2">1,		0,			0</div><div class="crayon-line" id="crayon-5c0ca7b88b8a6296259190-3">0,		1, 			0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b88b8a6296259190-4">0, 		0, 			1</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can do this by first encoding the strings consistently to integers using the scikit-learn class LabelEncoder. Then convert the vector of integers to a one hot encoding using the Keras function to_categorical().</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7b88b8a8571953649" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# encode class values as integers
encoder = LabelEncoder()
encoder.fit(Y)
encoded_Y = encoder.transform(Y)
# convert integers to dummy variables (i.e. one hot encoded)
dummy_y = np_utils.to_categorical(encoded_Y)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7b88b8a8571953649-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b88b8a8571953649-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7b88b8a8571953649-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b88b8a8571953649-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7b88b8a8571953649-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b88b8a8571953649-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7b88b8a8571953649-1"><span class="crayon-p"># encode class values as integers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b88b8a8571953649-2"><span class="crayon-v">encoder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LabelEncoder</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b88b8a8571953649-3"><span class="crayon-v">encoder</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">Y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b88b8a8571953649-4"><span class="crayon-v">encoded_Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">encoder</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">Y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b88b8a8571953649-5"><span class="crayon-p"># convert integers to dummy variables (i.e. one hot encoded)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b88b8a8571953649-6"><span class="crayon-v">dummy_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np_utils</span><span class="crayon-sy">.</span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_Y</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<h2>6. Define The Neural Network Model</h2>
<p>The Keras library provides wrapper classes to allow you to use neural network models developed with Keras in scikit-learn.</p>
<p>There is a KerasClassifier class in Keras that can be used as an Estimator in scikit-learn, the base type of model in the library. The KerasClassifier takes the name of a function as an argument. This function must return the constructed neural network model, ready for training.</p>
<p>Below is a function that will create a baseline neural network for the iris classification problem. It creates a simple fully connected network with one hidden layer that contains 8 neurons.</p>
<p>The hidden layer uses a rectifier activation function which is a good practice. Because we used a one-hot encoding for our iris dataset, the output layer must create 3 output values, one for each class. The output value with the largest value will be taken as the class predicted by the model.</p>
<p>The network topology of this simple one-layer neural network can be summarized as:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7b88b8a9242055346" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
4 inputs -&gt; [8 hidden nodes] -&gt; 3 outputs</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7b88b8a9242055346-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7b88b8a9242055346-1">4 inputs -&gt; [8 hidden nodes] -&gt; 3 outputs</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Note that we use a “<em>softmax</em>” activation function in the output layer. This is to ensure the output values are in the range of 0 and 1 and may be used as predicted probabilities.</p>
<p>Finally, the network uses the efficient Adam gradient descent optimization algorithm with a logarithmic loss function, which is called “<em>categorical_crossentropy</em>” in Keras.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7b88b8ad705575327" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# define baseline model
def baseline_model():
	# create model
	model = Sequential()
	model.add(Dense(8, input_dim=4, activation='relu'))
	model.add(Dense(3, activation='softmax'))
	# Compile model
	model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])
	return model</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7b88b8ad705575327-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b88b8ad705575327-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7b88b8ad705575327-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b88b8ad705575327-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7b88b8ad705575327-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b88b8ad705575327-6">6</div><div class="crayon-num" data-line="crayon-5c0ca7b88b8ad705575327-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b88b8ad705575327-8">8</div><div class="crayon-num" data-line="crayon-5c0ca7b88b8ad705575327-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7b88b8ad705575327-1"><span class="crayon-p"># define baseline model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b88b8ad705575327-2"><span class="crayon-e">def </span><span class="crayon-e">baseline_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7b88b8ad705575327-3"><span class="crayon-h"> </span><span class="crayon-p"># create model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b88b8ad705575327-4"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b88b8ad705575327-5"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b88b8ad705575327-6"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b88b8ad705575327-7"><span class="crayon-h"> </span><span class="crayon-p"># Compile model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b88b8ad705575327-8"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b88b8ad705575327-9"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>We can now create our KerasClassifier for use in scikit-learn.</p>
<p>We can also pass arguments in the construction of the KerasClassifier class that will be passed on to the fit() function internally used to train the neural network. Here, we pass the number of epochs as 200 and batch size as 5 to use when training the model. Debugging is also turned off when training by setting verbose to 0.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7b88b8af225750229" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
estimator = KerasClassifier(build_fn=baseline_model, epochs=200, batch_size=5, verbose=0)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7b88b8af225750229-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7b88b8af225750229-1"><span class="crayon-v">estimator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">baseline_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">200</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<h2>7. Evaluate The Model with k-Fold Cross Validation</h2>
<p>We can now evaluate the neural network model on our training data.</p>
<p>The scikit-learn has excellent capability to evaluate models using a suite of techniques. The gold standard for evaluating machine learning models is k-fold cross validation.</p>
<p>First we can define the model evaluation procedure. Here, we set the number of folds to be 10 (an excellent default) and to shuffle the data before partitioning it.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7b88b8b0332752228" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
kfold = KFold(n_splits=10, shuffle=True, random_state=seed)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7b88b8b0332752228-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7b88b8b0332752228-1"><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_splits</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Now we can evaluate our model (estimator) on our dataset (X and dummy_y) using a 10-fold cross-validation procedure (kfold).</p>
<p>Evaluating the model only takes approximately 10 seconds and returns an object that describes the evaluation of the 10 constructed models for each of the splits of the dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7b88b8b2452195314" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
results = cross_val_score(estimator, X, dummy_y, cv=kfold)
print("Baseline: %.2f%% (%.2f%%)" % (results.mean()*100, results.std()*100))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7b88b8b2452195314-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b88b8b2452195314-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7b88b8b2452195314-1"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dummy_y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-v">kfold</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b88b8b2452195314-2"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Baseline: %.2f%% (%.2f%%)"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>The results are summarized as both the mean and standard deviation of the model accuracy on the dataset. This is a reasonable estimation of the performance of the model on unseen data. It is also within the realm of known top results for this problem.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7b88b8b4862741229" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Accuracy: 97.33% (4.42%)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7b88b8b4862741229-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7b88b8b4862741229-1">Accuracy: 97.33% (4.42%)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p></p>
<h2>Summary</h2>
<p>In this post you discovered how to develop and evaluate a neural network using the Keras Python library for deep learning.</p>
<p>By completing this tutorial, you learned:</p>
<ul>
<li>How to load data and make it available to Keras.</li>
<li>How to prepare multi-class classification data for modeling using one hot encoding.</li>
<li>How to use Keras neural network models with scikit-learn.</li>
<li>How to define a neural network using Keras for multi-class classification.</li>
<li>How to evaluate a Keras neural network model using scikit-learn with k-fold cross validation</li>
</ul>
<p>Do you have any questions about deep learning with Keras or this post?</p>
<p>Ask your questions in the comments below and I will do my best to answer them.</p>
<!-- Shortcoder conditions not met -->
<div class="awac-wrapper"><div class="awac widget text-35"> <div class="textwidget"><div class="woo-sc-hr"></div>
<h2 style="text-align: center;">Frustrated With Your Progress In Deep Learning?</h2>
<p><a href="/deep-learning-with-python/"><img align="left" alt="Deep Learning with Python" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/DeepLearningWithPython-220.png" style="border: 0;"/></a></p>
<h4 style="text-align: center;"> What If You Could Develop A Network in Minutes</h4>
<p style="text-align: center;">…with just a few lines of Python</p>
<p style="text-align: center;">Discover how in my new Ebook: <a href="https://machinelearningmastery.com/deep-learning-with-python/">Deep Learning With Python</a></p>
<p style="text-align: center;">It covers <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> on topics like:<br/>
<em>Multilayer Perceptrons</em>, <em>Convolutional Nets</em> and <em>Recurrent Neural Nets</em>, and more…</p>
<h4 style="text-align: center;">Finally Bring Deep Learning To<br/>
Your Own Projects</h4>
<p style="text-align: center;">Skip the Academics. Just Results.</p>
<p style="text-align: center;"><a href="https://machinelearningmastery.com/deep-learning-with-python/">Click to learn more</a>.</p>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-2567 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=Multi-Class+Classification+Tutorial+with+the+Keras+Deep+Learning+Library&amp;url=https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
</section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/compare-machine-learning-algorithms-python-scikit-learn/" rel="prev"><i class="fa fa-angle-left"></i> How To Compare Machine Learning Algorithms in Python with scikit-learn</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/ensemble-machine-learning-algorithms-python-scikit-learn/" rel="next">Ensemble Machine Learning Algorithms in Python with scikit-learn <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">390 Responses to <em>Multi-Class Classification Tutorial with the Keras Deep Learning Library</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-354404">
<div class="comment-container" id="li-comment-354404">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0c799148f54e08a8b608ac5fe3eb5811?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0c799148f54e08a8b608ac5fe3eb5811?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jack</span>
<span class="date">June 19, 2016 at 3:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-354404" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for this cool tutorial! I have a question about the input data. If the datatypes of input variables are different (i.e. string and numeric). How to preprocess the train data to fit keras?</p>
<div class="reply">
<a aria-label="Reply to Jack" class="comment-reply-link" href="#comment-354404" onclick='return addComment.moveForm( "comment-354404", "354404", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-354449">
<div class="comment-container" id="li-comment-354449">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 20, 2016 at 5:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-354449" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question. Eventually, all of the data need to be turned into real values.</p>
<p>With categorical variables, you can create dummy variables and use one-hot encoding. For string data, you can use word embeddings.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-354449" onclick='return addComment.moveForm( "comment-354449", "354449", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-387003">
<div class="comment-container" id="li-comment-387003">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/de0346b9d3c6eec1627009341025aa09?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/de0346b9d3c6eec1627009341025aa09?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shraddha</span>
<span class="date">February 10, 2017 at 8:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-387003" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Could you please let me know how to convert string data into word embeddings in large datasets?<br/>
Would really appreciate it<br/>
Thanks so much</p>
<div class="reply">
<a aria-label="Reply to Shraddha" class="comment-reply-link" href="#comment-387003" onclick='return addComment.moveForm( "comment-387003", "387003", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-387107">
<div class="comment-container" id="li-comment-387107">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 11, 2017 at 5:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-387107" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Shraddha,</p>
<p>First, convert the chars to vectors of integers. You can then pad all vectors to the same length. Then away you go.</p>
<p>I hope that helps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-387107" onclick='return addComment.moveForm( "comment-387107", "387107", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-387717">
<div class="comment-container" id="li-comment-387717">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/de0346b9d3c6eec1627009341025aa09?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/de0346b9d3c6eec1627009341025aa09?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shraddha Sunil</span>
<span class="date">February 13, 2017 at 4:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-387717" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks so much Jason!</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-387882">
<div class="comment-container" id="li-comment-387882">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 14, 2017 at 10:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-387882" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-5" id="comment-408640">
<div class="comment-container" id="li-comment-408640">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d64c80a78c936a88939437ab8be7599e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d64c80a78c936a88939437ab8be7599e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sasi</span>
<span class="date">August 5, 2017 at 7:51 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-408640" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>can you give an example for that..</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-408692">
<div class="comment-container" id="li-comment-408692">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 6, 2017 at 7:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-408692" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have many tutorials for encoding and padding sequences on the blog. Please use the search.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-435584">
<div class="comment-container" id="li-comment-435584">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/57b1849ea308e33f3ae6038bb5d20a19?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/57b1849ea308e33f3ae6038bb5d20a19?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Harale Vandana Rangrao</span>
<span class="date">April 21, 2018 at 5:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-435584" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you very much, sir, for sharing so much information, but sir I want to a dataset of greenhouse for tomato crop with climate variable like Temperature, Humidity, Soil Moisture, pH Scale, CO2, Light Intensity. Can you provide me this type dataset?</p>
<div class="reply">
<a aria-label="Reply to Harale Vandana Rangrao" class="comment-reply-link" href="#comment-435584" onclick='return addComment.moveForm( "comment-435584", "435584", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-435620">
<div class="comment-container" id="li-comment-435620">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 22, 2018 at 5:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-435620" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I answer this question here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/where-can-i-get-a-dataset-on-___" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/where-can-i-get-a-dataset-on-___</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435620" onclick='return addComment.moveForm( "comment-435620", "435620", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-355669">
<div class="comment-container" id="li-comment-355669">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4ceccd16a420a71f33438c122e3ee027?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4ceccd16a420a71f33438c122e3ee027?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aakash Nain</span>
<span class="date">July 4, 2016 at 2:25 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-355669" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,<br/>
It’s a very nice tutorial to learn. I implemented the same model but on my work station I achieved a score of 88.67% only. After modifying the number of hidden layers, I achieved an accuracy of 93.04%. But I am not able to achieve the score of 95% or above. Any particular reason behind it ?</p>
<div class="reply">
<a aria-label="Reply to Aakash Nain" class="comment-reply-link" href="#comment-355669" onclick='return addComment.moveForm( "comment-355669", "355669", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-355770">
<div class="comment-container" id="li-comment-355770">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 6, 2016 at 6:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-355770" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Interesting Aakash. </p>
<p>I used the Theano backend. Are you using the same? </p>
<p>Are all your libraries up to date? (Keras, Theano, NumPy, etc…)</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-355770" onclick='return addComment.moveForm( "comment-355770", "355770", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-355856">
<div class="comment-container" id="li-comment-355856">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4ceccd16a420a71f33438c122e3ee027?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4ceccd16a420a71f33438c122e3ee027?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aakash Nain</span>
<span class="date">July 7, 2016 at 12:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-355856" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes Jason . Backend is theano and all libraries are up to date.</p>
<div class="reply">
<a aria-label="Reply to Aakash Nain" class="comment-reply-link" href="#comment-355856" onclick='return addComment.moveForm( "comment-355856", "355856", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-355908">
<div class="comment-container" id="li-comment-355908">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 7, 2016 at 9:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-355908" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Interesting. Perhaps seeding the random number generator is not having the desired effect for reproducibility. It perhaps it has different effects on different platforms.</p>
<p>Perhaps re-run the above code example a few times and see the spread of accuracy scores you achieve?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-355908" onclick='return addComment.moveForm( "comment-355908", "355908", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-355738">
<div class="comment-container" id="li-comment-355738">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a70dc8102aaca33955bb290217f96267?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a70dc8102aaca33955bb290217f96267?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">La Tuan Nghia</span>
<span class="date">July 6, 2016 at 1:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-355738" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>In chapter 10 of the book “Deep Learning With Python”, there is a fraction of code:</p>
<p>estimator = KerasClassifier(build_fn=baseline_model, nb_epoch=200, batch_size=5, verbose=0)<br/>
kfold = KFold(n=len(X), n_folds=10, shuffle=True, random_state=seed)<br/>
results = cross_val_score(estimator, X, dummy_y, cv=kfold)<br/>
print(“Accuracy: %.2f%% (%.2f%%)” % (results.mean()*100, results.std()*100))</p>
<p>How to save this model and weights to file, then how to load these file to predict a new input data? </p>
<p>Many thanks!</p>
<div class="reply">
<a aria-label="Reply to La Tuan Nghia" class="comment-reply-link" href="#comment-355738" onclick='return addComment.moveForm( "comment-355738", "355738", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-355769">
<div class="comment-container" id="li-comment-355769">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 6, 2016 at 6:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-355769" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Really good question.</p>
<p>Keras does provide functions to save network weights to HDF5 and network structure to JSON or YAML. The problem is, once you wrap the network in a scikit-learn classifier, how do you access the model and save it. Or can you save the whole wrapped model. </p>
<p>Perhaps a simple but inefficient place to start would be to try and simply pickle the whole classifier?<br/>
<a href="https://docs.python.org/2/library/pickle.html" rel="nofollow">https://docs.python.org/2/library/pickle.html</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-355769" onclick='return addComment.moveForm( "comment-355769", "355769", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-358321">
<div class="comment-container" id="li-comment-358321">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8453ffaaec42b286620b10b496ae6178?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8453ffaaec42b286620b10b496ae6178?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Constantin Weisser</span>
<span class="date">July 30, 2016 at 4:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-358321" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I tried doing that. It works for a normal sklearn classifier, but apparently not for a Keras Classifier:</p>
<p>import pickle<br/>
with open(“name.p”,”wb”) as fw:<br/>
    pickle.dump(clf,fw)</p>
<p>with open(name+”.p”,”rb”) as fr:<br/>
    clf_saved = pickle.load(fr)<br/>
print(clf_saved)</p>
<p>prob_pred=clf_saved.predict_proba(X_test)[:,1]</p>
<p>This gives:</p>
<p>theano.gof.fg.MissingInputError: An input of the graph, used to compute DimShuffle{x,x}(keras_learning_phase), was not provided and not given a value.Use the Theano flag exception_verbosity=’high’,for more information on this error.</p>
<p>Backtrace when the variable is created:<br/>
  File “nn_systematics_I_evaluation_of_optimised_classifiers.py”, line 6, in<br/>
    import classifier_eval_simplified<br/>
  File “../../../../classifier_eval_simplified.py”, line 26, in<br/>
    from keras.utils import np_utils<br/>
  File “/usr/local/lib/python2.7/site-packages/keras/__init__.py”, line 2, in<br/>
    from . import backend<br/>
  File “/usr/local/lib/python2.7/site-packages/keras/backend/__init__.py”, line 56, in<br/>
    from .theano_backend import *<br/>
  File “/usr/local/lib/python2.7/site-packages/keras/backend/theano_backend.py”, line 17, in<br/>
    _LEARNING_PHASE = T.scalar(dtype=’uint8′, name=’keras_learning_phase’)  # 0 = test, 1 = train</p>
<div class="reply">
<a aria-label="Reply to Constantin Weisser" class="comment-reply-link" href="#comment-358321" onclick='return addComment.moveForm( "comment-358321", "358321", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-358330">
<div class="comment-container" id="li-comment-358330">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 30, 2016 at 7:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-358330" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I provide examples of saving and loading Keras models here:<br/>
<a href="http://machinelearningmastery.com/save-load-keras-deep-learning-models/" rel="nofollow">http://machinelearningmastery.com/save-load-keras-deep-learning-models/</a></p>
<p>Sorry, I don’t have any examples of saving/loading the wrapped Keras classifier. Perhaps the internal model can be seralized and later deserialized and put back inside the wrapper.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-358330" onclick='return addComment.moveForm( "comment-358330", "358330", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-356849">
<div class="comment-container" id="li-comment-356849">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c0803e22c3adad9b13335f3af988b135?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c0803e22c3adad9b13335f3af988b135?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sally</span>
<span class="date">July 15, 2016 at 4:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-356849" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Dr. Jason, </p>
<p>Thanks very much for this great tutorial . I got extra benefit from it, but I need to calculate precision, recall and confusion matrix for such multi-class classification. I tried to did it but each time I got a different problem. could you please explain me how to do this</p>
<div class="reply">
<a aria-label="Reply to Sally" class="comment-reply-link" href="#comment-356849" onclick='return addComment.moveForm( "comment-356849", "356849", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-356873">
<div class="comment-container" id="li-comment-356873">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 15, 2016 at 9:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-356873" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Sally, you could perhaps use the tools in scikit-learn to summarize the performance of your model.</p>
<p>For example, you could use sklearn.metrics.confusion_matrix() to calculate the confusion matrix for predictions, etc.</p>
<p>See the metrics package:<br/>
<a href="http://scikit-learn.org/stable/modules/classes.html#module-sklearn.metrics" rel="nofollow">http://scikit-learn.org/stable/modules/classes.html#module-sklearn.metrics</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-356873" onclick='return addComment.moveForm( "comment-356873", "356873", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-434874">
<div class="comment-container" id="li-comment-434874">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e5ef8d4913ce3ae3f37d6ea90d0516f7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e5ef8d4913ce3ae3f37d6ea90d0516f7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Prabhat</span>
<span class="date">April 13, 2018 at 5:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-434874" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Could you tell how to use that in this code you have provided above? I am very new Keras. </p>
<p>Thanks in Advance</p>
<div class="reply">
<a aria-label="Reply to Prabhat" class="comment-reply-link" href="#comment-434874" onclick='return addComment.moveForm( "comment-434874", "434874", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-445175">
<div class="comment-container" id="li-comment-445175">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/91bb55f7e03c2d5eda133402d6144e7f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/91bb55f7e03c2d5eda133402d6144e7f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">olfa</span>
<span class="date">August 3, 2018 at 11:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-445175" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>please how we can implemente python code  using recall and precision to evaluate prediction model</p>
<div class="reply">
<a aria-label="Reply to olfa" class="comment-reply-link" href="#comment-445175" onclick='return addComment.moveForm( "comment-445175", "445175", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-3" id="comment-445204">
<div class="comment-container" id="li-comment-445204">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 4, 2018 at 6:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-445204" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can use the sklearn library to calculate these scores:<br/>
<a href="http://scikit-learn.org/stable/modules/classes.html#sklearn-metrics-metrics" rel="nofollow">http://scikit-learn.org/stable/modules/classes.html#sklearn-metrics-metrics</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-445204" onclick='return addComment.moveForm( "comment-445204", "445204", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-358407">
<div class="comment-container" id="li-comment-358407">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3876ac4d993538404499cb1dc2fdc5f6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3876ac4d993538404499cb1dc2fdc5f6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.sundevs.com" rel="external nofollow">Fabian Leon</a></span>
<span class="date">July 31, 2016 at 4:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-358407" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi jason, Reading the tutorial and the same example in your book, you still don’t tell us how can use the model to make predictions, you have only show us how to train and evaluate it but I would like to see you using this model to make predictions on at least one example of iris flowers data no matters if is dummy data.</p>
<p>I would like to see how can I load my own instance of an iris-flower and use the above model to predict what kind is the flower?</p>
<p>could you do that for us?</p>
<div class="reply">
<a aria-label="Reply to Fabian Leon" class="comment-reply-link" href="#comment-358407" onclick='return addComment.moveForm( "comment-358407", "358407", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-358418">
<div class="comment-container" id="li-comment-358418">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 31, 2016 at 7:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-358418" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Fabian, no problem.</p>
<p>In the tutorial above, we are using the scikit-learn wrapper. That means we can use the standard model.predict() function to make predictions from scikit-learn.</p>
<p>For example, below is an an example adapted from the above where we split the dataset, train on 67% and make predictions on 33%. Remember that we have encoded the output class value as integers, so the predictions are integers. We can then use encoder.inverse_transform() to turn the predicted integers back into strings.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7b89287f502970040" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Train model and make predictions
import numpy
import pandas
from keras.models import Sequential
from keras.layers import Dense
from keras.wrappers.scikit_learn import KerasClassifier
from keras.utils import np_utils
from sklearn.cross_validation import train_test_split
from sklearn.preprocessing import LabelEncoder
# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)
# load dataset
dataframe = pandas.read_csv("iris.csv", header=None)
dataset = dataframe.values
X = dataset[:,0:4].astype(float)
Y = dataset[:,4]
# encode class values as integers
encoder = LabelEncoder()
encoder.fit(Y)
encoded_Y = encoder.transform(Y)
# convert integers to dummy variables (i.e. one hot encoded)
dummy_y = np_utils.to_categorical(encoded_Y)
# define baseline model
def baseline_model():
	# create model
	model = Sequential()
	model.add(Dense(4, input_dim=4, init='normal', activation='relu'))
	model.add(Dense(3, init='normal', activation='sigmoid'))
	# Compile model
	model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])
	return model
estimator = KerasClassifier(build_fn=baseline_model, nb_epoch=200, batch_size=5, verbose=0)
X_train, X_test, Y_train, Y_test = train_test_split(X, dummy_y, test_size=0.33, random_state=seed)
estimator.fit(X_train, Y_train)
predictions = estimator.predict(X_test)
print(predictions)
print(encoder.inverse_transform(predictions))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7b89287f502970040-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b89287f502970040-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7b89287f502970040-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b89287f502970040-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7b89287f502970040-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b89287f502970040-6">6</div><div class="crayon-num" data-line="crayon-5c0ca7b89287f502970040-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b89287f502970040-8">8</div><div class="crayon-num" data-line="crayon-5c0ca7b89287f502970040-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b89287f502970040-10">10</div><div class="crayon-num" data-line="crayon-5c0ca7b89287f502970040-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b89287f502970040-12">12</div><div class="crayon-num" data-line="crayon-5c0ca7b89287f502970040-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b89287f502970040-14">14</div><div class="crayon-num" data-line="crayon-5c0ca7b89287f502970040-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b89287f502970040-16">16</div><div class="crayon-num" data-line="crayon-5c0ca7b89287f502970040-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b89287f502970040-18">18</div><div class="crayon-num" data-line="crayon-5c0ca7b89287f502970040-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b89287f502970040-20">20</div><div class="crayon-num" data-line="crayon-5c0ca7b89287f502970040-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b89287f502970040-22">22</div><div class="crayon-num" data-line="crayon-5c0ca7b89287f502970040-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b89287f502970040-24">24</div><div class="crayon-num" data-line="crayon-5c0ca7b89287f502970040-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b89287f502970040-26">26</div><div class="crayon-num" data-line="crayon-5c0ca7b89287f502970040-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b89287f502970040-28">28</div><div class="crayon-num" data-line="crayon-5c0ca7b89287f502970040-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b89287f502970040-30">30</div><div class="crayon-num" data-line="crayon-5c0ca7b89287f502970040-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b89287f502970040-32">32</div><div class="crayon-num" data-line="crayon-5c0ca7b89287f502970040-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b89287f502970040-34">34</div><div class="crayon-num" data-line="crayon-5c0ca7b89287f502970040-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b89287f502970040-36">36</div><div class="crayon-num" data-line="crayon-5c0ca7b89287f502970040-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b89287f502970040-38">38</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7b89287f502970040-1"><span class="crayon-p"># Train model and make predictions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b89287f502970040-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5c0ca7b89287f502970040-3"><span class="crayon-e">import </span><span class="crayon-e">pandas</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b89287f502970040-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5c0ca7b89287f502970040-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b89287f502970040-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">wrappers</span><span class="crayon-sy">.</span><span class="crayon-e">scikit_learn </span><span class="crayon-e">import </span><span class="crayon-e">KerasClassifier</span></div><div class="crayon-line" id="crayon-5c0ca7b89287f502970040-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">np_utils</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b89287f502970040-8"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">cross_validation </span><span class="crayon-e">import </span><span class="crayon-e">train_test_split</span></div><div class="crayon-line" id="crayon-5c0ca7b89287f502970040-9"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-v">LabelEncoder</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b89287f502970040-10"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line" id="crayon-5c0ca7b89287f502970040-11"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b89287f502970040-12"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b89287f502970040-13"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b89287f502970040-14"><span class="crayon-v">dataframe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pandas</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">"iris.csv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-v">None</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b89287f502970040-15"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-i">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b89287f502970040-16"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-t">float</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b89287f502970040-17"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b89287f502970040-18"><span class="crayon-p"># encode class values as integers</span></div><div class="crayon-line" id="crayon-5c0ca7b89287f502970040-19"><span class="crayon-v">encoder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LabelEncoder</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b89287f502970040-20"><span class="crayon-v">encoder</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">Y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b89287f502970040-21"><span class="crayon-v">encoded_Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">encoder</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">Y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b89287f502970040-22"><span class="crayon-p"># convert integers to dummy variables (i.e. one hot encoded)</span></div><div class="crayon-line" id="crayon-5c0ca7b89287f502970040-23"><span class="crayon-v">dummy_y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np_utils</span><span class="crayon-sy">.</span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_Y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b89287f502970040-24"><span class="crayon-p"># define baseline model</span></div><div class="crayon-line" id="crayon-5c0ca7b89287f502970040-25"><span class="crayon-e">def </span><span class="crayon-e">baseline_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b89287f502970040-26"><span class="crayon-h"> </span><span class="crayon-p"># create model</span></div><div class="crayon-line" id="crayon-5c0ca7b89287f502970040-27"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b89287f502970040-28"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">init</span><span class="crayon-o">=</span><span class="crayon-s">'normal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b89287f502970040-29"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">init</span><span class="crayon-o">=</span><span class="crayon-s">'normal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b89287f502970040-30"><span class="crayon-h"> </span><span class="crayon-p"># Compile model</span></div><div class="crayon-line" id="crayon-5c0ca7b89287f502970040-31"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b89287f502970040-32"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">model</span></div><div class="crayon-line" id="crayon-5c0ca7b89287f502970040-33"><span class="crayon-v">estimator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">baseline_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nb_epoch</span><span class="crayon-o">=</span><span class="crayon-cn">200</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b89287f502970040-34"><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">train_test_split</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dummy_y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_size</span><span class="crayon-o">=</span><span class="crayon-cn">0.33</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b89287f502970040-35"><span class="crayon-v">estimator</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y_train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b89287f502970040-36"><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">estimator</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b89287f502970040-37"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b89287f502970040-38"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">encoder</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0021 seconds] -->
<p></p>
<p>Running this example prints:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7b892882472509363" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
[2 1 0 1 2 0 1 1 0 1 2 1 0 2 0 2 2 2 0 0 1 2 1 2 2 2 1 1 2 2 2 1 0 2 1 0 0
 0 0 2 2 1 2 2 1 0 1 1 2 0]
['Iris-virginica' 'Iris-versicolor' 'Iris-setosa' 'Iris-versicolor'
 'Iris-virginica' 'Iris-setosa' 'Iris-versicolor' 'Iris-versicolor'
 'Iris-setosa' 'Iris-versicolor' 'Iris-virginica' 'Iris-versicolor'
 'Iris-setosa' 'Iris-virginica' 'Iris-setosa' 'Iris-virginica'
 'Iris-virginica' 'Iris-virginica' 'Iris-setosa' 'Iris-setosa'
 'Iris-versicolor' 'Iris-virginica' 'Iris-versicolor' 'Iris-virginica'
 'Iris-virginica' 'Iris-virginica' 'Iris-versicolor' 'Iris-versicolor'
 'Iris-virginica' 'Iris-virginica' 'Iris-virginica' 'Iris-versicolor'
 'Iris-setosa' 'Iris-virginica' 'Iris-versicolor' 'Iris-setosa'
 'Iris-setosa' 'Iris-setosa' 'Iris-setosa' 'Iris-virginica'
 'Iris-virginica' 'Iris-versicolor' 'Iris-virginica' 'Iris-virginica'
 'Iris-versicolor' 'Iris-setosa' 'Iris-versicolor' 'Iris-versicolor'
 'Iris-virginica' 'Iris-setosa']</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7b892882472509363-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b892882472509363-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7b892882472509363-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b892882472509363-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7b892882472509363-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b892882472509363-6">6</div><div class="crayon-num" data-line="crayon-5c0ca7b892882472509363-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b892882472509363-8">8</div><div class="crayon-num" data-line="crayon-5c0ca7b892882472509363-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b892882472509363-10">10</div><div class="crayon-num" data-line="crayon-5c0ca7b892882472509363-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b892882472509363-12">12</div><div class="crayon-num" data-line="crayon-5c0ca7b892882472509363-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b892882472509363-14">14</div><div class="crayon-num" data-line="crayon-5c0ca7b892882472509363-15">15</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7b892882472509363-1"><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b892882472509363-2"><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca7b892882472509363-3"><span class="crayon-sy">[</span><span class="crayon-s">'Iris-virginica'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-versicolor'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-setosa'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-versicolor'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b892882472509363-4"><span class="crayon-h"> </span><span class="crayon-s">'Iris-virginica'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-setosa'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-versicolor'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-versicolor'</span></div><div class="crayon-line" id="crayon-5c0ca7b892882472509363-5"><span class="crayon-h"> </span><span class="crayon-s">'Iris-setosa'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-versicolor'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-virginica'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-versicolor'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b892882472509363-6"><span class="crayon-h"> </span><span class="crayon-s">'Iris-setosa'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-virginica'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-setosa'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-virginica'</span></div><div class="crayon-line" id="crayon-5c0ca7b892882472509363-7"><span class="crayon-h"> </span><span class="crayon-s">'Iris-virginica'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-virginica'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-setosa'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-setosa'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b892882472509363-8"><span class="crayon-h"> </span><span class="crayon-s">'Iris-versicolor'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-virginica'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-versicolor'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-virginica'</span></div><div class="crayon-line" id="crayon-5c0ca7b892882472509363-9"><span class="crayon-h"> </span><span class="crayon-s">'Iris-virginica'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-virginica'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-versicolor'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-versicolor'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b892882472509363-10"><span class="crayon-h"> </span><span class="crayon-s">'Iris-virginica'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-virginica'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-virginica'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-versicolor'</span></div><div class="crayon-line" id="crayon-5c0ca7b892882472509363-11"><span class="crayon-h"> </span><span class="crayon-s">'Iris-setosa'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-virginica'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-versicolor'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-setosa'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b892882472509363-12"><span class="crayon-h"> </span><span class="crayon-s">'Iris-setosa'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-setosa'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-setosa'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-virginica'</span></div><div class="crayon-line" id="crayon-5c0ca7b892882472509363-13"><span class="crayon-h"> </span><span class="crayon-s">'Iris-virginica'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-versicolor'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-virginica'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-virginica'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b892882472509363-14"><span class="crayon-h"> </span><span class="crayon-s">'Iris-versicolor'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-setosa'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-versicolor'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-versicolor'</span></div><div class="crayon-line" id="crayon-5c0ca7b892882472509363-15"><span class="crayon-h"> </span><span class="crayon-s">'Iris-virginica'</span><span class="crayon-h"> </span><span class="crayon-s">'Iris-setosa'</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0013 seconds] -->
<p></p>
<p>I hope that is clear and useful. Let me know if you have any more questions.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-358418" onclick='return addComment.moveForm( "comment-358418", "358418", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-372607">
<div class="comment-container" id="li-comment-372607">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/089604a4c24916e2e9364fd1b611c72c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/089604a4c24916e2e9364fd1b611c72c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Devendra</span>
<span class="date">November 27, 2016 at 9:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-372607" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I was facing error while converting string to float and so I had to make a minor correction to my code<br/>
X = dataset[1:,0:4].astype(float)<br/>
Y = dataset[1:,4]</p>
<p>However, I am still unable to run since I am getting the following error for line</p>
<p>“—-&gt; 1 results = cross_val_score(estimator, X, dummy_y, cv=kfold)”<br/>
……………….<br/>
“Exception: Error when checking model target: expected dense_4 to have shape (None, 3) but got array with shape (135L, 22L)”</p>
<p>I would appreciate your help. Thanks.</p>
<div class="reply">
<a aria-label="Reply to Devendra" class="comment-reply-link" href="#comment-372607" onclick='return addComment.moveForm( "comment-372607", "372607", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-4" id="comment-372647">
<div class="comment-container" id="li-comment-372647">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/089604a4c24916e2e9364fd1b611c72c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/089604a4c24916e2e9364fd1b611c72c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Devendra</span>
<span class="date">November 28, 2016 at 5:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-372647" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I found the issue. It was with with the indexes.<br/>
I had to take [1:,1:5] for X and [1:,5] for Y.</p>
<p>I am using Jupyter notebook to run my code.<br/>
The index range seems to be different in my case.</p>
<div class="reply">
<a aria-label="Reply to Devendra" class="comment-reply-link" href="#comment-372647" onclick='return addComment.moveForm( "comment-372647", "372647", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-372669">
<div class="comment-container" id="li-comment-372669">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 28, 2016 at 8:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-372669" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad you worked it out Devendra.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even depth-3" id="comment-393938">
<div class="comment-container" id="li-comment-393938">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/08af408c45f4129b08863afcc429c7e6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/08af408c45f4129b08863afcc429c7e6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Cristina</span>
<span class="date">March 24, 2017 at 2:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-393938" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>For some reason, when I run this example I get 0 as prediction value for all the samples. What could be happening?</p>
<p>I’ve the same problem on prediction with other code I’m executing, and decided to run yours to check if i could be doing something wrong?</p>
<p>I’m lost now, this is very strange.</p>
<p>Thanks a in advance!</p>
<div class="reply">
<a aria-label="Reply to Cristina" class="comment-reply-link" href="#comment-393938" onclick='return addComment.moveForm( "comment-393938", "393938", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-4" id="comment-393941">
<div class="comment-container" id="li-comment-393941">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/08af408c45f4129b08863afcc429c7e6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/08af408c45f4129b08863afcc429c7e6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Cristina</span>
<span class="date">March 24, 2017 at 2:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-393941" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello again,</p>
<p>This is happening with Keras 2.0, with Keras 1 works fine.</p>
<p>Thanks,</p>
<p>Cristina</p>
<div class="reply">
<a aria-label="Reply to Cristina" class="comment-reply-link" href="#comment-393941" onclick='return addComment.moveForm( "comment-393941", "393941", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-393979">
<div class="comment-container" id="li-comment-393979">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 24, 2017 at 8:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-393979" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the note.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-5" id="comment-434224">
<div class="comment-container" id="li-comment-434224">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c3f088f09775bca3cc2a29a24f6392fc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c3f088f09775bca3cc2a29a24f6392fc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Fawzi</span>
<span class="date">April 5, 2018 at 5:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-434224" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi all,<br/>
I faced the same problem it works well with keras 1 but gives all 0 with keras 2 !</p>
<p>Thanks for this great tuto !</p>
<p>Fawzi</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-434263">
<div class="comment-container" id="li-comment-434263">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 6, 2018 at 6:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-434263" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Does this happen every time you train the model?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-393975">
<div class="comment-container" id="li-comment-393975">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 24, 2017 at 7:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-393975" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Very strange. </p>
<p>Maybe check that your data file is correct, that you have all of the code and that your environment is installed and is working correctly.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-393975" onclick='return addComment.moveForm( "comment-393975", "393975", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-422837">
<div class="comment-container" id="li-comment-422837">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b62d8cdd7165ed0641fb034d7cfd877f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b62d8cdd7165ed0641fb034d7cfd877f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://deland77@gmail.com" rel="external nofollow">Andrea</a></span>
<span class="date">December 12, 2017 at 7:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-422837" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, I’m getting the same prediction (all zeroes) with Keras 2. If we could be able to nail the cause, it would be great. After all, as of now it’s more than likely that people will try to run your great examples with keras 2.</p>
<p>Plus, a couple of questions:</p>
<p>1. why did you use a sigmoid for the output layer instead of a softmax?</p>
<p>2. why did you provide initialization even for the last layer?</p>
<p>Thanks a lot.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-422870">
<div class="comment-container" id="li-comment-422870">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 12, 2017 at 4:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-422870" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The example does use softmax, perhaps check that you have copied all of the code from the post?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even depth-4" id="comment-426827">
<div class="comment-container" id="li-comment-426827">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/265f8571ccaba2290ffc856bb2ccde21?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/265f8571ccaba2290ffc856bb2ccde21?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">kristi</span>
<span class="date">January 18, 2018 at 3:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-426827" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m having same issue. How did u resolve it? could you please help me</p>
<div class="reply">
<a aria-label="Reply to kristi" class="comment-reply-link" href="#comment-426827" onclick='return addComment.moveForm( "comment-426827", "426827", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-432791">
<div class="comment-container" id="li-comment-432791">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a6f3d12d234552723e5d6c2c2a58f304?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a6f3d12d234552723e5d6c2c2a58f304?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Yousuf</span>
<span class="date">March 21, 2018 at 1:41 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-432791" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Has anyone resolved the issue with the output being all zeros?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-432797">
<div class="comment-container" id="li-comment-432797">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 21, 2018 at 3:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-432797" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps try re-train the model to see if the issue occurs again?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="comment-394284">
<div class="comment-container" id="li-comment-394284">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dbc50ce216baa63780e6cec51ef5b54d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dbc50ce216baa63780e6cec51ef5b54d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://tanviranik.datascientistsbd.com/" rel="external nofollow">Tanvir.</a></span>
<span class="date">March 27, 2017 at 7:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-394284" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thanks for your awesome tutorials. I had a curious question:<br/>
As we are using KerasClassifier or KerasRegressor of Scikit-Learn wrapper, then how to save them as a file after fitting ?</p>
<p>For example, I am predicting regression or multiclass classification. I have to use KerasRegressor or KerasClassifier then. After fitting a large volume of data, I want to save the trained neural network model to use it for prediction purpose only. How to save them and how to restore them from saved files ? Your answer will help me a lot.</p>
<div class="reply">
<a aria-label="Reply to Tanvir." class="comment-reply-link" href="#comment-394284" onclick='return addComment.moveForm( "comment-394284", "394284", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-394298">
<div class="comment-container" id="li-comment-394298">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 27, 2017 at 8:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-394298" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question, I’m not sure you can easily do this. You might be better served fitting the Keras model directly then using the Keras API to save the model:<br/>
<a href="http://machinelearningmastery.com/save-load-keras-deep-learning-models/" rel="nofollow">http://machinelearningmastery.com/save-load-keras-deep-learning-models/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-394298" onclick='return addComment.moveForm( "comment-394298", "394298", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="comment-398455">
<div class="comment-container" id="li-comment-398455">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1c16173d75794e3e57056dc12f045d63?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1c16173d75794e3e57056dc12f045d63?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Reinier</span>
<span class="date">May 4, 2017 at 2:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-398455" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, Thank your very much for those nice explainations.<br/>
I’m having some problems and I trying very hard to get it solved but it wont work..<br/>
If I simply copy-past your code from your comment on 31-july 2016 I keep getting the following Error:</p>
<p>Traceback (most recent call last): File “/Users/reinier/PycharmProjects/Test-IRIS/TESTIRIS.py”, line 43, in  estimator.fit(X_train, Y_train) File “/Users/reinier/Library/Python/3.6/lib/python/site-packages/keras/wrappers/scikit_learn.py”, line 206, in fit return super(KerasClassifier, self).fit(x, y, **kwargs) File “/Users/reinier/Library/Python/3.6/lib/python/site-packages/keras/wrappers/scikit_learn.py”, line 149, in fit history = self.model.fit(x, y, **fit_args) File “/Users/reinier/Library/Python/3.6/lib/python/site-packages/keras/models.py”, line 856, in fit initial_epoch=initial_epoch) File “/Users/reinier/Library/Python/3.6/lib/python/site-packages/keras/engine/training.py”, line 1429, in fit batch_size=batch_size) File “/Users/reinier/Library/Python/3.6/lib/python/site-packages/keras/engine/training.py”, line 1309, in _standardize_user_data exception_prefix=’target’) File “/Users/reinier/Library/Python/3.6/lib/python/site-packages/keras/engine/training.py”, line 139, in _standardize_input_data str(array.shape)) ValueError: Error when checking target: expected dense_2 to have shape (None, 3) but got array with shape (67, 40)</p>
<p>It seems like something is wrong with the fit function. Is this the cause of a new Keras version? Thanks you very much in advance,</p>
<p>Reinier</p>
<div class="reply">
<a aria-label="Reply to Reinier" class="comment-reply-link" href="#comment-398455" onclick='return addComment.moveForm( "comment-398455", "398455", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-398494">
<div class="comment-container" id="li-comment-398494">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 4, 2017 at 8:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-398494" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, it is not clear what is going on.</p>
<p>Does the example in the blog post work as expected?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-398494" onclick='return addComment.moveForm( "comment-398494", "398494", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="comment-405561">
<div class="comment-container" id="li-comment-405561">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/adbfd7e19274440cfe7a057b7cc6f3c1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/adbfd7e19274440cfe7a057b7cc6f3c1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Priyesh</span>
<span class="date">July 12, 2017 at 3:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-405561" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>Thank you for such a wonderful and detailed explanation. Please can guide me on how to plot the graphs for clustering for this data set and code (both for training and predictions).</p>
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Priyesh" class="comment-reply-link" href="#comment-405561" onclick='return addComment.moveForm( "comment-405561", "405561", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-405607">
<div class="comment-container" id="li-comment-405607">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 12, 2017 at 9:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-405607" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I do not have examples of clustering.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-405607" onclick='return addComment.moveForm( "comment-405607", "405607", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="comment-405572">
<div class="comment-container" id="li-comment-405572">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/adbfd7e19274440cfe7a057b7cc6f3c1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/adbfd7e19274440cfe7a057b7cc6f3c1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Priyesh</span>
<span class="date">July 12, 2017 at 5:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-405572" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thank you so much for such an elegant and detailed explanation. I wanted to learn on how to plot graphs for the same. I went through the comments and you said we can’t plot accuracy but I wish to plot the graphs for input data sets and predictions to show like a cluster (as we show K-means like a scattered plot). Please can you guide me with the same.</p>
<p>Thank you.</p>
<div class="reply">
<a aria-label="Reply to Priyesh" class="comment-reply-link" href="#comment-405572" onclick='return addComment.moveForm( "comment-405572", "405572", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-405610">
<div class="comment-container" id="li-comment-405610">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 12, 2017 at 9:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-405610" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry I do not have any examples for clustering.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-405610" onclick='return addComment.moveForm( "comment-405610", "405610", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="comment-426863">
<div class="comment-container" id="li-comment-426863">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f98a2b8aa8c9c19f23b23783fb646460?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f98a2b8aa8c9c19f23b23783fb646460?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Budi</span>
<span class="date">January 19, 2018 at 2:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-426863" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Woahh,, it’s work’s again…<br/>
it’s nice result,</p>
<p>btw, how, it we want make just own sentences, not use test data?</p>
<div class="reply">
<a aria-label="Reply to Budi" class="comment-reply-link" href="#comment-426863" onclick='return addComment.moveForm( "comment-426863", "426863", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-426893">
<div class="comment-container" id="li-comment-426893">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 19, 2018 at 6:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-426893" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is called NLP, learn more here:<br/>
<a href="https://machinelearningmastery.com/start-here/#nlp" rel="nofollow">https://machinelearningmastery.com/start-here/#nlp</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426893" onclick='return addComment.moveForm( "comment-426893", "426893", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="comment-441798">
<div class="comment-container" id="li-comment-441798">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/06ca1fb6b1586cbe8bd136249bb9d56e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/06ca1fb6b1586cbe8bd136249bb9d56e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bonobo</span>
<span class="date">June 24, 2018 at 12:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-441798" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I think the line </p>
<p>model = KerasClassifier(build_fn=baseline_model, nb_epoch=200, batch_size=5, verbose=0)</p>
<p>must be</p>
<p>model = KerasClassifier(build_fn=baseline_model, epochs=200, batch_size=5, verbose=0)</p>
<p>for newer Keras versions.</p>
<div class="reply">
<a aria-label="Reply to Bonobo" class="comment-reply-link" href="#comment-441798" onclick='return addComment.moveForm( "comment-441798", "441798", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-441841">
<div class="comment-container" id="li-comment-441841">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 24, 2018 at 7:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-441841" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Correct.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-441841" onclick='return addComment.moveForm( "comment-441841", "441841", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="comment-443062">
<div class="comment-container" id="li-comment-443062">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a22f2f5ee4dc879312c343da7bf86059?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a22f2f5ee4dc879312c343da7bf86059?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Prakhar</span>
<span class="date">July 10, 2018 at 5:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-443062" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hello Sir,<br/>
i used the following code in keras backend, but when using categorical_crossentropy<br/>
all the  rows of a columns have same predictions,but when i use binary_crossentropy the predictions are correct.Can u plz explain why?<br/>
And my predictions are also in the form of HotEncoding an and not like 2,1,0,2. Kindly help me out in this.<br/>
Thank you</p>
<p>import numpy as np<br/>
import matplotlib.pyplot as plt<br/>
import pandas as pd</p>
<p>train=pd.read_csv(‘iris_train.csv’)<br/>
test=pd.read_csv(‘iris_test.csv’)</p>
<p>xtrain=train.iloc[:,0:4].values<br/>
ytrain=train.iloc[:,4].values<br/>
xtest=test.iloc[:,0:4].values<br/>
ytest=test.iloc[:,4].values</p>
<p>import keras<br/>
from keras.models import Sequential<br/>
from keras.layers import Dense<br/>
from keras.utils import to_categorical</p>
<p>from sklearn.preprocessing import LabelEncoder,OneHotEncoder<br/>
ytrain2=ytrain.reshape(len(ytrain),1)<br/>
encoder1=LabelEncoder()<br/>
ytrain2[:,0]=encoder1.fit_transform(ytrain2[:,0])<br/>
encoder=OneHotEncoder(categorical_features=[0])<br/>
ytrain2=encoder.fit_transform(ytrain2).toarray()</p>
<p>classifier=Sequential()<br/>
classifier.add(Dense(output_dim=4,init=’uniform’,activation=’relu’,input_dim=4))<br/>
classifier.add(Dense(output_dim=4,init=’uniform’,activation=’relu’))<br/>
classifier.add(Dense(output_dim=3,init=’uniform’,activation=’sigmoid’))</p>
<p>classifier.compile(optimizer=’adam’,loss=’categorical_crossentropy’,metrics=[‘accuracy’])<br/>
classifier.fit(xtrain,ytrain2,batch_size=5,epochs=300)</p>
<p>y_pred=classifier.predict(xtest)</p>
<div class="reply">
<a aria-label="Reply to Prakhar" class="comment-reply-link" href="#comment-443062" onclick='return addComment.moveForm( "comment-443062", "443062", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-443093">
<div class="comment-container" id="li-comment-443093">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 10, 2018 at 6:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-443093" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I do not have the capacity to debug your code. Perhaps post to stackoverflow.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443093" onclick='return addComment.moveForm( "comment-443093", "443093", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="comment-445773">
<div class="comment-container" id="li-comment-445773">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/48dbfb700ec2e7ac1658d54a895adcd1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/48dbfb700ec2e7ac1658d54a895adcd1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shooter</span>
<span class="date">August 10, 2018 at 7:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-445773" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, this code gives the accuracy of 98%. But when i add k-fold cross validation code, accuracy decreases to 75%.</p>
<div class="reply">
<a aria-label="Reply to Shooter" class="comment-reply-link" href="#comment-445773" onclick='return addComment.moveForm( "comment-445773", "445773", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-445811">
<div class="comment-container" id="li-comment-445811">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 11, 2018 at 6:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-445811" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps try tuning the model further?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-445811" onclick='return addComment.moveForm( "comment-445811", "445811", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-359957">
<div class="comment-container" id="li-comment-359957">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b7ef46eaf630fccf793206ef30ceea0c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b7ef46eaf630fccf793206ef30ceea0c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Prash</span>
<span class="date">August 14, 2016 at 9:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-359957" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, boss you are too good! You have really helped me out especially in implementation of Deep learning part. I was rattled and lost and was desperately looking for some technology and came across your blogs. thanks a lot.</p>
<div class="reply">
<a aria-label="Reply to Prash" class="comment-reply-link" href="#comment-359957" onclick='return addComment.moveForm( "comment-359957", "359957", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-360052">
<div class="comment-container" id="li-comment-360052">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 15, 2016 at 12:38 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-360052" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad I have helped in some small way Prash.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-360052" onclick='return addComment.moveForm( "comment-360052", "360052", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-360394">
<div class="comment-container" id="li-comment-360394">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/490c857f70772dacd0be50b97fc5bb29?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/490c857f70772dacd0be50b97fc5bb29?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Harsha</span>
<span class="date">August 18, 2016 at 7:03 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-360394" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It is a great tutorial Dr. Jason. Very clear and crispy. I am a beginner in Keras. I have a small doubt.</p>
<p>Is it necessary to use scikit-learn. Can we solve the same problem using basic keras?</p>
<div class="reply">
<a aria-label="Reply to Harsha" class="comment-reply-link" href="#comment-360394" onclick='return addComment.moveForm( "comment-360394", "360394", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-360449">
<div class="comment-container" id="li-comment-360449">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 19, 2016 at 5:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-360449" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can use basic Keras, but scikit-learn make Keras better. They work very well together.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-360449" onclick='return addComment.moveForm( "comment-360449", "360449", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-360513">
<div class="comment-container" id="li-comment-360513">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/490c857f70772dacd0be50b97fc5bb29?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/490c857f70772dacd0be50b97fc5bb29?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Harsha</span>
<span class="date">August 19, 2016 at 11:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-360513" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank You Jason for your prompt reply</p>
<div class="reply">
<a aria-label="Reply to Harsha" class="comment-reply-link" href="#comment-360513" onclick='return addComment.moveForm( "comment-360513", "360513", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-360579">
<div class="comment-container" id="li-comment-360579">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 20, 2016 at 6:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-360579" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome Harsha.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-360579" onclick='return addComment.moveForm( "comment-360579", "360579", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="comment-381577">
<div class="comment-container" id="li-comment-381577">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a55268e3c00b98c78cd9855722df4b6f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a55268e3c00b98c78cd9855722df4b6f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">jokla</span>
<span class="date">January 12, 2017 at 7:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-381577" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, nice tutorial! </p>
<p>I have a question. You mentioned that scikit-learn make Keras better,  why?</p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to jokla" class="comment-reply-link" href="#comment-381577" onclick='return addComment.moveForm( "comment-381577", "381577", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-381603">
<div class="comment-container" id="li-comment-381603">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 12, 2017 at 9:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-381603" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi jokla, great question. </p>
<p>The reason is that we can access all of sklearn’s features using the Keras Wrapper classes. Tools like grid searching, cross validation, ensembles, and more.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-381603" onclick='return addComment.moveForm( "comment-381603", "381603", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-360721">
<div class="comment-container" id="li-comment-360721">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1a3e66e8caff771ac45c63b904e74f5c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1a3e66e8caff771ac45c63b904e74f5c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">moeyzf</span>
<span class="date">August 21, 2016 at 10:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-360721" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I’m a CS student currently studying sentiment analysis and was wondering how to use keras for multi classification of text, ideally I would like the functionality of the TFidvectoriser from sklearn so a one hot vector representation against a given vocabulary is used, within a neural net to determine the final classification. </p>
<p>I am having trouble understanding the initial steps in transforming and feeding word data into vector representations. Can you help me out with some basic code examples of this first step in the sense that say I have a text file with 5000 words for example, which also include emoji (to use as the vocabulary), how can I feed in a training file in csv format text,sentiment and convert each text into a one hot representation then feed it into the neural net, for a final output vector of size e.g 1×7 to denote the various class labels.</p>
<p>I have tried to find help online and most of the solutions use helper methods to load in text data such as imdb, while others use word2vec which isnt what i need. </p>
<p>Hope you can help, I would really appreciate it!</p>
<p>Cheers,</p>
<p>Mo</p>
<div class="reply">
<a aria-label="Reply to moeyzf" class="comment-reply-link" href="#comment-360721" onclick='return addComment.moveForm( "comment-360721", "360721", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-364285">
<div class="comment-container" id="li-comment-364285">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8bf2d107c0d71124fecd0bb699816864?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8bf2d107c0d71124fecd0bb699816864?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Qichang</span>
<span class="date">September 12, 2016 at 3:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-364285" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for the great tutorial! </p>
<p>Just one question regarding the output variable encoding. You mentioned that it is a good practice to convert the output variable to one hot encoding matrix. Is this a necessary step? If the output varible consists of discrete integters, say 1, 2, 3, do we still need to to_categorical() to perform one hot encoding?</p>
<p>I check some example codes in keras github, it seems this is required. Can you please kindly shed some lights on it? </p>
<p>Thanks in advance.</p>
<div class="reply">
<a aria-label="Reply to Qichang" class="comment-reply-link" href="#comment-364285" onclick='return addComment.moveForm( "comment-364285", "364285", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-364344">
<div class="comment-container" id="li-comment-364344">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 13, 2016 at 8:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-364344" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Qichang, great question.</p>
<p>A one hot encoding is not required, you can train the network to predict an integer, it is just a MUCH harder problem.</p>
<p>By using a one hot encoding, you greatly simplify the prediction problem making it easier to train for and achieve better performance.</p>
<p>Try it and compare the results.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-364344" onclick='return addComment.moveForm( "comment-364344", "364344", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-364583">
<div class="comment-container" id="li-comment-364583">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9822c4a8ddf205fc970b5bc7a073f77f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9822c4a8ddf205fc970b5bc7a073f77f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Pedro A. Castillo</span>
<span class="date">September 16, 2016 at 12:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-364583" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello,<br/>
I have followed your tutorial and I get an error in the following line:</p>
<p>results = cross_val_score(estimator, X, dummy_y, cv=kfold)</p>
<p>Traceback (most recent call last):<br/>
  File “k.py”, line 84, in<br/>
    results = cross_val_score(estimator, X, dummy_y, cv=kfold)<br/>
  File “/Library/Python/2.7/site-packages/scikit_learn-0.17.1-py2.7-macosx-10.9-intel.egg/sklearn/cross_validation.py”, line 1433, in cross_val_score<br/>
    for train, test in cv)<br/>
  File “/Library/Python/2.7/site-packages/scikit_learn-0.17.1-py2.7-macosx-10.9-intel.egg/sklearn/externals/joblib/parallel.py”, line 800, in __call__<br/>
    while self.dispatch_one_batch(iterator):<br/>
  File “/Library/Python/2.7/site-packages/scikit_learn-0.17.1-py2.7-macosx-10.9-intel.egg/sklearn/externals/joblib/parallel.py”, line 658, in dispatch_one_batch<br/>
    self._dispatch(tasks)<br/>
  File “/Library/Python/2.7/site-packages/scikit_learn-0.17.1-py2.7-macosx-10.9-intel.egg/sklearn/externals/joblib/parallel.py”, line 566, in _dispatch<br/>
    job = ImmediateComputeBatch(batch)<br/>
  File “/Library/Python/2.7/site-packages/scikit_learn-0.17.1-py2.7-macosx-10.9-intel.egg/sklearn/externals/joblib/parallel.py”, line 180, in __init__<br/>
    self.results = batch()<br/>
  File “/Library/Python/2.7/site-packages/scikit_learn-0.17.1-py2.7-macosx-10.9-intel.egg/sklearn/externals/joblib/parallel.py”, line 72, in __call__<br/>
    return [func(*args, **kwargs) for func, args, kwargs in self.items]<br/>
  File “/Library/Python/2.7/site-packages/scikit_learn-0.17.1-py2.7-macosx-10.9-intel.egg/sklearn/cross_validation.py”, line 1531, in _fit_and_score<br/>
    estimator.fit(X_train, y_train, **fit_params)<br/>
  File “/Library/Python/2.7/site-packages/keras/wrappers/scikit_learn.py”, line 135, in fit<br/>
    **self.filter_sk_params(self.build_fn.__call__))<br/>
TypeError: __call__() takes at least 2 arguments (1 given)</p>
<p>Do you have received this error before? do you have an idea how to fix that?</p>
<div class="reply">
<a aria-label="Reply to Pedro A. Castillo" class="comment-reply-link" href="#comment-364583" onclick='return addComment.moveForm( "comment-364583", "364583", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-364628">
<div class="comment-container" id="li-comment-364628">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 16, 2016 at 9:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-364628" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have not seen this before Pedro.</p>
<p>Perhaps it is something simple like a copy-paste error from the tutorial? </p>
<p>Are you able to double check the code matches the tutorial exactly?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-364628" onclick='return addComment.moveForm( "comment-364628", "364628", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-366627">
<div class="comment-container" id="li-comment-366627">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d4b8352e397b4f693a3cd404d566d438?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d4b8352e397b4f693a3cd404d566d438?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Victor</span>
<span class="date">October 8, 2016 at 10:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-366627" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have exactly the same problem.<br/>
Double checked the code,<br/>
have all the versions of keras etc, updated.<br/>
🙁</p>
<div class="reply">
<a aria-label="Reply to Victor" class="comment-reply-link" href="#comment-366627" onclick='return addComment.moveForm( "comment-366627", "366627", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-366652">
<div class="comment-container" id="li-comment-366652">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 9, 2016 at 6:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-366652" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Victor, are you able to share your version of Keras, scikit-learn, TensorFlow/Theano?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-366652" onclick='return addComment.moveForm( "comment-366652", "366652", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-365422">
<div class="comment-container" id="li-comment-365422">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/baa4559fd3331de57cf75fb7ffcbcd23?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/baa4559fd3331de57cf75fb7ffcbcd23?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Yunita</span>
<span class="date">September 25, 2016 at 12:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-365422" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>Thanks for the great tutorial.<br/>
But I have a question, why did you use sigmoid activation function together with categorical_crossentropy loss function?<br/>
Usually, for multiclass classification problem, I found implementations always using softmax activation function with categorical_cross entropy.<br/>
In addition, does one-hot encoding in the output make it as binary classification instead of multiclass classification? Could you please give some explanations on it?</p>
<div class="reply">
<a aria-label="Reply to Yunita" class="comment-reply-link" href="#comment-365422" onclick='return addComment.moveForm( "comment-365422", "365422", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-365453">
<div class="comment-container" id="li-comment-365453">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 25, 2016 at 8:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-365453" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, you could use a softmax instead of sigmoid. Try it and see.</p>
<p>The one hot encoding creates 3 binary output features. This too would be required with the softmax activation function.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-365453" onclick='return addComment.moveForm( "comment-365453", "365453", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-413591">
<div class="comment-container" id="li-comment-413591">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d309cb156222f5124591dc94c4058a60?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d309cb156222f5124591dc94c4058a60?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Preston</span>
<span class="date">September 12, 2017 at 11:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-413591" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason,</p>
<p>Great site, great resource. Is it possible to see the old example with the one hot encoding output? I’m interested in creating a network with multiple binary outputs and have been searching around for an example. </p>
<p>Many thanks.</p>
<div class="reply">
<a aria-label="Reply to Preston" class="comment-reply-link" href="#comment-413591" onclick='return addComment.moveForm( "comment-413591", "413591", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-413649">
<div class="comment-container" id="li-comment-413649">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 13, 2017 at 12:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-413649" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have many examples on the blog of categorical outputs from LSTMs, try the search.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-413649" onclick='return addComment.moveForm( "comment-413649", "413649", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-413737">
<div class="comment-container" id="li-comment-413737">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d309cb156222f5124591dc94c4058a60?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d309cb156222f5124591dc94c4058a60?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Preston</span>
<span class="date">September 14, 2017 at 5:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-413737" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-365527">
<div class="comment-container" id="li-comment-365527">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1c47207f263e0c24373036b0cdc95f79?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1c47207f263e0c24373036b0cdc95f79?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Marcus</span>
<span class="date">September 26, 2016 at 6:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-365527" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>For Text classification or to basically assign them a category based on the text. How would the baseline_model change????</p>
<p>I’m trying to have an inner layer of 24 nodes and an output of 17 categories but the input_dim=4 as specified in the tutorial wouldn’t be right cause the text length will change depending on the number of words.</p>
<p>I’m a little confused. Your help would be much appreciated.</p>
<p>model.add(Dense(24, init=’normal’, activation=’relu’))</p>
<p>def baseline_model():<br/>
	# create model<br/>
	model = Sequential()<br/>
	model.add(Dense(24, init=’normal’, activation=’relu’))<br/>
	model.add(Dense(17, init=’normal’, activation=’sigmoid’))<br/>
	# Compile model<br/>
	model.compile(loss=’categorical_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])<br/>
	return model</p>
<div class="reply">
<a aria-label="Reply to Marcus" class="comment-reply-link" href="#comment-365527" onclick='return addComment.moveForm( "comment-365527", "365527", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-365532">
<div class="comment-container" id="li-comment-365532">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 26, 2016 at 7:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-365532" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You will need to use padding on the input vectors of encoded words.</p>
<p>See this post for an example of working with text:<br/>
<a href="http://machinelearningmastery.com/predict-sentiment-movie-reviews-using-deep-learning/" rel="nofollow">http://machinelearningmastery.com/predict-sentiment-movie-reviews-using-deep-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-365532" onclick='return addComment.moveForm( "comment-365532", "365532", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-367508">
<div class="comment-container" id="li-comment-367508">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e111f562a54f12edef2c664aa35d38d2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e111f562a54f12edef2c664aa35d38d2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vishnu</span>
<span class="date">October 19, 2016 at 9:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-367508" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>Thank you for your tutorial. I was really interested in Deep Learning and was looking for a place to start, this helped a lot. </p>
<p>But while I was running the code, I came across two errors. The first one was, that while loading the data through pandas, just like your code i set “header= None” but in the next line when we convert the value to float i got the following error message. </p>
<p>“ValueError: could not convert string to float: ‘Petal.Length'”.</p>
<p>This problem went away after I took the header=None condition off. </p>
<p>The second one came at the end, during the Kfold validation. during the one hot encoding it’s binning the values into 22 categories and not 3. which is causing this error: </p>
<p>“Exception: Error when checking model target: expected dense_2 to have shape (None, 3) but got array with shape (135, 22)”</p>
<p>I haven’t been able to get around this. Any suggestion would be appreciated.</p>
<div class="reply">
<a aria-label="Reply to Vishnu" class="comment-reply-link" href="#comment-367508" onclick='return addComment.moveForm( "comment-367508", "367508", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-367555">
<div class="comment-container" id="li-comment-367555">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 20, 2016 at 8:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-367555" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That is quite strange Vishnu, I think perhaps you have the wrong dataset.</p>
<p>You can download the CSV here:<br/>
<a href="http://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data" rel="nofollow">http://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-367555" onclick='return addComment.moveForm( "comment-367555", "367555", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-367571">
<div class="comment-container" id="li-comment-367571">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e8e0395f62267c59ffb556653ba276cb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e8e0395f62267c59ffb556653ba276cb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Homagni Saha</span>
<span class="date">October 20, 2016 at 10:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-367571" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, I tried to use the exact same code for another dataset , the only difference being the dataset had 78 columns and 100000 rows . I had to predict the last column taking the remaining 77 columns as features . I must also say that the last column has 23 different classes.(types basically) and the 23 different classes are all integers not strings like you have used.</p>
<p>model = Sequential()<br/>
	model.add(Dense(77, input_dim=77, init=’normal’, activation=’relu’))<br/>
	model.add(Dense(10, init=’normal’, activation=’relu’))<br/>
	model.add(Dense(23, init=’normal’, activation=’sigmoid’))</p>
<p>also I used nb_epoch=20 and batch_size=1000</p>
<p>also in estimator I changed the verbose to 1, and now the accuracy is a dismal of 0.52% at the end. Also while running I saw strange outputs in the verbose as :</p>
<p>93807/93807 [==============================] – 0s – loss: nan – acc: 0.0052 </p>
<p>why is the loss always as loss: nan ??</p>
<p>Can you please tell me how to modify the code to make it run correctly for my dataset?(remaining everything in the code is unchanged)</p>
<div class="reply">
<a aria-label="Reply to Homagni Saha" class="comment-reply-link" href="#comment-367571" onclick='return addComment.moveForm( "comment-367571", "367571", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even thread-even depth-1" id="comment-367752">
<div class="comment-container" id="li-comment-367752">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 21, 2016 at 8:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-367752" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Homagni,</p>
<p>That is a lot of classes for 100K records. If you can reduce that by splitting up the problem, that might be good.</p>
<p>Your batch size is probably too big and your number of epochs is way too small. Dramatically increase the number of epochs bu 2-3 orders of magnitude.</p>
<p>Start there and let me know how you go.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-367752" onclick='return addComment.moveForm( "comment-367752", "367752", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-368626">
<div class="comment-container" id="li-comment-368626">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3f8ae9940349b9d10b2ad09d2e370993?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3f8ae9940349b9d10b2ad09d2e370993?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">AbuZekry</span>
<span class="date">October 30, 2016 at 12:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-368626" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I’ve edited the first layer’s activation to ‘softplus’ instead of ‘relu’ and number of neurons to 8 instead of 4<br/>
Then I edited the second layer’s activation to ‘softmax’ instead of sigmoid and I got 97.33% (4.42%) performance. Do you have an explanation to this enhancement in performance ?</p>
<div class="reply">
<a aria-label="Reply to AbuZekry" class="comment-reply-link" href="#comment-368626" onclick='return addComment.moveForm( "comment-368626", "368626", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-368678">
<div class="comment-container" id="li-comment-368678">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 30, 2016 at 8:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-368678" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Well done AbuZekry.</p>
<p>Neural nets are infinitely configurable.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-368678" onclick='return addComment.moveForm( "comment-368678", "368678", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-369729">
<div class="comment-container" id="li-comment-369729">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b60348768efe1a794030dc279addfabd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b60348768efe1a794030dc279addfabd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Panand</span>
<span class="date">November 7, 2016 at 3:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-369729" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>Is there a error in your code? You said the network has 4 input neurons , 4 hidden neurons and 3 output neurons.But in the code you haven’t added the hidden neurons.You just specified only the input and output neurons… Will it effect the output in anyway?</p>
<div class="reply">
<a aria-label="Reply to Panand" class="comment-reply-link" href="#comment-369729" onclick='return addComment.moveForm( "comment-369729", "369729", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-369746">
<div class="comment-container" id="li-comment-369746">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 7, 2016 at 7:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-369746" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Panand,</p>
<p>The network structure is as follows:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7b8924e6908120041" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
4 inputs -&gt; [4 hidden nodes] -&gt; 3 outputs</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7b8924e6908120041-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7b8924e6908120041-1"><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">-&gt;</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-e">hidden </span><span class="crayon-v">nodes</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>Line 5 of the code in section 6 adds both the input and hidden layer:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7b8924e9179911883" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
model.add(Dense(4, input_dim=4, init='normal', activation='relu'))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7b8924e9179911883-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7b8924e9179911883-1"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">init</span><span class="crayon-o">=</span><span class="crayon-s">'normal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>The input_dim argument defines the shape of the input.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-369746" onclick='return addComment.moveForm( "comment-369746", "369746", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-370445">
<div class="comment-container" id="li-comment-370445">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fdfbaef7bddf66d3106705fade65d31b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fdfbaef7bddf66d3106705fade65d31b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">JD</span>
<span class="date">November 13, 2016 at 5:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-370445" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I have a set of categorical features and continuous features, I have this model:<br/>
model = Sequential()<br/>
model.add(Dense(117, input_dim=117, init=’normal’, activation=’relu’))<br/>
model.add(Dense(10, activation=’softmax’))</p>
<p>I am getting a dismal : (‘Test accuracy:’, 0.43541752685249119) :<br/>
Details:<br/>
Total records 45k, 10 classes to predict<br/>
batch_size=1000, nb_epoch=25</p>
<p>Any improvements also I would like to put LSTM how to go about doing that as I am getting errors  if I add<br/>
model.add(Dense(117, input_dim=117, init=’normal’, activation=’relu’))<br/>
model.add(LSTM(117,dropout_W=0.2, dropout_U=0.2, return_sequences=True))<br/>
model.add(Dense(10, activation=’softmax’))<br/>
Error:<br/>
Exception: Input 0 is incompatible with layer lstm_6: expected ndim=3, found ndim=2</p>
<div class="reply">
<a aria-label="Reply to JD" class="comment-reply-link" href="#comment-370445" onclick='return addComment.moveForm( "comment-370445", "370445", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-370500">
<div class="comment-container" id="li-comment-370500">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 14, 2016 at 7:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-370500" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi JD,</p>
<p>Here is a long list of ideas to improve the skill of your deep learning model:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<p>Not sure about the exception, you may need to double check the input dimensions of your data and confirm that your model definition matches.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-370500" onclick='return addComment.moveForm( "comment-370500", "370500", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-370974">
<div class="comment-container" id="li-comment-370974">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ca54949ff5d89e41446518d2c14ec5e0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ca54949ff5d89e41446518d2c14ec5e0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">YA</span>
<span class="date">November 17, 2016 at 7:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-370974" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I have a set of categorical features(events) from a real system, and i am trying to build a deep learning model for event prediction.<br/>
The event’s are not appears equally in the training set and one of them is relatively rare compared to the others.<br/>
event     count in training set<br/>
1            22000<br/>
2              6000<br/>
3            13000<br/>
4            12000<br/>
5            26000 </p>
<p>Should i continue with this training set? or should i restructure the training set?<br/>
What is your recommendation?</p>
<div class="reply">
<a aria-label="Reply to YA" class="comment-reply-link" href="#comment-370974" onclick='return addComment.moveForm( "comment-370974", "370974", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-371039">
<div class="comment-container" id="li-comment-371039">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 18, 2016 at 8:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-371039" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi YA, I would try as many different “views” on your problem as you can think of and see which best exposes the problem to the learning algorithms (gets the best performance when everything else is held constant).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-371039" onclick='return addComment.moveForm( "comment-371039", "371039", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-374387">
<div class="comment-container" id="li-comment-374387">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/51c280230e9e6369028bd4cb4a6b8711?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/51c280230e9e6369028bd4cb4a6b8711?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tom</span>
<span class="date">December 9, 2016 at 12:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-374387" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,<br/>
Great work on your website and tuturials! I was wondering if you could show a multi hot encoding, I think you can call it al multi label classification.<br/>
Now you have (only one option on and the rest off)<br/>
[1,0,0]<br/>
[0,1,0]<br/>
[0,0,1]</p>
<p>And do like (each classification has the option on or off)<br/>
[0,0,0]<br/>
[0,1,1]<br/>
[1,0,1]<br/>
[1,1,0]<br/>
[1,1,1]<br/>
etc..</p>
<p>This would really help for me<br/>
Thanks!!</p>
<div class="reply">
<a aria-label="Reply to Tom" class="comment-reply-link" href="#comment-374387" onclick='return addComment.moveForm( "comment-374387", "374387", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-374391">
<div class="comment-container" id="li-comment-374391">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/51c280230e9e6369028bd4cb4a6b8711?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/51c280230e9e6369028bd4cb4a6b8711?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tom</span>
<span class="date">December 9, 2016 at 1:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-374391" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Extra side note, with k-Fold Cross Validation. I got it working with binary_crossentropy with quite bad results. Therefore I wanted to optimize the model and add cross validation which unfortunately didn’t work.</p>
<div class="reply">
<a aria-label="Reply to Tom" class="comment-reply-link" href="#comment-374391" onclick='return addComment.moveForm( "comment-374391", "374391", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-377751">
<div class="comment-container" id="li-comment-377751">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/070be68e6e594dcbed196bac4955792d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/070be68e6e594dcbed196bac4955792d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Martin</span>
<span class="date">December 26, 2016 at 6:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-377751" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason: Regarding this, I have 2 questions:<br/>
1) You said this is a “simple one-layer neural network”. However, I feel it’s still 3-layer network: input layer, hidden layer and output layer.</p>
<p>4 inputs -&gt; [4 hidden nodes] -&gt; 3 outputs</p>
<p>2) However, in your model definition:<br/>
        model.add(Dense(4, input_dim=4, init=’normal’, activation=’relu’))<br/>
	model.add(Dense(3, init=’normal’, activation=’sigmoid’))</p>
<p>Seems that only two layers, input and output, there is no hidden layer. So this is actually a 2-layer network. Is this right?</p>
<div class="reply">
<a aria-label="Reply to Martin" class="comment-reply-link" href="#comment-377751" onclick='return addComment.moveForm( "comment-377751", "377751", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-377853">
<div class="comment-container" id="li-comment-377853">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 27, 2016 at 5:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-377853" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Martin, yes. One hidden layer. I take the input and output layers as assumed, the work happens in the hidden layer. </p>
<p>The first line defines the number of inputs (input_dim=4) AND the number of nodes in the hidden layer:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7b892370598439187" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
model.add(Dense(4, input_dim=4, init=’normal’, activation=’relu’))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7b892370598439187-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7b892370598439187-1"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">init</span><span class="crayon-o">=</span>’<span class="crayon-i">normal</span>’<span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span>’<span class="crayon-i">relu</span>’<span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>I hope that helps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-377853" onclick='return addComment.moveForm( "comment-377853", "377853", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-382423">
<div class="comment-container" id="li-comment-382423">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fc7577dbfe7242ebeae90f2592b7307b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fc7577dbfe7242ebeae90f2592b7307b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Seun</span>
<span class="date">January 16, 2017 at 3:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-382423" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason: I ran this same code but got this error:</p>
<p>Traceback (most recent call last):</p>
<p>  File “”, line 1, in<br/>
    runfile(‘C:/Users/USER/Documents/keras-master/examples/iris_val.py’, wdir=’C:/Users/USER/Documents/keras-master/examples’)</p>
<p>  File “C:\Users\USER\Anaconda2\lib\site-packages\spyder\utils\site\sitecustomize.py”, line 866, in runfile<br/>
    execfile(filename, namespace)</p>
<p>  File “C:\Users\USER\Anaconda2\lib\site-packages\spyder\utils\site\sitecustomize.py”, line 87, in execfile<br/>
    exec(compile(scripttext, filename, ‘exec’), glob, loc)</p>
<p>  File “C:/Users/USER/Documents/keras-master/examples/iris_val.py”, line 46, in<br/>
    results = cross_val_score(estimator, X, dummy_y, cv=kfold)</p>
<p>  File “C:\Users\USER\Anaconda2\lib\site-packages\sklearn\model_selection\_validation.py”, line 140, in cross_val_score<br/>
    for train, test in cv_iter)</p>
<p>  File “C:\Users\USER\Anaconda2\lib\site-packages\sklearn\externals\joblib\parallel.py”, line 758, in __call__<br/>
    while self.dispatch_one_batch(iterator):</p>
<p>  File “C:\Users\USER\Anaconda2\lib\site-packages\sklearn\externals\joblib\parallel.py”, line 603, in dispatch_one_batch<br/>
    tasks = BatchedCalls(itertools.islice(iterator, batch_size))</p>
<p>  File “C:\Users\USER\Anaconda2\lib\site-packages\sklearn\externals\joblib\parallel.py”, line 127, in __init__<br/>
    self.items = list(iterator_slice)</p>
<p>  File “C:\Users\USER\Anaconda2\lib\site-packages\sklearn\model_selection\_validation.py”, line 140, in<br/>
    for train, test in cv_iter)</p>
<p>  File “C:\Users\USER\Anaconda2\lib\site-packages\sklearn\base.py”, line 67, in clone<br/>
    new_object_params = estimator.get_params(deep=False)</p>
<p>TypeError: get_params() got an unexpected keyword argument ‘deep’</p>
<p>Please, I need your help on how to resolve this.</p>
<div class="reply">
<a aria-label="Reply to Seun" class="comment-reply-link" href="#comment-382423" onclick='return addComment.moveForm( "comment-382423", "382423", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-382528">
<div class="comment-container" id="li-comment-382528">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 17, 2017 at 7:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-382528" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Seun, it is not clear what is going on here. </p>
<p>You may have added an additional line or whitespace or perhaps your environment has a problem?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-382528" onclick='return addComment.moveForm( "comment-382528", "382528", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-383938">
<div class="comment-container" id="li-comment-383938">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b2002abe2ea000400745193efef67c52?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b2002abe2ea000400745193efef67c52?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">David</span>
<span class="date">January 25, 2017 at 3:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-383938" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Seun, perhaps this could help you: <a href="http://stackoverflow.com/questions/41796618/python-keras-cross-val-score-error/41832675#41832675" rel="nofollow">http://stackoverflow.com/questions/41796618/python-keras-cross-val-score-error/41832675#41832675</a></p>
<div class="reply">
<a aria-label="Reply to David" class="comment-reply-link" href="#comment-383938" onclick='return addComment.moveForm( "comment-383938", "383938", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-3" id="comment-384023">
<div class="comment-container" id="li-comment-384023">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 25, 2017 at 10:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-384023" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have reproduced the fault and understand the cause.</p>
<p>The error is caused by a bug in Keras 1.2.1 and I have two candidate fixes for the issue.</p>
<p>I have written up the problem and fixes here:<br/>
<a href="http://stackoverflow.com/a/41841066/78453" rel="nofollow">http://stackoverflow.com/a/41841066/78453</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-384023" onclick='return addComment.moveForm( "comment-384023", "384023", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-383979">
<div class="comment-container" id="li-comment-383979">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5961f857e30b83aba97ee6247edd53ab?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5961f857e30b83aba97ee6247edd53ab?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">shazz</span>
<span class="date">January 25, 2017 at 7:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-383979" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have the same issue….<br/>
  File “/usr/local/lib/python3.5/dist-packages/sklearn/base.py”, line 67, in clone<br/>
    new_object_params = estimator.get_params(deep=False)<br/>
TypeError: get_params() got an unexpected keyword argument ‘deep’</p>
<p>Looks to be an old issue fixed last year so I don’t understand which lib is in the wrong version…<br/>
<a href="https://github.com/fchollet/keras/issues/1385" rel="nofollow">https://github.com/fchollet/keras/issues/1385</a></p>
<div class="reply">
<a aria-label="Reply to shazz" class="comment-reply-link" href="#comment-383979" onclick='return addComment.moveForm( "comment-383979", "383979", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-384022">
<div class="comment-container" id="li-comment-384022">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 25, 2017 at 10:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-384022" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi shazz,</p>
<p>I have reproduced the fault and understand the cause. </p>
<p>The error is caused by a bug in Keras 1.2.1 and I have two candidate fixes for the issue.</p>
<p>I have written up the problem and fixes here:<br/>
<a href="http://stackoverflow.com/a/41841066/78453" rel="nofollow">http://stackoverflow.com/a/41841066/78453</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-384022" onclick='return addComment.moveForm( "comment-384022", "384022", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-384140">
<div class="comment-container" id="li-comment-384140">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fc7577dbfe7242ebeae90f2592b7307b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fc7577dbfe7242ebeae90f2592b7307b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Seun</span>
<span class="date">January 25, 2017 at 10:13 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-384140" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jasson,<br/>
Thanks so much. The second fix worked for me.</p>
<div class="reply">
<a aria-label="Reply to Seun" class="comment-reply-link" href="#comment-384140" onclick='return addComment.moveForm( "comment-384140", "384140", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-384215">
<div class="comment-container" id="li-comment-384215">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 26, 2017 at 4:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-384215" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear it Seun.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-384215" onclick='return addComment.moveForm( "comment-384215", "384215", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-385100">
<div class="comment-container" id="li-comment-385100">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/85668a1f8d9d8858f28e93aa776f1400?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/85668a1f8d9d8858f28e93aa776f1400?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sulthan</span>
<span class="date">January 31, 2017 at 3:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-385100" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,</p>
<p>With the help of your example i am trying to use the same for handwritten digits pixel data to classify the no input is 5000rows with example 20*20 pixels so totally x matrix is (5000,400) and Y is (5000,1), i am not able to successfully run the model getting error as below in the end of the code.</p>
<p>#importing the needed libraries<br/>
import scipy.io<br/>
import numpy<br/>
from sklearn.preprocessing import LabelEncoder<br/>
from keras.models import Sequential<br/>
from keras.layers import Dense<br/>
from keras.wrappers.scikit_learn import KerasClassifier<br/>
from keras.utils import np_utils<br/>
from sklearn.model_selection import cross_val_score<br/>
from sklearn.model_selection import KFold<br/>
from sklearn.preprocessing import LabelEncoder<br/>
from sklearn.pipeline import Pipeline<br/>
​</p>
<p>In [158]:</p>
<p>#Intializing random no for reproductiblity<br/>
seed = 7<br/>
numpy.random.seed(seed)</p>
<p>In [159]:</p>
<p>#loading the dataset from mat file<br/>
mat = scipy.io.loadmat(‘C:\\Users\\Sulthan\\Desktop\\NeuralNet\\ex3data1.mat’)<br/>
print(mat)</p>
<p>{‘X’: array([[ 0.,  0.,  0., …,  0.,  0.,  0.],<br/>
       [ 0.,  0.,  0., …,  0.,  0.,  0.],<br/>
       [ 0.,  0.,  0., …,  0.,  0.,  0.],<br/>
       …,<br/>
       [ 0.,  0.,  0., …,  0.,  0.,  0.],<br/>
       [ 0.,  0.,  0., …,  0.,  0.,  0.],<br/>
       [ 0.,  0.,  0., …,  0.,  0.,  0.]]), ‘__header__’: b’MATLAB 5.0 MAT-file, Platform: GLNXA64, Created on: Sun Oct 16 13:09:09 2011′, ‘__version__’: ‘1.0’, ‘y’: array([[10],<br/>
       [10],<br/>
       [10],<br/>
       …,<br/>
       [ 9],<br/>
       [ 9],<br/>
       [ 9]], dtype=uint8), ‘__globals__’: []}</p>
<p>Type Markdown and LaTeX:<br/>
α<br/>
2<br/>
α2<br/>
In [ ]:</p>
<p>​</p>
<p>In [ ]:</p>
<p>​</p>
<p>In [160]:</p>
<p>#Splitting of X and Y of DATA<br/>
X_train = mat[‘X’]</p>
<p>In [161]:</p>
<p>X_train</p>
<p>Out[161]:<br/>
array([[ 0.,  0.,  0., …,  0.,  0.,  0.],<br/>
       [ 0.,  0.,  0., …,  0.,  0.,  0.],<br/>
       [ 0.,  0.,  0., …,  0.,  0.,  0.],<br/>
       …,<br/>
       [ 0.,  0.,  0., …,  0.,  0.,  0.],<br/>
       [ 0.,  0.,  0., …,  0.,  0.,  0.],<br/>
       [ 0.,  0.,  0., …,  0.,  0.,  0.]])<br/>
In [162]:</p>
<p>Y_train = mat[‘y’]</p>
<p>In [163]:</p>
<p>Y_train</p>
<p>Out[163]:<br/>
array([[10],<br/>
       [10],<br/>
       [10],<br/>
       …,<br/>
       [ 9],<br/>
       [ 9],<br/>
       [ 9]], dtype=uint8)<br/>
In [164]:</p>
<p>X_train.shape</p>
<p>Out[164]:<br/>
(5000, 400)<br/>
In [165]:</p>
<p>Y_train.shape</p>
<p>Out[165]:<br/>
(5000, 1)<br/>
In [166]:</p>
<p>data_trainX = X_train[2500:,0:400]</p>
<p>In [167]:</p>
<p>data_trainX</p>
<p>Out[167]:<br/>
array([[ 0.,  0.,  0., …,  0.,  0.,  0.],<br/>
       [ 0.,  0.,  0., …,  0.,  0.,  0.],<br/>
       [ 0.,  0.,  0., …,  0.,  0.,  0.],<br/>
       …,<br/>
       [ 0.,  0.,  0., …,  0.,  0.,  0.],<br/>
       [ 0.,  0.,  0., …,  0.,  0.,  0.],<br/>
       [ 0.,  0.,  0., …,  0.,  0.,  0.]])<br/>
In [168]:</p>
<p>data_trainX.shape</p>
<p>Out[168]:<br/>
(2500, 400)<br/>
In [256]:</p>
<p>data_trainY = Y_train[:2500,:].reshape(-1)</p>
<p>In [257]:</p>
<p>data_trainY<br/>
data_trainY.shape</p>
<p>Out[257]:<br/>
(2500,)<br/>
In [284]:</p>
<p>#enocode class values as integers<br/>
encoder = LabelEncoder()<br/>
encoder.fit(data_trainY)<br/>
encoded_Y = encoder.transform(data_trainY)<br/>
# convert integers to dummy variables<br/>
dummy_Y= np_utils.to_categorical(encoded_Y)</p>
<p>In [285]:</p>
<p>dummy_Y<br/>
​<br/>
​</p>
<p>Out[285]:<br/>
array([[ 0.,  0.,  0.,  0.,  1.],<br/>
       [ 0.,  0.,  0.,  0.,  1.],<br/>
       [ 0.,  0.,  0.,  0.,  1.],<br/>
       …,<br/>
       [ 0.,  0.,  0.,  1.,  0.],<br/>
       [ 0.,  0.,  0.,  1.,  0.],<br/>
       [ 0.,  0.,  0.,  1.,  0.]])<br/>
In [298]:</p>
<p>newy = dummy_Y.reshape(-1,1)<br/>
​<br/>
​</p>
<p>In [300]:</p>
<p>newy</p>
<p>Out[300]:<br/>
array([[ 0.],<br/>
       [ 0.],<br/>
       [ 0.],<br/>
       …,<br/>
       [ 0.],<br/>
       [ 1.],<br/>
       [ 0.]])<br/>
In [293]:</p>
<p>#define baseline model<br/>
def baseline_model():<br/>
    #create model<br/>
    model = Sequential()<br/>
    model.add(Dense(15,input_dim=400,init=’normal’,activation=’relu’))<br/>
    model.add(Dense(10,init=’normal’,activation=’sigmoid’))<br/>
    #compilemodel<br/>
    model.compile(loss=’categorical_crossentropy’,optimizer=’adam’,metrics=[‘accuracy’])<br/>
    return model</p>
<p>estimator = KerasClassifier(build_fn=baseline_model, nb_epoch=200,batch_size=5,verbose=0)<br/>
print(estimator)</p>
<p>In [295]:</p>
<p>kfold = KFold(n_splits=10, shuffle=True, random_state=seed)</p>
<p>results = cross_val_score(estimator, data_trainX, newy, cv=kfold)<br/>
print(“Baseline: %.2f%% (%.2f%%)” % (results.mean()*100, results.std()*100))</p>
<p>—————————————————————————<br/>
ValueError                                Traceback (most recent call last)<br/>
 in ()<br/>
—-&gt; 1 results = cross_val_score(estimator, data_trainX, newy, cv=kfold)<br/>
      2 print(“Baseline: %.2f%% (%.2f%%)” % (results.mean()*100, results.std()*100))</p>
<p>C:\Users\Sulthan\Anaconda3\lib\site-packages\sklearn\model_selection\_validation.py in cross_val_score(estimator, X, y, groups, scoring, cv, n_jobs, verbose, fit_params, pre_dispatch)<br/>
    126<br/>
    127     “””<br/>
–&gt; 128     X, y, groups = indexable(X, y, groups)<br/>
    129<br/>
    130     cv = check_cv(cv, y, classifier=is_classifier(estimator))</p>
<p>C:\Users\Sulthan\Anaconda3\lib\site-packages\sklearn\utils\validation.py in indexable(*iterables)<br/>
    204         else:<br/>
    205             result.append(np.array(X))<br/>
–&gt; 206     check_consistent_length(*result)<br/>
    207     return result<br/>
    208 </p>
<p>C:\Users\Sulthan\Anaconda3\lib\site-packages\sklearn\utils\validation.py in check_consistent_length(*arrays)<br/>
    179     if len(uniques) &gt; 1:<br/>
    180         raise ValueError(“Found input variables with inconsistent numbers of”<br/>
–&gt; 181                          ” samples: %r” % [int(l) for l in lengths])<br/>
    182<br/>
    183 </p>
<p>ValueError: Found input variables with inconsistent numbers of samples: [2500, 12500]</p>
<div class="reply">
<a aria-label="Reply to Sulthan" class="comment-reply-link" href="#comment-385100" onclick='return addComment.moveForm( "comment-385100", "385100", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-385401">
<div class="comment-container" id="li-comment-385401">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 1, 2017 at 10:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-385401" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Sulthan, the trace is a little hard to read. </p>
<p>Sorry, I have no off the cuff ideas.</p>
<p>Perhaps try cutting your example back to the minimum to help isolate the fault?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-385401" onclick='return addComment.moveForm( "comment-385401", "385401", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-385704">
<div class="comment-container" id="li-comment-385704">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f80fac7991e083152b11609bb55e212c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f80fac7991e083152b11609bb55e212c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Linmu</span>
<span class="date">February 3, 2017 at 2:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-385704" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for your tutorial!</p>
<p>Just one question regarding the output. In this problem, we got three classes (setosa, versicolor and virginica), and since each data instance should be classified into only one category, the problem is more specifically “single-lable, multi-class classification”. What if each data instance belonged to multiple categories. Then we are facing “multi-lable, multi-class classification”. In our case, each flower belongs to at least two species (Let’s just forget the biology 🙂 ).</p>
<p>My solution is to modify the output variable (Y) with mutiple ‘1’ in it, i.e. [1 1 0], [0 1 1], [1 1 1 ]……. This is definitely not one-hot encoding any more (maybe two or three-hot?)</p>
<p>Will my method work out? If not, how do you think the problem of “multi-lable, multi-class classification” should be solved?</p>
<p>Thanks in advance</p>
<div class="reply">
<a aria-label="Reply to Linmu" class="comment-reply-link" href="#comment-385704" onclick='return addComment.moveForm( "comment-385704", "385704", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-385764">
<div class="comment-container" id="li-comment-385764">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 3, 2017 at 10:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-385764" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Your method sounds very reasonable. </p>
<p>You may also want to use sigmoid activation functions on the output layer to allow binary class membership to each available class.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-385764" onclick='return addComment.moveForm( "comment-385764", "385764", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-389064">
<div class="comment-container" id="li-comment-389064">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d1cb324bd8b9c022666ee1a7d2e19177?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d1cb324bd8b9c022666ee1a7d2e19177?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://x.hu" rel="external nofollow">solarenqu</a></span>
<span class="date">February 19, 2017 at 9:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-389064" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, how can I use the model to create predictions? </p>
<p>if i try this: print(‘predict: ‘,estimator.predict([[5.7,4.4,1.5,0.4]])) i got this exception:</p>
<p>AttributeError: ‘KerasClassifier’ object has no attribute ‘model’<br/>
Exception ignored in: &lt;bound method BaseSession.__del__ of &gt;<br/>
Traceback (most recent call last):<br/>
  File “/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/site-packages/tensorflow/python/client/session.py”, line 581, in __del__<br/>
AttributeError: ‘NoneType’ object has no attribute ‘TF_DeleteStatus’</p>
<div class="reply">
<a aria-label="Reply to solarenqu" class="comment-reply-link" href="#comment-389064" onclick='return addComment.moveForm( "comment-389064", "389064", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-389151">
<div class="comment-container" id="li-comment-389151">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 20, 2017 at 9:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-389151" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have not seen this error before.</p>
<p>What versions of Keras/TF/sklearn/Python are you using?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-389151" onclick='return addComment.moveForm( "comment-389151", "389151", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-390698">
<div class="comment-container" id="li-comment-390698">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2c6d840da29340d89dfcf9e85dd790e5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2c6d840da29340d89dfcf9e85dd790e5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Suvam</span>
<span class="date">March 1, 2017 at 7:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-390698" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
Thanks for the great tutorial.<br/>
It would be great if you could outline what changes would be necessary if I want to do a multi-class classification with text data: the training data assigns scores to different lines of text, and the problem is to infer the score for a new line of text. It seems that the estimator above cannot handle strings. What would be the fix for this?</p>
<p>Thanks in advance for the help.</p>
<div class="reply">
<a aria-label="Reply to Suvam" class="comment-reply-link" href="#comment-390698" onclick='return addComment.moveForm( "comment-390698", "390698", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-390719">
<div class="comment-container" id="li-comment-390719">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 1, 2017 at 8:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-390719" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Consider encoding your words as integers, using a word embedding and a fixed sequence length.</p>
<p>See this tutorial:<br/>
<a href="http://machinelearningmastery.com/predict-sentiment-movie-reviews-using-deep-learning/" rel="nofollow">http://machinelearningmastery.com/predict-sentiment-movie-reviews-using-deep-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-390719" onclick='return addComment.moveForm( "comment-390719", "390719", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-390803">
<div class="comment-container" id="li-comment-390803">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a6632f4cb6c59d006bef98ef15208ec2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a6632f4cb6c59d006bef98ef15208ec2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sweta</span>
<span class="date">March 1, 2017 at 9:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-390803" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This was a great tutorial to enhance the skills in deep learning. My question: is it possible to use this same dataset for LSTM? Can you please help with this how to solve in LSTM?</p>
<div class="reply">
<a aria-label="Reply to Sweta" class="comment-reply-link" href="#comment-390803" onclick='return addComment.moveForm( "comment-390803", "390803", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-390869">
<div class="comment-container" id="li-comment-390869">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 2, 2017 at 8:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-390869" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Sweta,</p>
<p>You could use an LSTM, but it would not be appropriate because LSTMs are intended for sequence prediction problems and this is not a sequence prediction problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-390869" onclick='return addComment.moveForm( "comment-390869", "390869", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-393776">
<div class="comment-container" id="li-comment-393776">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a6342d9ebeaf8e0ced9f5ca4dff7f390?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a6342d9ebeaf8e0ced9f5ca4dff7f390?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Akash</span>
<span class="date">March 22, 2017 at 5:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-393776" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I have this problem where I have 1500 features as input to my DNN and 2 output classes, can you explain how do I decide the size of neurons in my hidden layer and how many hidden layers I need to process such high features with accuracy.</p>
<div class="reply">
<a aria-label="Reply to Akash" class="comment-reply-link" href="#comment-393776" onclick='return addComment.moveForm( "comment-393776", "393776", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-393846">
<div class="comment-container" id="li-comment-393846">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 23, 2017 at 8:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-393846" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Lots of trial and error.</p>
<p>Start with a small network and keep adding neurons and layers and epochs until no more benefit is seen.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-393846" onclick='return addComment.moveForm( "comment-393846", "393846", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-394049">
<div class="comment-container" id="li-comment-394049">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1ee1ddc3c25a2fb4a1a7751c8e21ba11?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1ee1ddc3c25a2fb4a1a7751c8e21ba11?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ananya Mohapatra</span>
<span class="date">March 24, 2017 at 9:39 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-394049" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>sir, the  following code is showing an error message.. could you help me figure it out. i am trying to do a multi class classification with 5 datasets combined in one( 4 non epileptic patients and 1 epileptic) …500 x 25 dataset and the 26th column is the class.</p>
<p># Train model and make predictions<br/>
import numpy<br/>
import pandas<br/>
from keras.models import Sequential<br/>
from keras.layers import Dense<br/>
from keras.wrappers.scikit_learn import KerasClassifier<br/>
from keras.utils import np_utils<br/>
from sklearn.model_selection import cross_val_score<br/>
from sklearn.cross_validation import train_test_split<br/>
from sklearn.preprocessing import LabelEncoder<br/>
from sklearn.model_selection import KFold</p>
<p># fix random seed for reproducibility<br/>
seed = 7<br/>
numpy.random.seed(seed)<br/>
# load dataset<br/>
dataframe = pandas.read_csv(“DemoNSO.csv”, header=None)<br/>
dataset = dataframe.values<br/>
X = dataset[:,0:25].astype(float)<br/>
Y = dataset[:,25]<br/>
# encode class values as integers<br/>
encoder = LabelEncoder()<br/>
encoder.fit(Y)<br/>
encoded_Y = encoder.transform(Y)<br/>
# convert integers to dummy variables (i.e. one hot encoded)<br/>
dummy_y = np_utils.to_categorical(encoded_Y)<br/>
# define baseline model<br/>
def baseline_model():<br/>
	# create model<br/>
	model = Sequential()<br/>
	model.add(Dense(700, input_dim=25, init=’normal’, activation=’relu’))<br/>
	model.add(Dense(2, init=’normal’, activation=’sigmoid’))</p>
<p>	# Compile model<br/>
	model.compile(loss=’categorical_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])<br/>
	return model</p>
<p>estimator = KerasClassifier(build_fn=baseline_model, nb_epoch=50, batch_size=20)</p>
<p>kfold = KFold(n_splits=5, shuffle=True, random_state=seed)</p>
<p>results = cross_val_score(estimator, X, dummy_y, cv=kfold)<br/>
print(“Baseline: %.2f%% (%.2f%%)” % (results.mean()*100, results.std()*100))</p>
<p>X_train, X_test, Y_train, Y_test = train_test_split(X, dummy_y, test_size=0.55, random_state=seed)<br/>
estimator.fit(X_train, Y_train)<br/>
predictions = estimator.predict(X_test)</p>
<p>print(predictions)<br/>
print(encoder.inverse_transform(predictions))</p>
<p>error  message:<br/>
str(array.shape))<br/>
ValueError: Error when checking model target: expected dense_56 to have shape (None, 2) but got array with shape (240, 3)</p>
<div class="reply">
<a aria-label="Reply to Ananya Mohapatra" class="comment-reply-link" href="#comment-394049" onclick='return addComment.moveForm( "comment-394049", "394049", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-394102">
<div class="comment-container" id="li-comment-394102">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 25, 2017 at 7:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-394102" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Confirm the size of your output (y) matches the dimension of your output layer.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-394102" onclick='return addComment.moveForm( "comment-394102", "394102", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-394378">
<div class="comment-container" id="li-comment-394378">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/56767d0d864a3c47e62b351b146b2812?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/56767d0d864a3c47e62b351b146b2812?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alican</span>
<span class="date">March 28, 2017 at 4:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-394378" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>I got your model to work using Python 2.7.13, Keras 2.0.2, Theano 0.9.0.dev…, by copying the codes exactly, however the results that I get are not only very bad (59.33%, 48.67%, 38.00% on different trials), but they are also different.</p>
<p>I was under the impression that using a fixed seed would allow us to reproduce the same results.</p>
<p>Do you have any idea what could have caused such bad results?</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Alican" class="comment-reply-link" href="#comment-394378" onclick='return addComment.moveForm( "comment-394378", "394378", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-394381">
<div class="comment-container" id="li-comment-394381">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/56767d0d864a3c47e62b351b146b2812?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/56767d0d864a3c47e62b351b146b2812?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alican</span>
<span class="date">March 28, 2017 at 4:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-394381" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>edit: I was re-executing only the results=cross_val_score(…) line to get different results I listed above.</p>
<p>Running the whole script over and over generates the same result: “Baseline: 59.33% (21.59%)”</p>
<div class="reply">
<a aria-label="Reply to Alican" class="comment-reply-link" href="#comment-394381" onclick='return addComment.moveForm( "comment-394381", "394381", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-394410">
<div class="comment-container" id="li-comment-394410">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 28, 2017 at 8:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-394410" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear it.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-394410" onclick='return addComment.moveForm( "comment-394410", "394410", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-394409">
<div class="comment-container" id="li-comment-394409">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 28, 2017 at 8:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-394409" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not sure why the results are so bad. I’ll take a look.</p>
<p>The fixed seed does not seem to have an effect on the Theano or TensorFlow backends. Try running examples multiple times and take the average performance.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-394409" onclick='return addComment.moveForm( "comment-394409", "394409", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-395052">
<div class="comment-container" id="li-comment-395052">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/56767d0d864a3c47e62b351b146b2812?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/56767d0d864a3c47e62b351b146b2812?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alican</span>
<span class="date">April 2, 2017 at 2:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-395052" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Did you have time to look into this?</p>
<p>I had my colleague run this script on Theano 1.0.1, and it gave the expected performance of 95.33%. I then installed Theano 1.0.1, and got the same result again.</p>
<p>However, using Theano 2.0.2 I was getting 59.33% with seed=7, and similar performances with different seeds. Is it possible the developers made some crucial changes with the new version?</p>
<div class="reply">
<a aria-label="Reply to Alican" class="comment-reply-link" href="#comment-395052" onclick='return addComment.moveForm( "comment-395052", "395052", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-395077">
<div class="comment-container" id="li-comment-395077">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 2, 2017 at 6:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-395077" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The most recent version of Theano is 0.9:<br/>
<a href="https://github.com/Theano/Theano/releases" rel="nofollow">https://github.com/Theano/Theano/releases</a></p>
<p>Do you mean Keras versions?</p>
<p>It may not be the Keras version causing the difference in the run. The fixed random seed may not be having an effect in general, or may not be having when a Theano backend is being used.</p>
<p>Neural networks are stochastic algorithms and will produce a different result each run:<br/>
<a href="http://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">http://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-395077" onclick='return addComment.moveForm( "comment-395077", "395077", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-395088">
<div class="comment-container" id="li-comment-395088">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/56767d0d864a3c47e62b351b146b2812?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/56767d0d864a3c47e62b351b146b2812?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alican</span>
<span class="date">April 2, 2017 at 6:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-395088" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes I meant Keras, sorry.</p>
<p>There is no issue with the seed, I’m getting the same result with you on multiple computers using Keras 1.1.1. But with Keras 2.0.2, the results are absymally bad.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-5" id="comment-405442">
<div class="comment-container" id="li-comment-405442">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/eac15705b76063a5f0a158ae82edd763?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/eac15705b76063a5f0a158ae82edd763?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jonathan</span>
<span class="date">July 11, 2017 at 4:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-405442" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>not sure if this was every resolved, but I’m getting the same thing with most recent versions of Theano and Keras</p>
<p>59.33% with seed=7</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-405485">
<div class="comment-container" id="li-comment-405485">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 11, 2017 at 10:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-405485" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Try running the example a few times with different seeds.</p>
<p>Neural networks are stochastic:<br/>
<a href="http://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">http://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-394524">
<div class="comment-container" id="li-comment-394524">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f82aa4677814f1f2df2eeab8db31f65a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f82aa4677814f1f2df2eeab8db31f65a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nalini</span>
<span class="date">March 29, 2017 at 3:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-394524" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason</p>
<p>in this code for multiclass classification can u suggest me how to plot graph to display the accuracy and also what should be the axis represent</p>
<div class="reply">
<a aria-label="Reply to Nalini" class="comment-reply-link" href="#comment-394524" onclick='return addComment.moveForm( "comment-394524", "394524", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-394565">
<div class="comment-container" id="li-comment-394565">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 29, 2017 at 9:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-394565" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, we normally do not graph accuracy, unless you want to graph it over training epochs?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-394565" onclick='return addComment.moveForm( "comment-394565", "394565", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-394800">
<div class="comment-container" id="li-comment-394800">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f82aa4677814f1f2df2eeab8db31f65a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f82aa4677814f1f2df2eeab8db31f65a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nalini</span>
<span class="date">March 31, 2017 at 1:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-394800" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thanks</p>
<div class="reply">
<a aria-label="Reply to Nalini" class="comment-reply-link" href="#comment-394800" onclick='return addComment.moveForm( "comment-394800", "394800", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-394844">
<div class="comment-container" id="li-comment-394844">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 31, 2017 at 5:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-394844" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-394844" onclick='return addComment.moveForm( "comment-394844", "394844", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-395530">
<div class="comment-container" id="li-comment-395530">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5da573f845e1ef47ce8522ab31e64588?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5da573f845e1ef47ce8522ab31e64588?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Frank</span>
<span class="date">April 6, 2017 at 8:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-395530" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,<br/>
I have found this tutorial very interesting and helpful.<br/>
What I wanted to ask is, I am currently trying to classify poker hands as this kaggle competition: <a href="https://www.kaggle.com/c/poker-rule-induction" rel="nofollow">https://www.kaggle.com/c/poker-rule-induction</a>  (For a school project) I wish to create a neural network as you have created above. What do you suggest for me to start this?<br/>
Your help would be greatly appreciated!<br/>
Thanks.</p>
<div class="reply">
<a aria-label="Reply to Frank" class="comment-reply-link" href="#comment-395530" onclick='return addComment.moveForm( "comment-395530", "395530", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-395794">
<div class="comment-container" id="li-comment-395794">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 9, 2017 at 2:39 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-395794" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This process will help you work through your modeling problem:<br/>
<a href="http://machinelearningmastery.com/start-here/#process" rel="nofollow">http://machinelearningmastery.com/start-here/#process</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-395794" onclick='return addComment.moveForm( "comment-395794", "395794", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-395667">
<div class="comment-container" id="li-comment-395667">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a3b31b448ab5005c8a18694251004410?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a3b31b448ab5005c8a18694251004410?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">shiva</span>
<span class="date">April 8, 2017 at 12:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-395667" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Its an awesome tutorial. It would be great if you can come up with a blog post on multiclass medical image classification with Keras Deep Learning library. It would serve as a great asset for researchers like me, working with medical image classification. Looking forward.</p>
<div class="reply">
<a aria-label="Reply to shiva" class="comment-reply-link" href="#comment-395667" onclick='return addComment.moveForm( "comment-395667", "395667", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-395822">
<div class="comment-container" id="li-comment-395822">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 9, 2017 at 2:56 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-395822" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-395822" onclick='return addComment.moveForm( "comment-395822", "395822", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-395727">
<div class="comment-container" id="li-comment-395727">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4a264b33c41c16b7719d6c075c460f31?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4a264b33c41c16b7719d6c075c460f31?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Toby</span>
<span class="date">April 9, 2017 at 4:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-395727" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the great tutorial!<br/>
I duplicated the result using Theano as backend.<br/>
However, using Tensorflow yield a worse accuracy, 88.67%.<br/>
Any explanation?<br/>
Thanks!</p>
<div class="reply">
<a aria-label="Reply to Toby" class="comment-reply-link" href="#comment-395727" onclick='return addComment.moveForm( "comment-395727", "395727", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-395827">
<div class="comment-container" id="li-comment-395827">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 9, 2017 at 3:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-395827" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It may be related to the stochastic nature of neural nets and the difficulty of making results with the TF backend reproducible.</p>
<p>You can learn more about the stochastic nature of machine learning algorithms here:<br/>
<a href="http://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">http://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-395827" onclick='return addComment.moveForm( "comment-395827", "395827", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-396094">
<div class="comment-container" id="li-comment-396094">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d8213eff740d25c82cad3ce642cebd29?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d8213eff740d25c82cad3ce642cebd29?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anupam</span>
<span class="date">April 11, 2017 at 6:11 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-396094" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, How to find the Precision, Recall and f1 score of your example?</p>
<p>Case-1 I have used like :</p>
<p>model.compile(loss=’categorical_crossentropy’, optimizer=’Nadam’, metrics=[‘acc’, ‘fmeasure’, ‘precision’, ‘recall’])</p>
<p>Case-2 and also used : </p>
<p>def score(yh, pr):<br/>
    coords = [np.where(yhh &gt; 0)[0][0] for yhh in yh]<br/>
    yh = [yhh[co:] for yhh, co in zip(yh, coords)]<br/>
    ypr = [prr[co:] for prr, co in zip(pr, coords)]<br/>
    fyh = [c for row in yh for c in row]<br/>
    fpr = [c for row in ypr for c in row]<br/>
    return fyh, fpr</p>
<p>pr = model.predict_classes(X_train)<br/>
yh = y_train.argmax(2)<br/>
fyh, fpr = score(yh, pr)<br/>
print ‘Training accuracy:’, accuracy_score(fyh, fpr)<br/>
print ‘Training confusion matrix:’<br/>
print confusion_matrix(fyh, fpr)<br/>
precision_recall_fscore_support(fyh, fpr)</p>
<p>pr = model.predict_classes(X_test)<br/>
yh = y_test.argmax(2)<br/>
fyh, fpr = score(yh, pr)<br/>
print ‘Testing accuracy:’, accuracy_score(fyh, fpr)<br/>
print ‘Testing confusion matrix:’<br/>
print confusion_matrix(fyh, fpr)<br/>
precision_recall_fscore_support(fyh, fpr)</p>
<p>What I have observed is that, accuracy of case-1 and case-2 are different?</p>
<p>Any solution?</p>
<div class="reply">
<a aria-label="Reply to Anupam" class="comment-reply-link" href="#comment-396094" onclick='return addComment.moveForm( "comment-396094", "396094", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-396168">
<div class="comment-container" id="li-comment-396168">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 12, 2017 at 7:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-396168" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can make predictions on your test data and use the tools from sklearn:<br/>
<a href="http://scikit-learn.org/stable/modules/classes.html#module-sklearn.metrics" rel="nofollow">http://scikit-learn.org/stable/modules/classes.html#module-sklearn.metrics</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-396168" onclick='return addComment.moveForm( "comment-396168", "396168", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-396518">
<div class="comment-container" id="li-comment-396518">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a3e409f9468ce2c36506f09df22f434a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a3e409f9468ce2c36506f09df22f434a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.xfintell.com" rel="external nofollow">Raynier van Egmond</a></span>
<span class="date">April 15, 2017 at 12:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-396518" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Like a student earlier in the comments my accuracy results are exactly the same as his:</p>
<p>**********  Baseline: 88.67% (21.09%)</p>
<p>and I think this is related to having Tensorflow as the backend rather than the Theano backend.</p>
<p>I am working this through in a Jupyter notebook</p>
<p>I went through your earlier tutorials on setting up the environment:</p>
<p>scipy:                  0.18.1<br/>
numpy:               1.11.3<br/>
matplotlib:           2.0.0<br/>
pandas:              0.19.2<br/>
statsmodels:       0.6.1<br/>
sklearn:               0.18.1<br/>
theano:                     0.9.0.dev-c697eeab84e5b8a74908da654b66ec9eca4f1291<br/>
tensorflow:          1.0.1<br/>
                                      Using TensorFlow backend.<br/>
keras:                  2.0.3</p>
<p>The Tensorflow is a Python3.6 recompile picked up from the web at:</p>
<p><a href="http://www.lfd.uci.edu/~gohlke/pythonlibs/#tensorflow" rel="nofollow">http://www.lfd.uci.edu/~gohlke/pythonlibs/#tensorflow</a></p>
<p>Do you know have I can force the Keras library to take Theano as a backend rather than the Tensorflow library?</p>
<p>Thanks for the great work on your tutorials… for beginners it is such in invaluable thing to have tutorials that actually work !!!</p>
<p>Looking forward to get more of your books</p>
<p>Rene</p>
<div class="reply">
<a aria-label="Reply to Raynier van Egmond" class="comment-reply-link" href="#comment-396518" onclick='return addComment.moveForm( "comment-396518", "396518", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-396521">
<div class="comment-container" id="li-comment-396521">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a3e409f9468ce2c36506f09df22f434a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a3e409f9468ce2c36506f09df22f434a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.xfintell.com" rel="external nofollow">Raynier van Egmond</a></span>
<span class="date">April 15, 2017 at 12:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-396521" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Changing to the Theano backend doesn’t change the results: </p>
<p>Managed to change to a Theano backend by setting the Keras config file:<br/>
{<br/>
    “image_data_format”: “channels_last”,<br/>
    “epsilon”: 1e-07,<br/>
    “floatx”: “float32”,<br/>
    “backend”: “theano”<br/>
}</p>
<p>as instructed at:  <a href="https://keras.io/backend/#keras-backends" rel="nofollow">https://keras.io/backend/#keras-backends</a></p>
<p>The notebook no longer reports it is using Tensorflow so I guess the switch worked but the results are still: </p>
<p>****** Baseline: 88.67% (21.09%)</p>
<p>Will need to look a little deeper and play with the actual architecture a bit.</p>
<p>All the same great material to get started with </p>
<p>Thanks again</p>
<p>Rene</p>
<div class="reply">
<a aria-label="Reply to Raynier van Egmond" class="comment-reply-link" href="#comment-396521" onclick='return addComment.moveForm( "comment-396521", "396521", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-396524">
<div class="comment-container" id="li-comment-396524">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a3e409f9468ce2c36506f09df22f434a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a3e409f9468ce2c36506f09df22f434a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.xfintell.com" rel="external nofollow">Raynier van Egmond</a></span>
<span class="date">April 15, 2017 at 1:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-396524" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Confirmed that changes to the model as someone above mentioned</p>
<p>	model.add(Dense(8, input_dim=4, kernel_initializer=’normal’, activation=’relu’))<br/>
	model.add(Dense(3, kernel_initializer=’normal’, activation=’softmax’))</p>
<p>nodes makes a substantial difference: </p>
<p>**** Baseline: 96.67% (4.47%)</p>
<p>but there is no difference between the Tensorflow and Theano backend results. I guess that’s as far as I can take this for now.</p>
<p>Take care,</p>
<p>Rene</p>
<div class="reply">
<a aria-label="Reply to Raynier van Egmond" class="comment-reply-link" href="#comment-396524" onclick='return addComment.moveForm( "comment-396524", "396524", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-396584">
<div class="comment-container" id="li-comment-396584">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 16, 2017 at 9:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-396584" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice.</p>
<p>Also, note that MLPs are stochastic. This means that if you don’t fix the random seed, you will get different results for each run of the algorithm.</p>
<p>Ideally, you should take the average performance of the algorithm across multiple runs to evaluate its performance.</p>
<p>See this post:<br/>
<a href="http://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">http://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-396584" onclick='return addComment.moveForm( "comment-396584", "396584", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-396581">
<div class="comment-container" id="li-comment-396581">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 16, 2017 at 9:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-396581" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can change the back-end used by Keras in the Kersas config file. See this post:<br/>
<a href="http://machinelearningmastery.com/introduction-python-deep-learning-library-keras/" rel="nofollow">http://machinelearningmastery.com/introduction-python-deep-learning-library-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-396581" onclick='return addComment.moveForm( "comment-396581", "396581", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-396630">
<div class="comment-container" id="li-comment-396630">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fd033c5cbf5be2d582e8a01aed939d98?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fd033c5cbf5be2d582e8a01aed939d98?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tursun</span>
<span class="date">April 16, 2017 at 9:18 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-396630" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason,<br/>
Thank you very much first. These tutorials are excellent. They are very practical. Your are an excellent educator.<br/>
I want classify my data into multiple classes of 25-30. Your IRIS example is nearest classification. They DL4J previously has IRIS classification with DBN; but disappeared in new community version.<br/>
I have following issues:<br/>
1.&gt;<br/>
It takes so long. My laptop is TOSHIBA L745, 4GB RAM, i3 processor. it has CUDA.<br/>
My classification problem is solved with SVM in very short time. I’d say in split second.<br/>
Do you think speed would increase if we use DBN or CNN something ?<br/>
2.&gt;<br/>
My result :<br/>
Baseline: 88.67% (21.09%),<br/>
Once I have installed Docker (tensorflow in it),then run IRIS classification. It shows 96%.<br/>
I wish similar or better accuracy. How to reach that level ?</p>
<p>Thank you</p>
<div class="reply">
<a aria-label="Reply to Tursun" class="comment-reply-link" href="#comment-396630" onclick='return addComment.moveForm( "comment-396630", "396630", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-396656">
<div class="comment-container" id="li-comment-396656">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 17, 2017 at 5:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-396656" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>MLP is the right algorithm for multi-class classification algorithms.</p>
<p>If it is slow, consider running it on AWS:<br/>
<a href="http://machinelearningmastery.com/develop-evaluate-large-deep-learning-models-keras-amazon-web-services/" rel="nofollow">http://machinelearningmastery.com/develop-evaluate-large-deep-learning-models-keras-amazon-web-services/</a></p>
<p>There are many things you can do to lift performance, see this post:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-396656" onclick='return addComment.moveForm( "comment-396656", "396656", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-396657">
<div class="comment-container" id="li-comment-396657">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b7c1cb32c97bd28ec2f534fe4b204145?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b7c1cb32c97bd28ec2f534fe4b204145?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chris</span>
<span class="date">April 17, 2017 at 5:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-396657" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,<br/>
first of all, your tutorials are really well done when you start working with keras.</p>
<p>I have a question about the epochs and batch_size in this tutorial. I think I haven’t understood it correctly.</p>
<p>I loaded the record and it contains 150 entries.</p>
<p>You choose 200 epochs and batch_size=5. So you use 5*200=1000 examples for training. So does keras use the same entries multiple times or does it stop automatically?</p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Chris" class="comment-reply-link" href="#comment-396657" onclick='return addComment.moveForm( "comment-396657", "396657", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-396767">
<div class="comment-container" id="li-comment-396767">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 18, 2017 at 8:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-396767" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>One epoch involves exposing each pattern in the training dataset to the model. </p>
<p>One epoch is comprised of one or more batches.</p>
<p>One batch involves showing a subset of the patterns in the training data to the model and updating weights.</p>
<p>The number of patterns in the dataset for one epoch must be a factor of the batch size (e.g. divide evenly).</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-396767" onclick='return addComment.moveForm( "comment-396767", "396767", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-397168">
<div class="comment-container" id="li-comment-397168">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b7c1cb32c97bd28ec2f534fe4b204145?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b7c1cb32c97bd28ec2f534fe4b204145?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chris</span>
<span class="date">April 22, 2017 at 3:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-397168" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
thank you for the explanation.<br/>
The explanation helped me, and in the meantime I have read and tried several LSTM  tutorials from you  and it became much clearer to me.<br/>
greetings, Chris</p>
<div class="reply">
<a aria-label="Reply to Chris" class="comment-reply-link" href="#comment-397168" onclick='return addComment.moveForm( "comment-397168", "397168", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-397198">
<div class="comment-container" id="li-comment-397198">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 22, 2017 at 9:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-397198" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad to hear that Chris.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-397198" onclick='return addComment.moveForm( "comment-397198", "397198", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-396686">
<div class="comment-container" id="li-comment-396686">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/67d519e6bbbc681bcefc53eec695b60d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/67d519e6bbbc681bcefc53eec695b60d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Abhilash Menon</span>
<span class="date">April 17, 2017 at 1:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-396686" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,</p>
<p>I have been following your tutorials and they have been very very helpful!. Especially, the most useful section being the comments where people like me get to ask you questions and some of them are the same ones I had in my mind.</p>
<p>Although, I have one that I think hasn’t been asked before, at least on this page!</p>
<p>What changes should I make to the regular program you illustrated with the “pima_indians_diabetes.csv”  in order to take a dataset that has 5 categorical inputs and 1 binary output.</p>
<p>This would be a huge help!  Thanks in advance!</p>
<div class="reply">
<a aria-label="Reply to Abhilash Menon" class="comment-reply-link" href="#comment-396686" onclick='return addComment.moveForm( "comment-396686", "396686", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-396777">
<div class="comment-container" id="li-comment-396777">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 18, 2017 at 8:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-396777" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question.</p>
<p>Consider using an integer encoding followed by a binary encoding of the categorical inputs.</p>
<p>This post will show you how:<br/>
<a href="http://machinelearningmastery.com/data-preparation-gradient-boosting-xgboost-python/" rel="nofollow">http://machinelearningmastery.com/data-preparation-gradient-boosting-xgboost-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-396777" onclick='return addComment.moveForm( "comment-396777", "396777", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-406323">
<div class="comment-container" id="li-comment-406323">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fd9fe3289f272e1a105b9325cf932912?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fd9fe3289f272e1a105b9325cf932912?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Abhilash Menon</span>
<span class="date">July 18, 2017 at 12:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-406323" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Dr. Brownlee,</p>
<p>The link that you shared was very helpful and I have been able to one hot encode and use the data set but at this point of time I am not able to find relevant information regarding what the perfect batch size and no. of epochs should be. My data has 5 categorical inputs and 1 binary output (2800 instances). Could you tell me what factors I should take into consideration before arriving at a perfect batch size and epoch number? The following are the configuration details of my neural net:</p>
<p>    model.add(Dense(28, input_dim=43, init=’uniform’, activation=’relu’))<br/>
    model.add(Dense(28, init=’uniform’, activation=’relu’))<br/>
    model.add(Dense(1, init=’uniform’, activation=’sigmoid’))<br/>
    model.compile(loss=’binary_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])</p>
<div class="reply">
<a aria-label="Reply to Abhilash Menon" class="comment-reply-link" href="#comment-406323" onclick='return addComment.moveForm( "comment-406323", "406323", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-406342">
<div class="comment-container" id="li-comment-406342">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 18, 2017 at 5:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-406342" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I recommend testing a suite of different batch sizes.</p>
<p>I have a post this friday with advice on tuning the batch size, watch out for it.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-406342" onclick='return addComment.moveForm( "comment-406342", "406342", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-396785">
<div class="comment-container" id="li-comment-396785">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5352c419f4f799540d3e50c61e645a73?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5352c419f4f799540d3e50c61e645a73?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tuba</span>
<span class="date">April 18, 2017 at 8:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-396785" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>First of all, your tutorials are really very interesting.</p>
<p>I was facing error this when i run it . I’m work with python 3 and the same file input .</p>
<p>Error :<br/>
ImportError: Traceback (most recent call last):<br/>
  File “/home/indatacore/anaconda3/lib/python3.5/site-packages/tensorflow/python/__init__.py”, line 61, in<br/>
    from tensorflow.python import pywrap_tensorflow<br/>
  File “/home/indatacore/anaconda3/lib/python3.5/site-packages/tensorflow/python/pywrap_tensorflow.py”, line 28, in<br/>
    _pywrap_tensorflow = swig_import_helper()<br/>
  File “/home/indatacore/anaconda3/lib/python3.5/site-packages/tensorflow/python/pywrap_tensorflow.py”, line 24, in swig_import_helper<br/>
    _mod = imp.load_module(‘_pywrap_tensorflow’, fp, pathname, description)<br/>
  File “/home/indatacore/anaconda3/lib/python3.5/imp.py”, line 242, in load_module<br/>
    return load_dynamic(name, filename, file)<br/>
  File “/home/indatacore/anaconda3/lib/python3.5/imp.py”, line 342, in load_dynamic<br/>
    return _load(spec)<br/>
ImportError: libcudart.so.8.0: cannot open shared object file: No such file or directory</p>
<p>Failed to load the native TensorFlow runtime.</p>
<p>See <a href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/g3doc/get_started/os_setup.md#import_error" rel="nofollow">https://github.com/tensorflow/tensorflow/blob/master/tensorflow/g3doc/get_started/os_setup.md#import_error</a></p>
<p>for some common reasons and solutions.  Include the entire stack trace<br/>
above this error message when asking for help.</p>
<div class="reply">
<a aria-label="Reply to Tuba" class="comment-reply-link" href="#comment-396785" onclick='return addComment.moveForm( "comment-396785", "396785", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-396870">
<div class="comment-container" id="li-comment-396870">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 19, 2017 at 7:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-396870" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ouch. I have not seen this error before.</p>
<p>Consider trying the Theano backend and see if that makes a difference.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-396870" onclick='return addComment.moveForm( "comment-396870", "396870", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-397062">
<div class="comment-container" id="li-comment-397062">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fd033c5cbf5be2d582e8a01aed939d98?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fd033c5cbf5be2d582e8a01aed939d98?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tursun</span>
<span class="date">April 21, 2017 at 2:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-397062" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason,<br/>
Thank you. I got your notion: there is no key which opens all doors.</p>
<p>Here, I have multi class classification problem.<br/>
My data can be downloaded from here:<br/>
<a href="https://www.dropbox.com/s/w2en6ewdsed69pc/tursun_deep_p6.csv?dl=0" rel="nofollow">https://www.dropbox.com/s/w2en6ewdsed69pc/tursun_deep_p6.csv?dl=0</a></p>
<p>size of my data set : 512*16, last column is 21 classes, they are digits 1-21<br/>
note: number of samples (rows in my data) for each class is different. mostly 20 rows, but sometimes 17 or 31 rows<br/>
 my network has:<br/>
    first layer (input) has 15 neurons<br/>
     second layer (hidden) has 30 neurons<br/>
     last layer (output) has 21 neurons<br/>
     in last layer I used “softmax” based on this recommendation from<br/>
<a href="https://github.com/fchollet/keras/issues/1013" rel="nofollow">https://github.com/fchollet/keras/issues/1013</a><br/>
 “The softmax function transforms your hidden units into probability scores of the class labels you have; and thus is more suited to classification problems ”<br/>
 error message:<br/>
  alueError: Error when checking model target: expected dense_8 to have shape (None, 21) but got array with shape (512, 1)</p>
<p>I would be thankful if you can help me to run this code.</p>
<p>I modified this code from yours:<br/>
———–keras code start ———–<br/>
from keras.models import Sequential<br/>
from keras.layers import Dense<br/>
import numpy<br/>
# fix random seed for reproducibility<br/>
numpy.random.seed(7)<br/>
# load pima indians dataset<br/>
dataset = numpy.loadtxt(“tursun_deep_p6.csv”, delimiter=”,”)<br/>
# split into input (X) and output (Y) variables<br/>
X = dataset[:,0:15]<br/>
Y = dataset[:,15]</p>
<p># create model<br/>
model = Sequential()<br/>
model.add(Dense(30, input_dim=15, activation=’relu’))  # not sure if 30 too much. not sure #about lower and upper limits<br/>
#model.add(Dense(25, activation=’relu’))        # think about to add one more hidden layer<br/>
model.add(Dense(21, activation=’softmax’))   # they say softmax at last L does classification<br/>
# Compile model<br/>
model.compile(loss=’categorical_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])<br/>
# Fit the model<br/>
model.fit(X, Y, epochs=150, batch_size=5)<br/>
# evaluate the model<br/>
scores = model.evaluate(X, Y)<br/>
print(“\n%s: %.2f%%” % (model.metrics_names[1], scores[1]*100))</p>
<p>———–keras code start ———–</p>
<div class="reply">
<a aria-label="Reply to Tursun" class="comment-reply-link" href="#comment-397062" onclick='return addComment.moveForm( "comment-397062", "397062", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-397100">
<div class="comment-container" id="li-comment-397100">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 21, 2017 at 8:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-397100" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I see the problem, your output layer expects 8 columns and you only have 1.</p>
<p>You need to transform your output variable int 8 variables. You can do this using a one hot encoding.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-397100" onclick='return addComment.moveForm( "comment-397100", "397100", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-397293">
<div class="comment-container" id="li-comment-397293">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a3b31b448ab5005c8a18694251004410?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a3b31b448ab5005c8a18694251004410?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shiva</span>
<span class="date">April 23, 2017 at 5:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-397293" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi jason, I am following your book deep learning with python and i have an issue with the script. I have succesfully read my .csv datafile through pandas and trying to adopt a decay based learning rate as discussed in the book. I define the initial lrate, drop, epochs_drop and the formula for lrate update as said in the book. I then created the model like this (works best for my problem) and started creating a pipeline in contrary to the model fitting strategy used by you in the book:</p>
<p>def baseline_model():<br/>
    # create model<br/>
    model = Sequential()<br/>
    model.add(Dense(50, input_dim=15, kernel_initializer=’normal’, activation=’relu’))<br/>
    model.add(Dense(3, kernel_initializer=’normal’, activation=’sigmoid’))<br/>
    sgd = SGD(lr=0.0, momentum=0.9, decay=0, nesterov=False)<br/>
    model.compile(loss=’categorical_crossentropy’, optimizer=sgd, metrics=[‘accuracy’])<br/>
    return model<br/>
#learning schedule callback<br/>
lrate = LearningRateScheduler(step_decay)<br/>
callbacks_list = [lrate]</p>
<p>estimators = []<br/>
estimators.append((‘standardize’, StandardScaler()))<br/>
estimators.append((‘mlp’, KerasClassifier(build_fn=baseline_model, epochs=100,<br/>
batch_size=5, callbacks=[lrate], verbose=1)))<br/>
pipeline = Pipeline(estimators)<br/>
kfold = StratifiedKFold(n_splits=2, shuffle=True, random_state=seed)<br/>
results = cross_val_score(pipeline, X, encoded_Y, cv=kfold)</p>
<p>I’m getting the error “Cannot clone object , as the constructor does not seem to set parameter callbacks”. According to keras documentation, I can see that i can pass callbacks to the kerasclassifier wrapper. kindly suggest what to do in this occasion. Looking forward.</p>
<div class="reply">
<a aria-label="Reply to Shiva" class="comment-reply-link" href="#comment-397293" onclick='return addComment.moveForm( "comment-397293", "397293", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-397379">
<div class="comment-container" id="li-comment-397379">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 24, 2017 at 5:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-397379" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have not tried to use callbacks with the sklearn wrapper sorry. </p>
<p>Perhaps it is a limitation that you can’t? Though, I’d be surprised.</p>
<p>you may have to use the keras API directly.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-397379" onclick='return addComment.moveForm( "comment-397379", "397379", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-397514">
<div class="comment-container" id="li-comment-397514">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a3b31b448ab5005c8a18694251004410?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a3b31b448ab5005c8a18694251004410?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shiva</span>
<span class="date">April 25, 2017 at 6:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-397514" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I’m trying to apply the image augmentation techniques discussed in your book to the data I have stored in my system under C:\images\train and C:\images\test. Could you help me with the syntax on how to load my own data with a modification to the syntax available in the book:</p>
<p># load data<br/>
(X_train, y_train), (X_test, y_test) = mnist.load_data()</p>
<p>Thanks in advance.</p>
<div class="reply">
<a aria-label="Reply to Shiva" class="comment-reply-link" href="#comment-397514" onclick='return addComment.moveForm( "comment-397514", "397514", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-397531">
<div class="comment-container" id="li-comment-397531">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 25, 2017 at 7:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-397531" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have an example of how to load image data from disk, I hope to cover it in the future.</p>
<p>This post may help as a start:<br/>
<a href="https://blog.keras.io/building-powerful-image-classification-models-using-very-little-data.html" rel="nofollow">https://blog.keras.io/building-powerful-image-classification-models-using-very-little-data.html</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-397531" onclick='return addComment.moveForm( "comment-397531", "397531", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-397802">
<div class="comment-container" id="li-comment-397802">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1eaa3bf2c77f06a27a26637287a9dbb1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1eaa3bf2c77f06a27a26637287a9dbb1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Michael Ng</span>
<span class="date">April 28, 2017 at 12:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-397802" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>By implementing neural network in Keras, how can we get the associated probabilities for each predicted class?’</p>
<p>Many Thanks!<br/>
Michael Ng</p>
<div class="reply">
<a aria-label="Reply to Michael Ng" class="comment-reply-link" href="#comment-397802" onclick='return addComment.moveForm( "comment-397802", "397802", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-397852">
<div class="comment-container" id="li-comment-397852">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 28, 2017 at 7:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-397852" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Review the outputs from the softmax, although not strictly probabilities, they can be used as such.</p>
<p>Also see the keras function model.predict_proba() for predicting probabilities directly.<br/>
<a href="https://keras.io/models/sequential/" rel="nofollow">https://keras.io/models/sequential/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-397852" onclick='return addComment.moveForm( "comment-397852", "397852", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-398058">
<div class="comment-container" id="li-comment-398058">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1eaa3bf2c77f06a27a26637287a9dbb1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1eaa3bf2c77f06a27a26637287a9dbb1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Michael Ng</span>
<span class="date">April 30, 2017 at 11:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-398058" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>‘Note that we use a sigmoid activation function in the output layer. This is to ensure the output values are in the range of 0 and 1 and may be used as predicted probabilities.’</p>
<p>Instead of using softmax function, how do I review the sigmoidal outputs (as per the tutorial) for each of 3 output nodes? Mind to share the code to list the sigmoidal outputs?</p>
<p>Regards,<br/>
Michael Ng</p>
<div class="reply">
<a aria-label="Reply to Michael Ng" class="comment-reply-link" href="#comment-398058" onclick='return addComment.moveForm( "comment-398058", "398058", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-398128">
<div class="comment-container" id="li-comment-398128">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 1, 2017 at 5:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-398128" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend softmax for multi-class classification.</p>
<p>You can learn more about sigmoid here:<br/>
<a href="https://en.wikipedia.org/wiki/Logistic_function" rel="nofollow">https://en.wikipedia.org/wiki/Logistic_function</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-398128" onclick='return addComment.moveForm( "comment-398128", "398128", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="comment-422841">
<div class="comment-container" id="li-comment-422841">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b62d8cdd7165ed0641fb034d7cfd877f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b62d8cdd7165ed0641fb034d7cfd877f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://deland77@gmail.com" rel="external nofollow">Andrea</a></span>
<span class="date">December 12, 2017 at 7:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-422841" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason,</p>
<p>may you elaborate further (or provide a link) about “the outputs from the softmax, although not strictly probabilities”?</p>
<p>I thought they were probabilities even in the most formal sense.</p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Andrea" class="comment-reply-link" href="#comment-422841" onclick='return addComment.moveForm( "comment-422841", "422841", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-422872">
<div class="comment-container" id="li-comment-422872">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 12, 2017 at 4:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-422872" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, they are normalized to look like probabilities.</p>
<p>This might be a good place to start:<br/>
<a href="https://en.wikipedia.org/wiki/Softmax_function" rel="nofollow">https://en.wikipedia.org/wiki/Softmax_function</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-422872" onclick='return addComment.moveForm( "comment-422872", "422872", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-397808">
<div class="comment-container" id="li-comment-397808">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/77534594ac28e5c5e9cf14aac47a991a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/77534594ac28e5c5e9cf14aac47a991a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ann</span>
<span class="date">April 28, 2017 at 2:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-397808" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason! I’m exactly newbie to Keras, and I want to figure out confusion matrix by using sklearn.confusion_matrix(y_test, predict). But I was facing error this when i run it . </p>
<p>—————————————————————————<br/>
ValueError                                Traceback (most recent call last)<br/>
 in ()<br/>
—-&gt; 1 confusion_matrix(y_test, predict)</p>
<p>C:\Users\Ann\Anaconda3\envs\py27\lib\site-packages\sklearn\metrics\classification.pyc in confusion_matrix(y_true, y_pred, labels, sample_weight)<br/>
    240     y_type, y_true, y_pred = _check_targets(y_true, y_pred)<br/>
    241     if y_type not in (“binary”, “multiclass”):<br/>
–&gt; 242         raise ValueError(“%s is not supported” % y_type)<br/>
    243<br/>
    244     if labels is None:</p>
<p>ValueError: multilabel-indicator is not supported</p>
<p>I’ve checked that y_test and predict have same shape (231L, 2L).<br/>
Any solution?<br/>
Your help would be greatly appreciated!<br/>
Thanks.</p>
<div class="reply">
<a aria-label="Reply to Ann" class="comment-reply-link" href="#comment-397808" onclick='return addComment.moveForm( "comment-397808", "397808", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-397855">
<div class="comment-container" id="li-comment-397855">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 28, 2017 at 7:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-397855" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Consider checking the dimensionality of both y and yhat to ensure they are the same (e.g. print the shape of them).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-397855" onclick='return addComment.moveForm( "comment-397855", "397855", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-398031">
<div class="comment-container" id="li-comment-398031">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c2706f4530186f7b79640c9e093b6b13?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c2706f4530186f7b79640c9e093b6b13?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mohammed Zahran</span>
<span class="date">April 30, 2017 at 4:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-398031" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>can we use the same approach to classify MNIST in (0,1…) and the same time classify the numbers to even and odd numbers ?</p>
<div class="reply">
<a aria-label="Reply to Mohammed Zahran" class="comment-reply-link" href="#comment-398031" onclick='return addComment.moveForm( "comment-398031", "398031", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-398043">
<div class="comment-container" id="li-comment-398043">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 30, 2017 at 5:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-398043" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Machine learning is not needed to check for odd and even numbers, just a little math.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-398043" onclick='return addComment.moveForm( "comment-398043", "398043", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-398079">
<div class="comment-container" id="li-comment-398079">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3a0d0e8002675ff1ad88f8ac4f64096e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3a0d0e8002675ff1ad88f8ac4f64096e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">TAM.G</span>
<span class="date">April 30, 2017 at 4:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-398079" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>but if we too it as a simple try to learn about multi-labeling ,, how could we do this</p>
<div class="reply">
<a aria-label="Reply to TAM.G" class="comment-reply-link" href="#comment-398079" onclick='return addComment.moveForm( "comment-398079", "398079", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-4" id="comment-398163">
<div class="comment-container" id="li-comment-398163">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c2706f4530186f7b79640c9e093b6b13?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c2706f4530186f7b79640c9e093b6b13?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Moh</span>
<span class="date">May 1, 2017 at 10:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-398163" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>@Jason Brownlee I totally agree with you. We are using this problem as proxy for more complex problems like classifying a scene with multiple cars and we want to classify the models of these cars. The same approach is needed in tackling neurological images</p>
<div class="reply">
<a aria-label="Reply to Moh" class="comment-reply-link" href="#comment-398163" onclick='return addComment.moveForm( "comment-398163", "398163", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-398070">
<div class="comment-container" id="li-comment-398070">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3a0d0e8002675ff1ad88f8ac4f64096e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3a0d0e8002675ff1ad88f8ac4f64096e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">TAM.G</span>
<span class="date">April 30, 2017 at 3:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-398070" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>first this is a great tutorial , but , am confused a little ,, am i loading my training files and labeling files or what ??<br/>
as i tried to apply this tutorial to my case ,, I’ve about 10 folder each has its own images these images are related together for one class ,, but i need to make multi labeling for each folder of them for example folder number 1 has about 1500 .png imgs of owl bird , here i need to make a multi label for this to train it as a bird and owl , and here comes the problem ,, as i’m seraching for a tool to make labeling for all images in each folder and label them as [ owl, bird] together … any idea about how to build my own multi label classifier ?</p>
<div class="reply">
<a aria-label="Reply to TAM.G" class="comment-reply-link" href="#comment-398070" onclick='return addComment.moveForm( "comment-398070", "398070", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-398129">
<div class="comment-container" id="li-comment-398129">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 1, 2017 at 5:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-398129" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend using a CNN instead of an MLP for image classification, see this post:<br/>
<a href="http://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/" rel="nofollow">http://machinelearningmastery.com/object-recognition-convolutional-neural-networks-keras-deep-learning-library/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-398129" onclick='return addComment.moveForm( "comment-398129", "398129", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-399666">
<div class="comment-container" id="li-comment-399666">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/356ce8674b90329db6c12d9148aba94c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/356ce8674b90329db6c12d9148aba94c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ik.O</span>
<span class="date">May 14, 2017 at 10:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-399666" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I implemented the same code on my system and achieved a score of 88.67% at seed = 7 and 96.00% at seed = 4. Any particular reason for this?</p>
<div class="reply">
<a aria-label="Reply to Ik.O" class="comment-reply-link" href="#comment-399666" onclick='return addComment.moveForm( "comment-399666", "399666", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-399685">
<div class="comment-container" id="li-comment-399685">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 15, 2017 at 5:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-399685" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice work!</p>
<p>Yes, deep learning algorithms are stochastic:<br/>
<a href="http://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">http://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-399685" onclick='return addComment.moveForm( "comment-399685", "399685", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-399959">
<div class="comment-container" id="li-comment-399959">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d8213eff740d25c82cad3ce642cebd29?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d8213eff740d25c82cad3ce642cebd29?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anupam</span>
<span class="date">May 18, 2017 at 4:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-399959" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, Just gone through your blog <a href="http://machinelearningmastery.com/" rel="nofollow">http://machinelearningmastery.com/</a> .Just to know as a beginner in Deep learning,  can you give any hint to do the task sequence learning for word language identification problem.<br/>
Here each word is a variable sequence of characters and the id of each word must be classified with a language tag.<br/>
Like, Suppose if we have a dataset like: </p>
<p>hello/L1 bahiya/L2 hain/L2 brother/L1 ,/L3 :)/L4</p>
<p>where L1,L2,L3 and L4 are the Language-tag</p>
<div class="reply">
<a aria-label="Reply to Anupam" class="comment-reply-link" href="#comment-399959" onclick='return addComment.moveForm( "comment-399959", "399959", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-400008">
<div class="comment-container" id="li-comment-400008">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 19, 2017 at 8:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-400008" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Anupam, that sounds like a great problem.</p>
<p>I would suggest starting with a high-quality dataset, then consider modeling the problem using a seq2seq architecture.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-400008" onclick='return addComment.moveForm( "comment-400008", "400008", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-400048">
<div class="comment-container" id="li-comment-400048">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0b5ac1983fa8db61fc6358b9a779596b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0b5ac1983fa8db61fc6358b9a779596b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">A.Malathi</span>
<span class="date">May 19, 2017 at 7:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-400048" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Your tutorials are  great and very helpful  to me. Have you written any article on Autoencoder.<br/>
I have constructed an autoencoder network for a dataset with labels. The output is a vector of<br/>
errors(Euclidean Distance). From that errors, classification or prediction on the test set is possible since labels are given??</p>
<div class="reply">
<a aria-label="Reply to A.Malathi" class="comment-reply-link" href="#comment-400048" onclick='return addComment.moveForm( "comment-400048", "400048", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-400090">
<div class="comment-container" id="li-comment-400090">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 20, 2017 at 5:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-400090" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t currently have any material on autoencoders.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-400090" onclick='return addComment.moveForm( "comment-400090", "400090", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-400220">
<div class="comment-container" id="li-comment-400220">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a2de52c14e49bbbf2f7f99b12c803e65?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a2de52c14e49bbbf2f7f99b12c803e65?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">J. A. Gildea</span>
<span class="date">May 22, 2017 at 2:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-400220" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thank you so much for your helpful tutorials.<br/>
I have one question regarding one-hot encoding:<br/>
I am working on using a CNN for sentiment analysis and I have a total of six labels for my output variable, string values (P+, P, NONE, NEU, N, N+) representing sentiments.<br/>
I one-hot encoded my output variable the same way as you showed in this tutorial, but the shape after one-hot encoding appears to be (, 7). Shouln’t it be 6 instead of 7? Any idea what might be going on? I checked for issues in my dataset such as null values in a certain row, and got rid of all of them yet this persists.<br/>
Thanks!</p>
<div class="reply">
<a aria-label="Reply to J. A. Gildea" class="comment-reply-link" href="#comment-400220" onclick='return addComment.moveForm( "comment-400220", "400220", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-400241">
<div class="comment-container" id="li-comment-400241">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 22, 2017 at 7:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-400241" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It should be 7.</p>
<p>Consider loading your data in Python and printing the set of values in the column to get an idea of what is in your data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-400241" onclick='return addComment.moveForm( "comment-400241", "400241", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-400264">
<div class="comment-container" id="li-comment-400264">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a2de52c14e49bbbf2f7f99b12c803e65?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a2de52c14e49bbbf2f7f99b12c803e65?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">J. A. Gildea</span>
<span class="date">May 22, 2017 at 6:39 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-400264" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I checked my data a bit deeper and it seems it had a couple of null values that I removed.<br/>
I am however getting very poor results, could this be due to the fact that my data is a bit unbalanced? Some of the classes appear twice as others, so I imagine I would have to change the metrics in my compile function (using accuracy at the moment).<br/>
Can a slight imbalance in the dataset yield such poor results (under 40% validation accuracy)?</p>
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to J. A. Gildea" class="comment-reply-link" href="#comment-400264" onclick='return addComment.moveForm( "comment-400264", "400264", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-400300">
<div class="comment-container" id="li-comment-400300">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 23, 2017 at 7:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-400300" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>With multiple classes, it might be better to use another metric like log loss (cross entropy) or AUC.</p>
<p>Accuracy will not capture the true performance of the model.</p>
<p>Also, imbalanced classes can be a problem. You could look at removing some classes or rebalancing the data:<br/>
<a href="http://machinelearningmastery.com/tactics-to-combat-imbalanced-classes-in-your-machine-learning-dataset/" rel="nofollow">http://machinelearningmastery.com/tactics-to-combat-imbalanced-classes-in-your-machine-learning-dataset/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-400300" onclick='return addComment.moveForm( "comment-400300", "400300", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-400442">
<div class="comment-container" id="li-comment-400442">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f82aa4677814f1f2df2eeab8db31f65a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f82aa4677814f1f2df2eeab8db31f65a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nalini</span>
<span class="date">May 24, 2017 at 6:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-400442" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason!<br/>
I can’t seem to add more layers in my code.<br/>
	model.add(Dense(12, input_dim=25, init=’normal’, activation=’relu’))<br/>
	model.add(Dense(5, init=’normal’, activation=’sigmoid’))<br/>
This is a part of the existing code. if i try to add more layers along with them i get a warning for indentation fault.<br/>
can you please specify which one of the above layers is the input layer and which one is hidden….</p>
<div class="reply">
<a aria-label="Reply to Nalini" class="comment-reply-link" href="#comment-400442" onclick='return addComment.moveForm( "comment-400442", "400442", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-401111">
<div class="comment-container" id="li-comment-401111">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 11:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-401111" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is a Python issue. Ensure you understand the role of whitespace in Python:<br/>
<a href="http://www.diveintopython.net/getting_to_know_python/indenting_code.html" rel="nofollow">http://www.diveintopython.net/getting_to_know_python/indenting_code.html</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401111" onclick='return addComment.moveForm( "comment-401111", "401111", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-400662">
<div class="comment-container" id="li-comment-400662">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/24429a087a00581558151a5a618e06f1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/24429a087a00581558151a5a618e06f1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Michael</span>
<span class="date">May 28, 2017 at 4:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-400662" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I have two questions:</p>
<p>1. I didn’t see the code in this post calling the fit method. Is the fitting process executed in  KerasClassifier?</p>
<p>2. I have only one dataset as training set (No dedicated test set).<br/>
Is the KFold method using this single dataset for evaluation in the KerasClassifier class?<br/>
Or should I use the “validation_split parameter in the fit method?</p>
<p>Thank’s</p>
<div class="reply">
<a aria-label="Reply to Michael" class="comment-reply-link" href="#comment-400662" onclick='return addComment.moveForm( "comment-400662", "400662", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-401156">
<div class="comment-container" id="li-comment-401156">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 12:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-401156" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Michael,</p>
<p>Yes, we use the sklearn infrastructure to fit and evaluate the model.</p>
<p>You can try both methods. The best evaluation test harness is really problem dependent. k-fold cross validation generally gives a less biased estimate of performance and is often recommended.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401156" onclick='return addComment.moveForm( "comment-401156", "401156", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-400743">
<div class="comment-container" id="li-comment-400743">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ffff78838394dcfe0ec827afcdecdd8f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ffff78838394dcfe0ec827afcdecdd8f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.morafitweebly.com" rel="external nofollow">Nimesh</a></span>
<span class="date">May 29, 2017 at 4:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-400743" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am classifying mp3s into 7 genre classes. I have 1200 mp3 files dataset with 7 features as input. I got basic Neural network as your example shows and it gives nearly 60% of accuracy. Any suggestions on how to improve accuracy? your suggestions will be very helpful for me.</p>
<div class="reply">
<a aria-label="Reply to Nimesh" class="comment-reply-link" href="#comment-400743" onclick='return addComment.moveForm( "comment-400743", "400743", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-401180">
<div class="comment-container" id="li-comment-401180">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 12:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-401180" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, see this post:<br/>
<a href="http://machinelearningmastery.com/machine-learning-performance-improvement-cheat-sheet/" rel="nofollow">http://machinelearningmastery.com/machine-learning-performance-improvement-cheat-sheet/</a></p>
<p>And this post:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401180" onclick='return addComment.moveForm( "comment-401180", "401180", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-401918">
<div class="comment-container" id="li-comment-401918">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a2de52c14e49bbbf2f7f99b12c803e65?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a2de52c14e49bbbf2f7f99b12c803e65?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">J. A. Gildea</span>
<span class="date">June 9, 2017 at 3:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-401918" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>I posted here a while back and I’m back for more wisdom!</p>
<p>I have my own model and dataset for text classification (6 labels representing sentiment of tweets). I am not sure on how to evaluate it, I have tried using k fold just as in your example and it yields 100% accuracy which I assume is not the reality.<br/>
Just using model.fit() I obtain a result of 99%, which also makes me think I am not evaluating my model correctly.<br/>
I have been looking for a way to do this and apparently a good approach is to use a confusion matrix. Is this necessary to evaluate a multiclass model for text classification, or will other methods suffice?  </p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to J. A. Gildea" class="comment-reply-link" href="#comment-401918" onclick='return addComment.moveForm( "comment-401918", "401918", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-401946">
<div class="comment-container" id="li-comment-401946">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 9, 2017 at 6:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-401946" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Generally, I would recommend this process to work through your problem systematically:<br/>
<a href="http://machinelearningmastery.com/start-here/#process" rel="nofollow">http://machinelearningmastery.com/start-here/#process</a></p>
<p>I would recommend this post to get a robust estimate of the skill of a deep learning model on unseen data:<br/>
<a href="http://machinelearningmastery.com/evaluate-skill-deep-learning-models/" rel="nofollow">http://machinelearningmastery.com/evaluate-skill-deep-learning-models/</a></p>
<p>For multi-class classification, I would recommend a confusion matrix, but also measures like logloss.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401946" onclick='return addComment.moveForm( "comment-401946", "401946", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-402157">
<div class="comment-container" id="li-comment-402157">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c63ac6eb3172f148618cba2d8a19ec76?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c63ac6eb3172f148618cba2d8a19ec76?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">zakaria</span>
<span class="date">June 11, 2017 at 3:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-402157" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, I need your help I use tensorflow and keras to classify cifar10 images. My question is how to make prediction (make prediction for only one image)</p>
<div class="reply">
<a aria-label="Reply to zakaria" class="comment-reply-link" href="#comment-402157" onclick='return addComment.moveForm( "comment-402157", "402157", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-402181">
<div class="comment-container" id="li-comment-402181">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 11, 2017 at 8:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-402181" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Like this:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7b891623171199641" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
yhat = model.predict(X)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7b891623171199641-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7b891623171199641-1"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-402181" onclick='return addComment.moveForm( "comment-402181", "402181", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-402283">
<div class="comment-container" id="li-comment-402283">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c63ac6eb3172f148618cba2d8a19ec76?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c63ac6eb3172f148618cba2d8a19ec76?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">zakaria</span>
<span class="date">June 12, 2017 at 6:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-402283" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
To make the prediction I used this function Y_pred = model.predict (x_test)<br/>
print (Y_pred)<br/>
Y_pred = np.argmax (Y_pred, axis = 1)<br/>
print (y_pred)</p>
<p>And I got these results<br/>
[[0, 0, …, 0, 0, 0]]<br/>
  [0, 1, 0, …, 0, 0, 0]<br/>
  [1. 0. 0. …, 0. 0. 0.]<br/>
  …<br/>
  [0, 0, 0, …, 0, 0, 0]]<br/>
  [1. 0. 0. …, 0. 0. 0.]<br/>
  [0. 0. 0. …, 1. 0. 0.]]<br/>
[0 1 0 …, 5 0 7]<br/>
What these results mean<br/>
And how to display for example the first 10 images of the test database to see if the model works well</p>
<div class="reply">
<a aria-label="Reply to zakaria" class="comment-reply-link" href="#comment-402283" onclick='return addComment.moveForm( "comment-402283", "402283", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-402345">
<div class="comment-container" id="li-comment-402345">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 13, 2017 at 8:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-402345" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The prediction result may be an outcome (probability-like value) for each class.</p>
<p>You can take an argmax() of each vector to find the selected class.</p>
<p>Alternately, you can call predict_classes() to predict the class directly.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-402345" onclick='return addComment.moveForm( "comment-402345", "402345", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-402300">
<div class="comment-container" id="li-comment-402300">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/34f85329aac9febfd7cb97dacc6d5ebb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/34f85329aac9febfd7cb97dacc6d5ebb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Huong</span>
<span class="date">June 12, 2017 at 11:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-402300" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear @Jason,<br/>
Thank you for your useful post. I have a issues.<br/>
My dataset have 3 columns (features) for output data. Each column has multi-classes. So how can I process in this case?<br/>
Thanks.</p>
<div class="reply">
<a aria-label="Reply to Huong" class="comment-reply-link" href="#comment-402300" onclick='return addComment.moveForm( "comment-402300", "402300", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-402349">
<div class="comment-container" id="li-comment-402349">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 13, 2017 at 8:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-402349" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t have a great answer for you off the cuff. I would suggest doing a little research to see how this type of problem has been handled in the literature.</p>
<p>Maybe you can model each class separately?</p>
<p>Maybe you can one-hot encode each output variable and use a neural network to output everyone directly.</p>
<p>Let me know how you go.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-402349" onclick='return addComment.moveForm( "comment-402349", "402349", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-402904">
<div class="comment-container" id="li-comment-402904">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dd1735fd8ca90869aa876e649e49636f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dd1735fd8ca90869aa876e649e49636f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://soulis.tech" rel="external nofollow">Anastasios</a></span>
<span class="date">June 17, 2017 at 10:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-402904" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>great post on multiclass classification. I am trying to do a gridsearch on a multiclass dataset i created, but I get an error when calling the fit function on the gridsearch. Can we apply gridsearch on a multiclass dataset ?</p>
<p>My code looks like: <a href="https://pastebin.com/eB35aJmW" rel="nofollow">https://pastebin.com/eB35aJmW</a></p>
<p>And the error I get is: <a href="https://pastebin.com/C1ch7709" rel="nofollow">https://pastebin.com/C1ch7709</a></p>
<div class="reply">
<a aria-label="Reply to Anastasios" class="comment-reply-link" href="#comment-402904" onclick='return addComment.moveForm( "comment-402904", "402904", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-402941">
<div class="comment-container" id="li-comment-402941">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 18, 2017 at 6:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-402941" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, I believe you can grid search a multi-class classification problem.</p>
<p>Sorry, it is not clear to me what the cause of the error might be. You will need to cut your example back to a minimum case that still produces the error.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-402941" onclick='return addComment.moveForm( "comment-402941", "402941", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-404140">
<div class="comment-container" id="li-comment-404140">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6850e56cf6ab93d57d56df0c3cbf88af?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6850e56cf6ab93d57d56df0c3cbf88af?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anupam Samanta</span>
<span class="date">June 29, 2017 at 3:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-404140" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Excellent tutorials! I have been able to learn a lot reading your articles.</p>
<p>I ran into some problem while implementing this program<br/>
My accuracy was around Accuracy: 70.67% (12.00%)<br/>
I dont know why the accuracy is so dismal!<br/>
I tried changing some parameters, mostly that are mentioned in the comments, such as removing kernel_initializer, changing activation function, also the number of hidden nodes. But the best I was able to achieve was 70 %</p>
<p>Any reason something is going wrong here in my code?!</p>
<p># Modules<br/>
import numpy<br/>
import pandas<br/>
from keras.models import Sequential<br/>
from keras.layers import Dense<br/>
from keras.utils import np_utils<br/>
from keras.wrappers.scikit_learn import KerasClassifier<br/>
from sklearn.model_selection import cross_val_score<br/>
from sklearn.model_selection import KFold<br/>
from sklearn.preprocessing import LabelEncoder<br/>
from keras import backend as K<br/>
import os</p>
<p>def set_keras_backend(backend):<br/>
    if K.backend() != backend:<br/>
        os.environ[‘KERAS_BACKEND’] = backend<br/>
        reload(K)<br/>
        assert K.backend() == backend</p>
<p>set_keras_backend(“theano”)<br/>
# seed<br/>
seed = 7<br/>
numpy.random.seed(seed)</p>
<p># load dataset<br/>
dataFrame = pandas.read_csv(“iris.csv”, header=None)<br/>
dataset = dataFrame.values</p>
<p>X = dataset[:, 0:4].astype(float)<br/>
Y = dataset[:, 4]</p>
<p># encode class values<br/>
encoder = LabelEncoder()<br/>
encoder.fit(Y)<br/>
encoded_Y = encoder.transform(Y)</p>
<p>dummy_Y = np_utils.to_categorical(encoded_Y)</p>
<p># baseline model<br/>
def baseline_model():<br/>
    # create model<br/>
    model = Sequential()<br/>
    model.add(Dense(8, input_dim=4, kernel_initializer=’normal’, activation=’softplus’))<br/>
    model.add(Dense(3, kernel_initializer=’normal’, activation=’softmax’))<br/>
    # compile model<br/>
    model.compile(loss=’categorical_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])<br/>
    return model</p>
<p>estimator = KerasClassifier(build_fn=baseline_model, nb_epoch=200, batch_size=5, verbose=0)<br/>
kfold = KFold(n_splits=10, shuffle=True, random_state=seed)</p>
<p>results = cross_val_score(estimator, X, dummy_Y, cv=kfold)</p>
<p>print(“Accuracy: %.2f%% (%.2f%%)” % (results.mean() * 100, results.std() * 100))</p>
<div class="reply">
<a aria-label="Reply to Anupam Samanta" class="comment-reply-link" href="#comment-404140" onclick='return addComment.moveForm( "comment-404140", "404140", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-404141">
<div class="comment-container" id="li-comment-404141">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6850e56cf6ab93d57d56df0c3cbf88af?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6850e56cf6ab93d57d56df0c3cbf88af?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anupam Samanta</span>
<span class="date">June 29, 2017 at 3:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-404141" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I added my code here: <a href="https://pastebin.com/3Kr7P6Kw" rel="nofollow">https://pastebin.com/3Kr7P6Kw</a><br/>
Its better formatted here!</p>
<div class="reply">
<a aria-label="Reply to Anupam Samanta" class="comment-reply-link" href="#comment-404141" onclick='return addComment.moveForm( "comment-404141", "404141", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-404180">
<div class="comment-container" id="li-comment-404180">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 29, 2017 at 6:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-404180" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>There are more ideas here:<br/>
<a href="http://machinelearningmastery.com/deploy-machine-learning-model-to-production/" rel="nofollow">http://machinelearningmastery.com/deploy-machine-learning-model-to-production/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-404180" onclick='return addComment.moveForm( "comment-404180", "404180", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-404284">
<div class="comment-container" id="li-comment-404284">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6850e56cf6ab93d57d56df0c3cbf88af?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6850e56cf6ab93d57d56df0c3cbf88af?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anupam Samanta</span>
<span class="date">June 30, 2017 at 3:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-404284" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>But isnt it strange, that when I use the same code as yours, my program in my machine returns such bad results!<br/>
Is there anything I am doing wrong in my code?!</p>
<div class="reply">
<a aria-label="Reply to Anupam Samanta" class="comment-reply-link" href="#comment-404284" onclick='return addComment.moveForm( "comment-404284", "404284", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-404310">
<div class="comment-container" id="li-comment-404310">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 30, 2017 at 8:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-404310" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No. Try running the example a few times. Neural networks are stochastic and give different results each time they are run.</p>
<p>See this post on why:<br/>
<a href="http://MachineLearningMastery.com/randomness-in-machine-learning/" rel="nofollow">http://MachineLearningMastery.com/randomness-in-machine-learning/</a></p>
<p>See this post on how to address it and get a robust estimate of model performance:<br/>
<a href="http://MachineLearningMastery.com/evaluate-skill-deep-learning-models/" rel="nofollow">http://MachineLearningMastery.com/evaluate-skill-deep-learning-models/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-404310" onclick='return addComment.moveForm( "comment-404310", "404310", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-404368">
<div class="comment-container" id="li-comment-404368">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/52579add01b957b2e50dc347b445c71f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/52579add01b957b2e50dc347b445c71f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Zefeng Wu</span>
<span class="date">June 30, 2017 at 11:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-404368" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, my codes is as followings, but keras gave a extremebad results,<br/>
import numpy<br/>
import pandas<br/>
from keras.models import Sequential<br/>
from keras.layers import Dense<br/>
from keras.wrappers.scikit_learn import KerasClassifier<br/>
from keras.utils import np_utils<br/>
from sklearn.model_selection import cross_val_score<br/>
from sklearn.model_selection import KFold<br/>
from sklearn.preprocessing import LabelEncoder<br/>
from sklearn.pipeline import Pipeline<br/>
# fix random seed for reproducibility<br/>
seed = 7<br/>
numpy.random.seed(seed)<br/>
# load dataset<br/>
dataframe = pandas.read_csv(“iris.csv”, header=None)<br/>
dataset = dataframe.values<br/>
X = dataset[:,0:4].astype(float)<br/>
Y = dataset[:,4]<br/>
# encode class values as integers<br/>
encoder = LabelEncoder()<br/>
encoder.fit(Y)<br/>
encoded_Y = encoder.transform(Y)<br/>
# convert integers to dummy variables (i.e. one hot encoded)<br/>
dummy_y = np_utils.to_categorical(encoded_Y)<br/>
# define baseline model<br/>
def baseline_model():<br/>
# create model<br/>
    model = Sequential()<br/>
    model.add(Dense(8, input_dim=4 , activation= “relu” ))<br/>
    model.add(Dense(3, activation= “softmax” ))<br/>
    # Compile model<br/>
    model.compile(loss= “categorical_crossentropy” , optimizer= “adam” , metrics=[“accuracy”])<br/>
    return model<br/>
estimator = KerasClassifier(build_fn=baseline_model, nb_epoch=200, batch_size=5, verbose=0)<br/>
kfold = KFold(n_splits=10, shuffle=True, random_state=seed)<br/>
results = cross_val_score(estimator, X, dummy_y, cv=kfold)<br/>
print(“Accuracy: %.2f%% (%.2f%%)” % (results.mean()*100, results.std()*100))</p>
<p>Using Theano backend.<br/>
Accuracy: 64.67% (15.22%)</p>
<div class="reply">
<a aria-label="Reply to Zefeng Wu" class="comment-reply-link" href="#comment-404368" onclick='return addComment.moveForm( "comment-404368", "404368", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-404653">
<div class="comment-container" id="li-comment-404653">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/95471ec7ea4b231978fc1f1617e55b69?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/95471ec7ea4b231978fc1f1617e55b69?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nunu</span>
<span class="date">July 4, 2017 at 12:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-404653" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,<br/>
How can I increase the accuracy while training ? I am always getting an accuracy arround 68% and 70%!! even if i am chanching the optimizer, the loss function and the learning rate.<br/>
(I am using keras and CNN)</p>
<div class="reply">
<a aria-label="Reply to Nunu" class="comment-reply-link" href="#comment-404653" onclick='return addComment.moveForm( "comment-404653", "404653", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-404870">
<div class="comment-container" id="li-comment-404870">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 6, 2017 at 10:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-404870" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Here are many ideas:<br/>
<a href="http://machinelearningmastery.com/machine-learning-performance-improvement-cheat-sheet/" rel="nofollow">http://machinelearningmastery.com/machine-learning-performance-improvement-cheat-sheet/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-404870" onclick='return addComment.moveForm( "comment-404870", "404870", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-405045">
<div class="comment-container" id="li-comment-405045">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/95471ec7ea4b231978fc1f1617e55b69?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/95471ec7ea4b231978fc1f1617e55b69?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nunu</span>
<span class="date">July 8, 2017 at 12:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-405045" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks a lot it is very useful 🙂</p>
<div class="reply">
<a aria-label="Reply to Nunu" class="comment-reply-link" href="#comment-405045" onclick='return addComment.moveForm( "comment-405045", "405045", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-3" id="comment-405254">
<div class="comment-container" id="li-comment-405254">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 9, 2017 at 10:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-405254" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear it.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-405254" onclick='return addComment.moveForm( "comment-405254", "405254", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-4" id="comment-405665">
<div class="comment-container" id="li-comment-405665">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/95471ec7ea4b231978fc1f1617e55b69?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/95471ec7ea4b231978fc1f1617e55b69?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nunu</span>
<span class="date">July 12, 2017 at 7:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-405665" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,<br/>
I have a question: my model should classify every image in one of the 4 classes that I have, should I use “categorical cross entropy” or I can use instead the “Binary cross entropy” ? because I read a lot that when there is n classes it is better to use categorical cross entropy, but also the binary one is used for the same cases. I am too much confused 🙁 can you help me in understanding this issue better!!<br/>
Thanks in advance,<br/>
Nunu</p>
<div class="reply">
<a aria-label="Reply to Nunu" class="comment-reply-link" href="#comment-405665" onclick='return addComment.moveForm( "comment-405665", "405665", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-405721">
<div class="comment-container" id="li-comment-405721">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 13, 2017 at 9:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-405721" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>When you have more than 2 classes, use categorical cross entropy.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-5" id="comment-406398">
<div class="comment-container" id="li-comment-406398">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/95471ec7ea4b231978fc1f1617e55b69?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/95471ec7ea4b231978fc1f1617e55b69?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nunu</span>
<span class="date">July 19, 2017 at 12:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-406398" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>oh ok thanks a lot 🙂 I have another question : I used Rmsprop with different learning rates such that 0.0001, 0.001 and 0.01 and with  softmax in the last dense layer everything was good so far. Then i changed from softmax to sigmoid and i tried to excuted the same program with the same learning rates used in the cas of softmax, and here i got the problem : using learning rate 0.001 i got loss and val loss NAN after 24 epochs !! In your opinion what is the reason of getting such values??<br/>
Thanks in advance,<br/>
have a nice day,<br/>
Nunu</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-406442">
<div class="comment-container" id="li-comment-406442">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 19, 2017 at 8:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-406442" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ensure you have scaled your input/output data to the bounds of the input/output activation functions.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-5" id="comment-406499">
<div class="comment-container" id="li-comment-406499">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/95471ec7ea4b231978fc1f1617e55b69?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/95471ec7ea4b231978fc1f1617e55b69?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nunu</span>
<span class="date">July 19, 2017 at 5:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-406499" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanksssss 🙂</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-404802">
<div class="comment-container" id="li-comment-404802">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/93580f1a9713cd109204be3959868520?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/93580f1a9713cd109204be3959868520?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sriram</span>
<span class="date">July 5, 2017 at 5:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-404802" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>HI Jason,</p>
<p>Thanks for the awesome tutorial. I have a question regarding your first hidden layer which has 8 neurons. Correct me if I’m wrong, but shouldn’t the number of neurons in a hidden layer be upperbounded by the number of inputs? (in this case 4).</p>
<p>Thanks,<br/>
Sriram</p>
<div class="reply">
<a aria-label="Reply to Sriram" class="comment-reply-link" href="#comment-404802" onclick='return addComment.moveForm( "comment-404802", "404802", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-404899">
<div class="comment-container" id="li-comment-404899">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 6, 2017 at 10:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-404899" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No. There are no rules for the number of neurons in the hidden layer. Try different configurations and go with whatever robustly gives the best results on your problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-404899" onclick='return addComment.moveForm( "comment-404899", "404899", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-405777">
<div class="comment-container" id="li-comment-405777">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/95471ec7ea4b231978fc1f1617e55b69?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/95471ec7ea4b231978fc1f1617e55b69?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nunu</span>
<span class="date">July 13, 2017 at 8:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-405777" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>ok thanks a lot,</p>
<p>have a nice day 🙂</p>
<div class="reply">
<a aria-label="Reply to Nunu" class="comment-reply-link" href="#comment-405777" onclick='return addComment.moveForm( "comment-405777", "405777", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-404818">
<div class="comment-container" id="li-comment-404818">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c7b046cc76708cd1ef34612d1ca04075?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c7b046cc76708cd1ef34612d1ca04075?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">riya</span>
<span class="date">July 5, 2017 at 10:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-404818" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>i ran the above program and got error<br/>
Import error:  bad magic numbers in ‘keras’:b’\xf3\r\n’</p>
<div class="reply">
<a aria-label="Reply to riya" class="comment-reply-link" href="#comment-404818" onclick='return addComment.moveForm( "comment-404818", "404818", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-404901">
<div class="comment-container" id="li-comment-404901">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 6, 2017 at 10:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-404901" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You may have a copy-paste example. Check your code file.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-404901" onclick='return addComment.moveForm( "comment-404901", "404901", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-404949">
<div class="comment-container" id="li-comment-404949">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c7b046cc76708cd1ef34612d1ca04075?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c7b046cc76708cd1ef34612d1ca04075?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">riya</span>
<span class="date">July 6, 2017 at 9:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-404949" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>actually a pyc file was created  in the same directory due to which this error occoured.After deleting the file,error was solved</p>
<div class="reply">
<a aria-label="Reply to riya" class="comment-reply-link" href="#comment-404949" onclick='return addComment.moveForm( "comment-404949", "404949", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-405229">
<div class="comment-container" id="li-comment-405229">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 9, 2017 at 10:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-405229" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear it.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-405229" onclick='return addComment.moveForm( "comment-405229", "405229", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-405037">
<div class="comment-container" id="li-comment-405037">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c7b046cc76708cd1ef34612d1ca04075?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c7b046cc76708cd1ef34612d1ca04075?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">riya</span>
<span class="date">July 7, 2017 at 9:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-405037" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello jason,<br/>
how is the error calculated to adjust weights in neural network?does the classifier uses backpropgation or anything else for error correction and weight adjustment?</p>
<div class="reply">
<a aria-label="Reply to riya" class="comment-reply-link" href="#comment-405037" onclick='return addComment.moveForm( "comment-405037", "405037", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-405250">
<div class="comment-container" id="li-comment-405250">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 9, 2017 at 10:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-405250" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, the backpropgation algorithm is used.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-405250" onclick='return addComment.moveForm( "comment-405250", "405250", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-405302">
<div class="comment-container" id="li-comment-405302">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c7b046cc76708cd1ef34612d1ca04075?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c7b046cc76708cd1ef34612d1ca04075?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">riya</span>
<span class="date">July 9, 2017 at 7:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-405302" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks jason</p>
<div class="reply">
<a aria-label="Reply to riya" class="comment-reply-link" href="#comment-405302" onclick='return addComment.moveForm( "comment-405302", "405302", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-405461">
<div class="comment-container" id="li-comment-405461">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 11, 2017 at 10:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-405461" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-405461" onclick='return addComment.moveForm( "comment-405461", "405461", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-406504">
<div class="comment-container" id="li-comment-406504">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/95471ec7ea4b231978fc1f1617e55b69?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/95471ec7ea4b231978fc1f1617e55b69?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nunu</span>
<span class="date">July 19, 2017 at 6:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-406504" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,<br/>
In my classifier I have 4 classes and as I know the last Dense layer should also have 4 outputs correct me please if i am wrong :). Now I want to change the number of classes from 4 to 2 !! my dataset  is labeled as follows :<br/>
1) BirdYES_TreeNo<br/>
2) BirdNo_TreeNo<br/>
3)BirdYES_TreeYES<br/>
4)BirdNo_TreeYES<br/>
At the begining  my output vector that i did was [0,0,0,0] in such a way that it can take 1 in the first place and all the rest are zeros if the image labeled as BirdYES_TreeNo and it can take 1 in the second place if it is labeled as BirdNo_TreeNo and so on… </p>
<p>Can you give me any hint inorder to convert these 4 classes into only 2 ( is there a function in Python that can do this ?) class Bird and class Tree in which every class takes 2 values 1 and 0 ( 1 indicates the exsistance of a Bird/Tree and 0 indicates that there is no Bird/Tree). I hope that my explanation is clear.<br/>
I will appreciate so much any answer from your side.<br/>
Thanks in advance,<br/>
have a nice day,<br/>
Nunu</p>
<div class="reply">
<a aria-label="Reply to Nunu" class="comment-reply-link" href="#comment-406504" onclick='return addComment.moveForm( "comment-406504", "406504", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-406548">
<div class="comment-container" id="li-comment-406548">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 20, 2017 at 6:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-406548" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, the number of nodes in the output layer should match the number of classes.</p>
<p>Unless the number of classes is 2, in which case you can use a sigmoid activation function with a single neuron. Remember to change loss to binary_crossentropy.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-406548" onclick='return addComment.moveForm( "comment-406548", "406548", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-406619">
<div class="comment-container" id="li-comment-406619">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/95471ec7ea4b231978fc1f1617e55b69?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/95471ec7ea4b231978fc1f1617e55b69?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nunu</span>
<span class="date">July 20, 2017 at 6:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-406619" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks a lot for your help i will try it.</p>
<p>Have a nice day,<br/>
Nunu</p>
<div class="reply">
<a aria-label="Reply to Nunu" class="comment-reply-link" href="#comment-406619" onclick='return addComment.moveForm( "comment-406619", "406619", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-406712">
<div class="comment-container" id="li-comment-406712">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 21, 2017 at 9:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-406712" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good luck!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-406712" onclick='return addComment.moveForm( "comment-406712", "406712", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-407344">
<div class="comment-container" id="li-comment-407344">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7c100738585b78f5c9ff23ad09ce6eac?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7c100738585b78f5c9ff23ad09ce6eac?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Prathm</span>
<span class="date">July 26, 2017 at 8:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-407344" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>kfold = KFold(n_splits=10, shuffle=True, random_state=seed)</p>
<p>This line is giving me follwing error:</p>
<p>    File “C:\Users\pratmerc\AppData\Local\Continuum\Anaconda3\lib\site-<br/>
    packages\pandas\core\indexing.py”, line 1231, in _convert_to_indexer raise KeyError(‘%s<br/>
    not in index’ % objarr[mask])</p>
<p>    KeyError: ‘[41421  7755 11349 16135 36853] not in index’</p>
<p>Can you please help ?</p>
<div class="reply">
<a aria-label="Reply to Prathm" class="comment-reply-link" href="#comment-407344" onclick='return addComment.moveForm( "comment-407344", "407344", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-407385">
<div class="comment-container" id="li-comment-407385">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 26, 2017 at 3:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-407385" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m sorry to hear that, perhaps check the data that you have loaded?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-407385" onclick='return addComment.moveForm( "comment-407385", "407385", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-408565">
<div class="comment-container" id="li-comment-408565">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6e7eb97c454e6f3397488cb510b55b05?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6e7eb97c454e6f3397488cb510b55b05?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Q. I.</span>
<span class="date">August 5, 2017 at 5:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-408565" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>Thanks for a great site. New visitor. I have a question. In line 38 in your code above, which is “print(encoder.inverse_transform(predictions))”, don’t you have to do un-one-hot-encoded or reverse one-hot-encoded first to do encoder.inverse_transform(predictions)?</p>
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Q. I." class="comment-reply-link" href="#comment-408565" onclick='return addComment.moveForm( "comment-408565", "408565", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-408574">
<div class="comment-container" id="li-comment-408574">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 5, 2017 at 5:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-408574" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Normally yes, here I would guess that the learn wrapper predicted integers directly (I don’t recall the specifics off hand).</p>
<p>Try printing the outcome of predict() to confirm.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-408574" onclick='return addComment.moveForm( "comment-408574", "408574", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-409258">
<div class="comment-container" id="li-comment-409258">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/eae97b39f0687abe24cfdd056011f279?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/eae97b39f0687abe24cfdd056011f279?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hernando Salas</span>
<span class="date">August 11, 2017 at 5:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-409258" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I really enjoy your tutorials awesome at presenting the material. I’m a little bit puzzled by the results of this project as I get %44 rather than %95 which is a huge difference. I have used your code as follows in ipython notebook online:</p>
<p>import numpy<br/>
import pandas<br/>
from keras.models import Sequential<br/>
from keras.layers import Dense<br/>
from keras.wrappers.scikit_learn import KerasClassifier<br/>
from keras.utils import np_utils<br/>
from sklearn.cross_validation import cross_val_score, KFold<br/>
from sklearn.preprocessing import LabelEncoder<br/>
from sklearn.pipeline import Pipeline</p>
<p># fix random seed for reproducibility<br/>
seed = 7<br/>
numpy.random.seed(seed)</p>
<p># load dataset<br/>
dataframe = pandas.read_csv(“iris.csv”, header=None)<br/>
dataset = dataframe.values<br/>
X = dataset[:,0:4].astype(float)<br/>
Y = dataset[:,4]</p>
<p>#encode class values as integers<br/>
encoder = LabelEncoder()<br/>
encoder.fit(Y)<br/>
encoded_Y = encoder.transform(Y)</p>
<p># convert integers to dummy variables (hot encoded)<br/>
dummy_y = np_utils.to_categorical(encoded_Y)</p>
<p># define baseline model<br/>
def baseline_model():<br/>
    # create model<br/>
    model = Sequential()<br/>
    model.add(Dense(4, input_dim=4, init=’normal’, activation=’relu’))<br/>
    model.add(Dense(3, init=’normal’, activation=’sigmoid’))<br/>
    # Compile model<br/>
    model.compile(loss=’categorical_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])</p>
<p>    return model</p>
<p>estimator = KerasClassifier(build_fn=baseline_model, nb_epoch=200, batch_size=5, verbose=0)<br/>
kfold = KFold(n=len(X), n_folds=10, shuffle=True, random_state=seed)<br/>
results = cross_val_score(estimator, X, dummy_y, cv=kfold)</p>
<p>print(“Accuracy: %.2f%% (%.2f%%)” % (results.mean()*100, results.std()*100))</p>
<div class="reply">
<a aria-label="Reply to Hernando Salas" class="comment-reply-link" href="#comment-409258" onclick='return addComment.moveForm( "comment-409258", "409258", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-409277">
<div class="comment-container" id="li-comment-409277">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 11, 2017 at 6:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-409277" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The algorithm is stochastic, so you will get different results each time it is run, try running it multiple times and take the average.</p>
<p>More about the stochastic nature of the algorithms here:<br/>
<a href="http://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">http://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-409277" onclick='return addComment.moveForm( "comment-409277", "409277", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-409623">
<div class="comment-container" id="li-comment-409623">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/eae97b39f0687abe24cfdd056011f279?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/eae97b39f0687abe24cfdd056011f279?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hernando Salas</span>
<span class="date">August 15, 2017 at 5:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-409623" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for the reply. Run several times and got the same result. Any ideas?</p>
<div class="reply">
<a aria-label="Reply to Hernando Salas" class="comment-reply-link" href="#comment-409623" onclick='return addComment.moveForm( "comment-409623", "409623", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-4" id="comment-409624">
<div class="comment-container" id="li-comment-409624">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/eae97b39f0687abe24cfdd056011f279?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/eae97b39f0687abe24cfdd056011f279?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hernando Salas</span>
<span class="date">August 15, 2017 at 5:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-409624" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p><a href="https://notebooks.azure.com/hernandosalas/libraries/deeplearning/html/main.ipynb" rel="nofollow">https://notebooks.azure.com/hernandosalas/libraries/deeplearning/html/main.ipynb</a></p>
<div class="reply">
<a aria-label="Reply to Hernando Salas" class="comment-reply-link" href="#comment-409624" onclick='return addComment.moveForm( "comment-409624", "409624", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-409641">
<div class="comment-container" id="li-comment-409641">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 15, 2017 at 6:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-409641" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You could try varying the configuration of the network to see if that has an effect?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-409641" onclick='return addComment.moveForm( "comment-409641", "409641", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-409743">
<div class="comment-container" id="li-comment-409743">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/eae97b39f0687abe24cfdd056011f279?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/eae97b39f0687abe24cfdd056011f279?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hernando Salas</span>
<span class="date">August 16, 2017 at 5:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-409743" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If I set it to:</p>
<p># create model<br/>
model = Sequential()<br/>
model.add(Dense(4, input_dim=4, init=’normal’, activation=’relu’))<br/>
model.add(Dense(3, init=’normal’, activation=’sigmoid’))</p>
<p>I get Accuracy: 44.00% (17.44%) everytime</p>
<p>If I set it to:</p>
<p># create model<br/>
model = Sequential()<br/>
model.add(Dense(8, input_dim=4, init=’normal’, activation=’relu’))<br/>
model.add(Dense(3, init=’normal’, activation=’softmax’))</p>
<p>I get Accuracy: 64.00% (10.83%) everytime</p>
<div class="reply">
<a aria-label="Reply to Hernando Salas" class="comment-reply-link" href="#comment-409743" onclick='return addComment.moveForm( "comment-409743", "409743", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-409762">
<div class="comment-container" id="li-comment-409762">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 16, 2017 at 6:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-409762" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Interesting. Thanks for sharing.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-409762" onclick='return addComment.moveForm( "comment-409762", "409762", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-410465">
<div class="comment-container" id="li-comment-410465">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8ea5dd200e49b337a91aa5d70936496a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8ea5dd200e49b337a91aa5d70936496a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Akash</span>
<span class="date">August 22, 2017 at 12:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-410465" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thank you for your wonderful tutorial and it was really helpful. I just want to ask if we can perform grid search cv also the similar way because I am not able to do it right now?</p>
<div class="reply">
<a aria-label="Reply to Akash" class="comment-reply-link" href="#comment-410465" onclick='return addComment.moveForm( "comment-410465", "410465", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-410507">
<div class="comment-container" id="li-comment-410507">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 22, 2017 at 6:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-410507" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, see this post:<br/>
<a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" rel="nofollow">https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-410507" onclick='return addComment.moveForm( "comment-410507", "410507", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-413167">
<div class="comment-container" id="li-comment-413167">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a8a404e3ddf6be55ef21c4f4a1b5f77c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a8a404e3ddf6be55ef21c4f4a1b5f77c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alexander</span>
<span class="date">September 9, 2017 at 6:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-413167" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason. Thank you for beautiful work.<br/>
Help me please.<br/>
Where (in which folder, directory) should i save file “iris.csv” to use this code? Now system doesn’t see this file, when I write “dataframe=pandas.read_csv….”</p>
<p>4. Load The Dataset<br/>
The dataset can be loaded directly. Because the output variable contains strings, it is easiest to load the data using pandas. We can then split the attributes (columns) into input variables (X) and output variables (Y).<br/>
# load dataset<br/>
dataframe = pandas.read_csv(“iris.csv”, header=None)<br/>
dataset = dataframe.values<br/>
X = dataset[:,0:4].astype(float)<br/>
Y = dataset[:,4]</p>
<div class="reply">
<a aria-label="Reply to Alexander" class="comment-reply-link" href="#comment-413167" onclick='return addComment.moveForm( "comment-413167", "413167", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-413235">
<div class="comment-container" id="li-comment-413235">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 9, 2017 at 12:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-413235" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Download it and place it in the same directory as your Python code file.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-413235" onclick='return addComment.moveForm( "comment-413235", "413235", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-413261">
<div class="comment-container" id="li-comment-413261">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a8a404e3ddf6be55ef21c4f4a1b5f77c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a8a404e3ddf6be55ef21c4f4a1b5f77c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alexander</span>
<span class="date">September 9, 2017 at 5:59 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-413261" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you, Jason. I’ll try.</p>
<div class="reply">
<a aria-label="Reply to Alexander" class="comment-reply-link" href="#comment-413261" onclick='return addComment.moveForm( "comment-413261", "413261", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-414189">
<div class="comment-container" id="li-comment-414189">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7f34e3b38d0ca3c0b51dddf3d92d338c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7f34e3b38d0ca3c0b51dddf3d92d338c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tran Minh</span>
<span class="date">September 18, 2017 at 4:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-414189" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thank you for your great instruction<br/>
I follow your code but unfortunately, I get only 68%~70% accuracy rate.<br/>
I use Tensorflow backend and modified seed as well as the number of hidden units but I still can’t reach to 90% of accuracy rate.</p>
<p>Do you have any idea how to improve it</p>
<div class="reply">
<a aria-label="Reply to Tran Minh" class="comment-reply-link" href="#comment-414189" onclick='return addComment.moveForm( "comment-414189", "414189", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-414234">
<div class="comment-container" id="li-comment-414234">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 19, 2017 at 7:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-414234" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps try running the example a few times, see this post:<br/>
<a href="https://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">https://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-414234" onclick='return addComment.moveForm( "comment-414234", "414234", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-414423">
<div class="comment-container" id="li-comment-414423">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/32e6f147312d6e3caed3372ecc2d89c1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/32e6f147312d6e3caed3372ecc2d89c1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Greg</span>
<span class="date">September 21, 2017 at 8:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-414423" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason,</p>
<p>First thanks so much for a great post.</p>
<p>I cut and pasted the code above and got the following run times with a GTX 1060</p>
<p>real	2m49.436s<br/>
user	4m46.852s<br/>
sys	0m21.944s</p>
<p>and running without the GPU</p>
<p>124.93 user 25.74 system 1:04.90 elapsed 232% CPU</p>
<p>Is this reasonable?  It seems slow for a toy problem.</p>
<div class="reply">
<a aria-label="Reply to Greg" class="comment-reply-link" href="#comment-414423" onclick='return addComment.moveForm( "comment-414423", "414423", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-414440">
<div class="comment-container" id="li-comment-414440">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 21, 2017 at 4:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-414440" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for sharing.</p>
<p>Yes, LSTMs are slower than MLPs generally.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-414440" onclick='return addComment.moveForm( "comment-414440", "414440", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-414873">
<div class="comment-container" id="li-comment-414873">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fbdaff0f001025f5f8709d9c19fd0b7e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fbdaff0f001025f5f8709d9c19fd0b7e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bee</span>
<span class="date">September 27, 2017 at 1:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-414873" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Dr. Jason,</p>
<p>It’s a great tutorial. Do you have any similar tutorials for Unsupervised classification too? </p>
<p>Thanks,<br/>
Bee</p>
<div class="reply">
<a aria-label="Reply to Bee" class="comment-reply-link" href="#comment-414873" onclick='return addComment.moveForm( "comment-414873", "414873", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-414898">
<div class="comment-container" id="li-comment-414898">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 27, 2017 at 5:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-414898" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Unsupervised methods cannot be used for classification, only supervised methods.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-414898" onclick='return addComment.moveForm( "comment-414898", "414898", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-415286">
<div class="comment-container" id="li-comment-415286">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5eefea8ef3efa6cc819c04a79dcea4f3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5eefea8ef3efa6cc819c04a79dcea4f3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bee</span>
<span class="date">October 2, 2017 at 5:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-415286" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, it was my poor choice of words. What I meant was clustering data using unsupervised methods when I don’t have labels. Is that possible with Keras?   </p>
<p>Thanks,<br/>
Bee</p>
<div class="reply">
<a aria-label="Reply to Bee" class="comment-reply-link" href="#comment-415286" onclick='return addComment.moveForm( "comment-415286", "415286", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-415308">
<div class="comment-container" id="li-comment-415308">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 2, 2017 at 9:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-415308" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It may be, but I do not have examples of working with unsupervised methods, sorry.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-415308" onclick='return addComment.moveForm( "comment-415308", "415308", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-415391">
<div class="comment-container" id="li-comment-415391">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/70ef7fa3594ed218118865632433f9d1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/70ef7fa3594ed218118865632433f9d1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Miqueias</span>
<span class="date">October 3, 2017 at 8:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-415391" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for you work describing in a very nice way how to use Keras! I’ve a question about the performance of categorical classification versus the binary one. Suppose you have a class for something you call your signal and, then, many other classes which you would call background. In that case, which way is more efficient to work on Keras: merging the different background classes and considering all of them as just one background class and then use binary classification or use a categorical one to account all the classes? In other words, is one way more sensible than the other for keras learn well the features from all the classes?</p>
<div class="reply">
<a aria-label="Reply to Miqueias" class="comment-reply-link" href="#comment-415391" onclick='return addComment.moveForm( "comment-415391", "415391", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-415431">
<div class="comment-container" id="li-comment-415431">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 3, 2017 at 3:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-415431" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question. </p>
<p>It really depends on the specific data. I would recommend designing some experiments to see what works best.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-415431" onclick='return addComment.moveForm( "comment-415431", "415431", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-415476">
<div class="comment-container" id="li-comment-415476">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/70ef7fa3594ed218118865632433f9d1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/70ef7fa3594ed218118865632433f9d1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Miqueias</span>
<span class="date">October 3, 2017 at 10:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-415476" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for fast replay Jason!<br/>
I’ll try that to see what I get.<br/>
I’m wondering if in categorical classification Keras can build up independent functions inside it. Because, since the background classes may exist in different phase space regions (what would be more truthfully described by separated functions), training the net with all of them together for binary classification may not extract all the features from each one. In principle, that could be done with a single net but, it would probably require more neurons (which increases the over-fitting issue).<br/>
By the way, what do you think about training different nets for signal vs. each background? Could they be combined in the end?</p>
<div class="reply">
<a aria-label="Reply to Miqueias" class="comment-reply-link" href="#comment-415476" onclick='return addComment.moveForm( "comment-415476", "415476", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-415513">
<div class="comment-container" id="li-comment-415513">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 4, 2017 at 5:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-415513" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If the classes are separable I would encourage you to model them as separate problems.</p>
<p>Nevertheless, the best advice is always to test each idea and see what works best on your problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-415513" onclick='return addComment.moveForm( "comment-415513", "415513", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-416286">
<div class="comment-container" id="li-comment-416286">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b5ff592108eb6f2de53ebf051bdd2138?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b5ff592108eb6f2de53ebf051bdd2138?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Dave</span>
<span class="date">October 11, 2017 at 5:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-416286" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason! I have a question about multi classification</p>
<p>I would like to classify the 3 class of sleep disordered breathing.</p>
<p>I designed the LSTM network. but it works like under the table.</p>
<p>What is this situation?</p>
<p>Train matrix: precision    recall  f1-score   support</p>
<p>          0       0.00      0.00      0.00      1749<br/>
          1       0.46      1.00      0.63      2979<br/>
          2       0.00      0.00      0.00      1760</p>
<p>avg / total       0.21      0.46      0.29      6488</p>
<p>Train matrix: precision    recall  f1-score   support</p>
<p>          0       0.00      0.00      0.00       441<br/>
          1       0.46      1.00      0.63       750<br/>
          2       0.00      0.00      0.00       431</p>
<p>avg / total       0.21      0.46      0.29      1622</p>
<div class="reply">
<a aria-label="Reply to Dave" class="comment-reply-link" href="#comment-416286" onclick='return addComment.moveForm( "comment-416286", "416286", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-416580">
<div class="comment-container" id="li-comment-416580">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d64c80a78c936a88939437ab8be7599e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d64c80a78c936a88939437ab8be7599e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sasi</span>
<span class="date">October 13, 2017 at 10:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-416580" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
            Does this topic will match for this  tutorial??<br/>
 “Deep learning based multiclass classification tutorial”</p>
<div class="reply">
<a aria-label="Reply to sasi" class="comment-reply-link" href="#comment-416580" onclick='return addComment.moveForm( "comment-416580", "416580", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-416623">
<div class="comment-container" id="li-comment-416623">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 14, 2017 at 5:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-416623" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-416623" onclick='return addComment.moveForm( "comment-416623", "416623", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-416935">
<div class="comment-container" id="li-comment-416935">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7772fe744d3a4c2d2a0d0b97ab0a47e6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7772fe744d3a4c2d2a0d0b97ab0a47e6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">zaheer</span>
<span class="date">October 16, 2017 at 11:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-416935" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This tutorial is awsom. thanks for your time.<br/>
My data is<br/>
404. instances<br/>
2. class label. A/B<br/>
20. attribute columns.</p>
<p>i have tried the this example gives me 58% acc.<br/>
model = Sequential()<br/>
	model.add(Dense(200, input_dim=20, activation=’relu’))<br/>
	model.add(Dense(2, activation=’softmax’))<br/>
	# Compile model<br/>
	model.compile(loss=’categorical_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])<br/>
	return model</p>
<p>#Classifier invoking<br/>
estimator = KerasClassifier(build_fn=baseline_model, epochs=200, batch_size=5, verbose=0)</p>
<p>what should i do, how to increase the acc of the system</p>
<div class="reply">
<a aria-label="Reply to zaheer" class="comment-reply-link" href="#comment-416935" onclick='return addComment.moveForm( "comment-416935", "416935", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-416983">
<div class="comment-container" id="li-comment-416983">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 17, 2017 at 5:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-416983" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>See this post for a ton of ideas:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-416983" onclick='return addComment.moveForm( "comment-416983", "416983", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-417661">
<div class="comment-container" id="li-comment-417661">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ee937f19ed467fa81939b0f1a470a590?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ee937f19ed467fa81939b0f1a470a590?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Curious_Kid</span>
<span class="date">October 24, 2017 at 1:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-417661" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
              My training data consists of lines of characters with each line corresponding to a label.</p>
<p>E.g. afhafajkfajkfhafkahfahk 6</p>
<p>        fafafafafaftuiowjtwojdfafanfa 8</p>
<p>        dakworfwajanfnafjajfahifqnfqqfnq  4</p>
<p>Here, 6,8 and 4 are labels for each line of the training data.<br/>
……………………………………………………..</p>
<p>I have first done the integer encoding for each character and then done the one hot encoding. To keep the integer encoding consistent, I first looked for the unique letters in all the rows and then did the integer encoding. e.g. that’s why letter h will always be encoded as 7 in all the lines. </p>
<p>For a better understanding, consider a simple example where my training data has 3 lines(each line has some label):<br/>
af<br/>
fa<br/>
nf</p>
<p>It will be one hot encoded as:</p>
<p>0  [[1.0, 0.0, 0.0], [0.0, 1.0, 0.0]]<br/>
1  [[0.0, 1.0, 0.0], [1.0, 0.0, 0.0]]<br/>
2  [[0.0, 0.0, 1.0], [0.0, 1.0, 0.0]]</p>
<p>I wanted to do the classification for the unseen data(which label does the new line belong to) by training a neural network on this one hot encoded training data. </p>
<p>I am not able to understand how my model should look like as I want the model to learn from each one hot encoded character for each line. Could you please suggest me something in this case? Please let me know if you need more information to understand the problem.</p>
<div class="reply">
<a aria-label="Reply to Curious_Kid" class="comment-reply-link" href="#comment-417661" onclick='return addComment.moveForm( "comment-417661", "417661", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417688">
<div class="comment-container" id="li-comment-417688">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 24, 2017 at 5:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-417688" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is a sequence classification task.</p>
<p>Perhaps this post will give you a template to get started:<br/>
<a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" rel="nofollow">https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-417688" onclick='return addComment.moveForm( "comment-417688", "417688", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-417695">
<div class="comment-container" id="li-comment-417695">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ee937f19ed467fa81939b0f1a470a590?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ee937f19ed467fa81939b0f1a470a590?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Curious_Kid</span>
<span class="date">October 24, 2017 at 6:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-417695" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason for the reply.</p>
<p>However, I am not dealing with words. I just have characters in a line and I am doing one hot encoding for each character in a single line as I explained above. What I am confused with is the shapes that I have to give to the layers of my network.</p>
<div class="reply">
<a aria-label="Reply to Curious_Kid" class="comment-reply-link" href="#comment-417695" onclick='return addComment.moveForm( "comment-417695", "417695", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-417730">
<div class="comment-container" id="li-comment-417730">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 24, 2017 at 3:56 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-417730" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I see, perhaps this post will help with reshaping your data:<br/>
<a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" rel="nofollow">https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-417730" onclick='return addComment.moveForm( "comment-417730", "417730", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-427595">
<div class="comment-container" id="li-comment-427595">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7db579d9b1650c32f387a73cb3c1fe32?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7db579d9b1650c32f387a73cb3c1fe32?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nrithya Muniswamy</span>
<span class="date">January 26, 2018 at 1:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-427595" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>@Curious_Kid : did you find a workaround, I am dealing with same problem</p>
<div class="reply">
<a aria-label="Reply to Nrithya Muniswamy" class="comment-reply-link" href="#comment-427595" onclick='return addComment.moveForm( "comment-427595", "427595", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-419147">
<div class="comment-container" id="li-comment-419147">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a759748bdc1b036d3fd5ace8e24f6acb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a759748bdc1b036d3fd5ace8e24f6acb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">philippe</span>
<span class="date">November 6, 2017 at 9:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-419147" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason, </p>
<p>very clear tutorial. one quick question, how do you decide on the number of hidden neurons (in classification case). it seems to follow (Hidden neurons  = input  * 2) , how about * 1 or *3 is there a rule. same goes for epoch ; how do you choose nbr of iterations; </p>
<p>thanks.</p>
<div class="reply">
<a aria-label="Reply to philippe" class="comment-reply-link" href="#comment-419147" onclick='return addComment.moveForm( "comment-419147", "419147", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-419197">
<div class="comment-container" id="li-comment-419197">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 7, 2017 at 9:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-419197" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>There are no good rules, use trial and error or a robust test harness and a grid search.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-419197" onclick='return addComment.moveForm( "comment-419197", "419197", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-419918">
<div class="comment-container" id="li-comment-419918">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/268c7a2e81e3e763cab6e10de1d6a42f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/268c7a2e81e3e763cab6e10de1d6a42f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Niklas Wilke</span>
<span class="date">November 13, 2017 at 11:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-419918" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>great tutorial!<br/>
I’ve got a multi class classification problem. I try to classify different kind of bills into categorys (that are given !! no clustering!!) , like flight, train/bus, meal, hotels and so on.<br/>
I got a couple files in PDF which i transform in PNG to make it processable by MC Computer Vision using OCR.<br/>
After that i come out with a .txt or .csv file of the plain text.<br/>
Now i used skelarns vectorizers to create a bag of words and fit the single bills/documents.<br/>
Ending up with numpy-arrays looking like this (sample data i used to craete the code while i was gathering data):</p>
<p>[[3 0 1 1 0 0 0 0 2 0 2 2 1 3 1 1 0 3 0 0 3 2 1 0 1 3 1 0 0 5 0 0 1 1 0 1 0<br/>
  0 1 1 1 1 0 1 0 1 0 1 0 2 0 2 1 0 1 0 1 1 1 1 1 0 0 1 0 1 1 1 1 0 0 1 1 1<br/>
  0 1 1 0 0 0 0 1 0 0 0 1 0 0 1 1 1 2 1 0 0 0 0 0 0 0 2 1 0 0 0 2 1 0 1 0 1<br/>
  0 0 0 0 0 0 1 0 0 0 0 0 0 1 1 0 0 0 0 1 0 0 0 0 0 0 0 2 0 0 0 0 0 0 2 0 1<br/>
  0 0 1 1 0 0 1 1 1 0 0 1 0 0 0 0 0 1 1 0 0 0 1 0 0 0 0 1 0 0 1 1 1 0 2 0 0<br/>
  0 1 4 1 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 0 2 3 0 1 0 0 0 0 0 1 0 3 0 1 0<br/>
  1 1 0 0 0 0 0 0 1 2 0 0 0 3 0 0 0 1 0 0 0 1 1 0 2 0 0 0 0 1 0 1 1 0 0 1 0<br/>
  1 1 0 1 0 0 1 0 0 0 0 1 0]]</p>
<p>How do i categoryze or transform this to something like the iris dataset ?<br/>
Isn’t it basically the same ? Just with way more numbers and bigger arrrays ?<br/>
I tried to iterate through the array to print every single number in a .csv-file and then just append the category at the back with some for loops  but sadly you can’t iterate through numpy-arrays … + i can’t imagine that’s the intended way of labeling data …</p>
<p>Thanks for reading through this way too long comment , help is highly apreciated.</p>
<div class="reply">
<a aria-label="Reply to Niklas Wilke" class="comment-reply-link" href="#comment-419918" onclick='return addComment.moveForm( "comment-419918", "419918", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-419951">
<div class="comment-container" id="li-comment-419951">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 14, 2017 at 10:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-419951" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, the vectorized documents become input to ML algorithms.</p>
<p>I’d love to hear how you go, post your results!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-419951" onclick='return addComment.moveForm( "comment-419951", "419951", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-421631">
<div class="comment-container" id="li-comment-421631">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/268c7a2e81e3e763cab6e10de1d6a42f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/268c7a2e81e3e763cab6e10de1d6a42f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Niklas Wilke</span>
<span class="date">November 30, 2017 at 1:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-421631" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Finally solved all my preprocessing problems and today i was able to perform my first training trial runns with my actual dataset. (Btw : buffer_y = dummy_y)</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7b890b1e716143745" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
def createModell():
    #8137 words = input shape
    #14 categorys = output shape

    model = Sequential()
    model.add(Dense(8137, input_dim = 8137, activation='relu'))
    model.add(Dense(2250,  activation='relu'))
    #model.add(Dense(581,  activation='relu'))
    model.add(Dense(14,  activation='softmax'))
    
    model.compile(loss= 'categorical_crossentropy', optimizer='adam', metrics = ['accuracy'])
    return model

estimator = KerasClassifier(build_fn = createModell, epochs = 10, batch_size = 6)
crossvalidation_data = KFold(n_splits = 39, shuffle = True)
results = cross_val_score(estimator, X, buffer_y, cv= crossvalidation_data)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7b890b1e716143745-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b890b1e716143745-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7b890b1e716143745-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b890b1e716143745-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7b890b1e716143745-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b890b1e716143745-6">6</div><div class="crayon-num" data-line="crayon-5c0ca7b890b1e716143745-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b890b1e716143745-8">8</div><div class="crayon-num" data-line="crayon-5c0ca7b890b1e716143745-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b890b1e716143745-10">10</div><div class="crayon-num" data-line="crayon-5c0ca7b890b1e716143745-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b890b1e716143745-12">12</div><div class="crayon-num" data-line="crayon-5c0ca7b890b1e716143745-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b890b1e716143745-14">14</div><div class="crayon-num" data-line="crayon-5c0ca7b890b1e716143745-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b890b1e716143745-16">16</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7b890b1e716143745-1"><span class="crayon-e">def </span><span class="crayon-e">createModell</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b890b1e716143745-2"><span class="crayon-h">    </span><span class="crayon-p">#8137 words = input shape</span></div><div class="crayon-line" id="crayon-5c0ca7b890b1e716143745-3"><span class="crayon-h">    </span><span class="crayon-p">#14 categorys = output shape</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b890b1e716143745-4"> </div><div class="crayon-line" id="crayon-5c0ca7b890b1e716143745-5"><span class="crayon-h">    </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b890b1e716143745-6"><span class="crayon-h">    </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">8137</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">8137</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b890b1e716143745-7"><span class="crayon-h">    </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">2250</span><span class="crayon-sy">,</span><span class="crayon-h">  </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b890b1e716143745-8"><span class="crayon-h">    </span><span class="crayon-p">#model.add(Dense(581,  activation='relu'))</span></div><div class="crayon-line" id="crayon-5c0ca7b890b1e716143745-9"><span class="crayon-h">    </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">14</span><span class="crayon-sy">,</span><span class="crayon-h">  </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b890b1e716143745-10"><span class="crayon-h">    </span></div><div class="crayon-line" id="crayon-5c0ca7b890b1e716143745-11"><span class="crayon-h">    </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b890b1e716143745-12"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">model</span></div><div class="crayon-line" id="crayon-5c0ca7b890b1e716143745-13"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b890b1e716143745-14"><span class="crayon-v">estimator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">createModell</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b890b1e716143745-15"><span class="crayon-v">crossvalidation_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_splits</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">39</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b890b1e716143745-16"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">buffer_y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">crossvalidation_data</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0011 seconds] -->
<p></p>
<p>And hell am i overfitting.<br/>
0.98 acuraccy , which can’t be because my dataset is horribly unbalanced. (maybe thats the issue?)</p>
<p>Anyhow, i enabled the print option and for me it only displays 564/564 sample files for every epoche even though my dataset contains 579 … i check for you example and it also only displays 140/140 even though the iris dataset is 150 files big.</p>
<p>Are the splits to high ?<br/>
and what is a good amount of nodes for such a high input shape :/ tried to split it up to multiple layers so its not 8139 -&gt; 4000-&gt; 14</p>
<p>Cheers<br/>
Niklas</p>
<div class="reply">
<a aria-label="Reply to Niklas Wilke" class="comment-reply-link" href="#comment-421631" onclick='return addComment.moveForm( "comment-421631", "421631", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-421667">
<div class="comment-container" id="li-comment-421667">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 30, 2017 at 8:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-421667" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Well done!</p>
<p>Consider the options in this post for imbalanced data:<br/>
<a href="https://machinelearningmastery.com/tactics-to-combat-imbalanced-classes-in-your-machine-learning-dataset/" rel="nofollow">https://machinelearningmastery.com/tactics-to-combat-imbalanced-classes-in-your-machine-learning-dataset/</a></p>
<p>The count is wrong because you are using cross-validation (e.g. not all samples for each run).</p>
<p>You must use trial and error to explore alternative configurations, here are some ideas:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<p>I hope that helps as a start.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-421667" onclick='return addComment.moveForm( "comment-421667", "421667", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-421729">
<div class="comment-container" id="li-comment-421729">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/268c7a2e81e3e763cab6e10de1d6a42f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/268c7a2e81e3e763cab6e10de1d6a42f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Niklas Wilke</span>
<span class="date">November 30, 2017 at 6:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-421729" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ah ok , good point. When i create 10 splits it only uses 521 files =&gt; 90% of 579</p>
<p>Will look into it and post my hopefully sucessfull results here.</p>
<p>Given that i had no issue with the imbalance of my dataset, is the general amount of nodes or layers alright ? I have literally no clue because all the tipps ive found so far refer to way smaller input shapes like 4 or 8.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-421796">
<div class="comment-container" id="li-comment-421796">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 1, 2017 at 7:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-421796" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>There are no good rules of thumb, I recommend testing a suite of configurations to see what works best for your problem.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-5" id="comment-421732">
<div class="comment-container" id="li-comment-421732">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/268c7a2e81e3e763cab6e10de1d6a42f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/268c7a2e81e3e763cab6e10de1d6a42f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Niklas Wilke</span>
<span class="date">November 30, 2017 at 7:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-421732" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I read you mentioned other classifiers like decision trees performing well on imbalanced datasets. </p>
<p>Is there some way i can use other classifiers INSIDE of my NN ?</p>
<p>for example could i implement naive bayes into my NN ?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-421797">
<div class="comment-container" id="li-comment-421797">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 1, 2017 at 7:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-421797" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not that I am aware.</p>
<p>You could combine the predictions from multiple models into an ensemble though.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-421730">
<div class="comment-container" id="li-comment-421730">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/268c7a2e81e3e763cab6e10de1d6a42f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/268c7a2e81e3e763cab6e10de1d6a42f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Niklas Wilke</span>
<span class="date">November 30, 2017 at 6:59 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-421730" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Btw, even though i tell it to run 10 epoches , after the 10 epoches it just starts again with slightly different values. In your example it doesnt.</p>
<p>Epoch 1/10<br/>
521/521 [==============================] – 12s – loss: 2.0381 – acc: 0.4952<br/>
Epoch 2/10<br/>
521/521 [==============================] – 10s – loss: 0.3139 – acc: 0.9443<br/>
Epoch 3/10<br/>
521/521 [==============================] – 10s – loss: 0.0748 – acc: 0.9866<br/>
Epoch 4/10<br/>
521/521 [==============================] – 11s – loss: 0.0578 – acc: 0.9942<br/>
Epoch 5/10<br/>
521/521 [==============================] – 11s – loss: 0.0434 – acc: 0.9962<br/>
Epoch 6/10<br/>
521/521 [==============================] – 11s – loss: 0.0352 – acc: 0.9962<br/>
Epoch 7/10<br/>
521/521 [==============================] – 11s – loss: 0.0321 – acc: 0.9981<br/>
Epoch 8/10<br/>
521/521 [==============================] – 11s – loss: 0.0314 – acc: 0.9981<br/>
Epoch 9/10<br/>
521/521 [==============================] – 11s – loss: 0.0312 – acc: 0.9981<br/>
Epoch 10/10<br/>
521/521 [==============================] – 11s – loss: 0.0311 – acc: 0.9981<br/>
58/58 [==============================] – 0s<br/>
Epoch 1/10<br/>
521/521 [==============================] – 13s – loss: 1.9028 – acc: 0.4722<br/>
Epoch 2/10<br/>
521/521 [==============================] – 11s – loss: 0.2883 – acc: 0.9463<br/>
Epoch 3/10<br/>
521/521 [==============================] – 11s – loss: 0.1044 – acc: 0.9770<br/>
Epoch 4/10<br/>
521/521 [==============================] – 11s – loss: 0.0543 – acc: 0.9942</p>
<div class="reply">
<a aria-label="Reply to Niklas Wilke" class="comment-reply-link" href="#comment-421730" onclick='return addComment.moveForm( "comment-421730", "421730", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-421753">
<div class="comment-container" id="li-comment-421753">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/268c7a2e81e3e763cab6e10de1d6a42f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/268c7a2e81e3e763cab6e10de1d6a42f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Niklas Wilke</span>
<span class="date">November 30, 2017 at 11:38 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-421753" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
could you please comment on this blog entry :<br/>
<a href="http://www.alfredo.motta.name/cross-validation-done-wrong/" rel="nofollow">http://www.alfredo.motta.name/cross-validation-done-wrong/</a></p>
<p>Sounds pretty logical to me and isnt that exactly what we are doing here ?<br/>
If we ignore the feature selection part, we also split the data first and afterwards train the model ….</p>
<p>Thanks in advance</p>
<div class="reply">
<a aria-label="Reply to Niklas Wilke" class="comment-reply-link" href="#comment-421753" onclick='return addComment.moveForm( "comment-421753", "421753", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-423272">
<div class="comment-container" id="li-comment-423272">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bd9d77e6806d07198f8c45dac740503d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bd9d77e6806d07198f8c45dac740503d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Summer Cassidy</span>
<span class="date">December 16, 2017 at 12:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-423272" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason Brownlee,<br/>
When I run the code I get an error. I have checked multiple times whether I have copied the code correctly. I am unable to trace why the error is occurring. Can you please help me out?<br/>
The error is:</p>
<p>Traceback (most recent call last):<br/>
  File “F:/7th semester/machine language/thesis work/python/iris2.py”, line 36, in<br/>
    results = cross_val_score(estimator, X, dummy_y, cv=kfold)<br/>
  File “C:\Users\ratul\AppData\Local\Programs\Python\Python35\lib\site-packages\sklearn\model_selection\_validation.py”, line 342, in cross_val_score<br/>
    pre_dispatch=pre_dispatch)<br/>
  File “C:\Users\ratul\AppData\Local\Programs\Python\Python35\lib\site-packages\sklearn\model_selection\_validation.py”, line 206, in cross_validate<br/>
    for train, test in cv.split(X, y, groups))<br/>
  File “C:\Users\ratul\AppData\Local\Programs\Python\Python35\lib\site-packages\sklearn\externals\joblib\parallel.py”, line 779, in __call__<br/>
    while self.dispatch_one_batch(iterator):<br/>
  File “C:\Users\ratul\AppData\Local\Programs\Python\Python35\lib\site-packages\sklearn\externals\joblib\parallel.py”, line 625, in dispatch_one_batch<br/>
    self._dispatch(tasks)<br/>
  File “C:\Users\ratul\AppData\Local\Programs\Python\Python35\lib\site-packages\sklearn\externals\joblib\parallel.py”, line 588, in _dispatch<br/>
    job = self._backend.apply_async(batch, callback=cb)<br/>
  File “C:\Users\ratul\AppData\Local\Programs\Python\Python35\lib\site-packages\sklearn\externals\joblib\_parallel_backends.py”, line 111, in apply_async<br/>
    result = ImmediateResult(func)<br/>
  File “C:\Users\ratul\AppData\Local\Programs\Python\Python35\lib\site-packages\sklearn\externals\joblib\_parallel_backends.py”, line 332, in __init__<br/>
    self.results = batch()<br/>
  File “C:\Users\ratul\AppData\Local\Programs\Python\Python35\lib\site-packages\sklearn\externals\joblib\parallel.py”, line 131, in __call__<br/>
    return [func(*args, **kwargs) for func, args, kwargs in self.items]<br/>
  File “C:\Users\ratul\AppData\Local\Programs\Python\Python35\lib\site-packages\sklearn\externals\joblib\parallel.py”, line 131, in<br/>
    return [func(*args, **kwargs) for func, args, kwargs in self.items]<br/>
  File “C:\Users\ratul\AppData\Local\Programs\Python\Python35\lib\site-packages\sklearn\model_selection\_validation.py”, line 458, in _fit_and_score<br/>
    estimator.fit(X_train, y_train, **fit_params)<br/>
  File “C:\Users\ratul\AppData\Local\Programs\Python\Python35\lib\site-packages\keras\wrappers\scikit_learn.py”, line 203, in fit<br/>
    return super(KerasClassifier, self).fit(x, y, **kwargs)<br/>
  File “C:\Users\ratul\AppData\Local\Programs\Python\Python35\lib\site-packages\keras\wrappers\scikit_learn.py”, line 147, in fit<br/>
    history = self.model.fit(x, y, **fit_args)<br/>
  File “C:\Users\ratul\AppData\Local\Programs\Python\Python35\lib\site-packages\keras\models.py”, line 960, in fit<br/>
    validation_steps=validation_steps)<br/>
  File “C:\Users\ratul\AppData\Local\Programs\Python\Python35\lib\site-packages\keras\engine\training.py”, line 1581, in fit<br/>
    batch_size=batch_size)<br/>
  File “C:\Users\ratul\AppData\Local\Programs\Python\Python35\lib\site-packages\keras\engine\training.py”, line 1418, in _standardize_user_data<br/>
    exception_prefix=’target’)<br/>
  File “C:\Users\ratul\AppData\Local\Programs\Python\Python35\lib\site-packages\keras\engine\training.py”, line 153, in _standardize_input_data<br/>
    str(array.shape))<br/>
ValueError: Error when checking target: expected dense_2 to have shape (None, 3) but got array with shape (90, 40)</p>
<div class="reply">
<a aria-label="Reply to Summer Cassidy" class="comment-reply-link" href="#comment-423272" onclick='return addComment.moveForm( "comment-423272", "423272", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-423339">
<div class="comment-container" id="li-comment-423339">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 16, 2017 at 5:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-423339" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Looks like you might be using different data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-423339" onclick='return addComment.moveForm( "comment-423339", "423339", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-423360">
<div class="comment-container" id="li-comment-423360">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bd9d77e6806d07198f8c45dac740503d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bd9d77e6806d07198f8c45dac740503d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Summer Cassidy</span>
<span class="date">December 16, 2017 at 6:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-423360" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for looking into the problem. I downloaded the iris flower dataset but from a different source. Changing the source to UCI Machine Learning repository solved my problem.</p>
<div class="reply">
<a aria-label="Reply to Summer Cassidy" class="comment-reply-link" href="#comment-423360" onclick='return addComment.moveForm( "comment-423360", "423360", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-423396">
<div class="comment-container" id="li-comment-423396">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 16, 2017 at 9:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-423396" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear it!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-423396" onclick='return addComment.moveForm( "comment-423396", "423396", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-425357">
<div class="comment-container" id="li-comment-425357">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c3de1765adb318e9a037da34c28ef80f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c3de1765adb318e9a037da34c28ef80f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Pubudu</span>
<span class="date">January 1, 2018 at 4:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-425357" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason:</p>
<p>Thanks for the tute. BTW, how do you planning to void dummy variable trap. You don’t need all three types. Can you explain why you didn’t use train_test_split method?</p>
<div class="reply">
<a aria-label="Reply to Pubudu" class="comment-reply-link" href="#comment-425357" onclick='return addComment.moveForm( "comment-425357", "425357", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425383">
<div class="comment-container" id="li-comment-425383">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 2, 2018 at 5:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-425383" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The example uses k-fold cross validation instead of a train/test split.</p>
<p>The results are less biased with this method and I recommend it for smaller models.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425383" onclick='return addComment.moveForm( "comment-425383", "425383", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-425833">
<div class="comment-container" id="li-comment-425833">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0ad44132fd5da5667cb6e69bd8818e41?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0ad44132fd5da5667cb6e69bd8818e41?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hieu</span>
<span class="date">January 7, 2018 at 7:38 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-425833" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,<br/>
Thank you for your sharing.<br/>
I run your source code, now I want to replace “activation=’softmax'” –  (model.add(Dense(3, activation=’softmax’)) with multi-class SVM to classify. How can I do it?<br/>
Coul you please help me? Thank you so much!</p>
<div class="reply">
<a aria-label="Reply to Hieu" class="comment-reply-link" href="#comment-425833" onclick='return addComment.moveForm( "comment-425833", "425833", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425850">
<div class="comment-container" id="li-comment-425850">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 8, 2018 at 5:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-425850" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is a neural network example, not SVM. Perhaps I don’t understand your question. Can you restate it?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425850" onclick='return addComment.moveForm( "comment-425850", "425850", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-425986">
<div class="comment-container" id="li-comment-425986">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0ad44132fd5da5667cb6e69bd8818e41?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0ad44132fd5da5667cb6e69bd8818e41?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hieu</span>
<span class="date">January 9, 2018 at 8:39 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-425986" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jaso,<br/>
Thank you for your reply.<br/>
Because your example uses “Softmax regression” method to classify,  Now I want to use “multi-class SVM” method to add to the neural network to classify. When using SVM method, the accuracy of training data doesn’t change in each iteration and I only got 9.5% after training.<br/>
This is my code<br/>
……<br/>
model.add(Dense(1000, activation=’relu’))</p>
<p>#=======for softmax============<br/>
# model.add(Dense(10, activation=’softmax’))<br/>
# model.compile(loss=keras.losses.categorical_crossentropy,<br/>
#               optimizer=keras.optimizers.Adam(),<br/>
#               metrics=[‘accuracy’])</p>
<p>#========for SVM ==============<br/>
model.add(Dense(10, kernel_regularizer=regularizers.l2(0.01), activity_regularizer=regularizers.l1(0.01)))<br/>
model.add(Activation(‘linear’))<br/>
model.compile(loss=’hinge’,<br/>
                optimizer=’sgd’,<br/>
                metrics=[‘accuracy’])</p>
<p>Thank you!</p>
<div class="reply">
<a aria-label="Reply to Hieu" class="comment-reply-link" href="#comment-425986" onclick='return addComment.moveForm( "comment-425986", "425986", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426057">
<div class="comment-container" id="li-comment-426057">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 10, 2018 at 5:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-426057" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Here are some ideas to try:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426057" onclick='return addComment.moveForm( "comment-426057", "426057", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-426181">
<div class="comment-container" id="li-comment-426181">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0ad44132fd5da5667cb6e69bd8818e41?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0ad44132fd5da5667cb6e69bd8818e41?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hieu</span>
<span class="date">January 11, 2018 at 6:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-426181" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,<br/>
Thank you for your help! I will read and try it.</p>
<p>Have a nice day.<br/>
Trung Hieu</p>
<div class="reply">
<a aria-label="Reply to Hieu" class="comment-reply-link" href="#comment-426181" onclick='return addComment.moveForm( "comment-426181", "426181", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-426086">
<div class="comment-container" id="li-comment-426086">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ad529db123d5001dd3ff41235ff72b2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ad529db123d5001dd3ff41235ff72b2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Arjun</span>
<span class="date">January 10, 2018 at 9:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-426086" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for the content.<br/>
Could you tell me how we could do grid search for a multi class classification problem?</p>
<p>I tried doing:<br/>
# create model<br/>
model = KerasClassifier(build_fn=neural, verbose=0)</p>
<p># define the grid search parameters<br/>
batch_size = [10, 20, 40, 60, 80, 100]<br/>
epochs = [10, 50, 100]<br/>
param_grid = dict(batch_size=batch_size, epochs=epochs)<br/>
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1)<br/>
grid_result = grid.fit(X_train, Y_train)<br/>
# summarize results<br/>
print(“Best: %f using %s” % (grid_result.best_score_, grid_result.best_params_))<br/>
means = grid_result.cv_results_[‘mean_test_score’]<br/>
stds = grid_result.cv_results_[‘std_test_score’]<br/>
params = grid_result.cv_results_[‘params’]<br/>
for mean, stdev, param in zip(means, stds, params):<br/>
    print(“%f (%f) with: %r” % (mean, stdev, param))</p>
<p>but its giving me an error saying :<br/>
ValueError: Invalid shape for y: ()</p>
<p>I had one hot encoded the Y variable( having 3 classes)</p>
<div class="reply">
<a aria-label="Reply to Arjun" class="comment-reply-link" href="#comment-426086" onclick='return addComment.moveForm( "comment-426086", "426086", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-426107">
<div class="comment-container" id="li-comment-426107">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 10, 2018 at 3:41 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-426107" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Looks like you might need to one hot encode your output data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426107" onclick='return addComment.moveForm( "comment-426107", "426107", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-426565">
<div class="comment-container" id="li-comment-426565">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f98a2b8aa8c9c19f23b23783fb646460?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f98a2b8aa8c9c19f23b23783fb646460?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Budi</span>
<span class="date">January 15, 2018 at 4:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-426565" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Another nice result..</p>
<p>Using TensorFlow backend.<br/>
2018-01-15 00:01:58.609360: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX<br/>
Baseline: 97.33% (4.42%)</p>
<p>but, could you explain what the meaning of my CPU support instruction..</p>
<p>thanks alot..</p>
<div class="reply">
<a aria-label="Reply to Budi" class="comment-reply-link" href="#comment-426565" onclick='return addComment.moveForm( "comment-426565", "426565", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-426589">
<div class="comment-container" id="li-comment-426589">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 15, 2018 at 7:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-426589" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Well done. </p>
<p>You can ignore that warning.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426589" onclick='return addComment.moveForm( "comment-426589", "426589", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-426826">
<div class="comment-container" id="li-comment-426826">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/265f8571ccaba2290ffc856bb2ccde21?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/265f8571ccaba2290ffc856bb2ccde21?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">kristi</span>
<span class="date">January 18, 2018 at 3:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-426826" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m getting accuracy 0f 33.3% only.I’m using keras2</p>
<div class="reply">
<a aria-label="Reply to kristi" class="comment-reply-link" href="#comment-426826" onclick='return addComment.moveForm( "comment-426826", "426826", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-426872">
<div class="comment-container" id="li-comment-426872">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 19, 2018 at 6:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-426872" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps try running the example again?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426872" onclick='return addComment.moveForm( "comment-426872", "426872", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-426855">
<div class="comment-container" id="li-comment-426855">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/182dae290589bea3db1a154befce98c4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/182dae290589bea3db1a154befce98c4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shivang</span>
<span class="date">January 19, 2018 at 1:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-426855" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,<br/>
How would you handle the dummy variable trap? In this case, we have 3 categories by applying One hot encoding we get three columns but we can work with only two of them to avoid this dummy variable trap.<br/>
Please tell how is it handled here?</p>
<div class="reply">
<a aria-label="Reply to Shivang" class="comment-reply-link" href="#comment-426855" onclick='return addComment.moveForm( "comment-426855", "426855", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-426887">
<div class="comment-container" id="li-comment-426887">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 19, 2018 at 6:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-426887" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What trap are you referring to?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426887" onclick='return addComment.moveForm( "comment-426887", "426887", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-426924">
<div class="comment-container" id="li-comment-426924">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/182dae290589bea3db1a154befce98c4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/182dae290589bea3db1a154befce98c4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shivang</span>
<span class="date">January 19, 2018 at 5:56 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-426924" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Please refer this:<br/>
<a href="http://www.algosome.com/articles/dummy-variable-trap-regression.html" rel="nofollow">http://www.algosome.com/articles/dummy-variable-trap-regression.html</a></p>
<div class="reply">
<a aria-label="Reply to Shivang" class="comment-reply-link" href="#comment-426924" onclick='return addComment.moveForm( "comment-426924", "426924", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-426983">
<div class="comment-container" id="li-comment-426983">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 20, 2018 at 8:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-426983" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is for inputs not outputs and is for linear models not non-linear models.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426983" onclick='return addComment.moveForm( "comment-426983", "426983", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-428210">
<div class="comment-container" id="li-comment-428210">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bed5b814be00270776badc379880ea26?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bed5b814be00270776badc379880ea26?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Pradeep</span>
<span class="date">February 2, 2018 at 3:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-428210" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason !! Thanx for explaining in such a nice way.<br/>
I am using the similar dataset, having multiple classes. But at the end, model give the accuracy.<br/>
How can I visualize the individual class accuracy in terms of Precision and Recall?</p>
<div class="reply">
<a aria-label="Reply to Pradeep" class="comment-reply-link" href="#comment-428210" onclick='return addComment.moveForm( "comment-428210", "428210", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-428265">
<div class="comment-container" id="li-comment-428265">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 3, 2018 at 8:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-428265" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You could collect the prediction in an array and compare them to the expected values using tools in sklearn:<br/>
<a href="http://scikit-learn.org/stable/modules/classes.html#sklearn-metrics-metrics" rel="nofollow">http://scikit-learn.org/stable/modules/classes.html#sklearn-metrics-metrics</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-428265" onclick='return addComment.moveForm( "comment-428265", "428265", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-428234">
<div class="comment-container" id="li-comment-428234">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a91a750ca6ffa78bfef150ac88352d9d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a91a750ca6ffa78bfef150ac88352d9d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rahul</span>
<span class="date">February 2, 2018 at 9:13 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-428234" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I want to plot confusion metrics to see the distribution of data in different classes. We got the value in the range of 0-1 for every data instances by using the softmax function.<br/>
Out[30]:<br/>
array([[ 0.2284117 ,  0.03548411,  0.0659482 ,  0.63993007,  0.03022591],<br/>
       [ 0.10440681,  0.11356669,  0.09002439,  0.63514292,  0.05685928],<br/>
       [ 0.40078917,  0.11887287,  0.1319678 ,  0.30179501,  0.04657512],<br/>
       …,<br/>
       [ 0.38920838,  0.09161357,  0.10990805,  0.37070984,  0.03856021],<br/>
       [ 0.14154498,  0.53637242,  0.11574779,  0.18590394,  0.02043088],<br/>
       [ 0.17462374,  0.02110649,  0.03105714,  0.6064955 ,  0.16671705]], dtype=float32)</p>
<p>I want to the result in only 0 and 1 format as the hight value is replaced by 1 and others are 0. How can I do this? For example, the above array should be converted into<br/>
[0,0,0,1,0] and so on for different data. Please help</p>
<div class="reply">
<a aria-label="Reply to Rahul" class="comment-reply-link" href="#comment-428234" onclick='return addComment.moveForm( "comment-428234", "428234", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-428274">
<div class="comment-container" id="li-comment-428274">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 3, 2018 at 8:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-428274" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps apply the round() function?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-428274" onclick='return addComment.moveForm( "comment-428274", "428274", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-429194">
<div class="comment-container" id="li-comment-429194">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cb0be128ad075ddc8250a84e9f82ea92?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cb0be128ad075ddc8250a84e9f82ea92?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">CHIRANJEEVI</span>
<span class="date">February 12, 2018 at 6:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-429194" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>how can we predict output for new input values after validation ?</p>
<div class="reply">
<a aria-label="Reply to CHIRANJEEVI" class="comment-reply-link" href="#comment-429194" onclick='return addComment.moveForm( "comment-429194", "429194", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-429258">
<div class="comment-container" id="li-comment-429258">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 13, 2018 at 8:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-429258" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>See this post:<br/>
<a href="https://machinelearningmastery.com/train-final-machine-learning-model/" rel="nofollow">https://machinelearningmastery.com/train-final-machine-learning-model/</a></p>
<p>Once you have a final model you can call:</p>
<p>yhat = model.predict(X)</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-429258" onclick='return addComment.moveForm( "comment-429258", "429258", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-429863">
<div class="comment-container" id="li-comment-429863">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c8642c1a562a15ad74217065069800cb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c8642c1a562a15ad74217065069800cb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Meroua Daoudi</span>
<span class="date">February 19, 2018 at 12:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-429863" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi jason,</p>
<p>in my problem i have multi class and one data object can belong to multiple class at time </p>
<p>Do you know of any reference to this kind of problem</p>
<div class="reply">
<a aria-label="Reply to Meroua Daoudi" class="comment-reply-link" href="#comment-429863" onclick='return addComment.moveForm( "comment-429863", "429863", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-429901">
<div class="comment-container" id="li-comment-429901">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 19, 2018 at 9:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-429901" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is called multi-label classification:<br/>
<a href="https://en.wikipedia.org/wiki/Multi-label_classification" rel="nofollow">https://en.wikipedia.org/wiki/Multi-label_classification</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-429901" onclick='return addComment.moveForm( "comment-429901", "429901", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-430334">
<div class="comment-container" id="li-comment-430334">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c0fddbf1f5f774058d81a0a5e945a24c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c0fddbf1f5f774058d81a0a5e945a24c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://learnzone.info" rel="external nofollow">Madhav Bhattarai</a></span>
<span class="date">February 23, 2018 at 4:25 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-430334" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, as elegant as always. I am trying to solve the multiclass classification problem similar to this tutorial with the different dataset, where all my inputs are categorical. However, the accuracy of my model converges after achieving the accuracy of 57% and loss also converges after some point. My model doesn’t learn thereafter. Does this tutorial work for the dataset where all inputs are categorical? Is there some way to visualize and diagnose the issue?</p>
<div class="reply">
<a aria-label="Reply to Madhav Bhattarai" class="comment-reply-link" href="#comment-430334" onclick='return addComment.moveForm( "comment-430334", "430334", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-430394">
<div class="comment-container" id="li-comment-430394">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 24, 2018 at 9:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-430394" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This post should give you some good ideas to try:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430394" onclick='return addComment.moveForm( "comment-430394", "430394", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-430532">
<div class="comment-container" id="li-comment-430532">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c0fddbf1f5f774058d81a0a5e945a24c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c0fddbf1f5f774058d81a0a5e945a24c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://learnzone.info" rel="external nofollow">Madhav Bhattarai</a></span>
<span class="date">February 26, 2018 at 4:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-430532" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you so much.</p>
<div class="reply">
<a aria-label="Reply to Madhav Bhattarai" class="comment-reply-link" href="#comment-430532" onclick='return addComment.moveForm( "comment-430532", "430532", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-430557">
<div class="comment-container" id="li-comment-430557">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e8a2a5bf0e8f2ec8e7a0913844819673?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e8a2a5bf0e8f2ec8e7a0913844819673?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Yodish</span>
<span class="date">February 26, 2018 at 11:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-430557" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Is there a way I can print all the training epochs?</p>
<div class="reply">
<a aria-label="Reply to Yodish" class="comment-reply-link" href="#comment-430557" onclick='return addComment.moveForm( "comment-430557", "430557", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-430594">
<div class="comment-container" id="li-comment-430594">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 27, 2018 at 6:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-430594" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, you can set the verbose=1 when calling fit().</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430594" onclick='return addComment.moveForm( "comment-430594", "430594", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-430631">
<div class="comment-container" id="li-comment-430631">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cb0be128ad075ddc8250a84e9f82ea92?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cb0be128ad075ddc8250a84e9f82ea92?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ankitha</span>
<span class="date">February 27, 2018 at 4:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-430631" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>HI Jason<br/>
Is it possible to train a classifier dynamically ?<br/>
if yes how can we implement that</p>
<div class="reply">
<a aria-label="Reply to ankitha" class="comment-reply-link" href="#comment-430631" onclick='return addComment.moveForm( "comment-430631", "430631", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-430677">
<div class="comment-container" id="li-comment-430677">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 28, 2018 at 6:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-430677" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, it is called online learning where the model is updated after each pattern.</p>
<p>You can achieve this directly in Keras by setting the batch size to 1.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430677" onclick='return addComment.moveForm( "comment-430677", "430677", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-430846">
<div class="comment-container" id="li-comment-430846">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4370e2d33902ee613f23b3b9627b1aa0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4370e2d33902ee613f23b3b9627b1aa0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Varoons</span>
<span class="date">March 2, 2018 at 5:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-430846" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for these great tutorials Jason.</p>
<p>I had a question on multi label classification where the labels are one-hot encoded.</p>
<p>When predicting new data, how do you map the  one-hot encoded outputs to the actual class labels?</p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Varoons" class="comment-reply-link" href="#comment-430846" onclick='return addComment.moveForm( "comment-430846", "430846", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-430863">
<div class="comment-container" id="li-comment-430863">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 2, 2018 at 5:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-430863" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can use argmax() on the vector to get the index with the highest probability.</p>
<p>Also Keras has a predict_classes() function on the model that does the same thing.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430863" onclick='return addComment.moveForm( "comment-430863", "430863", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-431059">
<div class="comment-container" id="li-comment-431059">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1ee16e306d34cfc9ee929185bb787bba?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1ee16e306d34cfc9ee929185bb787bba?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Gledson Melotti</span>
<span class="date">March 4, 2018 at 5:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-431059" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, how are you? I really enjoyed your example over sorting using iris dataset. I have some doubts. I use anaconda with python 3.6. I installed keras. In my algorithm and I would like to assign (include) more hidden layers. How should I do it?<br/>
For example:<br/>
4 inputs -&gt; [8 hidden nodes] -&gt; [8 hidden nodes -&gt; [12 hidden nodes] -&gt; 3 outputs</p>
<p>Then you provided, as a response to a comment, a new prediction algorithm (where we split the dataset, train on 67% and make predictions on 33%). However, you included in the network model the following command: init = ‘normal’ (line 28). Why did you do this? When you’ve split the set into training and testing, you no longer use cross-validation. Could you use cross-validation together with the training and test set division?</p>
<p>Other questions: How to save the training template to use in the future with other test data? How to generate the ROC curves?</p>
<p>Thank you very much for your attention.</p>
<div class="reply">
<a aria-label="Reply to Gledson Melotti" class="comment-reply-link" href="#comment-431059" onclick='return addComment.moveForm( "comment-431059", "431059", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-431081">
<div class="comment-container" id="li-comment-431081">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 4, 2018 at 6:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-431081" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>To add new lauyers, just add lines to the code as follows:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7b89045b956869701" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
model.add(...)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7b89045b956869701-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7b89045b956869701-1"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>And replace … with the type of layer you want to add.</p>
<p>I used ‘normal’ to initialize the weights. I found it gave better skill with some trial and error.</p>
<p>Sorry, Id on’t have an example of generating roc curves for keras models.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-431081" onclick='return addComment.moveForm( "comment-431081", "431081", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-431062">
<div class="comment-container" id="li-comment-431062">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1ee16e306d34cfc9ee929185bb787bba?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1ee16e306d34cfc9ee929185bb787bba?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Gledson Melotti</span>
<span class="date">March 4, 2018 at 5:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-431062" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, how are you? I’m using python by spider-anaconda. I use your iris dataset example for sorting. However, when I use the following commands:<br/>
import matplotlib.pyplot as plt<br/>
import keras.backend as K<br/>
from keras import preprocessing<br/>
from sklearn.model_selection import cross_val_score<br/>
from sklearn.model_selection import KFold<br/>
from sklearn.pipeline import Pipeline</p>
<p>I get the following message: imported but unused.<br/>
What should I do to not receive this message?</p>
<p>Thank you very much for your attention.</p>
<div class="reply">
<a aria-label="Reply to Gledson Melotti" class="comment-reply-link" href="#comment-431062" onclick='return addComment.moveForm( "comment-431062", "431062", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-431082">
<div class="comment-container" id="li-comment-431082">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 4, 2018 at 6:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-431082" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can ignore it.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-431082" onclick='return addComment.moveForm( "comment-431082", "431082", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-431136">
<div class="comment-container" id="li-comment-431136">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8c36b9ece9a79d6b51e5e62f2a445f5c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8c36b9ece9a79d6b51e5e62f2a445f5c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mohannad Rateb</span>
<span class="date">March 5, 2018 at 12:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-431136" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>HI jason ,</p>
<p>Excellent tutorial.</p>
<p>i have a question concerning on the number of hidden nodes , on which basis do we know it’s value  .<br/>
Thanks</p>
<div class="reply">
<a aria-label="Reply to Mohannad Rateb" class="comment-reply-link" href="#comment-431136" onclick='return addComment.moveForm( "comment-431136", "431136", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-431174">
<div class="comment-container" id="li-comment-431174">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 5, 2018 at 6:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-431174" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Use experimentation to estimate the number of hidden nodes that results in a model with the best skill on your dataset.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-431174" onclick='return addComment.moveForm( "comment-431174", "431174", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-431163">
<div class="comment-container" id="li-comment-431163">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/da2f6e789db3fdb8f316bcd376fed7a5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/da2f6e789db3fdb8f316bcd376fed7a5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mo</span>
<span class="date">March 5, 2018 at 6:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-431163" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
So after building the neural network from the training data, I want to test the network with the new set of test data. How can I do that?</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7b8903c0172664408" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# import neural network libs
import numpy
import pandas
from keras.models import Sequential
from keras.layers import Dense
from keras.wrappers.scikit_learn import KerasClassifier
from keras.utils import np_utils
from sklearn.model_selection import cross_val_score
from sklearn.model_selection import KFold
from sklearn.preprocessing import LabelEncoder
from sklearn.pipeline import Pipeline
from sklearn.cross_validation import train_test_split

# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)

# load pima indians dataset
trainset = numpy.loadtxt("optdigits.tra", delimiter=",")
testset = numpy.loadtxt("optdigits.tes", delimiter=",")

# split into input (data) and output (labels) variables
data = trainset[:,0:64]
labels = trainset[:,64]

data_testset = testset[:,0:64]
labels_testset = testset[:,64]

# encode class values as integers
encoder = LabelEncoder()
encoder.fit(labels)
encoded_labels = encoder.transform(labels)
# convert integers to OneHot variables (i.e. one hot encoded)
OneHot_labels = np_utils.to_categorical(encoded_labels)

# define baseline model
def baseline_model():
    # create model
    model = Sequential()
    model.add(Dense(36, input_dim=64, init="uniform", activation='relu'))
    model.add(Dense(10, activation='softmax'))
    
    # Compile model
    model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])
    return model

# Fit the model
estimator = KerasClassifier(build_fn=baseline_model, nb_epoch=200, batch_size=10, verbose=0)

# evaluate the model using kFold cross validation with 20% of the data for testing and 80% for training
kfold = KFold(n_splits=5, shuffle=True, random_state=seed)
results = cross_val_score(estimator, data, OneHot_labels, cv=kfold)
print("\nOverall Validation accuracy: %.2f%% (%.2f%%)" % (results.mean()*100, results.std()*100))


# build the neural network from all the training set
estimator.fit(data, labels)
predictions = estimator.predict(data_testset)
print("\nPredeiction: \n" , predictions)
print("\nThe actual labels of the test set:\n" , labels_testset)

# build the confusion matrix after classifing the test data
from sklearn.metrics import confusion_matrix
cm = confusion_matrix(labels_testset, predictions)
print ("\nThe confusion matrix when apply the test set on the trained nerual network:\n" , cm)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-6">6</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-8">8</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-10">10</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-12">12</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-14">14</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-16">16</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-18">18</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-20">20</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-22">22</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-24">24</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-26">26</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-28">28</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-30">30</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-32">32</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-34">34</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-36">36</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-38">38</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-40">40</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-42">42</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-44">44</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-46">46</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-48">48</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-50">50</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-52">52</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-54">54</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-56">56</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-58">58</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-60">60</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-62">62</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8903c0172664408-64">64</div><div class="crayon-num" data-line="crayon-5c0ca7b8903c0172664408-65">65</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-1"><span class="crayon-p"># import neural network libs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-3"><span class="crayon-e">import </span><span class="crayon-e">pandas</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">wrappers</span><span class="crayon-sy">.</span><span class="crayon-e">scikit_learn </span><span class="crayon-e">import </span><span class="crayon-e">KerasClassifier</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">utils </span><span class="crayon-e">import </span><span class="crayon-e">np_utils</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-8"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">cross_val_score</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-9"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">KFold</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-10"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">LabelEncoder</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-11"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">pipeline </span><span class="crayon-e">import </span><span class="crayon-e">Pipeline</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-12"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">cross_validation </span><span class="crayon-e">import </span><span class="crayon-v">train_test_split</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-13"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-14"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-15"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-16"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-17"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-18"><span class="crayon-p"># load pima indians dataset</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-19"><span class="crayon-v">trainset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">"optdigits.tra"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">","</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-20"><span class="crayon-v">testset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">"optdigits.tes"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">","</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-21"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-22"><span class="crayon-p"># split into input (data) and output (labels) variables</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-23"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">64</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-24"><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">64</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-25"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-26"><span class="crayon-v">data_testset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">64</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-27"><span class="crayon-v">labels_testset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">64</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-28"> </div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-29"><span class="crayon-p"># encode class values as integers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-30"><span class="crayon-v">encoder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LabelEncoder</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-31"><span class="crayon-v">encoder</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-32"><span class="crayon-v">encoded_labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">encoder</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-33"><span class="crayon-p"># convert integers to OneHot variables (i.e. one hot encoded)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-34"><span class="crayon-v">OneHot_labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np_utils</span><span class="crayon-sy">.</span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_labels</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-35"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-36"><span class="crayon-p"># define baseline model</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-37"><span class="crayon-e">def </span><span class="crayon-e">baseline_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-38"><span class="crayon-h">    </span><span class="crayon-p"># create model</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-39"><span class="crayon-h">    </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-40"><span class="crayon-h">    </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">36</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">init</span><span class="crayon-o">=</span><span class="crayon-s">"uniform"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-41"><span class="crayon-h">    </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-42"><span class="crayon-h">    </span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-43"><span class="crayon-h">    </span><span class="crayon-p"># Compile model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-44"><span class="crayon-h">    </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-45"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-46"> </div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-47"><span class="crayon-p"># Fit the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-48"><span class="crayon-v">estimator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">baseline_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">nb_epoch</span><span class="crayon-o">=</span><span class="crayon-cn">200</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-49"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-50"><span class="crayon-p"># evaluate the model using kFold cross validation with 20% of the data for testing and 80% for training</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-51"><span class="crayon-v">kfold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KFold</span><span class="crayon-sy">(</span><span class="crayon-v">n_splits</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-52"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_val_score</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">OneHot_labels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-o">=</span><span class="crayon-v">kfold</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-53"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"\nOverall Validation accuracy: %.2f%% (%.2f%%)"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-54"> </div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-55"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-56"><span class="crayon-p"># build the neural network from all the training set</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-57"><span class="crayon-v">estimator</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-58"><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">estimator</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">data_testset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-59"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"\nPredeiction: \n"</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-60"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"\nThe actual labels of the test set:\n"</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels_testset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-61"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-62"><span class="crayon-p"># build the confusion matrix after classifing the test data</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-63"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-e">confusion_matrix</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8903c0172664408-64"><span class="crayon-v">cm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">confusion_matrix</span><span class="crayon-sy">(</span><span class="crayon-v">labels_testset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b8903c0172664408-65"><span class="crayon-e">print</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"\nThe confusion matrix when apply the test set on the trained nerual network:\n"</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cm</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0028 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to Mo" class="comment-reply-link" href="#comment-431163" onclick='return addComment.moveForm( "comment-431163", "431163", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-431176">
<div class="comment-container" id="li-comment-431176">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 5, 2018 at 6:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-431176" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You must fit a final model.</p>
<p>This post will make the concept clear:<br/>
<a href="https://machinelearningmastery.com/train-final-machine-learning-model/" rel="nofollow">https://machinelearningmastery.com/train-final-machine-learning-model/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-431176" onclick='return addComment.moveForm( "comment-431176", "431176", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-432822">
<div class="comment-container" id="li-comment-432822">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/faf61cfad598a96034524e8ae45cc0e9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/faf61cfad598a96034524e8ae45cc0e9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://www.linkedin.com/in/kashyapraiyani/" rel="external nofollow">Kashyap Raiyani</a></span>
<span class="date">March 21, 2018 at 9:24 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-432822" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>I did undergo the page and all the posts. I am having trouble with encoding label list. Please find the details as follows:</p>
<p>Problem:<br/>
Input data set file contain 3 columns in the following format unique_id,text,aggression-level</p>
<p>The columns are separated by the comma and follow a minimal quoting pattern (such that only those columns are quoted which are in multiple lines or contain quotes in the text).</p>
<p>column 1: unique_id facebook id<br/>
column 2: post/text<br/>
column 3: aggression-level: OAG, CAG, and NAG</p>
<p>There are 12000 records</p>
<p>Code as follows:</p>
<p>texts = []  # list of text samples<br/>
labels = []  # list of label ids<br/>
csvfile = pd.read_csv(‘agr_en_train.csv’,names=[‘id’, ‘post’, ‘label’])<br/>
texts = csvfile[‘post’]<br/>
labels = csvfile[‘label’]<br/>
print(‘Found %s texts.’ % len(texts))</p>
<p>#label_encoding<br/>
encoder = LabelEncoder()<br/>
encoder.fit(labels)<br/>
encoded_Y = encoder.transform(labels)<br/>
dummy_y = np_utils.to_categorical(encoded_Y)<br/>
print(‘Shape of label tensor:’, dummy_y.shape)</p>
<p>After Training model:</p>
<p>model.compile(loss=’categorical_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])<br/>
reduce_lr = ReduceLROnPlateau(monitor=’val_loss’, factor=0.5, patience=2, min_lr=0.000001)<br/>
print(model.summary())<br/>
model.fit(x_train, y_train, batch_size=256, epochs=25,validation_data=(x_val, y_val), shuffle=True, callbacks=[reduce_lr])</p>
<p>Below lines are giving Eorros:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca7b8902d9029137668" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
predict = model.predict(x_val)
print(encoder.inverse_transform(predict))

Traceback (most recent call last):
  File "aggression_analysis_on_facebookv2.py", line 161, in 
    print(encoder.inverse_transform(predict))
  File "/usr/local/lib/python2.7/dist-packages/sklearn/preprocessing/label.py", line 151, in inverse_transform
    if diff:
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca7b8902d9029137668-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8902d9029137668-2">2</div><div class="crayon-num" data-line="crayon-5c0ca7b8902d9029137668-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8902d9029137668-4">4</div><div class="crayon-num" data-line="crayon-5c0ca7b8902d9029137668-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8902d9029137668-6">6</div><div class="crayon-num" data-line="crayon-5c0ca7b8902d9029137668-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca7b8902d9029137668-8">8</div><div class="crayon-num" data-line="crayon-5c0ca7b8902d9029137668-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca7b8902d9029137668-1"><span class="crayon-v">predict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">x_val</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8902d9029137668-2"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">encoder</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">predict</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b8902d9029137668-3"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8902d9029137668-4"><span class="crayon-e">Traceback</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">most </span><span class="crayon-e">recent </span><span class="crayon-e">call </span><span class="crayon-v">last</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7b8902d9029137668-5"><span class="crayon-h">  </span><span class="crayon-i">File</span><span class="crayon-h"> </span><span class="crayon-s">"aggression_analysis_on_facebookv2.py"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">line</span><span class="crayon-h"> </span><span class="crayon-cn">161</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8902d9029137668-6"><span class="crayon-h">    </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">encoder</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">predict</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca7b8902d9029137668-7"><span class="crayon-h">  </span><span class="crayon-i">File</span><span class="crayon-h"> </span><span class="crayon-s">"/usr/local/lib/python2.7/dist-packages/sklearn/preprocessing/label.py"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">line</span><span class="crayon-h"> </span><span class="crayon-cn">151</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">inverse_transform</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca7b8902d9029137668-8"><span class="crayon-e">    </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca7b8902d9029137668-9"><span class="crayon-v">ValueError</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">The </span><span class="crayon-e">truth </span><span class="crayon-e">value </span><span class="crayon-e">of </span><span class="crayon-e">an </span><span class="crayon-t">array</span><span class="crayon-h"> </span><span class="crayon-e">with </span><span class="crayon-e">more </span><span class="crayon-e">than </span><span class="crayon-e">one </span><span class="crayon-e">element </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-v">ambiguous</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-st">Use</span><span class="crayon-h"> </span><span class="crayon-v">a</span><span class="crayon-sy">.</span><span class="crayon-e">any</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-v">a</span><span class="crayon-sy">.</span><span class="crayon-e">all</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0010 seconds] -->
<p></p>
<p>I am getting the predictions in np array but I am not able to convert back to the 3 classes (OAG, CAG, NAG) for test data.</p>
<p>Can you please have look at it? </p>
<p>Many thanks in advance.</p>
<div class="reply">
<a aria-label="Reply to Kashyap Raiyani" class="comment-reply-link" href="#comment-432822" onclick='return addComment.moveForm( "comment-432822", "432822", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-434200">
<div class="comment-container" id="li-comment-434200">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/41b9d0343fb01b52c97dbbecc55a1ae3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/41b9d0343fb01b52c97dbbecc55a1ae3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Esteban Vargas</span>
<span class="date">April 5, 2018 at 12:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-434200" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason this tutorial is just amazing! Thank you so much. </p>
<p>I want to ask you, how can this model be adapted for variables that measure different things? For example mixing lenghts, weights, etc.</p>
<div class="reply">
<a aria-label="Reply to Esteban Vargas" class="comment-reply-link" href="#comment-434200" onclick='return addComment.moveForm( "comment-434200", "434200", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-434217">
<div class="comment-container" id="li-comment-434217">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 5, 2018 at 3:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-434217" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<p>Provide all the variables to the model, but rescale all variables to the range 0-1 prior to modeling.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-434217" onclick='return addComment.moveForm( "comment-434217", "434217", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-434365">
<div class="comment-container" id="li-comment-434365">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4bfa68c086c0252395078b8e563f487c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4bfa68c086c0252395078b8e563f487c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Stuart Black</span>
<span class="date">April 7, 2018 at 6:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-434365" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>Thanks for the really helpful tutorial! </p>
<p>Can you recommend a good way to normalise the data prior to feeding it into the model? Half of my columns have data values in the thousands and others have values no greater than 10.</p>
<p>Thanks </p>
<p>S</p>
<div class="reply">
<a aria-label="Reply to Stuart Black" class="comment-reply-link" href="#comment-434365" onclick='return addComment.moveForm( "comment-434365", "434365", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-434376">
<div class="comment-container" id="li-comment-434376">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 7, 2018 at 6:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-434376" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, use the sklearn MinMaxScaler. I have many tutorials on the topic:<br/>
<a href="https://machinelearningmastery.com/?s=MinMaxScaler&amp;submit=Search" rel="nofollow">https://machinelearningmastery.com/?s=MinMaxScaler&amp;submit=Search</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-434376" onclick='return addComment.moveForm( "comment-434376", "434376", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-435412">
<div class="comment-container" id="li-comment-435412">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/efe8cb9dda59a8cecb437f8f86304dc2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/efe8cb9dda59a8cecb437f8f86304dc2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nikunj</span>
<span class="date">April 19, 2018 at 8:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-435412" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason! Thanks for the tutorial!<br/>
However I’m facing this problem – </p>
<p>Here is the code:</p>
<p>def baseline_model():<br/>
	model = Sequential()<br/>
	model.add(Dense(256, input_dim=90, activation=’relu’))<br/>
	model.add(Dense(9, activation=’softmax’))<br/>
	# learning rate is specified<br/>
	keras.optimizers.Adam(lr=0.001)<br/>
	model.compile(loss=’categorical_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])<br/>
	return model</p>
<p>estimator = KerasClassifier(build_fn=baseline_model, epochs=50, batch_size=500, verbose=1)<br/>
estimator.fit(X, dummy_y)</p>
<p>Now, the output is :</p>
<p>150000/150000 [==============================] – 2s 12us/step – loss: 11.4893 – acc: 0.2870<br/>
Epoch 2/50<br/>
150000/150000 [==============================] – 2s 11us/step – loss: 11.4329 – acc: 0.2907<br/>
Epoch 3/50<br/>
150000/150000 [==============================] – 2s 10us/step – loss: 11.4329 – acc: 0.2907<br/>
Epoch 4/50<br/>
150000/150000 [==============================] – 2s 11us/step – loss: 11.4329 – acc: 0.2907<br/>
Epoch 5/50<br/>
150000/150000 [==============================] – 2s 11us/step – loss: 11.4329 – acc: 0.2907<br/>
Epoch 6/50<br/>
150000/150000 [==============================] – 2s 11us/step – loss: 11.4329 – acc: 0.2907<br/>
………………..<br/>
……………….</p>
<p>The loss and acc remain the same for the remaining epochs.<br/>
The no. of layers and activation type are specified.<br/>
Why is the loss remaining constant?</p>
<div class="reply">
<a aria-label="Reply to Nikunj" class="comment-reply-link" href="#comment-435412" onclick='return addComment.moveForm( "comment-435412", "435412", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-435430">
<div class="comment-container" id="li-comment-435430">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 19, 2018 at 2:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-435430" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You may need to tune the model for your problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435430" onclick='return addComment.moveForm( "comment-435430", "435430", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-435472">
<div class="comment-container" id="li-comment-435472">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/efe8cb9dda59a8cecb437f8f86304dc2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/efe8cb9dda59a8cecb437f8f86304dc2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nikunj</span>
<span class="date">April 20, 2018 at 5:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-435472" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How can I do that Jason?</p>
<div class="reply">
<a aria-label="Reply to Nikunj" class="comment-reply-link" href="#comment-435472" onclick='return addComment.moveForm( "comment-435472", "435472", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-435489">
<div class="comment-container" id="li-comment-435489">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 20, 2018 at 6:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-435489" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I provide a long list of ideas here:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435489" onclick='return addComment.moveForm( "comment-435489", "435489", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-437067">
<div class="comment-container" id="li-comment-437067">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4a289f90a728511487af5d876291920c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4a289f90a728511487af5d876291920c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">anand</span>
<span class="date">May 10, 2018 at 3:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-437067" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi jason thanks for this tutorial</p>
<p> when iam trying this tutorial iam getting an error message of</p>
<p>Using TensorFlow backend.<br/>
Traceback (most recent call last):<br/>
  File “C:\Users\hp\AppData\Local\Programs\Python\Python36\keras example1.py”, line 29, in<br/>
    model = KerasClassifier(built_fn = baseline_model,epochs=200, batch_size=5,verbose=0)<br/>
  File “C:\Users\hp\AppData\Local\Programs\Python\Python36\lib\site-packages\keras\wrappers\scikit_learn.py”, line 61, in __init__<br/>
    self.check_params(sk_params)<br/>
  File “C:\Users\hp\AppData\Local\Programs\Python\Python36\lib\site-packages\keras\wrappers\scikit_learn.py”, line 75, in check_params<br/>
    legal_params_fns.append(self.__call__)<br/>
AttributeError: ‘KerasClassifier’ object has no attribute ‘__call__’</p>
<p>and second what if i use numpy to load the dataset. “numpy.loadtxt(x.csv)”<br/>
and how to encode the labels</p>
<div class="reply">
<a aria-label="Reply to anand" class="comment-reply-link" href="#comment-437067" onclick='return addComment.moveForm( "comment-437067", "437067", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-437092">
<div class="comment-container" id="li-comment-437092">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 10, 2018 at 6:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-437092" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m sorry to hear that, here are some ideas:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437092" onclick='return addComment.moveForm( "comment-437092", "437092", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-437517">
<div class="comment-container" id="li-comment-437517">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/212c00207ddebb7586bfd293663b9ba9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/212c00207ddebb7586bfd293663b9ba9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Voodoomonkey</span>
<span class="date">May 15, 2018 at 4:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-437517" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, Jason.<br/>
Been looking through some of your topics on deep learning with python.<br/>
They are very useful and give us a lot of information about using python with NN.<br/>
Thank you! </p>
<p>I’ve been trying to create a multi class classifier using your example but i can’t get it to work properly. </p>
<p>You see, i have approximately 20-80 classes and using your example i only get a really small accuracy rate. </p>
<p>My code looks like this (basically your code ) : </p>
<p>seed = 7<br/>
numpy.random.seed(seed)<br/>
# load dataset<br/>
dataframe = pandas.read_csv(“csv1.csv”, header=None)<br/>
dataset = dataframe.values<br/>
X = dataset[:,0:8]<br/>
Y = dataset[:,8:9]<br/>
print(X.shape)<br/>
print(Y.shape)<br/>
encoder = LabelEncoder()<br/>
encoder.fit(Y)<br/>
encoded_Y = encoder.transform(Y)<br/>
# convert integers to dummy variables (i.e. one hot encoded)<br/>
dummy_y = np_utils.to_categorical(encoded_Y)<br/>
# define baseline model<br/>
def baseline_model():<br/>
	# create model<br/>
	model = Sequential()<br/>
	model.add(Dense(8, input_dim=8, activation=’relu’))<br/>
	model.add(Dense(56, activation=’softmax’))<br/>
	# Compile model<br/>
	model.compile(loss=’categorical_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])<br/>
	return model<br/>
estimator = KerasClassifier(build_fn=baseline_model, epochs=200, batch_size=5, verbose=0)<br/>
kfold = KFold(n_splits=10, shuffle=True, random_state=seed)<br/>
results = cross_val_score(estimator, X, dummy_y, cv=kfold)<br/>
print(“Baseline: %.2f%% (%.2f%%)” % (results.mean()*100, results.std()*100))</p>
<p>and my csv is :<br/>
<a href="https://drive.google.com/open?id=1KmTpLHHd8apXrqOK8UcJfr3MbqWMe9ok" rel="nofollow">https://drive.google.com/open?id=1KmTpLHHd8apXrqOK8UcJfr3MbqWMe9ok</a></p>
<p>Looking forward for your answer. This is very important for me and my future.</p>
<div class="reply">
<a aria-label="Reply to Voodoomonkey" class="comment-reply-link" href="#comment-437517" onclick='return addComment.moveForm( "comment-437517", "437517", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-437539">
<div class="comment-container" id="li-comment-437539">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 15, 2018 at 8:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-437539" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I cannot review your code, what problem are you having exactly?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437539" onclick='return addComment.moveForm( "comment-437539", "437539", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-437599">
<div class="comment-container" id="li-comment-437599">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/212c00207ddebb7586bfd293663b9ba9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/212c00207ddebb7586bfd293663b9ba9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Voodoomonkey</span>
<span class="date">May 15, 2018 at 11:39 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-437599" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Would it be easier to review like this ?<br/>
<a href="https://pastebin.com/hYa2cpmW" rel="nofollow">https://pastebin.com/hYa2cpmW</a></p>
<p>The problem i’m having is that using the code you provided with my dataset i get<br/>
Baseline: 4.00% (6.63%)<br/>
Which is really low, and i don’t see any ways to fix that.<br/>
I’m trying to train it on 100 rows of data with 38 classes.</p>
<p>If i try to use it with more data, the baseline drops even more. </p>
<p>Is there a way to increase the percentage ? Maybe i’m doing something wrong ?<br/>
It always come’s down to – every example you provide works, but when i try my own data – it doesn’t work. </p>
<p>Can you please take a look at code and data, maybe ?</p>
<div class="reply">
<a aria-label="Reply to Voodoomonkey" class="comment-reply-link" href="#comment-437599" onclick='return addComment.moveForm( "comment-437599", "437599", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-437632">
<div class="comment-container" id="li-comment-437632">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 16, 2018 at 6:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-437632" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Here are some suggestions to lift model skill:<br/>
<a href="http://machinelearningmastery.com/machine-learning-performance-improvement-cheat-sheet/" rel="nofollow">http://machinelearningmastery.com/machine-learning-performance-improvement-cheat-sheet/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437632" onclick='return addComment.moveForm( "comment-437632", "437632", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-437912">
<div class="comment-container" id="li-comment-437912">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8e9827e82989efff8064e65b8b328a8a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8e9827e82989efff8064e65b8b328a8a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shyam</span>
<span class="date">May 19, 2018 at 4:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-437912" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am running the code with the dependencies installed, but I am receiving this as an output.</p>
<p>C:\Users\shyam\Anaconda3\envs\tensorflow\lib\site-packages\h5py\__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from <code>float</code> to <code>np.floating</code> is deprecated. In future, it will be treated as <code>np.float64 == np.dtype(float).type</code>.<br/>
  from ._conv import register_converters as _register_converters<br/>
Using TensorFlow backend.</p>
<p>Shouldn’t it be printing more than just “using TensorFlow backend”? Any help would be greatly appreciated</p>
<div class="reply">
<a aria-label="Reply to Shyam" class="comment-reply-link" href="#comment-437912" onclick='return addComment.moveForm( "comment-437912", "437912", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-437934">
<div class="comment-container" id="li-comment-437934">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 19, 2018 at 7:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-437934" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can ignore this warning.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437934" onclick='return addComment.moveForm( "comment-437934", "437934", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-438185">
<div class="comment-container" id="li-comment-438185">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1bba64cd3890e29f89bd37efb57a8ccb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1bba64cd3890e29f89bd37efb57a8ccb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chrisa</span>
<span class="date">May 22, 2018 at 4:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-438185" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello and thanks for this excellent tutorial.</p>
<p>I have a dataset with 150 attributes per entry. If an attribute is unknown for an entry, then in the csv file it is represented with a “?”. I suppose this will be a problem in the training phase. Can you suggest a way to handle his?</p>
<div class="reply">
<a aria-label="Reply to Chrisa" class="comment-reply-link" href="#comment-438185" onclick='return addComment.moveForm( "comment-438185", "438185", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-438205">
<div class="comment-container" id="li-comment-438205">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 22, 2018 at 6:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-438205" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is a common question that I answer here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-handle-missing-data" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-handle-missing-data</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-438205" onclick='return addComment.moveForm( "comment-438205", "438205", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-438209">
<div class="comment-container" id="li-comment-438209">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1bba64cd3890e29f89bd37efb57a8ccb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1bba64cd3890e29f89bd37efb57a8ccb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chrisa</span>
<span class="date">May 22, 2018 at 7:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-438209" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you very much</p>
<div class="reply">
<a aria-label="Reply to Chrisa" class="comment-reply-link" href="#comment-438209" onclick='return addComment.moveForm( "comment-438209", "438209", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-442097">
<div class="comment-container" id="li-comment-442097">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1bba64cd3890e29f89bd37efb57a8ccb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1bba64cd3890e29f89bd37efb57a8ccb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chrisa</span>
<span class="date">June 26, 2018 at 8:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-442097" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello again. I finally narowed down which of the 150 attributes I need to use, but now there is another problem. The attributes I need are in specific columns and of different datatype. I tried working with numpy.loadtxt and numpy.genfromtxt but the format of the resulting arrays is not the right one. I get the mistake:<br/>
 ValueError: Error when checking input: expected dense_1_input to have shape (5,) but got array with shape (1,)<br/>
where 5 are the attributes I m using<br/>
Can you help me?</p>
<div class="reply">
<a aria-label="Reply to Chrisa" class="comment-reply-link" href="#comment-442097" onclick='return addComment.moveForm( "comment-442097", "442097", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-442104">
<div class="comment-container" id="li-comment-442104">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1bba64cd3890e29f89bd37efb57a8ccb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1bba64cd3890e29f89bd37efb57a8ccb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chrisa</span>
<span class="date">June 26, 2018 at 11:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-442104" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I figured it out using:<br/>
dataframe = pandas.read_csv(“IrisDataset.csv”, header=None, usecols = [0,1,2,3,5], dtype ={0:np.float32, 1:np.float32, 2:np.float32, 3:np.float32, 5: np.str })<br/>
where the fifth column is one I added in order to check the string attributes.<br/>
Now there is problem of how can I have strings as input for the neural</p>
<div class="reply">
<a aria-label="Reply to Chrisa" class="comment-reply-link" href="#comment-442104" onclick='return addComment.moveForm( "comment-442104", "442104", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-442137">
<div class="comment-container" id="li-comment-442137">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 27, 2018 at 8:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-442137" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Strings must be encoded, see this:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/how-to-handle-categorical-data-with-string-values" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-to-handle-categorical-data-with-string-values</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442137" onclick='return addComment.moveForm( "comment-442137", "442137", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-442135">
<div class="comment-container" id="li-comment-442135">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 27, 2018 at 8:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-442135" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps this post will help you load your data:<br/>
<a href="http://machinelearningmastery.com/load-machine-learning-data-python/" rel="nofollow">http://machinelearningmastery.com/load-machine-learning-data-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442135" onclick='return addComment.moveForm( "comment-442135", "442135", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-442496">
<div class="comment-container" id="li-comment-442496">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0e0fe9951df99225b76427e469a897f6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0e0fe9951df99225b76427e469a897f6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kushagra</span>
<span class="date">July 2, 2018 at 12:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-442496" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason!<br/>
Thank you for such awesome posts. Do you have tutorials or recommendations for classifying raw time series data using RNN GRU or LSTM?</p>
<div class="reply">
<a aria-label="Reply to Kushagra" class="comment-reply-link" href="#comment-442496" onclick='return addComment.moveForm( "comment-442496", "442496", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-442501">
<div class="comment-container" id="li-comment-442501">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 2, 2018 at 2:59 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-442501" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>1D CNNs are very effective for time series classification in my experience.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442501" onclick='return addComment.moveForm( "comment-442501", "442501", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-443021">
<div class="comment-container" id="li-comment-443021">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1bd78d39fef126e2e59512d1cbeea812?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1bd78d39fef126e2e59512d1cbeea812?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sanjeev Ranjan</span>
<span class="date">July 9, 2018 at 3:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-443021" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Please help:<br/>
Error when checking target: expected dense_6 to have shape (10,) but got array with shape (1,)</p>
<p>I have to do a multi-class classification to predict value ranging between 1 to 5<br/>
there are total of 46 columns. All columns have numerical values only.</p>
<p>model = Sequential()<br/>
model.add(Dense(64, activation=’relu’, input_dim=46)) #there are 46 feature in my dataset to be trained<br/>
model.add(Dropout(0.5))<br/>
model.add(Dense(64, activation=’relu’))<br/>
model.add(Dropout(0.5))<br/>
model.add(Dense(10, activation=’softmax’))</p>
<p>model.compile(optimizer=’rmsprop’, loss=’categorical_crossentropy’, metrics=[‘accuracy’])</p>
<p>model.fit(X_train, Y_train, epochs=20, batch_size=128)</p>
<p>I got error in last line.</p>
<div class="reply">
<a aria-label="Reply to Sanjeev Ranjan" class="comment-reply-link" href="#comment-443021" onclick='return addComment.moveForm( "comment-443021", "443021", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-443074">
<div class="comment-container" id="li-comment-443074">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 10, 2018 at 6:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-443074" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This might help:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443074" onclick='return addComment.moveForm( "comment-443074", "443074", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-443111">
<div class="comment-container" id="li-comment-443111">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1bba64cd3890e29f89bd37efb57a8ccb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1bba64cd3890e29f89bd37efb57a8ccb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chrisa</span>
<span class="date">July 10, 2018 at 11:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-443111" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I tried adding this block of code in the end in order to test the model on new data,</p>
<p>estimator.fit(X, dummy_y)<br/>
predictions=estimator.predict(X)<br/>
correct=0</p>
<p>for i in range(np.size(X,0)):<br/>
	if predictions[i].argmax()==dummy_y[i].argmax():<br/>
		print (“%d well predicted\n” %i)<br/>
		correct+=1<br/>
print (“Correct predicted: %d” %correct)		</p>
<p>In fact, there is no new data. The test array X is the same as the training one, so I expected a very big number of corrects.. However the corrects are 50. After printing the predictions, I realized that all indexes are predicted as “Iris-setosa” which is the first label, so the rate is approximately 33.3%. Am I doing something wrong?</p>
<div class="reply">
<a aria-label="Reply to Chrisa" class="comment-reply-link" href="#comment-443111" onclick='return addComment.moveForm( "comment-443111", "443111", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-443122">
<div class="comment-container" id="li-comment-443122">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 10, 2018 at 2:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-443122" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I explain how to make predictions on new data here:<br/>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" rel="nofollow">https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443122" onclick='return addComment.moveForm( "comment-443122", "443122", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-443159">
<div class="comment-container" id="li-comment-443159">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4262bda93aa56dc0ccc3f9e9ad0e6c10?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4262bda93aa56dc0ccc3f9e9ad0e6c10?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex</span>
<span class="date">July 11, 2018 at 1:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-443159" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the awesome tutorial</p>
<p>One question, now that I have the model, how can I predict new data.</p>
<p>Imagine I have now this scenario</p>
<p>1. flowers.csv with 4 rows of collected data (without the labels)</p>
<p>Now I want to feed the csv to the model to have the predictions for every data</p>
<div class="reply">
<a aria-label="Reply to Alex" class="comment-reply-link" href="#comment-443159" onclick='return addComment.moveForm( "comment-443159", "443159", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-443181">
<div class="comment-container" id="li-comment-443181">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 11, 2018 at 5:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-443181" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This post explains more on how to make predictions:<br/>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" rel="nofollow">https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443181" onclick='return addComment.moveForm( "comment-443181", "443181", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-443160">
<div class="comment-container" id="li-comment-443160">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4262bda93aa56dc0ccc3f9e9ad0e6c10?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4262bda93aa56dc0ccc3f9e9ad0e6c10?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex</span>
<span class="date">July 11, 2018 at 1:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-443160" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I tried this for predictions<br/>
# load dataset<br/>
dataframe2 = pandas.read_csv(“flowers-pred.csv”, header=None)<br/>
dataset2 = dataframe.values<br/>
# new instance where we do not know the answer<br/>
Xnew = dataset2[:,0:4].astype(float)<br/>
# make a prediction<br/>
ynew = model.predict_classes(Xnew)<br/>
# show the inputs and predicted outputs<br/>
print(“X=%s, Predicted=%s” % (Xnew[0], ynew[0]))</p>
<p>And I get the result<br/>
X=[4.6 3.1 1.5 0.2], Predicted=1</p>
<p>Sometimes the values of X does not correspond to the real values of the file and always the prediction is 1.</p>
<p>Because is one hot encoding I supouse the prediccion should be 0 0 1 or 1 0 0 or 0 1 0</p>
<div class="reply">
<a aria-label="Reply to Alex" class="comment-reply-link" href="#comment-443160" onclick='return addComment.moveForm( "comment-443160", "443160", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-443182">
<div class="comment-container" id="li-comment-443182">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 11, 2018 at 6:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-443182" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>All models have error. You can try improving the performance of the model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443182" onclick='return addComment.moveForm( "comment-443182", "443182", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-443161">
<div class="comment-container" id="li-comment-443161">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4262bda93aa56dc0ccc3f9e9ad0e6c10?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4262bda93aa56dc0ccc3f9e9ad0e6c10?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex</span>
<span class="date">July 11, 2018 at 1:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-443161" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I found what I was doing wrong,</p>
<p>estimator = KerasClassifier(build_fn=baseline_model, epochs=200, batch_size=5, verbose=0)<br/>
kfold = KFold(n_splits=10, shuffle=True, random_state=seed)</p>
<p>results = cross_val_score(estimator, X, dummy_y, cv=kfold)<br/>
print(“Baseline: %.2f%% (%.2f%%)” % (results.mean()*100, results.std()*100))</p>
<p>model = baseline_model()</p>
<p># load dataset<br/>
dataframe2 = pandas.read_csv(“flores-pred.csv”, header=None)<br/>
dataset2 = dataframe.values<br/>
# new instance where we do not know the answer<br/>
Xnew = dataset2[:,0:4].astype(float)<br/>
# make a prediction<br/>
ynew = model.predict(Xnew)<br/>
# show the inputs and predicted outputs<br/>
print(“X=%s, Predicted=%s” % (Xnew[2], ynew[2]))</p>
<p>Now this works, but all the predictions are almost the same<br/>
X=[4.7 3.2 1.3 0.2], Predicted=[0.13254479 0.7711002  0.09635501]</p>
<p>NO matter wich flower is in the row, I always gets 0 1 0</p>
<div class="reply">
<a aria-label="Reply to Alex" class="comment-reply-link" href="#comment-443161" onclick='return addComment.moveForm( "comment-443161", "443161", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-443183">
<div class="comment-container" id="li-comment-443183">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 11, 2018 at 6:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-443183" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps there’s a bug in the way you are making predictions?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443183" onclick='return addComment.moveForm( "comment-443183", "443183", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-444076">
<div class="comment-container" id="li-comment-444076">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5053034161bdf2bc9a387f0872c23a83?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5053034161bdf2bc9a387f0872c23a83?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ansh</span>
<span class="date">July 22, 2018 at 12:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-444076" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I was just wondering. rather than one hot encoding 3 categories as shown below.</p>
<p>Iris-setosa,	Iris-versicolor,	Iris-virginica<br/>
1,		0,			0<br/>
0,		1, 			0<br/>
0, 		0, 			1</p>
<p>Can’t we change  the three  categories.<br/>
                       Y          Y1<br/>
Iris-setosa       0           0<br/>
Iris-versicolor   0           1<br/>
Iris-virginica      1           0</p>
<p>and if we could what will be the core difference in training the models using the above two mentioned ways.</p>
<div class="reply">
<a aria-label="Reply to Ansh" class="comment-reply-link" href="#comment-444076" onclick='return addComment.moveForm( "comment-444076", "444076", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-444097">
<div class="comment-container" id="li-comment-444097">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 22, 2018 at 6:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-444097" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t follow, what would a model predict?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444097" onclick='return addComment.moveForm( "comment-444097", "444097", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-444303">
<div class="comment-container" id="li-comment-444303">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e63114d8e779c90cd19e7b1c7c7425be?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e63114d8e779c90cd19e7b1c7c7425be?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://erfelipe.com.br" rel="external nofollow">Felipe</a></span>
<span class="date">July 25, 2018 at 12:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-444303" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, great tutorial, thanks.<br/>
Do you know some path to use ontology (OWL or RDF) like input data to improve a best analise?</p>
<div class="reply">
<a aria-label="Reply to Felipe" class="comment-reply-link" href="#comment-444303" onclick='return addComment.moveForm( "comment-444303", "444303", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-444341">
<div class="comment-container" id="li-comment-444341">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 25, 2018 at 6:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-444341" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t sorry.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444341" onclick='return addComment.moveForm( "comment-444341", "444341", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-445675">
<div class="comment-container" id="li-comment-445675">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/48dbfb700ec2e7ac1658d54a895adcd1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/48dbfb700ec2e7ac1658d54a895adcd1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shooter</span>
<span class="date">August 9, 2018 at 7:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-445675" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, what if X data contains numbers as well as multiple classes? </p>
<p>Thanks in advance.</p>
<div class="reply">
<a aria-label="Reply to Shooter" class="comment-reply-link" href="#comment-445675" onclick='return addComment.moveForm( "comment-445675", "445675", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-445714">
<div class="comment-container" id="li-comment-445714">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 10, 2018 at 6:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-445714" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>X is the input only, y contains the output or the classes.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-445714" onclick='return addComment.moveForm( "comment-445714", "445714", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-445760">
<div class="comment-container" id="li-comment-445760">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/48dbfb700ec2e7ac1658d54a895adcd1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/48dbfb700ec2e7ac1658d54a895adcd1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shooter</span>
<span class="date">August 10, 2018 at 3:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-445760" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I mean what if X contains multiple labels like “High and Low”? We need to use one hot encoding on that X data too and continue other steps in the same way?</p>
<div class="reply">
<a aria-label="Reply to Shooter" class="comment-reply-link" href="#comment-445760" onclick='return addComment.moveForm( "comment-445760", "445760", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-445806">
<div class="comment-container" id="li-comment-445806">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 11, 2018 at 6:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-445806" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If you are working with categorical inputs, you will need to encode them in some way.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-445806" onclick='return addComment.moveForm( "comment-445806", "445806", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-445771">
<div class="comment-container" id="li-comment-445771">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/48dbfb700ec2e7ac1658d54a895adcd1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/48dbfb700ec2e7ac1658d54a895adcd1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shooter</span>
<span class="date">August 10, 2018 at 7:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-445771" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi jason, It seems you have already answered my question in one of the comments. I need to convert the categorical value into one hot encoding then create dummy variable and then input it. Thanks.</p>
<div class="reply">
<a aria-label="Reply to Shooter" class="comment-reply-link" href="#comment-445771" onclick='return addComment.moveForm( "comment-445771", "445771", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-445810">
<div class="comment-container" id="li-comment-445810">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 11, 2018 at 6:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-445810" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-445810" onclick='return addComment.moveForm( "comment-445810", "445810", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-445778">
<div class="comment-container" id="li-comment-445778">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/48dbfb700ec2e7ac1658d54a895adcd1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/48dbfb700ec2e7ac1658d54a895adcd1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shooter</span>
<span class="date">August 10, 2018 at 8:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-445778" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, I wanted to ask again that using K-fold validation like this</p>
<p>    kfold = KFold(n_splits=10, shuffle=True, random_state=seed)<br/>
    results = cross_val_score(estimator, X, dummy_y, cv=kfold)</p>
<p>or using train/test split and validation data like this </p>
<p>    x_train,x_test,y_train,y_test=train_test_split(X,dummy_y,test_size=0.33,random_state=seed)</p>
<p>    estimator.fit(x_train,y_train,validation_data=(x_test,y_test))</p>
<p>These are just sampling techniques, we can use any one of them according to the availability and size of data right?</p>
<div class="reply">
<a aria-label="Reply to Shooter" class="comment-reply-link" href="#comment-445778" onclick='return addComment.moveForm( "comment-445778", "445778", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-445813">
<div class="comment-container" id="li-comment-445813">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 11, 2018 at 6:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-445813" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-445813" onclick='return addComment.moveForm( "comment-445813", "445813", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-446346">
<div class="comment-container" id="li-comment-446346">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/48dbfb700ec2e7ac1658d54a895adcd1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/48dbfb700ec2e7ac1658d54a895adcd1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shooter</span>
<span class="date">August 17, 2018 at 6:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-446346" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Shooter" class="comment-reply-link" href="#comment-446346" onclick='return addComment.moveForm( "comment-446346", "446346", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-446367">
<div class="comment-container" id="li-comment-446367">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/48dbfb700ec2e7ac1658d54a895adcd1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/48dbfb700ec2e7ac1658d54a895adcd1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shooter</span>
<span class="date">August 17, 2018 at 10:03 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-446367" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can u please provide one example of multilabel multi-class classification too?</p>
<div class="reply">
<a aria-label="Reply to Shooter" class="comment-reply-link" href="#comment-446367" onclick='return addComment.moveForm( "comment-446367", "446367", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-446384">
<div class="comment-container" id="li-comment-446384">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 18, 2018 at 5:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-446384" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-446384" onclick='return addComment.moveForm( "comment-446384", "446384", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-446404">
<div class="comment-container" id="li-comment-446404">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/48dbfb700ec2e7ac1658d54a895adcd1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/48dbfb700ec2e7ac1658d54a895adcd1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shooter</span>
<span class="date">August 18, 2018 at 3:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-446404" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>All examples i have seen so far in LSTM are related to classifiying imdb datasets or vocabulary like that. There are no simple examples to describe classification using LSTM. Can u please provide one example doing the same above iris classification using LSTM so that we can have a general idea.</p>
<p>Thanks in advance.</p>
<div class="reply">
<a aria-label="Reply to Shooter" class="comment-reply-link" href="#comment-446404" onclick='return addComment.moveForm( "comment-446404", "446404", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-446448">
<div class="comment-container" id="li-comment-446448">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 19, 2018 at 6:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-446448" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>LSTMs are for sequence data. For classification, this means sequence classification or time series classification.</p>
<p>Does that help?</p>
<p>You cannot use LSTMs on the Iris flowers dataset for example. Learn more here:<br/>
<a href="https://machinelearningmastery.com/when-to-use-mlp-cnn-and-rnn-neural-networks/" rel="nofollow">https://machinelearningmastery.com/when-to-use-mlp-cnn-and-rnn-neural-networks/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-446448" onclick='return addComment.moveForm( "comment-446448", "446448", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-446865">
<div class="comment-container" id="li-comment-446865">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/48dbfb700ec2e7ac1658d54a895adcd1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/48dbfb700ec2e7ac1658d54a895adcd1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shooter</span>
<span class="date">August 24, 2018 at 5:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-446865" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason. I have another question. I have total of 1950 data. Will it be enough if i train/test split into 90:10 ratio i.e 1560 data for training,195 for validation and 195 for testing. If i decrease training data, accuracy starts decreasing.</p>
<div class="reply">
<a aria-label="Reply to Shooter" class="comment-reply-link" href="#comment-446865" onclick='return addComment.moveForm( "comment-446865", "446865", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-446895">
<div class="comment-container" id="li-comment-446895">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 25, 2018 at 5:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-446895" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It is impossible for me to say, try it and see.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-446895" onclick='return addComment.moveForm( "comment-446895", "446895", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-446938">
<div class="comment-container" id="li-comment-446938">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/48dbfb700ec2e7ac1658d54a895adcd1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/48dbfb700ec2e7ac1658d54a895adcd1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shooter</span>
<span class="date">August 25, 2018 at 7:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-446938" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ok thanks, I’ll try it. Another question, How can i calculate accuracy of the model using sum of squared errors. I need to compare a model that gives sum of squared errors in regression with my  model that gives output in accuracy that is a classification problem.</p>
<div class="reply">
<a aria-label="Reply to Shooter" class="comment-reply-link" href="#comment-446938" onclick='return addComment.moveForm( "comment-446938", "446938", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-446980">
<div class="comment-container" id="li-comment-446980">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 26, 2018 at 6:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-446980" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sum squared errors is for regression, not classification.</p>
<p>For metrics, you can use sklearn to calculate anything you wish:<br/>
<a href="http://scikit-learn.org/stable/modules/classes.html#module-sklearn.metrics" rel="nofollow">http://scikit-learn.org/stable/modules/classes.html#module-sklearn.metrics</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-446980" onclick='return addComment.moveForm( "comment-446980", "446980", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-447792">
<div class="comment-container" id="li-comment-447792">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e394931838824d9ee14f0ebbc52bc43c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e394931838824d9ee14f0ebbc52bc43c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jet</span>
<span class="date">September 4, 2018 at 5:41 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-447792" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
awesome page &amp; tutorials!</p>
<p>Is there a way to do stratified k-fold cross-validation on multi-label classification, or at least k-fold cross-validation?</p>
<div class="reply">
<a aria-label="Reply to Jet" class="comment-reply-link" href="#comment-447792" onclick='return addComment.moveForm( "comment-447792", "447792", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-447870">
<div class="comment-container" id="li-comment-447870">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 5, 2018 at 6:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-447870" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>There may be, I don’t have any multi-label examples though, sorry.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-447870" onclick='return addComment.moveForm( "comment-447870", "447870", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-455878">
<div class="comment-container" id="li-comment-455878">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/46f77a9c07a1f0127cdbb0d713cca781?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/46f77a9c07a1f0127cdbb0d713cca781?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Manuel Gonçalves</span>
<span class="date">November 23, 2018 at 6:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-455878" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Use k-Fold on your Y and put the indexes on your one-hot-encodered. Something like this:</p>
<p>df  = pandas.read_csv, slice, blah blah blah<br/>
X = slice df etc..etc..<br/>
y = slice df etc..etc.. </p>
<p>dum_y = np_utils.to_categorical(y) #from keras</p>
<p>#now you have y and dum_y that is one-hot-encodered</p>
<p>skfold = StratifiedKFold(n_splits=10, random_state=0) #create a stratified Kfold<br/>
for train, test in skfold.split(X, y): #note that you are spliting the y without one-hot just to get indexes<br/>
         model = Sequential()<br/>
         model.add(Dense(blah blah blah)<br/>
         …<br/>
       #compile<br/>
       model.compile(blah blah blah)<br/>
       #now the magic, use indexes on one-hot-encodered, since the indexes are the same<br/>
       model.fit(X[train], dum_y[train], validation_data=(X[test], dum_y[test]), epochs=250, batch_size=50,verbose=False)<br/>
       #do the rest of your code<br/>
       #the model will be created and fitted 10 times</p>
<div class="reply">
<a aria-label="Reply to Manuel Gonçalves" class="comment-reply-link" href="#comment-455878" onclick='return addComment.moveForm( "comment-455878", "455878", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-449484">
<div class="comment-container" id="li-comment-449484">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d281b59bc721dcca3f4e347d9e99127d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d281b59bc721dcca3f4e347d9e99127d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sathvik</span>
<span class="date">September 21, 2018 at 2:24 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-449484" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That was really an excellent article..<br/>
can i implement CNN for feature Extraction from images then save the extracted features and apply SVM or XG boost for binary classification..please share the code to serve the purpose..thanks a lot..</p>
<div class="reply">
<a aria-label="Reply to sathvik" class="comment-reply-link" href="#comment-449484" onclick='return addComment.moveForm( "comment-449484", "449484", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-449530">
<div class="comment-container" id="li-comment-449530">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 22, 2018 at 6:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-449530" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes! I show how to use a VGG model to extraction features for describing the contents of photos. For example, the last part of this tutorial:<br/>
<a href="https://machinelearningmastery.com/prepare-photo-caption-dataset-training-deep-learning-model/" rel="nofollow">https://machinelearningmastery.com/prepare-photo-caption-dataset-training-deep-learning-model/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-449530" onclick='return addComment.moveForm( "comment-449530", "449530", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-452368">
<div class="comment-container" id="li-comment-452368">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/53bd0975e64a3e2a39315a35250cd041?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/53bd0975e64a3e2a39315a35250cd041?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">George</span>
<span class="date">October 22, 2018 at 10:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-452368" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason and many thanks for your helpful posts.</p>
<p>I haven’t find any multilabel classification post, so I am posting on this.</p>
<p>I have a problem to interpret the results of multi label classification.</p>
<p>Let’s say I have this problem.I have images with structures (ex building)</p>
<p>structure: 0 is there is no structure , 1 if it is<br/>
type: 3 different types of structures (1,2,3)<br/>
nb of structure</p>
<p>So, I have data:</p>
<p>labels = np.array([[0,’nan’, ‘nan’],<br/>
                            [1, 2, 2],<br/>
                            [1, 3, 1],<br/>
                            [1, 1, 1]])</p>
<p>When I have no structure all rest values are nan.</p>
<p>The second line means I have a structure of type 2 and also have 2 structures.<br/>
The third line means, I have a structure of type 3 and it is just one.<br/>
The fourth means I have a structure of type 1, just one.</p>
<p>I am applying the mlb:</p>
<p>mlb = MultiLabelBinarizer()<br/>
labels = mlb.fit_transform(labels)</p>
<p>and the mlb classes is :</p>
<p>array([‘0’, ‘1’, ‘2’, ‘3’, ‘nan’], dtype=object)</p>
<p>My test data is for example: [1, 2, 2] // 1: there is a structure, 2: of type 2, 2: there are 2 structures in the image</p>
<p>And my result predict array is : [20,10,2,4,50]</p>
<p>The problem is what 20 means.Is there a structure or not?Test data has the value 1 which means there is structure.So,<br/>
I 20% means possibility to have structure?</p>
<p>The 10 means that we have 10% possibility to be of type 1, then 2% to be of type 2 and 4% to be of type 3.<br/>
The 50% means that there is a possibility 50% to have how number of faces??? Two faces?as the test data says?</p>
<p>If there is no structure, the test array will be ([0, ‘nan’, ‘nan’])<br/>
So, the same prediction :  [20,10,2,4,50]</p>
<p>What 20% means?There is , or there is not a structure?<br/>
The 10,2,4 are the possibilities of type 1,2,3<br/>
The 50% is for the number of structures.But, is 50% for no structures , or for some number?</p>
<p>So, I have problem with first and last indices.</p>
<p>Thank you very much!</p>
<p>George</p>
<div class="reply">
<a aria-label="Reply to George" class="comment-reply-link" href="#comment-452368" onclick='return addComment.moveForm( "comment-452368", "452368", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-452399">
<div class="comment-container" id="li-comment-452399">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 23, 2018 at 6:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-452399" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have material on multi-label classification, so I can’t give useful off the cuff advice on the topic. I hope to cover it in the future.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-452399" onclick='return addComment.moveForm( "comment-452399", "452399", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-452415">
<div class="comment-container" id="li-comment-452415">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/53bd0975e64a3e2a39315a35250cd041?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/53bd0975e64a3e2a39315a35250cd041?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">George</span>
<span class="date">October 23, 2018 at 7:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/#comment-452415" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ok, thanks maybe I’ll post on stackoverflow if someone can help.Thanks.</p>
<div class="reply">
<a aria-label="Reply to George" class="comment-reply-link" href="#comment-452415" onclick='return addComment.moveForm( "comment-452415", "452415", "respond", "2567" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/multi-class-classification-tutorial-keras-deep-learning-library/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="2567"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="c05027177d"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="150"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery!</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Jason Brownlee, PhD
<br/>
I write tutorials to help developers (<i>like you</i>) get results with machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-6"> <div class="textwidget"><p></p><center><br/>
<strong>Deep Learning with Python</strong><br/>
No math, just tutorials and working code.
<p><a href="/deep-learning-with-python/">Click to Get Started Now!</a><br/>
<a href="/deep-learning-with-python/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/DeepLearningWithPython-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch"><img alt="How to Develop a Neural Machine Translation System in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/01/How-to-Develop-a-Neural-Machine-Translation-System-in-Keras-150x150.jpg" title="How to Develop a Neural Machine Translation System from Scratch" width="45"/></a> <a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch">How to Develop a Neural Machine Translation System from Scratch</a>
<span class="meta">January 10, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning"><img alt="Difference Between Classification and Regression in Machine Learning" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/Difference-Between-Classification-and-Regression-in-Machine-Learning-150x150.jpg" title="Difference Between Classification and Regression in Machine Learning" width="45"/></a> <a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning">Difference Between Classification and Regression in Machine Learning</a>
<span class="meta">December 11, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem..."><img alt="So, You are Working on a Machine Learning Problem..." class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/So-You-are-Working-on-a-Machine-Learning-Problem...-150x150.jpg" title="So, You are Working on a Machine Learning Problem..." width="45"/></a> <a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem…">So, You are Working on a Machine Learning Problem…</a>
<span class="meta">April 4, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis"><img alt="Plot of the Multichannel Convolutional Neural Network For Text" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-150x150.png" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis" width="45"/></a> <a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis">How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis</a>
<span class="meta">January 12, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras"><img alt="How to Make Classification and Regression Predictions for Deep Learning Models in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/How-to-Make-Classification-and-Regression-Predictions-for-Deep-Learning-Models-in-Keras-150x150.jpg" title="How to Make Predictions with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras">How to Make Predictions with Keras</a>
<span class="meta">April 9, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)"><img alt="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/11-Classical-Time-Series-Forecasting-Methods-in-Python-Cheat-Sheet-150x150.jpg" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)">11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)</a>
<span class="meta">August 6, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras"><img alt="How to Visualize a Deep Learning Neural Network Model in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/How-to-Visualize-a-Deep-Learning-Neural-Network-Model-in-Keras-150x150.jpg" title="How to Visualize a Deep Learning Neural Network Model in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras">How to Visualize a Deep Learning Neural Network Model in Keras</a>
<span class="meta">December 13, 2017</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> <div class="widget_text widget widget_custom_html" id="custom_html-2"><h3>You might also like…</h3><div class="textwidget custom-html-widget"><ul>
<li><a href="/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Install Python for Machine Learning</a></li>
<li><a href="/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python</a></li>
<li><a href="/tutorial-first-neural-network-python-keras/">Your First Neural Network in Python</a></li>
<li><a href="/how-to-run-your-first-classifier-in-weka/">Your First Classifier in Weka</a></li>
<li><a href="/arima-for-time-series-forecasting-with-python/">Your First Time Series Forecasting Project</a></li>
</ul></div></div></aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/disclaimer/">Disclaimer</a> | 
<a href="/terms-of-service/">Terms</a> | 
<a href="/contact/">Contact</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.8" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.0.5" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.8" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.1" type="text/javascript"></script>
</body>
</html>