<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v9.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Time Series Prediction With Deep Learning in Keras</title>
<link href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="Time Series Prediction With Deep Learning in Keras" property="og:title"/>
<meta content="Time Series prediction is a difficult problem both to frame and to address with machine learning. In this post, you will discover how to develop neural network models for time series prediction in Python using the Keras deep learning library. After reading this post you will know: About the airline passengers univariate time series prediction …" property="og:description"/>
<meta content="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="https://www.facebook.com/jason.brownlee.39" property="article:author"/>
<meta content="Deep Learning for Time Series" property="article:section"/>
<meta content="2016-07-18T19:00:49+00:00" property="article:published_time"/>
<meta content="2018-08-30T00:23:14+00:00" property="article:modified_time"/>
<meta content="2018-08-30T00:23:14+00:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Airline-Passengers-Dataset.png" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Airline-Passengers-Dataset.png" property="og:image:secure_url"/>
<meta content="800" property="og:image:width"/>
<meta content="600" property="og:image:height"/>
<meta content="Plot of the Airline Passengers Dataset" property="og:image:alt"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"https:\/\/machinelearningmastery.com\/#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/feed/" rel="alternate" title="Machine Learning Mastery » Time Series Prediction With Deep Learning in Keras Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<style media="all" type="text/css">
.wpautoterms-footer{background-color:#ffffff;text-align:center;}
.wpautoterms-footer a{color:#000000;font-family:Arial, sans-serif;font-size:14px;}
.wpautoterms-footer .separator{color:#cccccc;font-family:Arial, sans-serif;font-size:14px;}</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/auto-terms-of-service-and-privacy-policy/css/wpautoterms.css?ver=4.9.8" id="wpautoterms_css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.0.5" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/css/front.css?ver=2.0.20" id="ssb-front-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/ewd-ufaq-styles.css?ver=4.9.8" id="ewd-ufaq-style-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/rrssb-min.css?ver=4.9.8" id="ewd-ufaq-rrssb-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.8" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=2.0.20" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.8" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.8" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=2924" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Ftime-series-prediction-with-deep-learning-in-python-with-keras%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Ftime-series-prediction-with-deep-learning-in-python-with-keras%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<style media="screen">

        .simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
      margin: ;
    }
         /*inline margin*/
    
  
  
  
  
  
          .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
         margin: ;
     }

          /*margin-digbar*/

  
  
  
  
 
   
   

</style>
<script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#4c89bf; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#4c89bf;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#4c89bf!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#ffffff;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-2924 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/icon-100x100.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-53"> <div class="textwidget"><p>Want help with deep learning for time series? <a href="https://machinelearningmastery.lpages.co/deep-learning-for-time-series-forecasting-mini-course/">Take the FREE Mini-Course</a></p>
</div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<input name="post_type" type="hidden" value="post"/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Main Menu</h3><ul class="nav fl" id="main-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503" id="menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Start Here</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501" id="menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506" id="menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508" id="menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (Keras)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511" id="menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6509" id="menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515" id="menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">Deep Learning for NLP</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512" id="menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Understand Algorithms</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507" id="menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms (Python)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6513" id="menu-item-6513"><a href="https://machinelearningmastery.com/category/machine-learning-process/">Machine Learning Process</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516" id="menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517" id="menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522" id="menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6518" id="menu-item-6518"><a href="https://machinelearningmastery.com/category/start-machine-learning/">Getting Started</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510" id="menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519" id="menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistical Methods</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520" id="menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Time Series (introductory)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523" id="menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6514" id="menu-item-6514"><a href="https://machinelearningmastery.com/category/machine-learning-resources/">Resources</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502" id="menu-item-6502"><a href="https://machinelearningmastery.com/products/">Ebooks</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500" id="menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504" id="menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505" id="menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-2924 post type-post status-publish format-standard has-post-thumbnail hentry category-deep-learning-time-series">
<header>
<h1 class="title entry-title">Time Series Prediction With Deep Learning in Keras</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-07-19T05:00:49+1100">July 19, 2016</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/" title="View all items in Deep Learning for Time Series">Deep Learning for Time Series</a></span> </div>
<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-2924 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=Time+Series+Prediction+With+Deep+Learning+in+Keras&amp;url=https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
<p>Time Series prediction is a difficult problem both to frame and to address with machine learning.</p>
<p>In this post, you will discover how to develop neural network models for time series prediction in Python using the Keras deep learning library.</p>
<p>After reading this post you will know:</p>
<ul>
<li>About the airline passengers univariate time series prediction problem.</li>
<li>How to phrase time series prediction as a regression problem and develop a neural network model for it.</li>
<li>How to frame time series prediction with a time lag and develop a neural network model for it.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Oct/2016</strong>: Replaced graphs with more accurate versions, commented on the limited performance of the first method.</li>
<li><strong>Update Mar/2017</strong>: Updated example for Keras 2.0.2, TensorFlow 1.0.1 and Theano 0.9.0.</li>
</ul>
<h2>Problem Description</h2>
<p>The problem we are going to look at in this post is the international airline passengers prediction problem.</p>
<p>This is a problem where given a year and a month, the task is to predict the number of international airline passengers in units of 1,000. The data ranges from January 1949 to December 1960 or 12 years, with 144 observations.</p>
<p>The dataset is available for free from the <a href="https://datamarket.com/data/set/22u3/international-airline-passengers-monthly-totals-in-thousands-jan-49-dec-60#!ds=22u3&amp;display=line">DataMarket webpage as a CSV download</a> with the filename “<em>international-airline-passengers.csv</em>“.</p>
<p>Below is a sample of the first few lines of the file.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cab0261570060210279" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
"Month","International airline passengers: monthly totals in thousands. Jan 49 ? Dec 60"
"1949-01",112
"1949-02",118
"1949-03",132
"1949-04",129
"1949-05",121</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cab0261570060210279-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261570060210279-2">2</div><div class="crayon-num" data-line="crayon-5c0cab0261570060210279-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261570060210279-4">4</div><div class="crayon-num" data-line="crayon-5c0cab0261570060210279-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261570060210279-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cab0261570060210279-1">"Month","International airline passengers: monthly totals in thousands. Jan 49 ? Dec 60"</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261570060210279-2">"1949-01",112</div><div class="crayon-line" id="crayon-5c0cab0261570060210279-3">"1949-02",118</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261570060210279-4">"1949-03",132</div><div class="crayon-line" id="crayon-5c0cab0261570060210279-5">"1949-04",129</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261570060210279-6">"1949-05",121</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can load this dataset easily using the Pandas library. We are not interested in the date, given that each observation is separated by the same interval of one month. Therefore when we load the dataset we can exclude the first column.</p>
<p>The downloaded dataset also has footer information that we can exclude with the <strong>skipfooter</strong> argument to <strong>pandas.read_csv()</strong> set to 3 for the 3 footer lines. Once loaded we can easily plot the whole dataset. The code to load and plot the dataset is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cab0261578904496267" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
import pandas
import matplotlib.pyplot as plt
dataset = pandas.read_csv('international-airline-passengers.csv', usecols=[1], engine='python', skipfooter=3)
plt.plot(dataset)
plt.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cab0261578904496267-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261578904496267-2">2</div><div class="crayon-num" data-line="crayon-5c0cab0261578904496267-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261578904496267-4">4</div><div class="crayon-num" data-line="crayon-5c0cab0261578904496267-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cab0261578904496267-1"><span class="crayon-e">import </span><span class="crayon-e">pandas</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261578904496267-2"><span class="crayon-e">import </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line" id="crayon-5c0cab0261578904496267-3"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pandas</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'international-airline-passengers.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">usecols</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">engine</span><span class="crayon-o">=</span><span class="crayon-s">'python'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">skipfooter</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261578904496267-4"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab0261578904496267-5"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>You can see an upward trend in the plot.</p>
<p>You can also see some periodicity to the dataset that probably corresponds to the northern hemisphere summer holiday period.</p>
<div class="wp-caption aligncenter" id="attachment_2925" style="width: 810px"><img alt="Plot of the Airline Passengers Dataset" class="size-full wp-image-2925" height="600" sizes="(max-width: 800px) 100vw, 800px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Airline-Passengers-Dataset.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Airline-Passengers-Dataset.png 800w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Airline-Passengers-Dataset-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Airline-Passengers-Dataset-768x576.png 768w" width="800"/><p class="wp-caption-text">Plot of the Airline Passengers Dataset</p></div>
<p>We are going to keep things simple and work with the data as-is.</p>
<p>Normally, it is a good idea to investigate various data preparation techniques to rescale the data and to make it stationary.</p>
<p></p><div class="woo-sc-hr"></div>
<center>
<h3>Need help with Deep Learning for Time Series?</h3>
<p>Take my free 7-day email crash course now (with sample code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.lpages.co/leadbox/14531ee73f72a2%3A164f8be4f346dc/5630742793027584/" style="background: rgb(255, 206, 10); color: rgb(255, 255, 255); text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.25) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.5) 0px 1px 3px inset, rgba(0, 0, 0, 0.5) 0px 1px 3px;" target="_blank">Download Your FREE Mini-Course</a><script data-config="%7B%7D" data-leadbox="14531ee73f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.lpages.co/leadbox/14531ee73f72a2%3A164f8be4f346dc/5630742793027584/" src="https://machinelearningmastery.lpages.co/leadbox-1534880695.js" type="text/javascript"></script></p>
</center>
<p></p><div class="woo-sc-hr"></div>
<h2>Multilayer Perceptron Regression</h2>
<p>We want to phrase the time series prediction problem as a regression problem.</p>
<p>That is, given the number of passengers (in units of thousands) this month, what is the number of passengers next month.</p>
<p>We can write a simple function to convert our single column of data into a two-column dataset. The first column containing this month’s (t) passenger count and the second column containing next month’s (t+1) passenger count, to be predicted.</p>
<p>Before we get started, let’s first import all of the functions and classes we intend to use. This assumes a working SciPy environment with the Keras deep learning library installed.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cab026157b786251788" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
import numpy
import matplotlib.pyplot as plt
import pandas
from keras.models import Sequential
from keras.layers import Dense</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cab026157b786251788-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026157b786251788-2">2</div><div class="crayon-num" data-line="crayon-5c0cab026157b786251788-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026157b786251788-4">4</div><div class="crayon-num" data-line="crayon-5c0cab026157b786251788-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cab026157b786251788-1"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026157b786251788-2"><span class="crayon-e">import </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line" id="crayon-5c0cab026157b786251788-3"><span class="crayon-e">import </span><span class="crayon-e">pandas</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026157b786251788-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5c0cab026157b786251788-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-v">Dense</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p><span style="line-height: 1.5;">Before we do anything, it is a good idea to fix the random number seed to ensure our results are reproducible.</span></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cab026157d860323134" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# fix random seed for reproducibility
numpy.random.seed(7)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cab026157d860323134-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026157d860323134-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cab026157d860323134-1"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026157d860323134-2"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can also use the code from the previous section to load the dataset as a Pandas dataframe. We can then extract the NumPy array from the dataframe and convert the integer values to floating point values which are more suitable for modeling with a neural network.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cab026157f244788765" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load the dataset
dataframe = pandas.read_csv('international-airline-passengers.csv', usecols=[1], engine='python', skipfooter=3)
dataset = dataframe.values
dataset = dataset.astype('float32')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cab026157f244788765-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026157f244788765-2">2</div><div class="crayon-num" data-line="crayon-5c0cab026157f244788765-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026157f244788765-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cab026157f244788765-1"><span class="crayon-p"># load the dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026157f244788765-2"><span class="crayon-v">dataframe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pandas</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'international-airline-passengers.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">usecols</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">engine</span><span class="crayon-o">=</span><span class="crayon-s">'python'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">skipfooter</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab026157f244788765-3"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026157f244788765-4"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>After we model our data and estimate the skill of our model on the training dataset, we need to get an idea of the skill of the model on new unseen data. For a normal classification or regression problem we would do this using cross validation.</p>
<p>With time series data, the sequence of values is important. A simple method that we can use is to split the ordered dataset into train and test datasets. The code below calculates the index of the split point and separates the data into the training datasets with 67% of the observations that we can use to train our model, leaving the remaining 33% for testing the model.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cab0261580418642148" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# split into train and test sets
train_size = int(len(dataset) * 0.67)
test_size = len(dataset) - train_size
train, test = dataset[0:train_size,:], dataset[train_size:len(dataset),:]
print(len(train), len(test))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cab0261580418642148-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261580418642148-2">2</div><div class="crayon-num" data-line="crayon-5c0cab0261580418642148-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261580418642148-4">4</div><div class="crayon-num" data-line="crayon-5c0cab0261580418642148-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cab0261580418642148-1"><span class="crayon-p"># split into train and test sets</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261580418642148-2"><span class="crayon-v">train_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.67</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab0261580418642148-3"><span class="crayon-v">test_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">train_size</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261580418642148-4"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">train_size</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">train_size</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0cab0261580418642148-5"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p><span style="line-height: 1.5;">Now we can define a function to create a new dataset as described above. The function takes two arguments, the dataset which is a NumPy array that we want to convert into a dataset and the <strong>look_back</strong> which is the number of previous time steps to use as input variables to predict the next time period, in this case, defaulted to 1. </span></p>
<p><span style="line-height: 1.5;">This default will create a dataset where X is the number of passengers at a given time (t) and Y is the number of passengers at the next time (t + 1).</span></p>
<p>It can be configured and we will look at constructing a differently shaped dataset in the next section.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cab0261582517965377" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# convert an array of values into a dataset matrix
def create_dataset(dataset, look_back=1):
	dataX, dataY = [], []
	for i in range(len(dataset)-look_back-1):
		a = dataset[i:(i+look_back), 0]
		dataX.append(a)
		dataY.append(dataset[i + look_back, 0])
	return numpy.array(dataX), numpy.array(dataY)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cab0261582517965377-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261582517965377-2">2</div><div class="crayon-num" data-line="crayon-5c0cab0261582517965377-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261582517965377-4">4</div><div class="crayon-num" data-line="crayon-5c0cab0261582517965377-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261582517965377-6">6</div><div class="crayon-num" data-line="crayon-5c0cab0261582517965377-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261582517965377-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cab0261582517965377-1"><span class="crayon-p"># convert an array of values into a dataset matrix</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261582517965377-2"><span class="crayon-e">def </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cab0261582517965377-3"><span class="crayon-h"> </span><span class="crayon-v">dataX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261582517965377-4"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-v">look_back</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cab0261582517965377-5"><span class="crayon-h"> </span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261582517965377-6"><span class="crayon-h"> </span><span class="crayon-v">dataX</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab0261582517965377-7"><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261582517965377-8"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">dataY</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>Let’s take a look at the effect of this function on the first few rows of the dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cab0261584683386852" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
X		Y
112		118
118		132
132		129
129		121
121		135</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cab0261584683386852-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261584683386852-2">2</div><div class="crayon-num" data-line="crayon-5c0cab0261584683386852-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261584683386852-4">4</div><div class="crayon-num" data-line="crayon-5c0cab0261584683386852-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261584683386852-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cab0261584683386852-1">X		Y</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261584683386852-2">112		118</div><div class="crayon-line" id="crayon-5c0cab0261584683386852-3">118		132</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261584683386852-4">132		129</div><div class="crayon-line" id="crayon-5c0cab0261584683386852-5">129		121</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261584683386852-6">121		135</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>If you compare these first 5 rows to the original dataset sample listed in the previous section, you can see the X=t and Y=t+1 pattern in the numbers.</p>
<p>Let’s use this function to prepare the train and test datasets ready for modeling.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cab0261586353460074" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# reshape into X=t and Y=t+1
look_back = 1
trainX, trainY = create_dataset(train, look_back)
testX, testY = create_dataset(test, look_back)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cab0261586353460074-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261586353460074-2">2</div><div class="crayon-num" data-line="crayon-5c0cab0261586353460074-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261586353460074-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cab0261586353460074-1"><span class="crayon-p"># reshape into X=t and Y=t+1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261586353460074-2"><span class="crayon-v">look_back</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5c0cab0261586353460074-3"><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261586353460074-4"><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>We can now fit a Multilayer Perceptron model to the training data.</p>
<p>We use a simple network with 1 input, 1 hidden layer with 8 neurons and an output layer. The model is fit using mean squared error, which if we take the square root gives us an error score in the units of the dataset.</p>
<p>I tried a few rough parameters and settled on the configuration below, but by no means is the network listed  optimized.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cab0261587092591650" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# create and fit Multilayer Perceptron model
model = Sequential()
model.add(Dense(8, input_dim=look_back, activation='relu'))
model.add(Dense(1))
model.compile(loss='mean_squared_error', optimizer='adam')
model.fit(trainX, trainY, epochs=200, batch_size=2, verbose=2)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cab0261587092591650-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261587092591650-2">2</div><div class="crayon-num" data-line="crayon-5c0cab0261587092591650-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261587092591650-4">4</div><div class="crayon-num" data-line="crayon-5c0cab0261587092591650-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261587092591650-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cab0261587092591650-1"><span class="crayon-p"># create and fit Multilayer Perceptron model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261587092591650-2"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab0261587092591650-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261587092591650-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab0261587092591650-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mean_squared_error'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261587092591650-6"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">200</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Once the model is fit, we can estimate the performance of the model on the train and test datasets. This will give us a point of comparison for new models.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cab0261589362073765" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Estimate model performance
trainScore = model.evaluate(trainX, trainY, verbose=0)
print('Train Score: %.2f MSE (%.2f RMSE)' % (trainScore, math.sqrt(trainScore)))
testScore = model.evaluate(testX, testY, verbose=0)
print('Test Score: %.2f MSE (%.2f RMSE)' % (testScore, math.sqrt(testScore)))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cab0261589362073765-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261589362073765-2">2</div><div class="crayon-num" data-line="crayon-5c0cab0261589362073765-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261589362073765-4">4</div><div class="crayon-num" data-line="crayon-5c0cab0261589362073765-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cab0261589362073765-1"><span class="crayon-p"># Estimate model performance</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261589362073765-2"><span class="crayon-v">trainScore</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab0261589362073765-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Train Score: %.2f MSE (%.2f RMSE)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">trainScore</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">trainScore</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261589362073765-4"><span class="crayon-v">testScore</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab0261589362073765-5"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test Score: %.2f MSE (%.2f RMSE)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testScore</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">testScore</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Finally, we can generate predictions using the model for both the train and test dataset to get a visual indication of the skill of the model.</p>
<p>Because of how the dataset was prepared, we must shift the predictions so that they aline on the x-axis with the original dataset. Once prepared, the data is plotted, showing the original dataset in blue, the predictions for the train dataset in green the predictions on the unseen test dataset in red.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cab026158b968298806" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# generate predictions for training
trainPredict = model.predict(trainX)
testPredict = model.predict(testX)

# shift train predictions for plotting
trainPredictPlot = numpy.empty_like(dataset)
trainPredictPlot[:, :] = numpy.nan
trainPredictPlot[look_back:len(trainPredict)+look_back, :] = trainPredict

# shift test predictions for plotting
testPredictPlot = numpy.empty_like(dataset)
testPredictPlot[:, :] = numpy.nan
testPredictPlot[len(trainPredict)+(look_back*2)+1:len(dataset)-1, :] = testPredict

# plot baseline and predictions
plt.plot(dataset)
plt.plot(trainPredictPlot)
plt.plot(testPredictPlot)
plt.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cab026158b968298806-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158b968298806-2">2</div><div class="crayon-num" data-line="crayon-5c0cab026158b968298806-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158b968298806-4">4</div><div class="crayon-num" data-line="crayon-5c0cab026158b968298806-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158b968298806-6">6</div><div class="crayon-num" data-line="crayon-5c0cab026158b968298806-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158b968298806-8">8</div><div class="crayon-num" data-line="crayon-5c0cab026158b968298806-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158b968298806-10">10</div><div class="crayon-num" data-line="crayon-5c0cab026158b968298806-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158b968298806-12">12</div><div class="crayon-num" data-line="crayon-5c0cab026158b968298806-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158b968298806-14">14</div><div class="crayon-num" data-line="crayon-5c0cab026158b968298806-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158b968298806-16">16</div><div class="crayon-num" data-line="crayon-5c0cab026158b968298806-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158b968298806-18">18</div><div class="crayon-num" data-line="crayon-5c0cab026158b968298806-19">19</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cab026158b968298806-1"><span class="crayon-p"># generate predictions for training</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158b968298806-2"><span class="crayon-v">trainPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab026158b968298806-3"><span class="crayon-v">testPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158b968298806-4"> </div><div class="crayon-line" id="crayon-5c0cab026158b968298806-5"><span class="crayon-p"># shift train predictions for plotting</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158b968298806-6"><span class="crayon-v">trainPredictPlot</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">empty_like</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab026158b968298806-7"><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">nan</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158b968298806-8"><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-v">look_back</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainPredict</span></div><div class="crayon-line" id="crayon-5c0cab026158b968298806-9"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158b968298806-10"><span class="crayon-p"># shift test predictions for plotting</span></div><div class="crayon-line" id="crayon-5c0cab026158b968298806-11"><span class="crayon-v">testPredictPlot</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">empty_like</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158b968298806-12"><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">nan</span></div><div class="crayon-line" id="crayon-5c0cab026158b968298806-13"><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-sy">(</span><span class="crayon-e ">look_back*</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testPredict</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158b968298806-14"> </div><div class="crayon-line" id="crayon-5c0cab026158b968298806-15"><span class="crayon-p"># plot baseline and predictions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158b968298806-16"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab026158b968298806-17"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158b968298806-18"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab026158b968298806-19"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>We can see that the model did a pretty poor job of fitting both the training and the test datasets. It basically predicted the same input value as the output.</p>
<div class="wp-caption aligncenter" id="attachment_3301" style="width: 810px"><img alt="Naive Time Series Predictions With Neural Network" class="wp-image-3301 size-full" height="600" sizes="(max-width: 800px) 100vw, 800px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Naive-Time-Series-Prediction-With-Neural-Networks.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Naive-Time-Series-Prediction-With-Neural-Networks.png 800w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Naive-Time-Series-Prediction-With-Neural-Networks-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Naive-Time-Series-Prediction-With-Neural-Networks-768x576.png 768w" width="800"/><p class="wp-caption-text">Naive Time Series Predictions With Neural Network<br/>Blue=Whole Dataset, Green=Training, Red=Predictions</p></div>
<p>For completeness, below is the entire code listing.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cab026158c097485628" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Multilayer Perceptron to Predict International Airline Passengers (t+1, given t)
import numpy
import matplotlib.pyplot as plt
import pandas
import math
from keras.models import Sequential
from keras.layers import Dense
# fix random seed for reproducibility
numpy.random.seed(7)
# load the dataset
dataframe = pandas.read_csv('international-airline-passengers.csv', usecols=[1], engine='python', skipfooter=3)
dataset = dataframe.values
dataset = dataset.astype('float32')
# split into train and test sets
train_size = int(len(dataset) * 0.67)
test_size = len(dataset) - train_size
train, test = dataset[0:train_size,:], dataset[train_size:len(dataset),:]
print(len(train), len(test))
# convert an array of values into a dataset matrix
def create_dataset(dataset, look_back=1):
	dataX, dataY = [], []
	for i in range(len(dataset)-look_back-1):
		a = dataset[i:(i+look_back), 0]
		dataX.append(a)
		dataY.append(dataset[i + look_back, 0])
	return numpy.array(dataX), numpy.array(dataY)
# reshape into X=t and Y=t+1
look_back = 1
trainX, trainY = create_dataset(train, look_back)
testX, testY = create_dataset(test, look_back)
# create and fit Multilayer Perceptron model
model = Sequential()
model.add(Dense(8, input_dim=look_back, activation='relu'))
model.add(Dense(1))
model.compile(loss='mean_squared_error', optimizer='adam')
model.fit(trainX, trainY, epochs=200, batch_size=2, verbose=2)
# Estimate model performance
trainScore = model.evaluate(trainX, trainY, verbose=0)
print('Train Score: %.2f MSE (%.2f RMSE)' % (trainScore, math.sqrt(trainScore)))
testScore = model.evaluate(testX, testY, verbose=0)
print('Test Score: %.2f MSE (%.2f RMSE)' % (testScore, math.sqrt(testScore)))
# generate predictions for training
trainPredict = model.predict(trainX)
testPredict = model.predict(testX)
# shift train predictions for plotting
trainPredictPlot = numpy.empty_like(dataset)
trainPredictPlot[:, :] = numpy.nan
trainPredictPlot[look_back:len(trainPredict)+look_back, :] = trainPredict
# shift test predictions for plotting
testPredictPlot = numpy.empty_like(dataset)
testPredictPlot[:, :] = numpy.nan
testPredictPlot[len(trainPredict)+(look_back*2)+1:len(dataset)-1, :] = testPredict
# plot baseline and predictions
plt.plot(dataset)
plt.plot(trainPredictPlot)
plt.plot(testPredictPlot)
plt.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-2">2</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-4">4</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-6">6</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-8">8</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-10">10</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-12">12</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-14">14</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-16">16</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-18">18</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-20">20</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-22">22</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-24">24</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-26">26</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-28">28</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-30">30</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-32">32</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-34">34</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-36">36</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-38">38</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-40">40</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-42">42</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-44">44</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-46">46</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-48">48</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-50">50</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-52">52</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-54">54</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158c097485628-56">56</div><div class="crayon-num" data-line="crayon-5c0cab026158c097485628-57">57</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cab026158c097485628-1"><span class="crayon-p"># Multilayer Perceptron to Predict International Airline Passengers (t+1, given t)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-3"><span class="crayon-e">import </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-4"><span class="crayon-e">import </span><span class="crayon-e">pandas</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-5"><span class="crayon-e">import </span><span class="crayon-e">math</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-v">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-8"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-9"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-10"><span class="crayon-p"># load the dataset</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-11"><span class="crayon-v">dataframe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pandas</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'international-airline-passengers.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">usecols</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">engine</span><span class="crayon-o">=</span><span class="crayon-s">'python'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">skipfooter</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-12"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-13"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-14"><span class="crayon-p"># split into train and test sets</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-15"><span class="crayon-v">train_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.67</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-16"><span class="crayon-v">test_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">train_size</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-17"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">train_size</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">train_size</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-18"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-19"><span class="crayon-p"># convert an array of values into a dataset matrix</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-20"><span class="crayon-e">def </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-21"><span class="crayon-h"> </span><span class="crayon-v">dataX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-22"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-v">look_back</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-23"><span class="crayon-h"> </span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-24"><span class="crayon-h"> </span><span class="crayon-v">dataX</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-25"><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-26"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">dataY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-27"><span class="crayon-p"># reshape into X=t and Y=t+1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-28"><span class="crayon-v">look_back</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-29"><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-30"><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-31"><span class="crayon-p"># create and fit Multilayer Perceptron model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-32"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-33"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-34"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-35"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mean_squared_error'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-36"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">200</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-37"><span class="crayon-p"># Estimate model performance</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-38"><span class="crayon-v">trainScore</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-39"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Train Score: %.2f MSE (%.2f RMSE)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">trainScore</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">trainScore</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-40"><span class="crayon-v">testScore</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-41"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test Score: %.2f MSE (%.2f RMSE)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testScore</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">testScore</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-42"><span class="crayon-p"># generate predictions for training</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-43"><span class="crayon-v">trainPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-44"><span class="crayon-v">testPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-45"><span class="crayon-p"># shift train predictions for plotting</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-46"><span class="crayon-v">trainPredictPlot</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">empty_like</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-47"><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">nan</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-48"><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-v">look_back</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainPredict</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-49"><span class="crayon-p"># shift test predictions for plotting</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-50"><span class="crayon-v">testPredictPlot</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">empty_like</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-51"><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">nan</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-52"><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-sy">(</span><span class="crayon-e ">look_back*</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testPredict</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-53"><span class="crayon-p"># plot baseline and predictions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-54"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-55"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158c097485628-56"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab026158c097485628-57"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0035 seconds] -->
<p><span style="line-height: 1.5;">Running the model produces the following output.</span></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cab026158f763488705" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Epoch 195/200
0s - loss: 536.7014
Epoch 196/200
0s - loss: 555.4216
Epoch 197/200
0s - loss: 552.2841
Epoch 198/200
0s - loss: 541.2220
Epoch 199/200
0s - loss: 542.3288
Epoch 200/200
0s - loss: 534.2096
Train Score: 532.59 MSE (23.08 RMSE)
Test Score: 2358.07 MSE (48.56 RMSE)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cab026158f763488705-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158f763488705-2">2</div><div class="crayon-num" data-line="crayon-5c0cab026158f763488705-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158f763488705-4">4</div><div class="crayon-num" data-line="crayon-5c0cab026158f763488705-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158f763488705-6">6</div><div class="crayon-num" data-line="crayon-5c0cab026158f763488705-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158f763488705-8">8</div><div class="crayon-num" data-line="crayon-5c0cab026158f763488705-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158f763488705-10">10</div><div class="crayon-num" data-line="crayon-5c0cab026158f763488705-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158f763488705-12">12</div><div class="crayon-num" data-line="crayon-5c0cab026158f763488705-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab026158f763488705-14">14</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cab026158f763488705-1">Epoch 195/200</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158f763488705-2">0s - loss: 536.7014</div><div class="crayon-line" id="crayon-5c0cab026158f763488705-3">Epoch 196/200</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158f763488705-4">0s - loss: 555.4216</div><div class="crayon-line" id="crayon-5c0cab026158f763488705-5">Epoch 197/200</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158f763488705-6">0s - loss: 552.2841</div><div class="crayon-line" id="crayon-5c0cab026158f763488705-7">Epoch 198/200</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158f763488705-8">0s - loss: 541.2220</div><div class="crayon-line" id="crayon-5c0cab026158f763488705-9">Epoch 199/200</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158f763488705-10">0s - loss: 542.3288</div><div class="crayon-line" id="crayon-5c0cab026158f763488705-11">Epoch 200/200</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158f763488705-12">0s - loss: 534.2096</div><div class="crayon-line" id="crayon-5c0cab026158f763488705-13">Train Score: 532.59 MSE (23.08 RMSE)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab026158f763488705-14">Test Score: 2358.07 MSE (48.56 RMSE)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Taking the square root of the performance estimates, we can see that the model has an average error of 23 passengers (in thousands) on the training dataset and 48 passengers (in thousands) on the test dataset.</p>
<h2>Multilayer Perceptron Using the Window Method</h2>
<p>We can also phrase the problem so that multiple recent time steps can be used to make the prediction for the next time step.</p>
<p>This is called the window method, and the size of the window is a parameter that can be tuned for each problem.</p>
<p>For example, given the current time (t) we want to predict the value at the next time in the sequence (t + 1), we can use the current time (t) as well as the two prior times (t-1 and t-2).</p>
<p>When phrased as a regression problem the input variables are t-2, t-1, t and the output variable is t+1.</p>
<p>The <strong>create_dataset()</strong> function we wrote in the previous section allows us to create this formulation of the time series problem by increasing the <strong>look_back</strong> argument from 1 to 3.</p>
<p>A sample of the dataset with this formulation looks as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cab0261594149208714" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
X1	X2	X3	Y
112	118	132	129
118	132	129	121
132	129	121	135
129	121	135	148
121	135	148	148</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cab0261594149208714-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261594149208714-2">2</div><div class="crayon-num" data-line="crayon-5c0cab0261594149208714-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261594149208714-4">4</div><div class="crayon-num" data-line="crayon-5c0cab0261594149208714-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261594149208714-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cab0261594149208714-1">X1	X2	X3	Y</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261594149208714-2">112	118	132	129</div><div class="crayon-line" id="crayon-5c0cab0261594149208714-3">118	132	129	121</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261594149208714-4">132	129	121	135</div><div class="crayon-line" id="crayon-5c0cab0261594149208714-5">129	121	135	148</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261594149208714-6">121	135	148	148</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can re-run the example in the previous section with the larger window size. We will increase the network capacity to handle the additional information. The first hidden layer is increased to 14 neurons and a second hidden layer is added with 8 neurons. The number of epochs is also increased to 400.</p>
<p>The whole code listing with just the window size change is listed below for completeness.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cab0261596599768346" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Multilayer Perceptron to Predict International Airline Passengers (t+1, given t, t-1, t-2)
import numpy
import matplotlib.pyplot as plt
from pandas import read_csv
import math
from keras.models import Sequential
from keras.layers import Dense

# convert an array of values into a dataset matrix
def create_dataset(dataset, look_back=1):
	dataX, dataY = [], []
	for i in range(len(dataset)-look_back-1):
		a = dataset[i:(i+look_back), 0]
		dataX.append(a)
		dataY.append(dataset[i + look_back, 0])
	return numpy.array(dataX), numpy.array(dataY)

# fix random seed for reproducibility
numpy.random.seed(7)
# load the dataset
dataframe = read_csv('international-airline-passengers.csv', usecols=[1], engine='python', skipfooter=3)
dataset = dataframe.values
dataset = dataset.astype('float32')
# split into train and test sets
train_size = int(len(dataset) * 0.67)
test_size = len(dataset) - train_size
train, test = dataset[0:train_size,:], dataset[train_size:len(dataset),:]
# reshape dataset
look_back = 3
trainX, trainY = create_dataset(train, look_back)
testX, testY = create_dataset(test, look_back)
# create and fit Multilayer Perceptron model
model = Sequential()
model.add(Dense(12, input_dim=look_back, activation='relu'))
model.add(Dense(8, activation='relu'))
model.add(Dense(1))
model.compile(loss='mean_squared_error', optimizer='adam')
model.fit(trainX, trainY, epochs=400, batch_size=2, verbose=2)
# Estimate model performance
trainScore = model.evaluate(trainX, trainY, verbose=0)
print('Train Score: %.2f MSE (%.2f RMSE)' % (trainScore, math.sqrt(trainScore)))
testScore = model.evaluate(testX, testY, verbose=0)
print('Test Score: %.2f MSE (%.2f RMSE)' % (testScore, math.sqrt(testScore)))
# generate predictions for training
trainPredict = model.predict(trainX)
testPredict = model.predict(testX)
# shift train predictions for plotting
trainPredictPlot = numpy.empty_like(dataset)
trainPredictPlot[:, :] = numpy.nan
trainPredictPlot[look_back:len(trainPredict)+look_back, :] = trainPredict
# shift test predictions for plotting
testPredictPlot = numpy.empty_like(dataset)
testPredictPlot[:, :] = numpy.nan
testPredictPlot[len(trainPredict)+(look_back*2)+1:len(dataset)-1, :] = testPredict
# plot baseline and predictions
plt.plot(dataset)
plt.plot(trainPredictPlot)
plt.plot(testPredictPlot)
plt.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-2">2</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-4">4</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-6">6</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-8">8</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-10">10</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-12">12</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-14">14</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-16">16</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-18">18</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-20">20</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-22">22</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-24">24</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-26">26</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-28">28</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-30">30</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-32">32</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-34">34</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-36">36</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-38">38</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-40">40</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-42">42</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-44">44</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-46">46</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-48">48</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-50">50</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-52">52</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-54">54</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-56">56</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261596599768346-58">58</div><div class="crayon-num" data-line="crayon-5c0cab0261596599768346-59">59</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cab0261596599768346-1"><span class="crayon-p"># Multilayer Perceptron to Predict International Airline Passengers (t+1, given t, t-1, t-2)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-3"><span class="crayon-e">import </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-4"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-5"><span class="crayon-e">import </span><span class="crayon-e">math</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-v">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-8"> </div><div class="crayon-line" id="crayon-5c0cab0261596599768346-9"><span class="crayon-p"># convert an array of values into a dataset matrix</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-10"><span class="crayon-e">def </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-11"><span class="crayon-h"> </span><span class="crayon-v">dataX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-12"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-v">look_back</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-13"><span class="crayon-h"> </span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-14"><span class="crayon-h"> </span><span class="crayon-v">dataX</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-15"><span class="crayon-h"> </span><span class="crayon-v">dataY</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-16"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">dataX</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">dataY</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-17"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-18"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-19"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-20"><span class="crayon-p"># load the dataset</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-21"><span class="crayon-v">dataframe</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'international-airline-passengers.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">usecols</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">engine</span><span class="crayon-o">=</span><span class="crayon-s">'python'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">skipfooter</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-22"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataframe</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-23"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-24"><span class="crayon-p"># split into train and test sets</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-25"><span class="crayon-v">train_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.67</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-26"><span class="crayon-v">test_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">train_size</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-27"><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">train_size</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-v">train_size</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-28"><span class="crayon-p"># reshape dataset</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-29"><span class="crayon-v">look_back</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-30"><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-31"><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">create_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">look_back</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-32"><span class="crayon-p"># create and fit Multilayer Perceptron model</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-33"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-34"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-35"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-36"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-37"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'mean_squared_error'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-38"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">400</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-39"><span class="crayon-p"># Estimate model performance</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-40"><span class="crayon-v">trainScore</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-41"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Train Score: %.2f MSE (%.2f RMSE)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">trainScore</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">trainScore</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-42"><span class="crayon-v">testScore</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-43"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test Score: %.2f MSE (%.2f RMSE)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">testScore</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">math</span><span class="crayon-sy">.</span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">testScore</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-44"><span class="crayon-p"># generate predictions for training</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-45"><span class="crayon-v">trainPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-46"><span class="crayon-v">testPredict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-47"><span class="crayon-p"># shift train predictions for plotting</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-48"><span class="crayon-v">trainPredictPlot</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">empty_like</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-49"><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">nan</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-50"><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-v">look_back</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-v">look_back</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">trainPredict</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-51"><span class="crayon-p"># shift test predictions for plotting</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-52"><span class="crayon-v">testPredictPlot</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">empty_like</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-53"><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">nan</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-54"><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredict</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-sy">(</span><span class="crayon-e ">look_back*</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testPredict</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-55"><span class="crayon-p"># plot baseline and predictions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-56"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-57"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">trainPredictPlot</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261596599768346-58"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">testPredictPlot</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab0261596599768346-59"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0035 seconds] -->
<p>Running the example provides the following output.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cab0261598276503239" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Epoch 395/400
0s - loss: 485.3482
Epoch 396/400
0s - loss: 479.9485
Epoch 397/400
0s - loss: 497.2707
Epoch 398/400
0s - loss: 489.5670
Epoch 399/400
0s - loss: 490.8099
Epoch 400/400
0s - loss: 493.6544
Train Score: 564.03 MSE (23.75 RMSE)
Test Score: 2244.82 MSE (47.38 RMSE)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cab0261598276503239-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261598276503239-2">2</div><div class="crayon-num" data-line="crayon-5c0cab0261598276503239-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261598276503239-4">4</div><div class="crayon-num" data-line="crayon-5c0cab0261598276503239-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261598276503239-6">6</div><div class="crayon-num" data-line="crayon-5c0cab0261598276503239-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261598276503239-8">8</div><div class="crayon-num" data-line="crayon-5c0cab0261598276503239-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261598276503239-10">10</div><div class="crayon-num" data-line="crayon-5c0cab0261598276503239-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261598276503239-12">12</div><div class="crayon-num" data-line="crayon-5c0cab0261598276503239-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0261598276503239-14">14</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cab0261598276503239-1">Epoch 395/400</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261598276503239-2">0s - loss: 485.3482</div><div class="crayon-line" id="crayon-5c0cab0261598276503239-3">Epoch 396/400</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261598276503239-4">0s - loss: 479.9485</div><div class="crayon-line" id="crayon-5c0cab0261598276503239-5">Epoch 397/400</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261598276503239-6">0s - loss: 497.2707</div><div class="crayon-line" id="crayon-5c0cab0261598276503239-7">Epoch 398/400</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261598276503239-8">0s - loss: 489.5670</div><div class="crayon-line" id="crayon-5c0cab0261598276503239-9">Epoch 399/400</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261598276503239-10">0s - loss: 490.8099</div><div class="crayon-line" id="crayon-5c0cab0261598276503239-11">Epoch 400/400</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261598276503239-12">0s - loss: 493.6544</div><div class="crayon-line" id="crayon-5c0cab0261598276503239-13">Train Score: 564.03 MSE (23.75 RMSE)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0261598276503239-14">Test Score: 2244.82 MSE (47.38 RMSE)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can see that the error was not significantly reduced compared to that of the previous section.</p>
<p>Looking at the graph, we can see more structure in the predictions.</p>
<p>Again, the window size and the network architecture were not tuned, this is just a demonstration of how to frame a prediction problem.</p>
<p>Taking the square root of the performance scores we can see the average error on the training dataset was 23 passengers (in thousands per month) and the average error on the unseen test set was 47 passengers (in thousands per month).</p>
<div class="wp-caption aligncenter" id="attachment_3302" style="width: 810px"><img alt="Window Method For Time Series Predictions With Neural Networks" class="size-full wp-image-3302" height="600" sizes="(max-width: 800px) 100vw, 800px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Window-Method-for-Time-Series-Prediction-With-Neural-Networks.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Window-Method-for-Time-Series-Prediction-With-Neural-Networks.png 800w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Window-Method-for-Time-Series-Prediction-With-Neural-Networks-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Window-Method-for-Time-Series-Prediction-With-Neural-Networks-768x576.png 768w" width="800"/><p class="wp-caption-text">Window Method For Time Series Predictions With Neural Networks<br/>Blue=Whole Dataset, Green=Training, Red=Predictions</p></div>
<h2>Summary</h2>
<p>In this post, you discovered how to develop a neural network model for a time series prediction problem using the Keras deep learning library.</p>
<p>After working through this tutorial you now know:</p>
<ul>
<li>About the international airline passenger prediction time series dataset.</li>
<li>How to frame time series prediction problems as a regression problems and develop a neural network model.</li>
<li>How use the window approach to frame a time series prediction problem and develop a neural network model.</li>
</ul>
<p>Do you have any questions about time series prediction with neural networks or about this post?<br/>
Ask your question in the comments below and I will do my best to answer.</p>
<div class="awac-wrapper"><div class="awac widget text-52"> <div class="textwidget"><p></p><center><br/>
<div class="woo-sc-hr"></div>
<h2>Develop Deep Learning models for Time Series Today!</h2>
<p><a href="/deep-learning-for-time-series-forecasting/"><img align="left" alt="Deep Learning for Time Series Forecasting" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/Cover-220.png" style="border: 0;"/></a></p>
<h4>Develop Your Own Forecasting models in Minutes</h4>
<p>…with just a few lines of python code</p>
<p>Discover how in my new Ebook:<br/>
<a href="/deep-learning-for-time-series-forecasting/">Deep Learning for Time Series Forecasting</a></p>
<p>It provides <strong>self-study tutorials</strong> on topics like: <em>CNNs</em>, <em>LSTMs</em>,<br/>
<em>Multivariate Forecasting</em>, <em>Multi-Step Forecasting</em> and much more…</p>
<h4>Finally Bring Deep Learning to your Time Series Forecasting Projects</h4>
<p>Skip the Academics. Just Results.</p>
<p><a href="/deep-learning-for-time-series-forecasting/">Click to learn more</a>.<br/>
</p><div class="woo-sc-hr"></div><br/>
</center>
</div>
</div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-2924 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=Time+Series+Prediction+With+Deep+Learning+in+Keras&amp;url=https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
</section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/estimate-performance-machine-learning-algorithms-weka/" rel="prev"><i class="fa fa-angle-left"></i> How To Estimate The Performance of Machine Learning Algorithms in Weka</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/estimate-baseline-performance-machine-learning-models-weka/" rel="next">How To Estimate A Baseline Performance For Your Machine Learning Models in Weka <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">170 Responses to <em>Time Series Prediction With Deep Learning in Keras</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-359782">
<div class="comment-container" id="li-comment-359782">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2794853cf3fdb27a9ad776389861d82a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2794853cf3fdb27a9ad776389861d82a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Steve Buckley</span>
<span class="date">August 13, 2016 at 2:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-359782" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>This is a new tool for me so an interesting post to get started!</p>
<p>It looks to me like your plot for the first method is wrong. As you’re only giving the previous time point to predict the next, the model is going to fit (close to) a straight line and won’t pull out the periodicity your plot suggests. The almost perfect fit of the red line to the blue line also doesn’t reflect the much worse fit suggested in the model score!</p>
<p>Hope that’s helpful.</p>
<div class="reply">
<a aria-label="Reply to Steve Buckley" class="comment-reply-link" href="#comment-359782" onclick='return addComment.moveForm( "comment-359782", "359782", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-360237">
<div class="comment-container" id="li-comment-360237">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1f18dc91e24d187ff2342ef564d887c7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1f18dc91e24d187ff2342ef564d887c7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Curious George</span>
<span class="date">August 17, 2016 at 2:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-360237" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>How can you use this technique to forecast into the future?</p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Curious George" class="comment-reply-link" href="#comment-360237" onclick='return addComment.moveForm( "comment-360237", "360237", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-360272">
<div class="comment-container" id="li-comment-360272">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 17, 2016 at 9:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-360272" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This example is forecasting t+1 in the future.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-360272" onclick='return addComment.moveForm( "comment-360272", "360272", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-361479">
<div class="comment-container" id="li-comment-361479">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1f18dc91e24d187ff2342ef564d887c7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1f18dc91e24d187ff2342ef564d887c7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Curious George</span>
<span class="date">August 25, 2016 at 1:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-361479" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In order to forecast t+2, t+3, t+n…., is it recommended to use the previous prediction (t+1) as the assumed data point. </p>
<p>For example, if I wanted to forecast t+2, I would use the available data including my prediction at t+1. </p>
<p>I understand that the error would increase the further out the forecast due to relying on predictions as data points.</p>
<p>Thoughts?</p>
<div class="reply">
<a aria-label="Reply to Curious George" class="comment-reply-link" href="#comment-361479" onclick='return addComment.moveForm( "comment-361479", "361479", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-361500">
<div class="comment-container" id="li-comment-361500">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 25, 2016 at 5:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-361500" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, using this approach will provide multiple future data points. As you suggest, the further in the future you go, the more likely errors are to compound.</p>
<p>Give it a go, it’s good to experiment with these models and see what they are capable of.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-361500" onclick='return addComment.moveForm( "comment-361500", "361500", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="comment-361480">
<div class="comment-container" id="li-comment-361480">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1f18dc91e24d187ff2342ef564d887c7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1f18dc91e24d187ff2342ef564d887c7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Curious George</span>
<span class="date">August 25, 2016 at 1:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-361480" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Also, when running the full code snippet using the window method, the graph produced does not match the one shown. </p>
<p>This is what I’m getting</p>
<p><a href="http://imgur.com/a/NaoYE" rel="nofollow">http://imgur.com/a/NaoYE</a></p>
<div class="reply">
<a aria-label="Reply to Curious George" class="comment-reply-link" href="#comment-361480" onclick='return addComment.moveForm( "comment-361480", "361480", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-361501">
<div class="comment-container" id="li-comment-361501">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 25, 2016 at 5:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-361501" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I did update the plotting code with a minor change and did not update the images accordingly. I will update them ASAP.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-361501" onclick='return addComment.moveForm( "comment-361501", "361501", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="comment-390684">
<div class="comment-container" id="li-comment-390684">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/48796fcbbbeb695ef822ea241b9c713c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/48796fcbbbeb695ef822ea241b9c713c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Andy</span>
<span class="date">March 1, 2017 at 6:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-390684" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Could you show an example where maybe there was a couple more features. So, say you wanted to predict how many passengers, and you knew about temperature and day of the week (Mon-Sun).</p>
<div class="reply">
<a aria-label="Reply to Andy" class="comment-reply-link" href="#comment-390684" onclick='return addComment.moveForm( "comment-390684", "390684", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-390718">
<div class="comment-container" id="li-comment-390718">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 1, 2017 at 8:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-390718" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Andy,</p>
<p>Yes, I am working on more sophisticated time series tutorials at the moment, they should be on the blog soon.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-390718" onclick='return addComment.moveForm( "comment-390718", "390718", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-401995">
<div class="comment-container" id="li-comment-401995">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ffa50b2ca24453993f3a1aaefc6db603?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ffa50b2ca24453993f3a1aaefc6db603?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Soren Pallesen</span>
<span class="date">June 9, 2017 at 6:18 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-401995" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Look forward to these time series forecast with multiple features examples – when do you expect to post them to your blog?</p>
<p>As always thx for this valuable resource and for sharing your experience !</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-402072">
<div class="comment-container" id="li-comment-402072">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 10, 2017 at 8:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-402072" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps a month. No promises. I am taking my time to ensure they are good.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="comment-419561">
<div class="comment-container" id="li-comment-419561">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0dc506904c98025d8792adf9d94bf2b3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0dc506904c98025d8792adf9d94bf2b3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ramzan Shahid</span>
<span class="date">November 10, 2017 at 4:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-419561" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sir please, share some tutorial on tensorflow and what are the differences to make models in tensorflow and keras. thanks</p>
<div class="reply">
<a aria-label="Reply to Ramzan Shahid" class="comment-reply-link" href="#comment-419561" onclick='return addComment.moveForm( "comment-419561", "419561", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-419591">
<div class="comment-container" id="li-comment-419591">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 10, 2017 at 10:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-419591" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Tensorflow is like coding in assembly, Keras is like coding in Python. </p>
<p>Keras is so much simpler and makes you more productive, but gives up some speed and flexibility, a worthy trade-off for most applications.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-419591" onclick='return addComment.moveForm( "comment-419591", "419591", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="comment-426692">
<div class="comment-container" id="li-comment-426692">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0dc506904c98025d8792adf9d94bf2b3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0dc506904c98025d8792adf9d94bf2b3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">shahid</span>
<span class="date">January 17, 2018 at 6:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-426692" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>sir can you have done any example for more than one column for time series prediction like stock data? If yes, please share the link of that. Thanks</p>
<div class="reply">
<a aria-label="Reply to shahid" class="comment-reply-link" href="#comment-426692" onclick='return addComment.moveForm( "comment-426692", "426692", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-426727">
<div class="comment-container" id="li-comment-426727">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 17, 2018 at 10:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-426727" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>See here:<br/>
<a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" rel="nofollow">https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426727" onclick='return addComment.moveForm( "comment-426727", "426727", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-448204">
<div class="comment-container" id="li-comment-448204">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/30a6dc3074b2be27a998db9eeddbd7ec?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/30a6dc3074b2be27a998db9eeddbd7ec?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">poiuwn</span>
<span class="date">September 8, 2018 at 4:53 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-448204" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Super! Will take some time on it soon. Thanks so much, Jason!</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-362611">
<div class="comment-container" id="li-comment-362611">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/90fe344194ca036393e4c028d9f73847?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/90fe344194ca036393e4c028d9f73847?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Keshav Mathur</span>
<span class="date">August 30, 2016 at 7:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-362611" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello,</p>
<p>Thank you for a great article. I have a big doubt and also related to the plot posted in the earlier comment which shows a sort of lag in the prediction. Here we are training the model on t to get predictions for t+1.</p>
<p>Given this I would assume that when the model sees an input of 112 it should predict around 118 (first data point in the training set). But that’s not what the predictions show. Copying the top 5 train points and their subsequent predictions generated by the code given in this post for the first example:</p>
<p>trainX[:5]     trainPredict[:5]<br/>
[ 112.],          [112.56],<br/>
[ 118.],          [118.47],<br/>
[ 132.],          [132.26],<br/>
[ 129.],          [129.55],<br/>
[ 121.]           [121.57],</p>
<p>I am trying to understand from a model perspective as to why is it predicting with a lag?</p>
<div class="reply">
<a aria-label="Reply to Keshav Mathur" class="comment-reply-link" href="#comment-362611" onclick='return addComment.moveForm( "comment-362611", "362611", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-366664">
<div class="comment-container" id="li-comment-366664">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 9, 2016 at 10:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-366664" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Keshav, I have updated the description and the graphs.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-366664" onclick='return addComment.moveForm( "comment-366664", "366664", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-363604">
<div class="comment-container" id="li-comment-363604">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9f414c06291b00a7b09858c1299af8b2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9f414c06291b00a7b09858c1299af8b2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://tradingwithpython.blogspot.com" rel="external nofollow">Jev</a></span>
<span class="date">September 5, 2016 at 7:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-363604" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Just as Steve Buckley pointed out, your first method seems to be wrong. The model indeed just fits a straight line ( yPred = a*X+b) , which can be verified by calculating predictions on  an input such as arange(200).<br/>
Because you shift the results afterwards before plotting, the outcome seems very good. However, from a conceptual point of view, it should be impossible to predict X_t+1 correctly based on only X_t, as the latter contains no trend or seasonal information. </p>
<p>Here is what I’ve got after trying to reproduce your results:</p>
<p>	X	        Y	        yPred<br/>
0	112.0	118.0	112.897537<br/>
1	118.0	132.0	118.847107<br/>
2	132.0	129.0	132.729446<br/>
3	129.0	121.0	129.754669<br/>
….</p>
<p>as you can see, the yPred is way off ( it should be equal to Y), but looks good when shifted one period.</p>
<div class="reply">
<a aria-label="Reply to Jev" class="comment-reply-link" href="#comment-363604" onclick='return addComment.moveForm( "comment-363604", "363604", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-366665">
<div class="comment-container" id="li-comment-366665">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 9, 2016 at 10:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-366665" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yep, right on Jev, thanks. I have updated the description and the graphs.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-366665" onclick='return addComment.moveForm( "comment-366665", "366665", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-364399">
<div class="comment-container" id="li-comment-364399">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/caf83ee03275d00855f613dc310962f8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/caf83ee03275d00855f613dc310962f8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Max Clayer</span>
<span class="date">September 14, 2016 at 4:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-364399" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason</p>
<p>I also have to agree with Jev, I would expect using predict(trainX) would give values closer to trainY values not trainX values.</p>
<div class="reply">
<a aria-label="Reply to Max Clayer" class="comment-reply-link" href="#comment-364399" onclick='return addComment.moveForm( "comment-364399", "364399", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-366666">
<div class="comment-container" id="li-comment-366666">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 9, 2016 at 10:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-366666" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>They do Max, you’re right. I have updated the graphs to better reflect the actual predictions made.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-366666" onclick='return addComment.moveForm( "comment-366666", "366666", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-365419">
<div class="comment-container" id="li-comment-365419">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/77a2b2a58d40fd0a919ebd1f97af4386?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/77a2b2a58d40fd0a919ebd1f97af4386?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://in.linkedin.com/in/hmishra2250" rel="external nofollow">Himadri</a></span>
<span class="date">September 24, 2016 at 11:56 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-365419" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thanks for such a wonderful tutorial!<br/>
I was just wondering if in function create_dataset, there should be range(len(dataset)-1) in the loop. Hence for plotting logic, it should be:</p>
<p>…<br/>
trainPredictPlot[lb:len(train),:] = trainPredict<br/>
…<br/>
testPredictPlot[len(train)+lb:len(dataset),:] = testPredict</p>
<p>I am just in a big confusion with the index and getting somewhat difference plot for look_back=3 : <a href="http://imgur.com/a/DMbOU" rel="nofollow">http://imgur.com/a/DMbOU</a></p>
<div class="reply">
<a aria-label="Reply to Himadri" class="comment-reply-link" href="#comment-365419" onclick='return addComment.moveForm( "comment-365419", "365419", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-365564">
<div class="comment-container" id="li-comment-365564">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d55a762483423fd44120e091bf1d266a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d55a762483423fd44120e091bf1d266a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Veltzer Doron</span>
<span class="date">September 26, 2016 at 6:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-365564" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey, thanks for a most helpful tutorial, any ideas why this seems to work better than the time series predictions using RNNs and LSTM in the sister tutorial? My intuition predicts the opposite.</p>
<div class="reply">
<a aria-label="Reply to Veltzer Doron" class="comment-reply-link" href="#comment-365564" onclick='return addComment.moveForm( "comment-365564", "365564", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-365644">
<div class="comment-container" id="li-comment-365644">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 27, 2016 at 7:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-365644" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad you like it Veltzer. </p>
<p>Great question, the LSTMs probably require more fine tuning I expect.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-365644" onclick='return addComment.moveForm( "comment-365644", "365644", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-365816">
<div class="comment-container" id="li-comment-365816">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c4df017288d10f80194eef397542ee7b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c4df017288d10f80194eef397542ee7b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Newbtothis</span>
<span class="date">September 29, 2016 at 12:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-365816" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey there! Great blog and articles – the examples really help a lot! I’m new to this so excuse the stupid question if applicable – I want to predict the next three outputs based on the same input. Is that doable in the LSTM framework? This is for predicting the water temperature for the next 3 days.</p>
<div class="reply">
<a aria-label="Reply to Newbtothis" class="comment-reply-link" href="#comment-365816" onclick='return addComment.moveForm( "comment-365816", "365816", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-365861">
<div class="comment-container" id="li-comment-365861">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 30, 2016 at 7:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-365861" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, this is called sequence to sequence prediction.</p>
<p>I see two main options:</p>
<p>– Run the LSTM 3 times and feed output as input.<br/>
– Change the LSTM to output 3 numbers.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-365861" onclick='return addComment.moveForm( "comment-365861", "365861", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-365884">
<div class="comment-container" id="li-comment-365884">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e59367edb07db16cf72b929f4d671064?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e59367edb07db16cf72b929f4d671064?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Han</span>
<span class="date">September 30, 2016 at 11:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-365884" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This particular time-series has strong seasonality and looks exponential in trend. In reality, the growth rate of this time series is more important. Could you plot the year-on-year growth rate?</p>
<div class="reply">
<a aria-label="Reply to Han" class="comment-reply-link" href="#comment-365884" onclick='return addComment.moveForm( "comment-365884", "365884", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-365951">
<div class="comment-container" id="li-comment-365951">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 1, 2016 at 8:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-365951" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>There would be benefit in modeling a stationary version of the data, I agree.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-365951" onclick='return addComment.moveForm( "comment-365951", "365951", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-365935">
<div class="comment-container" id="li-comment-365935">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e59367edb07db16cf72b929f4d671064?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e59367edb07db16cf72b929f4d671064?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Han</span>
<span class="date">October 1, 2016 at 2:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-365935" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I agree with Steve Buckley. The code is predicting x[i+1] = x[i] (approximately), that why the last part of code, which is supposed to fix the shift, couldn’t get the shift part right. </p>
<p>Try the following: pick any point in your testX, say testX[i], use the model to predict testY[i], then instead of using testX[i+1], use testY[i] as the input parameter for model.predict(), and so on. You will end up with a nearly straight line.</p>
<p>I’d thank you for your wonderful posts on neural network, which helped me a lot when learning neural network. However, this particular code is not correct.</p>
<div class="reply">
<a aria-label="Reply to Han" class="comment-reply-link" href="#comment-365935" onclick='return addComment.moveForm( "comment-365935", "365935", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-366316">
<div class="comment-container" id="li-comment-366316">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d7461246ebe0c959f3ee490af685d3c4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d7461246ebe0c959f3ee490af685d3c4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jeremy</span>
<span class="date">October 5, 2016 at 1:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-366316" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for great article! It is really helpful for me. I have one question. If I have two more variable, how can i do? Take example, my data looks like follow,<br/>
date   windspeed  rain price<br/>
20160101  10         100  1000<br/>
20160102   10          80   1010<br/>
…<br/>
I’d like to predict the price.</p>
<div class="reply">
<a aria-label="Reply to Jeremy" class="comment-reply-link" href="#comment-366316" onclick='return addComment.moveForm( "comment-366316", "366316", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-366389">
<div class="comment-container" id="li-comment-366389">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 6, 2016 at 9:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-366389" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jeremy, each input would be a feature. You could then use the window method to frame multiple time steps of multiple features as new features.</p>
<p>For example:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cab026517c292980105" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
x1(t), x2(t), x1(t-1), x2(t-1) to predict y(t+1)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cab026517c292980105-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cab026517c292980105-1"><span class="crayon-e">x1</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">x2</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">x1</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">x2</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-i">predict</span><span class="crayon-h"> </span><span class="crayon-e">y</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-366389" onclick='return addComment.moveForm( "comment-366389", "366389", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-371560">
<div class="comment-container" id="li-comment-371560">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/810aefa4aa25539acdb67e064590f542?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/810aefa4aa25539acdb67e064590f542?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shimin</span>
<span class="date">November 22, 2016 at 10:53 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-371560" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for your great explanation!</p>
<p>I have one question like Jeremy’s. Is there any suggestion for me if I want to predict 2 variables? Data frame shown as below:</p>
<p>Date          X1               X2             X3         X4            Y1             Y2</p>
<p>I want to predict Y1 and Y2. Also, Y1 and Y2 have some correlations.</p>
<div class="reply">
<a aria-label="Reply to Shimin" class="comment-reply-link" href="#comment-371560" onclick='return addComment.moveForm( "comment-371560", "371560", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-371691">
<div class="comment-container" id="li-comment-371691">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 23, 2016 at 8:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-371691" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi Shimin,</p>
<p>Yes, this is often called a sequence prediction problem in deep learning or a multi-step prediction problem in time series prediction.</p>
<p>You can use an LSTM with two outputs or you can use an MLP with two outputs to model this problem. Be sure to prepare your data into this form.</p>
<p>I hope that helps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-371691" onclick='return addComment.moveForm( "comment-371691", "371691", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-367371">
<div class="comment-container" id="li-comment-367371">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/925bc8b2881db8c342cfea7c0f959fc9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/925bc8b2881db8c342cfea7c0f959fc9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sunny</span>
<span class="date">October 18, 2016 at 9:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-367371" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason,<br/>
Great writeup on using Keras for TS data. My dataset is something like below:# print the </p>
<p> Date           Time        Power1      Power2   Power3    Meter1     Meter2<br/>
12/02/2012  02:53:00 2.423         0.118       0.0303    0.020       1.1000</p>
<p>My feature vectors/predictors are Date, Time, Power1, Power2, Power3, Meter1. i am trying to predict Meter 2. </p>
<p>I would like to instead of using MLP use RNN/LSTM for the above time series prediction.<br/>
Can you pl. suggest is this is possible? and if yes, any pointers would help<br/>
thanks<br/>
Sunny</p>
<div class="reply">
<a aria-label="Reply to Sunny" class="comment-reply-link" href="#comment-367371" onclick='return addComment.moveForm( "comment-367371", "367371", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-367463">
<div class="comment-container" id="li-comment-367463">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 19, 2016 at 9:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-367463" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Sunny, this tutorial will help to get you started:<br/>
<a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" rel="nofollow">http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-367463" onclick='return addComment.moveForm( "comment-367463", "367463", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-368825">
<div class="comment-container" id="li-comment-368825">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3d203b7c730fc1d54078c17b65f2492b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3d203b7c730fc1d54078c17b65f2492b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">nicoad</span>
<span class="date">October 31, 2016 at 7:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-368825" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello , nice tutorial .</p>
<p>I have one question : it would be usefull to have similar stuff on live data. let s say I have access to some real time data (software downloads, stock price …) , would it requires to train the model each time new data is available ?</p>
<div class="reply">
<a aria-label="Reply to nicoad" class="comment-reply-link" href="#comment-368825" onclick='return addComment.moveForm( "comment-368825", "368825", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-368905">
<div class="comment-container" id="li-comment-368905">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 1, 2016 at 7:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-368905" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I agree nicoad, a real-time example would be great. I’ll look into it.</p>
<p>A great thing about neural networks is that they can be updated with new data and do not have to be re-trained from scratch.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-368905" onclick='return addComment.moveForm( "comment-368905", "368905", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-369833">
<div class="comment-container" id="li-comment-369833">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/63943354e49cfb6883a28181808e27ae?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/63943354e49cfb6883a28181808e27ae?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sherlockatszx</span>
<span class="date">November 8, 2016 at 3:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-369833" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,your original post code is to use 1(or 3) dimension X to predict the later 1 dimension Y.how about I want to use 48 dimension X to predict 49th and 50th.what i mean is i increase the time unit i want to predict ,predict 3 or even 10 time unit . under such condition : does that mean i just change the output_dime of the last output layer :</p>
<p>model.add(Dense(<br/>
output_dim=3))</p>
<p>Is that right?</p>
<div class="reply">
<a aria-label="Reply to sherlockatszx" class="comment-reply-link" href="#comment-369833" onclick='return addComment.moveForm( "comment-369833", "369833", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-369872">
<div class="comment-container" id="li-comment-369872">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 8, 2016 at 9:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-369872" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, that looks right. Let me know how you go.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-369872" onclick='return addComment.moveForm( "comment-369872", "369872", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-369919">
<div class="comment-container" id="li-comment-369919">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/63943354e49cfb6883a28181808e27ae?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/63943354e49cfb6883a28181808e27ae?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sherlockatszx</span>
<span class="date">November 8, 2016 at 6:56 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-369919" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi jason, I make a quick expriment in jupyter notebook and published in the github<br/>
github:<a href="https://github.com/sherlockhoatszx/TimeSeriesPredctionUsingDeeplearning" rel="nofollow">https://github.com/sherlockhoatszx/TimeSeriesPredctionUsingDeeplearning</a><br/>
the code could work.<br/>
However If you  look very carefully of the trainPredict data(IN[18] of the notebook).</p>
<p>the first 3 array is:<br/>
array([[ 128.60112   ,  127.5030365 ],<br/>
       [ 121.16256714,  122.3662262 ],<br/>
       [ 144.46884155,  145.67802429]</p>
<p>the list inside [ 128.6,127.5 ] [121,2,122,3] does not like t+1 and t+2.<br/>
**Instead,** It looks like 2 probaly prediction for 1 unit.<br/>
What i means is  [128.6,127.5] doesn’t mean t+1 and t+2 prediction, it most possibly mean 2 possible prediction for t+1.<br/>
one output cell with 2dimension and 2 output cell with 1 dimension is different.<br/>
I discussed it with other guy in github .<br/>
<a href="https://github.com/Vict0rSch/deep_learning/issues/11" rel="nofollow">https://github.com/Vict0rSch/deep_learning/issues/11</a><br/>
It seems i should use seq2seq or use timedistributed wrapper .</p>
<p>I stilll explored this and have not got one solution .</p>
<p>What is your suggestion?</p>
<div class="reply">
<a aria-label="Reply to sherlockatszx" class="comment-reply-link" href="#comment-369919" onclick='return addComment.moveForm( "comment-369919", "369919", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-370069">
<div class="comment-container" id="li-comment-370069">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 9, 2016 at 9:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-370069" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That does sound like good advice. Treat the problem as sequence to sequence problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-370069" onclick='return addComment.moveForm( "comment-370069", "370069", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-369923">
<div class="comment-container" id="li-comment-369923">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/63943354e49cfb6883a28181808e27ae?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/63943354e49cfb6883a28181808e27ae?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sherlockatszx</span>
<span class="date">November 8, 2016 at 8:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-369923" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi jason , I made a experiment on the jupyter notebook and published on the github .The code could output 2 columns data.<br/>
<a href="https://github.com/sherlockhoatszx/TimeSeriesPredctionUsingDeeplearning/blob/master/README.md" rel="nofollow">https://github.com/sherlockhoatszx/TimeSeriesPredctionUsingDeeplearning/blob/master/README.md</a></p>
<p>However! If you  look very carefully of the trainPredict data(IN[18] of the notebook).</p>
<p>the first 3 array is:<br/>
array([[ 128.60112   ,  127.5030365 ],<br/>
       [ 121.16256714,  122.3662262 ],<br/>
       [ 144.46884155,  145.67802429]</p>
<p>the list inside [ 128.6,127.5 ] [121,2,122,3] does not like t+1 and t+2.<br/>
**Instead,** It looks like 2 probaly prediction for 1 unit.<br/>
What i means is  [128.6,127.5] doesn’t mean t+1 and t+2 prediction, it most possibly mean 2 possible prediction for t+1.<br/>
1 output cell with 2 dimension and 2 output cell with 1 dimension is different.<br/>
The input dimension and the output dimension will be tricky for the NN.</p>
<div class="reply">
<a aria-label="Reply to sherlockatszx" class="comment-reply-link" href="#comment-369923" onclick='return addComment.moveForm( "comment-369923", "369923", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-370682">
<div class="comment-container" id="li-comment-370682">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6b215cfd834030fdca17528c4e20f1b1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6b215cfd834030fdca17528c4e20f1b1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Xiao</span>
<span class="date">November 16, 2016 at 1:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-370682" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason for the conceptual explaining.  I have one question about the KERAS package:  </p>
<p>It looks you input the raw data (x=118 etc) to KERAS.  Do you know whether KERAS needs to standardize (normalize) the data to (0,1) or (-1,1) or some distribution with mean of 0?</p>
<p>— Xiao</p>
<div class="reply">
<a aria-label="Reply to Xiao" class="comment-reply-link" href="#comment-370682" onclick='return addComment.moveForm( "comment-370682", "370682", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-370790">
<div class="comment-container" id="li-comment-370790">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 16, 2016 at 9:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-370790" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question Xiao,</p>
<p>It is a good idea to standardize data or normalize data when working with neural networks. Try it on your problem and see if it affects the performance of your model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-370790" onclick='return addComment.moveForm( "comment-370790", "370790", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-371215">
<div class="comment-container" id="li-comment-371215">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d2e44d0e2e9ed4fdd7890264e780b127?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d2e44d0e2e9ed4fdd7890264e780b127?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Satoshi Report</span>
<span class="date">November 19, 2016 at 2:24 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-371215" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Wasn’t the data normalized in an early version of this post?</p>
<div class="reply">
<a aria-label="Reply to Satoshi Report" class="comment-reply-link" href="#comment-371215" onclick='return addComment.moveForm( "comment-371215", "371215", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-371483">
<div class="comment-container" id="li-comment-371483">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 22, 2016 at 6:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-371483" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t believe so Satoshi.</p>
<p>Normalization is a great idea in general when working with neural nets, though.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-371483" onclick='return addComment.moveForm( "comment-371483", "371483", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-374948">
<div class="comment-container" id="li-comment-374948">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6db0adde32dff1a15c7c047e8046e69a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6db0adde32dff1a15c7c047e8046e69a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">charith</span>
<span class="date">December 12, 2016 at 8:11 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-374948" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I keep getting this error dt = datetime.datetime.fromordinal(ix).replace(tzinfo=UTC)</p>
<p>ValueError: ordinal must be &gt;= 1</p>
<div class="reply">
<a aria-label="Reply to charith" class="comment-reply-link" href="#comment-374948" onclick='return addComment.moveForm( "comment-374948", "374948", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-375011">
<div class="comment-container" id="li-comment-375011">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 13, 2016 at 8:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-375011" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry charith, I have not seen this error before.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-375011" onclick='return addComment.moveForm( "comment-375011", "375011", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-380731">
<div class="comment-container" id="li-comment-380731">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c26b2a27088ceb2f60088c6197100b2e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c26b2a27088ceb2f60088c6197100b2e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Trex</span>
<span class="date">January 7, 2017 at 8:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-380731" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In Your text you say, the window size is 3, But in Your Code you use loop_back = 10 ?</p>
<div class="reply">
<a aria-label="Reply to Trex" class="comment-reply-link" href="#comment-380731" onclick='return addComment.moveForm( "comment-380731", "380731", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-380748">
<div class="comment-container" id="li-comment-380748">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 7, 2017 at 8:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-380748" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Trex. </p>
<p>That is a typo from some experimenting I was doing at one point. Fixed.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-380748" onclick='return addComment.moveForm( "comment-380748", "380748", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-380769">
<div class="comment-container" id="li-comment-380769">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c26b2a27088ceb2f60088c6197100b2e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c26b2a27088ceb2f60088c6197100b2e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Trex</span>
<span class="date">January 7, 2017 at 11:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-380769" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No problem,</p>
<p>I have another question: </p>
<p>what the algorithm now does is predict 1 value. I want to predict with this MLP like  n-values.</p>
<p>How should this work?</p>
<div class="reply">
<a aria-label="Reply to Trex" class="comment-reply-link" href="#comment-380769" onclick='return addComment.moveForm( "comment-380769", "380769", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-380945">
<div class="comment-container" id="li-comment-380945">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 8, 2017 at 5:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-380945" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Reframe your training dataset to match what you require and change the number of neurons in the output layer to the number of outputs you desire.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-380945" onclick='return addComment.moveForm( "comment-380945", "380945", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-380777">
<div class="comment-container" id="li-comment-380777">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3544af4963055a5e292137f45b5c9b01?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3544af4963055a5e292137f45b5c9b01?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mansolo</span>
<span class="date">January 7, 2017 at 12:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-380777" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Sir,</p>
<p>great Tutorial.</p>
<p>I am trying to build a NN for Time-Series-Prediction. But my Datas are different than yours.</p>
<p>I want to predict a whole next day. But a whole day is defined as 48 values.</p>
<p>Some lines of the Blank datas:<br/>
2016-11-10 05:00:00.000 0<br/>
2016-11-10 05:30:00.000 0<br/>
2016-11-10 06:00:00.000 1<br/>
2016-11-10 06:30:00.000 3<br/>
2016-11-10 07:00:00.000 12<br/>
2016-11-10 07:30:00.000 36<br/>
2016-11-10 08:00:00.000 89<br/>
2016-11-10 08:30:00.000 120<br/>
2016-11-10 09:00:00.000 209<br/>
2016-11-10 09:30:00.000 233<br/>
2016-11-10 10:00:00.000 217<br/>
2016-11-10 10:30:00.000 199<br/>
2016-11-10 11:00:00.000 244</p>
<p>There is a value for each half an hour of a whole day. </p>
<p>i want to predict the values for every half an hour for the next few days. How could this work?</p>
<div class="reply">
<a aria-label="Reply to Mansolo" class="comment-reply-link" href="#comment-380777" onclick='return addComment.moveForm( "comment-380777", "380777", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-381016">
<div class="comment-container" id="li-comment-381016">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7be8f55e3233f6bf5acba20e62c1e200?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7be8f55e3233f6bf5acba20e62c1e200?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hem</span>
<span class="date">January 8, 2017 at 3:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-381016" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Could you do an example for a Multivariate Time Series? 🙂</p>
<div class="reply">
<a aria-label="Reply to Hem" class="comment-reply-link" href="#comment-381016" onclick='return addComment.moveForm( "comment-381016", "381016", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-381131">
<div class="comment-container" id="li-comment-381131">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 9, 2017 at 7:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-381131" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, there are some tutorials scheduled on the blog. I will link to them once they’re out.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-381131" onclick='return addComment.moveForm( "comment-381131", "381131", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-381520">
<div class="comment-container" id="li-comment-381520">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/29aee320cbf751859ece2ed14425b708?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/29aee320cbf751859ece2ed14425b708?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bonje</span>
<span class="date">January 12, 2017 at 12:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-381520" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Why doesnt need the reLu Activation function that the input datas are normalized between 0 and 1?</p>
<p>If i use the sigmoid activation function, there is a must, that the input datas are normalized.</p>
<p>But why reLu doesnt need that?</p>
<div class="reply">
<a aria-label="Reply to Bonje" class="comment-reply-link" href="#comment-381520" onclick='return addComment.moveForm( "comment-381520", "381520", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-381595">
<div class="comment-container" id="li-comment-381595">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 12, 2017 at 9:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-381595" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Generally, because of the bounds of the sigmoid function imposes hard limits values outside of 0-1. </p>
<p>The Rectifier function is quite different, you can read up on it here:<br/>
<a href="https://en.wikipedia.org/wiki/Rectifier_(neural_networks)" rel="nofollow">https://en.wikipedia.org/wiki/Rectifier_(neural_networks)</a></p>
<p>I’d recommend implementing in excel or Python and having a play with inputs and outputs.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-381595" onclick='return addComment.moveForm( "comment-381595", "381595", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-381524">
<div class="comment-container" id="li-comment-381524">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/29aee320cbf751859ece2ed14425b708?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/29aee320cbf751859ece2ed14425b708?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bonje</span>
<span class="date">January 12, 2017 at 1:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-381524" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Another Question:</p>
<p>Your Input Layer uses reLu as activition Function.<br/>
But why has your Output Layer no activition Function? Is there a default activition function which keras uses if you give one as parameter? if yes, which is it? if no, why is it possible to have a Layer without a activition function in it?</p>
<p>Thanks 🙂</p>
<div class="reply">
<a aria-label="Reply to Bonje" class="comment-reply-link" href="#comment-381524" onclick='return addComment.moveForm( "comment-381524", "381524", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-381598">
<div class="comment-container" id="li-comment-381598">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 12, 2017 at 9:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-381598" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes the default is Linear, this is a desirable activation function on regression problems.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-381598" onclick='return addComment.moveForm( "comment-381598", "381598", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-381525">
<div class="comment-container" id="li-comment-381525">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/29aee320cbf751859ece2ed14425b708?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/29aee320cbf751859ece2ed14425b708?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bonje</span>
<span class="date">January 12, 2017 at 1:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-381525" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>dont give one as parameter*</p>
<div class="reply">
<a aria-label="Reply to Bonje" class="comment-reply-link" href="#comment-381525" onclick='return addComment.moveForm( "comment-381525", "381525", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-385956">
<div class="comment-container" id="li-comment-385956">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fe5e3f98c7927b9d7ae399e433401dcf?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fe5e3f98c7927b9d7ae399e433401dcf?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Dmitry N. Medvedev</span>
<span class="date">February 4, 2017 at 1:11 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-385956" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>A stupid question, sir.</p>
<p>Suppose I have a dataset with two fields: “date” (timestamp), “amount” (float32) describing a year.</p>
<p>on the first day of each month the amount is set to -200.</p>
<p>This is true for 11 months, except for the 12th (December).</p>
<p>Is there a way to train a NN so that it returns 12, marking the December as not having such and amount on its first day?</p>
<div class="reply">
<a aria-label="Reply to Dmitry N. Medvedev" class="comment-reply-link" href="#comment-385956" onclick='return addComment.moveForm( "comment-385956", "385956", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-386046">
<div class="comment-container" id="li-comment-386046">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 5, 2017 at 5:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-386046" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry Dmitry, I’m not sure I really understand your question.</p>
<p>Perhaps you’re able to ask it a different way or provide a small example?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-386046" onclick='return addComment.moveForm( "comment-386046", "386046", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-386787">
<div class="comment-container" id="li-comment-386787">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/68d5e146de1a5587a775d6c8b28aee3c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/68d5e146de1a5587a775d6c8b28aee3c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Thomas Durant</span>
<span class="date">February 9, 2017 at 3:36 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-386787" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Is it common to only predict the single next time point? Or are there times/ways to predict 2,3, and 4 times points into the future, and if so, how do you assess performance metrics for those predictions?</p>
<div class="reply">
<a aria-label="Reply to Thomas Durant" class="comment-reply-link" href="#comment-386787" onclick='return addComment.moveForm( "comment-386787", "386787", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-386900">
<div class="comment-container" id="li-comment-386900">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 10, 2017 at 9:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-386900" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good question Thomas.</p>
<p>The forecast time horizon is problem specific. You can predict multiple steps with a MLP or LSTM using multiple neurons in the output layer.</p>
<p>Evaluation is problem specific but could be RMSE across the entire forecast or per forecast lead time.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-386900" onclick='return addComment.moveForm( "comment-386900", "386900", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-390610">
<div class="comment-container" id="li-comment-390610">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b7b7c519835b7cc4b89d155a617338a5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b7b7c519835b7cc4b89d155a617338a5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">zhou</span>
<span class="date">February 28, 2017 at 8:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-390610" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thanks for Jason’s post, I benefit a lot from it. now I have a problem:how can I get the passengers in 1961-01? anticipates your reply.</p>
<div class="reply">
<a aria-label="Reply to zhou" class="comment-reply-link" href="#comment-390610" onclick='return addComment.moveForm( "comment-390610", "390610", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-390710">
<div class="comment-container" id="li-comment-390710">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 1, 2017 at 8:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-390710" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can train your model on all available data, then call model.predict() to forecast the next out of sample observation.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-390710" onclick='return addComment.moveForm( "comment-390710", "390710", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-391051">
<div class="comment-container" id="li-comment-391051">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b7b7c519835b7cc4b89d155a617338a5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b7b7c519835b7cc4b89d155a617338a5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">zhou</span>
<span class="date">March 3, 2017 at 1:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-391051" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>it seems the model can’t forecast  the next month in future？</p>
<div class="reply">
<a aria-label="Reply to zhou" class="comment-reply-link" href="#comment-391051" onclick='return addComment.moveForm( "comment-391051", "391051", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-391447">
<div class="comment-container" id="li-comment-391447">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 6, 2017 at 10:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-391447" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What do you mean exactly zhou?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-391447" onclick='return addComment.moveForm( "comment-391447", "391447", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-391828">
<div class="comment-container" id="li-comment-391828">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b7b7c519835b7cc4b89d155a617338a5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b7b7c519835b7cc4b89d155a617338a5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">zhou</span>
<span class="date">March 8, 2017 at 4:39 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-391828" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>sorry. I want to forecast the passengers in future, what should I do?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-390824">
<div class="comment-container" id="li-comment-390824">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/05bbd1d0875731297408557a7f7d4061?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/05bbd1d0875731297408557a7f7d4061?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Viktor</span>
<span class="date">March 2, 2017 at 12:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-390824" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the tutorial, Jason. it’s very useful. It would be nice to also know how you chose the different parameters for MLP, and you’d go about optimizing them.</p>
<div class="reply">
<a aria-label="Reply to Viktor" class="comment-reply-link" href="#comment-390824" onclick='return addComment.moveForm( "comment-390824", "390824", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-390871">
<div class="comment-container" id="li-comment-390871">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 2, 2017 at 8:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-390871" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Viktor, I hope to cover more tutorials on this topic.</p>
<p>You can see this post on how to best tune an MLP:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-390871" onclick='return addComment.moveForm( "comment-390871", "390871", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-391528">
<div class="comment-container" id="li-comment-391528">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0e96f5be3d17e22ff54eb42f659f1e40?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0e96f5be3d17e22ff54eb42f659f1e40?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">0xKA</span>
<span class="date">March 6, 2017 at 7:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-391528" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In the first case. If I shift model to the left side, it will be a good model for forecasting because predicted values are quite fit the original data. Is it possible to do that ?</p>
<div class="reply">
<a aria-label="Reply to 0xKA" class="comment-reply-link" href="#comment-391528" onclick='return addComment.moveForm( "comment-391528", "391528", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-391615">
<div class="comment-container" id="li-comment-391615">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 7, 2017 at 9:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-391615" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can you give an example of what you mean?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-391615" onclick='return addComment.moveForm( "comment-391615", "391615", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-393762">
<div class="comment-container" id="li-comment-393762">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d89e891b7caf7b30c4cf87f9ca026f83?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d89e891b7caf7b30c4cf87f9ca026f83?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sphurti</span>
<span class="date">March 22, 2017 at 4:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-393762" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Is there any specific condition to use activation functions? how to deside which activation function is more suitable for linear or nonlinear datasets?</p>
<div class="reply">
<a aria-label="Reply to Sphurti" class="comment-reply-link" href="#comment-393762" onclick='return addComment.moveForm( "comment-393762", "393762", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-393845">
<div class="comment-container" id="li-comment-393845">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 23, 2017 at 8:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-393845" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>There are some rules.</p>
<p>Relu in hidden because it works really well. Sigmoid for binary outputs, linear for regression outputs, softmax for muti-class classification. </p>
<p>Often you can transform your data for the bounds of a given activation function (e.g. 0,1 for sigmoid, -1,1 for tanh, etc.)</p>
<p>I hope that helps as a start.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-393845" onclick='return addComment.moveForm( "comment-393845", "393845", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-393895">
<div class="comment-container" id="li-comment-393895">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d89e891b7caf7b30c4cf87f9ca026f83?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d89e891b7caf7b30c4cf87f9ca026f83?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sphurti</span>
<span class="date">March 23, 2017 at 5:51 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-393895" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>how to decide the optimizer? Is there any relevance with activation function?</p>
<div class="reply">
<a aria-label="Reply to Sphurti" class="comment-reply-link" href="#comment-393895" onclick='return addComment.moveForm( "comment-393895", "393895", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-393969">
<div class="comment-container" id="li-comment-393969">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 24, 2017 at 7:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-393969" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not really. It’s a matter of taste it seems (speed vs time).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-393969" onclick='return addComment.moveForm( "comment-393969", "393969", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-394511">
<div class="comment-container" id="li-comment-394511">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0e96f5be3d17e22ff54eb42f659f1e40?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0e96f5be3d17e22ff54eb42f659f1e40?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">John</span>
<span class="date">March 29, 2017 at 1:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-394511" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What kind of validation are you using in this tutorial? is it cross validation?</p>
<div class="reply">
<a aria-label="Reply to John" class="comment-reply-link" href="#comment-394511" onclick='return addComment.moveForm( "comment-394511", "394511", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-394560">
<div class="comment-container" id="li-comment-394560">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 29, 2017 at 9:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-394560" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, a train-test split.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-394560" onclick='return addComment.moveForm( "comment-394560", "394560", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-394605">
<div class="comment-container" id="li-comment-394605">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d89e891b7caf7b30c4cf87f9ca026f83?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d89e891b7caf7b30c4cf87f9ca026f83?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sphurti</span>
<span class="date">March 29, 2017 at 3:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-394605" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Is there any another deep learning algorithms that can be used for time series prediction? why to prefer multilayer perceptron for time series prediction?</p>
<div class="reply">
<a aria-label="Reply to Sphurti" class="comment-reply-link" href="#comment-394605" onclick='return addComment.moveForm( "comment-394605", "394605", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-394696">
<div class="comment-container" id="li-comment-394696">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 30, 2017 at 8:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-394696" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, you can use Long Short-Term Memory (LSTM) networks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-394696" onclick='return addComment.moveForm( "comment-394696", "394696", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-395252">
<div class="comment-container" id="li-comment-395252">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/584893509513c9ba44e795ae5f3327da?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/584893509513c9ba44e795ae5f3327da?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Qiushi Wang</span>
<span class="date">April 3, 2017 at 5:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-395252" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>I always have a question, if we only predict 1 time step further (t+1), the accurate predicted result is just copy the value of t, as the first figure shows. When we add more input like (t-2, t-1, t), the predicted result get worse. Even compare with other prediction method like ARIMA, RNN, this conclusion perhaps is still correct. To better exhibit the power of these prediction methods, should we try to predict more time steps further t+2, t+3, …? </p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Qiushi Wang" class="comment-reply-link" href="#comment-395252" onclick='return addComment.moveForm( "comment-395252", "395252", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-395331">
<div class="comment-container" id="li-comment-395331">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 4, 2017 at 9:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-395331" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It is a good idea to make the input data stationary and scale it. Then the network needs to be tuned for the problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-395331" onclick='return addComment.moveForm( "comment-395331", "395331", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-395879">
<div class="comment-container" id="li-comment-395879">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/98356a3335855b57853dbca90d6c1098?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/98356a3335855b57853dbca90d6c1098?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://none" rel="external nofollow">Stephan Oelze</a></span>
<span class="date">April 10, 2017 at 1:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-395879" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason.</p>
<p>Thanks for sharing your information here. Anyway i was not able to reproduce your last figure. On my machine it still looks like the “bad” figure. </p>
<p><a href="https://www2.pic-upload.de/img/32978063/auto.png" rel="nofollow">https://www2.pic-upload.de/img/32978063/auto.png</a></p>
<p>I used the code as stated above. Where is my missunderstanding here?</p>
<p><a href="https://pastebin.com/EzvjnvGv" rel="nofollow">https://pastebin.com/EzvjnvGv</a></p>
<p>Thank You!<br/>
silly me 🙂</p>
<div class="reply">
<a aria-label="Reply to Stephan Oelze" class="comment-reply-link" href="#comment-395879" onclick='return addComment.moveForm( "comment-395879", "395879", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-395911">
<div class="comment-container" id="li-comment-395911">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 10, 2017 at 7:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-395911" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps try fitting the network for longer?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-395911" onclick='return addComment.moveForm( "comment-395911", "395911", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-396075">
<div class="comment-container" id="li-comment-396075">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/abe17146ac6c56ba7ad7e3c1880f1021?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/abe17146ac6c56ba7ad7e3c1880f1021?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">trupti</span>
<span class="date">April 11, 2017 at 3:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-396075" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thanks for this post..actually I am referring this for my work. my dataset is linear. Can I  use softplus or elu as an activation function for linear data?</p>
<div class="reply">
<a aria-label="Reply to trupti" class="comment-reply-link" href="#comment-396075" onclick='return addComment.moveForm( "comment-396075", "396075", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-396164">
<div class="comment-container" id="li-comment-396164">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 12, 2017 at 7:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-396164" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, but your model may be more complex than is needed. In fact, you may be better off with a linear model like Linear Regression or Logistic Regression.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-396164" onclick='return addComment.moveForm( "comment-396164", "396164", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-396976">
<div class="comment-container" id="li-comment-396976">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cf391f9cb46875b41adeccfe22939df9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cf391f9cb46875b41adeccfe22939df9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ikok</span>
<span class="date">April 20, 2017 at 8:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-396976" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Firstly thanks Jason, I try MLP and LSTM based models on my time series data, and I get some RMSE values. ( e.g. train rmse 10, and test 11) (my example count 1400, min value:21, max value 210 ) What is acceptance value of RMSE. ?</p>
<div class="reply">
<a aria-label="Reply to ikok" class="comment-reply-link" href="#comment-396976" onclick='return addComment.moveForm( "comment-396976", "396976", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-397006">
<div class="comment-container" id="li-comment-397006">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 20, 2017 at 9:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-397006" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice work!</p>
<p>An acceptable RMSE depends on your problem and how much error you can bear.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-397006" onclick='return addComment.moveForm( "comment-397006", "397006", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-397142">
<div class="comment-container" id="li-comment-397142">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0325b27d60795f06f6e9e1c4a9909a9e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0325b27d60795f06f6e9e1c4a9909a9e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Dmitry</span>
<span class="date">April 21, 2017 at 6:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-397142" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great article, thank you.<br/>
Is it possible to make a DNN with several outputs? For example the output layer has several neurons responsible for different flight directions. What difficulties can arise?</p>
<div class="reply">
<a aria-label="Reply to Dmitry" class="comment-reply-link" href="#comment-397142" onclick='return addComment.moveForm( "comment-397142", "397142", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-397191">
<div class="comment-container" id="li-comment-397191">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 22, 2017 at 9:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-397191" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, try it.</p>
<p>Skill at future time steps often degrades quickly.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-397191" onclick='return addComment.moveForm( "comment-397191", "397191", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-397151">
<div class="comment-container" id="li-comment-397151">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/caa4a50abd4a89f2a54e42339fc1a1d1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/caa4a50abd4a89f2a54e42339fc1a1d1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">piemonsparrow</span>
<span class="date">April 21, 2017 at 10:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-397151" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, Jason, i am a student, recently i am learning from your blog. Could you make a display deep learning model training history in this article? I will be very appreciated if you can, because i am a newer. Thank you!</p>
<div class="reply">
<a aria-label="Reply to piemonsparrow" class="comment-reply-link" href="#comment-397151" onclick='return addComment.moveForm( "comment-397151", "397151", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-397194">
<div class="comment-container" id="li-comment-397194">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 22, 2017 at 9:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-397194" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This example shows you how to display training history:<br/>
<a href="http://machinelearningmastery.com/display-deep-learning-model-training-history-in-keras/" rel="nofollow">http://machinelearningmastery.com/display-deep-learning-model-training-history-in-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-397194" onclick='return addComment.moveForm( "comment-397194", "397194", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-397317">
<div class="comment-container" id="li-comment-397317">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hans</span>
<span class="date">April 23, 2017 at 2:09 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-397317" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Does anybody have an idea/code snippet how to store observations of this example code in a variable, so that the variable can be used to to make predictions beyond the airline dataset (one step in the future)?</p>
<div class="reply">
<a aria-label="Reply to Hans" class="comment-reply-link" href="#comment-397317" onclick='return addComment.moveForm( "comment-397317", "397317", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-397439">
<div class="comment-container" id="li-comment-397439">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hans</span>
<span class="date">April 24, 2017 at 3:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-397439" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Would it be logical incorrect to extend the testX-Array with for example [0,0,0] to forecast unseen data/ a step in the future?</p>
<div class="reply">
<a aria-label="Reply to Hans" class="comment-reply-link" href="#comment-397439" onclick='return addComment.moveForm( "comment-397439", "397439", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-397523">
<div class="comment-container" id="li-comment-397523">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 25, 2017 at 7:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-397523" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It would not be required.</p>
<p>Fit your model on all available data. When a new observation arrives, scale it appropriately, gather it with the other lag observations your model requires as input and call model.predict().</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-397523" onclick='return addComment.moveForm( "comment-397523", "397523", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-397442">
<div class="comment-container" id="li-comment-397442">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hans</span>
<span class="date">April 24, 2017 at 4:45 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-397442" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Is there a magic trick to get the right array-format for a prediction based on observations?<br/>
I always get the wrong format:</p>
<p><code><br/>
obsv1 = testPredict[4]<br/>
obsv2 = testPredict[5]<br/>
obsv3 = testPredict[6]</code></p>
<p>dataset = obsv1, obsv2, obsv3<br/>
dataX = []<br/>
dataX.append(dataset)<br/>
#dataX.append(obsv2)<br/>
#dataX.append(obsv3)<br/>
myNewX = numpy.array(dataX)</p>
<p></p>
<div class="reply">
<a aria-label="Reply to Hans" class="comment-reply-link" href="#comment-397442" onclick='return addComment.moveForm( "comment-397442", "397442", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-397444">
<div class="comment-container" id="li-comment-397444">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hans</span>
<span class="date">April 24, 2017 at 5:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-397444" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Update: </p>
<p>After several days I manged to make a prediction on unseen data in this example (code below).<br/>
Is this way correct?<br/>
How many observations should be used to get a good prediction on unseen data.<br/>
Are there standard tools available to measure corresponding performances and suggest the amount of observations?<br/>
Would this topic the same as choosing the right window-size for time-series analysis, or where would be the difference?</p>
<p>Code:</p>
<p>obsv1 = float(testPredict[4])<br/>
obsv2 = float(testPredict[5])<br/>
obsv3 = float(testPredict[6])</p>
<p>dataX = []<br/>
myNewX = []<br/>
dataX.append(obsv1)<br/>
dataX.append(obsv2)<br/>
dataX.append(obsv3)<br/>
myNewX.append(dataX)<br/>
myNewX = numpy.array(myNewX)</p>
<p>futureStepPredict = model.predict(myNewX)<br/>
print(futureStepPredict)</p>
<div class="reply">
<a aria-label="Reply to Hans" class="comment-reply-link" href="#comment-397444" onclick='return addComment.moveForm( "comment-397444", "397444", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-397525">
<div class="comment-container" id="li-comment-397525">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 25, 2017 at 7:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-397525" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Looks fine.</p>
<p>The number of obs required depends on how you have configured your model.</p>
<p>The “best” window size for a given problem is unknown, you must discover it through trial and error, see this post:<br/>
<a href="http://machinelearningmastery.com/a-data-driven-approach-to-machine-learning/" rel="nofollow">http://machinelearningmastery.com/a-data-driven-approach-to-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-397525" onclick='return addComment.moveForm( "comment-397525", "397525", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-4" id="comment-397885">
<div class="comment-container" id="li-comment-397885">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hans</span>
<span class="date">April 28, 2017 at 1:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-397885" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Is there a method or trial and error-strategy to find out how many lag observations are ‘best’ for a forecast of unseen data?<br/>
Is there a relation between look_back (window size) and lag observations?<br/>
In theory I could use all observations to predict one step of unseen data. Would this be useful?</p>
<div class="reply">
<a aria-label="Reply to Hans" class="comment-reply-link" href="#comment-397885" onclick='return addComment.moveForm( "comment-397885", "397885", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-397958">
<div class="comment-container" id="li-comment-397958">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 29, 2017 at 7:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-397958" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Look-back defines the lag.</p>
<p>You can use ACF and PACF plots to discover the most relevant lag obs:<br/>
<a href="http://machinelearningmastery.com/gentle-introduction-autocorrelation-partial-autocorrelation/" rel="nofollow">http://machinelearningmastery.com/gentle-introduction-autocorrelation-partial-autocorrelation/</a></p>
<p>The “promise” of LSTMs is that they can learn the appropriate time dependence structure without having it explicitly specified.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even depth-3" id="comment-400936">
<div class="comment-container" id="li-comment-400936">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hans</span>
<span class="date">May 31, 2017 at 8:38 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-400936" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If I fill the model with 3 obs, I get 3 predictions/data points of unseen data. </p>
<p>If I only want to predict one step in the future, should I build an average of the resulting 3 predictions,<br/>
or should I simply use the last of the 3 prediction steps?</p>
<p>Thank you.</p>
<div class="reply">
<a aria-label="Reply to Hans" class="comment-reply-link" href="#comment-400936" onclick='return addComment.moveForm( "comment-400936", "400936", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-401219">
<div class="comment-container" id="li-comment-401219">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 12:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-401219" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend changing the model to make one prediction if only one time step prediction is required.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401219" onclick='return addComment.moveForm( "comment-401219", "401219", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-401271">
<div class="comment-container" id="li-comment-401271">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hans</span>
<span class="date">June 2, 2017 at 7:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-401271" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How would you change the Multilayer Perceptron model of this site in this regard?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="comment-402013">
<div class="comment-container" id="li-comment-402013">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hans</span>
<span class="date">June 9, 2017 at 9:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-402013" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have a misconception here. Don’t do the same fellow reader!</p>
<p>With “obsv(n) = float(testPredict[n])” I took predictions of the test dataset as observations.</p>
<p>THAT’S WRONG! </p>
<p>Instead we take a partition of the original raw data as x/observations to predict unseen data, with a trained/fitted model- IN EVERY CASE.</p>
<p>Like in R:<br/>
<a href="http://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-401949" rel="nofollow">http://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-401949</a></p>
<p>Is this right Jason?</p>
<div class="reply">
<a aria-label="Reply to Hans" class="comment-reply-link" href="#comment-402013" onclick='return addComment.moveForm( "comment-402013", "402013", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-397524">
<div class="comment-container" id="li-comment-397524">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 25, 2017 at 7:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-397524" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If you need a 2D array with 1 row and 2 columns, you can do something like:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cab0264882418080924" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
data = [0.1, 0.1]
data = numpy.array(data)
data = data.resize(1, 2)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cab0264882418080924-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cab0264882418080924-2">2</div><div class="crayon-num" data-line="crayon-5c0cab0264882418080924-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cab0264882418080924-1"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cab0264882418080924-2"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cab0264882418080924-3"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">resize</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-397524" onclick='return addComment.moveForm( "comment-397524", "397524", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-397889">
<div class="comment-container" id="li-comment-397889">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/aa68f81dfcc6ba8e117249f0cb1188df?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/aa68f81dfcc6ba8e117249f0cb1188df?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Md. Armanur Rahman</span>
<span class="date">April 28, 2017 at 2:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-397889" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Sir,</p>
<p>This is Arman from Malaysia. I am a student of Multimedia University. I want to do “Self-Tuning performance of Hadoop using Deep Learning”. So which framework I will consider for this sort of problem. as like DBM, DBN , CNN, RNN ?</p>
<p>I need your suggestion.</p>
<p>With best regards<br/>
Arman</p>
<div class="reply">
<a aria-label="Reply to Md. Armanur Rahman" class="comment-reply-link" href="#comment-397889" onclick='return addComment.moveForm( "comment-397889", "397889", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-397959">
<div class="comment-container" id="li-comment-397959">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 29, 2017 at 7:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-397959" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend following this process:<br/>
<a href="http://machinelearningmastery.com/start-here/#process" rel="nofollow">http://machinelearningmastery.com/start-here/#process</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-397959" onclick='return addComment.moveForm( "comment-397959", "397959", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-398182">
<div class="comment-container" id="li-comment-398182">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hans</span>
<span class="date">May 1, 2017 at 6:41 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-398182" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Are there any more concerns about this code. Or is it updated and technical correct now?</p>
<div class="reply">
<a aria-label="Reply to Hans" class="comment-reply-link" href="#comment-398182" onclick='return addComment.moveForm( "comment-398182", "398182", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-398227">
<div class="comment-container" id="li-comment-398227">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 2, 2017 at 5:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-398227" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>We can always do things better.</p>
<p>For this example, I would recommend exploring providing the data as time steps and explore larger networks fit for more epochs.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-398227" onclick='return addComment.moveForm( "comment-398227", "398227", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-398312">
<div class="comment-container" id="li-comment-398312">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hans</span>
<span class="date">May 2, 2017 at 11:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-398312" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hm, I’m not sure if I understand it right.</p>
<p>I believe I’m already feeding it with time-step like so:</p>
<p>return datetime.strptime(x, ‘%Y-%m-%d’)</p>
<p>My raw data items have a decent date column. Is this what you meant?</p>
<p>How do we explore larger networks fit for more epochs?</p>
<p>I have everything parameterized in a central batch file now (pipeline).</p>
<p>Should I increase the epochs for…</p>
<p>model.fit(trainX, trainY, epochs=myEpochs, batch_size=myBatchSize, verbose=0)</p>
<p>Thank you.</p>
<div class="reply">
<a aria-label="Reply to Hans" class="comment-reply-link" href="#comment-398312" onclick='return addComment.moveForm( "comment-398312", "398312", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-398183">
<div class="comment-container" id="li-comment-398183">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hans</span>
<span class="date">May 1, 2017 at 6:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-398183" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m trying to adapt some code from: </p>
<p><a href="http://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" rel="nofollow">http://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/</a></p>
<p>…and build the variable EXPECTED in the context of this script.<br/>
Unfortunately I don’t know how to do it right. I’m a little bit frustrated at this point.</p>
<p><code><br/>
for i in range(len(test)): &lt;-- what should I better use here?<br/>
	expected = dataset[len(train) + i + 1] &lt;-- what should I better use here?<br/>
	print(expected)</code></p>
<p>This looks cool so far, could I use the index to retrieve a var called EXPECTED?</p>
<p>for i in range(len(testPredict)):<br/>
	pre = '%.3f' % testPredict[i]<br/>
	print(pre)<br/>
</p>
<p>A code example would help to solve my index-confusions.</p>
<div class="reply">
<a aria-label="Reply to Hans" class="comment-reply-link" href="#comment-398183" onclick='return addComment.moveForm( "comment-398183", "398183", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-402540">
<div class="comment-container" id="li-comment-402540">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ca955954da949e61b60b681534e46c16?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ca955954da949e61b60b681534e46c16?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Stefan</span>
<span class="date">June 15, 2017 at 2:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-402540" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is a great example that machine learning is often much more than knowing how to use the algorithms / libraries. It’s always important to understand the data we are working with. For this example as it is 1 dimensional this is luckily quite easily done.<br/>
In the first example we are giving the the algorithm one previous value and ask it “What will the next value be?”. </p>
<p>Since we use a neural net not taking into account any time behavior, this system is strongly overdetermined. There are a lot of values at the y value 290 for example. For half of them the values decline, for half of them the values increase. If we don’t give the algorithm any indication, how should it know which direction this would be for the test datapoint? There is just not enough information. </p>
<p>One idea could be to additionally give the algorithm the gradient which would help in the decision whether we a rising or a falling value follows (which is somehow what we do when adding a lookback of 2). Yet, the results do obviously not improve significantly.</p>
<p>Here I want to come back to “understand the data you are dealing with”. If we look at the plot, there are two characteristics which are obvious. A generally rising trend and a periodicity. We want the algorithm to cover both. Only then, will the prediction be accurate. We see that there is an obvious 12 month periodicity (think of summer vacation, christmas). If we want the algorithm to cover that periodicity without including model knowledge (as we are using an ANN) we have to at least provide it the data in a format to deduct this property.</p>
<p>Hence: Extending the lookback to 12 month (12 datapoints in the X) will lead to a significantly improved “1 month ahead”-prediction! Now however, we have a higher feature dimension, which might not be desired due to computational reasons (doesn’t matter for this toy example, but anyway…). Next thing we do is take only 3 month steps at lookback (still look back 12 month but skip 2 months in the data). We still cover the periodicity but reduce the feature amount. The algorithm provides almost the same performance for the “1 month ahead” prediction.</p>
<p>Another possibility would surely be to add the month (Jan, Feb, etc.) as a categorical feature.</p>
<div class="reply">
<a aria-label="Reply to Stefan" class="comment-reply-link" href="#comment-402540" onclick='return addComment.moveForm( "comment-402540", "402540", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-402578">
<div class="comment-container" id="li-comment-402578">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 15, 2017 at 8:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-402578" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Stefan, very insightful.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-402578" onclick='return addComment.moveForm( "comment-402578", "402578", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-405494">
<div class="comment-container" id="li-comment-405494">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d0dc4739fd3aa8cbd25fe69a64426e1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d0dc4739fd3aa8cbd25fe69a64426e1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Paul</span>
<span class="date">July 11, 2017 at 10:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-405494" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason! Thanks for the great example! I was looking for this kind of example.<br/>
I’m learning Neural Network these days and trying to predict the number which is temperature like this example, but I have more inputs to predict temperature.<br/>
Then should I edit on the pandas.read.csv(…,usecols[1],…) to usecols[0:4] if I have 5 inputs?</p>
<p>Thanks in advance!</p>
<p>Best,<br/>
Paul</p>
<div class="reply">
<a aria-label="Reply to Paul" class="comment-reply-link" href="#comment-405494" onclick='return addComment.moveForm( "comment-405494", "405494", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-405495">
<div class="comment-container" id="li-comment-405495">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d0dc4739fd3aa8cbd25fe69a64426e1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d0dc4739fd3aa8cbd25fe69a64426e1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Paul</span>
<span class="date">July 11, 2017 at 11:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-405495" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I mean something like below<br/>
X1          X2              X3         X4    X5       Y1<br/>
380   17.00017    9.099979    4    744    889.7142</p>
<p>Thank you!</p>
<div class="reply">
<a aria-label="Reply to Paul" class="comment-reply-link" href="#comment-405495" onclick='return addComment.moveForm( "comment-405495", "405495", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-405589">
<div class="comment-container" id="li-comment-405589">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 12, 2017 at 9:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-405589" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This post might help you frame your prediction problem:<br/>
<a href="http://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow">http://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-405589" onclick='return addComment.moveForm( "comment-405589", "405589", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-407126">
<div class="comment-container" id="li-comment-407126">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d0dc4739fd3aa8cbd25fe69a64426e1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d0dc4739fd3aa8cbd25fe69a64426e1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Paul</span>
<span class="date">July 24, 2017 at 3:13 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-407126" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for replying me back! 🙂 And sorry for late response.<br/>
When I clicked the link that you wrote, it requires username and password.. :'(</p>
<div class="reply">
<a aria-label="Reply to Paul" class="comment-reply-link" href="#comment-407126" onclick='return addComment.moveForm( "comment-407126", "407126", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-407212">
<div class="comment-container" id="li-comment-407212">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 25, 2017 at 9:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-407212" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry about that, fixed. Please try again.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-407212" onclick='return addComment.moveForm( "comment-407212", "407212", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even depth-3" id="comment-407127">
<div class="comment-container" id="li-comment-407127">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d0dc4739fd3aa8cbd25fe69a64426e1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d0dc4739fd3aa8cbd25fe69a64426e1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Paul</span>
<span class="date">July 24, 2017 at 3:16 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-407127" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>NVM. I figured out it was <code>machinelearningmastery</code>. instead of <code>mlmastery.staging.wpengine.com</code> 🙂</p>
<p>Thanks. 🙂</p>
<p>Best,<br/>
Paul</p>
<div class="reply">
<a aria-label="Reply to Paul" class="comment-reply-link" href="#comment-407127" onclick='return addComment.moveForm( "comment-407127", "407127", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-407213">
<div class="comment-container" id="li-comment-407213">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 25, 2017 at 9:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-407213" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, for some reason I liked to the staging version of my site, sorry about that.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-407213" onclick='return addComment.moveForm( "comment-407213", "407213", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-408217">
<div class="comment-container" id="li-comment-408217">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f19c89fc2d5a09c0658da89da485740b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f19c89fc2d5a09c0658da89da485740b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Barkın Tuncer</span>
<span class="date">August 2, 2017 at 7:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-408217" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey, I am trying to make a case where the test case is not given but the model should predict the so called future of the timeseries. Hence, I wrote a code which takes the last row of the train data and predict a value from it then put the predicted value at the end of that row and make a prediction again. After doing this procedure for let say len(testX) times. It ended up like an exponential graph. I can upload it if you want to check it out. My code is given below. I dont understand why it works like that. I hope you can enlighten me.</p>
<p>prediction=numpy.zeros((testX.shape[0],1))<br/>
test_initial=trainX[-1].copy()<br/>
testPredictFirst = model.predict(test_initial.reshape(1,3))<br/>
new_=create_pred(test_initial,testPredictFirst[0][0])<br/>
prediction[0]=testPredictFirst</p>
<p>for k in range(1,len(testX)):<br/>
    testPredict=model.predict(new_.reshape(1,3))<br/>
    new_=create_pred(new_,testPredict[0][0]) #this code does if new_ is [1,2,3] and testPredict[0][0] is 4 the output is [2,3,4]</p>
<p>    prediction[k]=testPredict</p>
<div class="reply">
<a aria-label="Reply to Barkın Tuncer" class="comment-reply-link" href="#comment-408217" onclick='return addComment.moveForm( "comment-408217", "408217", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-408295">
<div class="comment-container" id="li-comment-408295">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fbdca5ecddc007b1828fc1361a905e13?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fbdca5ecddc007b1828fc1361a905e13?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">rohini</span>
<span class="date">August 2, 2017 at 8:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-408295" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>really awesome and useful to0</p>
<div class="reply">
<a aria-label="Reply to rohini" class="comment-reply-link" href="#comment-408295" onclick='return addComment.moveForm( "comment-408295", "408295", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-408352">
<div class="comment-container" id="li-comment-408352">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 3, 2017 at 6:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-408352" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-408352" onclick='return addComment.moveForm( "comment-408352", "408352", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-409700">
<div class="comment-container" id="li-comment-409700">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/310546daa8cb9f3d43d8f231bfe6af52?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/310546daa8cb9f3d43d8f231bfe6af52?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://jayhshah.me" rel="external nofollow">Jay Shah</a></span>
<span class="date">August 15, 2017 at 7:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-409700" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>It’s awesome article. Very Helpful. I implemented these concepts in my Categorical TIme Series Forecasting problem.But the result I got is very unexpected.</p>
<p>My TIme Series can take only 10 values from 0 to 9. I’ve approx 15k rows of data.I want to predict next value in the time series. </p>
<p>But the issue is ‘1’ appears in time series most of the time. So starting from 2nd or 3rd epoch LSTM predicts only ‘1’ for whatsoever input. I tried varying Hyperparameter but it’s not working out. Can you please point out what could be the approach to solve the problem?</p>
<div class="reply">
<a aria-label="Reply to Jay Shah" class="comment-reply-link" href="#comment-409700" onclick='return addComment.moveForm( "comment-409700", "409700", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-409751">
<div class="comment-container" id="li-comment-409751">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 16, 2017 at 6:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-409751" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps your problem is too challenging for the chosen model.</p>
<p>Try testing with an MLP with a large window size. The search hyperparameters of the model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-409751" onclick='return addComment.moveForm( "comment-409751", "409751", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-413307">
<div class="comment-container" id="li-comment-413307">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/803429d2c28ebcb04e040aa8012daba2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/803429d2c28ebcb04e040aa8012daba2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Patt</span>
<span class="date">September 10, 2017 at 5:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-413307" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m new to coding. How can I predict t+1 from your example code? I mean from your code I want the value of t+1 or can you more explanation about the code where it predicts t+1.</p>
<div class="reply">
<a aria-label="Reply to Patt" class="comment-reply-link" href="#comment-413307" onclick='return addComment.moveForm( "comment-413307", "413307", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-413428">
<div class="comment-container" id="li-comment-413428">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 11, 2017 at 12:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-413428" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps start with something simpler if you are new to coding, for example simpler linear models:<br/>
<a href="https://machinelearningmastery.com/start-here/#timeseries" rel="nofollow">https://machinelearningmastery.com/start-here/#timeseries</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-413428" onclick='return addComment.moveForm( "comment-413428", "413428", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-413722">
<div class="comment-container" id="li-comment-413722">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a57a6bfdb69d9c215db9653428bb8d2a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a57a6bfdb69d9c215db9653428bb8d2a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://doganaskan.com" rel="external nofollow">Dogan</a></span>
<span class="date">September 14, 2017 at 2:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-413722" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Why do you think making the data stationary is a good idea in this approach? I know ARIMA assumes the data is stationary, but is it also valid for neural networks in general? I thought normalization would be enough.</p>
<div class="reply">
<a aria-label="Reply to Dogan" class="comment-reply-link" href="#comment-413722" onclick='return addComment.moveForm( "comment-413722", "413722", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-413887">
<div class="comment-container" id="li-comment-413887">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 15, 2017 at 12:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-413887" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, it will make the problem easier to model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-413887" onclick='return addComment.moveForm( "comment-413887", "413887", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-414731">
<div class="comment-container" id="li-comment-414731">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6e2afdcd0ec852a2e193d7b7be15e889?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6e2afdcd0ec852a2e193d7b7be15e889?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://karanahh262.github.io" rel="external nofollow">karan</a></span>
<span class="date">September 24, 2017 at 10:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-414731" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am getting this error:<br/>
Help me please i am new here. i am using tensorflow</p>
<p>Traceback (most recent call last):<br/>
  File “international-airline-passengers.py”, line 49, in<br/>
    testPredictPlot[len(trainPredict)+(look_back*2)+1:len(dataset)-1, :] = testPredict<br/>
ValueError: could not broadcast input array from shape (94,1) into shape (46,1)</p>
<div class="reply">
<a aria-label="Reply to karan" class="comment-reply-link" href="#comment-414731" onclick='return addComment.moveForm( "comment-414731", "414731", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-414735">
<div class="comment-container" id="li-comment-414735">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6e2afdcd0ec852a2e193d7b7be15e889?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6e2afdcd0ec852a2e193d7b7be15e889?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://karanahh262.github.io" rel="external nofollow">karan</a></span>
<span class="date">September 24, 2017 at 11:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-414735" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I got my error. It was  silly mistake.<br/>
thanks</p>
<div class="reply">
<a aria-label="Reply to karan" class="comment-reply-link" href="#comment-414735" onclick='return addComment.moveForm( "comment-414735", "414735", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-414753">
<div class="comment-container" id="li-comment-414753">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 25, 2017 at 5:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-414753" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear you worked it out.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-414753" onclick='return addComment.moveForm( "comment-414753", "414753", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-4" id="comment-414866">
<div class="comment-container" id="li-comment-414866">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fbcb378708ca04ecd728abda729810cd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fbcb378708ca04ecd728abda729810cd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sanam</span>
<span class="date">September 26, 2017 at 10:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-414866" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thankyou so much for all this . I have a question ! Why the obtained accuracy of regression models in terms of MSE is not good when trained using theano, tensorflow or keras. However , if we try to train MLP or anyother model by using matlabs neural network tool , the models show very good accuraccy in terms of e power negative values. why is that so ?</p>
<div class="reply">
<a aria-label="Reply to Sanam" class="comment-reply-link" href="#comment-414866" onclick='return addComment.moveForm( "comment-414866", "414866", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-414894">
<div class="comment-container" id="li-comment-414894">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 27, 2017 at 5:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-414894" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Accuracy is a score for classification algorithms that predict a label, RMSE is a score for regression algorithms that predict a quantity.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-443826">
<div class="comment-container" id="li-comment-443826">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c7fbb380b7fe66106b06db3cb7fdc40b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c7fbb380b7fe66106b06db3cb7fdc40b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Asif khan</span>
<span class="date">July 18, 2018 at 11:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-443826" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Firstly Thank you for this tutorial.  I am implementing this within my design but I am getting an error in this line:</p>
<p> –&gt; 128 testPredictPlot[len(trainPredict)+(look_back*2)+1:len(Y1)-1] =<br/>
&gt; testPredict</p>
<p>of: ValueError: could not broadcast input array from shape (19) into shape<br/>
&gt; (0))</p>
<p>My complete code is: <a href="https://stackoverflow.com/questions/51401060/valueerror-could-not-broadcast-input-array-from-shape-19-into-shape-0/51403185#51403185" rel="nofollow">https://stackoverflow.com/questions/51401060/valueerror-could-not-broadcast-input-array-from-shape-19-into-shape-0/51403185#51403185</a></p>
<p>I  would really appreciate your help as I know this is probably something small but I cannot get passed it. Thank you</p>
<div class="reply">
<a aria-label="Reply to Asif khan" class="comment-reply-link" href="#comment-443826" onclick='return addComment.moveForm( "comment-443826", "443826", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-415644">
<div class="comment-container" id="li-comment-415644">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/80365673cd69143489ee51facc5a6449?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/80365673cd69143489ee51facc5a6449?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">MaCa</span>
<span class="date">October 5, 2017 at 3:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-415644" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Maybe I am not understanding something. </p>
<p>You say something like<br/>
 “We can see that the model did a pretty poor job of fitting both the training and the test datasets. It basically predicted the same input value as the output.”<br/>
when talking about the first image. I don’t understand how that prediction is bad. It looks very very good to me. I am asking because I tried your code with my own dataset and I obtained something similar, i.e. it looked perfect except it was slightly shifted. But how is it bad? </p>
<p>Also in the following section you say<br/>
“Looking at the graph, we can see more structure in the predictions.”<br/>
How do we see the structure? To me it looks like it is less precise than the first one.</p>
<p>Apologies if I quoted you twice, but I don’t really understand…</p>
<div class="reply">
<a aria-label="Reply to MaCa" class="comment-reply-link" href="#comment-415644" onclick='return addComment.moveForm( "comment-415644", "415644", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-415658">
<div class="comment-container" id="li-comment-415658">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 5, 2017 at 5:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-415658" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If the model cannot do better than predicting the input as the output, then the model is not skillful as you may as well just use a persistence model:<br/>
<a href="https://machinelearningmastery.com/persistence-time-series-forecasting-with-python/" rel="nofollow">https://machinelearningmastery.com/persistence-time-series-forecasting-with-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-415658" onclick='return addComment.moveForm( "comment-415658", "415658", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-418713">
<div class="comment-container" id="li-comment-418713">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7eeba338edd653728a707bfb84c5a6ec?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7eeba338edd653728a707bfb84c5a6ec?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Wawan</span>
<span class="date">November 2, 2017 at 1:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-418713" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason<br/>
Do you how train data in PyCharm with Dynamic CNN<br/>
Please give us more explanation..<br/>
thank you</p>
<div class="reply">
<a aria-label="Reply to Wawan" class="comment-reply-link" href="#comment-418713" onclick='return addComment.moveForm( "comment-418713", "418713", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-423137">
<div class="comment-container" id="li-comment-423137">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/af054f9d96e84ad0a5f7d04a049c43f5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/af054f9d96e84ad0a5f7d04a049c43f5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alessandro</span>
<span class="date">December 15, 2017 at 2:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-423137" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I think I’m a little confused.<br/>
Your post seems to address how to forecast t+1 from t.<br/>
The output however looks pretty poor as it ends up performing as a persistence model.<br/>
What is the value of using keras to achieve the same goal as a persistence model then?<br/>
How would you modify your network to try to perform better than a common persistence model?</p>
<p>What would the model structure look like?<br/>
Thanks in advance!</p>
<div class="reply">
<a aria-label="Reply to Alessandro" class="comment-reply-link" href="#comment-423137" onclick='return addComment.moveForm( "comment-423137", "423137", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-423161">
<div class="comment-container" id="li-comment-423161">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 15, 2017 at 5:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-423161" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend an MLP tuned to the problem with many lag variables as input.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-423161" onclick='return addComment.moveForm( "comment-423161", "423161", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-423182">
<div class="comment-container" id="li-comment-423182">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4ebfe51da51807eadddbeac6a00ff8c0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4ebfe51da51807eadddbeac6a00ff8c0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Volodymyr</span>
<span class="date">December 15, 2017 at 7:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-423182" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thx for great tutorial, but i cant find value t+1. And can we use it for predicting stock prices?</p>
<div class="reply">
<a aria-label="Reply to Volodymyr" class="comment-reply-link" href="#comment-423182" onclick='return addComment.moveForm( "comment-423182", "423182", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-423229">
<div class="comment-container" id="li-comment-423229">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 15, 2017 at 3:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-423229" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Use a persistence model to predict short-term stock prices:<br/>
<a href="https://machinelearningmastery.com/gentle-introduction-random-walk-times-series-forecasting-python/" rel="nofollow">https://machinelearningmastery.com/gentle-introduction-random-walk-times-series-forecasting-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-423229" onclick='return addComment.moveForm( "comment-423229", "423229", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-430710">
<div class="comment-container" id="li-comment-430710">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fb5febb6cec09479b57896c62698ea90?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fb5febb6cec09479b57896c62698ea90?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">DC</span>
<span class="date">February 28, 2018 at 1:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-430710" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
This article as well as the following comments are really helpful. I have tried this one on stock price prediction with more lookbacks, say 10~30, or more layers. But after I add one more layer into the network, it becomes harder/slower to get the loss decreased, which makes bad result over 10,000+ epochs. Do you have any idea about that? </p>
<p>Thank you.</p>
<div class="reply">
<a aria-label="Reply to DC" class="comment-reply-link" href="#comment-430710" onclick='return addComment.moveForm( "comment-430710", "430710", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-430780">
<div class="comment-container" id="li-comment-430780">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 1, 2018 at 6:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-430780" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I believe security prices are a random walk and are not predictable:<br/>
<a href="https://machinelearningmastery.com/gentle-introduction-random-walk-times-series-forecasting-python/" rel="nofollow">https://machinelearningmastery.com/gentle-introduction-random-walk-times-series-forecasting-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430780" onclick='return addComment.moveForm( "comment-430780", "430780", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-430812">
<div class="comment-container" id="li-comment-430812">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fb5febb6cec09479b57896c62698ea90?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fb5febb6cec09479b57896c62698ea90?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">DC</span>
<span class="date">March 1, 2018 at 1:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-430812" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the prompt reply.<br/>
Yes I believe it’s quite hard to predict stock price. However I can get similar result  as yours in this article by one hidden layer with 8 neuron and relu function after a few epochs. So it may be just a coincidence?</p>
<div class="reply">
<a aria-label="Reply to DC" class="comment-reply-link" href="#comment-430812" onclick='return addComment.moveForm( "comment-430812", "430812", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-435540">
<div class="comment-container" id="li-comment-435540">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1cadc58a45bed6dd34e5ccc528f3fbc5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1cadc58a45bed6dd34e5ccc528f3fbc5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alessandro</span>
<span class="date">April 21, 2018 at 2:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-435540" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,</p>
<p>I’m studying time-series prediction and I was impressed when I saw your results on the airline passengers prediction problem. I was amazed by the fact that the prediction of such a complicated non-linear problem was so perfect!</p>
<p>However, when I looked at the code, I realised that what you’re showing is not really a prediction, or at least it’s not very fair. In fact, when you predict the results for the testing data, you’re only predicting the results for the next timestamp, and not for the entire sequence.<br/>
To say that in other words, you’re predicting the future of next datapoint, given the previous datapoint.<br/>
Maybe I misunderstood the aim of the problem, but from what I understood, you were trying to predict the passengers for a time in the future, given a previous time in the past.</p>
<p>To make a fair comparison, it would be interesting to see what happens when the network predicts the future based exclusively on the past data. For example, you can predict the first testing point based on the last training point and then continue the prediction using the previous predictions. I tried doing this, and results are just shit 🙂<br/>
I wonder now how it could be possible to write a network that actually predicts the future events based on the past events. I also tried with your LSTM example, but results were still disappointing…</p>
<p>Cheers,<br/>
Alessandro</p>
<div class="reply">
<a aria-label="Reply to Alessandro" class="comment-reply-link" href="#comment-435540" onclick='return addComment.moveForm( "comment-435540", "435540", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-435560">
<div class="comment-container" id="li-comment-435560">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 21, 2018 at 6:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-435560" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great point, I have better examples here listed here:<br/>
<a href="https://machinelearningmastery.com/start-here/#lstm" rel="nofollow">https://machinelearningmastery.com/start-here/#lstm</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435560" onclick='return addComment.moveForm( "comment-435560", "435560", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-436388">
<div class="comment-container" id="li-comment-436388">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f5dd543087b41b53359361b4de0a4c84?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f5dd543087b41b53359361b4de0a4c84?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Matúš Vršanský</span>
<span class="date">May 1, 2018 at 10:39 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-436388" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, I would like to ask you something, what exactly means number of verbose write on one epoch? </p>
<p>For example, I have “0s – loss: 23647.2512” , and what means that number ?</p>
<div class="reply">
<a aria-label="Reply to Matúš Vršanský" class="comment-reply-link" href="#comment-436388" onclick='return addComment.moveForm( "comment-436388", "436388", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-436417">
<div class="comment-container" id="li-comment-436417">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 2, 2018 at 5:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-436417" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good question.</p>
<p>It reports how long the epoch took in seconds and the loss (a measure of error) on the samples in the training set for that epoch.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436417" onclick='return addComment.moveForm( "comment-436417", "436417", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-436703">
<div class="comment-container" id="li-comment-436703">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f5dd543087b41b53359361b4de0a4c84?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f5dd543087b41b53359361b4de0a4c84?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Matúš Vršanský</span>
<span class="date">May 5, 2018 at 6:51 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-436703" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>But why each epoch shows so big loss?  </p>
<p>Example:  – 0s – loss: 543.4524 – val_loss: 2389.2405</p>
<p>… why is loss to big?  and in final graph training and testing data are very similar to default dataset?</p>
<div class="reply">
<a aria-label="Reply to Matúš Vršanský" class="comment-reply-link" href="#comment-436703" onclick='return addComment.moveForm( "comment-436703", "436703", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-436731">
<div class="comment-container" id="li-comment-436731">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 6, 2018 at 6:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-436731" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good question, I cannot answer that. I suspect it has something to do with the same of your data. Perhaps you need to rescale your data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436731" onclick='return addComment.moveForm( "comment-436731", "436731", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-436949">
<div class="comment-container" id="li-comment-436949">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f5dd543087b41b53359361b4de0a4c84?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f5dd543087b41b53359361b4de0a4c84?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Matúš Vršanský</span>
<span class="date">May 8, 2018 at 9:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-436949" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Understand, and last question, please . This dataset represents airline passagers on which country? Just for curiosity 🙂</p>
<div class="reply">
<a aria-label="Reply to Matúš Vršanský" class="comment-reply-link" href="#comment-436949" onclick='return addComment.moveForm( "comment-436949", "436949", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-436990">
<div class="comment-container" id="li-comment-436990">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 9, 2018 at 6:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-436990" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t know, sorry.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436990" onclick='return addComment.moveForm( "comment-436990", "436990", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-443009">
<div class="comment-container" id="li-comment-443009">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c7a1c86062ccd3fd87d9ba527f166729?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c7a1c86062ccd3fd87d9ba527f166729?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Isaac</span>
<span class="date">July 9, 2018 at 10:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-443009" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the tutorial!</p>
<p>Do you see any problem with shuffling the data? I.e using ‘numpy.random.shuffle(train_test_data’ to randomly select training and test data?<br/>
(as used here)<br/>
<a href="https://stackoverflow.com/questions/42786129/keras-doesnt-make-good-predictions/51234143#51234143" rel="nofollow">https://stackoverflow.com/questions/42786129/keras-doesnt-make-good-predictions/51234143#51234143</a></p>
<div class="reply">
<a aria-label="Reply to Isaac" class="comment-reply-link" href="#comment-443009" onclick='return addComment.moveForm( "comment-443009", "443009", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-443068">
<div class="comment-container" id="li-comment-443068">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 10, 2018 at 6:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-443068" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In general no, with time series, yes. You should not shuffle time series data.</p>
<p>Learn more here:<br/>
<a href="https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443068" onclick='return addComment.moveForm( "comment-443068", "443068", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-448293">
<div class="comment-container" id="li-comment-448293">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1c72c60702a1048f4385ff16eb4ec7ab?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1c72c60702a1048f4385ff16eb4ec7ab?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Gladys</span>
<span class="date">September 10, 2018 at 8:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-448293" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
Thank you for this tutorial. However, when using the exact same code in the loop_back=3 case, it seems the graph is much more similar to the first graph shown (loop_back=1) than the second one! Also, isn’t it a bit confusing to compare the error on test vs train, as the slopes are steeper in the second part of the dataset? What I mean is, if we were to train on the last 67% of the dataset and test on the first 33%, the error on the test set would reduce while the error on the train set would increase. It is kind of confusing to present the results this way (maybe the evaluation measure should be relative to the range in values for the current time-window?)<br/>
Thanks anyway!</p>
<div class="reply">
<a aria-label="Reply to Gladys" class="comment-reply-link" href="#comment-448293" onclick='return addComment.moveForm( "comment-448293", "448293", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-449954">
<div class="comment-container" id="li-comment-449954">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/30a6dc3074b2be27a998db9eeddbd7ec?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/30a6dc3074b2be27a998db9eeddbd7ec?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Christopher</span>
<span class="date">September 27, 2018 at 8:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-449954" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Great tutorial!<br/>
You fit the model with the default value of suffle, which is True, shown below.<br/>
model.fit(trainX, trainY, epochs=200, batch_size=2, verbose=2)</p>
<p>I remember you indicate in other tutorial that one should not shuffle a time serires when training it. Would you have any comments?</p>
<p>Regards</p>
<div class="reply">
<a aria-label="Reply to Christopher" class="comment-reply-link" href="#comment-449954" onclick='return addComment.moveForm( "comment-449954", "449954", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-449992">
<div class="comment-container" id="li-comment-449992">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 28, 2018 at 6:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-449992" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, shuffle of the data is a bad idea for time series!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-449992" onclick='return addComment.moveForm( "comment-449992", "449992", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-450773">
<div class="comment-container" id="li-comment-450773">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8bf72b2a3841428638a9facb04d7f965?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8bf72b2a3841428638a9facb04d7f965?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ebenezer</span>
<span class="date">October 5, 2018 at 7:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-450773" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>def create_dataset(dataset, look_back=1):<br/>
 I am getting some errors when i input this code</p>
<p> File “”, line 1<br/>
    def create_dataset(dataset, look_back=1):<br/>
                                             ^<br/>
SyntaxError: unexpected EOF while parsing</p>
<p>Can you help me understand what i am doing wrong. Thank you</p>
<div class="reply">
<a aria-label="Reply to Ebenezer" class="comment-reply-link" href="#comment-450773" onclick='return addComment.moveForm( "comment-450773", "450773", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-450808">
<div class="comment-container" id="li-comment-450808">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 6, 2018 at 5:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-450808" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ensure you maintain the indenting of the code.</p>
<p>Also, save the code to a file and run the file from the command line, more details here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-run-a-script-from-the-command-line" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-run-a-script-from-the-command-line</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-450808" onclick='return addComment.moveForm( "comment-450808", "450808", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-450931">
<div class="comment-container" id="li-comment-450931">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/aa3d20d9402dec558c9f03903e8f21ca?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/aa3d20d9402dec558c9f03903e8f21ca?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">fadhil</span>
<span class="date">October 7, 2018 at 10:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-450931" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Great tutorial!<br/>
but, how to determine the learning rate?, and how much is the learning rate in the code above?</p>
<div class="reply">
<a aria-label="Reply to fadhil" class="comment-reply-link" href="#comment-450931" onclick='return addComment.moveForm( "comment-450931", "450931", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-450964">
<div class="comment-container" id="li-comment-450964">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 8, 2018 at 9:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-450964" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Trial and error or use a method like Adam to adapt it automatically.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-450964" onclick='return addComment.moveForm( "comment-450964", "450964", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-451348">
<div class="comment-container" id="li-comment-451348">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0937416b76a08bdf27a1c5ebddb27d9d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0937416b76a08bdf27a1c5ebddb27d9d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jay Lee</span>
<span class="date">October 11, 2018 at 7:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-451348" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello. I have a question for this chapter.<br/>
I understood like below.<br/>
During the “training” period, weights are calculated by 67% of all data.<br/>
After that, with 33% of all data we make a prediction.</p>
<p>Question :<br/>
During the “test” period, are we making a prediction y_hat(t+1) with y(t) using weight calculated with 67% of data?<br/>
I want to know which data is used to predict y_hat(t+1) in the “test” period.</p>
<div class="reply">
<a aria-label="Reply to Jay Lee" class="comment-reply-link" href="#comment-451348" onclick='return addComment.moveForm( "comment-451348", "451348", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-451391">
<div class="comment-container" id="li-comment-451391">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 12, 2018 at 6:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-451391" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can use real obs as input if they are available or you can use predictions as input (e.g. recursive).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-451391" onclick='return addComment.moveForm( "comment-451391", "451391", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-452474">
<div class="comment-container" id="li-comment-452474">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8d9aba79be37c3e972c9d572ee7dc66b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8d9aba79be37c3e972c9d572ee7dc66b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://franciskim.co" rel="external nofollow">Francis Kim</a></span>
<span class="date">October 23, 2018 at 11:38 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-452474" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, how do you get this to predict, say, t + 60 ?</p>
<div class="reply">
<a aria-label="Reply to Francis Kim" class="comment-reply-link" href="#comment-452474" onclick='return addComment.moveForm( "comment-452474", "452474", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-452518">
<div class="comment-container" id="li-comment-452518">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 24, 2018 at 6:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-452518" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is called multi-step forecasting:<br/>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting/</a></p>
<p>I have many examples, perhaps start here:<br/>
<a href="https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/" rel="nofollow">https://machinelearningmastery.com/multi-step-time-series-forecasting-long-short-term-memory-networks-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-452518" onclick='return addComment.moveForm( "comment-452518", "452518", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-454611">
<div class="comment-container" id="li-comment-454611">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/38fad5c19b9f971dbd2b25b324bda3f8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/38fad5c19b9f971dbd2b25b324bda3f8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">JG</span>
<span class="date">November 13, 2018 at 9:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-454611" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hola Jason:</p>
<p>Nice Tutorial, as usual !. Thanks.</p>
<p>I have 3 questions:</p>
<p>1) If we would have multi-steps forecasting (e.g. for regression analysis) we would need as many outputs units (neurons) as number of output steps, right? something similar to classification problems where we have to use as many outputs neurons as classes ?</p>
<p>2) I modify the neural model, in the case of the single step input (i.e. look_back ==1), using a wider model (more units or neurons) and deeper (more layers in a similar way as you do in your multi-steps inputs or window) and… surprisingly… I got “very much worst MSE and RMSE scores or metrics !<br/>
How can we explained this? because of model overfitting? is something similar at when you perform with windows (taken into consideration more back-steps or look-baks steps , that  you only  get in your case  similar scores ?<br/>
I am really surprise for this model ANN behavior against common sense? what is your explanation, if anyone exist?</p>
<p>3) for me one of the core of the TIMESERIES analysis , in comparison of classical image analysis and features data model, in addition to introducing other techniques of RNN such as LSTM is, the previous work of preparing the FRAMING of your  DATA SERIES and, splitting or building-up the the input-s X, and the output-s Y (or labels), from the original TIMESERIES, as you do with your function definition called : def create_dataset(dataset, look_back): do you agree?</p>
<p>thank you in advance for your time, effort and consideration!<br/>
regards<br/>
JG</p>
<div class="reply">
<a aria-label="Reply to JG" class="comment-reply-link" href="#comment-454611" onclick='return addComment.moveForm( "comment-454611", "454611", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-454628">
<div class="comment-container" id="li-comment-454628">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 13, 2018 at 1:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/time-series-prediction-with-deep-learning-in-python-with-keras/#comment-454628" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You have many options for multi-step, such as recursive use of a one-step model, vector output or seq2seq. I have tutorials on each.</p>
<p>Perhaps the model is overfitting, analysis would be required.</p>
<p>Yes, framing a problem is the point of biggest leverage.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-454628" onclick='return addComment.moveForm( "comment-454628", "454628", "respond", "2924" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/time-series-prediction-with-deep-learning-in-python-with-keras/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="2924"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="e64952d2fb"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="153"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery!</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Jason Brownlee, PhD
<br/>
I write tutorials to help developers (<i>like you</i>) get results with machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-51"> <div class="textwidget"><p></p><center><br/>
<strong>Deep Learning for Time Series</strong><br/>
Forecast the future with MLPs, CNNs, and LSTMs.
<p><a href="/deep-learning-for-time-series-forecasting/">Click to Get Started Now!</a><br/>
<a href="/deep-learning-for-time-series-forecasting/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/Cover-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch"><img alt="How to Develop a Neural Machine Translation System in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/01/How-to-Develop-a-Neural-Machine-Translation-System-in-Keras-150x150.jpg" title="How to Develop a Neural Machine Translation System from Scratch" width="45"/></a> <a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch">How to Develop a Neural Machine Translation System from Scratch</a>
<span class="meta">January 10, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning"><img alt="Difference Between Classification and Regression in Machine Learning" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/Difference-Between-Classification-and-Regression-in-Machine-Learning-150x150.jpg" title="Difference Between Classification and Regression in Machine Learning" width="45"/></a> <a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning">Difference Between Classification and Regression in Machine Learning</a>
<span class="meta">December 11, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem..."><img alt="So, You are Working on a Machine Learning Problem..." class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/So-You-are-Working-on-a-Machine-Learning-Problem...-150x150.jpg" title="So, You are Working on a Machine Learning Problem..." width="45"/></a> <a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem…">So, You are Working on a Machine Learning Problem…</a>
<span class="meta">April 4, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis"><img alt="Plot of the Multichannel Convolutional Neural Network For Text" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-150x150.png" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis" width="45"/></a> <a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis">How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis</a>
<span class="meta">January 12, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras"><img alt="How to Make Classification and Regression Predictions for Deep Learning Models in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/How-to-Make-Classification-and-Regression-Predictions-for-Deep-Learning-Models-in-Keras-150x150.jpg" title="How to Make Predictions with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras">How to Make Predictions with Keras</a>
<span class="meta">April 9, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)"><img alt="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/11-Classical-Time-Series-Forecasting-Methods-in-Python-Cheat-Sheet-150x150.jpg" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)">11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)</a>
<span class="meta">August 6, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras"><img alt="How to Visualize a Deep Learning Neural Network Model in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/How-to-Visualize-a-Deep-Learning-Neural-Network-Model-in-Keras-150x150.jpg" title="How to Visualize a Deep Learning Neural Network Model in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras">How to Visualize a Deep Learning Neural Network Model in Keras</a>
<span class="meta">December 13, 2017</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> <div class="widget_text widget widget_custom_html" id="custom_html-2"><h3>You might also like…</h3><div class="textwidget custom-html-widget"><ul>
<li><a href="/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Install Python for Machine Learning</a></li>
<li><a href="/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python</a></li>
<li><a href="/tutorial-first-neural-network-python-keras/">Your First Neural Network in Python</a></li>
<li><a href="/how-to-run-your-first-classifier-in-weka/">Your First Classifier in Weka</a></li>
<li><a href="/arima-for-time-series-forecasting-with-python/">Your First Time Series Forecasting Project</a></li>
</ul></div></div></aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/disclaimer/">Disclaimer</a> | 
<a href="/terms-of-service/">Terms</a> | 
<a href="/contact/">Contact</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.8" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.0.5" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.8" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.1" type="text/javascript"></script>
</body>
</html>