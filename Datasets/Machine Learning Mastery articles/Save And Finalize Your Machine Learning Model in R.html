<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v9.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Save And Finalize Your Machine Learning Model in R</title>
<link href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="Save And Finalize Your Machine Learning Model in R" property="og:title"/>
<meta content="Finding an accurate machine learning is not the end of the project. In this post you will discover how to finalize your machine learning model in R including: making predictions on unseen data, re-building the model from scratch and saving your model for later use. Let’s get started. Finalize Your Machine Learning Model Once you have an accurate model …" property="og:description"/>
<meta content="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="https://www.facebook.com/jason.brownlee.39" property="article:author"/>
<meta content="R Machine Learning" property="article:section"/>
<meta content="2016-02-18T18:00:39+00:00" property="article:published_time"/>
<meta content="2016-09-22T00:13:19+00:00" property="article:modified_time"/>
<meta content="2016-09-22T00:13:19+00:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/02/Finalize-Your-Machine-Learning-Model-in-R.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/02/Finalize-Your-Machine-Learning-Model-in-R.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="427" property="og:image:height"/>
<meta content="Finalize Your Machine Learning Model in R" property="og:image:alt"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"https:\/\/machinelearningmastery.com\/#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/feed/" rel="alternate" title="Machine Learning Mastery » Save And Finalize Your Machine Learning Model in R Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<style media="all" type="text/css">
.wpautoterms-footer{background-color:#ffffff;text-align:center;}
.wpautoterms-footer a{color:#000000;font-family:Arial, sans-serif;font-size:14px;}
.wpautoterms-footer .separator{color:#cccccc;font-family:Arial, sans-serif;font-size:14px;}</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/auto-terms-of-service-and-privacy-policy/css/wpautoterms.css?ver=4.9.8" id="wpautoterms_css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.0.5" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/css/front.css?ver=2.0.20" id="ssb-front-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/ewd-ufaq-styles.css?ver=4.9.8" id="ewd-ufaq-style-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/rrssb-min.css?ver=4.9.8" id="ewd-ufaq-rrssb-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.8" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=2.0.20" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.8" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.8" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=2212" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Ffinalize-machine-learning-models-in-r%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Ffinalize-machine-learning-models-in-r%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<style media="screen">

        .simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
      margin: ;
    }
         /*inline margin*/
    
  
  
  
  
  
          .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
         margin: ;
     }

          /*margin-digbar*/

  
  
  
  
 
   
   

</style>
<script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#4c89bf; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#4c89bf;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#4c89bf!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#ffffff;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-2212 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/icon-100x100.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-15"> <div class="textwidget"><p>Want help with R and caret? <a href="https://machinelearningmastery.leadpages.co/r-machine-learning-mini-course/">Take the FREE Mini-Course</a>.</p>
</div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<input name="post_type" type="hidden" value="post"/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Main Menu</h3><ul class="nav fl" id="main-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503" id="menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Start Here</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501" id="menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506" id="menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508" id="menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (Keras)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511" id="menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509" id="menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515" id="menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">Deep Learning for NLP</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512" id="menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Understand Algorithms</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507" id="menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms (Python)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6513" id="menu-item-6513"><a href="https://machinelearningmastery.com/category/machine-learning-process/">Machine Learning Process</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516" id="menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6517" id="menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522" id="menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6518" id="menu-item-6518"><a href="https://machinelearningmastery.com/category/start-machine-learning/">Getting Started</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510" id="menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519" id="menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistical Methods</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520" id="menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Time Series (introductory)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523" id="menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6514" id="menu-item-6514"><a href="https://machinelearningmastery.com/category/machine-learning-resources/">Resources</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502" id="menu-item-6502"><a href="https://machinelearningmastery.com/products/">Ebooks</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500" id="menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504" id="menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505" id="menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-2212 post type-post status-publish format-standard has-post-thumbnail hentry category-r-machine-learning">
<header>
<h1 class="title entry-title">Save And Finalize Your Machine Learning Model in R</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-02-19T05:00:39+1100">February 19, 2016</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/r-machine-learning/" title="View all items in R Machine Learning">R Machine Learning</a></span> </div>
<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-2212 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=Save+And+Finalize+Your+Machine+Learning+Model+in+R&amp;url=https://machinelearningmastery.com/finalize-machine-learning-models-in-r/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/finalize-machine-learning-models-in-r/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/finalize-machine-learning-models-in-r/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/finalize-machine-learning-models-in-r/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
<p>Finding an accurate machine learning is not the end of the project.</p>
<p>In this post you will discover how to finalize your machine learning model in R including: making predictions on unseen data, re-building the model from scratch and saving your model for later use.</p>
<p>Let’s get started.</p>
<div class="wp-caption aligncenter" id="attachment_2214" style="width: 650px"><img alt="Finalize Your Machine Learning Model in R" class="size-full wp-image-2214" height="427" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/02/Finalize-Your-Machine-Learning-Model-in-R.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/02/Finalize-Your-Machine-Learning-Model-in-R.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/02/Finalize-Your-Machine-Learning-Model-in-R-300x200.jpg 300w" width="640"/><p class="wp-caption-text">Finalize Your Machine Learning Model in R.<br/>Photo by <a href="https://www.flickr.com/photos/manoftaste-de/9483602817/">Christian Schnettelker</a>, some rights reserved.</p></div>
<h2>Finalize Your Machine Learning Model</h2>
<p>Once you have an accurate model on your test harness you are nearly, done. But not yet.</p>
<p>There are still a number of tasks to do to finalize your model. The whole idea of creating an accurate model for your dataset was to make predictions on unseen data.</p>
<p>There are three tasks you may be concerned with:</p>
<ol>
<li>Making new predictions on unseen data.</li>
<li>Creating a standalone model using all training data.</li>
<li>Saving your model to file for later loading and making predictions on new data.</li>
</ol>
<p>Once you have finalized your model you are ready to make use of it. You could use the R model directly. You could also discover the key internal representation found by the learning algorithm (like the coefficients in a linear model) and use them in a new implementation of the prediction algorithm on another platform.</p>
<p>In the next section, you will look at how you can finalize your machine learning model in R.</p>
<p></p><div class="woo-sc-hr"></div>
<center>
<h3>Need more Help with R for Machine Learning?</h3>
<p>Take my free 14-day email course and discover how to use R on your project (with sample code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.lpages.co/leadbox/141caac73f72a2%3A164f8be4f346dc/5734055144325120/" style="background: rgb(255, 206, 10); color: rgb(255, 255, 255); text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.25) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.5) 0px 1px 3px inset, rgba(0, 0, 0, 0.5) 0px 1px 3px;" target="_blank">Start Your FREE Mini-Course Now!</a><script data-config="%7B%7D" data-leadbox="141caac73f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.lpages.co/leadbox/141caac73f72a2%3A164f8be4f346dc/5734055144325120/" src="https://machinelearningmastery.lpages.co/leadbox-1500583721.js" type="text/javascript"></script></p>
</center>
<p></p><div class="woo-sc-hr"></div>
<h2>Finalize Predictive Model in R</h2>
<p>Caret is an excellent tool that you can use to find good or even best machine learning algorithms and parameters for machine learning algorithms.</p>
<p>But what do you do after you have discovered a model that is accurate enough to use?</p>
<p>Once you have found a good model in R, you have three main concerns:</p>
<ol>
<li>Making new predictions using your tuned caret model.</li>
<li>Creating a standalone model using the entire training dataset.</li>
<li>Saving/Loading a standalone model to file.</li>
</ol>
<p>This section will step you through how to achieve each of these tasks in R.</p>
<h3>1. Make Predictions On New Data</h3>
<p>You can make new predictions using a model you have tuned using caret using the <em>predict.train()</em> function.</p>
<p>In the recipe below, the dataset is split into a validation dataset and a training dataset. The validation dataset could just as easily be a new dataset stored in a separate file and loaded as a data frame.</p>
<p>A good model of the data is found using LDA. We can see that caret provides access to the best model from a training run in the finalModel variable.</p>
<p>We can use that model to make predictions by calling predict using the fit from train which will automatically use the final model. We must specify the data one which to make predictions via the <em>newdata</em> argument.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cabe977050232439630" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load libraries
library(caret)
library(mlbench)
# load dataset
data(PimaIndiansDiabetes)
# create 80%/20% for training and validation datasets
set.seed(9)
validation_index &lt;- createDataPartition(PimaIndiansDiabetes$diabetes, p=0.80, list=FALSE)
validation &lt;- PimaIndiansDiabetes[-validation_index,]
training &lt;- PimaIndiansDiabetes[validation_index,]
# train a model and summarize model
set.seed(9)
control &lt;- trainControl(method="cv", number=10)
fit.lda &lt;- train(diabetes~., data=training, method="lda", metric="Accuracy", trControl=control)
print(fit.lda)
print(fit.lda$finalModel)
# estimate skill on validation dataset
set.seed(9)
predictions &lt;- predict(fit.lda, newdata=validation)
confusionMatrix(predictions, validation$diabetes)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cabe977050232439630-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977050232439630-2">2</div><div class="crayon-num" data-line="crayon-5c0cabe977050232439630-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977050232439630-4">4</div><div class="crayon-num" data-line="crayon-5c0cabe977050232439630-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977050232439630-6">6</div><div class="crayon-num" data-line="crayon-5c0cabe977050232439630-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977050232439630-8">8</div><div class="crayon-num" data-line="crayon-5c0cabe977050232439630-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977050232439630-10">10</div><div class="crayon-num" data-line="crayon-5c0cabe977050232439630-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977050232439630-12">12</div><div class="crayon-num" data-line="crayon-5c0cabe977050232439630-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977050232439630-14">14</div><div class="crayon-num" data-line="crayon-5c0cabe977050232439630-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977050232439630-16">16</div><div class="crayon-num" data-line="crayon-5c0cabe977050232439630-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977050232439630-18">18</div><div class="crayon-num" data-line="crayon-5c0cabe977050232439630-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977050232439630-20">20</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cabe977050232439630-1"><span class="crayon-p"># load libraries</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977050232439630-2"><span class="crayon-e">library</span><span class="crayon-sy">(</span><span class="crayon-v">caret</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabe977050232439630-3"><span class="crayon-e">library</span><span class="crayon-sy">(</span><span class="crayon-v">mlbench</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977050232439630-4"><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="crayon-5c0cabe977050232439630-5"><span class="crayon-e">data</span><span class="crayon-sy">(</span><span class="crayon-v">PimaIndiansDiabetes</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977050232439630-6"><span class="crayon-p"># create 80%/20% for training and validation datasets</span></div><div class="crayon-line" id="crayon-5c0cabe977050232439630-7"><span class="crayon-v">set</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">9</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977050232439630-8"><span class="crayon-v">validation_index</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">createDataPartition</span><span class="crayon-sy">(</span><span class="crayon-v">PimaIndiansDiabetes</span><span class="crayon-sy">$</span><span class="crayon-v">diabetes</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-o">=</span><span class="crayon-cn">0.80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">list</span><span class="crayon-o">=</span><span class="crayon-t">FALSE</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabe977050232439630-9"><span class="crayon-v">validation</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">PimaIndiansDiabetes</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">validation_index</span><span class="crayon-sy">,</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977050232439630-10"><span class="crayon-v">training</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">PimaIndiansDiabetes</span><span class="crayon-sy">[</span><span class="crayon-v">validation_index</span><span class="crayon-sy">,</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0cabe977050232439630-11"><span class="crayon-p"># train a model and summarize model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977050232439630-12"><span class="crayon-v">set</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">9</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabe977050232439630-13"><span class="crayon-v">control</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">trainControl</span><span class="crayon-sy">(</span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"cv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">number</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977050232439630-14"><span class="crayon-v">fit</span><span class="crayon-sy">.</span><span class="crayon-v">lda</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">train</span><span class="crayon-sy">(</span><span class="crayon-v">diabetes</span><span class="crayon-o">~</span><span class="crayon-sy">.</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-o">=</span><span class="crayon-v">training</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"lda"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-o">=</span><span class="crayon-s">"Accuracy"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trControl</span><span class="crayon-o">=</span><span class="crayon-v">control</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabe977050232439630-15"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">fit</span><span class="crayon-sy">.</span><span class="crayon-v">lda</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977050232439630-16"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">fit</span><span class="crayon-sy">.</span><span class="crayon-v">lda</span><span class="crayon-sy">$</span><span class="crayon-v">finalModel</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabe977050232439630-17"><span class="crayon-p"># estimate skill on validation dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977050232439630-18"><span class="crayon-v">set</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">9</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabe977050232439630-19"><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">fit</span><span class="crayon-sy">.</span><span class="crayon-v">lda</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">newdata</span><span class="crayon-o">=</span><span class="crayon-v">validation</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977050232439630-20"><span class="crayon-e">confusionMatrix</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation</span><span class="crayon-sy">$</span><span class="crayon-v">diabetes</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>Running the example, we can see that the estimated accuracy on the training dataset was 76.91%. Using the finalModel in the fit, we can see that the accuracy on the hold out validation dataset was 77.78%, very similar to our estimate.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cabe977059889913097" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Resampling results

  Accuracy   Kappa    Accuracy SD  Kappa SD 
  0.7691169  0.45993  0.06210884   0.1537133

...

Confusion Matrix and Statistics

          Reference
Prediction neg pos
       neg  85  19
       pos  15  34
                                          
               Accuracy : 0.7778          
                 95% CI : (0.7036, 0.8409)
    No Information Rate : 0.6536          
    P-Value [Acc &gt; NIR] : 0.000586        
                                          
                  Kappa : 0.5004          
 Mcnemar's Test P-Value : 0.606905        
                                          
            Sensitivity : 0.8500          
            Specificity : 0.6415          
         Pos Pred Value : 0.8173          
         Neg Pred Value : 0.6939          
             Prevalence : 0.6536          
         Detection Rate : 0.5556          
   Detection Prevalence : 0.6797          
      Balanced Accuracy : 0.7458          
                                          
       'Positive' Class : neg</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cabe977059889913097-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977059889913097-2">2</div><div class="crayon-num" data-line="crayon-5c0cabe977059889913097-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977059889913097-4">4</div><div class="crayon-num" data-line="crayon-5c0cabe977059889913097-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977059889913097-6">6</div><div class="crayon-num" data-line="crayon-5c0cabe977059889913097-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977059889913097-8">8</div><div class="crayon-num" data-line="crayon-5c0cabe977059889913097-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977059889913097-10">10</div><div class="crayon-num" data-line="crayon-5c0cabe977059889913097-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977059889913097-12">12</div><div class="crayon-num" data-line="crayon-5c0cabe977059889913097-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977059889913097-14">14</div><div class="crayon-num" data-line="crayon-5c0cabe977059889913097-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977059889913097-16">16</div><div class="crayon-num" data-line="crayon-5c0cabe977059889913097-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977059889913097-18">18</div><div class="crayon-num" data-line="crayon-5c0cabe977059889913097-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977059889913097-20">20</div><div class="crayon-num" data-line="crayon-5c0cabe977059889913097-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977059889913097-22">22</div><div class="crayon-num" data-line="crayon-5c0cabe977059889913097-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977059889913097-24">24</div><div class="crayon-num" data-line="crayon-5c0cabe977059889913097-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977059889913097-26">26</div><div class="crayon-num" data-line="crayon-5c0cabe977059889913097-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977059889913097-28">28</div><div class="crayon-num" data-line="crayon-5c0cabe977059889913097-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977059889913097-30">30</div><div class="crayon-num" data-line="crayon-5c0cabe977059889913097-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977059889913097-32">32</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cabe977059889913097-1">Resampling results</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977059889913097-2"> </div><div class="crayon-line" id="crayon-5c0cabe977059889913097-3">  Accuracy   Kappa    Accuracy SD  Kappa SD </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977059889913097-4">  0.7691169  0.45993  0.06210884   0.1537133</div><div class="crayon-line" id="crayon-5c0cabe977059889913097-5"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977059889913097-6">...</div><div class="crayon-line" id="crayon-5c0cabe977059889913097-7"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977059889913097-8">Confusion Matrix and Statistics</div><div class="crayon-line" id="crayon-5c0cabe977059889913097-9"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977059889913097-10">          Reference</div><div class="crayon-line" id="crayon-5c0cabe977059889913097-11">Prediction neg pos</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977059889913097-12">       neg  85  19</div><div class="crayon-line" id="crayon-5c0cabe977059889913097-13">       pos  15  34</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977059889913097-14">                                          </div><div class="crayon-line" id="crayon-5c0cabe977059889913097-15">               Accuracy : 0.7778          </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977059889913097-16">                 95% CI : (0.7036, 0.8409)</div><div class="crayon-line" id="crayon-5c0cabe977059889913097-17">    No Information Rate : 0.6536          </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977059889913097-18">    P-Value [Acc &gt; NIR] : 0.000586        </div><div class="crayon-line" id="crayon-5c0cabe977059889913097-19">                                          </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977059889913097-20">                  Kappa : 0.5004          </div><div class="crayon-line" id="crayon-5c0cabe977059889913097-21"> Mcnemar's Test P-Value : 0.606905        </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977059889913097-22">                                          </div><div class="crayon-line" id="crayon-5c0cabe977059889913097-23">            Sensitivity : 0.8500          </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977059889913097-24">            Specificity : 0.6415          </div><div class="crayon-line" id="crayon-5c0cabe977059889913097-25">         Pos Pred Value : 0.8173          </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977059889913097-26">         Neg Pred Value : 0.6939          </div><div class="crayon-line" id="crayon-5c0cabe977059889913097-27">             Prevalence : 0.6536          </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977059889913097-28">         Detection Rate : 0.5556          </div><div class="crayon-line" id="crayon-5c0cabe977059889913097-29">   Detection Prevalence : 0.6797          </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977059889913097-30">      Balanced Accuracy : 0.7458          </div><div class="crayon-line" id="crayon-5c0cabe977059889913097-31">                                          </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977059889913097-32">       'Positive' Class : neg</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h3>2. Create A Standalone Model</h3>
<p>In this example, we have tuned a random forest with 3 different values for <em>mtry</em> and <em>ntree</em> set to 2000. By printing the fit and the finalModel, we can see that the most accurate value for <em>mtry</em> was 2.</p>
<p>Now that we know a good algorithm (random forest) and the good configuration (mtry=2, <em>ntree=2000</em>) we can create the final model directly using all of the training data. We can lookup the “<em>rf</em>” random forest implementation used by caret in the <a href="https://topepo.github.io/caret/modelList.html">Caret List of Models</a> and note that it is using the <em>randomForest</em> package and in turn the <em>randomForest()</em> function.</p>
<p>The example creates a new model directly and uses it to make predictions on the new data, this case simulated as the verification dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cabe97705b403208881" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load libraries
library(caret)
library(mlbench)
library(randomForest)
# load dataset
data(Sonar)
set.seed(7)
# create 80%/20% for training and validation datasets
validation_index &lt;- createDataPartition(Sonar$Class, p=0.80, list=FALSE)
validation &lt;- Sonar[-validation_index,]
training &lt;- Sonar[validation_index,]
# train a model and summarize model
set.seed(7)
control &lt;- trainControl(method="repeatedcv", number=10, repeats=3)
fit.rf &lt;- train(Class~., data=training, method="rf", metric="Accuracy", trControl=control, ntree=2000)
print(fit.rf)
print(fit.rf$finalModel)
# create standalone model using all training data
set.seed(7)
finalModel &lt;- randomForest(Class~., training, mtry=2, ntree=2000)
# make a predictions on "new data" using the final model
final_predictions &lt;- predict(finalModel, validation[,1:60])
confusionMatrix(final_predictions, validation$Class)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cabe97705b403208881-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705b403208881-2">2</div><div class="crayon-num" data-line="crayon-5c0cabe97705b403208881-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705b403208881-4">4</div><div class="crayon-num" data-line="crayon-5c0cabe97705b403208881-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705b403208881-6">6</div><div class="crayon-num" data-line="crayon-5c0cabe97705b403208881-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705b403208881-8">8</div><div class="crayon-num" data-line="crayon-5c0cabe97705b403208881-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705b403208881-10">10</div><div class="crayon-num" data-line="crayon-5c0cabe97705b403208881-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705b403208881-12">12</div><div class="crayon-num" data-line="crayon-5c0cabe97705b403208881-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705b403208881-14">14</div><div class="crayon-num" data-line="crayon-5c0cabe97705b403208881-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705b403208881-16">16</div><div class="crayon-num" data-line="crayon-5c0cabe97705b403208881-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705b403208881-18">18</div><div class="crayon-num" data-line="crayon-5c0cabe97705b403208881-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705b403208881-20">20</div><div class="crayon-num" data-line="crayon-5c0cabe97705b403208881-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705b403208881-22">22</div><div class="crayon-num" data-line="crayon-5c0cabe97705b403208881-23">23</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cabe97705b403208881-1"><span class="crayon-p"># load libraries</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705b403208881-2"><span class="crayon-e">library</span><span class="crayon-sy">(</span><span class="crayon-v">caret</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabe97705b403208881-3"><span class="crayon-e">library</span><span class="crayon-sy">(</span><span class="crayon-v">mlbench</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705b403208881-4"><span class="crayon-e">library</span><span class="crayon-sy">(</span><span class="crayon-v">randomForest</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabe97705b403208881-5"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705b403208881-6"><span class="crayon-e">data</span><span class="crayon-sy">(</span><span class="crayon-v">Sonar</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabe97705b403208881-7"><span class="crayon-v">set</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705b403208881-8"><span class="crayon-p"># create 80%/20% for training and validation datasets</span></div><div class="crayon-line" id="crayon-5c0cabe97705b403208881-9"><span class="crayon-v">validation_index</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">createDataPartition</span><span class="crayon-sy">(</span><span class="crayon-v">Sonar</span><span class="crayon-sy">$</span><span class="crayon-t">Class</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-o">=</span><span class="crayon-cn">0.80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">list</span><span class="crayon-o">=</span><span class="crayon-t">FALSE</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705b403208881-10"><span class="crayon-v">validation</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">Sonar</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">validation_index</span><span class="crayon-sy">,</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0cabe97705b403208881-11"><span class="crayon-v">training</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">Sonar</span><span class="crayon-sy">[</span><span class="crayon-v">validation_index</span><span class="crayon-sy">,</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705b403208881-12"><span class="crayon-p"># train a model and summarize model</span></div><div class="crayon-line" id="crayon-5c0cabe97705b403208881-13"><span class="crayon-v">set</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705b403208881-14"><span class="crayon-v">control</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">trainControl</span><span class="crayon-sy">(</span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"repeatedcv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">number</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">repeats</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabe97705b403208881-15"><span class="crayon-v">fit</span><span class="crayon-sy">.</span><span class="crayon-v">rf</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">train</span><span class="crayon-sy">(</span><span class="crayon-t">Class</span><span class="crayon-o">~</span><span class="crayon-sy">.</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-o">=</span><span class="crayon-v">training</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"rf"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metric</span><span class="crayon-o">=</span><span class="crayon-s">"Accuracy"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trControl</span><span class="crayon-o">=</span><span class="crayon-v">control</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ntree</span><span class="crayon-o">=</span><span class="crayon-cn">2000</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705b403208881-16"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">fit</span><span class="crayon-sy">.</span><span class="crayon-v">rf</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabe97705b403208881-17"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">fit</span><span class="crayon-sy">.</span><span class="crayon-v">rf</span><span class="crayon-sy">$</span><span class="crayon-v">finalModel</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705b403208881-18"><span class="crayon-p"># create standalone model using all training data</span></div><div class="crayon-line" id="crayon-5c0cabe97705b403208881-19"><span class="crayon-v">set</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705b403208881-20"><span class="crayon-v">finalModel</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">randomForest</span><span class="crayon-sy">(</span><span class="crayon-t">Class</span><span class="crayon-o">~</span><span class="crayon-sy">.</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">training</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mtry</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ntree</span><span class="crayon-o">=</span><span class="crayon-cn">2000</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabe97705b403208881-21"><span class="crayon-p"># make a predictions on "new data" using the final model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705b403208881-22"><span class="crayon-v">final_predictions</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">finalModel</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation</span><span class="crayon-sy">[</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-cn">60</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabe97705b403208881-23"><span class="crayon-e">confusionMatrix</span><span class="crayon-sy">(</span><span class="crayon-v">final_predictions</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation</span><span class="crayon-sy">$</span><span class="crayon-t">Class</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0013 seconds] -->
<p>We can see that the estimated accuracy of the optimal configuration was 85.07%. We can see that the accuracy of the final standalone model trained on all of the training dataset and predicting for the validation dataset was 82.93%.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cabe97705d306345236" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Random Forest 

167 samples
 60 predictor
  2 classes: 'M', 'R' 

No pre-processing
Resampling: Cross-Validated (10 fold, repeated 3 times) 
Summary of sample sizes: 151, 150, 150, 150, 151, 150, ... 
Resampling results across tuning parameters:

  mtry  Accuracy   Kappa      Accuracy SD  Kappa SD 
   2    0.8507353  0.6968343  0.07745360   0.1579125
  31    0.8064951  0.6085348  0.09373438   0.1904946
  60    0.7927696  0.5813335  0.08768147   0.1780100

Accuracy was used to select the optimal model using  the largest value.
The final value used for the model was mtry = 2. 

...

Call:
 randomForest(x = x, y = y, ntree = 2000, mtry = param$mtry) 
               Type of random forest: classification
                     Number of trees: 2000
No. of variables tried at each split: 2

        OOB estimate of  error rate: 14.37%
Confusion matrix:
   M  R class.error
M 83  6  0.06741573
R 18 60  0.23076923

...

Confusion Matrix and Statistics

          Reference
Prediction  M  R
         M 20  5
         R  2 14
                                          
               Accuracy : 0.8293          
                 95% CI : (0.6794, 0.9285)
    No Information Rate : 0.5366          
    P-Value [Acc &gt; NIR] : 8.511e-05       
                                          
                  Kappa : 0.653           
 Mcnemar's Test P-Value : 0.4497          
                                          
            Sensitivity : 0.9091          
            Specificity : 0.7368          
         Pos Pred Value : 0.8000          
         Neg Pred Value : 0.8750          
             Prevalence : 0.5366          
         Detection Rate : 0.4878          
   Detection Prevalence : 0.6098          
      Balanced Accuracy : 0.8230          
                                          
       'Positive' Class : M</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-2">2</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-4">4</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-6">6</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-8">8</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-10">10</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-12">12</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-14">14</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-16">16</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-18">18</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-20">20</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-22">22</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-24">24</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-26">26</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-28">28</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-30">30</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-32">32</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-34">34</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-36">36</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-38">38</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-40">40</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-42">42</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-44">44</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-46">46</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-48">48</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-50">50</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-52">52</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-54">54</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-56">56</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-58">58</div><div class="crayon-num" data-line="crayon-5c0cabe97705d306345236-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe97705d306345236-60">60</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cabe97705d306345236-1">Random Forest </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-2"> </div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-3">167 samples</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-4"> 60 predictor</div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-5">  2 classes: 'M', 'R' </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-6"> </div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-7">No pre-processing</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-8">Resampling: Cross-Validated (10 fold, repeated 3 times) </div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-9">Summary of sample sizes: 151, 150, 150, 150, 151, 150, ... </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-10">Resampling results across tuning parameters:</div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-11"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-12">  mtry  Accuracy   Kappa      Accuracy SD  Kappa SD </div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-13">   2    0.8507353  0.6968343  0.07745360   0.1579125</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-14">  31    0.8064951  0.6085348  0.09373438   0.1904946</div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-15">  60    0.7927696  0.5813335  0.08768147   0.1780100</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-16"> </div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-17">Accuracy was used to select the optimal model using  the largest value.</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-18">The final value used for the model was mtry = 2. </div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-19"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-20">...</div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-21"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-22">Call:</div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-23"> randomForest(x = x, y = y, ntree = 2000, mtry = param$mtry) </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-24">               Type of random forest: classification</div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-25">                     Number of trees: 2000</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-26">No. of variables tried at each split: 2</div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-27"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-28">        OOB estimate of  error rate: 14.37%</div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-29">Confusion matrix:</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-30">   M  R class.error</div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-31">M 83  6  0.06741573</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-32">R 18 60  0.23076923</div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-33"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-34">...</div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-35"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-36">Confusion Matrix and Statistics</div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-37"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-38">          Reference</div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-39">Prediction  M  R</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-40">         M 20  5</div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-41">         R  2 14</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-42">                                          </div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-43">               Accuracy : 0.8293          </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-44">                 95% CI : (0.6794, 0.9285)</div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-45">    No Information Rate : 0.5366          </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-46">    P-Value [Acc &gt; NIR] : 8.511e-05       </div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-47">                                          </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-48">                  Kappa : 0.653           </div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-49"> Mcnemar's Test P-Value : 0.4497          </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-50">                                          </div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-51">            Sensitivity : 0.9091          </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-52">            Specificity : 0.7368          </div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-53">         Pos Pred Value : 0.8000          </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-54">         Neg Pred Value : 0.8750          </div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-55">             Prevalence : 0.5366          </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-56">         Detection Rate : 0.4878          </div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-57">   Detection Prevalence : 0.6098          </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-58">      Balanced Accuracy : 0.8230          </div><div class="crayon-line" id="crayon-5c0cabe97705d306345236-59">                                          </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe97705d306345236-60">       'Positive' Class : M</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Some simpler models, like linear models can output their coefficients. This is useful, because from these, you can implement the simple prediction procedure in your language of choice and use the coefficients to get the same accuracy. This gets more difficult as the complexity of the representation increases.</p>
<h3>3. Save and Load Your Model</h3>
<p>You can save your best models to a file so that you can load them up later and make predictions.</p>
<p>In this example we split the Sonar dataset into a training dataset and a validation dataset. We take our validation dataset as new data to test our final model. We train the final model using the training dataset and our optimal parameters, then save it to a file called final_model.rds in the local working directory.</p>
<p>The model is serialized. It can be loaded at a later time by calling readRDS() and assigning the object that is loaded (in this case a random forest fit) to a variable name. The loaded random forest is then used to make predictions on new data, in this case the validation dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cabe977061085182548" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load libraries
library(caret)
library(mlbench)
library(randomForest)
library(doMC)
registerDoMC(cores=8)
# load dataset
data(Sonar)
set.seed(7)
# create 80%/20% for training and validation datasets
validation_index &lt;- createDataPartition(Sonar$Class, p=0.80, list=FALSE)
validation &lt;- Sonar[-validation_index,]
training &lt;- Sonar[validation_index,]
# create final standalone model using all training data
set.seed(7)
final_model &lt;- randomForest(Class~., training, mtry=2, ntree=2000)
# save the model to disk
saveRDS(final_model, "./final_model.rds")

# later...

# load the model
super_model &lt;- readRDS("./final_model.rds")
print(super_model)
# make a predictions on "new data" using the final model
final_predictions &lt;- predict(super_model, validation[,1:60])
confusionMatrix(final_predictions, validation$Class)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cabe977061085182548-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977061085182548-2">2</div><div class="crayon-num" data-line="crayon-5c0cabe977061085182548-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977061085182548-4">4</div><div class="crayon-num" data-line="crayon-5c0cabe977061085182548-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977061085182548-6">6</div><div class="crayon-num" data-line="crayon-5c0cabe977061085182548-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977061085182548-8">8</div><div class="crayon-num" data-line="crayon-5c0cabe977061085182548-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977061085182548-10">10</div><div class="crayon-num" data-line="crayon-5c0cabe977061085182548-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977061085182548-12">12</div><div class="crayon-num" data-line="crayon-5c0cabe977061085182548-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977061085182548-14">14</div><div class="crayon-num" data-line="crayon-5c0cabe977061085182548-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977061085182548-16">16</div><div class="crayon-num" data-line="crayon-5c0cabe977061085182548-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977061085182548-18">18</div><div class="crayon-num" data-line="crayon-5c0cabe977061085182548-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977061085182548-20">20</div><div class="crayon-num" data-line="crayon-5c0cabe977061085182548-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977061085182548-22">22</div><div class="crayon-num" data-line="crayon-5c0cabe977061085182548-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977061085182548-24">24</div><div class="crayon-num" data-line="crayon-5c0cabe977061085182548-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977061085182548-26">26</div><div class="crayon-num" data-line="crayon-5c0cabe977061085182548-27">27</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cabe977061085182548-1"><span class="crayon-p"># load libraries</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977061085182548-2"><span class="crayon-e">library</span><span class="crayon-sy">(</span><span class="crayon-v">caret</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabe977061085182548-3"><span class="crayon-e">library</span><span class="crayon-sy">(</span><span class="crayon-v">mlbench</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977061085182548-4"><span class="crayon-e">library</span><span class="crayon-sy">(</span><span class="crayon-v">randomForest</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabe977061085182548-5"><span class="crayon-e">library</span><span class="crayon-sy">(</span><span class="crayon-v">doMC</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977061085182548-6"><span class="crayon-e">registerDoMC</span><span class="crayon-sy">(</span><span class="crayon-v">cores</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabe977061085182548-7"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977061085182548-8"><span class="crayon-e">data</span><span class="crayon-sy">(</span><span class="crayon-v">Sonar</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabe977061085182548-9"><span class="crayon-v">set</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977061085182548-10"><span class="crayon-p"># create 80%/20% for training and validation datasets</span></div><div class="crayon-line" id="crayon-5c0cabe977061085182548-11"><span class="crayon-v">validation_index</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">createDataPartition</span><span class="crayon-sy">(</span><span class="crayon-v">Sonar</span><span class="crayon-sy">$</span><span class="crayon-t">Class</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p</span><span class="crayon-o">=</span><span class="crayon-cn">0.80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">list</span><span class="crayon-o">=</span><span class="crayon-t">FALSE</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977061085182548-12"><span class="crayon-v">validation</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">Sonar</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">validation_index</span><span class="crayon-sy">,</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0cabe977061085182548-13"><span class="crayon-v">training</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">Sonar</span><span class="crayon-sy">[</span><span class="crayon-v">validation_index</span><span class="crayon-sy">,</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977061085182548-14"><span class="crayon-p"># create final standalone model using all training data</span></div><div class="crayon-line" id="crayon-5c0cabe977061085182548-15"><span class="crayon-v">set</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977061085182548-16"><span class="crayon-v">final_model</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">randomForest</span><span class="crayon-sy">(</span><span class="crayon-t">Class</span><span class="crayon-o">~</span><span class="crayon-sy">.</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">training</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mtry</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ntree</span><span class="crayon-o">=</span><span class="crayon-cn">2000</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabe977061085182548-17"><span class="crayon-p"># save the model to disk</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977061085182548-18"><span class="crayon-e">saveRDS</span><span class="crayon-sy">(</span><span class="crayon-v">final_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"./final_model.rds"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabe977061085182548-19"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977061085182548-20"><span class="crayon-p"># later...</span></div><div class="crayon-line" id="crayon-5c0cabe977061085182548-21"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977061085182548-22"><span class="crayon-p"># load the model</span></div><div class="crayon-line" id="crayon-5c0cabe977061085182548-23"><span class="crayon-v">super_model</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">readRDS</span><span class="crayon-sy">(</span><span class="crayon-s">"./final_model.rds"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977061085182548-24"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">super_model</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabe977061085182548-25"><span class="crayon-p"># make a predictions on "new data" using the final model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977061085182548-26"><span class="crayon-v">final_predictions</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">super_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation</span><span class="crayon-sy">[</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-cn">60</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0cabe977061085182548-27"><span class="crayon-e">confusionMatrix</span><span class="crayon-sy">(</span><span class="crayon-v">final_predictions</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation</span><span class="crayon-sy">$</span><span class="crayon-t">Class</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>We can see that the accuracy on the validation dataset was 82.93%.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0cabe977063652545206" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Confusion Matrix and Statistics

          Reference
Prediction  M  R
         M 20  5
         R  2 14
                                          
               Accuracy : 0.8293          
                 95% CI : (0.6794, 0.9285)
    No Information Rate : 0.5366          
    P-Value [Acc &gt; NIR] : 8.511e-05       
                                          
                  Kappa : 0.653           
 Mcnemar's Test P-Value : 0.4497          
                                          
            Sensitivity : 0.9091          
            Specificity : 0.7368          
         Pos Pred Value : 0.8000          
         Neg Pred Value : 0.8750          
             Prevalence : 0.5366          
         Detection Rate : 0.4878          
   Detection Prevalence : 0.6098          
      Balanced Accuracy : 0.8230          
                                          
       'Positive' Class : M</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0cabe977063652545206-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977063652545206-2">2</div><div class="crayon-num" data-line="crayon-5c0cabe977063652545206-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977063652545206-4">4</div><div class="crayon-num" data-line="crayon-5c0cabe977063652545206-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977063652545206-6">6</div><div class="crayon-num" data-line="crayon-5c0cabe977063652545206-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977063652545206-8">8</div><div class="crayon-num" data-line="crayon-5c0cabe977063652545206-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977063652545206-10">10</div><div class="crayon-num" data-line="crayon-5c0cabe977063652545206-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977063652545206-12">12</div><div class="crayon-num" data-line="crayon-5c0cabe977063652545206-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977063652545206-14">14</div><div class="crayon-num" data-line="crayon-5c0cabe977063652545206-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977063652545206-16">16</div><div class="crayon-num" data-line="crayon-5c0cabe977063652545206-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977063652545206-18">18</div><div class="crayon-num" data-line="crayon-5c0cabe977063652545206-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977063652545206-20">20</div><div class="crayon-num" data-line="crayon-5c0cabe977063652545206-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977063652545206-22">22</div><div class="crayon-num" data-line="crayon-5c0cabe977063652545206-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0cabe977063652545206-24">24</div><div class="crayon-num" data-line="crayon-5c0cabe977063652545206-25">25</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0cabe977063652545206-1">Confusion Matrix and Statistics</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977063652545206-2"> </div><div class="crayon-line" id="crayon-5c0cabe977063652545206-3">          Reference</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977063652545206-4">Prediction  M  R</div><div class="crayon-line" id="crayon-5c0cabe977063652545206-5">         M 20  5</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977063652545206-6">         R  2 14</div><div class="crayon-line" id="crayon-5c0cabe977063652545206-7">                                          </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977063652545206-8">               Accuracy : 0.8293          </div><div class="crayon-line" id="crayon-5c0cabe977063652545206-9">                 95% CI : (0.6794, 0.9285)</div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977063652545206-10">    No Information Rate : 0.5366          </div><div class="crayon-line" id="crayon-5c0cabe977063652545206-11">    P-Value [Acc &gt; NIR] : 8.511e-05       </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977063652545206-12">                                          </div><div class="crayon-line" id="crayon-5c0cabe977063652545206-13">                  Kappa : 0.653           </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977063652545206-14"> Mcnemar's Test P-Value : 0.4497          </div><div class="crayon-line" id="crayon-5c0cabe977063652545206-15">                                          </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977063652545206-16">            Sensitivity : 0.9091          </div><div class="crayon-line" id="crayon-5c0cabe977063652545206-17">            Specificity : 0.7368          </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977063652545206-18">         Pos Pred Value : 0.8000          </div><div class="crayon-line" id="crayon-5c0cabe977063652545206-19">         Neg Pred Value : 0.8750          </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977063652545206-20">             Prevalence : 0.5366          </div><div class="crayon-line" id="crayon-5c0cabe977063652545206-21">         Detection Rate : 0.4878          </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977063652545206-22">   Detection Prevalence : 0.6098          </div><div class="crayon-line" id="crayon-5c0cabe977063652545206-23">      Balanced Accuracy : 0.8230          </div><div class="crayon-line crayon-striped-line" id="crayon-5c0cabe977063652545206-24">                                          </div><div class="crayon-line" id="crayon-5c0cabe977063652545206-25">       'Positive' Class : M</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Summary</h2>
<p>In this post you discovered three recipes for working with final predictive models:</p>
<ol>
<li>How to make predictions using the best model from caret tuning.</li>
<li>How to create a standalone model using the parameters found during caret tuning.</li>
<li>How to save and later load a standalone model and use it to make predictions.</li>
</ol>
<p>You can work through these recipes to understand them better. You can also use them as a template and copy-and-paste them into your current or next machine learning project.</p>
<h2>Next Step</h2>
<p>Did you try out these recipes?</p>
<ol>
<li>Start your R interactive environment.</li>
<li>Type or copy-paste the recipes above and try them out.</li>
<li>Use the built-in help in R to learn more about the functions used.</li>
</ol>
<p>Do you have a question. Ask it in the comments and I will do my best to answer it.</p>
<!-- Shortcoder conditions not met -->
<div class="awac-wrapper"><div class="awac widget text-39"> <div class="textwidget"><p></p><div class="woo-sc-hr"></div><br/>
<center>
<h2>Frustrated With Your Progress In R Machine Learning?</h2>
<p><a href="/machine-learning-with-r/"><img align="left" alt="Master Machine Learning With R" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/02/MachineLearningMasteryWithR-small.png" style="border: 0;"/></a></p>
<h4>Develop Your Own Models in Minutes</h4>
<p>…with just a few lines of R code</p>
<p>Discover how in my new Ebook:<br/>
<a href="/machine-learning-with-r/">Machine Learning Mastery With R</a></p>
<p>Covers <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> like:<br/>Loading data, visualization, build models, tuning, and much more…</p>
<h4>Finally Bring Machine Learning To<br/>Your Own Projects</h4>
<p>Skip the Academics. Just Results.</p>
<p><a href="/machine-learning-with-r/">Click to learn more</a>.</p>
<p></p></center><br/>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-2212 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=Save+And+Finalize+Your+Machine+Learning+Model+in+R&amp;url=https://machinelearningmastery.com/finalize-machine-learning-models-in-r/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/finalize-machine-learning-models-in-r/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/finalize-machine-learning-models-in-r/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/finalize-machine-learning-models-in-r/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
</section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/pre-process-your-dataset-in-r/" rel="prev"><i class="fa fa-angle-left"></i> Get Your Data Ready For Machine Learning in R with Pre-Processing</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/machine-learning-project-template-in-r/" rel="next">Machine Learning Project Template in R <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">30 Responses to <em>Save And Finalize Your Machine Learning Model in R</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-368962">
<div class="comment-container" id="li-comment-368962">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ee1f31b7c94feb674814b8b79f4707de?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ee1f31b7c94feb674814b8b79f4707de?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">John ford</span>
<span class="date">November 1, 2016 at 3:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-368962" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi.  I’ve been working through the examples, and some models of my own, and i have a question on preprocessing my data.</p>
<p>When training my models, I used the preProcess argument to center and scale the data.  </p>
<p>When I have a new data set to run through my model after training, does the model know to preprocess that data as well?  Or do i have to manually scale and center the new data set before applying the model to it?    What about after saving and reloading the final model?</p>
<p>this is one of the less-clear points in the docs.</p>
<div class="reply">
<a aria-label="Reply to John ford" class="comment-reply-link" href="#comment-368962" onclick='return addComment.moveForm( "comment-368962", "368962", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-369072">
<div class="comment-container" id="li-comment-369072">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 2, 2016 at 9:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-369072" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi John, great question.</p>
<p>The safest way is to managing data scaling separately and save scaled versions of your data as well as the coefficients needed to scale new data in the future.</p>
<p>According to the caret doco, any preprocessing applied during training will be applied to later calls to predict() on new data:<br/>
<a href="http://topepo.github.io/caret/model-training-and-tuning.html#preproc" rel="nofollow">http://topepo.github.io/caret/model-training-and-tuning.html#preproc</a></p>
<p>I would expect this to be preserved if you saved the trained model, but I would suggest testing this out (do pre-save and post-save results match for a model with preprocessing).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-369072" onclick='return addComment.moveForm( "comment-369072", "369072", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-401800">
<div class="comment-container" id="li-comment-401800">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hans</span>
<span class="date">June 7, 2017 at 9:41 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-401800" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Are there concerns about applying this to non-classification-problems?<br/>
What would be the differences?</p>
<div class="reply">
<a aria-label="Reply to Hans" class="comment-reply-link" href="#comment-401800" onclick='return addComment.moveForm( "comment-401800", "401800", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401837">
<div class="comment-container" id="li-comment-401837">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 8, 2017 at 7:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-401837" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No difference of note.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401837" onclick='return addComment.moveForm( "comment-401837", "401837", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-401949">
<div class="comment-container" id="li-comment-401949">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hans</span>
<span class="date">June 9, 2017 at 6:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-401949" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hm…</p>
<p>Error: Metric Accuracy not applicable for regression models<br/>
Error in <code>[.data.frame</code>(validation, , 1:60) : undefined columns selected</p>
<div class="reply">
<a aria-label="Reply to Hans" class="comment-reply-link" href="#comment-401949" onclick='return addComment.moveForm( "comment-401949", "401949", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-4" id="comment-401950">
<div class="comment-container" id="li-comment-401950">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hans</span>
<span class="date">June 9, 2017 at 7:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-401950" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>1. &amp; 2. fixed, Still getting errors:<br/>
Error in confusionMatrix.default(final_predictions, validation$n5) :<br/>
  the data cannot have more levels than the reference</p>
<div class="reply">
<a aria-label="Reply to Hans" class="comment-reply-link" href="#comment-401950" onclick='return addComment.moveForm( "comment-401950", "401950", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-401952">
<div class="comment-container" id="li-comment-401952">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hans</span>
<span class="date">June 9, 2017 at 7:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-401952" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If I do a print(final_predictions), I get: </p>
<p>3   6   9  11  18  19  21  26  29  39  47  50  61  63  74  92  94  95  97  99 101 104 111 114<br/>
  M   R   M   R   R   R   M   R   M   R   M   R   R   R   R   R   R   R   R   M   M   R   M   M<br/>
117 120 126 129 137 138 145 146 148 155 160 164 170 171 173 191 206<br/>
  M   M   M   M   M   M   M   M   M   M   M   M   M   R   M   M   M </p>
<p>The last data point has a row index of 206. The original data from Sonar has an end index of 208.<br/>
So where is the unseen data here? Are the row indexes in depended from each other?</p>
<div class="reply">
<a aria-label="Reply to Hans" class="comment-reply-link" href="#comment-401952" onclick='return addComment.moveForm( "comment-401952", "401952", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-401953">
<div class="comment-container" id="li-comment-401953">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hans</span>
<span class="date">June 9, 2017 at 7:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-401953" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How to predict one step of unseen data in the future with example 2?</p>
<div class="reply">
<a aria-label="Reply to Hans" class="comment-reply-link" href="#comment-401953" onclick='return addComment.moveForm( "comment-401953", "401953", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-403213">
<div class="comment-container" id="li-comment-403213">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/11afa04c2343196a27248e6b995cd648?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/11afa04c2343196a27248e6b995cd648?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://apice.unibo.it/xwiki/bin/view/StefanoMariani/" rel="external nofollow">Ste</a></span>
<span class="date">June 20, 2017 at 10:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-403213" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason, thanks for the precious post.</p>
<p>I’m going a bit too far maybe, but I’ve been wondering recently if it is possible to save a trained model in some kind of standard format so that it can be (1) sent over a network and (2) parsed even by a different language (I dunno, Java for example).</p>
<p>Are you aware of anything similar, for R or (possibly) other machine learning / statistics suites?</p>
<p>Apologies if the question is considered off-topic.</p>
<div class="reply">
<a aria-label="Reply to Ste" class="comment-reply-link" href="#comment-403213" onclick='return addComment.moveForm( "comment-403213", "403213", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-403265">
<div class="comment-container" id="li-comment-403265">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 21, 2017 at 8:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-403265" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I believe there are standard model formats, but I am not an expert in them.</p>
<p>See the Predictive Model Markup Language<br/>
<a href="https://en.wikipedia.org/wiki/Predictive_Model_Markup_Language" rel="nofollow">https://en.wikipedia.org/wiki/Predictive_Model_Markup_Language</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-403265" onclick='return addComment.moveForm( "comment-403265", "403265", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-407284">
<div class="comment-container" id="li-comment-407284">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8fcb5777ac29afdff8a074dd744cf0d0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8fcb5777ac29afdff8a074dd744cf0d0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chandra</span>
<span class="date">July 25, 2017 at 11:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-407284" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason – Thanks for the example! This came in very handy and just in time for me.</p>
<div class="reply">
<a aria-label="Reply to Chandra" class="comment-reply-link" href="#comment-407284" onclick='return addComment.moveForm( "comment-407284", "407284", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-407328">
<div class="comment-container" id="li-comment-407328">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 26, 2017 at 7:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-407328" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad to hear that!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-407328" onclick='return addComment.moveForm( "comment-407328", "407328", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-413014">
<div class="comment-container" id="li-comment-413014">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e30b6a48cba7fd9b3169039d4cd483cc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e30b6a48cba7fd9b3169039d4cd483cc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://z01.ch" rel="external nofollow">Christian Ruiz</a></span>
<span class="date">September 7, 2017 at 7:39 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-413014" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason<br/>
Great website! Thank you for the very valuable information.</p>
<p>I have a short question concerning the “standalone model”. Why is it necessary to use it after using the caret one? I though bought would be equivalent (i.e. caret using the randomForest one in this example of “rf”-method) and am now a bit confused.</p>
<p>Cheers,<br/>
Chris</p>
<div class="reply">
<a aria-label="Reply to Christian Ruiz" class="comment-reply-link" href="#comment-413014" onclick='return addComment.moveForm( "comment-413014", "413014", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-413201">
<div class="comment-container" id="li-comment-413201">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 9, 2017 at 11:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-413201" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Caret is a wrapper for the models that can help us find which model to use.</p>
<p>Once we know which model to use, we can use it directly without the caret wrapper – if we want.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-413201" onclick='return addComment.moveForm( "comment-413201", "413201", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-438369">
<div class="comment-container" id="li-comment-438369">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e30b6a48cba7fd9b3169039d4cd483cc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e30b6a48cba7fd9b3169039d4cd483cc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Christian Ruiz</span>
<span class="date">May 24, 2018 at 12:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-438369" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Christian Ruiz" class="comment-reply-link" href="#comment-438369" onclick='return addComment.moveForm( "comment-438369", "438369", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-414272">
<div class="comment-container" id="li-comment-414272">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b66482667a7d1c68e9e272f71cd20a2a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b66482667a7d1c68e9e272f71cd20a2a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://N.A" rel="external nofollow">SUMANTA</a></span>
<span class="date">September 19, 2017 at 3:39 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-414272" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Excellent work and quite helpful for us who is in learning mode. Just one question here. Suppose, I’ve 100 data-points and I divide into train &amp; test (80 &amp; 20). I fit the model and see accuracy as 75%. My question is how do I implement this model so that when 101st and 102nd data arrives, this model runs and provides me some classification?</p>
<div class="reply">
<a aria-label="Reply to SUMANTA" class="comment-reply-link" href="#comment-414272" onclick='return addComment.moveForm( "comment-414272", "414272", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-414274">
<div class="comment-container" id="li-comment-414274">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 19, 2017 at 3:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-414274" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I believe this post shows you how to save the model and load it to make predictions on new data.</p>
<p>Perhaps this post will make things clearer:<br/>
<a href="https://machinelearningmastery.com/train-final-machine-learning-model/" rel="nofollow">https://machinelearningmastery.com/train-final-machine-learning-model/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-414274" onclick='return addComment.moveForm( "comment-414274", "414274", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-414586">
<div class="comment-container" id="li-comment-414586">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/34f830be520059100796948310f3767a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/34f830be520059100796948310f3767a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Monte</span>
<span class="date">September 23, 2017 at 4:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-414586" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason.</p>
<p>The “finalize machine learning models” article above is helpful, and I can’t wait to try it out. However, I notice that it’s making one prediction. Is here a way to get multiple predictions at once, based on criteria, and give them as a list? Like this:</p>
<p>Item 1…result<br/>
Item 2…result</p>
<div class="reply">
<a aria-label="Reply to Monte" class="comment-reply-link" href="#comment-414586" onclick='return addComment.moveForm( "comment-414586", "414586", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-414610">
<div class="comment-container" id="li-comment-414610">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 23, 2017 at 5:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-414610" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, the predict function will support this by default.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-414610" onclick='return addComment.moveForm( "comment-414610", "414610", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-418897">
<div class="comment-container" id="li-comment-418897">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2161dc8b37c990d0b4f6cba0a4ef4ef7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2161dc8b37c990d0b4f6cba0a4ef4ef7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Zalak</span>
<span class="date">November 3, 2017 at 6:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-418897" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Sir,<br/>
I am doing dissertation in load balancing in distributed computing system in which I want to predict the future incoming jobs on the basis of past load information given in the real time dataset.So how can I apply this technique in my work?</p>
<div class="reply">
<a aria-label="Reply to Zalak" class="comment-reply-link" href="#comment-418897" onclick='return addComment.moveForm( "comment-418897", "418897", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-418949">
<div class="comment-container" id="li-comment-418949">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 4, 2017 at 5:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-418949" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This might be a good place for you to start:<br/>
<a href="https://machinelearningmastery.com/start-here/#timeseries" rel="nofollow">https://machinelearningmastery.com/start-here/#timeseries</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-418949" onclick='return addComment.moveForm( "comment-418949", "418949", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-419092">
<div class="comment-container" id="li-comment-419092">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/36f897efa5b3608b5d7c612333f33138?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/36f897efa5b3608b5d7c612333f33138?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Martín Solís</span>
<span class="date">November 6, 2017 at 2:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-419092" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason , I have a question, maybe you can help me. </p>
<p>I am using caret, and I need to print the function of a ramdom forest best model,  I am talking about all the trees, that are 100.<br/>
 I know with model$finalModel I can print the function of neuronal network or tree with rpart, but this command don’t print all the trees of random forest or the function of boosted trees<br/>
Do you Know how I can do it </p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Martín Solís" class="comment-reply-link" href="#comment-419092" onclick='return addComment.moveForm( "comment-419092", "419092", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-419112">
<div class="comment-container" id="li-comment-419112">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 6, 2017 at 4:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-419112" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I have not printed all of the trees from a random forest before. Perhaps there is a third party tool to help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-419112" onclick='return addComment.moveForm( "comment-419112", "419112", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-434551">
<div class="comment-container" id="li-comment-434551">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7072444435dfbbeb2b6674c77cc58678?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7072444435dfbbeb2b6674c77cc58678?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Srini</span>
<span class="date">April 9, 2018 at 10:56 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-434551" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason! Thanks for the post. I have a question to you.</p>
<p>I have a built a highly accurate random forest model for a student enrollment prediction project ,let’s say, for this year. Now I have saved the model and want to use this model for data belonging to ,let’s assume, last year. But the number of variables in my last year’s data has changed. How to approach this situation? Is there any way to scale this model to fit the new case?</p>
<p>Thank you!</p>
<div class="reply">
<a aria-label="Reply to Srini" class="comment-reply-link" href="#comment-434551" onclick='return addComment.moveForm( "comment-434551", "434551", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-434600">
<div class="comment-container" id="li-comment-434600">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 10, 2018 at 6:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-434600" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This process will help you work through your problem systematically:<br/>
<a href="https://machinelearningmastery.com/start-here/#process" rel="nofollow">https://machinelearningmastery.com/start-here/#process</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-434600" onclick='return addComment.moveForm( "comment-434600", "434600", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-434631">
<div class="comment-container" id="li-comment-434631">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2a11794f7b3e51a60dd3166cdd2ab155?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2a11794f7b3e51a60dd3166cdd2ab155?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Srini</span>
<span class="date">April 10, 2018 at 12:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-434631" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason!</p>
<div class="reply">
<a aria-label="Reply to Srini" class="comment-reply-link" href="#comment-434631" onclick='return addComment.moveForm( "comment-434631", "434631", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-444759">
<div class="comment-container" id="li-comment-444759">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/01eaf7960f7e979e5a07cfa6ce5cf6ca?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/01eaf7960f7e979e5a07cfa6ce5cf6ca?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ken</span>
<span class="date">July 30, 2018 at 7:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-444759" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello guys! What ML tool (regression model) would be appropriate for predicting call center call volume</p>
<div class="reply">
<a aria-label="Reply to Ken" class="comment-reply-link" href="#comment-444759" onclick='return addComment.moveForm( "comment-444759", "444759", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-444781">
<div class="comment-container" id="li-comment-444781">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 30, 2018 at 2:13 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-444781" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This process will help you work through your predictive modeling problem:<br/>
<a href="https://machinelearningmastery.com/start-here/#process" rel="nofollow">https://machinelearningmastery.com/start-here/#process</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444781" onclick='return addComment.moveForm( "comment-444781", "444781", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-456435">
<div class="comment-container" id="li-comment-456435">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e45a96f1129237717c67ea1a0371da3e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e45a96f1129237717c67ea1a0371da3e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Griffin</span>
<span class="date">November 28, 2018 at 12:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-456435" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>many thanks for this superb post! </p>
<p>Would like to know if the following process (essentially what you did in this post) is considered best practice or common practice in ML and DS:<br/>
1. Perform cross-validation to tune hyperparameters<br/>
2. using optimised hyperparameters to train the ENTIRE training dataset to arrive at an optimal accuracy?</p>
<p>And also, in part 3 on saving and loading the model, I am encountering problems with the doMC package in R and I understand that doMC is not usable in windows. Could you suggest alternative workaround for this?</p>
<p>Thank you so much</p>
<div class="reply">
<a aria-label="Reply to Griffin" class="comment-reply-link" href="#comment-456435" onclick='return addComment.moveForm( "comment-456435", "456435", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-456444">
<div class="comment-container" id="li-comment-456444">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 28, 2018 at 2:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/finalize-machine-learning-models-in-r/#comment-456444" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, you can learn more here:<br/>
<a href="https://machinelearningmastery.com/train-final-machine-learning-model/" rel="nofollow">https://machinelearningmastery.com/train-final-machine-learning-model/</a></p>
<p>The doMC might not be supported on Windows. Perhaps comment it out for now?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-456444" onclick='return addComment.moveForm( "comment-456444", "456444", "respond", "2212" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/finalize-machine-learning-models-in-r/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="2212"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="0202d75c8d"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="79"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery!</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Jason Brownlee, PhD
<br/>
I write tutorials to help developers (<i>like you</i>) get results with machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-8"> <div class="textwidget"><p></p><center><br/>
<strong>Machine Learning with R</strong><br/>
The platform preferred by top practitioners.
<p><a href="/machine-learning-with-r/">Click to Get Started Now!</a><br/>
<a href="/machine-learning-with-r/"><img alt="Machine Learning Mastery With R" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/02/MachineLearningMasteryWithR-small.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch"><img alt="How to Develop a Neural Machine Translation System in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/01/How-to-Develop-a-Neural-Machine-Translation-System-in-Keras-150x150.jpg" title="How to Develop a Neural Machine Translation System from Scratch" width="45"/></a> <a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch">How to Develop a Neural Machine Translation System from Scratch</a>
<span class="meta">January 10, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning"><img alt="Difference Between Classification and Regression in Machine Learning" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/Difference-Between-Classification-and-Regression-in-Machine-Learning-150x150.jpg" title="Difference Between Classification and Regression in Machine Learning" width="45"/></a> <a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning">Difference Between Classification and Regression in Machine Learning</a>
<span class="meta">December 11, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem..."><img alt="So, You are Working on a Machine Learning Problem..." class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/So-You-are-Working-on-a-Machine-Learning-Problem...-150x150.jpg" title="So, You are Working on a Machine Learning Problem..." width="45"/></a> <a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem…">So, You are Working on a Machine Learning Problem…</a>
<span class="meta">April 4, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis"><img alt="Plot of the Multichannel Convolutional Neural Network For Text" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-150x150.png" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis" width="45"/></a> <a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis">How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis</a>
<span class="meta">January 12, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras"><img alt="How to Make Classification and Regression Predictions for Deep Learning Models in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/How-to-Make-Classification-and-Regression-Predictions-for-Deep-Learning-Models-in-Keras-150x150.jpg" title="How to Make Predictions with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras">How to Make Predictions with Keras</a>
<span class="meta">April 9, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)"><img alt="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/11-Classical-Time-Series-Forecasting-Methods-in-Python-Cheat-Sheet-150x150.jpg" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)">11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)</a>
<span class="meta">August 6, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras"><img alt="How to Visualize a Deep Learning Neural Network Model in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/How-to-Visualize-a-Deep-Learning-Neural-Network-Model-in-Keras-150x150.jpg" title="How to Visualize a Deep Learning Neural Network Model in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras">How to Visualize a Deep Learning Neural Network Model in Keras</a>
<span class="meta">December 13, 2017</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> <div class="widget_text widget widget_custom_html" id="custom_html-2"><h3>You might also like…</h3><div class="textwidget custom-html-widget"><ul>
<li><a href="/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Install Python for Machine Learning</a></li>
<li><a href="/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python</a></li>
<li><a href="/tutorial-first-neural-network-python-keras/">Your First Neural Network in Python</a></li>
<li><a href="/how-to-run-your-first-classifier-in-weka/">Your First Classifier in Weka</a></li>
<li><a href="/arima-for-time-series-forecasting-with-python/">Your First Time Series Forecasting Project</a></li>
</ul></div></div></aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/disclaimer/">Disclaimer</a> | 
<a href="/terms-of-service/">Terms</a> | 
<a href="/contact/">Contact</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.8" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.0.5" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.8" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.1" type="text/javascript"></script>
</body>
</html>