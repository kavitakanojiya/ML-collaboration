<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v9.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>How to Implement the Backpropagation Algorithm From Scratch In Python</title>
<link href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="How to Implement the Backpropagation Algorithm From Scratch In Python" property="og:title"/>
<meta content="The backpropagation algorithm is the classical feed-forward artificial neural network. It is the technique still used to train large deep learning networks. In this tutorial, you will discover how to implement the backpropagation algorithm from scratch with Python. After completing this tutorial, you will know: How to forward-propagate an input to calculate an output. How …" property="og:description"/>
<meta content="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="https://www.facebook.com/jason.brownlee.39" property="article:author"/>
<meta content="Code Machine Learning Algorithms From Scratch" property="article:section"/>
<meta content="2016-11-06T18:00:52+00:00" property="article:published_time"/>
<meta content="2018-08-27T22:09:56+00:00" property="article:modified_time"/>
<meta content="2018-08-27T22:09:56+00:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-the-Backpropagation-Algorithm-From-Scratch-In-Python.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-the-Backpropagation-Algorithm-From-Scratch-In-Python.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="512" property="og:image:height"/>
<meta content="How to Implement the Backpropagation Algorithm From Scratch In Python" property="og:image:alt"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"https:\/\/machinelearningmastery.com\/#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/feed/" rel="alternate" title="Machine Learning Mastery » How to Implement the Backpropagation Algorithm From Scratch In Python Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<style media="all" type="text/css">
.wpautoterms-footer{background-color:#ffffff;text-align:center;}
.wpautoterms-footer a{color:#000000;font-family:Arial, sans-serif;font-size:14px;}
.wpautoterms-footer .separator{color:#cccccc;font-family:Arial, sans-serif;font-size:14px;}</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/auto-terms-of-service-and-privacy-policy/css/wpautoterms.css?ver=4.9.8" id="wpautoterms_css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.0.5" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/css/front.css?ver=2.0.20" id="ssb-front-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/ewd-ufaq-styles.css?ver=4.9.8" id="ewd-ufaq-style-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/rrssb-min.css?ver=4.9.8" id="ewd-ufaq-rrssb-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.8" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=2.0.20" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.8" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.8" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=3349" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-backpropagation-algorithm-scratch-python%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fimplement-backpropagation-algorithm-scratch-python%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<style media="screen">

        .simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
      margin: ;
    }
         /*inline margin*/
    
  
  
  
  
  
          .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
         margin: ;
     }

          /*margin-digbar*/

  
  
  
  
 
   
   

</style>
<script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#4c89bf; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#4c89bf;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#4c89bf!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#ffffff;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-3349 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/icon-100x100.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-18"> <div class="textwidget"><p>Want help with machine learning? <a href="https://machinelearningmastery.leadpages.co/machine-learning-resource-guide/">Take the FREE Crash-Course</a>.</p>
</div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<input name="post_type" type="hidden" value="post"/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Main Menu</h3><ul class="nav fl" id="main-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503" id="menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Start Here</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501" id="menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506" id="menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508" id="menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (Keras)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511" id="menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509" id="menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515" id="menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">Deep Learning for NLP</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512" id="menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Understand Algorithms</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6507" id="menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms (Python)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6513" id="menu-item-6513"><a href="https://machinelearningmastery.com/category/machine-learning-process/">Machine Learning Process</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516" id="menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517" id="menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522" id="menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6518" id="menu-item-6518"><a href="https://machinelearningmastery.com/category/start-machine-learning/">Getting Started</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510" id="menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519" id="menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistical Methods</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520" id="menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Time Series (introductory)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523" id="menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6514" id="menu-item-6514"><a href="https://machinelearningmastery.com/category/machine-learning-resources/">Resources</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502" id="menu-item-6502"><a href="https://machinelearningmastery.com/products/">Ebooks</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500" id="menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504" id="menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505" id="menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-3349 post type-post status-publish format-standard has-post-thumbnail hentry category-algorithms-from-scratch">
<header>
<h1 class="title entry-title">How to Implement the Backpropagation Algorithm From Scratch In Python</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-11-07T05:00:52+1100">November 7, 2016</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/" title="View all items in Code Machine Learning Algorithms From Scratch">Code Machine Learning Algorithms From Scratch</a></span> </div>
<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-3349 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Implement+the+Backpropagation+Algorithm+From+Scratch+In+Python&amp;url=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
<p>The backpropagation algorithm is the classical feed-forward artificial neural network.</p>
<p>It is the technique still used to train large <a href="http://machinelearningmastery.com/what-is-deep-learning/">deep learning</a> networks.</p>
<p>In this tutorial, you will discover how to implement the backpropagation algorithm from scratch with Python.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>How to forward-propagate an input to calculate an output.</li>
<li>How to back-propagate error and train a network.</li>
<li>How to apply the backpropagation algorithm to a real-world predictive modeling problem.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Nov/2016</strong>: Fixed a bug in the activate() function. Thanks Alex!</li>
<li><strong>Update Jan/2017</strong>: Changed the calculation of fold_size in cross_validation_split() to always be an integer. Fixes issues with Python 3.</li>
<li><strong>Update Jan/2017</strong>: Updated small bug in update_weights(). Thanks Tomasz!</li>
<li><strong>Update Apr/2018</strong>: Added direct link to CSV dataset.</li>
<li><strong>Update Aug/2018</strong>: Tested and updated to work with Python 3.6.</li>
</ul>
<div class="wp-caption aligncenter" id="attachment_3350" style="width: 650px"><img alt="How to Implement the Backpropagation Algorithm From Scratch In Python" class="size-full wp-image-3350" height="512" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-the-Backpropagation-Algorithm-From-Scratch-In-Python.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-the-Backpropagation-Algorithm-From-Scratch-In-Python.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/11/How-to-Implement-the-Backpropagation-Algorithm-From-Scratch-In-Python-300x240.jpg 300w" width="640"/><p class="wp-caption-text">How to Implement the Backpropagation Algorithm From Scratch In Python<br/>Photo by <a href="https://www.flickr.com/photos/nichd/21086425615/">NICHD</a>, some rights reserved.</p></div>
<h2>Description</h2>
<p>This section provides a brief introduction to the Backpropagation Algorithm and the Wheat Seeds dataset that we will be using in this tutorial.</p>
<h3>Backpropagation Algorithm</h3>
<p>The Backpropagation algorithm is a supervised learning method for multilayer feed-forward networks from the field of Artificial Neural Networks.</p>
<p>Feed-forward neural networks are inspired by the information processing of one or more neural cells, called a neuron. A neuron accepts input signals via its dendrites, which pass the electrical signal down to the cell body. The axon carries the signal out to synapses, which are the connections of a cell’s axon to other cell’s dendrites.</p>
<p>The principle of the backpropagation approach is to model a given function by modifying internal weightings of input signals to produce an expected output signal. The system is trained using a supervised learning method, where the error between the system’s output and a known expected output is presented to the system and used to modify its internal state.</p>
<p>Technically, the backpropagation algorithm is a method for training the weights in a multilayer feed-forward neural network. As such, it requires a network structure to be defined of one or more layers where one layer is fully connected to the next layer. A standard network structure is one input layer, one hidden layer, and one output layer.</p>
<p>Backpropagation can be used for both classification and regression problems, but we will focus on classification in this tutorial.</p>
<p>In classification problems, best results are achieved when the network has one neuron in the output layer for each class value. For example, a 2-class or binary classification problem with the class values of A and B. These expected outputs would have to be transformed into binary vectors with one column for each class value. Such as [1, 0] and [0, 1] for A and B respectively. This is called a one hot encoding.</p>
<h3>Wheat Seeds Dataset</h3>
<p>The seeds dataset involves the prediction of species given measurements seeds from different varieties of wheat.</p>
<p>There are 201 records and 7 numerical input variables. It is a classification problem with 3 output classes. The scale for each numeric input value vary, so some data normalization may be required for use with algorithms that weight inputs like the backpropagation algorithm.</p>
<p>Below is a sample of the first 5 rows of the dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038af010180593" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
15.26,14.84,0.871,5.763,3.312,2.221,5.22,1
14.88,14.57,0.8811,5.554,3.333,1.018,4.956,1
14.29,14.09,0.905,5.291,3.337,2.699,4.825,1
13.84,13.94,0.8955,5.324,3.379,2.259,4.805,1
16.14,14.99,0.9034,5.658,3.562,1.355,5.175,1</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038af010180593-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038af010180593-2">2</div><div class="crayon-num" data-line="crayon-5c0ca806038af010180593-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038af010180593-4">4</div><div class="crayon-num" data-line="crayon-5c0ca806038af010180593-5">5</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038af010180593-1">15.26,14.84,0.871,5.763,3.312,2.221,5.22,1</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038af010180593-2">14.88,14.57,0.8811,5.554,3.333,1.018,4.956,1</div><div class="crayon-line" id="crayon-5c0ca806038af010180593-3">14.29,14.09,0.905,5.291,3.337,2.699,4.825,1</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038af010180593-4">13.84,13.94,0.8955,5.324,3.379,2.259,4.805,1</div><div class="crayon-line" id="crayon-5c0ca806038af010180593-5">16.14,14.99,0.9034,5.658,3.562,1.355,5.175,1</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Using the Zero Rule algorithm that predicts the most common class value, the baseline accuracy for the problem is 28.095%.</p>
<p>You can learn more and download the seeds dataset from the <a href="http://archive.ics.uci.edu/ml/datasets/seeds">UCI Machine Learning Repository</a>.</p>
<p>Download the seeds dataset and place it into your current working directory with the filename <strong>seeds_dataset.csv</strong>.</p>
<p>The dataset is in tab-separated format, so you must convert it to CSV using a text editor or a spreadsheet program.</p>
<p>Update, download the dataset in CSV format directly:</p>
<ul>
<li><a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/wheat-seeds.csv">Download Wheat Seeds Dataset</a></li>
</ul>
<h2>Tutorial</h2>
<p>This tutorial is broken down into 6 parts:</p>
<ol>
<li>Initialize Network.</li>
<li>Forward Propagate.</li>
<li>Back Propagate Error.</li>
<li>Train Network.</li>
<li>Predict.</li>
<li>Seeds Dataset Case Study.</li>
</ol>
<p>These steps will provide the foundation that you need to implement the backpropagation algorithm from scratch and apply it to your own predictive modeling problems.</p>
<h3>1. Initialize Network</h3>
<p>Let’s start with something easy, the creation of a new network ready for training.</p>
<p>Each neuron has a set of weights that need to be maintained. One weight for each input connection and an additional weight for the bias. We will need to store additional properties for a neuron during training, therefore we will use a dictionary to represent each neuron and store properties by names such as ‘<strong>weights</strong>‘ for the weights.</p>
<p>A network is organized into layers. The input layer is really just a row from our training dataset. The first real layer is the hidden layer. This is followed by the output layer that has one neuron for each class value.</p>
<p>We will organize layers as arrays of dictionaries and treat the whole network as an array of layers.</p>
<p>It is good practice to initialize the network weights to small random numbers. In this case, will we use random numbers in the range of 0 to 1.</p>
<p>Below is a function named <strong>initialize_network()</strong> that creates a new neural network ready for training. It accepts three parameters, the number of inputs, the number of neurons to have in the hidden layer and the number of outputs.</p>
<p>You can see that for the hidden layer we create <strong>n_hidden</strong> neurons and each neuron in the hidden layer has <strong>n_inputs + 1</strong> weights, one for each input column in a dataset and an additional one for the bias.</p>
<p>You can also see that the output layer that connects to the hidden layer has <strong>n_outputs</strong> neurons, each with <strong>n_hidden + 1</strong> weights. This means that each neuron in the output layer connects to (has a weight for) each neuron in the hidden layer.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038b9399645997" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Initialize a network
def initialize_network(n_inputs, n_hidden, n_outputs):
	network = list()
	hidden_layer = [{'weights':[random() for i in range(n_inputs + 1)]} for i in range(n_hidden)]
	network.append(hidden_layer)
	output_layer = [{'weights':[random() for i in range(n_hidden + 1)]} for i in range(n_outputs)]
	network.append(output_layer)
	return network</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038b9399645997-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038b9399645997-2">2</div><div class="crayon-num" data-line="crayon-5c0ca806038b9399645997-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038b9399645997-4">4</div><div class="crayon-num" data-line="crayon-5c0ca806038b9399645997-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038b9399645997-6">6</div><div class="crayon-num" data-line="crayon-5c0ca806038b9399645997-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038b9399645997-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038b9399645997-1"><span class="crayon-p"># Initialize a network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038b9399645997-2"><span class="crayon-e">def </span><span class="crayon-e">initialize_network</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hidden</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038b9399645997-3"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038b9399645997-4"><span class="crayon-h"> </span><span class="crayon-v">hidden_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038b9399645997-5"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">hidden_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038b9399645997-6"><span class="crayon-h"> </span><span class="crayon-v">output_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038b9399645997-7"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">output_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038b9399645997-8"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">network</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>Let’s test out this function. Below is a complete example that creates a small network.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038bb636147586" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from random import seed
from random import random

# Initialize a network
def initialize_network(n_inputs, n_hidden, n_outputs):
	network = list()
	hidden_layer = [{'weights':[random() for i in range(n_inputs + 1)]} for i in range(n_hidden)]
	network.append(hidden_layer)
	output_layer = [{'weights':[random() for i in range(n_hidden + 1)]} for i in range(n_outputs)]
	network.append(output_layer)
	return network

seed(1)
network = initialize_network(2, 1, 2)
for layer in network:
	print(layer)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038bb636147586-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038bb636147586-2">2</div><div class="crayon-num" data-line="crayon-5c0ca806038bb636147586-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038bb636147586-4">4</div><div class="crayon-num" data-line="crayon-5c0ca806038bb636147586-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038bb636147586-6">6</div><div class="crayon-num" data-line="crayon-5c0ca806038bb636147586-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038bb636147586-8">8</div><div class="crayon-num" data-line="crayon-5c0ca806038bb636147586-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038bb636147586-10">10</div><div class="crayon-num" data-line="crayon-5c0ca806038bb636147586-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038bb636147586-12">12</div><div class="crayon-num" data-line="crayon-5c0ca806038bb636147586-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038bb636147586-14">14</div><div class="crayon-num" data-line="crayon-5c0ca806038bb636147586-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038bb636147586-16">16</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038bb636147586-1"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">seed</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038bb636147586-2"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-v">random</span></div><div class="crayon-line" id="crayon-5c0ca806038bb636147586-3"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038bb636147586-4"><span class="crayon-p"># Initialize a network</span></div><div class="crayon-line" id="crayon-5c0ca806038bb636147586-5"><span class="crayon-e">def </span><span class="crayon-e">initialize_network</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hidden</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038bb636147586-6"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038bb636147586-7"><span class="crayon-h"> </span><span class="crayon-v">hidden_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038bb636147586-8"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">hidden_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038bb636147586-9"><span class="crayon-h"> </span><span class="crayon-v">output_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038bb636147586-10"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">output_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038bb636147586-11"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038bb636147586-12"> </div><div class="crayon-line" id="crayon-5c0ca806038bb636147586-13"><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038bb636147586-14"><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">initialize_network</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038bb636147586-15"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038bb636147586-16"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>Running the example, you can see that the code prints out each layer one by one. You can see the hidden layer has one neuron with 2 input weights plus the bias. The output layer has 2 neurons, each with 1 weight plus the bias.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038bd319167743" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
[{'weights': [0.13436424411240122, 0.8474337369372327, 0.763774618976614]}]
[{'weights': [0.2550690257394217, 0.49543508709194095]}, {'weights': [0.4494910647887381, 0.651592972722763]}]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038bd319167743-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038bd319167743-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038bd319167743-1">[{'weights': [0.13436424411240122, 0.8474337369372327, 0.763774618976614]}]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038bd319167743-2">[{'weights': [0.2550690257394217, 0.49543508709194095]}, {'weights': [0.4494910647887381, 0.651592972722763]}]</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Now that we know how to create and initialized a network, let’s see how we can use it to calculate an output.</p>
<h3>2. Forward Propagate</h3>
<p>We can calculate an output from a neural network by propagating an input signal through each layer until the output layer outputs its values.</p>
<p>We call this forward-propagation.</p>
<p>It is the technique we will need to generate predictions during training that will need to be corrected, and it is the method we will need after the network is trained to make predictions on new data.</p>
<p>We can break forward propagation down into three parts:</p>
<ol>
<li>Neuron Activation.</li>
<li>Neuron Transfer.</li>
<li>Forward Propagation.</li>
</ol>
<h4>2.1. Neuron Activation</h4>
<p>The first step is to calculate the activation of one neuron given an input.</p>
<p>The input could be a row from our training dataset, as in the case of the hidden layer. It may also be the outputs from each neuron in the hidden layer, in the case of the output layer.</p>
<p>Neuron activation is calculated as the weighted sum of the inputs. Much like linear regression.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038c3630693797" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
activation = sum(weight_i * input_i) + bias</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038c3630693797-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038c3630693797-1">activation = sum(weight_i * input_i) + bias</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Where <strong>weight</strong> is a network weight, <strong>input</strong> is an input, <strong>i</strong> is the index of a weight or an input and <strong>bias</strong> is a special weight that has no input to multiply with (or you can think of the input as always being 1.0).</p>
<p>Below is an implementation of this in a function named <strong>activate()</strong>. You can see that the function assumes that the bias is the last weight in the list of weights. This helps here and later to make the code easier to read.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038c4815852427" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Calculate neuron activation for an input
def activate(weights, inputs):
	activation = weights[-1]
	for i in range(len(weights)-1):
		activation += weights[i] * inputs[i]
	return activation</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038c4815852427-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038c4815852427-2">2</div><div class="crayon-num" data-line="crayon-5c0ca806038c4815852427-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038c4815852427-4">4</div><div class="crayon-num" data-line="crayon-5c0ca806038c4815852427-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038c4815852427-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038c4815852427-1"><span class="crayon-p"># Calculate neuron activation for an input</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038c4815852427-2"><span class="crayon-e">def </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038c4815852427-3"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038c4815852427-4"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038c4815852427-5"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038c4815852427-6"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">activation</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Now, let’s see how to use the neuron activation.</p>
<h4>2.2. Neuron Transfer</h4>
<p>Once a neuron is activated, we need to transfer the activation to see what the neuron output actually is.</p>
<p>Different transfer functions can be used. It is traditional to use the <a href="https://en.wikipedia.org/wiki/Sigmoid_function">sigmoid activation function</a>, but you can also use the tanh (<a href="https://en.wikipedia.org/wiki/Hyperbolic_function">hyperbolic tangent</a>) function to transfer outputs. More recently, the <a href="https://en.wikipedia.org/wiki/Rectifier_(neural_networks)">rectifier transfer function</a> has been popular with large deep learning networks.</p>
<p>The sigmoid activation function looks like an S shape, it’s also called the logistic function. It can take any input value and produce a number between 0 and 1 on an S-curve. It is also a function of which we can easily calculate the derivative (slope) that we will need later when backpropagating error.</p>
<p>We can transfer an activation function using the sigmoid function as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038c6785698636" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
output = 1 / (1 + e^(-activation))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038c6785698636-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038c6785698636-1">output = 1 / (1 + e^(-activation))</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Where <strong>e</strong> is the base of the natural logarithms (<a href="https://en.wikipedia.org/wiki/E_(mathematical_constant)">Euler’s number</a>).</p>
<p>Below is a function named <strong>transfer()</strong> that implements the sigmoid equation.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038c8423493877" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Transfer neuron activation
def transfer(activation):
	return 1.0 / (1.0 + exp(-activation))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038c8423493877-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038c8423493877-2">2</div><div class="crayon-num" data-line="crayon-5c0ca806038c8423493877-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038c8423493877-1"><span class="crayon-p"># Transfer neuron activation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038c8423493877-2"><span class="crayon-e">def </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038c8423493877-3"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Now that we have the pieces, let’s see how they are used.</p>
<h4>2.3. Forward Propagation</h4>
<p>Forward propagating an input is straightforward.</p>
<p>We work through each layer of our network calculating the outputs for each neuron. All of the outputs from one layer become inputs to the neurons on the next layer.</p>
<p>Below is a function named <strong>forward_propagate()</strong> that implements the forward propagation for a row of data from our dataset with our neural network.</p>
<p>You can see that a neuron’s output value is stored in the neuron with the name ‘<strong>output</strong>‘. You can also see that we collect the outputs for a layer in an array named <strong>new_inputs</strong> that becomes the array <strong>inputs</strong> and is used as inputs for the following layer.</p>
<p>The function returns the outputs from the last layer also called the output layer.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038c9463242770" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Forward propagate input to a network output
def forward_propagate(network, row):
	inputs = row
	for layer in network:
		new_inputs = []
		for neuron in layer:
			activation = activate(neuron['weights'], inputs)
			neuron['output'] = transfer(activation)
			new_inputs.append(neuron['output'])
		inputs = new_inputs
	return inputs</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038c9463242770-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038c9463242770-2">2</div><div class="crayon-num" data-line="crayon-5c0ca806038c9463242770-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038c9463242770-4">4</div><div class="crayon-num" data-line="crayon-5c0ca806038c9463242770-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038c9463242770-6">6</div><div class="crayon-num" data-line="crayon-5c0ca806038c9463242770-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038c9463242770-8">8</div><div class="crayon-num" data-line="crayon-5c0ca806038c9463242770-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038c9463242770-10">10</div><div class="crayon-num" data-line="crayon-5c0ca806038c9463242770-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038c9463242770-1"><span class="crayon-p"># Forward propagate input to a network output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038c9463242770-2"><span class="crayon-e">def </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038c9463242770-3"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">row</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038c9463242770-4"><span class="crayon-e"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038c9463242770-5"><span class="crayon-h"> </span><span class="crayon-v">new_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038c9463242770-6"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038c9463242770-7"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038c9463242770-8"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038c9463242770-9"><span class="crayon-h"> </span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038c9463242770-10"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_inputs</span></div><div class="crayon-line" id="crayon-5c0ca806038c9463242770-11"><span class="crayon-e"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>Let’s put all of these pieces together and test out the forward propagation of our network.</p>
<p>We define our network inline with one hidden neuron that expects 2 input values and an output layer with two neurons.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038cb030793234" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from math import exp

# Calculate neuron activation for an input
def activate(weights, inputs):
	activation = weights[-1]
	for i in range(len(weights)-1):
		activation += weights[i] * inputs[i]
	return activation

# Transfer neuron activation
def transfer(activation):
	return 1.0 / (1.0 + exp(-activation))

# Forward propagate input to a network output
def forward_propagate(network, row):
	inputs = row
	for layer in network:
		new_inputs = []
		for neuron in layer:
			activation = activate(neuron['weights'], inputs)
			neuron['output'] = transfer(activation)
			new_inputs.append(neuron['output'])
		inputs = new_inputs
	return inputs

# test forward propagation
network = [[{'weights': [0.13436424411240122, 0.8474337369372327, 0.763774618976614]}],
		[{'weights': [0.2550690257394217, 0.49543508709194095]}, {'weights': [0.4494910647887381, 0.651592972722763]}]]
row = [1, 0, None]
output = forward_propagate(network, row)
print(output)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038cb030793234-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038cb030793234-2">2</div><div class="crayon-num" data-line="crayon-5c0ca806038cb030793234-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038cb030793234-4">4</div><div class="crayon-num" data-line="crayon-5c0ca806038cb030793234-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038cb030793234-6">6</div><div class="crayon-num" data-line="crayon-5c0ca806038cb030793234-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038cb030793234-8">8</div><div class="crayon-num" data-line="crayon-5c0ca806038cb030793234-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038cb030793234-10">10</div><div class="crayon-num" data-line="crayon-5c0ca806038cb030793234-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038cb030793234-12">12</div><div class="crayon-num" data-line="crayon-5c0ca806038cb030793234-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038cb030793234-14">14</div><div class="crayon-num" data-line="crayon-5c0ca806038cb030793234-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038cb030793234-16">16</div><div class="crayon-num" data-line="crayon-5c0ca806038cb030793234-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038cb030793234-18">18</div><div class="crayon-num" data-line="crayon-5c0ca806038cb030793234-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038cb030793234-20">20</div><div class="crayon-num" data-line="crayon-5c0ca806038cb030793234-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038cb030793234-22">22</div><div class="crayon-num" data-line="crayon-5c0ca806038cb030793234-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038cb030793234-24">24</div><div class="crayon-num" data-line="crayon-5c0ca806038cb030793234-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038cb030793234-26">26</div><div class="crayon-num" data-line="crayon-5c0ca806038cb030793234-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038cb030793234-28">28</div><div class="crayon-num" data-line="crayon-5c0ca806038cb030793234-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038cb030793234-30">30</div><div class="crayon-num" data-line="crayon-5c0ca806038cb030793234-31">31</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038cb030793234-1"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-v">exp</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038cb030793234-2"> </div><div class="crayon-line" id="crayon-5c0ca806038cb030793234-3"><span class="crayon-p"># Calculate neuron activation for an input</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038cb030793234-4"><span class="crayon-e">def </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038cb030793234-5"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038cb030793234-6"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038cb030793234-7"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038cb030793234-8"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">activation</span></div><div class="crayon-line" id="crayon-5c0ca806038cb030793234-9"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038cb030793234-10"><span class="crayon-p"># Transfer neuron activation</span></div><div class="crayon-line" id="crayon-5c0ca806038cb030793234-11"><span class="crayon-e">def </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038cb030793234-12"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038cb030793234-13"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038cb030793234-14"><span class="crayon-p"># Forward propagate input to a network output</span></div><div class="crayon-line" id="crayon-5c0ca806038cb030793234-15"><span class="crayon-e">def </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038cb030793234-16"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">row</span></div><div class="crayon-line" id="crayon-5c0ca806038cb030793234-17"><span class="crayon-e"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038cb030793234-18"><span class="crayon-h"> </span><span class="crayon-v">new_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038cb030793234-19"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038cb030793234-20"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038cb030793234-21"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038cb030793234-22"><span class="crayon-h"> </span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038cb030793234-23"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_inputs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038cb030793234-24"><span class="crayon-e"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span></div><div class="crayon-line" id="crayon-5c0ca806038cb030793234-25"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038cb030793234-26"><span class="crayon-p"># test forward propagation</span></div><div class="crayon-line" id="crayon-5c0ca806038cb030793234-27"><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.13436424411240122</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8474337369372327</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.763774618976614</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038cb030793234-28"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.2550690257394217</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.49543508709194095</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.4494910647887381</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.651592972722763</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038cb030793234-29"><span class="crayon-v">row</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038cb030793234-30"><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038cb030793234-31"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0016 seconds] -->
<p>Running the example propagates the input pattern [1, 0] and produces an output value that is printed. Because the output layer has two neurons, we get a list of two numbers as output.</p>
<p>The actual output values are just nonsense for now, but next, we will start to learn how to make the weights in the neurons more useful.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038cd243302562" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
[0.6629970129852887, 0.7253160725279748]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038cd243302562-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038cd243302562-1">[0.6629970129852887, 0.7253160725279748]</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p></p>
<h3>3. Back Propagate Error</h3>
<p>The backpropagation algorithm is named for the way in which weights are trained.</p>
<p>Error is calculated between the expected outputs and the outputs forward propagated from the network. These errors are then propagated backward through the network from the output layer to the hidden layer, assigning blame for the error and updating weights as they go.</p>
<p>The math for backpropagating error is rooted in calculus, but we will remain high level in this section and focus on what is calculated and how rather than why the calculations take this particular form.</p>
<p>This part is broken down into two sections.</p>
<ol>
<li>Transfer Derivative.</li>
<li>Error Backpropagation.</li>
</ol>
<h4>3.1. Transfer Derivative</h4>
<p>Given an output value from a neuron, we need to calculate it’s slope.</p>
<p>We are using the sigmoid transfer function, the derivative of which can be calculated as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038cf955785087" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
derivative = output * (1.0 - output)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038cf955785087-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038cf955785087-1">derivative = output * (1.0 - output)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Below is a function named <strong>transfer_derivative()</strong> that implements this equation.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038d1359137671" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Calculate the derivative of an neuron output
def transfer_derivative(output):
	return output * (1.0 - output)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038d1359137671-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d1359137671-2">2</div><div class="crayon-num" data-line="crayon-5c0ca806038d1359137671-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038d1359137671-1"><span class="crayon-p"># Calculate the derivative of an neuron output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d1359137671-2"><span class="crayon-e">def </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">output</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038d1359137671-3"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e ">output *</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Now, let’s see how this can be used.</p>
<h4>3.2. Error Backpropagation</h4>
<p>The first step is to calculate the error for each output neuron, this will give us our error signal (input) to propagate backwards through the network.</p>
<p>The error for a given neuron can be calculated as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038d3017686551" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
error = (expected - output) * transfer_derivative(output)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038d3017686551-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038d3017686551-1">error = (expected - output) * transfer_derivative(output)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Where <strong>expected</strong> is the expected output value for the neuron, <strong>output</strong> is the output value for the neuron and <strong>transfer_derivative()</strong> calculates the slope of the neuron’s output value, as shown above.</p>
<p>This error calculation is used for neurons in the output layer. The expected value is the class value itself. In the hidden layer, things are a little more complicated.</p>
<p>The error signal for a neuron in the hidden layer is calculated as the weighted error of each neuron in the output layer. Think of the error traveling back along the weights of the output layer to the neurons in the hidden layer.</p>
<p>The back-propagated error signal is accumulated and then used to determine the error for the neuron in the hidden layer, as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038d5364295258" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
error = (weight_k * error_j) * transfer_derivative(output)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038d5364295258-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038d5364295258-1">error = (weight_k * error_j) * transfer_derivative(output)</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Where <strong>error_j</strong> is the error signal from the <strong>j</strong>th neuron in the output layer, <strong>weight_k</strong> is the weight that connects the <strong>k</strong>th neuron to the current neuron and output is the output for the current neuron.</p>
<p>Below is a function named <strong>backward_propagate_error()</strong> that implements this procedure.</p>
<p>You can see that the error signal calculated for each neuron is stored with the name ‘delta’. You can see that the layers of the network are iterated in reverse order, starting at the output and working backwards. This ensures that the neurons in the output layer have ‘delta’ values calculated first that neurons in the hidden layer can use in the subsequent iteration. I chose the name ‘delta’ to reflect the change the error implies on the neuron (e.g. the weight delta).</p>
<p>You can see that the error signal for neurons in the hidden layer is accumulated from neurons in the output layer where the hidden neuron number <strong>j</strong> is also the index of the neuron’s weight in the output layer <strong>neuron[‘weights’][j]</strong>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038d7181995287" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Backpropagate error and store in neurons
def backward_propagate_error(network, expected):
	for i in reversed(range(len(network))):
		layer = network[i]
		errors = list()
		if i != len(network)-1:
			for j in range(len(layer)):
				error = 0.0
				for neuron in network[i + 1]:
					error += (neuron['weights'][j] * neuron['delta'])
				errors.append(error)
		else:
			for j in range(len(layer)):
				neuron = layer[j]
				errors.append(expected[j] - neuron['output'])
		for j in range(len(layer)):
			neuron = layer[j]
			neuron['delta'] = errors[j] * transfer_derivative(neuron['output'])</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038d7181995287-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d7181995287-2">2</div><div class="crayon-num" data-line="crayon-5c0ca806038d7181995287-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d7181995287-4">4</div><div class="crayon-num" data-line="crayon-5c0ca806038d7181995287-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d7181995287-6">6</div><div class="crayon-num" data-line="crayon-5c0ca806038d7181995287-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d7181995287-8">8</div><div class="crayon-num" data-line="crayon-5c0ca806038d7181995287-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d7181995287-10">10</div><div class="crayon-num" data-line="crayon-5c0ca806038d7181995287-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d7181995287-12">12</div><div class="crayon-num" data-line="crayon-5c0ca806038d7181995287-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d7181995287-14">14</div><div class="crayon-num" data-line="crayon-5c0ca806038d7181995287-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d7181995287-16">16</div><div class="crayon-num" data-line="crayon-5c0ca806038d7181995287-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d7181995287-18">18</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038d7181995287-1"><span class="crayon-p"># Backpropagate error and store in neurons</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d7181995287-2"><span class="crayon-e">def </span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038d7181995287-3"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d7181995287-4"><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038d7181995287-5"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d7181995287-6"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038d7181995287-7"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d7181995287-8"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5c0ca806038d7181995287-9"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d7181995287-10"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038d7181995287-11"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">error</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d7181995287-12"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038d7181995287-13"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d7181995287-14"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038d7181995287-15"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d7181995287-16"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038d7181995287-17"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d7181995287-18"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0014 seconds] -->
<p>Let’s put all of the pieces together and see how it works.</p>
<p>We define a fixed neural network with output values and backpropagate an expected output pattern. The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038d9864151506" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Calculate the derivative of an neuron output
def transfer_derivative(output):
	return output * (1.0 - output)

# Backpropagate error and store in neurons
def backward_propagate_error(network, expected):
	for i in reversed(range(len(network))):
		layer = network[i]
		errors = list()
		if i != len(network)-1:
			for j in range(len(layer)):
				error = 0.0
				for neuron in network[i + 1]:
					error += (neuron['weights'][j] * neuron['delta'])
				errors.append(error)
		else:
			for j in range(len(layer)):
				neuron = layer[j]
				errors.append(expected[j] - neuron['output'])
		for j in range(len(layer)):
			neuron = layer[j]
			neuron['delta'] = errors[j] * transfer_derivative(neuron['output'])

# test backpropagation of error
network = [[{'output': 0.7105668883115941, 'weights': [0.13436424411240122, 0.8474337369372327, 0.763774618976614]}],
		[{'output': 0.6213859615555266, 'weights': [0.2550690257394217, 0.49543508709194095]}, {'output': 0.6573693455986976, 'weights': [0.4494910647887381, 0.651592972722763]}]]
expected = [0, 1]
backward_propagate_error(network, expected)
for layer in network:
	print(layer)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038d9864151506-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d9864151506-2">2</div><div class="crayon-num" data-line="crayon-5c0ca806038d9864151506-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d9864151506-4">4</div><div class="crayon-num" data-line="crayon-5c0ca806038d9864151506-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d9864151506-6">6</div><div class="crayon-num" data-line="crayon-5c0ca806038d9864151506-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d9864151506-8">8</div><div class="crayon-num" data-line="crayon-5c0ca806038d9864151506-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d9864151506-10">10</div><div class="crayon-num" data-line="crayon-5c0ca806038d9864151506-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d9864151506-12">12</div><div class="crayon-num" data-line="crayon-5c0ca806038d9864151506-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d9864151506-14">14</div><div class="crayon-num" data-line="crayon-5c0ca806038d9864151506-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d9864151506-16">16</div><div class="crayon-num" data-line="crayon-5c0ca806038d9864151506-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d9864151506-18">18</div><div class="crayon-num" data-line="crayon-5c0ca806038d9864151506-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d9864151506-20">20</div><div class="crayon-num" data-line="crayon-5c0ca806038d9864151506-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d9864151506-22">22</div><div class="crayon-num" data-line="crayon-5c0ca806038d9864151506-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d9864151506-24">24</div><div class="crayon-num" data-line="crayon-5c0ca806038d9864151506-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d9864151506-26">26</div><div class="crayon-num" data-line="crayon-5c0ca806038d9864151506-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d9864151506-28">28</div><div class="crayon-num" data-line="crayon-5c0ca806038d9864151506-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038d9864151506-30">30</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038d9864151506-1"><span class="crayon-p"># Calculate the derivative of an neuron output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d9864151506-2"><span class="crayon-e">def </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">output</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038d9864151506-3"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e ">output *</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d9864151506-4"> </div><div class="crayon-line" id="crayon-5c0ca806038d9864151506-5"><span class="crayon-p"># Backpropagate error and store in neurons</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d9864151506-6"><span class="crayon-e">def </span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038d9864151506-7"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d9864151506-8"><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038d9864151506-9"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d9864151506-10"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038d9864151506-11"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d9864151506-12"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5c0ca806038d9864151506-13"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d9864151506-14"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038d9864151506-15"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">error</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d9864151506-16"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038d9864151506-17"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d9864151506-18"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038d9864151506-19"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d9864151506-20"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038d9864151506-21"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d9864151506-22"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038d9864151506-23"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d9864151506-24"><span class="crayon-p"># test backpropagation of error</span></div><div class="crayon-line" id="crayon-5c0ca806038d9864151506-25"><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'output'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.7105668883115941</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.13436424411240122</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8474337369372327</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.763774618976614</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d9864151506-26"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'output'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.6213859615555266</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.2550690257394217</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.49543508709194095</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'output'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0.6573693455986976</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.4494910647887381</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.651592972722763</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038d9864151506-27"><span class="crayon-v">expected</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d9864151506-28"><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038d9864151506-29"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038d9864151506-30"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0021 seconds] -->
<p>Running the example prints the network after the backpropagation of error is complete. You can see that error values are calculated and stored in the neurons for the output layer and the hidden layer.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038db107656519" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
[{'output': 0.7105668883115941, 'weights': [0.13436424411240122, 0.8474337369372327, 0.763774618976614], 'delta': -0.0005348048046610517}]
[{'output': 0.6213859615555266, 'weights': [0.2550690257394217, 0.49543508709194095], 'delta': -0.14619064683582808}, {'output': 0.6573693455986976, 'weights': [0.4494910647887381, 0.651592972722763], 'delta': 0.0771723774346327}]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038db107656519-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038db107656519-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038db107656519-1">[{'output': 0.7105668883115941, 'weights': [0.13436424411240122, 0.8474337369372327, 0.763774618976614], 'delta': -0.0005348048046610517}]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038db107656519-2">[{'output': 0.6213859615555266, 'weights': [0.2550690257394217, 0.49543508709194095], 'delta': -0.14619064683582808}, {'output': 0.6573693455986976, 'weights': [0.4494910647887381, 0.651592972722763], 'delta': 0.0771723774346327}]</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Now let’s use the backpropagation of error to train the network.</p>
<h3>4. Train Network</h3>
<p>The network is trained using stochastic gradient descent.</p>
<p>This involves multiple iterations of exposing a training dataset to the network and for each row of data forward propagating the inputs, backpropagating the error and updating the network weights.</p>
<p>This part is broken down into two sections:</p>
<ol>
<li>Update Weights.</li>
<li>Train Network.</li>
</ol>
<h4>4.1. Update Weights</h4>
<p>Once errors are calculated for each neuron in the network via the back propagation method above, they can be used to update weights.</p>
<p>Network weights are updated as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038de265000076" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
weight = weight + learning_rate * error * input</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038de265000076-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038de265000076-1">weight = weight + learning_rate * error * input</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Where <strong>weight</strong> is a given weight, <strong>learning_rate</strong> is a parameter that you must specify, <strong>error</strong> is the error calculated by the backpropagation procedure for the neuron and <strong>input</strong> is the input value that caused the error.</p>
<p>The same procedure can be used for updating the bias weight, except there is no input term, or input is the fixed value of 1.0.</p>
<p>Learning rate controls how much to change the weight to correct for the error. For example, a value of 0.1 will update the weight 10% of the amount that it possibly could be updated. Small learning rates are preferred that cause slower learning over a large number of training iterations. This increases the likelihood of the network finding a good set of weights across all layers rather than the fastest set of weights that minimize error (called premature convergence).</p>
<p>Below is a function named <strong>update_weights()</strong> that updates the weights for a network given an input row of data, a learning rate and assume that a forward and backward propagation have already been performed.</p>
<p>Remember that the input for the output layer is a collection of outputs from the hidden layer.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038e0609437677" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Update network weights with error
def update_weights(network, row, l_rate):
	for i in range(len(network)):
		inputs = row[:-1]
		if i != 0:
			inputs = [neuron['output'] for neuron in network[i - 1]]
		for neuron in network[i]:
			for j in range(len(inputs)):
				neuron['weights'][j] += l_rate * neuron['delta'] * inputs[j]
			neuron['weights'][-1] += l_rate * neuron['delta']</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038e0609437677-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e0609437677-2">2</div><div class="crayon-num" data-line="crayon-5c0ca806038e0609437677-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e0609437677-4">4</div><div class="crayon-num" data-line="crayon-5c0ca806038e0609437677-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e0609437677-6">6</div><div class="crayon-num" data-line="crayon-5c0ca806038e0609437677-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e0609437677-8">8</div><div class="crayon-num" data-line="crayon-5c0ca806038e0609437677-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e0609437677-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038e0609437677-1"><span class="crayon-p"># Update network weights with error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e0609437677-2"><span class="crayon-e">def </span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038e0609437677-3"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e0609437677-4"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038e0609437677-5"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e0609437677-6"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038e0609437677-7"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e0609437677-8"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038e0609437677-9"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">l_rate *</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e0609437677-10"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">l_rate *</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>Now we know how to update network weights, let’s see how we can do it repeatedly.</p>
<h4>4.2. Train Network</h4>
<p>As mentioned, the network is updated using stochastic gradient descent.</p>
<p>This involves first looping for a fixed number of epochs and within each epoch updating the network for each row in the training dataset.</p>
<p>Because updates are made for each training pattern, this type of learning is called online learning. If errors were accumulated across an epoch before updating the weights, this is called batch learning or batch gradient descent.</p>
<p>Below is a function that implements the training of an already initialized neural network with a given training dataset, learning rate, fixed number of epochs and an expected number of output values.</p>
<p>The expected number of output values is used to transform class values in the training data into a one hot encoding. That is a binary vector with one column for each class value to match the output of the network. This is required to calculate the error for the output layer.</p>
<p>You can also see that the sum squared error between the expected output and the network output is accumulated each epoch and printed. This is helpful to create a trace of how much the network is learning and improving each epoch.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038e2556952662" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Train a network for a fixed number of epochs
def train_network(network, train, l_rate, n_epoch, n_outputs):
	for epoch in range(n_epoch):
		sum_error = 0
		for row in train:
			outputs = forward_propagate(network, row)
			expected = [0 for i in range(n_outputs)]
			expected[row[-1]] = 1
			sum_error += sum([(expected[i]-outputs[i])**2 for i in range(len(expected))])
			backward_propagate_error(network, expected)
			update_weights(network, row, l_rate)
		print('&gt;epoch=%d, lrate=%.3f, error=%.3f' % (epoch, l_rate, sum_error))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038e2556952662-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e2556952662-2">2</div><div class="crayon-num" data-line="crayon-5c0ca806038e2556952662-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e2556952662-4">4</div><div class="crayon-num" data-line="crayon-5c0ca806038e2556952662-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e2556952662-6">6</div><div class="crayon-num" data-line="crayon-5c0ca806038e2556952662-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e2556952662-8">8</div><div class="crayon-num" data-line="crayon-5c0ca806038e2556952662-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e2556952662-10">10</div><div class="crayon-num" data-line="crayon-5c0ca806038e2556952662-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e2556952662-12">12</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038e2556952662-1"><span class="crayon-p"># Train a network for a fixed number of epochs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e2556952662-2"><span class="crayon-e">def </span><span class="crayon-e">train_network</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038e2556952662-3"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">epoch </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_epoch</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e2556952662-4"><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-5c0ca806038e2556952662-5"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e2556952662-6"><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038e2556952662-7"><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e2556952662-8"><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5c0ca806038e2556952662-9"><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">-</span><span class="crayon-v">outputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e2556952662-10"><span class="crayon-h"> </span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038e2556952662-11"><span class="crayon-h"> </span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e2556952662-12"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;epoch=%d, lrate=%.3f, error=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>We now have all of the pieces to train the network. We can put together an example that includes everything we’ve seen so far including network initialization and train a network on a small dataset.</p>
<p>Below is a small contrived dataset that we can use to test out training our neural network.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038e4634602098" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
X1			X2			Y
2.7810836		2.550537003		0
1.465489372		2.362125076		0
3.396561688		4.400293529		0
1.38807019		1.850220317		0
3.06407232		3.005305973		0
7.627531214		2.759262235		1
5.332441248		2.088626775		1
6.922596716		1.77106367		1
8.675418651		-0.242068655		1
7.673756466		3.508563011		1</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038e4634602098-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e4634602098-2">2</div><div class="crayon-num" data-line="crayon-5c0ca806038e4634602098-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e4634602098-4">4</div><div class="crayon-num" data-line="crayon-5c0ca806038e4634602098-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e4634602098-6">6</div><div class="crayon-num" data-line="crayon-5c0ca806038e4634602098-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e4634602098-8">8</div><div class="crayon-num" data-line="crayon-5c0ca806038e4634602098-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e4634602098-10">10</div><div class="crayon-num" data-line="crayon-5c0ca806038e4634602098-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038e4634602098-1">X1			X2			Y</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e4634602098-2">2.7810836		2.550537003		0</div><div class="crayon-line" id="crayon-5c0ca806038e4634602098-3">1.465489372		2.362125076		0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e4634602098-4">3.396561688		4.400293529		0</div><div class="crayon-line" id="crayon-5c0ca806038e4634602098-5">1.38807019		1.850220317		0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e4634602098-6">3.06407232		3.005305973		0</div><div class="crayon-line" id="crayon-5c0ca806038e4634602098-7">7.627531214		2.759262235		1</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e4634602098-8">5.332441248		2.088626775		1</div><div class="crayon-line" id="crayon-5c0ca806038e4634602098-9">6.922596716		1.77106367		1</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e4634602098-10">8.675418651		-0.242068655		1</div><div class="crayon-line" id="crayon-5c0ca806038e4634602098-11">7.673756466		3.508563011		1</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Below is the complete example. We will use 2 neurons in the hidden layer. It is a binary classification problem (2 classes) so there will be two neurons in the output layer. The network will be trained for 20 epochs with a learning rate of 0.5, which is high because we are training for so few iterations.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038e6077229450" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from math import exp
from random import seed
from random import random

# Initialize a network
def initialize_network(n_inputs, n_hidden, n_outputs):
	network = list()
	hidden_layer = [{'weights':[random() for i in range(n_inputs + 1)]} for i in range(n_hidden)]
	network.append(hidden_layer)
	output_layer = [{'weights':[random() for i in range(n_hidden + 1)]} for i in range(n_outputs)]
	network.append(output_layer)
	return network

# Calculate neuron activation for an input
def activate(weights, inputs):
	activation = weights[-1]
	for i in range(len(weights)-1):
		activation += weights[i] * inputs[i]
	return activation

# Transfer neuron activation
def transfer(activation):
	return 1.0 / (1.0 + exp(-activation))

# Forward propagate input to a network output
def forward_propagate(network, row):
	inputs = row
	for layer in network:
		new_inputs = []
		for neuron in layer:
			activation = activate(neuron['weights'], inputs)
			neuron['output'] = transfer(activation)
			new_inputs.append(neuron['output'])
		inputs = new_inputs
	return inputs

# Calculate the derivative of an neuron output
def transfer_derivative(output):
	return output * (1.0 - output)

# Backpropagate error and store in neurons
def backward_propagate_error(network, expected):
	for i in reversed(range(len(network))):
		layer = network[i]
		errors = list()
		if i != len(network)-1:
			for j in range(len(layer)):
				error = 0.0
				for neuron in network[i + 1]:
					error += (neuron['weights'][j] * neuron['delta'])
				errors.append(error)
		else:
			for j in range(len(layer)):
				neuron = layer[j]
				errors.append(expected[j] - neuron['output'])
		for j in range(len(layer)):
			neuron = layer[j]
			neuron['delta'] = errors[j] * transfer_derivative(neuron['output'])

# Update network weights with error
def update_weights(network, row, l_rate):
	for i in range(len(network)):
		inputs = row[:-1]
		if i != 0:
			inputs = [neuron['output'] for neuron in network[i - 1]]
		for neuron in network[i]:
			for j in range(len(inputs)):
				neuron['weights'][j] += l_rate * neuron['delta'] * inputs[j]
			neuron['weights'][-1] += l_rate * neuron['delta']

# Train a network for a fixed number of epochs
def train_network(network, train, l_rate, n_epoch, n_outputs):
	for epoch in range(n_epoch):
		sum_error = 0
		for row in train:
			outputs = forward_propagate(network, row)
			expected = [0 for i in range(n_outputs)]
			expected[row[-1]] = 1
			sum_error += sum([(expected[i]-outputs[i])**2 for i in range(len(expected))])
			backward_propagate_error(network, expected)
			update_weights(network, row, l_rate)
		print('&gt;epoch=%d, lrate=%.3f, error=%.3f' % (epoch, l_rate, sum_error))

# Test training backprop algorithm
seed(1)
dataset = [[2.7810836,2.550537003,0],
	[1.465489372,2.362125076,0],
	[3.396561688,4.400293529,0],
	[1.38807019,1.850220317,0],
	[3.06407232,3.005305973,0],
	[7.627531214,2.759262235,1],
	[5.332441248,2.088626775,1],
	[6.922596716,1.77106367,1],
	[8.675418651,-0.242068655,1],
	[7.673756466,3.508563011,1]]
n_inputs = len(dataset[0]) - 1
n_outputs = len(set([row[-1] for row in dataset]))
network = initialize_network(n_inputs, 2, n_outputs)
train_network(network, dataset, 0.5, 20, n_outputs)
for layer in network:
	print(layer)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-2">2</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-4">4</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-6">6</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-8">8</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-10">10</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-12">12</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-14">14</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-16">16</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-18">18</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-20">20</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-22">22</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-24">24</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-26">26</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-28">28</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-30">30</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-32">32</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-34">34</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-36">36</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-38">38</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-40">40</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-42">42</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-44">44</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-46">46</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-48">48</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-50">50</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-52">52</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-54">54</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-56">56</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-58">58</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-60">60</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-62">62</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-64">64</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-66">66</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-68">68</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-70">70</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-72">72</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-74">74</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-76">76</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-78">78</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-80">80</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-82">82</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-84">84</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-86">86</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-88">88</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-90">90</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-92">92</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-94">94</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-96">96</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-98">98</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e6077229450-100">100</div><div class="crayon-num" data-line="crayon-5c0ca806038e6077229450-101">101</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038e6077229450-1"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-e">exp</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-2"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">seed</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-3"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-v">random</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-4"> </div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-5"><span class="crayon-p"># Initialize a network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-6"><span class="crayon-e">def </span><span class="crayon-e">initialize_network</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hidden</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-7"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-8"><span class="crayon-h"> </span><span class="crayon-v">hidden_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-9"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">hidden_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-10"><span class="crayon-h"> </span><span class="crayon-v">output_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-11"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">output_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-12"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">network</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-13"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-14"><span class="crayon-p"># Calculate neuron activation for an input</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-15"><span class="crayon-e">def </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-16"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-17"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-18"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-19"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">activation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-20"> </div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-21"><span class="crayon-p"># Transfer neuron activation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-22"><span class="crayon-e">def </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-23"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-24"> </div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-25"><span class="crayon-p"># Forward propagate input to a network output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-26"><span class="crayon-e">def </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-27"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">row</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-28"><span class="crayon-e"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-29"><span class="crayon-h"> </span><span class="crayon-v">new_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-30"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-31"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-32"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-33"><span class="crayon-h"> </span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-34"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_inputs</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-35"><span class="crayon-e"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-36"> </div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-37"><span class="crayon-p"># Calculate the derivative of an neuron output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-38"><span class="crayon-e">def </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">output</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-39"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e ">output *</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-40"> </div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-41"><span class="crayon-p"># Backpropagate error and store in neurons</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-42"><span class="crayon-e">def </span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-43"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-44"><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-45"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-46"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-47"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-48"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-49"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-50"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-51"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">error</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-52"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-53"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-54"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-55"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-56"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-57"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-58"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-59"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-60"><span class="crayon-p"># Update network weights with error</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-61"><span class="crayon-e">def </span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-62"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-63"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-64"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-65"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-66"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-67"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-68"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">l_rate *</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-69"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">l_rate *</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-70"> </div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-71"><span class="crayon-p"># Train a network for a fixed number of epochs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-72"><span class="crayon-e">def </span><span class="crayon-e">train_network</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-73"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">epoch </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_epoch</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-74"><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-75"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-76"><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-77"><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-78"><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-79"><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">-</span><span class="crayon-v">outputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-80"><span class="crayon-h"> </span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-81"><span class="crayon-h"> </span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-82"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;epoch=%d, lrate=%.3f, error=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sum_error</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-83"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-84"><span class="crayon-p"># Test training backprop algorithm</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-85"><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-86"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">2.7810836</span><span class="crayon-sy">,</span><span class="crayon-cn">2.550537003</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-87"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1.465489372</span><span class="crayon-sy">,</span><span class="crayon-cn">2.362125076</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-88"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3.396561688</span><span class="crayon-sy">,</span><span class="crayon-cn">4.400293529</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-89"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1.38807019</span><span class="crayon-sy">,</span><span class="crayon-cn">1.850220317</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-90"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3.06407232</span><span class="crayon-sy">,</span><span class="crayon-cn">3.005305973</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-91"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">7.627531214</span><span class="crayon-sy">,</span><span class="crayon-cn">2.759262235</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-92"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">5.332441248</span><span class="crayon-sy">,</span><span class="crayon-cn">2.088626775</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-93"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">6.922596716</span><span class="crayon-sy">,</span><span class="crayon-cn">1.77106367</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-94"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">8.675418651</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">0.242068655</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-95"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">7.673756466</span><span class="crayon-sy">,</span><span class="crayon-cn">3.508563011</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-96"><span class="crayon-v">n_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-97"><span class="crayon-v">n_outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-98"><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">initialize_network</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-99"><span class="crayon-e">train_network</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e6077229450-100"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038e6077229450-101"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0064 seconds] -->
<p>Running the example first prints the sum squared error each training epoch. We can see a trend of this error decreasing with each epoch.</p>
<p>Once trained, the network is printed, showing the learned weights. Also still in the network are output and delta values that can be ignored. We could update our training function to delete these data if we wanted.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038e9264740385" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
&gt;epoch=0, lrate=0.500, error=6.350
&gt;epoch=1, lrate=0.500, error=5.531
&gt;epoch=2, lrate=0.500, error=5.221
&gt;epoch=3, lrate=0.500, error=4.951
&gt;epoch=4, lrate=0.500, error=4.519
&gt;epoch=5, lrate=0.500, error=4.173
&gt;epoch=6, lrate=0.500, error=3.835
&gt;epoch=7, lrate=0.500, error=3.506
&gt;epoch=8, lrate=0.500, error=3.192
&gt;epoch=9, lrate=0.500, error=2.898
&gt;epoch=10, lrate=0.500, error=2.626
&gt;epoch=11, lrate=0.500, error=2.377
&gt;epoch=12, lrate=0.500, error=2.153
&gt;epoch=13, lrate=0.500, error=1.953
&gt;epoch=14, lrate=0.500, error=1.774
&gt;epoch=15, lrate=0.500, error=1.614
&gt;epoch=16, lrate=0.500, error=1.472
&gt;epoch=17, lrate=0.500, error=1.346
&gt;epoch=18, lrate=0.500, error=1.233
&gt;epoch=19, lrate=0.500, error=1.132
[{'weights': [-1.4688375095432327, 1.850887325439514, 1.0858178629550297], 'output': 0.029980305604426185, 'delta': -0.0059546604162323625}, {'weights': [0.37711098142462157, -0.0625909894552989, 0.2765123702642716], 'output': 0.9456229000211323, 'delta': 0.0026279652850863837}]
[{'weights': [2.515394649397849, -0.3391927502445985, -0.9671565426390275], 'output': 0.23648794202357587, 'delta': -0.04270059278364587}, {'weights': [-2.5584149848484263, 1.0036422106209202, 0.42383086467582715], 'output': 0.7790535202438367, 'delta': 0.03803132596437354}]</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038e9264740385-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e9264740385-2">2</div><div class="crayon-num" data-line="crayon-5c0ca806038e9264740385-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e9264740385-4">4</div><div class="crayon-num" data-line="crayon-5c0ca806038e9264740385-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e9264740385-6">6</div><div class="crayon-num" data-line="crayon-5c0ca806038e9264740385-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e9264740385-8">8</div><div class="crayon-num" data-line="crayon-5c0ca806038e9264740385-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e9264740385-10">10</div><div class="crayon-num" data-line="crayon-5c0ca806038e9264740385-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e9264740385-12">12</div><div class="crayon-num" data-line="crayon-5c0ca806038e9264740385-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e9264740385-14">14</div><div class="crayon-num" data-line="crayon-5c0ca806038e9264740385-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e9264740385-16">16</div><div class="crayon-num" data-line="crayon-5c0ca806038e9264740385-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e9264740385-18">18</div><div class="crayon-num" data-line="crayon-5c0ca806038e9264740385-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e9264740385-20">20</div><div class="crayon-num" data-line="crayon-5c0ca806038e9264740385-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038e9264740385-22">22</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038e9264740385-1">&gt;epoch=0, lrate=0.500, error=6.350</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e9264740385-2">&gt;epoch=1, lrate=0.500, error=5.531</div><div class="crayon-line" id="crayon-5c0ca806038e9264740385-3">&gt;epoch=2, lrate=0.500, error=5.221</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e9264740385-4">&gt;epoch=3, lrate=0.500, error=4.951</div><div class="crayon-line" id="crayon-5c0ca806038e9264740385-5">&gt;epoch=4, lrate=0.500, error=4.519</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e9264740385-6">&gt;epoch=5, lrate=0.500, error=4.173</div><div class="crayon-line" id="crayon-5c0ca806038e9264740385-7">&gt;epoch=6, lrate=0.500, error=3.835</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e9264740385-8">&gt;epoch=7, lrate=0.500, error=3.506</div><div class="crayon-line" id="crayon-5c0ca806038e9264740385-9">&gt;epoch=8, lrate=0.500, error=3.192</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e9264740385-10">&gt;epoch=9, lrate=0.500, error=2.898</div><div class="crayon-line" id="crayon-5c0ca806038e9264740385-11">&gt;epoch=10, lrate=0.500, error=2.626</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e9264740385-12">&gt;epoch=11, lrate=0.500, error=2.377</div><div class="crayon-line" id="crayon-5c0ca806038e9264740385-13">&gt;epoch=12, lrate=0.500, error=2.153</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e9264740385-14">&gt;epoch=13, lrate=0.500, error=1.953</div><div class="crayon-line" id="crayon-5c0ca806038e9264740385-15">&gt;epoch=14, lrate=0.500, error=1.774</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e9264740385-16">&gt;epoch=15, lrate=0.500, error=1.614</div><div class="crayon-line" id="crayon-5c0ca806038e9264740385-17">&gt;epoch=16, lrate=0.500, error=1.472</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e9264740385-18">&gt;epoch=17, lrate=0.500, error=1.346</div><div class="crayon-line" id="crayon-5c0ca806038e9264740385-19">&gt;epoch=18, lrate=0.500, error=1.233</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e9264740385-20">&gt;epoch=19, lrate=0.500, error=1.132</div><div class="crayon-line" id="crayon-5c0ca806038e9264740385-21">[{'weights': [-1.4688375095432327, 1.850887325439514, 1.0858178629550297], 'output': 0.029980305604426185, 'delta': -0.0059546604162323625}, {'weights': [0.37711098142462157, -0.0625909894552989, 0.2765123702642716], 'output': 0.9456229000211323, 'delta': 0.0026279652850863837}]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038e9264740385-22">[{'weights': [2.515394649397849, -0.3391927502445985, -0.9671565426390275], 'output': 0.23648794202357587, 'delta': -0.04270059278364587}, {'weights': [-2.5584149848484263, 1.0036422106209202, 0.42383086467582715], 'output': 0.7790535202438367, 'delta': 0.03803132596437354}]</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Once a network is trained, we need to use it to make predictions.</p>
<h3>5. Predict</h3>
<p>Making predictions with a trained neural network is easy enough.</p>
<p>We have already seen how to forward-propagate an input pattern to get an output. This is all we need to do to make a prediction. We can use the output values themselves directly as the probability of a pattern belonging to each output class.</p>
<p>It may be more useful to turn this output back into a crisp class prediction. We can do this by selecting the class value with the larger probability. This is also called the <a href="https://en.wikipedia.org/wiki/Arg_max">arg max function</a>.</p>
<p>Below is a function named <strong>predict()</strong> that implements this procedure. It returns the index in the network output that has the largest probability. It assumes that class values have been converted to integers starting at 0.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038ec924262765" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Make a prediction with a network
def predict(network, row):
	outputs = forward_propagate(network, row)
	return outputs.index(max(outputs))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038ec924262765-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ec924262765-2">2</div><div class="crayon-num" data-line="crayon-5c0ca806038ec924262765-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ec924262765-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038ec924262765-1"><span class="crayon-p"># Make a prediction with a network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ec924262765-2"><span class="crayon-e">def </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038ec924262765-3"><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ec924262765-4"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-sy">.</span><span class="crayon-e">index</span><span class="crayon-sy">(</span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-v">outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>We can put this together with our code above for forward propagating input and with our small contrived dataset to test making predictions with an already-trained network. The example hardcodes a network trained from the previous step.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038ef675249857" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from math import exp

# Calculate neuron activation for an input
def activate(weights, inputs):
	activation = weights[-1]
	for i in range(len(weights)-1):
		activation += weights[i] * inputs[i]
	return activation

# Transfer neuron activation
def transfer(activation):
	return 1.0 / (1.0 + exp(-activation))

# Forward propagate input to a network output
def forward_propagate(network, row):
	inputs = row
	for layer in network:
		new_inputs = []
		for neuron in layer:
			activation = activate(neuron['weights'], inputs)
			neuron['output'] = transfer(activation)
			new_inputs.append(neuron['output'])
		inputs = new_inputs
	return inputs

# Make a prediction with a network
def predict(network, row):
	outputs = forward_propagate(network, row)
	return outputs.index(max(outputs))

# Test making predictions with the network
dataset = [[2.7810836,2.550537003,0],
	[1.465489372,2.362125076,0],
	[3.396561688,4.400293529,0],
	[1.38807019,1.850220317,0],
	[3.06407232,3.005305973,0],
	[7.627531214,2.759262235,1],
	[5.332441248,2.088626775,1],
	[6.922596716,1.77106367,1],
	[8.675418651,-0.242068655,1],
	[7.673756466,3.508563011,1]]
network = [[{'weights': [-1.482313569067226, 1.8308790073202204, 1.078381922048799]}, {'weights': [0.23244990332399884, 0.3621998343835864, 0.40289821191094327]}],
	[{'weights': [2.5001872433501404, 0.7887233511355132, -1.1026649757805829]}, {'weights': [-2.429350576245497, 0.8357651039198697, 1.0699217181280656]}]]
for row in dataset:
	prediction = predict(network, row)
	print('Expected=%d, Got=%d' % (row[-1], prediction))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038ef675249857-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ef675249857-2">2</div><div class="crayon-num" data-line="crayon-5c0ca806038ef675249857-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ef675249857-4">4</div><div class="crayon-num" data-line="crayon-5c0ca806038ef675249857-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ef675249857-6">6</div><div class="crayon-num" data-line="crayon-5c0ca806038ef675249857-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ef675249857-8">8</div><div class="crayon-num" data-line="crayon-5c0ca806038ef675249857-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ef675249857-10">10</div><div class="crayon-num" data-line="crayon-5c0ca806038ef675249857-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ef675249857-12">12</div><div class="crayon-num" data-line="crayon-5c0ca806038ef675249857-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ef675249857-14">14</div><div class="crayon-num" data-line="crayon-5c0ca806038ef675249857-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ef675249857-16">16</div><div class="crayon-num" data-line="crayon-5c0ca806038ef675249857-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ef675249857-18">18</div><div class="crayon-num" data-line="crayon-5c0ca806038ef675249857-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ef675249857-20">20</div><div class="crayon-num" data-line="crayon-5c0ca806038ef675249857-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ef675249857-22">22</div><div class="crayon-num" data-line="crayon-5c0ca806038ef675249857-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ef675249857-24">24</div><div class="crayon-num" data-line="crayon-5c0ca806038ef675249857-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ef675249857-26">26</div><div class="crayon-num" data-line="crayon-5c0ca806038ef675249857-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ef675249857-28">28</div><div class="crayon-num" data-line="crayon-5c0ca806038ef675249857-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ef675249857-30">30</div><div class="crayon-num" data-line="crayon-5c0ca806038ef675249857-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ef675249857-32">32</div><div class="crayon-num" data-line="crayon-5c0ca806038ef675249857-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ef675249857-34">34</div><div class="crayon-num" data-line="crayon-5c0ca806038ef675249857-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ef675249857-36">36</div><div class="crayon-num" data-line="crayon-5c0ca806038ef675249857-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ef675249857-38">38</div><div class="crayon-num" data-line="crayon-5c0ca806038ef675249857-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ef675249857-40">40</div><div class="crayon-num" data-line="crayon-5c0ca806038ef675249857-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ef675249857-42">42</div><div class="crayon-num" data-line="crayon-5c0ca806038ef675249857-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ef675249857-44">44</div><div class="crayon-num" data-line="crayon-5c0ca806038ef675249857-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038ef675249857-46">46</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038ef675249857-1"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-v">exp</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ef675249857-2"> </div><div class="crayon-line" id="crayon-5c0ca806038ef675249857-3"><span class="crayon-p"># Calculate neuron activation for an input</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ef675249857-4"><span class="crayon-e">def </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038ef675249857-5"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ef675249857-6"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038ef675249857-7"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ef675249857-8"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">activation</span></div><div class="crayon-line" id="crayon-5c0ca806038ef675249857-9"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ef675249857-10"><span class="crayon-p"># Transfer neuron activation</span></div><div class="crayon-line" id="crayon-5c0ca806038ef675249857-11"><span class="crayon-e">def </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ef675249857-12"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038ef675249857-13"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ef675249857-14"><span class="crayon-p"># Forward propagate input to a network output</span></div><div class="crayon-line" id="crayon-5c0ca806038ef675249857-15"><span class="crayon-e">def </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ef675249857-16"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">row</span></div><div class="crayon-line" id="crayon-5c0ca806038ef675249857-17"><span class="crayon-e"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ef675249857-18"><span class="crayon-h"> </span><span class="crayon-v">new_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038ef675249857-19"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ef675249857-20"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038ef675249857-21"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ef675249857-22"><span class="crayon-h"> </span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038ef675249857-23"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_inputs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ef675249857-24"><span class="crayon-e"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span></div><div class="crayon-line" id="crayon-5c0ca806038ef675249857-25"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ef675249857-26"><span class="crayon-p"># Make a prediction with a network</span></div><div class="crayon-line" id="crayon-5c0ca806038ef675249857-27"><span class="crayon-e">def </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ef675249857-28"><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038ef675249857-29"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-sy">.</span><span class="crayon-e">index</span><span class="crayon-sy">(</span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-v">outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ef675249857-30"> </div><div class="crayon-line" id="crayon-5c0ca806038ef675249857-31"><span class="crayon-p"># Test making predictions with the network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ef675249857-32"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">2.7810836</span><span class="crayon-sy">,</span><span class="crayon-cn">2.550537003</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca806038ef675249857-33"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1.465489372</span><span class="crayon-sy">,</span><span class="crayon-cn">2.362125076</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ef675249857-34"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3.396561688</span><span class="crayon-sy">,</span><span class="crayon-cn">4.400293529</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca806038ef675249857-35"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1.38807019</span><span class="crayon-sy">,</span><span class="crayon-cn">1.850220317</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ef675249857-36"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">3.06407232</span><span class="crayon-sy">,</span><span class="crayon-cn">3.005305973</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca806038ef675249857-37"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">7.627531214</span><span class="crayon-sy">,</span><span class="crayon-cn">2.759262235</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ef675249857-38"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">5.332441248</span><span class="crayon-sy">,</span><span class="crayon-cn">2.088626775</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca806038ef675249857-39"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">6.922596716</span><span class="crayon-sy">,</span><span class="crayon-cn">1.77106367</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ef675249857-40"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">8.675418651</span><span class="crayon-sy">,</span><span class="crayon-o">-</span><span class="crayon-cn">0.242068655</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca806038ef675249857-41"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">7.673756466</span><span class="crayon-sy">,</span><span class="crayon-cn">3.508563011</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ef675249857-42"><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1.482313569067226</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.8308790073202204</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.078381922048799</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.23244990332399884</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3621998343835864</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.40289821191094327</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca806038ef675249857-43"><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">2.5001872433501404</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7887233511355132</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1.1026649757805829</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">2.429350576245497</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8357651039198697</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0699217181280656</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ef675249857-44"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038ef675249857-45"><span class="crayon-h"> </span><span class="crayon-v">prediction</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038ef675249857-46"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Expected=%d, Got=%d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">prediction</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0027 seconds] -->
<p>Running the example prints the expected output for each record in the training dataset, followed by the crisp prediction made by the network.</p>
<p>It shows that the network achieves 100% accuracy on this small dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038f1048324476" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Expected=0, Got=0
Expected=0, Got=0
Expected=0, Got=0
Expected=0, Got=0
Expected=0, Got=0
Expected=1, Got=1
Expected=1, Got=1
Expected=1, Got=1
Expected=1, Got=1
Expected=1, Got=1</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038f1048324476-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f1048324476-2">2</div><div class="crayon-num" data-line="crayon-5c0ca806038f1048324476-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f1048324476-4">4</div><div class="crayon-num" data-line="crayon-5c0ca806038f1048324476-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f1048324476-6">6</div><div class="crayon-num" data-line="crayon-5c0ca806038f1048324476-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f1048324476-8">8</div><div class="crayon-num" data-line="crayon-5c0ca806038f1048324476-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f1048324476-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038f1048324476-1">Expected=0, Got=0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f1048324476-2">Expected=0, Got=0</div><div class="crayon-line" id="crayon-5c0ca806038f1048324476-3">Expected=0, Got=0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f1048324476-4">Expected=0, Got=0</div><div class="crayon-line" id="crayon-5c0ca806038f1048324476-5">Expected=0, Got=0</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f1048324476-6">Expected=1, Got=1</div><div class="crayon-line" id="crayon-5c0ca806038f1048324476-7">Expected=1, Got=1</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f1048324476-8">Expected=1, Got=1</div><div class="crayon-line" id="crayon-5c0ca806038f1048324476-9">Expected=1, Got=1</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f1048324476-10">Expected=1, Got=1</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Now we are ready to apply our backpropagation algorithm to a real world dataset.</p>
<h3>6. Wheat Seeds Dataset</h3>
<p>This section applies the Backpropagation algorithm to the wheat seeds dataset.</p>
<p>The first step is to load the dataset and convert the loaded data to numbers that we can use in our neural network. For this we will use the helper function <strong>load_csv()</strong> to load the file, <strong>str_column_to_float()</strong> to convert string numbers to floats and <strong>str_column_to_int()</strong> to convert the class column to integer values.</p>
<p>Input values vary in scale and need to be normalized to the range of 0 and 1. It is generally good practice to normalize input values to the range of the chosen transfer function, in this case, the sigmoid function that outputs values between 0 and 1. The <strong>dataset_minmax()</strong> and <strong>normalize_dataset()</strong> helper functions were used to normalize the input values.</p>
<p>We will evaluate the algorithm using k-fold cross-validation with 5 folds. This means that 201/5=40.2 or 40 records will be in each fold. We will use the helper functions <strong>evaluate_algorithm()</strong> to evaluate the algorithm with cross-validation and <strong>accuracy_metric()</strong> to calculate the accuracy of predictions.</p>
<p>A new function named <strong>back_propagation()</strong> was developed to manage the application of the Backpropagation algorithm, first initializing a network, training it on the training dataset and then using the trained network to make predictions on a test dataset.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038f3228689326" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Backprop on the Seeds Dataset
from random import seed
from random import randrange
from random import random
from csv import reader
from math import exp

# Load a CSV file
def load_csv(filename):
	dataset = list()
	with open(filename, 'r') as file:
		csv_reader = reader(file)
		for row in csv_reader:
			if not row:
				continue
			dataset.append(row)
	return dataset

# Convert string column to float
def str_column_to_float(dataset, column):
	for row in dataset:
		row[column] = float(row[column].strip())

# Convert string column to integer
def str_column_to_int(dataset, column):
	class_values = [row[column] for row in dataset]
	unique = set(class_values)
	lookup = dict()
	for i, value in enumerate(unique):
		lookup[value] = i
	for row in dataset:
		row[column] = lookup[row[column]]
	return lookup

# Find the min and max values for each column
def dataset_minmax(dataset):
	minmax = list()
	stats = [[min(column), max(column)] for column in zip(*dataset)]
	return stats

# Rescale dataset columns to the range 0-1
def normalize_dataset(dataset, minmax):
	for row in dataset:
		for i in range(len(row)-1):
			row[i] = (row[i] - minmax[i][0]) / (minmax[i][1] - minmax[i][0])

# Split a dataset into k folds
def cross_validation_split(dataset, n_folds):
	dataset_split = list()
	dataset_copy = list(dataset)
	fold_size = int(len(dataset) / n_folds)
	for i in range(n_folds):
		fold = list()
		while len(fold) &lt; fold_size:
			index = randrange(len(dataset_copy))
			fold.append(dataset_copy.pop(index))
		dataset_split.append(fold)
	return dataset_split

# Calculate accuracy percentage
def accuracy_metric(actual, predicted):
	correct = 0
	for i in range(len(actual)):
		if actual[i] == predicted[i]:
			correct += 1
	return correct / float(len(actual)) * 100.0

# Evaluate an algorithm using a cross validation split
def evaluate_algorithm(dataset, algorithm, n_folds, *args):
	folds = cross_validation_split(dataset, n_folds)
	scores = list()
	for fold in folds:
		train_set = list(folds)
		train_set.remove(fold)
		train_set = sum(train_set, [])
		test_set = list()
		for row in fold:
			row_copy = list(row)
			test_set.append(row_copy)
			row_copy[-1] = None
		predicted = algorithm(train_set, test_set, *args)
		actual = [row[-1] for row in fold]
		accuracy = accuracy_metric(actual, predicted)
		scores.append(accuracy)
	return scores

# Calculate neuron activation for an input
def activate(weights, inputs):
	activation = weights[-1]
	for i in range(len(weights)-1):
		activation += weights[i] * inputs[i]
	return activation

# Transfer neuron activation
def transfer(activation):
	return 1.0 / (1.0 + exp(-activation))

# Forward propagate input to a network output
def forward_propagate(network, row):
	inputs = row
	for layer in network:
		new_inputs = []
		for neuron in layer:
			activation = activate(neuron['weights'], inputs)
			neuron['output'] = transfer(activation)
			new_inputs.append(neuron['output'])
		inputs = new_inputs
	return inputs

# Calculate the derivative of an neuron output
def transfer_derivative(output):
	return output * (1.0 - output)

# Backpropagate error and store in neurons
def backward_propagate_error(network, expected):
	for i in reversed(range(len(network))):
		layer = network[i]
		errors = list()
		if i != len(network)-1:
			for j in range(len(layer)):
				error = 0.0
				for neuron in network[i + 1]:
					error += (neuron['weights'][j] * neuron['delta'])
				errors.append(error)
		else:
			for j in range(len(layer)):
				neuron = layer[j]
				errors.append(expected[j] - neuron['output'])
		for j in range(len(layer)):
			neuron = layer[j]
			neuron['delta'] = errors[j] * transfer_derivative(neuron['output'])

# Update network weights with error
def update_weights(network, row, l_rate):
	for i in range(len(network)):
		inputs = row[:-1]
		if i != 0:
			inputs = [neuron['output'] for neuron in network[i - 1]]
		for neuron in network[i]:
			for j in range(len(inputs)):
				neuron['weights'][j] += l_rate * neuron['delta'] * inputs[j]
			neuron['weights'][-1] += l_rate * neuron['delta']

# Train a network for a fixed number of epochs
def train_network(network, train, l_rate, n_epoch, n_outputs):
	for epoch in range(n_epoch):
		for row in train:
			outputs = forward_propagate(network, row)
			expected = [0 for i in range(n_outputs)]
			expected[row[-1]] = 1
			backward_propagate_error(network, expected)
			update_weights(network, row, l_rate)

# Initialize a network
def initialize_network(n_inputs, n_hidden, n_outputs):
	network = list()
	hidden_layer = [{'weights':[random() for i in range(n_inputs + 1)]} for i in range(n_hidden)]
	network.append(hidden_layer)
	output_layer = [{'weights':[random() for i in range(n_hidden + 1)]} for i in range(n_outputs)]
	network.append(output_layer)
	return network

# Make a prediction with a network
def predict(network, row):
	outputs = forward_propagate(network, row)
	return outputs.index(max(outputs))

# Backpropagation Algorithm With Stochastic Gradient Descent
def back_propagation(train, test, l_rate, n_epoch, n_hidden):
	n_inputs = len(train[0]) - 1
	n_outputs = len(set([row[-1] for row in train]))
	network = initialize_network(n_inputs, n_hidden, n_outputs)
	train_network(network, train, l_rate, n_epoch, n_outputs)
	predictions = list()
	for row in test:
		prediction = predict(network, row)
		predictions.append(prediction)
	return(predictions)

# Test Backprop on Seeds dataset
seed(1)
# load and prepare data
filename = 'seeds_dataset.csv'
dataset = load_csv(filename)
for i in range(len(dataset[0])-1):
	str_column_to_float(dataset, i)
# convert class column to integers
str_column_to_int(dataset, len(dataset[0])-1)
# normalize input variables
minmax = dataset_minmax(dataset)
normalize_dataset(dataset, minmax)
# evaluate algorithm
n_folds = 5
l_rate = 0.3
n_epoch = 500
n_hidden = 5
scores = evaluate_algorithm(dataset, back_propagation, n_folds, l_rate, n_epoch, n_hidden)
print('Scores: %s' % scores)
print('Mean Accuracy: %.3f%%' % (sum(scores)/float(len(scores))))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-2">2</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-4">4</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-6">6</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-8">8</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-10">10</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-12">12</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-14">14</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-16">16</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-18">18</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-20">20</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-22">22</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-24">24</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-26">26</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-28">28</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-30">30</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-32">32</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-34">34</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-36">36</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-38">38</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-40">40</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-42">42</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-44">44</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-46">46</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-48">48</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-50">50</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-52">52</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-54">54</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-56">56</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-58">58</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-60">60</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-62">62</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-64">64</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-66">66</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-68">68</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-70">70</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-72">72</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-74">74</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-76">76</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-78">78</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-80">80</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-82">82</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-84">84</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-86">86</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-88">88</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-90">90</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-92">92</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-94">94</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-96">96</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-98">98</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-100">100</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-102">102</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-104">104</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-106">106</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-108">108</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-110">110</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-112">112</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-114">114</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-116">116</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-118">118</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-120">120</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-122">122</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-124">124</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-126">126</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-128">128</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-130">130</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-132">132</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-134">134</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-136">136</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-138">138</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-140">140</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-142">142</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-144">144</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-145">145</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-146">146</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-147">147</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-148">148</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-149">149</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-150">150</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-151">151</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-152">152</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-153">153</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-154">154</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-155">155</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-156">156</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-157">157</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-158">158</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-159">159</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-160">160</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-161">161</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-162">162</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-163">163</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-164">164</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-165">165</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-166">166</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-167">167</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-168">168</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-169">169</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-170">170</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-171">171</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-172">172</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-173">173</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-174">174</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-175">175</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-176">176</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-177">177</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-178">178</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-179">179</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-180">180</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-181">181</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-182">182</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-183">183</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-184">184</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-185">185</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-186">186</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-187">187</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-188">188</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-189">189</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-190">190</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-191">191</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-192">192</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-193">193</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-194">194</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-195">195</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-196">196</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-197">197</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f3228689326-198">198</div><div class="crayon-num" data-line="crayon-5c0ca806038f3228689326-199">199</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038f3228689326-1"><span class="crayon-p"># Backprop on the Seeds Dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-2"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">seed</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-3"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">randrange</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-4"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">random</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-5"><span class="crayon-e">from </span><span class="crayon-e">csv </span><span class="crayon-e">import </span><span class="crayon-e">reader</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-6"><span class="crayon-e">from </span><span class="crayon-e">math </span><span class="crayon-e">import </span><span class="crayon-v">exp</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-7"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-8"><span class="crayon-p"># Load a CSV file</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-9"><span class="crayon-e">def </span><span class="crayon-e">load_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-10"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-11"><span class="crayon-h"> </span><span class="crayon-e">with </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-12"><span class="crayon-h"> </span><span class="crayon-v">csv_reader</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">reader</span><span class="crayon-sy">(</span><span class="crayon-v">file</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-13"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">csv_reader</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-14"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-15"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-16"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-17"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-18"> </div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-19"><span class="crayon-p"># Convert string column to float</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-20"><span class="crayon-e">def </span><span class="crayon-e">str_column_to_float</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">column</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-21"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-22"><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">strip</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-23"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-24"><span class="crayon-p"># Convert string column to integer</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-25"><span class="crayon-e">def </span><span class="crayon-e">str_column_to_int</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">column</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-26"><span class="crayon-h"> </span><span class="crayon-v">class_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-27"><span class="crayon-h"> </span><span class="crayon-v">unique</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">class_values</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-28"><span class="crayon-h"> </span><span class="crayon-v">lookup</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-29"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">value </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">unique</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-30"><span class="crayon-h"> </span><span class="crayon-v">lookup</span><span class="crayon-sy">[</span><span class="crayon-v">value</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">i</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-31"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-32"><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lookup</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-33"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">lookup</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-34"> </div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-35"><span class="crayon-p"># Find the min and max values for each column</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-36"><span class="crayon-e">def </span><span class="crayon-e">dataset_minmax</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-37"><span class="crayon-h"> </span><span class="crayon-v">minmax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-38"><span class="crayon-h"> </span><span class="crayon-v">stats</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-e">min</span><span class="crayon-sy">(</span><span class="crayon-v">column</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-v">column</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">column </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-o">*</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-39"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">stats</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-40"> </div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-41"><span class="crayon-p"># Rescale dataset columns to the range 0-1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-42"><span class="crayon-e">def </span><span class="crayon-e">normalize_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">minmax</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-43"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-44"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-45"><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">minmax</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">minmax</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">minmax</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-46"> </div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-47"><span class="crayon-p"># Split a dataset into k folds</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-48"><span class="crayon-e">def </span><span class="crayon-e">cross_validation_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-49"><span class="crayon-h"> </span><span class="crayon-v">dataset_split</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-50"><span class="crayon-h"> </span><span class="crayon-v">dataset_copy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-51"><span class="crayon-h"> </span><span class="crayon-v">fold_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-52"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-53"><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-54"><span class="crayon-h"> </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">fold_size</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-55"><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">randrange</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset_copy</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-56"><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">dataset_copy</span><span class="crayon-sy">.</span><span class="crayon-e">pop</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-57"><span class="crayon-h"> </span><span class="crayon-v">dataset_split</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-58"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">dataset_split</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-59"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-60"><span class="crayon-p"># Calculate accuracy percentage</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-61"><span class="crayon-e">def </span><span class="crayon-e">accuracy_metric</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-62"><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-63"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-64"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">actual</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-65"><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-66"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">correct</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">100.0</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-67"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-68"><span class="crayon-p"># Evaluate an algorithm using a cross validation split</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-69"><span class="crayon-e">def </span><span class="crayon-e">evaluate_algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">algorithm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">args</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-70"><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_validation_split</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-71"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-72"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">fold </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">folds</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-73"><span class="crayon-h"> </span><span class="crayon-v">train_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">folds</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-74"><span class="crayon-h"> </span><span class="crayon-v">train_set</span><span class="crayon-sy">.</span><span class="crayon-e">remove</span><span class="crayon-sy">(</span><span class="crayon-v">fold</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-75"><span class="crayon-h"> </span><span class="crayon-v">train_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">train_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-76"><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-77"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-78"><span class="crayon-h"> </span><span class="crayon-v">row_copy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-79"><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">row_copy</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-80"><span class="crayon-h"> </span><span class="crayon-v">row_copy</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-81"><span class="crayon-e"> </span><span class="crayon-v">predicted</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">train_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test_set</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">args</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-82"><span class="crayon-h"> </span><span class="crayon-v">actual</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">fold</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-83"><span class="crayon-h"> </span><span class="crayon-v">accuracy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">accuracy_metric</span><span class="crayon-sy">(</span><span class="crayon-v">actual</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predicted</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-84"><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">accuracy</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-85"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">scores</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-86"> </div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-87"><span class="crayon-p"># Calculate neuron activation for an input</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-88"><span class="crayon-e">def </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-89"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-90"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">weights</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-91"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-92"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">activation</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-93"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-94"><span class="crayon-p"># Transfer neuron activation</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-95"><span class="crayon-e">def </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-96"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-97"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-98"><span class="crayon-p"># Forward propagate input to a network output</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-99"><span class="crayon-e">def </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-100"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">row</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-101"><span class="crayon-e"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">layer </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-102"><span class="crayon-h"> </span><span class="crayon-v">new_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-103"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-104"><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-105"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-106"><span class="crayon-h"> </span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-107"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_inputs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-108"><span class="crayon-e"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-109"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-110"><span class="crayon-p"># Calculate the derivative of an neuron output</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-111"><span class="crayon-e">def </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">output</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-112"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e ">output *</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">output</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-113"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-114"><span class="crayon-p"># Backpropagate error and store in neurons</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-115"><span class="crayon-e">def </span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-116"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-117"><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-118"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-119"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-120"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-121"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-122"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-123"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-124"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">error</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-125"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-126"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-127"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-128"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-129"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-130"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-131"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-132"> </div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-133"><span class="crayon-p"># Update network weights with error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-134"><span class="crayon-e">def </span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-135"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-136"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-137"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-138"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-139"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-140"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-141"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">l_rate *</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-142"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">l_rate *</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-143"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-144"><span class="crayon-p"># Train a network for a fixed number of epochs</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-145"><span class="crayon-e">def </span><span class="crayon-e">train_network</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-146"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">epoch </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_epoch</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-147"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-148"><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-149"><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-150"><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-151"><span class="crayon-h"> </span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-152"><span class="crayon-h"> </span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-153"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-154"><span class="crayon-p"># Initialize a network</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-155"><span class="crayon-e">def </span><span class="crayon-e">initialize_network</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hidden</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-156"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-157"><span class="crayon-h"> </span><span class="crayon-v">hidden_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-158"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">hidden_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-159"><span class="crayon-h"> </span><span class="crayon-v">output_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">{</span><span class="crayon-s">'weights'</span><span class="crayon-o">:</span><span class="crayon-sy">[</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_hidden</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-160"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">output_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-161"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-162"> </div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-163"><span class="crayon-p"># Make a prediction with a network</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-164"><span class="crayon-e">def </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-165"><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-166"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">outputs</span><span class="crayon-sy">.</span><span class="crayon-e">index</span><span class="crayon-sy">(</span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-v">outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-167"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-168"><span class="crayon-p"># Backpropagation Algorithm With Stochastic Gradient Descent</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-169"><span class="crayon-e">def </span><span class="crayon-e">back_propagation</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hidden</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-170"><span class="crayon-h"> </span><span class="crayon-v">n_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-171"><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-172"><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">initialize_network</span><span class="crayon-sy">(</span><span class="crayon-v">n_inputs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hidden</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-173"><span class="crayon-h"> </span><span class="crayon-e">train_network</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-174"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-175"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-176"><span class="crayon-h"> </span><span class="crayon-v">prediction</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-177"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">prediction</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-178"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-179"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-180"><span class="crayon-p"># Test Backprop on Seeds dataset</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-181"><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-182"><span class="crayon-p"># load and prepare data</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-183"><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'seeds_dataset.csv'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-184"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_csv</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-185"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-186"><span class="crayon-h"> </span><span class="crayon-e">str_column_to_float</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-187"><span class="crayon-p"># convert class column to integers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-188"><span class="crayon-e">str_column_to_int</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-189"><span class="crayon-p"># normalize input variables</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-190"><span class="crayon-v">minmax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dataset_minmax</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-191"><span class="crayon-e">normalize_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">minmax</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-192"><span class="crayon-p"># evaluate algorithm</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-193"><span class="crayon-v">n_folds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-194"><span class="crayon-v">l_rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-195"><span class="crayon-v">n_epoch</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">500</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-196"><span class="crayon-v">n_hidden</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-197"><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_algorithm</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">back_propagation</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_folds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_hidden</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f3228689326-198"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Scores: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">scores</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806038f3228689326-199"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Mean Accuracy: %.3f%%'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0111 seconds] -->
<p>A network with 5 neurons in the hidden layer and 3 neurons in the output layer was constructed. The network was trained for 500 epochs with a learning rate of 0.3. These parameters were found with a little trial and error, but you may be able to do much better.</p>
<p>Running the example prints the average classification accuracy on each fold as well as the average performance across all folds.</p>
<p>You can see that backpropagation and the chosen configuration achieved a mean classification accuracy of about 93% which is dramatically better than the Zero Rule algorithm that did slightly better than 28% accuracy.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806038f7639093903" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Scores: [92.85714285714286, 92.85714285714286, 97.61904761904762, 92.85714285714286, 90.47619047619048]
Mean Accuracy: 93.333%</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806038f7639093903-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806038f7639093903-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806038f7639093903-1">Scores: [92.85714285714286, 92.85714285714286, 97.61904761904762, 92.85714285714286, 90.47619047619048]</div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806038f7639093903-2">Mean Accuracy: 93.333%</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Extensions</h2>
<p>This section lists extensions to the tutorial that you may wish to explore.</p>
<ul>
<li><strong>Tune Algorithm Parameters</strong>. Try larger or smaller networks trained for longer or shorter. See if you can get better performance on the seeds dataset.</li>
<li><strong>Additional Methods</strong>. Experiment with different weight initialization techniques (such as small random numbers) and different transfer functions (such as tanh).</li>
<li><strong>More Layers</strong>. Add support for more hidden layers, trained in just the same way as the one hidden layer used in this tutorial.</li>
<li><strong>Regression</strong>. Change the network so that there is only one neuron in the output layer and that a real value is predicted. Pick a regression dataset to practice on. A linear transfer function could be used for neurons in the output layer, or the output values of the chosen dataset could be scaled to values between 0 and 1.</li>
<li><strong>Batch Gradient Descent</strong>. Change the training procedure from online to batch gradient descent and update the weights only at the end of each epoch.</li>
</ul>
<p style="text-align: center;"><strong>Did you try any of these extensions?</strong><br/>
Share your experiences in the comments below.</p>
<h2>Review</h2>
<p>In this tutorial, you discovered how to implement the Backpropagation algorithm from scratch.</p>
<p>Specifically, you learned:</p>
<ul>
<li>How to forward propagate an input to calculate a network output.</li>
<li>How to back propagate error and update network weights.</li>
<li>How to apply the backpropagation algorithm to a real world dataset.</li>
</ul>
<p style="text-align: center;"><strong>Do you have any questions?</strong><br/>
Ask your questions in the comments below and I will do my best to answer.</p>
<p style="text-align: left;"><!-- Shortcoder conditions not met --></p>
<div class="awac-wrapper"><div class="awac widget text-37"> <div class="textwidget"><p></p><div class="woo-sc-hr"></div><br/>
<center>
<h2 style="text-align: center;">Want to Code Algorithms in Python Without Math?</h2>
<p><a href="/machine-learning-algorithms-from-scratch/"><img align="left" alt="Machine Learning Algorithms From Scratch" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningAlgorithmsFromScratch-220.png" style="border: 0;"/></a></p>
<h4>Code Your First Algorithm in Minutes</h4>
<p style="text-align: center;">…with step-by-step tutorials on real-world datasets</p>
<p style="text-align: center;">Discover how in my new Ebook:<br/>
<a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Machine Learning Algorithms From Scratch</a></p>
<p style="text-align: center;">It covers <strong>18 tutorials</strong> with all the code for <strong>12 top algorithms</strong>, like:<br/>Linear Regression, k-Nearest Neighbors, Stochastic Gradient Descent and much more…</p>
<h4>Finally, Pull Back the Curtain on <br/>Machine Learning Algorithms</h4>
<p style="text-align: center;">Skip the Academics. Just Results.</p>
<p style="text-align: center;"><a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Click to learn more</a>.</p>
<p></p></center><br/>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-3349 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Implement+the+Backpropagation+Algorithm+From+Scratch+In+Python&amp;url=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
</section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/implement-learning-vector-quantization-scratch-python/" rel="prev"><i class="fa fa-angle-left"></i> How To Implement Learning Vector Quantization From Scratch With Python</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/implement-decision-tree-algorithm-scratch-python/" rel="next">How To Implement The Decision Tree Algorithm From Scratch In Python <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">377 Responses to <em>How to Implement the Backpropagation Algorithm From Scratch In Python</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-369793">
<div class="comment-container" id="li-comment-369793">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a7f661305b54a2c0f68f8faa81007e23?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a7f661305b54a2c0f68f8faa81007e23?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://www.facebook.com/talkdatatome/" rel="external nofollow">Talk Data To Me</a></span>
<span class="date">November 7, 2016 at 9:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-369793" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That’s what I was looking for. Write a neural network without any libraries (scikit, keras etc.) Thnak you very much!</p>
<div class="reply">
<a aria-label="Reply to Talk Data To Me" class="comment-reply-link" href="#comment-369793" onclick='return addComment.moveForm( "comment-369793", "369793", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-369865">
<div class="comment-container" id="li-comment-369865">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 8, 2016 at 9:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-369865" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad to hear it!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-369865" onclick='return addComment.moveForm( "comment-369865", "369865", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-430007">
<div class="comment-container" id="li-comment-430007">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/160276a64f3bab346f10267d5323c222?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/160276a64f3bab346f10267d5323c222?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/" rel="external nofollow">WB</a></span>
<span class="date">February 20, 2018 at 3:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430007" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I experienced the following applying the  Backpropagation algorithm to the wheat seeds dataset. I am wondering how to resolve the errors? Thank you<br/>
—————————————————————————<br/>
ValueError                                Traceback (most recent call last)<br/>
 in ()<br/>
    184 dataset = load_csv(filename)<br/>
    185 for i in range(len(dataset[0])-1):<br/>
–&gt; 186         str_column_to_float(dataset, i)<br/>
    187 # convert class column to integers<br/>
    188 str_column_to_int(dataset, len(dataset[0])-1)</p>
<p> in str_column_to_float(dataset, column)<br/>
     20 def str_column_to_float(dataset, column):<br/>
     21         for row in dataset:<br/>
—&gt; 22                 row[column] = float(row[column].strip())<br/>
     23<br/>
     24 # Convert string column to integer</p>
<p>ValueError: could not convert string to float:</p>
<div class="reply">
<a aria-label="Reply to WB" class="comment-reply-link" href="#comment-430007" onclick='return addComment.moveForm( "comment-430007", "430007", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-430095">
<div class="comment-container" id="li-comment-430095">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 21, 2018 at 6:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430095" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Are you using Python 2?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430095" onclick='return addComment.moveForm( "comment-430095", "430095", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-4" id="comment-430134">
<div class="comment-container" id="li-comment-430134">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/160276a64f3bab346f10267d5323c222?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/160276a64f3bab346f10267d5323c222?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430007" rel="external nofollow">wb</a></span>
<span class="date">February 21, 2018 at 2:51 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430134" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes  I am</p>
<div class="reply">
<a aria-label="Reply to wb" class="comment-reply-link" href="#comment-430134" onclick='return addComment.moveForm( "comment-430134", "430134", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-4" id="comment-450776">
<div class="comment-container" id="li-comment-450776">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c8592a34514876fd1e4a747c2d2ff0de?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c8592a34514876fd1e4a747c2d2ff0de?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">harshith</span>
<span class="date">October 5, 2018 at 8:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-450776" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi bro whass up</p>
<div class="reply">
<a aria-label="Reply to harshith" class="comment-reply-link" href="#comment-450776" onclick='return addComment.moveForm( "comment-450776", "450776", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even depth-3" id="comment-431188">
<div class="comment-container" id="li-comment-431188">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/128f0d1c2cd29ed12d2a69135d5021dc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/128f0d1c2cd29ed12d2a69135d5021dc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mike Harney</span>
<span class="date">March 5, 2018 at 9:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431188" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi wb, I’m on 3.6 and I found the same issue. Maybe you can answer this Jason, but it looks like the some of the data is misaligned in the sample. When opened in Excel, there are many open spaces followed by data jutted out to an extra column. I assume this is unintentional, and when I corrected the spacing, it appeared to work for me.</p>
<div class="reply">
<a aria-label="Reply to Mike Harney" class="comment-reply-link" href="#comment-431188" onclick='return addComment.moveForm( "comment-431188", "431188", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-431265">
<div class="comment-container" id="li-comment-431265">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 6, 2018 at 6:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431265" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The code was written and tested with Python 2.7.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-431265" onclick='return addComment.moveForm( "comment-431265", "431265", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-435683">
<div class="comment-container" id="li-comment-435683">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4d520b60a75d799c5f7699e1e4e547c0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4d520b60a75d799c5f7699e1e4e547c0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">JU</span>
<span class="date">April 23, 2018 at 7:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435683" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Mike is right – the dataset from the UCI website is slightly defective: It has two tabs in some places where there should be only one. This needs to be corrected during the conversion to CSV. In Excel the easiest way is to use the text importer and then click the “Treat consecutive delimiters as one” checkbox.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-435685">
<div class="comment-container" id="li-comment-435685">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 23, 2018 at 7:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435685" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Here is the dataset ready to use:<br/>
<a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/wheat-seeds.csv" rel="nofollow">https://raw.githubusercontent.com/jbrownlee/Datasets/master/wheat-seeds.csv</a></p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even depth-3" id="comment-447163">
<div class="comment-container" id="li-comment-447163">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7e7d2c532c3bc706ec0bf6a3fec85c6b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7e7d2c532c3bc706ec0bf6a3fec85c6b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alexis Batyk</span>
<span class="date">August 29, 2018 at 6:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-447163" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>[SOLVED]<br/>
i have the same issue with </p>
<p><a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/wheat-seeds.csv" rel="nofollow">https://raw.githubusercontent.com/jbrownlee/Datasets/master/wheat-seeds.csv</a></p>
<p>there is still dirty that csv</p>
<p>use a text editor -&gt; select search and replace tool -&gt; search ‘,,’ replace ‘,’ and it works</p>
<div class="reply">
<a aria-label="Reply to Alexis Batyk" class="comment-reply-link" href="#comment-447163" onclick='return addComment.moveForm( "comment-447163", "447163", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-447193">
<div class="comment-container" id="li-comment-447193">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 29, 2018 at 8:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-447193" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t have such problems on Py 3.6.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-447193" onclick='return addComment.moveForm( "comment-447193", "447193", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-4" id="comment-450367">
<div class="comment-container" id="li-comment-450367">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3f1abfb9722fe725edc0c5ae14598ec1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3f1abfb9722fe725edc0c5ae14598ec1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://jacksonscott.net" rel="external nofollow">Jackson Scott</a></span>
<span class="date">October 1, 2018 at 9:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-450367" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thanks, this worked for me as well. The csv file had some tabbed over and others correct.</p>
<div class="reply">
<a aria-label="Reply to Jackson Scott" class="comment-reply-link" href="#comment-450367" onclick='return addComment.moveForm( "comment-450367", "450367", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="comment-451606">
<div class="comment-container" id="li-comment-451606">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cfa744c359c19540478c6b25cae782b5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cfa744c359c19540478c6b25cae782b5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Deng</span>
<span class="date">October 14, 2018 at 5:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451606" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The data in the seeds_dataset file contains the backspace key, and it is ok to reset the data</p>
<div class="reply">
<a aria-label="Reply to Deng" class="comment-reply-link" href="#comment-451606" onclick='return addComment.moveForm( "comment-451606", "451606", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-369860">
<div class="comment-container" id="li-comment-369860">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/da4244fdf35bb00ddf81b5953121443a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/da4244fdf35bb00ddf81b5953121443a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">MO</span>
<span class="date">November 8, 2016 at 9:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-369860" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>where can i see your data set, i want to see how it looked like</p>
<div class="reply">
<a aria-label="Reply to MO" class="comment-reply-link" href="#comment-369860" onclick='return addComment.moveForm( "comment-369860", "369860", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-369876">
<div class="comment-container" id="li-comment-369876">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 8, 2016 at 10:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-369876" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi MO.</p>
<p>The small contrived dataset used for testing is listed inline in the post in section 4.2</p>
<p>The dataset used for the full example is on the UCI ML repository, linked in the section titled “Wheat Seeds Dataset”. Here is the direct link:<br/>
<a href="http://archive.ics.uci.edu/ml/datasets/seeds" rel="nofollow">http://archive.ics.uci.edu/ml/datasets/seeds</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-369876" onclick='return addComment.moveForm( "comment-369876", "369876", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-370232">
<div class="comment-container" id="li-comment-370232">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/aa64e188d54ba89fd88ee384a0591548?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/aa64e188d54ba89fd88ee384a0591548?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">prakash</span>
<span class="date">November 11, 2016 at 12:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370232" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>in two class classification for 0 the expected value is [1,0] for 1 its is [0,1].<br/>
how will be the output vectors for more than two class??</p>
<div class="reply">
<a aria-label="Reply to prakash" class="comment-reply-link" href="#comment-370232" onclick='return addComment.moveForm( "comment-370232", "370232", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-370268">
<div class="comment-container" id="li-comment-370268">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 11, 2016 at 10:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370268" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi prakash,</p>
<p>For multi-class classification, we can extend the one hot encoding.</p>
<p>Three class values for “red”, “green” “blue” can be represented as an output vector like:<br/>
1, 0, 0 for red<br/>
0, 1, 0 for green<br/>
0, 0, 1 for blue</p>
<p>I hope that helps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-370268" onclick='return addComment.moveForm( "comment-370268", "370268", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-370436">
<div class="comment-container" id="li-comment-370436">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/05d3a6b3db274552359f0329beacfeb6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/05d3a6b3db274552359f0329beacfeb6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rakesh</span>
<span class="date">November 13, 2016 at 3:41 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370436" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason.<br/>
You’ve mentioned that there are 3 output classes.<br/>
How do we check the values which come under the 3 classes / clusters?<br/>
Could we print the data which fall under each class?</p>
<div class="reply">
<a aria-label="Reply to Rakesh" class="comment-reply-link" href="#comment-370436" onclick='return addComment.moveForm( "comment-370436", "370436", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-370498">
<div class="comment-container" id="li-comment-370498">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 14, 2016 at 7:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370498" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Rakesh,</p>
<p>The data does belong to 3 classes. We can check the skill of our model by comparing the predicted classes to the actual/expected classes and calculate an accuracy measure.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-370498" onclick='return addComment.moveForm( "comment-370498", "370498", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-370823">
<div class="comment-container" id="li-comment-370823">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ed861268a75ff080493e6b72509b409a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ed861268a75ff080493e6b72509b409a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex</span>
<span class="date">November 16, 2016 at 12:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370823" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m confused why the activation method iterates from 0 to len(inputs) – 1 instead of from 0 to len(weights) – 1. Am I missing something?</p>
<div class="reply">
<a aria-label="Reply to Alex" class="comment-reply-link" href="#comment-370823" onclick='return addComment.moveForm( "comment-370823", "370823", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-370925">
<div class="comment-container" id="li-comment-370925">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 17, 2016 at 9:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370925" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Alex,</p>
<p>The length of weights is the length of the input + 1 (to accommodate the bias term).</p>
<p>We add the bias term first, then we add the weighted inputs. This is why we iterate over input values.</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-370925" onclick='return addComment.moveForm( "comment-370925", "370925", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-370953">
<div class="comment-container" id="li-comment-370953">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ed861268a75ff080493e6b72509b409a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ed861268a75ff080493e6b72509b409a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex</span>
<span class="date">November 17, 2016 at 12:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-370953" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>When I step through the code above for the ‘forward_propagate’ test case, I see the code correctly generate the output for the single hidden node but that output doesn’t get correctly processed when determining the outputs for the output layer. As written above in the activate function ‘for i in range(len(inputs)-1):’, when the calculation gets to the activate function for the output node for class=0, since ‘inputs’ has a single element in it (the output from the single hidden node), ‘len(inputs) – 1’ equals 0 so the for loop never executes. I’m assuming the code is supposed to read ‘for i in range(len(weights) -1):’ Does that make sense?</p>
<p>I’m just trying to make sure I don’t fundamentally misunderstand something and improve this post for other readers. This site has been really, really helpful for me.</p>
<div class="reply">
<a aria-label="Reply to Alex" class="comment-reply-link" href="#comment-370953" onclick='return addComment.moveForm( "comment-370953", "370953", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-371044">
<div class="comment-container" id="li-comment-371044">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 18, 2016 at 8:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-371044" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m with you now, thanks for helping me catch-up. </p>
<p>Nice spot. I’ll fix up the tutorial.</p>
<p>Update: Fixed. Thanks again mate!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-371044" onclick='return addComment.moveForm( "comment-371044", "371044", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-371350">
<div class="comment-container" id="li-comment-371350">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/41fb215d5b7d2713aa491dbb1f07063c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/41fb215d5b7d2713aa491dbb1f07063c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tomasz Panek</span>
<span class="date">November 21, 2016 at 1:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-371350" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p># Update network weights with error<br/>
def update_weights(network, row, l_rate):<br/>
	for i in range(len(network)):<br/>
		inputs = row<br/>
		if i != 0:<br/>
			inputs = [neuron[‘output’] for neuron in network[i – 1]]<br/>
		for neuron in network[i]:<br/>
			for j in range(len(inputs)-1):<br/>
				neuron[‘weights’][j] += l_rate * neuron[‘delta’] * inputs[j]<br/>
			neuron[‘weights’][-1] += l_rate * neuron[‘delta’]</p>
<p>In this fragment:<br/>
			for j in range(len(inputs)-1):<br/>
				neuron[‘weights’][j] += l_rate * neuron[‘delta’] * inputs[j]<br/>
			neuron[‘weights’][-1] += l_rate * neuron[‘delta’]</p>
<p>If inputs length = 1, you are not updating weights, it’s correct? You are updating only bias, because in hidden layer is only one neuron.</p>
<div class="reply">
<a aria-label="Reply to Tomasz Panek" class="comment-reply-link" href="#comment-371350" onclick='return addComment.moveForm( "comment-371350", "371350", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-371352">
<div class="comment-container" id="li-comment-371352">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/41fb215d5b7d2713aa491dbb1f07063c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/41fb215d5b7d2713aa491dbb1f07063c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tomasz</span>
<span class="date">November 21, 2016 at 1:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-371352" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello. In method update_weight you are doing for j in range(len(inputs) – 1). If inputs lenght = 1, you aren’t updating weights. It’s correct? Hidden layer have one neuron so in output layer weights aren’t updated</p>
<div class="reply">
<a aria-label="Reply to Tomasz" class="comment-reply-link" href="#comment-371352" onclick='return addComment.moveForm( "comment-371352", "371352", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-371489">
<div class="comment-container" id="li-comment-371489">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 22, 2016 at 6:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-371489" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Tomasz, </p>
<p>The assumption here is that the input vector always contains at least one input value and an output value, even if the output is set to None.</p>
<p>You may have found a bug though when updating the layers. I’ll investigate and get back to you.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-371489" onclick='return addComment.moveForm( "comment-371489", "371489", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-379663">
<div class="comment-container" id="li-comment-379663">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 3, 2017 at 10:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-379663" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Tomasz, this was indeed a bug.</p>
<p>I have updated the update_weights() function in the above code examples.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-379663" onclick='return addComment.moveForm( "comment-379663", "379663", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-4" id="comment-451747">
<div class="comment-container" id="li-comment-451747">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7dbaf4305bc8adde504dcf56e6a05050?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7dbaf4305bc8adde504dcf56e6a05050?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jerry Jones</span>
<span class="date">October 16, 2018 at 8:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451747" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t understand how update_weights updates the NN. There is no global variable or return from the function. What am I missing?</p>
<div class="reply">
<a aria-label="Reply to Jerry Jones" class="comment-reply-link" href="#comment-451747" onclick='return addComment.moveForm( "comment-451747", "451747", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-451765">
<div class="comment-container" id="li-comment-451765">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 16, 2018 at 2:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451765" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The weights are passed in by reference and modified in place.</p>
<p>This is an advanced tutorial, I’d recommend using Keras for beginners.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-374990">
<div class="comment-container" id="li-comment-374990">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/eed34e11c4d514f087562dae06a92d93?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/eed34e11c4d514f087562dae06a92d93?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Michael</span>
<span class="date">December 13, 2016 at 4:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-374990" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Thanks for the tutorial, I’m doing a backpropagation project at the moment so its been really useful. </p>
<p>I was a little confused on the back-propagation error calculation function. Does “if i != len(network)-1:” mean that if the current layer isn’t the output layer then this following code is run or does it mean that the current layer is an output layer?</p>
<div class="reply">
<a aria-label="Reply to Michael" class="comment-reply-link" href="#comment-374990" onclick='return addComment.moveForm( "comment-374990", "374990", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-375013">
<div class="comment-container" id="li-comment-375013">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 13, 2016 at 8:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-375013" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear it Michael.</p>
<p>The line means if the index i is not equal to the index of the last layer of the network (the output layer), then run code inside the block.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-375013" onclick='return addComment.moveForm( "comment-375013", "375013", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-380227">
<div class="comment-container" id="li-comment-380227">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/eed34e11c4d514f087562dae06a92d93?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/eed34e11c4d514f087562dae06a92d93?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Michael</span>
<span class="date">January 5, 2017 at 7:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-380227" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have another question.<br/>
Would it be possible to extend the code from this tutorial and create a network that trains using the MNIST handwritten digit set? using a input unit to represent each pixel in the image. I’m also not sure whether/how I could use feature extractors for the images.</p>
<p>I have a project where I have to implement the Backpropagation algorithm with possibly the MNIST handwritten digit training set. </p>
<p>I hope my question makes sense!</p>
<div class="reply">
<a aria-label="Reply to Michael" class="comment-reply-link" href="#comment-380227" onclick='return addComment.moveForm( "comment-380227", "380227", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-380268">
<div class="comment-container" id="li-comment-380268">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 5, 2017 at 9:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-380268" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure Michael, but I would recommend using a library like Keras instead as this code is not written for performance.</p>
<p>Load an image as a long list of pixel integer values, convert to floats and away you go. No feature extraction needed for a simple MLP implementation. You should get performance above 90%.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-380268" onclick='return addComment.moveForm( "comment-380268", "380268", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-380650">
<div class="comment-container" id="li-comment-380650">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d674e92bd259cc3ea6cc30daeed0b2d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d674e92bd259cc3ea6cc30daeed0b2d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Calin</span>
<span class="date">January 6, 2017 at 10:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-380650" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Great post!</p>
<p>I have a concern though:</p>
<p>In train_network method there are these two lines of code:</p>
<p>expected = [0 for i in range(n_outputs)]<br/>
expected[row[-1]] = 1</p>
<p>Couldn’t be the case that expected[row[-1]] = 1 will throw IndexError, as n_outputs is the size of the training set which is a subset of the dataset and row basically contains values from the whole dataset?</p>
<div class="reply">
<a aria-label="Reply to Calin" class="comment-reply-link" href="#comment-380650" onclick='return addComment.moveForm( "comment-380650", "380650", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-380745">
<div class="comment-container" id="li-comment-380745">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 7, 2017 at 8:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-380745" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Calin,</p>
<p>If I understand you correctly, No. The n_outputs var is the length of the number of possible output values.</p>
<p>Maybe put some print() statements in to help you better understand what values variables have.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-380745" onclick='return addComment.moveForm( "comment-380745", "380745", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-380871">
<div class="comment-container" id="li-comment-380871">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d674e92bd259cc3ea6cc30daeed0b2d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d674e92bd259cc3ea6cc30daeed0b2d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Calin</span>
<span class="date">January 7, 2017 at 9:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-380871" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hmm..I ran the entire code (with the csv file downloaded from <a href="http://archive.ics.uci.edu/ml/datasets/seeds" rel="nofollow">http://archive.ics.uci.edu/ml/datasets/seeds</a>), added some breakpoints and this is what I got after a few iterations:</p>
<p>n_outputs  = 168<br/>
row[-1] = 201</p>
<p>which is causing IndexError: list assignment index out of range.</p>
<div class="reply">
<a aria-label="Reply to Calin" class="comment-reply-link" href="#comment-380871" onclick='return addComment.moveForm( "comment-380871", "380871", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-4" id="comment-381390">
<div class="comment-container" id="li-comment-381390">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d10ca8d11301c2f4993ac2279ce4b930?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d10ca8d11301c2f4993ac2279ce4b930?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Adriaan</span>
<span class="date">January 11, 2017 at 4:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381390" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’ve got the same error, That my list assignment index is out of range</p>
<div class="reply">
<a aria-label="Reply to Adriaan" class="comment-reply-link" href="#comment-381390" onclick='return addComment.moveForm( "comment-381390", "381390", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-381425">
<div class="comment-container" id="li-comment-381425">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 11, 2017 at 9:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381425" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry to hear that, did you try running the updated code?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-5" id="comment-382373">
<div class="comment-container" id="li-comment-382373">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c75c4ffacd0596bbc93dfd651e247031?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c75c4ffacd0596bbc93dfd651e247031?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ivan</span>
<span class="date">January 16, 2017 at 10:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-382373" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is error of csv read. Try to reformat it with commas. For me it worked</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-382386">
<div class="comment-container" id="li-comment-382386">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 16, 2017 at 10:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-382386" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What was the problem and fix exactly Ivan?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-5" id="comment-386073">
<div class="comment-container" id="li-comment-386073">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c5f1007e2bd7d86e697779ce73d978fd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c5f1007e2bd7d86e697779ce73d978fd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bob</span>
<span class="date">February 5, 2017 at 10:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-386073" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The data file (<a href="http://archive.ics.uci.edu/ml/machine-learning-databases/00236/seeds_dataset.txt" rel="nofollow">http://archive.ics.uci.edu/ml/machine-learning-databases/00236/seeds_dataset.txt</a>) has a few lines with double tabs (\t\t) as the delimiter — removing the double tabs and changing tabs to commas fixed it.</p>
<p>Thanks for the good article.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-386187">
<div class="comment-container" id="li-comment-386187">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 6, 2017 at 9:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-386187" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the note Bob.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-5" id="comment-452204">
<div class="comment-container" id="li-comment-452204">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/63b157dcb852e58e4acd7c93a8bf8d2d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/63b157dcb852e58e4acd7c93a8bf8d2d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.hit.ac.ze" rel="external nofollow">Rowen Bruce</a></span>
<span class="date">October 20, 2018 at 8:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-452204" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>updated code</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-381397">
<div class="comment-container" id="li-comment-381397">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d10ca8d11301c2f4993ac2279ce4b930?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d10ca8d11301c2f4993ac2279ce4b930?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Adriaan</span>
<span class="date">January 11, 2017 at 5:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381397" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’ve had the same error at the ‘train_network’ function. Is your dataset fine? I’ve had some problems because the CSV file wasn’t loaded correctly due to my regional windows settings. I’ve had to adjust my settings and everything worked out alright. </p>
<p><a href="http://superuser.com/questions/783060/excel-save-as-csv-options-possible-to-change-comma-to-pipe-or-tab-instead" rel="nofollow">http://superuser.com/questions/783060/excel-save-as-csv-options-possible-to-change-comma-to-pipe-or-tab-instead</a></p>
<div class="reply">
<a aria-label="Reply to Adriaan" class="comment-reply-link" href="#comment-381397" onclick='return addComment.moveForm( "comment-381397", "381397", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-381009">
<div class="comment-container" id="li-comment-381009">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fa1374086d343aae43a869f23438e00d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fa1374086d343aae43a869f23438e00d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Stanley</span>
<span class="date">January 8, 2017 at 3:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381009" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for such a good article. </p>
<p>Just one question: in the equation “weight = weight + learning_rate * error * input”, why there is an “input”? IMO it should be: “weight = weight + learning_rate * error”?</p>
<div class="reply">
<a aria-label="Reply to Stanley" class="comment-reply-link" href="#comment-381009" onclick='return addComment.moveForm( "comment-381009", "381009", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-381130">
<div class="comment-container" id="li-comment-381130">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 9, 2017 at 7:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381130" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The var names and explanation are correct.</p>
<p>The update equation is:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca8060a5c2999655823" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
weight = weight + learning_rate * error * input</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca8060a5c2999655823-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca8060a5c2999655823-1"><span class="crayon-v">weight</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">weight</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e ">learning_rate *</span><span class="crayon-h"> </span><span class="crayon-e ">error *</span><span class="crayon-h"> </span><span class="crayon-v">input</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p>For the input layer the input are the input data, for hidden layers the input is the output of the prior layer.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-381130" onclick='return addComment.moveForm( "comment-381130", "381130", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-381762">
<div class="comment-container" id="li-comment-381762">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b6aa4516178a87bb39c050f8b940057c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b6aa4516178a87bb39c050f8b940057c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Madwadasa</span>
<span class="date">January 13, 2017 at 3:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381762" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason,</p>
<p>           Thanks for the code and post.<br/>
Why is “expected”  in expected = [0 for i in range(n_outputs)]  initialized to  [0,0] ?<br/>
Should not the o/p values be taken as expected when training the model ?<br/>
i.e for example in case of Xor should not 1 be taken as the expected ?</p>
<div class="reply">
<a aria-label="Reply to Madwadasa" class="comment-reply-link" href="#comment-381762" onclick='return addComment.moveForm( "comment-381762", "381762", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-381810">
<div class="comment-container" id="li-comment-381810">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 13, 2017 at 9:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-381810" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Madwadasa,</p>
<p>Expected is a one-hot encoding. All classes are “0” expect the actual class for the row which is marked as a “1” on the next line.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-381810" onclick='return addComment.moveForm( "comment-381810", "381810", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-382858">
<div class="comment-container" id="li-comment-382858">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/eed34e11c4d514f087562dae06a92d93?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/eed34e11c4d514f087562dae06a92d93?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Michael</span>
<span class="date">January 19, 2017 at 3:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-382858" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, I have a couple more questions. When training the network with a dataset, does the error at each epoch indicate the distance between the predicted outcomes and the expected outcomes together for the whole dataset? Also when the mean accuracy is given in my case being 13% when I used the MNIST digit set, does this mean that the network will be correct 13% of the time and would have an error rate of 87%?</p>
<div class="reply">
<a aria-label="Reply to Michael" class="comment-reply-link" href="#comment-382858" onclick='return addComment.moveForm( "comment-382858", "382858", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-382900">
<div class="comment-container" id="li-comment-382900">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 19, 2017 at 7:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-382900" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Michael,</p>
<p>The epoch error does capture how wrong the algorithm is on all training data. This may or may not be a distance depending on the error measure used. RMSE is technically not a distance measure, you could use Euclidean distance if you like, but I would not recommend it.</p>
<p>Yes, in generally when the model makes predictions your understanding is correct.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-382900" onclick='return addComment.moveForm( "comment-382900", "382900", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-383717">
<div class="comment-container" id="li-comment-383717">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9840a8441afca615aaa5f7234692111b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9840a8441afca615aaa5f7234692111b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bernardo Galvão</span>
<span class="date">January 24, 2017 at 3:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-383717" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>in the excerpt regarding error of a neuron in a hidden layer:</p>
<p>“Where error_j is the error signal from the jth neuron in the output layer, weight_k is the weight that connects the kth neuron to the current neuron and output is the output for the current neuron.”</p>
<p>is the k-th neuron a neuron in the output layer or a neuron in the hidden layer we’re “on”? What about the current neuron, are you referring to the neuron in the output layer? Sorry, english is not my native tongue.</p>
<p>Appreciate your work!</p>
<p>Bernardo</p>
<div class="reply">
<a aria-label="Reply to Bernardo Galvão" class="comment-reply-link" href="#comment-383717" onclick='return addComment.moveForm( "comment-383717", "383717", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-385291">
<div class="comment-container" id="li-comment-385291">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/403b88a973dc51dc9ef64bbae6c0e28e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/403b88a973dc51dc9ef64bbae6c0e28e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">anonymous</span>
<span class="date">February 1, 2017 at 1:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-385291" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It would have been better if recall and precision were printed. Can somebody tell me how to print them in the above code.</p>
<div class="reply">
<a aria-label="Reply to anonymous" class="comment-reply-link" href="#comment-385291" onclick='return addComment.moveForm( "comment-385291", "385291", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-385423">
<div class="comment-container" id="li-comment-385423">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 1, 2017 at 10:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-385423" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can learn more about precision and recall here:<br/>
<a href="https://en.wikipedia.org/wiki/Precision_and_recall" rel="nofollow">https://en.wikipedia.org/wiki/Precision_and_recall</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-385423" onclick='return addComment.moveForm( "comment-385423", "385423", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-386259">
<div class="comment-container" id="li-comment-386259">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7592c1dd8cb9f45f6b1d89412534feb5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7592c1dd8cb9f45f6b1d89412534feb5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">kehinde kolade</span>
<span class="date">February 6, 2017 at 8:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-386259" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason, great tutorial, I am developer and I do not really know much about this machine learning thing but I need to extend this your code to incorporate the Momentum aspect to the training, can you please explain how I can achieve this extension?</p>
<div class="reply">
<a aria-label="Reply to kehinde kolade" class="comment-reply-link" href="#comment-386259" onclick='return addComment.moveForm( "comment-386259", "386259", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-386365">
<div class="comment-container" id="li-comment-386365">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 7, 2017 at 10:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-386365" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have the capacity to write or spell out this change for you.</p>
<p>My advice would be to read a good book on the topic, such as Neural Smithing: <a href="http://amzn.to/2ld9ds0" rel="nofollow">http://amzn.to/2ld9ds0</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-386365" onclick='return addComment.moveForm( "comment-386365", "386365", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-388719">
<div class="comment-container" id="li-comment-388719">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8aa40a517f98cb5534e0e6dc6f83cc0b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8aa40a517f98cb5534e0e6dc6f83cc0b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ibrahim</span>
<span class="date">February 18, 2017 at 2:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-388719" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I have my own code written in C++, which works similar to your code. My intention is to extend my code to convolutional deep neural nets, and i have actually written the convolution, Relu and pooling functions however i could not begin to apply the backpropagation i have used in my shallow neural net, to the convolutional deep net, cause i really cant imagine the transition of the backpropagation calculation between the convolutional layers and the standard shallow layers existing in the same system. I hoped to find a source for this issue however i always come to the point that there is a standard backpropagation algorithm given for shallow nets that i applied already. Can you please guide me on this problem?</p>
<div class="reply">
<a aria-label="Reply to ibrahim" class="comment-reply-link" href="#comment-388719" onclick='return addComment.moveForm( "comment-388719", "388719", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-388796">
<div class="comment-container" id="li-comment-388796">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 18, 2017 at 8:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-388796" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I”d love to guide you but I don’t have my own from scratch implementation of CNNs, sorry. I’m not best placed to help at the moment.</p>
<p>I’d recommend reading code from existing open source implementations.</p>
<p>Good luck with your project.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-388796" onclick='return addComment.moveForm( "comment-388796", "388796", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-389517">
<div class="comment-container" id="li-comment-389517">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e12ea245a7de8e243d4972c06c1df332?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e12ea245a7de8e243d4972c06c1df332?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://cingkleung.com" rel="external nofollow">matias</a></span>
<span class="date">February 22, 2017 at 3:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-389517" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you, I was looking for exactly this kind of ann algorith. A simple thank won’t be enough tho lol</p>
<div class="reply">
<a aria-label="Reply to matias" class="comment-reply-link" href="#comment-389517" onclick='return addComment.moveForm( "comment-389517", "389517", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-389639">
<div class="comment-container" id="li-comment-389639">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 23, 2017 at 8:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-389639" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad it helped.</p>
<p>The best way to help is to share the post with other people, or maybe purchase one of my books to support my ongoing work:<br/>
<a href="http://machinelearningmastery.com/products" rel="nofollow">http://machinelearningmastery.com/products</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-389639" onclick='return addComment.moveForm( "comment-389639", "389639", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-390209">
<div class="comment-container" id="li-comment-390209">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e773dcb70a26a8cfad75d659427f30c5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e773dcb70a26a8cfad75d659427f30c5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Manohar Katam</span>
<span class="date">February 26, 2017 at 3:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390209" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great one! .. I have one doubt .. the dataset seeds contains missing features/fields for some rows.. how you are handling that …</p>
<div class="reply">
<a aria-label="Reply to Manohar Katam" class="comment-reply-link" href="#comment-390209" onclick='return addComment.moveForm( "comment-390209", "390209", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-390313">
<div class="comment-container" id="li-comment-390313">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 27, 2017 at 5:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390313" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You could set the missing values to 0, you could remove the rows with missing values, you could impute the missing values with mean column values, etc.</p>
<p>Try a few different methods and see what results in the best performing models.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-390313" onclick='return addComment.moveForm( "comment-390313", "390313", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-390756">
<div class="comment-container" id="li-comment-390756">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e773dcb70a26a8cfad75d659427f30c5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e773dcb70a26a8cfad75d659427f30c5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Manohar Katam</span>
<span class="date">March 1, 2017 at 2:59 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390756" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What if I have canonical forms like “male” or “female” in my dataset… Will this program work even with string data..</p>
<div class="reply">
<a aria-label="Reply to Manohar Katam" class="comment-reply-link" href="#comment-390756" onclick='return addComment.moveForm( "comment-390756", "390756", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-390866">
<div class="comment-container" id="li-comment-390866">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 2, 2017 at 8:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390866" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Manohar,</p>
<p>No, you will need to convert them to integers (integer encoding) or similar.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-390866" onclick='return addComment.moveForm( "comment-390866", "390866", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-390434">
<div class="comment-container" id="li-comment-390434">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fa831d998404b4907410de6085d69ba2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fa831d998404b4907410de6085d69ba2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Wissal ARGOUBI</span>
<span class="date">February 27, 2017 at 11:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390434" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great job! this is what i was looking for ! thank you very much .<br/>
However i already have a data base and i didn’t know how to make it work with this code how can i adapt it on my data<br/>
Thank you</p>
<div class="reply">
<a aria-label="Reply to Wissal ARGOUBI" class="comment-reply-link" href="#comment-390434" onclick='return addComment.moveForm( "comment-390434", "390434", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-390485">
<div class="comment-container" id="li-comment-390485">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 28, 2017 at 8:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-390485" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This process will help you work through your predictive modeling problem:<br/>
<a href="http://machinelearningmastery.com/start-here/#process" rel="nofollow">http://machinelearningmastery.com/start-here/#process</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-390485" onclick='return addComment.moveForm( "comment-390485", "390485", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-391271">
<div class="comment-container" id="li-comment-391271">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bbdf9cfbf33951aaf35751f379d1fd84?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bbdf9cfbf33951aaf35751f379d1fd84?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shweta Gupta</span>
<span class="date">March 5, 2017 at 4:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-391271" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for such a great article..<br/>
I have one question, in update_weights why you have used weight=weight+l_rate*delta*input rather than weight=weight+l_rate*delta?</p>
<div class="reply">
<a aria-label="Reply to Shweta Gupta" class="comment-reply-link" href="#comment-391271" onclick='return addComment.moveForm( "comment-391271", "391271", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-391461">
<div class="comment-container" id="li-comment-391461">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 6, 2017 at 10:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-391461" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can learn more about the math in the book on the topic. </p>
<p>I recommend Neural Smithing: <a href="http://amzn.to/2ld9ds0" rel="nofollow">http://amzn.to/2ld9ds0</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-391461" onclick='return addComment.moveForm( "comment-391461", "391461", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-392458">
<div class="comment-container" id="li-comment-392458">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a025e68c7374439da69e52541bef6625?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a025e68c7374439da69e52541bef6625?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sittha</span>
<span class="date">March 13, 2017 at 1:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-392458" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for a good tutorial.<br/>
I have some  IndexError: list assignment index out of range. And I cannot fix it with comma or full-stop separator.</p>
<div class="reply">
<a aria-label="Reply to Sittha" class="comment-reply-link" href="#comment-392458" onclick='return addComment.moveForm( "comment-392458", "392458", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-392571">
<div class="comment-container" id="li-comment-392571">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 14, 2017 at 8:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-392571" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What is the full error you are getting?</p>
<p>Did you copy-paste the full final example and run it on the same dataset?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-392571" onclick='return addComment.moveForm( "comment-392571", "392571", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-393944">
<div class="comment-container" id="li-comment-393944">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6c2a8dcd39c95bf5660785a37f988adc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6c2a8dcd39c95bf5660785a37f988adc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sittha</span>
<span class="date">March 24, 2017 at 3:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-393944" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>line 151 :<br/>
expected[row[-1]] = 1<br/>
IndexError : list assignment  index out of range</p>
<div class="reply">
<a aria-label="Reply to Sittha" class="comment-reply-link" href="#comment-393944" onclick='return addComment.moveForm( "comment-393944", "393944", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-393980">
<div class="comment-container" id="li-comment-393980">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 24, 2017 at 8:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-393980" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Is this with a different dataset?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-393980" onclick='return addComment.moveForm( "comment-393980", "393980", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-399327">
<div class="comment-container" id="li-comment-399327">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/92af1d38e899cd89b71d01c566b67cd0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/92af1d38e899cd89b71d01c566b67cd0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Benji Weiss</span>
<span class="date">May 11, 2017 at 5:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399327" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>if it is a different dataset, what do i need to do to not get this error</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-392903">
<div class="comment-container" id="li-comment-392903">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4e5b3376ce0c57b1bc53d9888bf86024?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4e5b3376ce0c57b1bc53d9888bf86024?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Karan</span>
<span class="date">March 16, 2017 at 6:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-392903" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The dataset that was given was for training the network. Now how do we test the network by providing the 7 features without giving the class label(1,2 or 3) ?</p>
<div class="reply">
<a aria-label="Reply to Karan" class="comment-reply-link" href="#comment-392903" onclick='return addComment.moveForm( "comment-392903", "392903", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-392984">
<div class="comment-container" id="li-comment-392984">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 17, 2017 at 8:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-392984" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You will have to adapt the example to fit the model on all of the training data, then you can call predict() to make predictions on new data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-392984" onclick='return addComment.moveForm( "comment-392984", "392984", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-393320">
<div class="comment-container" id="li-comment-393320">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4e5b3376ce0c57b1bc53d9888bf86024?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4e5b3376ce0c57b1bc53d9888bf86024?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Karan</span>
<span class="date">March 19, 2017 at 7:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-393320" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ok Jason, i’ll try that and get back to you! Thank you!</p>
<div class="reply">
<a aria-label="Reply to Karan" class="comment-reply-link" href="#comment-393320" onclick='return addComment.moveForm( "comment-393320", "393320", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-393321">
<div class="comment-container" id="li-comment-393321">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4e5b3376ce0c57b1bc53d9888bf86024?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4e5b3376ce0c57b1bc53d9888bf86024?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Karan</span>
<span class="date">March 19, 2017 at 7:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-393321" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Just a suggestion for the people who would be using their own dataset(not the seeds_dataset) for training their network, make sure you add an IF loop as follows before the 45th line :<br/>
if minmax[i][1]!=minmax[i][0]</p>
<p>This is because your own dataset might contain same values in the same column and that might cause a divide by zero error.</p>
<div class="reply">
<a aria-label="Reply to Karan" class="comment-reply-link" href="#comment-393321" onclick='return addComment.moveForm( "comment-393321", "393321", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-393371">
<div class="comment-container" id="li-comment-393371">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 20, 2017 at 8:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-393371" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the tip Karan.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-393371" onclick='return addComment.moveForm( "comment-393371", "393371", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-394130">
<div class="comment-container" id="li-comment-394130">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c667ecfa99fb8309df749867ae729ffc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c667ecfa99fb8309df749867ae729ffc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://liquntang.wordpress.com/" rel="external nofollow">Li Qun</a></span>
<span class="date">March 25, 2017 at 5:45 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394130" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks jason for the amazing posts of your from scratch pyhton implementations! i have learned so much from you!</p>
<p>I have followed through both your naive bayes and backprop posts, and I have a (perhaps quite naive) question: </p>
<p>what is the relationship between the two? did backprop actually implement bayesian inference (after all, what i understand is that bayesian = weights being updated every cycle) already? perhaps just non-gaussian? so.. are non-gaussian PDF weight updates not bayesian inference?</p>
<p>i guess to put it simply : is backpropagation essentially a bayesian inference loop for an n number of epochs?</p>
<p>I came from the naive bayes tutorial wanting to implement backpropagation together with your naive bayes implementation but got a bit lost along the way.</p>
<p>sorry if i was going around in circles, i sincerely hope someone would be able to at least point me on the right direction.</p>
<div class="reply">
<a aria-label="Reply to Li Qun" class="comment-reply-link" href="#comment-394130" onclick='return addComment.moveForm( "comment-394130", "394130", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-394185">
<div class="comment-container" id="li-comment-394185">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 26, 2017 at 6:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394185" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question.</p>
<p>No, they are both very different. Naive bayes is a direct use of the probabilities and bayes theorem. The neural net is approximating a mapping function from inputs and outputs – a very different approach that does not directly use the joint probability.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-394185" onclick='return addComment.moveForm( "comment-394185", "394185", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-394245">
<div class="comment-container" id="li-comment-394245">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/80c8454bf99969c638d56da27d2e546c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/80c8454bf99969c638d56da27d2e546c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chiraag</span>
<span class="date">March 26, 2017 at 10:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394245" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How did you decide that the number of folds will be 5 ? Could you please explain the significance of this number. Thank You.</p>
<div class="reply">
<a aria-label="Reply to Chiraag" class="comment-reply-link" href="#comment-394245" onclick='return addComment.moveForm( "comment-394245", "394245", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-394290">
<div class="comment-container" id="li-comment-394290">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 27, 2017 at 7:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394290" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In this case, it was pretty arbitary.</p>
<p>Generally, you want to split the data so that each fold is representative of the dataset. The objective measure is how closely the mean performance reflect the actual performance of the model on unseen data. We can only estimate this in practice (standard error?).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-394290" onclick='return addComment.moveForm( "comment-394290", "394290", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-394355">
<div class="comment-container" id="li-comment-394355">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c667ecfa99fb8309df749867ae729ffc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c667ecfa99fb8309df749867ae729ffc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://liquntang.wordpress.com/" rel="external nofollow">Li Qun</a></span>
<span class="date">March 27, 2017 at 10:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394355" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,</p>
<p>thank you for the reply! I read up a bit more about the differences between Naive Bayes (or Bayesian Nets in general) and Neural Networks and found this Quora answer that i thought was very clear. I’ll put it up here to give other readers a good point to go from: </p>
<p><a href="https://www.quora.com/What-is-the-difference-between-a-Bayesian-network-and-an-artificial-neural-network" rel="nofollow">https://www.quora.com/What-is-the-difference-between-a-Bayesian-network-and-an-artificial-neural-network</a></p>
<p>TL:DR :<br/>
– they look the same, but every node in a Bayesian Network has meaning, in that you can read a Bayesian network structure (like a mind map) and see what’s happening where and why.<br/>
– a Neural Network structure doesn’t have explicit meaning, its just dots that link previous dots.<br/>
– there are more reasons, but the above two highlighted the biggest difference.</p>
<p>Just a quick guess after playing around with backpropagation a little: the way NB and backprop NN would work together is by running Naive Bayes to get a good ‘first guess’ of initial weights that are then run through and Neural Network and Backpropagated?</p>
<div class="reply">
<a aria-label="Reply to Li Qun" class="comment-reply-link" href="#comment-394355" onclick='return addComment.moveForm( "comment-394355", "394355", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-394407">
<div class="comment-container" id="li-comment-394407">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 28, 2017 at 8:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394407" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Please note that a Bayesian network and naive bayes are very different algorithms.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-394407" onclick='return addComment.moveForm( "comment-394407", "394407", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-394359">
<div class="comment-container" id="li-comment-394359">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b4b45a1d938fb70c1fc592ac66f9c849?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b4b45a1d938fb70c1fc592ac66f9c849?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Melissa</span>
<span class="date">March 27, 2017 at 10:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394359" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Further to this update:</p>
<p> Update Jan/2017: Changed the calculation of fold_size in cross_validation_split() to always be an integer. Fixes issues with Python 3.</p>
<p>I’m still having this same problem whilst using python 3, on both the seeds data set and my own. It returns an error at line 75 saying ‘list object has no attribute ‘sum” and also saying than ‘an integer is required.’</p>
<p>Any help would be very much appreciated.<br/>
Overall this code is very helpful. Thank you!</p>
<div class="reply">
<a aria-label="Reply to Melissa" class="comment-reply-link" href="#comment-394359" onclick='return addComment.moveForm( "comment-394359", "394359", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-394408">
<div class="comment-container" id="li-comment-394408">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 28, 2017 at 8:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394408" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry to hear that, did you try copy-paste the complete working example from the end of the post and run it on the same dataset from the command line?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-394408" onclick='return addComment.moveForm( "comment-394408", "394408", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-394418">
<div class="comment-container" id="li-comment-394418">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b4b45a1d938fb70c1fc592ac66f9c849?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b4b45a1d938fb70c1fc592ac66f9c849?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Melissa</span>
<span class="date">March 28, 2017 at 9:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394418" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes I’ve done that, but still the same problem!</p>
<div class="reply">
<a aria-label="Reply to Melissa" class="comment-reply-link" href="#comment-394418" onclick='return addComment.moveForm( "comment-394418", "394418", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-394538">
<div class="comment-container" id="li-comment-394538">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/38ac56634f0c251e5dbf113ab668fb35?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/38ac56634f0c251e5dbf113ab668fb35?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">david</span>
<span class="date">March 29, 2017 at 6:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-394538" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello jason,</p>
<p>please i need help on how to pass the output of the trained network into a fuzzy logic system if possible a code or link which can help understand better. Thank you</p>
<div class="reply">
<a aria-label="Reply to david" class="comment-reply-link" href="#comment-394538" onclick='return addComment.moveForm( "comment-394538", "394538", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-395134">
<div class="comment-container" id="li-comment-395134">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/27234cc290919180762b7218c7be4893?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/27234cc290919180762b7218c7be4893?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aditya</span>
<span class="date">April 2, 2017 at 3:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395134" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Awesome Explanation</p>
<div class="reply">
<a aria-label="Reply to Aditya" class="comment-reply-link" href="#comment-395134" onclick='return addComment.moveForm( "comment-395134", "395134", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-395321">
<div class="comment-container" id="li-comment-395321">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 4, 2017 at 9:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395321" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-395321" onclick='return addComment.moveForm( "comment-395321", "395321", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-395516">
<div class="comment-container" id="li-comment-395516">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6e2a3c6d3d507b984c6c32865cfa727f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6e2a3c6d3d507b984c6c32865cfa727f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Raunak Jain</span>
<span class="date">April 6, 2017 at 5:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395516" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason<br/>
I m getting list assignment index out or range error. How to handle this error?</p>
<div class="reply">
<a aria-label="Reply to Raunak Jain" class="comment-reply-link" href="#comment-395516" onclick='return addComment.moveForm( "comment-395516", "395516", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-395789">
<div class="comment-container" id="li-comment-395789">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 9, 2017 at 2:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395789" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The example was developed for Python 2, perhaps this is Python version issue?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-395789" onclick='return addComment.moveForm( "comment-395789", "395789", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-395538">
<div class="comment-container" id="li-comment-395538">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/51ffefd98dda8a19c7c8196cb75be6fb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/51ffefd98dda8a19c7c8196cb75be6fb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Marco</span>
<span class="date">April 6, 2017 at 9:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395538" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks but I think python is not a good choice…</p>
<div class="reply">
<a aria-label="Reply to Marco" class="comment-reply-link" href="#comment-395538" onclick='return addComment.moveForm( "comment-395538", "395538", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-395796">
<div class="comment-container" id="li-comment-395796">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 9, 2017 at 2:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395796" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I think it is a good choice for learning how backprop works.</p>
<p>What would be a better choice?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-395796" onclick='return addComment.moveForm( "comment-395796", "395796", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-395539">
<div class="comment-container" id="li-comment-395539">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/110197b76f8099b9dff15e9c0a0db52a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/110197b76f8099b9dff15e9c0a0db52a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Agrawal</span>
<span class="date">April 6, 2017 at 9:38 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395539" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey, Jason Thanks for this wonderful lecture on Neural Network.</p>
<p>As I am working on Iris Recognition, I have extracted the features of each eye and store it in .csv file, Can u suggest how further can I build my Backpropagation code.<br/>
As when I run your code I am getting many errors.<br/>
Thank you</p>
<div class="reply">
<a aria-label="Reply to Agrawal" class="comment-reply-link" href="#comment-395539" onclick='return addComment.moveForm( "comment-395539", "395539", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-395797">
<div class="comment-container" id="li-comment-395797">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 9, 2017 at 2:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395797" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This process will help you work through your modeling problem:<br/>
<a href="http://machinelearningmastery.com/start-here/#process" rel="nofollow">http://machinelearningmastery.com/start-here/#process</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-395797" onclick='return addComment.moveForm( "comment-395797", "395797", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-395606">
<div class="comment-container" id="li-comment-395606">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/63bd4d0145d8be1d9218724edb89cbfa?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/63bd4d0145d8be1d9218724edb89cbfa?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jack</span>
<span class="date">April 7, 2017 at 3:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395606" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Could you please convert this iterative implementation into matrix implementation?</p>
<div class="reply">
<a aria-label="Reply to Jack" class="comment-reply-link" href="#comment-395606" onclick='return addComment.moveForm( "comment-395606", "395606", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-395815">
<div class="comment-container" id="li-comment-395815">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 9, 2017 at 2:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-395815" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps in the future Jack.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-395815" onclick='return addComment.moveForm( "comment-395815", "395815", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-396152">
<div class="comment-container" id="li-comment-396152">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/53cfc782eb381c8a336270c9cdafd6f2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/53cfc782eb381c8a336270c9cdafd6f2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jk</span>
<span class="date">April 12, 2017 at 5:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396152" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>In section 4.1 , may you please explain why you used ###  inputs = row[:-1] ###  ?</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Jk" class="comment-reply-link" href="#comment-396152" onclick='return addComment.moveForm( "comment-396152", "396152", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-396174">
<div class="comment-container" id="li-comment-396174">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 12, 2017 at 7:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396174" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes. By default we are back-propagating the error of the expected output vs the network output (inputs = row[:-1]), but if we are not the output layer, propagate the error from the previous layer in the network (inputs = [neuron[‘output’] for neuron in network[i – 1]]).</p>
<p>I hope that helps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-396174" onclick='return addComment.moveForm( "comment-396174", "396174", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-396257">
<div class="comment-container" id="li-comment-396257">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/53cfc782eb381c8a336270c9cdafd6f2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/53cfc782eb381c8a336270c9cdafd6f2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">JK</span>
<span class="date">April 13, 2017 at 3:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396257" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for your respond. I understand what you said , the part I am no understanding is the [:-1] . why eliminating the last list item ?</p>
<div class="reply">
<a aria-label="Reply to JK" class="comment-reply-link" href="#comment-396257" onclick='return addComment.moveForm( "comment-396257", "396257", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-396295">
<div class="comment-container" id="li-comment-396295">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 13, 2017 at 10:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396295" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It is a range from 0 to the second last item in the list, e.g. (0 to n-1)</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-396295" onclick='return addComment.moveForm( "comment-396295", "396295", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-4" id="comment-434281">
<div class="comment-container" id="li-comment-434281">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/97bdacc4e384dbde42c88a223aee9565?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/97bdacc4e384dbde42c88a223aee9565?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Amer</span>
<span class="date">April 6, 2018 at 7:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-434281" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Because the last Item in the weights array is the biass</p>
<div class="reply">
<a aria-label="Reply to Amer" class="comment-reply-link" href="#comment-434281" onclick='return addComment.moveForm( "comment-434281", "434281", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-396220">
<div class="comment-container" id="li-comment-396220">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3d2465e5513171420e78195269e8e2a4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3d2465e5513171420e78195269e8e2a4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Prem Puri</span>
<span class="date">April 12, 2017 at 8:18 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396220" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In function call, def backward_propagate_error(network, expected):<br/>
 how much i understand is , it sequentially pass upto<br/>
if i != len(network)-1:<br/>
			for j in range(len(layer)):<br/>
				error = 0.0<br/>
				for neuron in network[i + 1]:<br/>
					error += (neuron[‘weights’][j] * neuron[‘delta’])<br/>
My question is which value is used in neuron[‘delta’]</p>
<div class="reply">
<a aria-label="Reply to Prem Puri" class="comment-reply-link" href="#comment-396220" onclick='return addComment.moveForm( "comment-396220", "396220", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-396284">
<div class="comment-container" id="li-comment-396284">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 13, 2017 at 10:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396284" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>delta is set in the previous code block. It is the error signal that is being propagated backward.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-396284" onclick='return addComment.moveForm( "comment-396284", "396284", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-433169">
<div class="comment-container" id="li-comment-433169">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/848284904bbf3451793c2ce1889ab2d9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/848284904bbf3451793c2ce1889ab2d9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nishu</span>
<span class="date">March 25, 2018 at 11:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-433169" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m sorry, but I still can’t find the location where delta is set and hence, the code gives error.<br/>
Where is the delta set for the first time?</p>
<div class="reply">
<a aria-label="Reply to Nishu" class="comment-reply-link" href="#comment-433169" onclick='return addComment.moveForm( "comment-433169", "433169", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-396366">
<div class="comment-container" id="li-comment-396366">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3d2465e5513171420e78195269e8e2a4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3d2465e5513171420e78195269e8e2a4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Prem Puri</span>
<span class="date">April 14, 2017 at 3:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396366" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks very much!</p>
<div class="reply">
<a aria-label="Reply to Prem Puri" class="comment-reply-link" href="#comment-396366" onclick='return addComment.moveForm( "comment-396366", "396366", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-396395">
<div class="comment-container" id="li-comment-396395">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 14, 2017 at 8:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-396395" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-396395" onclick='return addComment.moveForm( "comment-396395", "396395", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-397669">
<div class="comment-container" id="li-comment-397669">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c7d7f80d684360f62cd958e52da04972?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c7d7f80d684360f62cd958e52da04972?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">youssef oumate</span>
<span class="date">April 26, 2017 at 4:53 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-397669" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason </p>
<p>Thank you very much for this awesome implementation of neural network,<br/>
I have a question for you : I want to replace the activation function from Sigmoid<br/>
to RELU . So, what are the changes that I should perform in order to get<br/>
correct predictions?</p>
<div class="reply">
<a aria-label="Reply to youssef oumate" class="comment-reply-link" href="#comment-397669" onclick='return addComment.moveForm( "comment-397669", "397669", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-397730">
<div class="comment-container" id="li-comment-397730">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 27, 2017 at 8:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-397730" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I think just a change to the transfer() and transfer_derivative() functions will do the trick.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-397730" onclick='return addComment.moveForm( "comment-397730", "397730", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-397752">
<div class="comment-container" id="li-comment-397752">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c7d7f80d684360f62cd958e52da04972?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c7d7f80d684360f62cd958e52da04972?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">youssef oumate</span>
<span class="date">April 27, 2017 at 10:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-397752" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Awesome !</p>
<p>Thank you so much</p>
<div class="reply">
<a aria-label="Reply to youssef oumate" class="comment-reply-link" href="#comment-397752" onclick='return addComment.moveForm( "comment-397752", "397752", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-397833">
<div class="comment-container" id="li-comment-397833">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 28, 2017 at 7:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-397833" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-397833" onclick='return addComment.moveForm( "comment-397833", "397833", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-398019">
<div class="comment-container" id="li-comment-398019">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f9e3c410ecbc0f82435e2ea3f632e06a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f9e3c410ecbc0f82435e2ea3f632e06a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Yahya Alaa</span>
<span class="date">April 30, 2017 at 2:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398019" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thank you very much for this wonderful implementation of Neural Network, it really helped me a lot to understand neural networks concept,</p>
<p>n_inputs = len(dataset[0]) – 1<br/>
n_outputs = len(set([row[-1] for row in dataset]))<br/>
network = initialize_network(n_inputs, 2, n_outputs)<br/>
train_network(network, dataset, 0.5, 20, n_outputs)</p>
<p>What do n_inputs and n_outputs refer to? According to the small dataset used in this section, is n_inputs only 2 and n_outputs only 2 (0 or 1) or I am missing something?</p>
<div class="reply">
<a aria-label="Reply to Yahya Alaa" class="comment-reply-link" href="#comment-398019" onclick='return addComment.moveForm( "comment-398019", "398019", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-398039">
<div class="comment-container" id="li-comment-398039">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 30, 2017 at 5:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398039" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Input/outputs refers to the number of input and output features (columns) in your data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-398039" onclick='return addComment.moveForm( "comment-398039", "398039", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-398392">
<div class="comment-container" id="li-comment-398392">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f9e3c410ecbc0f82435e2ea3f632e06a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f9e3c410ecbc0f82435e2ea3f632e06a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Yahya Alaa</span>
<span class="date">May 3, 2017 at 1:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398392" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Is the program training the network for 500 epochs for each one of the k-folds and then testing the network with the testing data set?</p>
<div class="reply">
<a aria-label="Reply to Yahya Alaa" class="comment-reply-link" href="#comment-398392" onclick='return addComment.moveForm( "comment-398392", "398392", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-398484">
<div class="comment-container" id="li-comment-398484">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 4, 2017 at 8:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398484" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Yahya,</p>
<p>5-fold cross validation is used.</p>
<p>That means that 5 models are fit and evaluated on 5 different hold out sets. Each model is trained for 500 epochs.</p>
<p>I hope that makes things clearer Yahya.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-398484" onclick='return addComment.moveForm( "comment-398484", "398484", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-4" id="comment-398496">
<div class="comment-container" id="li-comment-398496">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f9e3c410ecbc0f82435e2ea3f632e06a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f9e3c410ecbc0f82435e2ea3f632e06a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Yahya Alaa</span>
<span class="date">May 4, 2017 at 8:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398496" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes you made things clear to me, Thank you.<br/>
I have two other questions,<br/>
How to know when to stop training the network to avoid overfitting?<br/>
How to choose the number of neurons in the hidden layer?</p>
<div class="reply">
<a aria-label="Reply to Yahya Alaa" class="comment-reply-link" href="#comment-398496" onclick='return addComment.moveForm( "comment-398496", "398496", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-398571">
<div class="comment-container" id="li-comment-398571">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 5, 2017 at 7:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398571" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can use early stopping, to save network weights when the skill on a validation set stops improving.</p>
<p>The number of neurons can be found through trial and error.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-5" id="comment-398753">
<div class="comment-container" id="li-comment-398753">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f9e3c410ecbc0f82435e2ea3f632e06a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f9e3c410ecbc0f82435e2ea3f632e06a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Yahya Alaa</span>
<span class="date">May 6, 2017 at 8:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398753" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am working on a program that recognizes handwritten digits, the dataset is consisting of pictures (45*45) pixels each, which is 2025 input neurons, this causes me a problem in the activation function, the summation of (weight[i] * input[i]) is big, then it gives me always a result of (0.99 -&gt; 1) after putting the value of the activation function in the Sigmoid function, any suggestions?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-398864">
<div class="comment-container" id="li-comment-398864">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 7, 2017 at 5:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398864" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend using a Convolutional Neural Network rather than a Multilayer Perceptron.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-398029">
<div class="comment-container" id="li-comment-398029">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/92bd7933f25006410472c346379b36d5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/92bd7933f25006410472c346379b36d5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">morok</span>
<span class="date">April 30, 2017 at 3:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398029" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In section 3.2. Error Backpropagation, where did output numbers came from for testing backpropagation</p>
<p>‘output’: 0.7105668883115941<br/>
‘output’: 0.6213859615555266<br/>
‘output’: 0.6573693455986976</p>
<p>Perhaps from outputs on test forward propagation [0.6629970129852887, 0.7253160725279748] taking dd -&gt; derivative = output * (1.0 – output), problem is they don’t match, so I’m a bit lost here…</p>
<p>thanks!</p>
<p>Awesome article!!!</p>
<div class="reply">
<a aria-label="Reply to morok" class="comment-reply-link" href="#comment-398029" onclick='return addComment.moveForm( "comment-398029", "398029", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-398041">
<div class="comment-container" id="li-comment-398041">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 30, 2017 at 5:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-398041" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In that example, the output and weights were contrived to test back propagation of error. Note the “delta” in those outputs.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-398041" onclick='return addComment.moveForm( "comment-398041", "398041", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-421124">
<div class="comment-container" id="li-comment-421124">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e96ad5cc29e1bb6da950048d42fbd32d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e96ad5cc29e1bb6da950048d42fbd32d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Massa</span>
<span class="date">November 25, 2017 at 7:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-421124" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hello Dr Jason…</p>
<p>I was wondering …</p>
<p>n_outputs = len(set([row[-1] for row in dataset]))</p>
<p>this line, how does it give the number of output features?<br/>
when I print it gives the number of the dataset(number of rows, not columns)</p>
<div class="reply">
<a aria-label="Reply to Massa" class="comment-reply-link" href="#comment-421124" onclick='return addComment.moveForm( "comment-421124", "421124", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-421146">
<div class="comment-container" id="li-comment-421146">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 25, 2017 at 10:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-421146" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The length of the set of values in the final column.</p>
<p>Perhaps this post will help with Python syntax:<br/>
<a href="https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/" rel="nofollow">https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-421146" onclick='return addComment.moveForm( "comment-421146", "421146", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-4" id="comment-421189">
<div class="comment-container" id="li-comment-421189">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e96ad5cc29e1bb6da950048d42fbd32d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e96ad5cc29e1bb6da950048d42fbd32d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Massa</span>
<span class="date">November 26, 2017 at 4:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-421189" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>but I thought it gives the number of outputs…I mean the number of neurons in the output layer.</p>
<p>here it’s giving the number of the dataset ….if I have 200 input/output pairs it prints 200</p>
<p>so I am confused…how would it be?</p>
<div class="reply">
<a aria-label="Reply to Massa" class="comment-reply-link" href="#comment-421189" onclick='return addComment.moveForm( "comment-421189", "421189", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-421205">
<div class="comment-container" id="li-comment-421205">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 26, 2017 at 7:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-421205" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If there are two class values, it should print 2. It should not print the number of examples.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-399034">
<div class="comment-container" id="li-comment-399034">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bf0ef567a0b7edfe1a2924da1068804a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bf0ef567a0b7edfe1a2924da1068804a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Umamaheswaran</span>
<span class="date">May 8, 2017 at 9:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399034" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p> I am using the MNIST data set to implement a handwritten digit classifier. How many training examples will be needed to get a perfomance above 90%.</p>
<div class="reply">
<a aria-label="Reply to Umamaheswaran" class="comment-reply-link" href="#comment-399034" onclick='return addComment.moveForm( "comment-399034", "399034", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-399092">
<div class="comment-container" id="li-comment-399092">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 9, 2017 at 7:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399092" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend using a CNN on MNIST. See this tutorial:<br/>
<a href="http://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/" rel="nofollow">http://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-399092" onclick='return addComment.moveForm( "comment-399092", "399092", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-399149">
<div class="comment-container" id="li-comment-399149">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0138f6e24db7f665b7680a4faf1d0b28?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0138f6e24db7f665b7680a4faf1d0b28?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Huyen</span>
<span class="date">May 9, 2017 at 6:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399149" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Your blog is totally awesome not only by this post but also for the whole series about neural network. Some of them explained so much useful thing than others on Internet. They help me a lot to understand the core of network instead of applying directly Keras or Tensorflow.</p>
<p>Just one question, if I would like to change the result from classification to regression, which part in back propagation I need to change and how?</p>
<p>Thank you in advance for your answer</p>
<div class="reply">
<a aria-label="Reply to Huyen" class="comment-reply-link" href="#comment-399149" onclick='return addComment.moveForm( "comment-399149", "399149", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-399253">
<div class="comment-container" id="li-comment-399253">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 10, 2017 at 8:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399253" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Huyen.</p>
<p>You would change the activation function in the output layer to linear (e.g. no transform).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-399253" onclick='return addComment.moveForm( "comment-399253", "399253", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-399412">
<div class="comment-container" id="li-comment-399412">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9bdbeeeaf0542e8d50c5e867c44074a2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9bdbeeeaf0542e8d50c5e867c44074a2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">TGoritsky</span>
<span class="date">May 12, 2017 at 12:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399412" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I am playing around with your code to better understand how the ANN works. Right now I am trying to do predictions with a NN, that is trained on my own dataset, but the program returns me one class label for all rows in a test dataset. I understand, that normalizing dataset should help, but it doesn`t work (I am using your minmax and normalize_dataset functions). Also, is there a way to return prediction for one-dimensional dataset?<br/>
Here is the code (sorry for lack of formatting):<br/>
def make_predictions():<br/>
    dataset = [[29,46,107,324,56,44,121,35,1],<br/>
            [29,46,109,327,51,37,123,38,1],<br/>
            [28,42,107,309,55,32,124,38,1],<br/>
            [40,112,287,59,35,121,36,1],<br/>
            [27,43,129,306,75,41,107,38,1],<br/>
            [28,38,127,289,79,40,109,37,1],<br/>
            [29,37,126,292,77,35,100,34,1],<br/>
            [30,40,87,48,77,51,272,80,2],<br/>
            [26,37,88,47,84,44,250,80,2],<br/>
            [29,39,91,47,84,46,247,79,2],<br/>
            [28,38,85,45,80,47,249,78,2],<br/>
            [28,36,81,43,76,50,337,83,2],<br/>
            [28,34,75,41,83,52,344,81,2],<br/>
            [30,38,80,46,71,53,347,92,2],<br/>
            [28,35,72,45,64,47,360,101,2]]<br/>
    network = [[{‘weights’: [0.09640510259345969, 0.37923370996257266, 0.5476265202749506, 0.9144446394025773, 0.837692750149296, 0.5343300438262426, 0.7679511829130964, 0.5325204151469501, 0.06532276962299033]}],<br/>
            [{‘weights’: [0.040400453542770665, 0.13301701225112483]}, {‘weights’: [0.1665525504275246, 0.5382087395561351]}, {‘weights’: [0.26800994395551214, 0.3322334781304659]}]]<br/>
#    minmax = dataset_minmax(dataset)<br/>
 #   normalize_dataset(dataset, minmax)<br/>
    for row in dataset:<br/>
        prediction = predict(network, row)<br/>
        print(‘Expected=%d, Got=%d’ % (row[-1], prediction))</p>
<div class="reply">
<a aria-label="Reply to TGoritsky" class="comment-reply-link" href="#comment-399412" onclick='return addComment.moveForm( "comment-399412", "399412", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-399443">
<div class="comment-container" id="li-comment-399443">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 12, 2017 at 7:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399443" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would suggest exploring your problem with the Keras framework:<br/>
<a href="http://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow">http://machinelearningmastery.com/start-here/#deeplearning</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-399443" onclick='return addComment.moveForm( "comment-399443", "399443", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-399961">
<div class="comment-container" id="li-comment-399961">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2c4015dec2450cccdd3df863dd23040f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2c4015dec2450cccdd3df863dd23040f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tomo</span>
<span class="date">May 18, 2017 at 6:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-399961" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason!<br/>
In the function “backward_propagate_error”, when you do this:</p>
<p>		neuron[‘delta’] = errors[j] * transfer_derivative(neuron[‘output’])</p>
<p>The derivative should be applied on the activation of that neuron, not to the output . Am I right??</p>
<p>		neuron[‘delta’] = errors[j] * transfer_derivative(activate(neuron[‘weights’], inputs))</p>
<p>And inputs is:<br/>
		inputs = row[-1]<br/>
		if i != 0:<br/>
			inputs = [neuron[‘output’] for neuron in self.network[i-1]]</p>
<p>Thank you! The post was really helpful!</p>
<div class="reply">
<a aria-label="Reply to Tomo" class="comment-reply-link" href="#comment-399961" onclick='return addComment.moveForm( "comment-399961", "399961", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-400540">
<div class="comment-container" id="li-comment-400540">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b49655a25d156960f928a2b25430b9ef?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b49655a25d156960f928a2b25430b9ef?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tina</span>
<span class="date">May 26, 2017 at 3:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400540" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason!</p>
<p>This is a very interesting contribution to the community 🙂<br/>
Have you tried using the algorithm with other activation functions?<br/>
I tried with Gaussian, tanh and sinx, but the accuracy was not that high, so I think that I omitted something. What I altered were the activation functions and the derivatives. Is there something else that needs to be changed?</p>
<div class="reply">
<a aria-label="Reply to Tina" class="comment-reply-link" href="#comment-400540" onclick='return addComment.moveForm( "comment-400540", "400540", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-401137">
<div class="comment-container" id="li-comment-401137">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 11:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401137" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sigmoid was the defacto standard for many years because it performs well on many different problems. </p>
<p>Now the defacto standard is ReLU.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401137" onclick='return addComment.moveForm( "comment-401137", "401137", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-401683">
<div class="comment-container" id="li-comment-401683">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ef3dc8d91143cd1650d052b9d0d975d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ef3dc8d91143cd1650d052b9d0d975d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Manu</span>
<span class="date">June 6, 2017 at 8:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401683" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sigmoid and ReLU are transfer functions right ?<br/>
Activation function is just the sum of all weights and inputs</p>
<div class="reply">
<a aria-label="Reply to Manu" class="comment-reply-link" href="#comment-401683" onclick='return addComment.moveForm( "comment-401683", "401683", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-401731">
<div class="comment-container" id="li-comment-401731">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 7, 2017 at 7:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401731" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You are correct, but in some frameworks, transfer functions are called activation functions:<br/>
<a href="https://keras.io/activations/" rel="nofollow">https://keras.io/activations/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401731" onclick='return addComment.moveForm( "comment-401731", "401731", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-400644">
<div class="comment-container" id="li-comment-400644">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4d7d7c7ad00661e8f45b9a5be551e31f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4d7d7c7ad00661e8f45b9a5be551e31f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vishwanathan</span>
<span class="date">May 27, 2017 at 8:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400644" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the great post. Here is some observation that I am not able to understand. In the back ward propagate you are not taking all the weights and only considering the jth. Can you kindly help understand. I was under the impression that the delta from output is applied across all the weights,<br/>
				for neuron in network[i + 1]:<br/>
					error += (neuron[‘weights’][j] * neuron[‘delta’])</p>
<div class="reply">
<a aria-label="Reply to vishwanathan" class="comment-reply-link" href="#comment-400644" onclick='return addComment.moveForm( "comment-400644", "400644", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-400645">
<div class="comment-container" id="li-comment-400645">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4d7d7c7ad00661e8f45b9a5be551e31f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4d7d7c7ad00661e8f45b9a5be551e31f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vishwanathan</span>
<span class="date">May 27, 2017 at 8:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400645" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I understand you do not want to take in the bias weight hence the exclusion of the last weight in neuron. I kind of get stumped on bias.</p>
<div class="reply">
<a aria-label="Reply to vishwanathan" class="comment-reply-link" href="#comment-400645" onclick='return addComment.moveForm( "comment-400645", "400645", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-400646">
<div class="comment-container" id="li-comment-400646">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4d7d7c7ad00661e8f45b9a5be551e31f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4d7d7c7ad00661e8f45b9a5be551e31f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vishwanathan</span>
<span class="date">May 27, 2017 at 9:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400646" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the great article. In the backward propagate, the delta value is applied for each weight across the neuron and the error is summed. I am curious why is the delta not applied to individual weights of the neuron and the error summed for that neuron. Can you please clarify?</p>
<div class="reply">
<a aria-label="Reply to vishwanathan" class="comment-reply-link" href="#comment-400646" onclick='return addComment.moveForm( "comment-400646", "400646", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-400706">
<div class="comment-container" id="li-comment-400706">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0707154c61049f645af6783bec2b9725?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0707154c61049f645af6783bec2b9725?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://jgjgjh" rel="external nofollow">Josue</a></span>
<span class="date">May 29, 2017 at 3:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400706" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Why don’t you split the data into TrainData and TestData, like 80% of the dataset for training and 20% for testing, because if you train with 100% of rows of the dataset and then test some rows of the dataset the accuracy will be good . But if you put new data on the seeds.csv the model will work with less accuracy, Right?</p>
<div class="reply">
<a aria-label="Reply to Josue" class="comment-reply-link" href="#comment-400706" onclick='return addComment.moveForm( "comment-400706", "400706", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401170">
<div class="comment-container" id="li-comment-401170">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 12:16 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401170" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can, k-fold cross validation generally gives a better estimate of model performance.</p>
<p>Once we have the estimate and choose our model, we can fit the final model on all available data and make predictions on new data:<br/>
<a href="http://machinelearningmastery.com/train-final-machine-learning-model/" rel="nofollow">http://machinelearningmastery.com/train-final-machine-learning-model/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401170" onclick='return addComment.moveForm( "comment-401170", "401170", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-400727">
<div class="comment-container" id="li-comment-400727">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/67d241041014f0f5d9ebdcc9debacf33?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/67d241041014f0f5d9ebdcc9debacf33?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://donthave" rel="external nofollow">Josue</a></span>
<span class="date">May 29, 2017 at 11:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400727" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the post! I have a question about cross-validation. The dataset of seeds is perfect for 5 folds but for a dataset of 211? I’ll have uniformly sized subset right? (211/5) Can you give me a suggestion how I could handle that ?<br/>
Thanks in advanced.</p>
<div class="reply">
<a aria-label="Reply to Josue" class="comment-reply-link" href="#comment-400727" onclick='return addComment.moveForm( "comment-400727", "400727", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401176">
<div class="comment-container" id="li-comment-401176">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 12:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401176" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>One way is that some records can be discarded to give even sized groups.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401176" onclick='return addComment.moveForm( "comment-401176", "401176", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-400803">
<div class="comment-container" id="li-comment-400803">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c5bf824ed810d04fcbe552afbc0768ac?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c5bf824ed810d04fcbe552afbc0768ac?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sebastián</span>
<span class="date">May 30, 2017 at 9:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-400803" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks so much for the tutorial. It was really helpful!</p>
<div class="reply">
<a aria-label="Reply to Sebastián" class="comment-reply-link" href="#comment-400803" onclick='return addComment.moveForm( "comment-400803", "400803", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401194">
<div class="comment-container" id="li-comment-401194">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 12:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-401194" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad it helped.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401194" onclick='return addComment.moveForm( "comment-401194", "401194", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-402132">
<div class="comment-container" id="li-comment-402132">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ef3dc8d91143cd1650d052b9d0d975d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ef3dc8d91143cd1650d052b9d0d975d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Manu</span>
<span class="date">June 10, 2017 at 9:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-402132" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>any advice on how to handle multi-classifier problems when the classes have high cardinality ?<br/>
I’m thinking about input data of search engines linked to choosen urls.</p>
<div class="reply">
<a aria-label="Reply to Manu" class="comment-reply-link" href="#comment-402132" onclick='return addComment.moveForm( "comment-402132", "402132", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-402178">
<div class="comment-container" id="li-comment-402178">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 11, 2017 at 8:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-402178" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ouch, consider modeling it as regression instead (e.g. a rating or recommender system).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-402178" onclick='return addComment.moveForm( "comment-402178", "402178", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-402304">
<div class="comment-container" id="li-comment-402304">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ef3dc8d91143cd1650d052b9d0d975d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ef3dc8d91143cd1650d052b9d0d975d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Manuel</span>
<span class="date">June 13, 2017 at 1:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-402304" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ok thank you very much Jason.<br/>
But it wont work with searches unseen by the algorithm.<br/>
I red something in the books “Programming collective intelligence” about a neural net from scratch for this king of problem but I don’t understang how it works for the moments…</p>
<div class="reply">
<a aria-label="Reply to Manuel" class="comment-reply-link" href="#comment-402304" onclick='return addComment.moveForm( "comment-402304", "402304", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-402350">
<div class="comment-container" id="li-comment-402350">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 13, 2017 at 8:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-402350" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Consider focusing on one measure/metric that really matters in your domain, then try a suite of framings of the problem and different algorithms to get a feeling for what might work best.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-402350" onclick='return addComment.moveForm( "comment-402350", "402350", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-402977">
<div class="comment-container" id="li-comment-402977">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/959d5fe77a415801a0e4749065d2d60f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/959d5fe77a415801a0e4749065d2d60f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Yash</span>
<span class="date">June 18, 2017 at 6:21 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-402977" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am not able to understand the above code.So, I request you to explain me the above code</p>
<div class="reply">
<a aria-label="Reply to Yash" class="comment-reply-link" href="#comment-402977" onclick='return addComment.moveForm( "comment-402977", "402977", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-403024">
<div class="comment-container" id="li-comment-403024">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 19, 2017 at 8:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-403024" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Which part do you not understand exactly?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-403024" onclick='return addComment.moveForm( "comment-403024", "403024", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-403300">
<div class="comment-container" id="li-comment-403300">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cce0b8ebf653dba6ba6c64769cf1417c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cce0b8ebf653dba6ba6c64769cf1417c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tathagat</span>
<span class="date">June 21, 2017 at 3:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-403300" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason..am a novice in machine learning..have a small question…how can I track the timesteps involved in the algorithm with accordance with the code?</p>
<div class="reply">
<a aria-label="Reply to Tathagat" class="comment-reply-link" href="#comment-403300" onclick='return addComment.moveForm( "comment-403300", "403300", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-403364">
<div class="comment-container" id="li-comment-403364">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 22, 2017 at 6:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-403364" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What do you mean by time steps?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-403364" onclick='return addComment.moveForm( "comment-403364", "403364", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-404185">
<div class="comment-container" id="li-comment-404185">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/194495195e7bc8c0f21b8cc71273be40?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/194495195e7bc8c0f21b8cc71273be40?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">bazooka</span>
<span class="date">June 29, 2017 at 6:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-404185" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason. I am so confused, in the result, why there are 4 set of [output,weight,delta]</p>
<p>like this:<br/>
[{‘output’: 0.9999930495852168, ‘weights’: [0.9315463130784808, 1.0639526745114607, 0.9274685127907779], ‘delta’: -4.508489650980804e-09}, {‘output’: 0.9992087809233077, ‘weights’: [-2.4595353900551125, 5.153506472345162, -0.5778256160239431], ‘delta’: 1.940550145482836e-06}]<br/>
[{‘output’: 0.01193860966265472, ‘weights’: [2.3512725698865053, -8.719060612965613, 1.944330467290268], ‘delta’: -0.0001408287858584854}, {‘output’: 0.988067899681387, ‘weights’: [-2.2568526798573116, 8.720113230271012, -2.0392501730513253], ‘delta’: 0.0001406761850156443}]</p>
<p>after the backpropagation we find the optimal weights to get minimum error, what does these 4 group means?<br/>
E</p>
<div class="reply">
<a aria-label="Reply to bazooka" class="comment-reply-link" href="#comment-404185" onclick='return addComment.moveForm( "comment-404185", "404185", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-404190">
<div class="comment-container" id="li-comment-404190">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 29, 2017 at 7:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-404190" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That is the internal state of the whole trained network.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-404190" onclick='return addComment.moveForm( "comment-404190", "404190", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-404189">
<div class="comment-container" id="li-comment-404189">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e1242e2b42e73cede3549da144ed6d57?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e1242e2b42e73cede3549da144ed6d57?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">hassan</span>
<span class="date">June 29, 2017 at 7:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-404189" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi Jason<br/>
thanks for your code and good description here, i like it so much.<br/>
i run your  example code and encounter with an error same others whom left note here<br/>
 the error is:<br/>
expected[row[-1]] = 1<br/>
IndexError: list assignment index out of range</p>
<p>how i can fix this error?</p>
<div class="reply">
<a aria-label="Reply to hassan" class="comment-reply-link" href="#comment-404189" onclick='return addComment.moveForm( "comment-404189", "404189", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-404193">
<div class="comment-container" id="li-comment-404193">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 29, 2017 at 7:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-404193" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The code was written for Python 2.7, confirm that this is your Python version.</p>
<p>Also confirm that you have copied the code exactly.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-404193" onclick='return addComment.moveForm( "comment-404193", "404193", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-404812">
<div class="comment-container" id="li-comment-404812">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c135376b695ae35d060f01a1151c43d6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c135376b695ae35d060f01a1151c43d6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jerome</span>
<span class="date">July 5, 2017 at 9:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-404812" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,</p>
<p>i have this question about Back Propagate Error</p>
<p>1- derivative sigmoid  = output * (1.0 – output)<br/>
That is ok </p>
<p>2- error = (expected – output) * transfer_derivative(output)<br/>
Ok but it also means that error == 0 for output = 1 whatever the expected is because transfer_derivative(1) ==0</p>
<p>So, whatever the expected , error is nil if output is 1 …<br/>
Is there something rotten here?</p>
<p>Thanks</p>
<p>Jerome</p>
<div class="reply">
<a aria-label="Reply to Jerome" class="comment-reply-link" href="#comment-404812" onclick='return addComment.moveForm( "comment-404812", "404812", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-405420">
<div class="comment-container" id="li-comment-405420">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/75cf6d43b9e8929ba9253a185be4c699?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/75cf6d43b9e8929ba9253a185be4c699?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">wddddds</span>
<span class="date">July 10, 2017 at 10:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-405420" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Jason, It’s a great tutorial and really helpful for me! </p>
<p>But I have to say that trying to reimplement your code strongly increased my ability of debugging 🙂</p>
<div class="reply">
<a aria-label="Reply to wddddds" class="comment-reply-link" href="#comment-405420" onclick='return addComment.moveForm( "comment-405420", "405420", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-405483">
<div class="comment-container" id="li-comment-405483">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 11, 2017 at 10:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-405483" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-405483" onclick='return addComment.moveForm( "comment-405483", "405483", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-406233">
<div class="comment-container" id="li-comment-406233">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c5e8ae78e24da1f52dbb9029073c4be6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c5e8ae78e24da1f52dbb9029073c4be6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Victor</span>
<span class="date">July 17, 2017 at 7:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-406233" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>Thanks for sharing your code. I’m a PhD candidate in machine learning, and I have a doubt about the weights update in section 4.1:</p>
<p>weight = weight + learning_rate * error * input</p>
<p>Should not it be as follows?</p>
<p>weight = weight – learning_rate * error * input</p>
<p>Thanks again for sharing this.</p>
<p>Regards,<br/>
Victor.</p>
<div class="reply">
<a aria-label="Reply to Victor" class="comment-reply-link" href="#comment-406233" onclick='return addComment.moveForm( "comment-406233", "406233", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-408545">
<div class="comment-container" id="li-comment-408545">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c5e8ae78e24da1f52dbb9029073c4be6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c5e8ae78e24da1f52dbb9029073c4be6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Víctor</span>
<span class="date">August 4, 2017 at 11:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408545" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I didn’t say anything, my mistake in understanding.</p>
<p>Thanks again for sharing your work.</p>
<div class="reply">
<a aria-label="Reply to Víctor" class="comment-reply-link" href="#comment-408545" onclick='return addComment.moveForm( "comment-408545", "408545", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-406881">
<div class="comment-container" id="li-comment-406881">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/785810a6e8dfb52098803fb3dede7578?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/785810a6e8dfb52098803fb3dede7578?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vishnu priya</span>
<span class="date">July 22, 2017 at 4:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-406881" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi..<br/>
Thanks for ur coding. It was too helpful. can u suggest me how to use this code for classifying tamil characters. i have tried in cnn and now i need to compare the result with bpn. can u pls suggest me.</p>
<p>thank you</p>
<div class="reply">
<a aria-label="Reply to vishnu priya" class="comment-reply-link" href="#comment-406881" onclick='return addComment.moveForm( "comment-406881", "406881", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-406962">
<div class="comment-container" id="li-comment-406962">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 23, 2017 at 6:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-406962" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps this tutorial on classifying with a CNN would be more useful to you:<br/>
<a href="http://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/" rel="nofollow">http://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-406962" onclick='return addComment.moveForm( "comment-406962", "406962", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-407012">
<div class="comment-container" id="li-comment-407012">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/785810a6e8dfb52098803fb3dede7578?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/785810a6e8dfb52098803fb3dede7578?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vishnu priya</span>
<span class="date">July 23, 2017 at 4:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407012" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you sir.  With this tutorial i have implemented cnn sir. but for BPN i am getting error rate 687.203 sir. i dnt know what to do sir. can u help me sir.</p>
<p>Thank you</p>
<div class="reply">
<a aria-label="Reply to vishnu priya" class="comment-reply-link" href="#comment-407012" onclick='return addComment.moveForm( "comment-407012", "407012", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-407079">
<div class="comment-container" id="li-comment-407079">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 24, 2017 at 6:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407079" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What is the problem exactly?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-407079" onclick='return addComment.moveForm( "comment-407079", "407079", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-407137">
<div class="comment-container" id="li-comment-407137">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/785810a6e8dfb52098803fb3dede7578?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/785810a6e8dfb52098803fb3dede7578?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vishnupriya</span>
<span class="date">July 24, 2017 at 4:53 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407137" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Classification of Tamil characters sir. I have 144 different classes. I have taken 7 glcm features of each character and I need to train this features in backpropagation and predict the character to which class it belongs.</p>
<div class="reply">
<a aria-label="Reply to Vishnupriya" class="comment-reply-link" href="#comment-407137" onclick='return addComment.moveForm( "comment-407137", "407137", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-407218">
<div class="comment-container" id="li-comment-407218">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 25, 2017 at 9:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407218" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sound like a great project!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-407218" onclick='return addComment.moveForm( "comment-407218", "407218", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-407398">
<div class="comment-container" id="li-comment-407398">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ca5c626a48952b317f06e7d65d0706cb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ca5c626a48952b317f06e7d65d0706cb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">codeo</span>
<span class="date">July 26, 2017 at 5:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407398" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, so I wasn’t following this tutorial when implementing my neural network from scratch, and mine is in JavaScript. I just need help with the theory. How do I calculate the error for each node in the net so that I can incrementally change the weights? Great tutorial btw</p>
<div class="reply">
<a aria-label="Reply to codeo" class="comment-reply-link" href="#comment-407398" onclick='return addComment.moveForm( "comment-407398", "407398", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-407408">
<div class="comment-container" id="li-comment-407408">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ca5c626a48952b317f06e7d65d0706cb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ca5c626a48952b317f06e7d65d0706cb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">codeo</span>
<span class="date">July 26, 2017 at 6:38 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407408" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hahaha nevermind, it was my code<br/>
Multidimensional arrays and stuff boggle the mind hah</p>
<div class="reply">
<a aria-label="Reply to codeo" class="comment-reply-link" href="#comment-407408" onclick='return addComment.moveForm( "comment-407408", "407408", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-407476">
<div class="comment-container" id="li-comment-407476">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 27, 2017 at 7:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-407476" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear you worked it out.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-407476" onclick='return addComment.moveForm( "comment-407476", "407476", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-408006">
<div class="comment-container" id="li-comment-408006">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ab3ef00b2d5371febe545e3e31cc17f3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ab3ef00b2d5371febe545e3e31cc17f3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">PRABHAKARAN M</span>
<span class="date">July 31, 2017 at 4:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408006" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>[ 6.38491205	5.333345	4.81565798	5.43552204	9.96445304	2.57268919	4.07671018	1.5258789	6.19728301	0	1	]<br/>
Dear sir,<br/>
the above mentioned numerical values are extracted from the dental x-ray image using gray level co occurrence matrix [10 inputs and 1 output]. This dataset is used as a input for BPN classifier. whether the same data set as[.csv] file can be used as the input for DEEP Convolutional Neural Network technique ? and can i get the output as image ? for example if i give the dental x ray images as numerical values i have to get the caries affected teeth as the output for the given dataset.</p>
<div class="reply">
<a aria-label="Reply to PRABHAKARAN M" class="comment-reply-link" href="#comment-408006" onclick='return addComment.moveForm( "comment-408006", "408006", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-408079">
<div class="comment-container" id="li-comment-408079">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 1, 2017 at 7:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408079" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That sounds like a great problem. It may be possible.</p>
<p>I would recommend using deep CNNs.</p>
<p>Perhaps this tutorial will give you some ideas on how to get started:<br/>
<a href="http://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/" rel="nofollow">http://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/</a></p>
<p>You may want to look at some papers on object localization in images. I don’t have material on it sorry.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-408079" onclick='return addComment.moveForm( "comment-408079", "408079", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-408007">
<div class="comment-container" id="li-comment-408007">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ab3ef00b2d5371febe545e3e31cc17f3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ab3ef00b2d5371febe545e3e31cc17f3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">PRABHAKARAN M</span>
<span class="date">July 31, 2017 at 4:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408007" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>can i get the example code for dental caries detection using deep Convolutional Neural Network for the given dataset as x ray images.</p>
<div class="reply">
<a aria-label="Reply to PRABHAKARAN M" class="comment-reply-link" href="#comment-408007" onclick='return addComment.moveForm( "comment-408007", "408007", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-408080">
<div class="comment-container" id="li-comment-408080">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 1, 2017 at 7:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408080" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I do not have sample code for this problem, sorry.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-408080" onclick='return addComment.moveForm( "comment-408080", "408080", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-408057">
<div class="comment-container" id="li-comment-408057">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b795467df2464d8a9f719fbfec9cd564?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b795467df2464d8a9f719fbfec9cd564?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">John</span>
<span class="date">August 1, 2017 at 3:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408057" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Very nice explanation, thank you.<br/>
I have some questions.</p>
<p>1) weight = weight + learning_rate * error * input</p>
<p>Do I really need to multiply it with input ? For example here <a href="http://home.agh.edu.pl/~vlsi/AI/backp_t_en/backprop.html" rel="nofollow">http://home.agh.edu.pl/~vlsi/AI/backp_t_en/backprop.html</a> they dont it multiply it with input. At least, I think that…</p>
<p>2) Is your method same as in <a href="http://home.agh.edu.pl/~vlsi/AI/backp_t_en/backprop.html" rel="nofollow">http://home.agh.edu.pl/~vlsi/AI/backp_t_en/backprop.html</a>?<br/>
i think yes, but again, Im not sure and Im confused by that input multiplication. </p>
<p>3) What is exactly loss function in your example (I usually found some derivations of loss (cost ?) function (in other explanations), not transfer function derivation)? Im actually very confused by notation which I find around …</p>
<p>4) momentum and weight decay. In  your example, you can implement them that you substract calculated decay and add calculated momentum (to weight update) ? Again, I found forms which substract both and weight update as w + deltaW, so again I’m mega confused by notation for backpropagation which I found…</p>
<p>Sorry for dumb questions, … math is not my strong side, so many things which can be inferred by math sense are simply hidden for me.</p>
<div class="reply">
<a aria-label="Reply to John" class="comment-reply-link" href="#comment-408057" onclick='return addComment.moveForm( "comment-408057", "408057", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-408058">
<div class="comment-container" id="li-comment-408058">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b795467df2464d8a9f719fbfec9cd564?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b795467df2464d8a9f719fbfec9cd564?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">John</span>
<span class="date">August 1, 2017 at 3:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408058" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>*substract both and weight update as w + deltaW, so again</p>
<p>I found above sentence as nonsense, must be side effect of my confusion …</p>
<div class="reply">
<a aria-label="Reply to John" class="comment-reply-link" href="#comment-408058" onclick='return addComment.moveForm( "comment-408058", "408058", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-3" id="comment-408096">
<div class="comment-container" id="li-comment-408096">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 1, 2017 at 8:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408096" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hang in there. </p>
<p>Pick one tutorial and focus on it. Jumping from place to place will make things worse for sure.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-408096" onclick='return addComment.moveForm( "comment-408096", "408096", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-408094">
<div class="comment-container" id="li-comment-408094">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 1, 2017 at 8:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408094" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi John, good questions.</p>
<p>According to my textbook, yes.<br/>
I can’t speak for random sites on the internet sorry.</p>
<p>Loss is prediction error. You can change this to other forms like MAE or MSE.</p>
<p>No decay or momentum in this example. Easy to add if you want. There are many ways to dial in the learning process. No hard and fast rules, just some norms that people reuse.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-408094" onclick='return addComment.moveForm( "comment-408094", "408094", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-408748">
<div class="comment-container" id="li-comment-408748">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a11dc1ca672ffee4c876eee33b7ac7ca?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a11dc1ca672ffee4c876eee33b7ac7ca?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Parminder Kaur</span>
<span class="date">August 6, 2017 at 7:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408748" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>A VERY GOOD TUTORIAL SIR…<br/>
Sir i am implementing remote sensed image classification using BPN neural network using IDL.<br/>
I am not finding good resources on constructing features for input dataset and also number of hidden layers and number of neurons in hidden layer.<br/>
Any resources you know, can help me?</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Parminder Kaur" class="comment-reply-link" href="#comment-408748" onclick='return addComment.moveForm( "comment-408748", "408748", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-408800">
<div class="comment-container" id="li-comment-408800">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 7, 2017 at 8:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-408800" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The CNN will perform feature extraction automatically, you could explore using different filters on the data to see if it helps the network.</p>
<p>The number of layers and neurons/filters per layer must be found using trial and error. It is common to copy the designs from other papers as a starting point.</p>
<p>I hope that helps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-408800" onclick='return addComment.moveForm( "comment-408800", "408800", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-409003">
<div class="comment-container" id="li-comment-409003">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1268ae50179722425c7c57aaa5984486?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1268ae50179722425c7c57aaa5984486?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">pero</span>
<span class="date">August 9, 2017 at 1:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-409003" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice tutorial, very clean and readable code. =)  thank you!</p>
<div class="reply">
<a aria-label="Reply to pero" class="comment-reply-link" href="#comment-409003" onclick='return addComment.moveForm( "comment-409003", "409003", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-409043">
<div class="comment-container" id="li-comment-409043">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 9, 2017 at 6:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-409043" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks pero.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-409043" onclick='return addComment.moveForm( "comment-409043", "409043", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-409615">
<div class="comment-container" id="li-comment-409615">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f50075a51189a6ad3ba2f2e313965e54?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f50075a51189a6ad3ba2f2e313965e54?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vatandas</span>
<span class="date">August 15, 2017 at 3:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-409615" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>1. I expect that this code is deep learning (many hidden layer) but not. One sentence is easy (“you can add more hidden layer as explained”) but to do is not as easy as you said.</p>
<p>2. I think your code is wrong.<br/>
neuron[‘delta’] = errors[j] * transfer_derivative(neuron[‘output’])<br/>
but<br/>
Error = Target – ActivatedOutputNode<br/>
Delta = Error * Derivative(NONActivatedOutputNode)</p>
<p>I mean you use the same ‘output’ variable both error and delta. But in error it must be activated one, in delta it must be NONactivated one.</p>
<div class="reply">
<a aria-label="Reply to Vatandas" class="comment-reply-link" href="#comment-409615" onclick='return addComment.moveForm( "comment-409615", "409615", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-410043">
<div class="comment-container" id="li-comment-410043">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1a4213d34804626d852f6e053ff42e98?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1a4213d34804626d852f6e053ff42e98?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">8CG_256</span>
<span class="date">August 18, 2017 at 9:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410043" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice tutorial, very clean code and beginner-friendly. Thank you very much!</p>
<div class="reply">
<a aria-label="Reply to 8CG_256" class="comment-reply-link" href="#comment-410043" onclick='return addComment.moveForm( "comment-410043", "410043", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-410090">
<div class="comment-container" id="li-comment-410090">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 18, 2017 at 4:36 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410090" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, I’m glad you found it useful!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-410090" onclick='return addComment.moveForm( "comment-410090", "410090", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-410125">
<div class="comment-container" id="li-comment-410125">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1a4213d34804626d852f6e053ff42e98?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1a4213d34804626d852f6e053ff42e98?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">8CG_256</span>
<span class="date">August 18, 2017 at 9:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410125" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I only have one slight issue: I implemented this in Ruby and I tried to train it using the IRIS dataset, keeping the network simple (1 input layer, 1 hidden layer, 1 output layer) and after decreasing for a while the error rate keeps increasing. I tried lowering the learning rate, even making it dynamic so it decreases whenever the error increases but it doesn’t seem to help. Could you give me some advice? P.S sorry for my bad English</p>
<div class="reply">
<a aria-label="Reply to 8CG_256" class="comment-reply-link" href="#comment-410125" onclick='return addComment.moveForm( "comment-410125", "410125", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-3" id="comment-410183">
<div class="comment-container" id="li-comment-410183">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 19, 2017 at 6:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410183" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Here is an example of backprop I developed in Ruby:<br/>
<a href="http://cleveralgorithms.com/nature-inspired/neural/backpropagation.html" rel="nofollow">http://cleveralgorithms.com/nature-inspired/neural/backpropagation.html</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-410183" onclick='return addComment.moveForm( "comment-410183", "410183", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-410592">
<div class="comment-container" id="li-comment-410592">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/26b98e129350b612628d7ba5094429dd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/26b98e129350b612628d7ba5094429dd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Derek Martins</span>
<span class="date">August 22, 2017 at 9:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410592" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, I enjoy so much your tutorials. Can you do a tutorial implementing BackPropagation Through Time? Thanks man.</p>
<div class="reply">
<a aria-label="Reply to Derek Martins" class="comment-reply-link" href="#comment-410592" onclick='return addComment.moveForm( "comment-410592", "410592", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-410658">
<div class="comment-container" id="li-comment-410658">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 23, 2017 at 6:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410658" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion.</p>
<p>I have a few posts on the general topic, for example:<br/>
<a href="https://machinelearningmastery.com/gentle-introduction-backpropagation-time/" rel="nofollow">https://machinelearningmastery.com/gentle-introduction-backpropagation-time/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-410658" onclick='return addComment.moveForm( "comment-410658", "410658", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-410863">
<div class="comment-container" id="li-comment-410863">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a7cb65695fb2f8b52ea5917dca40d2d4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a7cb65695fb2f8b52ea5917dca40d2d4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://xprilion.com" rel="external nofollow">Anubhav Singh</a></span>
<span class="date">August 24, 2017 at 1:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-410863" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>Thank you for the great tutorial!</p>
<p>I would like to know how I can obtain the weight*input for every single neuron in the network…</p>
<p>I’ve been trying these lines – </p>
<p>for layer in network:<br/>
		new_inputs = []<br/>
		for neuron in layer:<br/>
			activation = activate(neuron[‘weights’], inputs)<br/>
			neuron[‘output’] = transfer(activation)<br/>
			new_inputs.append(neuron[‘output’])</p>
<p>but the activation variable here is a single value…what I understand is that if I have set n_hidden = 5 (number of hidden layers), I should get N*5 (N = number of features in the dataset) outputs if I print the activation…</p>
<p>Kindly help 🙂</p>
<p>Thank you!</p>
<div class="reply">
<a aria-label="Reply to Anubhav Singh" class="comment-reply-link" href="#comment-410863" onclick='return addComment.moveForm( "comment-410863", "410863", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-411028">
<div class="comment-container" id="li-comment-411028">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3cc61772448f5917d23ae1e3487635f1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3cc61772448f5917d23ae1e3487635f1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jose Panakkel</span>
<span class="date">August 25, 2017 at 10:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-411028" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,</p>
<p>I have a question on the delta calculation at the output layer, where<br/>
the primary value is the difference between the neuron output and<br/>
the expected output. And we are then multiplying this difference<br/>
with the transfer_derivative. where transfer_derivative is a function<br/>
of neuron’s output.</p>
<p>My question is, is it correct to find the difference between the<br/>
neuron’s output and the expected output?</p>
<p>In this case of the example, you have chosen digital outputs [0,1]<br/>
and hence it may not have come up .. but my point is…<br/>
one is already subjected to a transfer function, and one is not.</p>
<p>The neuron’s output is always subjected to a transfer function and<br/>
hence will be in a specific range, say -.5 to +.5 or something..<br/>
But the expected output is the user’s choice .. isnt it?<br/>
user can have an expected value of say 488.34, for some stock price<br/>
learning.. then is it still correct to find this primary difference<br/>
between the expected output and the neuron output, at the output<br/>
layer delta calculation?</p>
<p>shoulnt the expected output also be subjected to the same transfer<br/>
function before finding the difference? Or the otherway, like<br/>
shoulnt the neuron ouptut be subjected to a reverse transfer function<br/>
before comparing with the expected output directly?</p>
<p>Thanks and Regards,<br/>
Jose Panakkel</p>
<div class="reply">
<a aria-label="Reply to Jose Panakkel" class="comment-reply-link" href="#comment-411028" onclick='return addComment.moveForm( "comment-411028", "411028", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-412837">
<div class="comment-container" id="li-comment-412837">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d6508606fe9489601d669f5cdc283d7b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d6508606fe9489601d669f5cdc283d7b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">RealUser404</span>
<span class="date">September 6, 2017 at 1:36 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-412837" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason, great tutorial that helped me a lot!</p>
<p>I have a question concerning the back-propagation : what if instead of having an error function I only have a desired gradient for the output (in the case of an actor-critic model for example)?<br/>
How can I change your backprop function to make it work? Or can I just use the gradient as the error?</p>
<div class="reply">
<a aria-label="Reply to RealUser404" class="comment-reply-link" href="#comment-412837" onclick='return addComment.moveForm( "comment-412837", "412837", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-412962">
<div class="comment-container" id="li-comment-412962">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 7, 2017 at 12:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-412962" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t follow, perhaps you can restate your question with an example?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-412962" onclick='return addComment.moveForm( "comment-412962", "412962", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-413123">
<div class="comment-container" id="li-comment-413123">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6225bd61d073fc6ba733e76c0b6499bd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6225bd61d073fc6ba733e76c0b6499bd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">user28</span>
<span class="date">September 8, 2017 at 9:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413123" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason , thank you for providing this tutorial. I’m confused  of how can I implement the same backpropagation algorithm with output not binary. Since I noticed that your example has binary output. Like predicting for stock price given the  open, high, low and close values. Regards.</p>
<div class="reply">
<a aria-label="Reply to user28" class="comment-reply-link" href="#comment-413123" onclick='return addComment.moveForm( "comment-413123", "413123", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-413225">
<div class="comment-container" id="li-comment-413225">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 9, 2017 at 11:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413225" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Use a library like Keras. Start here:<br/>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow">https://machinelearningmastery.com/start-here/#deeplearning</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-413225" onclick='return addComment.moveForm( "comment-413225", "413225", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-413386">
<div class="comment-container" id="li-comment-413386">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8283c11827ba7552e4edc668aa74e2c3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8283c11827ba7552e4edc668aa74e2c3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://na" rel="external nofollow">Lewis</a></span>
<span class="date">September 11, 2017 at 2:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413386" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>great article. I have an interest in NN but I am not that good at python. </p>
<p>Want I wanted to try was to withhold say 5 rows from the dataset and have the trained network predict the results for those rows. these is is different from what I think the example does which is rolling predictions with the learning. Removing 5 rows from the dataset is of course easy but my pitiful attempts at predicting with unseen data like below fail ((I guess network is not in scope at the end): any help appreciated!</p>
<p># predict unseen data<br/>
unseendataset = [[12.37,13.47,0.8567,5.204,2.96,3.919,5.001],<br/>
[12.19,13.2,0.8783,5.137,2.981,3.631,4.87],<br/>
[11.23,12.88,0.8511,5.14,2.795,4.325,5.003],<br/>
[13.2,13.66,0.8883,5.236,3.232,8.315,5.056],<br/>
[11.84,13.21,0.8521,5.175,2.836,3.598,5.044],<br/>
[12.3,13.34,0.8684,5.243,2.974,5.637,5.063]]</p>
<p>for row in unseendataset:<br/>
    prediction2 = predict(network, row)<br/>
    print(‘Predicted=%d’ % (prediction2))</p>
<div class="reply">
<a aria-label="Reply to Lewis" class="comment-reply-link" href="#comment-413386" onclick='return addComment.moveForm( "comment-413386", "413386", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-413434">
<div class="comment-container" id="li-comment-413434">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 11, 2017 at 12:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413434" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend starting with Keras rather than coding the algorithm from scratch.</p>
<p>Start here:<br/>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow">https://machinelearningmastery.com/start-here/#deeplearning</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-413434" onclick='return addComment.moveForm( "comment-413434", "413434", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-413775">
<div class="comment-container" id="li-comment-413775">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ce124181d0a03bb5edf4f647f95b9fad?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ce124181d0a03bb5edf4f647f95b9fad?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://www.linkedin.com/in/kmagdy/" rel="external nofollow">Karim</a></span>
<span class="date">September 14, 2017 at 1:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413775" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, I am trying to generalize your implementation to work with a variable number of layers and nodes. However, whenever I try to increase the number of nodes too much it stops working (the network freezes at one error rate and all output nodes are active, i.e. giving 1). Although the code would work if I decreased the layers and the errors will go down.<br/>
Is there something I am missing when using too many layers? The concepts should be the same. </p>
<p>I trained a network with 4 layers: [14,10,10,4] and it worked.<br/>
I trained a network with 4 layers [14,100,40,4] and it is stuck. Same dataset. </p>
<p>My code is here if you are looking in more details:<br/>
<a href="https://github.com/KariMagdy/Implementing-a-neural-network" rel="nofollow">https://github.com/KariMagdy/Implementing-a-neural-network</a></p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Karim" class="comment-reply-link" href="#comment-413775" onclick='return addComment.moveForm( "comment-413775", "413775", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-413891">
<div class="comment-container" id="li-comment-413891">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 15, 2017 at 12:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-413891" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What problem do you get exactly?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-413891" onclick='return addComment.moveForm( "comment-413891", "413891", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-415614">
<div class="comment-container" id="li-comment-415614">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bc803c364515901e16bbc203c53d3ca2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bc803c364515901e16bbc203c53d3ca2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Laksh</span>
<span class="date">October 4, 2017 at 11:11 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-415614" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason Brownlee,<br/>
can we extend this code for 2 or more hidden layers ?</p>
<div class="reply">
<a aria-label="Reply to Laksh" class="comment-reply-link" href="#comment-415614" onclick='return addComment.moveForm( "comment-415614", "415614", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-415653">
<div class="comment-container" id="li-comment-415653">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 5, 2017 at 5:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-415653" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-415653" onclick='return addComment.moveForm( "comment-415653", "415653", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-416085">
<div class="comment-container" id="li-comment-416085">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a17ed90fdc8633fa31b3787ed44a65d8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a17ed90fdc8633fa31b3787ed44a65d8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">dsliver33</span>
<span class="date">October 9, 2017 at 1:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416085" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Mr. Brownlee,</p>
<p>I’m trying to alter the code to represent a regression problem (sigmoid on hidden layer, linear on output layer). As far as I know, the main part of the code that would have to be modified is the FF algorithm. I’ve rewritten the code as below:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806092ef620875267" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Forward propagate input to a network output
def forward_propagate_regression(network, row):
    inputs = row
    new_inputs = []
    #gets the 1st layer, applies sigmoid activation
    hiddenlayer = network[0]
    for neuron in hiddenlayer:
        activation = activate(neuron['weights'], inputs)
        neuron['output'] = transfer(activation)
        new_inputs.append(neuron['output'])
    inputs = new_inputs
    #gets the last layer, applies linear activation
    outputlayer = network[-1]
    for neuron in outputlayer:
            activation = activate(neuron['weights'], inputs)
            neuron['output'] = activation
            new_inputs.append(neuron['output'])
    inputs = new_inputs
    return inputs</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806092ef620875267-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806092ef620875267-2">2</div><div class="crayon-num" data-line="crayon-5c0ca806092ef620875267-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806092ef620875267-4">4</div><div class="crayon-num" data-line="crayon-5c0ca806092ef620875267-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806092ef620875267-6">6</div><div class="crayon-num" data-line="crayon-5c0ca806092ef620875267-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806092ef620875267-8">8</div><div class="crayon-num" data-line="crayon-5c0ca806092ef620875267-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806092ef620875267-10">10</div><div class="crayon-num" data-line="crayon-5c0ca806092ef620875267-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806092ef620875267-12">12</div><div class="crayon-num" data-line="crayon-5c0ca806092ef620875267-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806092ef620875267-14">14</div><div class="crayon-num" data-line="crayon-5c0ca806092ef620875267-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806092ef620875267-16">16</div><div class="crayon-num" data-line="crayon-5c0ca806092ef620875267-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806092ef620875267-18">18</div><div class="crayon-num" data-line="crayon-5c0ca806092ef620875267-19">19</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806092ef620875267-1"><span class="crayon-p"># Forward propagate input to a network output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806092ef620875267-2"><span class="crayon-e">def </span><span class="crayon-e">forward_propagate_regression</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806092ef620875267-3"><span class="crayon-h">    </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">row</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806092ef620875267-4"><span class="crayon-e">    </span><span class="crayon-v">new_inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806092ef620875267-5"><span class="crayon-h">    </span><span class="crayon-p">#gets the 1st layer, applies sigmoid activation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806092ef620875267-6"><span class="crayon-h">    </span><span class="crayon-v">hiddenlayer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca806092ef620875267-7"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">hiddenlayer</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806092ef620875267-8"><span class="crayon-h">        </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806092ef620875267-9"><span class="crayon-h">        </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">transfer</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806092ef620875267-10"><span class="crayon-h">        </span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806092ef620875267-11"><span class="crayon-h">    </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">new_inputs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806092ef620875267-12"><span class="crayon-h">    </span><span class="crayon-p">#gets the last layer, applies linear activation</span></div><div class="crayon-line" id="crayon-5c0ca806092ef620875267-13"><span class="crayon-h">    </span><span class="crayon-v">outputlayer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806092ef620875267-14"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">outputlayer</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806092ef620875267-15"><span class="crayon-h">            </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activate</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806092ef620875267-16"><span class="crayon-h">            </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">activation</span></div><div class="crayon-line" id="crayon-5c0ca806092ef620875267-17"><span class="crayon-e">            </span><span class="crayon-v">new_inputs</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806092ef620875267-18"><span class="crayon-h">    </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_inputs</span></div><div class="crayon-line" id="crayon-5c0ca806092ef620875267-19"><span class="crayon-e">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0011 seconds] -->
<p></p>
<p>With this code, I’m getting an “OverflowError: (34, ‘Result too large’)” error. Could you please tell what I’m doing wrong? All the other parts of the code are as you’ve written.</p>
<div class="reply">
<a aria-label="Reply to dsliver33" class="comment-reply-link" href="#comment-416085" onclick='return addComment.moveForm( "comment-416085", "416085", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-416100">
<div class="comment-container" id="li-comment-416100">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 9, 2017 at 4:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416100" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What did you change exactly? Can you highlight the change for me?</p>
<p>Also, try using pre tags.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-416100" onclick='return addComment.moveForm( "comment-416100", "416100", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-416157">
<div class="comment-container" id="li-comment-416157">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a17ed90fdc8633fa31b3787ed44a65d8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a17ed90fdc8633fa31b3787ed44a65d8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">dsliver33</span>
<span class="date">October 10, 2017 at 4:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416157" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>(I don’t know how to highlight the change, sorry!)</p>
<p>I got the hidden layer (network[0]), and I applied your algorithm (calculate activation, transfer the activation to the output, append that to a new list called “new_inputs”). </p>
<p>After that, I get the output layer (network[-1]), I calculate the activation with the “new_inputs”, but I do NOT apply the sigmoid transfer function (so, the outputs should be linear). The results are appended to a new list, which is set to be the return of the function. </p>
<p>Would that be the best way to remove the sigmoid function from the output layer, making the code a regression, instead of a classification?</p>
<div class="reply">
<a aria-label="Reply to dsliver33" class="comment-reply-link" href="#comment-416157" onclick='return addComment.moveForm( "comment-416157", "416157", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-416186">
<div class="comment-container" id="li-comment-416186">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 10, 2017 at 7:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416186" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sounds good. I don’t have any good ideas, I’d recommend stepping through some calculations to help spot where it is going wrong.</p>
<p>You may want to consider moving to an open source neural net library, such as Keras:<br/>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow">https://machinelearningmastery.com/start-here/#deeplearning</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-416186" onclick='return addComment.moveForm( "comment-416186", "416186", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-417956">
<div class="comment-container" id="li-comment-417956">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3a9e36841e2b4afcd9389ccb5e46c1df?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3a9e36841e2b4afcd9389ccb5e46c1df?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Liam McGoldrick</span>
<span class="date">October 26, 2017 at 5:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-417956" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am having the same issue with mine. i made alterations and they are just the same as yours. Did you find a solution?</p>
<div class="reply">
<a aria-label="Reply to Liam McGoldrick" class="comment-reply-link" href="#comment-417956" onclick='return addComment.moveForm( "comment-417956", "417956", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-417963">
<div class="comment-container" id="li-comment-417963">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3a9e36841e2b4afcd9389ccb5e46c1df?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3a9e36841e2b4afcd9389ccb5e46c1df?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Liam McGoldrick</span>
<span class="date">October 26, 2017 at 5:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-417963" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I GOT IT TO WORK!!! You have to normalize your output data. Then you can apply the transfer function to the output layer just the same! After that it will work!</p>
<div class="reply">
<a aria-label="Reply to Liam McGoldrick" class="comment-reply-link" href="#comment-417963" onclick='return addComment.moveForm( "comment-417963", "417963", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-416406">
<div class="comment-container" id="li-comment-416406">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/19ad03bc88f93977eb58a0a21c943632?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/19ad03bc88f93977eb58a0a21c943632?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chris</span>
<span class="date">October 12, 2017 at 11:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416406" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, nice posting and it really helps a lot<br/>
for j in range(len(layer)):<br/>
	neuron = layer[j]<br/>
	neuron[‘delta’] = errors[j] * transfer_derivative(neuron[‘output’])<br/>
Should the neuron[‘output’] be the output of the activation function instead of the transfer function here?</p>
<div class="reply">
<a aria-label="Reply to Chris" class="comment-reply-link" href="#comment-416406" onclick='return addComment.moveForm( "comment-416406", "416406", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-416652">
<div class="comment-container" id="li-comment-416652">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7c8460bc85f0bdaa6278488d56b20510?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7c8460bc85f0bdaa6278488d56b20510?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Asad</span>
<span class="date">October 14, 2017 at 3:24 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416652" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi jason, nice post its really helps alot.</p>
<p>please tell me how we can change the neuron in hidden layer and in output layer?<br/>
and what will be the result when we change the neuron in hidden layer and in output layer?<br/>
in this tutorial u take one hidden layer,so can we use more than one hidden layer? and how?</p>
<p>please tell me i m waiting</p>
<div class="reply">
<a aria-label="Reply to Asad" class="comment-reply-link" href="#comment-416652" onclick='return addComment.moveForm( "comment-416652", "416652", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-416721">
<div class="comment-container" id="li-comment-416721">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 15, 2017 at 5:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416721" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps you would be better served by starting with a neural network library such as Keras:<br/>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-416721" onclick='return addComment.moveForm( "comment-416721", "416721", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-416872">
<div class="comment-container" id="li-comment-416872">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a17ed90fdc8633fa31b3787ed44a65d8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a17ed90fdc8633fa31b3787ed44a65d8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">dsliver33</span>
<span class="date">October 16, 2017 at 2:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416872" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Mr. Brownlee,</p>
<p>I’m trying to adapt the code to support many hidden layers. I’ve adapted the code as below, with a new input called “n_layers”, to insert N hidden layers in the network. </p>
<p># Initialize a network with “n_layers” hidden layers<br/>
def initialize_network3(n_inputs, n_hidden, n_layers, n_outputs):<br/>
    network = list()<br/>
    for i in range(n_layers):<br/>
        hidden_layer = [{‘weights’:[random() for i in range(n_inputs + 1)]} for i in range(n_hidden)]<br/>
        network.append(hidden_layer)<br/>
    output_layer = [{‘weights’:[random() for i in range(n_hidden)]} for i in range(n_outputs)]<br/>
    network.append(output_layer)<br/>
    return network</p>
<p>When I try to run the code, it shows the error below. Do you have any idea why?</p>
<p> in backward_propagate_error(network, expected)<br/>
     78                 error = 0.0<br/>
     79                 for neuron in network[i + 1]:<br/>
—&gt; 80                     error += (neuron[‘weights’][j] * neuron[‘delta’])<br/>
     81                 errors.append(error)<br/>
     82         else:</p>
<p>IndexError: list index out of range</p>
<div class="reply">
<a aria-label="Reply to dsliver33" class="comment-reply-link" href="#comment-416872" onclick='return addComment.moveForm( "comment-416872", "416872", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-428308">
<div class="comment-container" id="li-comment-428308">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e809fd1c87b28b52bf163c33a16ce0fc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e809fd1c87b28b52bf163c33a16ce0fc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">dna_remaps</span>
<span class="date">February 3, 2018 at 10:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-428308" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This took me a minute to figure out myself.</p>
<p>You need to add a conditional after your first layer to make sure your subsequent hidden layer weights have the proper dimensions (n_hidden+1, n_hidden)</p>
<p>for i in range(n_layers):<br/>
hidden_layer = [{‘weights’:[random() for i in range(n_inputs + 1)]} for i in range(n_hidden)]<br/>
if i &gt; 0:<br/>
hidden_layer = [[{‘weights’:[random() for i in range(n_hidden + 1)]} for i in range(n_hidden)]<br/>
network.append(hidden_layer)</p>
<div class="reply">
<a aria-label="Reply to dna_remaps" class="comment-reply-link" href="#comment-428308" onclick='return addComment.moveForm( "comment-428308", "428308", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-416944">
<div class="comment-container" id="li-comment-416944">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7218da6c248a3829926f473bf0c9905c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7218da6c248a3829926f473bf0c9905c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Arijit Mukherjee</span>
<span class="date">October 17, 2017 at 1:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-416944" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, </p>
<p>In the output/last layer when we are calculating the backprop error why are we multiplying  with the transfer derivative with the (expected-output)?? transfer derivative is already canceled out for the the last layer , the update should be only (expected-output)*previous_layer_input , ???<br/>
Thanks</p>
<div class="reply">
<a aria-label="Reply to Arijit Mukherjee" class="comment-reply-link" href="#comment-416944" onclick='return addComment.moveForm( "comment-416944", "416944", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-417112">
<div class="comment-container" id="li-comment-417112">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b451c3e1b17fc81e5bf84cc05b98ffb0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b451c3e1b17fc81e5bf84cc05b98ffb0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tanoh Henry</span>
<span class="date">October 18, 2017 at 8:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-417112" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Really good article. Thanks a lot.<br/>
Need a little bit of clarification.<br/>
For backward propagation starting at the output layer,<br/>
you get the error by appending to errors expected[j] – neuron[‘output’].<br/>
Isn’t  Error = 0.5 * sum(errors)?<br/>
and then using this sum of errors for back-propagation?<br/>
Thanks.</p>
<div class="reply">
<a aria-label="Reply to Tanoh Henry" class="comment-reply-link" href="#comment-417112" onclick='return addComment.moveForm( "comment-417112", "417112", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-417341">
<div class="comment-container" id="li-comment-417341">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3a9e36841e2b4afcd9389ccb5e46c1df?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3a9e36841e2b4afcd9389ccb5e46c1df?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Liam</span>
<span class="date">October 21, 2017 at 5:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-417341" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the tutorial! I am trying to modify your code to do a regression  model and I am stuck. I have an input data set (4 columns and many rows) and a single variable output data set (in range of tens of thousands). I fed them into the train procedure and I get an error when it reaches “expected = [0 for i in range(n_outputs)]” in the train portion. The error reads “only length-1 arrays can be converted to Python scalar”. Now I understand this is because of the intended purpose for the code was a categorization problem but I am wondering what I would need to modify to get this to work? Any help would go a long way as I have been stuck on this issue for some time now.</p>
<p>Thanks, and again wonderful tutorial!</p>
<div class="reply">
<a aria-label="Reply to Liam" class="comment-reply-link" href="#comment-417341" onclick='return addComment.moveForm( "comment-417341", "417341", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-417348">
<div class="comment-container" id="li-comment-417348">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 21, 2017 at 5:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-417348" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps start with Keras, it will be much easier for you:<br/>
<a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" rel="nofollow">https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-417348" onclick='return addComment.moveForm( "comment-417348", "417348", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-418032">
<div class="comment-container" id="li-comment-418032">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/33f8d2acc9ddf62eb3c18d23d372b459?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/33f8d2acc9ddf62eb3c18d23d372b459?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sam</span>
<span class="date">October 26, 2017 at 11:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-418032" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi<br/>
I am implementing a 2 layer neural network with 100 hidden units in the first layer and 50<br/>
in the next using your code. Implement sigmoid activation function in each layer. Train/test your<br/>
model on the MNIST dataset subset.<br/>
But it is always giving same prediction.<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=0, Got=1<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=1, Got=1<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=1, Got=1<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=1, Got=1<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=1, Got=1<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=0, Got=1<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=0, Got=1<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=1, Got=1<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=0, Got=1<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=0, Got=1<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=0, Got=1<br/>
[0.99999999986772, 0.99999999994584]<br/>
Expected=0, Got=1</p>
<div class="reply">
<a aria-label="Reply to Sam" class="comment-reply-link" href="#comment-418032" onclick='return addComment.moveForm( "comment-418032", "418032", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418053">
<div class="comment-container" id="li-comment-418053">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 27, 2017 at 5:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-418053" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend using a framework like Keras:<br/>
<a href="https://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/" rel="nofollow">https://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-418053" onclick='return addComment.moveForm( "comment-418053", "418053", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-435029">
<div class="comment-container" id="li-comment-435029">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5ae8bc3b70b383b5d06c0caa0b7b7f5f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5ae8bc3b70b383b5d06c0caa0b7b7f5f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Matthias</span>
<span class="date">April 15, 2018 at 2:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435029" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Weights should be initialized with normally distributed random values. Try using random.gauss for weight initialization.</p>
<div class="reply">
<a aria-label="Reply to Matthias" class="comment-reply-link" href="#comment-435029" onclick='return addComment.moveForm( "comment-435029", "435029", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-418240">
<div class="comment-container" id="li-comment-418240">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f8452cbd8c2a63adc828d8146220a2b0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f8452cbd8c2a63adc828d8146220a2b0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">John</span>
<span class="date">October 28, 2017 at 6:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-418240" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>help, I dont know why i got this error.</p>
<p>Traceback (most recent call last):<br/>
  File “a.py”, line 185, in<br/>
    for i in range(len(dataset[0])-1):<br/>
TypeError: ‘NoneType’ object has no attribute ‘__getitem__’</p>
<div class="reply">
<a aria-label="Reply to John" class="comment-reply-link" href="#comment-418240" onclick='return addComment.moveForm( "comment-418240", "418240", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-418288">
<div class="comment-container" id="li-comment-418288">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 29, 2017 at 5:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-418288" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You cannot have the “-1” within the call to len()</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-418288" onclick='return addComment.moveForm( "comment-418288", "418288", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-419811">
<div class="comment-container" id="li-comment-419811">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a192ed79ebd87633f7b3f4b422175e4d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a192ed79ebd87633f7b3f4b422175e4d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">João Costa</span>
<span class="date">November 12, 2017 at 12:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-419811" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason, thanks for your post!</p>
<p>This is helping me a lot with a college work. But in this NN, how can I set manually not the number of input neuros, the input values? </p>
<p>For example, if I have 1 input neuro, I wan’t to set this value to 0.485.</p>
<p>Best regards!</p>
<div class="reply">
<a aria-label="Reply to João Costa" class="comment-reply-link" href="#comment-419811" onclick='return addComment.moveForm( "comment-419811", "419811", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-419867">
<div class="comment-container" id="li-comment-419867">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 13, 2017 at 10:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-419867" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t follow.</p>
<p>Perhaps you’d be better off using a library like Keras:<br/>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-419867" onclick='return addComment.moveForm( "comment-419867", "419867", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-420277">
<div class="comment-container" id="li-comment-420277">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2de5bbda17e93bc53aa17350c13f6837?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2de5bbda17e93bc53aa17350c13f6837?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">yesta</span>
<span class="date">November 17, 2017 at 8:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-420277" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason<br/>
Thank you for this amazing tutorial!</p>
<p>I have a question that may be out of the topic. How do you call models or type of DL models where you feed a model with new test data in order to make the model adaptive to the environment?</p>
<p>Thank you.</p>
<div class="reply">
<a aria-label="Reply to yesta" class="comment-reply-link" href="#comment-420277" onclick='return addComment.moveForm( "comment-420277", "420277", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-420299">
<div class="comment-container" id="li-comment-420299">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 17, 2017 at 9:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-420299" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, you can update a model after it has been trained.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-420299" onclick='return addComment.moveForm( "comment-420299", "420299", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-422285">
<div class="comment-container" id="li-comment-422285">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b7d93b68858e06c3ddd8e40665260f03?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b7d93b68858e06c3ddd8e40665260f03?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nil</span>
<span class="date">December 6, 2017 at 7:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422285" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Dr. Jason,</p>
<p>I have been studying how to develop a neural network from scratch and this tutorial is the main one I have been following because it is helping me so much.<br/>
I have a doubt: When I study the theory I see the neural network scheme carrying only the weights and bias. And here in practice I see that the network is also carrying the output values and the delta i.e (weights, bias, output and delta). Will the final model be saved like this? with the latter (weights, bias, output and delta)? would this be the rule in practice?</p>
<p>I would appreciate it if you could help with this issue so that I could get out of where I left off.</p>
<p>Your posts are really very good there is where I find my way in to learning in Machine Learning.</p>
<p>Best Regards</p>
<div class="reply">
<a aria-label="Reply to Nil" class="comment-reply-link" href="#comment-422285" onclick='return addComment.moveForm( "comment-422285", "422285", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-422347">
<div class="comment-container" id="li-comment-422347">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 7, 2017 at 7:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422347" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The final model (e.g. trained) only needs to perform the forward pass.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-422347" onclick='return addComment.moveForm( "comment-422347", "422347", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-422467">
<div class="comment-container" id="li-comment-422467">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b7d93b68858e06c3ddd8e40665260f03?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b7d93b68858e06c3ddd8e40665260f03?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nil</span>
<span class="date">December 8, 2017 at 5:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422467" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Understood.<br/>
Thank you Dr. Jason</p>
<div class="reply">
<a aria-label="Reply to Nil" class="comment-reply-link" href="#comment-422467" onclick='return addComment.moveForm( "comment-422467", "422467", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-422514">
<div class="comment-container" id="li-comment-422514">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/774946826d1ae794b3e0ceaf4e03f0bb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/774946826d1ae794b3e0ceaf4e03f0bb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">MohamedElshazly</span>
<span class="date">December 8, 2017 at 9:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422514" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi , there’s something i don’t understand  : </p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca80608f34364710730" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
for i in reversed(range(len(network))):
		layer = network[i]
		errors = list()
		if i != len(network)-1:
			for j in range(len(layer)):
				error = 0.0
				for neuron in network[i + 1]:</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca80608f34364710730-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca80608f34364710730-2">2</div><div class="crayon-num" data-line="crayon-5c0ca80608f34364710730-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca80608f34364710730-4">4</div><div class="crayon-num" data-line="crayon-5c0ca80608f34364710730-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca80608f34364710730-6">6</div><div class="crayon-num" data-line="crayon-5c0ca80608f34364710730-7">7</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca80608f34364710730-1"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca80608f34364710730-2"><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca80608f34364710730-3"><span class="crayon-h"> </span><span class="crayon-v">errors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca80608f34364710730-4"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca80608f34364710730-5"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca80608f34364710730-6"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line" id="crayon-5c0ca80608f34364710730-7"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0007 seconds] -->
<p></p>
<p>wouldn’t the last line be out of range because  the current ‘ i ‘ is the last one and i can’t go beyond it by 1  ?  thanks in advance</p>
<div class="reply">
<a aria-label="Reply to MohamedElshazly" class="comment-reply-link" href="#comment-422514" onclick='return addComment.moveForm( "comment-422514", "422514", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-422538">
<div class="comment-container" id="li-comment-422538">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 9, 2017 at 5:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422538" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, because of the “if” check on the 4th line down.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-422538" onclick='return addComment.moveForm( "comment-422538", "422538", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-422524">
<div class="comment-container" id="li-comment-422524">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/48a04ab0dabb1c812bbaa5d89d889f2d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/48a04ab0dabb1c812bbaa5d89d889f2d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Olu</span>
<span class="date">December 9, 2017 at 3:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422524" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Mr Brownlee,</p>
<p>Thank you for your tutorial. The training for the example worked however when I try to implement the code for the Wheat Seeds Dataset I get an error from my line 210:</p>
<p>for i in range(len(dataset[0]) – 1):<br/>
    str_column_to_float(dataset, i)</p>
<p>The error is: IndexError: list index out of range</p>
<p>Can you please explain why it is (dataset[0])? Does (dataset[0]) means the 1st column in the dataset?</p>
<div class="reply">
<a aria-label="Reply to Olu" class="comment-reply-link" href="#comment-422524" onclick='return addComment.moveForm( "comment-422524", "422524", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-422544">
<div class="comment-container" id="li-comment-422544">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 9, 2017 at 5:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422544" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, I recommend learning more about Python arrays here:<br/>
<a href="https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/" rel="nofollow">https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/</a></p>
<p>The example was written for Python 2.7, confirm your Python version.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-422544" onclick='return addComment.moveForm( "comment-422544", "422544", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-422862">
<div class="comment-container" id="li-comment-422862">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8a063be39857787086c58ac99ea0e076?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8a063be39857787086c58ac99ea0e076?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://optimistic.ninja" rel="external nofollow">Jonesy</a></span>
<span class="date">December 12, 2017 at 3:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422862" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>Fantastic stuff here. I had a question about the network configuration. This 2 input, 2 hidden and 2 output seems a bit odd to me. I’m used to seeing 2, 2, 1 for XOR – can you explain why you have two output nodes and how they work with the max function? I think it would better explain this line for me in train():</p>
<p>expected[row[-1]] = 1</p>
<p>And lastly, why would one choose this configuration over a 2, 2, 1.</p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Jonesy" class="comment-reply-link" href="#comment-422862" onclick='return addComment.moveForm( "comment-422862", "422862", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-422877">
<div class="comment-container" id="li-comment-422877">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 12, 2017 at 4:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-422877" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The final model has the shape [7, 5, 3]. Perhaps check the tutorial again? It has 3 outputs, one for each of the 3 classes in the dataset.</p>
<p>Configuration was chosen via trial and error. There is no analytical way to choose a configuration for a neural network.</p>
<p>Finally, you can learn more about array indexing in Python here:<br/>
<a href="https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/" rel="nofollow">https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-422877" onclick='return addComment.moveForm( "comment-422877", "422877", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-423629">
<div class="comment-container" id="li-comment-423629">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/774946826d1ae794b3e0ceaf4e03f0bb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/774946826d1ae794b3e0ceaf4e03f0bb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mohamed Elshazly</span>
<span class="date">December 17, 2017 at 9:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-423629" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason  </p>
<p>In the tain_network function  the line “expected[row[-1]] = 1”  what i understand is that you take the Y value of every row (which is either 0 or 1 ) and use it as an index in the expected array and you change the value at that index to 1   ,First i don’t know if i understand that correctly in the first place or not  but if so, Wouldn’t the modification to the expected array be locked down to just only the first and second index because “expected[row[-1]] = 1” would only be expected[0] or expected[1] ? and how would that help in our algorithm . </p>
<p>looking forward to your response   and thanks for the Great Tutorial</p>
<div class="reply">
<a aria-label="Reply to Mohamed Elshazly" class="comment-reply-link" href="#comment-423629" onclick='return addComment.moveForm( "comment-423629", "423629", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-423671">
<div class="comment-container" id="li-comment-423671">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 18, 2017 at 5:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-423671" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>We are one hot encoding the variable.</p>
<p>Learn more about it here:<br/>
<a href="https://machinelearningmastery.com/why-one-hot-encode-data-in-machine-learning/" rel="nofollow">https://machinelearningmastery.com/why-one-hot-encode-data-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-423671" onclick='return addComment.moveForm( "comment-423671", "423671", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-423734">
<div class="comment-container" id="li-comment-423734">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/774946826d1ae794b3e0ceaf4e03f0bb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/774946826d1ae794b3e0ceaf4e03f0bb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">MohamedElshazly</span>
<span class="date">December 18, 2017 at 4:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-423734" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>HI again Jason </p>
<p>  If I’m implementing this algorithm in python 3 what should i change in expected[row[-1]]=1  in order for it to work because I’m having this error : list assignment index out of range<br/>
thanks in advance</p>
<div class="reply">
<a aria-label="Reply to MohamedElshazly" class="comment-reply-link" href="#comment-423734" onclick='return addComment.moveForm( "comment-423734", "423734", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-423779">
<div class="comment-container" id="li-comment-423779">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 19, 2017 at 5:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-423779" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t know off the cuff, I will look into porting the example to Py3 in the new year.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-423779" onclick='return addComment.moveForm( "comment-423779", "423779", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-423941">
<div class="comment-container" id="li-comment-423941">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/aa6eacd3b9c219f3f48252f7a13e8d47?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/aa6eacd3b9c219f3f48252f7a13e8d47?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.tusharahuja.in" rel="external nofollow">Tushar</a></span>
<span class="date">December 19, 2017 at 5:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-423941" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You are just awesome Jason. You are adding more value to people’s ML skills than most average graduate schools do in the US.</p>
<p>Thanks a ton!</p>
<div class="reply">
<a aria-label="Reply to Tushar" class="comment-reply-link" href="#comment-423941" onclick='return addComment.moveForm( "comment-423941", "423941", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-424039">
<div class="comment-container" id="li-comment-424039">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 20, 2017 at 5:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-424039" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Tushar.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-424039" onclick='return addComment.moveForm( "comment-424039", "424039", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-425739">
<div class="comment-container" id="li-comment-425739">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e2571da49a2941dc5744d8a97012e700?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e2571da49a2941dc5744d8a97012e700?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://n.a" rel="external nofollow">mark</a></span>
<span class="date">January 6, 2018 at 3:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-425739" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Wow, thanks for your codes. I have a question, what if I want to add regularisation term like L2 during back propagation, what should i do?</p>
<div class="reply">
<a aria-label="Reply to mark" class="comment-reply-link" href="#comment-425739" onclick='return addComment.moveForm( "comment-425739", "425739", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-425753">
<div class="comment-container" id="li-comment-425753">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 6, 2018 at 5:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-425753" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend moving to a platform like Keras:<br/>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow">https://machinelearningmastery.com/start-here/#deeplearning</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425753" onclick='return addComment.moveForm( "comment-425753", "425753", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-425829">
<div class="comment-container" id="li-comment-425829">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e2571da49a2941dc5744d8a97012e700?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e2571da49a2941dc5744d8a97012e700?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">mark</span>
<span class="date">January 7, 2018 at 5:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-425829" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for replying. I know the keras and have been using keras for a while. But in the problem I am focusing on, I need to make changes on the back propagation. That’s why I didn’t use keras.<br/>
So let’s go back to my original question, is the error term the cost function? Thanks.</p>
<div class="reply">
<a aria-label="Reply to mark" class="comment-reply-link" href="#comment-425829" onclick='return addComment.moveForm( "comment-425829", "425829", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-425849">
<div class="comment-container" id="li-comment-425849">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 8, 2018 at 5:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-425849" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I cannot work-through adding regularization to this tutorial for you.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425849" onclick='return addComment.moveForm( "comment-425849", "425849", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-427014">
<div class="comment-container" id="li-comment-427014">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9c7233c5e89a1b54b71d5d7c1dfbb874?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9c7233c5e89a1b54b71d5d7c1dfbb874?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mojo</span>
<span class="date">January 20, 2018 at 7:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-427014" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jeson,<br/>
Thanks for the informative tutorial. I have a question.<br/>
if i want to change the error equation and as well as the equation between input with hidden and hidden with output layer. How can i change it?<br/>
Hope you will reply in a short time.</p>
<p>Regards,<br/>
Mojo</p>
<div class="reply">
<a aria-label="Reply to Mojo" class="comment-reply-link" href="#comment-427014" onclick='return addComment.moveForm( "comment-427014", "427014", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-427048">
<div class="comment-container" id="li-comment-427048">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 21, 2018 at 9:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-427048" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend using a library instead, it will be much easier for you.</p>
<p>Here’s how to get started with Keras:<br/>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow">https://machinelearningmastery.com/start-here/#deeplearning</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-427048" onclick='return addComment.moveForm( "comment-427048", "427048", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-429705">
<div class="comment-container" id="li-comment-429705">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/735373561f6c85beb7025792afd12d08?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/735373561f6c85beb7025792afd12d08?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aliya Anil</span>
<span class="date">February 16, 2018 at 9:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-429705" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>It was indeed a very informative tutorial. Could you please explain the need for seed(1) in the code?</p>
<div class="reply">
<a aria-label="Reply to Aliya Anil" class="comment-reply-link" href="#comment-429705" onclick='return addComment.moveForm( "comment-429705", "429705", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-429751">
<div class="comment-container" id="li-comment-429751">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 17, 2018 at 8:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-429751" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am trying to tie down the random number generator so that you get the same results as me.</p>
<p>Learn more here:<br/>
<a href="https://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">https://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-429751" onclick='return addComment.moveForm( "comment-429751", "429751", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-429886">
<div class="comment-container" id="li-comment-429886">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/05e9480f976efcbc71cff41646c0a515?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/05e9480f976efcbc71cff41646c0a515?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Raj</span>
<span class="date">February 19, 2018 at 7:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-429886" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey there,<br/>
Been following your tutorial and I’m having problems with using my dataset with it. The outputs of the hidden neurons appear to only be exactly 1 constantly. I’m not sure what’s wrong exactly or how to fix it but its resulting in the network not learning at all. Please let me know if you can help.<br/>
Thanks,<br/>
Raj</p>
<div class="reply">
<a aria-label="Reply to Raj" class="comment-reply-link" href="#comment-429886" onclick='return addComment.moveForm( "comment-429886", "429886", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-429909">
<div class="comment-container" id="li-comment-429909">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 19, 2018 at 9:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-429909" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps try to get the code and data in the tutorial working first and use that as a starting point for your own problem.</p>
<p>Generally, I would recommend using a library like Keras for your own projects and only code methods from scratch as a learning exercise.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-429909" onclick='return addComment.moveForm( "comment-429909", "429909", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-430009">
<div class="comment-container" id="li-comment-430009">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/735373561f6c85beb7025792afd12d08?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/735373561f6c85beb7025792afd12d08?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aliya Anil</span>
<span class="date">February 20, 2018 at 4:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430009" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>I tried the first code in the tutorial with 4-parameter dataset, but it is not predicting like the 2-parameter set. Could you explain the reason?</p>
<p>Thanks,<br/>
Aliya</p>
<div class="reply">
<a aria-label="Reply to Aliya Anil" class="comment-reply-link" href="#comment-430009" onclick='return addComment.moveForm( "comment-430009", "430009", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-430097">
<div class="comment-container" id="li-comment-430097">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 21, 2018 at 6:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430097" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If you are looking to develop a neural network for your own data, I would recommend the Keras library:<br/>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow">https://machinelearningmastery.com/start-here/#deeplearning</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430097" onclick='return addComment.moveForm( "comment-430097", "430097", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-430881">
<div class="comment-container" id="li-comment-430881">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7504348e9916ae45e70974b27d0649fc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7504348e9916ae45e70974b27d0649fc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nik</span>
<span class="date">March 2, 2018 at 1:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430881" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,</p>
<p>Can I use the codes for handwritten digits recognition? If yes, are there any special recommendations what to change in the codes or I can use them with no changes?</p>
<p>Thanks,<br/>
Nik</p>
<div class="reply">
<a aria-label="Reply to Nik" class="comment-reply-link" href="#comment-430881" onclick='return addComment.moveForm( "comment-430881", "430881", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-430894">
<div class="comment-container" id="li-comment-430894">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 2, 2018 at 3:25 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430894" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend this tutorial:<br/>
<a href="https://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/" rel="nofollow">https://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430894" onclick='return addComment.moveForm( "comment-430894", "430894", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-430908">
<div class="comment-container" id="li-comment-430908">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7504348e9916ae45e70974b27d0649fc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7504348e9916ae45e70974b27d0649fc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nik</span>
<span class="date">March 2, 2018 at 7:51 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430908" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, I have seen that tutorial. But is there any way to use the codes from this tutorial? I just would like to understand why they work so well for seeds and do not work for handwritten digits…</p>
<div class="reply">
<a aria-label="Reply to Nik" class="comment-reply-link" href="#comment-430908" onclick='return addComment.moveForm( "comment-430908", "430908", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-430959">
<div class="comment-container" id="li-comment-430959">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 3, 2018 at 8:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-430959" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, you can. You can develop a model with all pixels as inputs.</p>
<p>I cannot write the modification for you, sorry, I just don’t have the capacity.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430959" onclick='return addComment.moveForm( "comment-430959", "430959", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-431046">
<div class="comment-container" id="li-comment-431046">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bcb6fe38adcb6de87380acd8ee463024?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bcb6fe38adcb6de87380acd8ee463024?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Filoingko</span>
<span class="date">March 4, 2018 at 2:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431046" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, </p>
<p>How can I use this trained network to predict another data set. </p>
<p>Thank you.</p>
<div class="reply">
<a aria-label="Reply to Filoingko" class="comment-reply-link" href="#comment-431046" onclick='return addComment.moveForm( "comment-431046", "431046", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-431076">
<div class="comment-container" id="li-comment-431076">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 4, 2018 at 6:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431076" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The code in this tutorial is to teach you about backprop, not for use on real problems. If you are working through a problem, I’d recommend using Keras.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-431076" onclick='return addComment.moveForm( "comment-431076", "431076", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-431224">
<div class="comment-container" id="li-comment-431224">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f95f9040f79b6ca828fc515c45d81f58?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f95f9040f79b6ca828fc515c45d81f58?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.info.univ-angers.fr/~richer/" rel="external nofollow">Jean-Michel Richer</a></span>
<span class="date">March 5, 2018 at 9:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431224" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,<br/>
  I have tried to use your code on a simple XOR example but get a result of [0, 0, 1, 1] instead of [0,1,1,0]<br/>
Scores: [0.0]<br/>
Mean Accuracy: 0.000%</p>
<p>The input xor.csv file is<br/>
0,0,0<br/>
0,1,1<br/>
1,0,1<br/>
1,1,0</p>
<p>For this I have modified the evaluate_algorithm function to:<br/>
def evaluate_algorithm_no_fold(dataset, algorithm, *args):<br/>
	scores = list()<br/>
	predicted = algorithm(dataset, dataset, *args)<br/>
	print(predicted)<br/>
	accuracy = accuracy_metric(dataset, predicted)<br/>
	scores.append(accuracy)<br/>
	return scores</p>
<p>and call the function like this:<br/>
scores = evaluate_algorithm_no_fold(dataset, back_propagation, 0.1, 500, 4)</p>
<p>Would you have some explanation because I can not figure out why it is not working ?<br/>
Best regards,<br/>
JM</p>
<div class="reply">
<a aria-label="Reply to Jean-Michel Richer" class="comment-reply-link" href="#comment-431224" onclick='return addComment.moveForm( "comment-431224", "431224", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-431276">
<div class="comment-container" id="li-comment-431276">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 6, 2018 at 6:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431276" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps the model requires tuning to your new dataset.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-431276" onclick='return addComment.moveForm( "comment-431276", "431276", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-431225">
<div class="comment-container" id="li-comment-431225">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8214979f8112bba72d66508128d32af6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8214979f8112bba72d66508128d32af6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tanveer</span>
<span class="date">March 5, 2018 at 9:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431225" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank You So Much Jason !! Wonderful Tutorial. THANKS Much !!</p>
<div class="reply">
<a aria-label="Reply to Tanveer" class="comment-reply-link" href="#comment-431225" onclick='return addComment.moveForm( "comment-431225", "431225", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-431277">
<div class="comment-container" id="li-comment-431277">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 6, 2018 at 6:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431277" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-431277" onclick='return addComment.moveForm( "comment-431277", "431277", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-431697">
<div class="comment-container" id="li-comment-431697">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9c7233c5e89a1b54b71d5d7c1dfbb874?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9c7233c5e89a1b54b71d5d7c1dfbb874?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mojo</span>
<span class="date">March 9, 2018 at 10:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431697" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If i want to calculate the training accuracy and F-measure and want to change the activation function, how i can do it?</p>
<div class="reply">
<a aria-label="Reply to Mojo" class="comment-reply-link" href="#comment-431697" onclick='return addComment.moveForm( "comment-431697", "431697", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-431742">
<div class="comment-container" id="li-comment-431742">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 10, 2018 at 6:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431742" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps you would be better off using scikit-learn and Keras instead.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-431742" onclick='return addComment.moveForm( "comment-431742", "431742", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-431941">
<div class="comment-container" id="li-comment-431941">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/22ba6318aedec7368b6fb6c0a3f84d5e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/22ba6318aedec7368b6fb6c0a3f84d5e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Fahad</span>
<span class="date">March 12, 2018 at 8:03 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431941" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Is there something wrong with this code in case of using MINIST data? I tried to change the structured of the data to be compatible with the code, but it gave me a huge error and the error did not decrees during all training steps</p>
<div class="reply">
<a aria-label="Reply to Fahad" class="comment-reply-link" href="#comment-431941" onclick='return addComment.moveForm( "comment-431941", "431941", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-431970">
<div class="comment-container" id="li-comment-431970">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 13, 2018 at 6:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-431970" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The code was not developed for MNIST. Here is an example of working with MNIST:<br/>
<a href="http://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/" rel="nofollow">http://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-431970" onclick='return addComment.moveForm( "comment-431970", "431970", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-432017">
<div class="comment-container" id="li-comment-432017">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/22ba6318aedec7368b6fb6c0a3f84d5e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/22ba6318aedec7368b6fb6c0a3f84d5e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Fahad</span>
<span class="date">March 13, 2018 at 4:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432017" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason for your response. I want to apply the code without keras. I tried to change the structure of the data to be each row as a vector of 784 pixel followed by a class label, but as I said it gave a huge error and does not decrees at all. </p>
<p>I am trying to develop some algorithm for enhancing of learning, hence, I need to deal with the procedure as step by step. So keras or any other library does not help.</p>
<p>Thanks again Jason</p>
<div class="reply">
<a aria-label="Reply to Fahad" class="comment-reply-link" href="#comment-432017" onclick='return addComment.moveForm( "comment-432017", "432017", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-432092">
<div class="comment-container" id="li-comment-432092">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 14, 2018 at 6:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432092" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps update the code to use numpy, it will be much faster.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-432092" onclick='return addComment.moveForm( "comment-432092", "432092", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-432155">
<div class="comment-container" id="li-comment-432155">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0ae4b21a9cd4b9e4654236d18cf8df39?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0ae4b21a9cd4b9e4654236d18cf8df39?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">kelvin</span>
<span class="date">March 15, 2018 at 2:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432155" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Mr Brownlee,</p>
<p>Can you teach me how to plot the errors per epochs (validation error) and accuracy for both training and validation in your scratch network?</p>
<div class="reply">
<a aria-label="Reply to kelvin" class="comment-reply-link" href="#comment-432155" onclick='return addComment.moveForm( "comment-432155", "432155", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-432157">
<div class="comment-container" id="li-comment-432157">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0ae4b21a9cd4b9e4654236d18cf8df39?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0ae4b21a9cd4b9e4654236d18cf8df39?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">kelvin</span>
<span class="date">March 15, 2018 at 2:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432157" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I only can find the training error but not validation error in the code. For the accuracy, I plot a graph have a straight line only.</p>
<div class="reply">
<a aria-label="Reply to kelvin" class="comment-reply-link" href="#comment-432157" onclick='return addComment.moveForm( "comment-432157", "432157", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-432177">
<div class="comment-container" id="li-comment-432177">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 15, 2018 at 6:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432177" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, you can do it easily in Keras here:<br/>
<a href="https://machinelearningmastery.com/display-deep-learning-model-training-history-in-keras/" rel="nofollow">https://machinelearningmastery.com/display-deep-learning-model-training-history-in-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-432177" onclick='return addComment.moveForm( "comment-432177", "432177", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-432204">
<div class="comment-container" id="li-comment-432204">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0ae4b21a9cd4b9e4654236d18cf8df39?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0ae4b21a9cd4b9e4654236d18cf8df39?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">kelvin</span>
<span class="date">March 15, 2018 at 12:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432204" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Is there any possible way to do it on your scratch network? for example which part of the code save the training error, validation error, training accuracy and validation accuracy? So I can plot the graph myself since your scratch model does not have “model” for me to save the history.</p>
<div class="reply">
<a aria-label="Reply to kelvin" class="comment-reply-link" href="#comment-432204" onclick='return addComment.moveForm( "comment-432204", "432204", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-432223">
<div class="comment-container" id="li-comment-432223">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 15, 2018 at 2:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432223" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, perhaps change it from CV to a single/train test, then evaluate the model skill on each dataset at the end of each epoch. Save the results in a list and return the lists.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-432223" onclick='return addComment.moveForm( "comment-432223", "432223", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-432202">
<div class="comment-container" id="li-comment-432202">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/44ddc273bbba48e477fc8e9e2a82f73a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/44ddc273bbba48e477fc8e9e2a82f73a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jack</span>
<span class="date">March 15, 2018 at 12:11 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432202" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can I use this model for regression problem? For example us this model for boston house-prices dataset?</p>
<div class="reply">
<a aria-label="Reply to Jack" class="comment-reply-link" href="#comment-432202" onclick='return addComment.moveForm( "comment-432202", "432202", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-432222">
<div class="comment-container" id="li-comment-432222">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 15, 2018 at 2:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432222" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure, some changes would be required, such as the activation in the output layer would need to be linear.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-432222" onclick='return addComment.moveForm( "comment-432222", "432222", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-432230">
<div class="comment-container" id="li-comment-432230">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/755e6112e94ffdd57a7c60bd3a487f13?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/755e6112e94ffdd57a7c60bd3a487f13?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nabil</span>
<span class="date">March 15, 2018 at 3:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432230" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Are you using MSE?</p>
<div class="reply">
<a aria-label="Reply to Nabil" class="comment-reply-link" href="#comment-432230" onclick='return addComment.moveForm( "comment-432230", "432230", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-432288">
<div class="comment-container" id="li-comment-432288">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 16, 2018 at 6:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432288" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>As mentioned in the post, we are reporting accuracy for the classification problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-432288" onclick='return addComment.moveForm( "comment-432288", "432288", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-432619">
<div class="comment-container" id="li-comment-432619">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/48a04ab0dabb1c812bbaa5d89d889f2d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/48a04ab0dabb1c812bbaa5d89d889f2d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Olu</span>
<span class="date">March 19, 2018 at 11:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432619" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In the train section,</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca806088ad287493152" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
def train_network(network, train, l_rate, n_epoch, n_outputs):
    for epoch in range(n_epoch):
        for row in train:
            outputs = forward_propagate(network, row)
            expected = [0 for i in range(n_outputs)]
            expected[row[-1]] = 1
            backward_propagate_error(network, expected)
            update_weights(network, row, l_rate)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca806088ad287493152-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806088ad287493152-2">2</div><div class="crayon-num" data-line="crayon-5c0ca806088ad287493152-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806088ad287493152-4">4</div><div class="crayon-num" data-line="crayon-5c0ca806088ad287493152-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806088ad287493152-6">6</div><div class="crayon-num" data-line="crayon-5c0ca806088ad287493152-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca806088ad287493152-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca806088ad287493152-1"><span class="crayon-e">def </span><span class="crayon-e">train_network</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_epoch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806088ad287493152-2"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">epoch </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_epoch</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca806088ad287493152-3"><span class="crayon-h">        </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806088ad287493152-4"><span class="crayon-h">            </span><span class="crayon-v">outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca806088ad287493152-5"><span class="crayon-h">            </span><span class="crayon-v">expected</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806088ad287493152-6"><span class="crayon-h">            </span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5c0ca806088ad287493152-7"><span class="crayon-h">            </span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca806088ad287493152-8"><span class="crayon-h">            </span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0008 seconds] -->
<p></p>
<p>Can you please explain how this expected[row[-1]] = 1 knows where to insert the 1 in the arrays of zero created.</p>
<div class="reply">
<a aria-label="Reply to Olu" class="comment-reply-link" href="#comment-432619" onclick='return addComment.moveForm( "comment-432619", "432619", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-432666">
<div class="comment-container" id="li-comment-432666">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 20, 2018 at 6:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432666" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good question.</p>
<p>expected is all zeros. row[-1] is the index of the class value. therefore we set the index of the class value in expected to 1.</p>
<p>Perhaps it is worth reading up on array indexing:<br/>
<a href="https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/" rel="nofollow">https://machinelearningmastery.com/index-slice-reshape-numpy-arrays-machine-learning-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-432666" onclick='return addComment.moveForm( "comment-432666", "432666", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-454958">
<div class="comment-container" id="li-comment-454958">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2f4916070de31c492fb264d8910c4cb3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2f4916070de31c492fb264d8910c4cb3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">kmillen</span>
<span class="date">November 16, 2018 at 11:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454958" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason,<br/>
This is an amazing piece of code that has been very beneficial.</p>
<p>Doesn’t that mean that only expected[0] and expected[1] will ever be set to 1 for this test data?</p>
<p>Thank you,</p>
<div class="reply">
<a aria-label="Reply to kmillen" class="comment-reply-link" href="#comment-454958" onclick='return addComment.moveForm( "comment-454958", "454958", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-454973">
<div class="comment-container" id="li-comment-454973">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 16, 2018 at 1:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454973" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t understand your question?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-454973" onclick='return addComment.moveForm( "comment-454973", "454973", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-455042">
<div class="comment-container" id="li-comment-455042">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2f4916070de31c492fb264d8910c4cb3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2f4916070de31c492fb264d8910c4cb3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">kmillen</span>
<span class="date">November 17, 2018 at 1:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-455042" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If I understand Python (which I may not), row[-1] represents the last item in the row. Since the last value in each of the 10 rows is only either 0 or 1, expected[row[-1]] = 1 will only ever set expected[0] or expected[1] to the value of 1. Or, what am I missing?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-455079">
<div class="comment-container" id="li-comment-455079">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 17, 2018 at 5:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-455079" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Are you referring to this: expected[row[-1]] = 1</p>
<p>If so:</p>
<p>“expected” is all zeros, e.g. [0, 0]<br/>
“row” is an example, e.g. […] where the value at -1 is either 0 or 1</p>
<p>Therefore row[-1] is an index of either 0 or 1 and we are marking the value in expected at that index as 1.</p>
<p>We have created a one hot vector.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-4" id="comment-455048">
<div class="comment-container" id="li-comment-455048">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2f4916070de31c492fb264d8910c4cb3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2f4916070de31c492fb264d8910c4cb3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">kmillen</span>
<span class="date">November 17, 2018 at 2:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-455048" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Disregard my previous question; I found the answer in a previous reply. Thank you again for this example.</p>
<div class="reply">
<a aria-label="Reply to kmillen" class="comment-reply-link" href="#comment-455048" onclick='return addComment.moveForm( "comment-455048", "455048", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-432741">
<div class="comment-container" id="li-comment-432741">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0ae4b21a9cd4b9e4654236d18cf8df39?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0ae4b21a9cd4b9e4654236d18cf8df39?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">kelvin</span>
<span class="date">March 21, 2018 at 2:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432741" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, I would like to use softmax as the activation function for output layer. However, I do not know how to write the code for the derivative of softmax. Can you show me the code how to change the sigmoid function from your code to softmax?</p>
<div class="reply">
<a aria-label="Reply to kelvin" class="comment-reply-link" href="#comment-432741" onclick='return addComment.moveForm( "comment-432741", "432741", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-432742">
<div class="comment-container" id="li-comment-432742">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0ae4b21a9cd4b9e4654236d18cf8df39?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0ae4b21a9cd4b9e4654236d18cf8df39?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">kelvin</span>
<span class="date">March 21, 2018 at 2:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432742" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I do try few ways to change the sigmoid to softmax, however, all of them are not working. Can you show me how to create a softmax layer?</p>
<p>for transfer():<br/>
first case:<br/>
def transfer(input_value):<br/>
        exp_scores = np.exp(input_value)<br/>
        return exp_scores / np.sum(exp_scores, axis=1, keepdims=True)</p>
<p>second case:<br/>
def transfer(input_value):<br/>
        input_value -= np.max(input_value)<br/>
        return np.exp(input_value) / np.sum(np.exp(input_value))</p>
<p>third case:<br/>
def transfer(input_value):<br/>
        input_value -= np.max(input_value)<br/>
        result = (np.exp(input_value).T / np.sum(np.exp(input_value))).T<br/>
        return result</p>
<p>for transfer_derivative():<br/>
first case:<br/>
def transfer_derivative(output):<br/>
       s = output.reshape(-1, 1)<br/>
        return np.diagflat(s) – np.dot(s, s.T)</p>
<p>second case:<br/>
def transfer_derivative(output):<br/>
        jacobian_m = np.diag(output)<br/>
        for i in range(len(jacobian_m)):<br/>
            for j in range(len(jacobian_m)):<br/>
                if i == j:<br/>
                    jacobian_m[i][j] = output[i] * (1 – output[i])<br/>
                else:<br/>
                    jacobian_m[i][j] = -output[i] * output[j]<br/>
        return jacobian_m</p>
<div class="reply">
<a aria-label="Reply to kelvin" class="comment-reply-link" href="#comment-432742" onclick='return addComment.moveForm( "comment-432742", "432742", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-3" id="comment-432771">
<div class="comment-container" id="li-comment-432771">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 21, 2018 at 6:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432771" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Here you go:<br/>
<a href="https://en.wikipedia.org/wiki/Softmax_function#Artificial_neural_networks" rel="nofollow">https://en.wikipedia.org/wiki/Softmax_function#Artificial_neural_networks</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-432771" onclick='return addComment.moveForm( "comment-432771", "432771", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-432770">
<div class="comment-container" id="li-comment-432770">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 21, 2018 at 6:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-432770" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps use Keras instead?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-432770" onclick='return addComment.moveForm( "comment-432770", "432770", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-433545">
<div class="comment-container" id="li-comment-433545">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1f44ac7a59dd09f3eb83e639a0b5ded8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1f44ac7a59dd09f3eb83e639a0b5ded8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Suede</span>
<span class="date">March 29, 2018 at 6:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-433545" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hey Jason, this is very helpful. I have run the code but i keep on getting this error, can you please help me out? the error is:</p>
<p>NameError                                 Traceback (most recent call last)<br/>
 in ()<br/>
    186         str_column_to_float(dataset, i)<br/>
    187 # convert class column to integers<br/>
–&gt; 188 str_columnto_int(dataset, len(dataset[0])-1)<br/>
    189 # normalize input variables<br/>
    190 minmax = dataset_minmax(dataset)</p>
<p>NameError: name ‘str_columnto_int’ is not defined</p>
<div class="reply">
<a aria-label="Reply to Suede" class="comment-reply-link" href="#comment-433545" onclick='return addComment.moveForm( "comment-433545", "433545", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-433550">
<div class="comment-container" id="li-comment-433550">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 29, 2018 at 6:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-433550" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The code was written for Python 2.7, confirm that you are using this version of Python?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-433550" onclick='return addComment.moveForm( "comment-433550", "433550", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-435047">
<div class="comment-container" id="li-comment-435047">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4bb4b72187cad374aebefc17d252f5a2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4bb4b72187cad374aebefc17d252f5a2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://fahriguresci.com" rel="external nofollow">Fahri Güreşçi</a></span>
<span class="date">April 15, 2018 at 7:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435047" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The csv file is not working. Edited csv file &gt; bit.ly/2GYX2dF<br/>
you can use python 2 or 3<br/>
results:<br/>
python2 &gt; Mean Accuracy: 95.238%<br/>
python3 &gt; Mean Accuracy: 93.333%</p>
<p>Why different?</p>
<div class="reply">
<a aria-label="Reply to Fahri Güreşçi" class="comment-reply-link" href="#comment-435047" onclick='return addComment.moveForm( "comment-435047", "435047", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-435097">
<div class="comment-container" id="li-comment-435097">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 16, 2018 at 6:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435097" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Wh is the CSV file not working? The link appears to work fine.</p>
<p>Good question re the difference, no idea. Perhaps small differences in the API? The code was written for Py2, so it may require changes for py3.</p>
<p>Also, see this post on the stochastic nature of ml algorithms:<br/>
<a href="https://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">https://machinelearningmastery.com/randomness-in-machine-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435097" onclick='return addComment.moveForm( "comment-435097", "435097", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-435339">
<div class="comment-container" id="li-comment-435339">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/22ba6318aedec7368b6fb6c0a3f84d5e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/22ba6318aedec7368b6fb6c0a3f84d5e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Fahad</span>
<span class="date">April 18, 2018 at 8:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435339" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have altered the code to work with MNIST (digit numbers) , the problem I have faced that forward_propagate function returns [1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ,1 ]  for each instance !</p>
<p>Any help</p>
<div class="reply">
<a aria-label="Reply to Fahad" class="comment-reply-link" href="#comment-435339" onclick='return addComment.moveForm( "comment-435339", "435339", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-435390">
<div class="comment-container" id="li-comment-435390">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 19, 2018 at 6:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435390" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Well done.</p>
<p>The model will require tuning for the problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435390" onclick='return addComment.moveForm( "comment-435390", "435390", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-435408">
<div class="comment-container" id="li-comment-435408">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/22ba6318aedec7368b6fb6c0a3f84d5e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/22ba6318aedec7368b6fb6c0a3f84d5e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Fahad</span>
<span class="date">April 19, 2018 at 7:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435408" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Could you explain more in some details please.</p>
<div class="reply">
<a aria-label="Reply to Fahad" class="comment-reply-link" href="#comment-435408" onclick='return addComment.moveForm( "comment-435408", "435408", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-435428">
<div class="comment-container" id="li-comment-435428">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 19, 2018 at 2:45 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435428" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What details exactly?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435428" onclick='return addComment.moveForm( "comment-435428", "435428", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-435446">
<div class="comment-container" id="li-comment-435446">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/22ba6318aedec7368b6fb6c0a3f84d5e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/22ba6318aedec7368b6fb6c0a3f84d5e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Fahad</span>
<span class="date">April 19, 2018 at 8:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435446" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>As I mentioned that forward_propagation function returns [1,1,1,1,1,1,1,1,1,1], what is the possible alter to come over this problem</p>
<div class="reply">
<a aria-label="Reply to Fahad" class="comment-reply-link" href="#comment-435446" onclick='return addComment.moveForm( "comment-435446", "435446", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-435477">
<div class="comment-container" id="li-comment-435477">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 20, 2018 at 5:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435477" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps tune the model to your specific problem. I have some suggestions here:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435477" onclick='return addComment.moveForm( "comment-435477", "435477", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-435665">
<div class="comment-container" id="li-comment-435665">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/22ba6318aedec7368b6fb6c0a3f84d5e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/22ba6318aedec7368b6fb6c0a3f84d5e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Fahad</span>
<span class="date">April 23, 2018 at 5:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435665" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I altered the code to work with XOR problem and it was working perfectly. Then, I altered the code to work with digit numbers MNIST, but as I told you there was a problem with the the forward_propagation function that it returned all outputs to be [1,1,1,…] instead of a probabilities for each output.<br/>
I think it is not an optimization problem, there is something wrong with the forward_propagate function.</p>
<p>Here is the code after alteration [it is working but with a fixed error during all training epochs</p>
<p>from random import seed<br/>
from random import randrange<br/>
from random import random<br/>
from csv import reader<br/>
from math import exp<br/>
global network<br/>
global gl_errors</p>
<p># Load a CSV file<br/>
def load_csv(filename):<br/>
	dataset = list()<br/>
	with open(filename, ‘r’) as file:<br/>
		csv_reader = reader(file)<br/>
		for row in csv_reader:<br/>
			if not row:<br/>
				continue<br/>
			dataset.append(row)<br/>
	return dataset</p>
<p># Convert string column to float<br/>
def str_column_to_float(dataset, column):<br/>
	for row in dataset:<br/>
		row[column] = float(row[column].strip())</p>
<p>def str_column_to_intX(dataset, column):<br/>
	for row in dataset:<br/>
		row[column] = int(row[column].strip())</p>
<p># Convert string column to integer<br/>
def str_column_to_int(dataset, column):<br/>
	class_values = [row[column] for row in dataset]<br/>
	unique = set(class_values)<br/>
	lookup = dict()<br/>
	for i, value in enumerate(unique):<br/>
		lookup[value] = i<br/>
	for row in dataset:<br/>
		row[column] = lookup[row[column]]<br/>
	return lookup</p>
<p># Find the min and max values for each column<br/>
def dataset_minmax(dataset):<br/>
	minmax = list()<br/>
	stats = [[min(column), max(column)] for column in zip(*dataset)]<br/>
	return stats</p>
<p># Rescale dataset columns to the range 0-1<br/>
def normalize_dataset(dataset):<br/>
    for row in dataset:<br/>
        for i in range(1,len(row)):<br/>
#            row[i] = (row[i] – minmax[i][0]) / (minmax[i][1] – minmax[i][0])<br/>
            if row[i]&gt;10:<br/>
                row[i]=1<br/>
            else:<br/>
                row[i]=0</p>
<p># Split a dataset into k folds<br/>
def cross_validation_split(dataset, n_folds):<br/>
	dataset_split = list()<br/>
	dataset_copy = list(dataset)<br/>
	fold_size = int(len(dataset) / n_folds)<br/>
	for i in range(n_folds):<br/>
		fold = list()<br/>
		while len(fold) epoch=%d, lrate=%.3f, error=%.3f’ % (epoch, l_rate, sum_error))</p>
<p># Calculate neuron activation for an input<br/>
def activate(weights, inputs):</p>
<p>	activation = weights[-1]<br/>
	for i in range(len(weights)-1):<br/>
		activation += weights[i] * inputs[i]<br/>
	return activation</p>
<p># Transfer neuron activation<br/>
def transfer(activation):<br/>
	return 1.0 / (1.0 + exp(-activation))</p>
<p># Forward propagate input to a network output<br/>
def forward_propagate(network, row):<br/>
    inputs = row[1:]<br/>
    i=0</p>
<p>    for layer in network:<br/>
        new_inputs = []<br/>
        i+=1<br/>
        for neuron in layer:<br/>
            activation = activate(neuron[‘weights’], inputs)<br/>
            neuron[‘output’] = transfer(activation)<br/>
            new_inputs.append(neuron[‘output’])<br/>
        inputs = new_inputs</p>
<p>    return inputs</p>
<p># Calculate the derivative of an neuron output<br/>
def transfer_derivative(output):<br/>
	return output * (1.0 – output)</p>
<p># Backpropagate error and store in neurons<br/>
def backward_propagate_error(network, expected):<br/>
#    err =0<br/>
    for i in reversed(range(len(network))):<br/>
        layer = network[i]<br/>
        errors = list()<br/>
        if i != len(network)-1:<br/>
            for j in range(len(layer)):<br/>
                error = 0.0<br/>
                for neuron in network[i + 1]:<br/>
                    error += (neuron[‘weights’][j] * neuron[‘delta’])<br/>
                errors.append(error)<br/>
        else:<br/>
            for j in range(len(layer)):<br/>
                neuron = layer[j]<br/>
                errors.append(expected[j] – neuron[‘output’])</p>
<p>        for j in range(len(layer)):<br/>
            neuron = layer[j]<br/>
            neuron[‘delta’] = errors[j] * transfer_derivative(neuron[‘output’])</p>
<p># Update network weights with error<br/>
def update_weights(network, row, l_rate):</p>
<p>	for i in range(len(network)):<br/>
		inputs = row[1:]<br/>
		if i != 0:<br/>
			inputs = [neuron[‘output’] for neuron in network[i – 1]]<br/>
		for neuron in network[i]:<br/>
			for j in range(len(inputs)):<br/>
				neuron[‘weights’][j] += l_rate * neuron[‘delta’] * inputs[j]<br/>
			neuron[‘weights’][-1] += l_rate * neuron[‘delta’]</p>
<p># Initialize a network<br/>
def initialize_network(n_inputs, n_hidden, n_outputs):<br/>
    global network<br/>
    network = list()<br/>
    hidden_layer1 = [{‘weights’:[random() for i in range(n_inputs + 1)]} for i in range(n_hidden)]<br/>
    network.append(hidden_layer1)</p>
<p>    hidden_layer2 = [{‘weights’:[random() for i in range(n_hidden + 1)]} for i in range(100)]<br/>
    network.append(hidden_layer2)</p>
<p>    hidden_layer3 = [{‘weights’:[random() for i in range(100 + 1)]} for i in range(50)]<br/>
    network.append(hidden_layer3)</p>
<p>    output_layer = [{‘weights’:[random() for i in range(50 + 1)]} for i in range(n_outputs)]<br/>
    network.append(output_layer)<br/>
    return network</p>
<p># Make a prediction with a network<br/>
def predict(network, row):<br/>
    outputs = forward_propagate(network, row)<br/>
    return outputs.index(max(outputs)) </p>
<p># Test Backprop on Seeds dataset<br/>
seed(1)<br/>
# load and prepare data<br/>
filename = ‘dataset/train2.csv’<br/>
dataset = load_csv(filename)</p>
<p>for i in range(1,len(dataset[0])):<br/>
	str_column_to_float(dataset, i)</p>
<p># convert class column to integers<br/>
str_column_to_int(dataset, 0)</p>
<p>normalize_dataset(dataset)</p>
<p># evaluate algorithm<br/>
n_folds = 5<br/>
l_rate = 0.5<br/>
n_epoch = 100<br/>
n_hidden = 500</p>
<p>scores = evaluate_algorithm(dataset, back_propagation, n_folds, l_rate, n_epoch, n_hidden)<br/>
print(‘Scores: %s’ % scores)<br/>
print(‘Mean Accuracy: %.3f%%’ % (sum(scores)/float(len(scores))))</p>
<div class="reply">
<a aria-label="Reply to Fahad" class="comment-reply-link" href="#comment-435665" onclick='return addComment.moveForm( "comment-435665", "435665", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-435681">
<div class="comment-container" id="li-comment-435681">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 23, 2018 at 6:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435681" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have the capacity to debug the modified code for you.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435681" onclick='return addComment.moveForm( "comment-435681", "435681", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-435926">
<div class="comment-container" id="li-comment-435926">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/299f14931ecf1fd2e009e0fae8b52074?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/299f14931ecf1fd2e009e0fae8b52074?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rahmad ars</span>
<span class="date">April 26, 2018 at 3:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435926" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sir, can you help me?<br/>
this is my question..</p>
<p><a href="https://stackoverflow.com/questions/50027886/need-help-for-check-my-backprop-ann-using-python" rel="nofollow">https://stackoverflow.com/questions/50027886/need-help-for-check-my-backprop-ann-using-python</a></p>
<div class="reply">
<a aria-label="Reply to Rahmad ars" class="comment-reply-link" href="#comment-435926" onclick='return addComment.moveForm( "comment-435926", "435926", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-435970">
<div class="comment-container" id="li-comment-435970">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 26, 2018 at 6:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435970" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps you can summarize your question in a sentence or two?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435970" onclick='return addComment.moveForm( "comment-435970", "435970", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-435975">
<div class="comment-container" id="li-comment-435975">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/299f14931ecf1fd2e009e0fae8b52074?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/299f14931ecf1fd2e009e0fae8b52074?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rahmad ars</span>
<span class="date">April 26, 2018 at 7:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435975" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>your original code sir, only have 1 hidden layer with 2 neurons. then, I modify it, so the ANN have 3 hidden layers, each consist of (128, 64, 32). and i have my own dataset, so i change it (the dataset and input neurons). when i run this code, everything looks fine but the error value is not changing…</p>
<p>here’s the screen: <a href="https://i.stack.imgur.com/NQbNd.png" rel="nofollow">https://i.stack.imgur.com/NQbNd.png</a></p>
<p>modified code: <a href="https://stackoverflow.com/questions/50027886/need-help-for-check-my-backprop-ann-using-python" rel="nofollow">https://stackoverflow.com/questions/50027886/need-help-for-check-my-backprop-ann-using-python</a></p>
<p>thanks sir</p>
<div class="reply">
<a aria-label="Reply to Rahmad ars" class="comment-reply-link" href="#comment-435975" onclick='return addComment.moveForm( "comment-435975", "435975", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-435997">
<div class="comment-container" id="li-comment-435997">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 26, 2018 at 2:59 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-435997" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If you are struggling with the code, I would recommend not coding the algorithm from scratch.</p>
<p>Instead, I would recommend using a library like Keras. Here is a worked example:<br/>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435997" onclick='return addComment.moveForm( "comment-435997", "435997", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-436195">
<div class="comment-container" id="li-comment-436195">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/22ba6318aedec7368b6fb6c0a3f84d5e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/22ba6318aedec7368b6fb6c0a3f84d5e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Fahad</span>
<span class="date">April 28, 2018 at 9:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-436195" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have the same problem of Rahmad</p>
<p>The same problem occurs when you change the original code from 5 neurons in the hidden layer to 31 neuron ( the error value does not change). </p>
<p>I know 31 hidden neuron is not a right number of neurons for seed data set. But I would like to know what is the wrong when you increase the number of neurons.</p>
<p>Logically, it should be fine and the error value decreases. But when you change the number of neurons to 30 it is still working , when change it to 31 neurons it does not decrease !</p>
<p>I think if this problem is fixed, then the problem of Rahmad will be fixed too.</p>
<div class="reply">
<a aria-label="Reply to Fahad" class="comment-reply-link" href="#comment-436195" onclick='return addComment.moveForm( "comment-436195", "436195", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-436225">
<div class="comment-container" id="li-comment-436225">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 29, 2018 at 6:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-436225" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps the model requires tuning to your specific problem (e.g. layers, nodes, activation function, etc.)</p>
<p>It might be better to use a library like Keras for your project:<br/>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow">https://machinelearningmastery.com/start-here/#deeplearning</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436225" onclick='return addComment.moveForm( "comment-436225", "436225", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-436476">
<div class="comment-container" id="li-comment-436476">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ce7b36067c2dd43538c4799c1103be1b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ce7b36067c2dd43538c4799c1103be1b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rocha</span>
<span class="date">May 2, 2018 at 9:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-436476" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi dude, I’m stuck in this error, could you help me?</p>
<p># Forward propagate input to a network output<br/>
def forward_propagate(network, row):<br/>
	inputs = row<br/>
	for layer in network:<br/>
		new_inputs = []<br/>
		for neuron in layer:<br/>
—&gt;&gt;&gt;		activation = activate(neuron[‘weights’], inputs)<br/>
			neuron[‘output’] = transfer(activation)<br/>
			new_inputs.append(neuron[‘output’])<br/>
		inputs = new_inputs<br/>
	return inputs</p>
<p>That line is giving me this: TypeError: list indices must be integers or slices, not str</p>
<p>Should be the python version? I’m using python 3…</p>
<div class="reply">
<a aria-label="Reply to Rocha" class="comment-reply-link" href="#comment-436476" onclick='return addComment.moveForm( "comment-436476", "436476", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-436513">
<div class="comment-container" id="li-comment-436513">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 3, 2018 at 6:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-436513" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This code was written for Python 2.7 sorry.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436513" onclick='return addComment.moveForm( "comment-436513", "436513", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-436927">
<div class="comment-container" id="li-comment-436927">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f27effc28daddcc0264d3b26be036d5c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f27effc28daddcc0264d3b26be036d5c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kamrun Nahar Nisha</span>
<span class="date">May 8, 2018 at 4:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-436927" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hello.please help me.<br/>
I want to use breast cancer dataset instead of seed dataset. </p>
<p>seed(1)<br/>
# load and prepare data<br/>
filename = ‘seeds_dataset.csv’<br/>
dataset = load_csv(filename)<br/>
for i in range(len(dataset[0])-1):<br/>
	str_column_to_float(dataset, i)<br/>
# convert class column to integers<br/>
str_column_to_int(dataset, len(dataset[0])-1)<br/>
# normalize input variables<br/>
minmax = dataset_minmax(dataset)<br/>
normalize_dataset(dataset, minmax)<br/>
# evaluate algorithm<br/>
n_folds = 5<br/>
l_rate = 0.3<br/>
n_epoch = 500<br/>
n_hidden = 5<br/>
scores = evaluate_algorithm(dataset, back_propagation, n_folds, l_rate, n_epoch, n_hidden)<br/>
print(‘Scores: %s’ % scores)<br/>
print(‘Mean Accuracy: %.3f%%’ % (sum(scores)/float(len(scores))))</p>
<p>In this part of your code I also want to print the error and it will be like</p>
<p>epoch=0, lrate=0.500, error=6.350<br/>
&gt;epoch=1, lrate=0.500, error=5.531<br/>
&gt;epoch=2, lrate=0.500, error=5.221<br/>
&gt;epoch=3, lrate=0.500, error=4.951<br/>
&gt;epoch=4, lrate=0.500, error=4.519<br/>
&gt;epoch=5, lrate=0.500, error=4.173<br/>
&gt;epoch=6, lrate=0.500, error=3.835<br/>
&gt;epoch=7, lrate=0.500, error=3.506<br/>
&gt;epoch=8, lrate=0.500, error=3.192<br/>
&gt;epoch=9, lrate=0.500, error=2.898<br/>
&gt;epoch=10, lrate=0.500, error=2.626<br/>
&gt;epoch=11, lrate=0.500, error=2.377<br/>
&gt;epoch=12, lrate=0.500, error=2.153<br/>
&gt;epoch=13, lrate=0.500, error=1.953<br/>
&gt;epoch=14, lrate=0.500, error=1.774<br/>
&gt;epoch=15, lrate=0.500, error=1.614<br/>
&gt;epoch=16, lrate=0.500, error=1.472<br/>
&gt;epoch=17, lrate=0.500, error=1.346<br/>
&gt;epoch=18, lrate=0.500, error=1.233<br/>
&gt;epoch=19, lrate=0.500, error=1.132<br/>
[{‘output’: 0.029980305604426185, ‘weights’: [-1.4688375095432327, 1.850887325439514, 1.0858178629550297], ‘delta’: -0.0059546604162323625}, {‘output’: 0.9456229000211323, ‘weights’: [0.37711098142462157, -0.0625909894552989, 0.2765123702642716], ‘delta’: 0.0026279652850863837}]<br/>
[{‘output’: 0.23648794202357587, ‘weights’: [2.515394649397849, -0.3391927502445985, -0.9671565426390275], ‘delta’: -0.04270059278364587}, {‘output’: 0.7790535202438367, ‘weights’: [-2.5584149848484263, 1.0036422106209202, 0.42383086467582715], ‘delta’: 0.03803132596437354}]</p>
<p>please tell me the code . Using breast cancer dataset not wheat seed dataset. I am not so good in coding that’s why I need your help immediately.</p>
<div class="reply">
<a aria-label="Reply to Kamrun Nahar Nisha" class="comment-reply-link" href="#comment-436927" onclick='return addComment.moveForm( "comment-436927", "436927", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-436976">
<div class="comment-container" id="li-comment-436976">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 9, 2018 at 6:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-436976" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m eager to help, but I do not have the capacity to outline the changes or write the code for you.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436976" onclick='return addComment.moveForm( "comment-436976", "436976", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-437162">
<div class="comment-container" id="li-comment-437162">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7d22a6579d5a4cb864b3af62ddf0f521?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7d22a6579d5a4cb864b3af62ddf0f521?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Akefar</span>
<span class="date">May 11, 2018 at 4:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437162" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi Jason,<br/>
I tried your code in my data set ,shape of my data is (576,16) .the problem is </p>
<p>IndexError: list assignment index out of range</p>
<p>is there any need to change your code for (576,16) data shape .<br/>
Thanks</p>
<p>—————————————————————————<br/>
IndexError                                Traceback (most recent call last)<br/>
 in ()<br/>
    195 n_epoch = 500<br/>
    196 n_hidden = 1<br/>
–&gt; 197 scores = evaluate_algorithm(dataset, back_propagation, n_folds, l_rate, n_epoch, n_hidden)<br/>
    198 print(‘Scores: %s’ % scores)<br/>
    199 print(‘Mean Accuracy: %.3f%%’ % (sum(scores)/float(len(scores))))</p>
<p> in evaluate_algorithm(dataset, algorithm, n_folds, *args)<br/>
     79                         test_set.append(row_copy)<br/>
     80                         row_copy[-1] = None<br/>
—&gt; 81                 predicted = algorithm(train_set, test_set, *args)<br/>
     82                 actual = [row[-1] for row in fold]<br/>
     83                 accuracy = accuracy_metric(actual, predicted)</p>
<p> in back_propagation(train, test, l_rate, n_epoch, n_hidden)<br/>
    171         n_outputs = len(set([row[-1] for row in train]))<br/>
    172         network = initialize_network(n_inputs, n_hidden, n_outputs)<br/>
–&gt; 173         train_network(network, train, l_rate, n_epoch, n_outputs)<br/>
    174         predictions = list()<br/>
    175         for row in test:</p>
<p> in train_network(network, train, l_rate, n_epoch, n_outputs)<br/>
    148                         outputs = forward_propagate(network, row)<br/>
    149                         expected = [0 for i in range(n_outputs)]<br/>
–&gt; 150                         expected[row[-1]] = 1<br/>
    151                         backward_propagate_error(network, expected)<br/>
    152                         update_weights(network, row, l_rate)</p>
<p>IndexError: list assignment index out of range</p>
<div class="reply">
<a aria-label="Reply to Akefar" class="comment-reply-link" href="#comment-437162" onclick='return addComment.moveForm( "comment-437162", "437162", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-437186">
<div class="comment-container" id="li-comment-437186">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 11, 2018 at 6:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437186" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You may need to change your data to match the model or the model to match the data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437186" onclick='return addComment.moveForm( "comment-437186", "437186", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-437427">
<div class="comment-container" id="li-comment-437427">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6fd8251ab680d739a19a1d104d9ccdc4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6fd8251ab680d739a19a1d104d9ccdc4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Pradeep</span>
<span class="date">May 14, 2018 at 3:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437427" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, I tried your code on the same sample dataset, i am getting the following type error in the function activate. I am doing it in python3.6. hope to hear from you soon</p>
<p>Traceback (most recent call last):<br/>
  File “neural_network.py”, line 94, in<br/>
    train_network(network, dataset, 0.5, 20, n_outputs)<br/>
  File “neural_network.py”, line 76, in train_network<br/>
    outputs = forward_propagate(network, row)<br/>
  File “neural_network.py”, line 31, in forward_propagate<br/>
    activation = activate(neuron[‘weights’], inputs)<br/>
  File “neural_network.py”, line 18, in activate<br/>
    activation += weights[i] * inputs[i]<br/>
TypeError: can’t multiply sequence by non-int of type ‘float’</p>
<div class="reply">
<a aria-label="Reply to Pradeep" class="comment-reply-link" href="#comment-437427" onclick='return addComment.moveForm( "comment-437427", "437427", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-437458">
<div class="comment-container" id="li-comment-437458">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 14, 2018 at 6:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437458" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The code requires Python 2.7.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437458" onclick='return addComment.moveForm( "comment-437458", "437458", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-437787">
<div class="comment-container" id="li-comment-437787">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e881f540a747c2fc238dd9ac0c66b157?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e881f540a747c2fc238dd9ac0c66b157?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Deepak D</span>
<span class="date">May 17, 2018 at 6:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437787" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason Brownlee,</p>
<p>I tried your code and experienced the some error applying the Backpropagation algorithm to the wheat seeds dataset. I am using python 2.7.</p>
<p>Error type:</p>
<p>File “C:\Python27\programs\backpropagation.py”, line 186,<br/>
in  str_column_to_float(dataset, i)</p>
<p>File “C:\Python27\programs\backpropagation.py”, line 22,<br/>
in str_column_to_float     row[column] = float(row[column].strip())<br/>
ValueError: could not convert string to float:</p>
<div class="reply">
<a aria-label="Reply to Deepak D" class="comment-reply-link" href="#comment-437787" onclick='return addComment.moveForm( "comment-437787", "437787", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-437829">
<div class="comment-container" id="li-comment-437829">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 18, 2018 at 6:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437829" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am sorry to hear that, I have some suggestions here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437829" onclick='return addComment.moveForm( "comment-437829", "437829", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-437901">
<div class="comment-container" id="li-comment-437901">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c6313461e27ed009989687ab27507dff?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c6313461e27ed009989687ab27507dff?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Dhanya Hegde</span>
<span class="date">May 19, 2018 at 1:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437901" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason! Great work. Really helpful. I didn’t understand one part of your code. On what basis does predict function return the predicted value as 0 or 1, after taking the maximum of the two output neuron values?</p>
<div class="reply">
<a aria-label="Reply to Dhanya Hegde" class="comment-reply-link" href="#comment-437901" onclick='return addComment.moveForm( "comment-437901", "437901", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-437930">
<div class="comment-container" id="li-comment-437930">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 19, 2018 at 7:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-437930" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The summation of the activation is passed through a sigmoid transfer function.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437930" onclick='return addComment.moveForm( "comment-437930", "437930", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-438072">
<div class="comment-container" id="li-comment-438072">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c6313461e27ed009989687ab27507dff?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c6313461e27ed009989687ab27507dff?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://." rel="external nofollow">Dhanya Hegde</a></span>
<span class="date">May 21, 2018 at 3:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-438072" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I didn’t understand this part of the code</p>
<p>outputs.index(max(outputs)</p>
<p>Is one hot encoding used or binary classification?<br/>
If so, how is the actual mapping done?<br/>
And when is the iteration process stopped?</p>
<div class="reply">
<a aria-label="Reply to Dhanya Hegde" class="comment-reply-link" href="#comment-438072" onclick='return addComment.moveForm( "comment-438072", "438072", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-438103">
<div class="comment-container" id="li-comment-438103">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 21, 2018 at 6:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-438103" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>As stated in the text above the code, it returns an integer for the class with the largest probability.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-438103" onclick='return addComment.moveForm( "comment-438103", "438103", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-438755">
<div class="comment-container" id="li-comment-438755">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c5964b1e36a53faf0c3ee1d72d509acd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c5964b1e36a53faf0c3ee1d72d509acd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ionut</span>
<span class="date">May 27, 2018 at 12:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-438755" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>I’m a beginner in neural networks and I don’t understand the dataset from the section “4.2. Train Network”. Can anyone explain me what x1, x2 and y means?</p>
<div class="reply">
<a aria-label="Reply to Ionut" class="comment-reply-link" href="#comment-438755" onclick='return addComment.moveForm( "comment-438755", "438755", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-438786">
<div class="comment-container" id="li-comment-438786">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 27, 2018 at 6:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-438786" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Input 1, input 2 and output.</p>
<p>Perhaps start here:<br/>
<a href="https://machinelearningmastery.com/start-here/#algorithms" rel="nofollow">https://machinelearningmastery.com/start-here/#algorithms</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-438786" onclick='return addComment.moveForm( "comment-438786", "438786", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-438884">
<div class="comment-container" id="li-comment-438884">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5374c07f0b56e1d42053a0b0a803f224?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5374c07f0b56e1d42053a0b0a803f224?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rishik Mani</span>
<span class="date">May 28, 2018 at 7:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-438884" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thank you for the highly informative post. But could you please clarify me upon this petty little issue.</p>
<p>In section 4.2 Train network, you considered n_inputs = len(dataset[0]) – 1. Why did you put a -1 here, while the number of the inputs should exactly be of the length of the dataset.</p>
<div class="reply">
<a aria-label="Reply to Rishik Mani" class="comment-reply-link" href="#comment-438884" onclick='return addComment.moveForm( "comment-438884", "438884", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-438914">
<div class="comment-container" id="li-comment-438914">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 28, 2018 at 2:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-438914" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>To exclude the output variable from the number of inputs.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-438914" onclick='return addComment.moveForm( "comment-438914", "438914", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-439536">
<div class="comment-container" id="li-comment-439536">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/03a747778ade225b77e92439146b7886?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/03a747778ade225b77e92439146b7886?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Samih Eisa</span>
<span class="date">June 2, 2018 at 9:13 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-439536" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you, jason.</p>
<div class="reply">
<a aria-label="Reply to Samih Eisa" class="comment-reply-link" href="#comment-439536" onclick='return addComment.moveForm( "comment-439536", "439536", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-439591">
<div class="comment-container" id="li-comment-439591">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 3, 2018 at 6:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-439591" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-439591" onclick='return addComment.moveForm( "comment-439591", "439591", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-439801">
<div class="comment-container" id="li-comment-439801">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5c7013883e95ef081e12404c5436a3e6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5c7013883e95ef081e12404c5436a3e6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://github.com/gknam" rel="external nofollow">Kie Woo Nam</a></span>
<span class="date">June 5, 2018 at 3:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-439801" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca8060829d316825647" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Update network weights with error
def update_weights(network, row, l_rate):
	for i in range(len(network)):
		inputs = row[:-1]
		if i != 0:
			inputs = [neuron['output'] for neuron in network[i - 1]]
		for neuron in network[i]:
			for j in range(len(inputs)):
				neuron['weights'][j] += l_rate * neuron['delta'] * inputs[j]
			neuron['weights'][-1] += l_rate * neuron['delta']</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca8060829d316825647-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca8060829d316825647-2">2</div><div class="crayon-num" data-line="crayon-5c0ca8060829d316825647-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca8060829d316825647-4">4</div><div class="crayon-num" data-line="crayon-5c0ca8060829d316825647-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca8060829d316825647-6">6</div><div class="crayon-num" data-line="crayon-5c0ca8060829d316825647-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca8060829d316825647-8">8</div><div class="crayon-num" data-line="crayon-5c0ca8060829d316825647-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca8060829d316825647-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca8060829d316825647-1"><span class="crayon-p"># Update network weights with error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca8060829d316825647-2"><span class="crayon-e">def </span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca8060829d316825647-3"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca8060829d316825647-4"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca8060829d316825647-5"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca8060829d316825647-6"><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca8060829d316825647-7"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">neuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca8060829d316825647-8"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca8060829d316825647-9"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">l_rate *</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">inputs</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca8060829d316825647-10"><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e ">l_rate *</span><span class="crayon-h"> </span><span class="crayon-v">neuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0010 seconds] -->
<p></p>
<p>Hi,</p>
<p>I guess I’m likely mistaken, so please but when i != 0, isn’t the last line updating the last weight for the second time?</p>
<p>So, shouldn’t it be “inputs = [neuron[‘output’] for neuron in network[i – 1]][:-1]” (add “[:-1]]” at the end)?</p>
<p>If I’m wrong, I’ll read the code again more carefully, so please let me know.</p>
<div class="reply">
<a aria-label="Reply to Kie Woo Nam" class="comment-reply-link" href="#comment-439801" onclick='return addComment.moveForm( "comment-439801", "439801", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-439837">
<div class="comment-container" id="li-comment-439837">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 5, 2018 at 6:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-439837" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No. There are more weights than inputs and the -1 index of the weights is the bias.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-439837" onclick='return addComment.moveForm( "comment-439837", "439837", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-439891">
<div class="comment-container" id="li-comment-439891">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5c7013883e95ef081e12404c5436a3e6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5c7013883e95ef081e12404c5436a3e6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://github.com/gknam" rel="external nofollow">Kie Woo Nam</a></span>
<span class="date">June 5, 2018 at 7:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-439891" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ah, right. Now I see it from “output_layer = [{‘weights’:[random() for i in range(n_hidden + 1)]} for i in range(n_outputs)]”.</p>
<p>Thank you for your quick reply.</p>
<div class="reply">
<a aria-label="Reply to Kie Woo Nam" class="comment-reply-link" href="#comment-439891" onclick='return addComment.moveForm( "comment-439891", "439891", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-439939">
<div class="comment-container" id="li-comment-439939">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 6, 2018 at 6:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-439939" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-439939" onclick='return addComment.moveForm( "comment-439939", "439939", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-443058">
<div class="comment-container" id="li-comment-443058">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/119a6951e13df5661987462b66d36b2a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/119a6951e13df5661987462b66d36b2a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Thomas Specht</span>
<span class="date">July 10, 2018 at 4:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-443058" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Great tutorial to get into ML coding. I have one question:</p>
<p>What library would you recommend for projects and why? I want to use NN for regression problems.</p>
<div class="reply">
<a aria-label="Reply to Thomas Specht" class="comment-reply-link" href="#comment-443058" onclick='return addComment.moveForm( "comment-443058", "443058", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-443091">
<div class="comment-container" id="li-comment-443091">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 10, 2018 at 6:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-443091" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I recommend Keras because it is computationally efficient, fast for development and fun:<br/>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow">https://machinelearningmastery.com/start-here/#deeplearning</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443091" onclick='return addComment.moveForm( "comment-443091", "443091", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-445938">
<div class="comment-container" id="li-comment-445938">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a105e85f2291c370973e906cc67ef051?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a105e85f2291c370973e906cc67ef051?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hugo B.</span>
<span class="date">August 13, 2018 at 1:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-445938" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason! Thank you for this tutorial.<br/>
I try to implement the batch learning, but I have some questions about it…</p>
<p>– Computing the errors:<br/>
Do I have to accumulate the errors (‘delta’) in backward_propagate_error() during one epoch and performing an average according to the number of back-propagations performed?</p>
<p>– Updating the weights:<br/>
In train_network(), I call update_weights() for each epoch, but I don’t know which row(s) of train (dataset) I have to used. Currently I use only one row: train[0].</p>
<div class="reply">
<a aria-label="Reply to Hugo B." class="comment-reply-link" href="#comment-445938" onclick='return addComment.moveForm( "comment-445938", "445938", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-446016">
<div class="comment-container" id="li-comment-446016">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ab04b70a617a9a2df7606a532ff323f0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ab04b70a617a9a2df7606a532ff323f0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">elizabeth</span>
<span class="date">August 14, 2018 at 2:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-446016" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Sir<br/>
Thank you so much for this article.<br/>
Can you please tell me how i can solve this error:</p>
<p>   File “mlp8.py”, line 186, in<br/>
    str_column_to_float(dataset, i)<br/>
  File “mlp8.py”, line 22, in str_column_to_float<br/>
    row[column] = float(row[column].strip())<br/>
ValueError: could not convert string to float:</p>
<p>thankyou</p>
<div class="reply">
<a aria-label="Reply to elizabeth" class="comment-reply-link" href="#comment-446016" onclick='return addComment.moveForm( "comment-446016", "446016", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-446048">
<div class="comment-container" id="li-comment-446048">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 14, 2018 at 6:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-446048" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have some suggestions here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-446048" onclick='return addComment.moveForm( "comment-446048", "446048", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-447148">
<div class="comment-container" id="li-comment-447148">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8d54987121a77d3f5755bed8357efb0a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8d54987121a77d3f5755bed8357efb0a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">STEPHEN OLADEJI</span>
<span class="date">August 28, 2018 at 10:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-447148" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Prof,</p>
<p>Thanks for this tutorial,<br/>
Sir, I’ve gone through a lot of your project online and they are very superb. God bless you, sir.<br/>
Sir. my question is as followings.<br/>
1. I noticed that one WEKA 3.6, Artificial Immune System was removed because this was in version 1.8, Is it because there is no research prospect in the algorithm?<br/>
2. I want to write python version for AIRS, CSCA, Genetic Algorithm can you help proofread  it sir so see if what I write is correct</p>
<div class="reply">
<a aria-label="Reply to STEPHEN OLADEJI" class="comment-reply-link" href="#comment-447148" onclick='return addComment.moveForm( "comment-447148", "447148", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-447185">
<div class="comment-container" id="li-comment-447185">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 29, 2018 at 8:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-447185" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have an implementation here that you can use:<br/>
<a href="http://wekaclassalgos.sourceforge.net/" rel="nofollow">http://wekaclassalgos.sourceforge.net/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-447185" onclick='return addComment.moveForm( "comment-447185", "447185", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-448350">
<div class="comment-container" id="li-comment-448350">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4ced9b8066651b3cb5874e14a971eba6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4ced9b8066651b3cb5874e14a971eba6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tamara</span>
<span class="date">September 11, 2018 at 5:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-448350" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you so much for this tutorial.<br/>
How to see the results of work a trained network in Python?</p>
<div class="reply">
<a aria-label="Reply to Tamara" class="comment-reply-link" href="#comment-448350" onclick='return addComment.moveForm( "comment-448350", "448350", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-448368">
<div class="comment-container" id="li-comment-448368">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 11, 2018 at 6:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-448368" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What do you mean exactly?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-448368" onclick='return addComment.moveForm( "comment-448368", "448368", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-449612">
<div class="comment-container" id="li-comment-449612">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f5e9b95ca84c1b7932a5b9f1d928a27e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f5e9b95ca84c1b7932a5b9f1d928a27e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ritu</span>
<span class="date">September 23, 2018 at 9:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-449612" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How should I modify to code to always run for one output neuron in the output layer?<br/>
eg. if the output class consist of only 2 output classes ‘1’ and ‘2’ , as per the above code 2 neurons will be created within the output layer, but what if I wanted a neural network to just have one neuron in the output layer.</p>
<div class="reply">
<a aria-label="Reply to ritu" class="comment-reply-link" href="#comment-449612" onclick='return addComment.moveForm( "comment-449612", "449612", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-449654">
<div class="comment-container" id="li-comment-449654">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 24, 2018 at 6:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-449654" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If you are having trouble with this tutorial, I would encourage you to use Keras to develop neural network models.</p>
<p>You can get started here:<br/>
<a href="https://machinelearningmastery.com/start-here/#python" rel="nofollow">https://machinelearningmastery.com/start-here/#python</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-449654" onclick='return addComment.moveForm( "comment-449654", "449654", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-449919">
<div class="comment-container" id="li-comment-449919">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2641a0a39da1a5a369448a6848d4c6bb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2641a0a39da1a5a369448a6848d4c6bb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Parva</span>
<span class="date">September 27, 2018 at 9:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-449919" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Why is there just one output coming from layer 1 though it contains 2 neurons. Shouldn’t there be 2 outputs one from each neuron?</p>
<p> [{‘output’: 0.7105668883115941, ‘weights’: [0.13436424411240122, 0.8474337369372327, 0.763774618976614], ‘delta’: -0.0005348048046610517}]<br/>
[{‘output’: 0.6213859615555266, ‘weights’: [0.2550690257394217, 0.49543508709194095], ‘delta’: -0.14619064683582808}, {‘output’: 0.6573693455986976, ‘weights’: [0.4494910647887381, 0.651592972722763], ‘delta’: 0.0771723774346327}]</p>
<div class="reply">
<a aria-label="Reply to Parva" class="comment-reply-link" href="#comment-449919" onclick='return addComment.moveForm( "comment-449919", "449919", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-449941">
<div class="comment-container" id="li-comment-449941">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 27, 2018 at 2:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-449941" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Which step exactly are you having trouble with?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-449941" onclick='return addComment.moveForm( "comment-449941", "449941", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-449974">
<div class="comment-container" id="li-comment-449974">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/361f92a100abccd2f1866faa6c809ab4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/361f92a100abccd2f1866faa6c809ab4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Brian</span>
<span class="date">September 28, 2018 at 1:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-449974" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for this example. It has helped me get past the block I had with the mathematical based descriptions and differential calculus related to back propagation.<br/>
As I have been focusing on the back propagation portion of this example I have come up with an alternative version of  the ‘backward_propagate_error’ function that I think is a much more succinct and logical way to write this function.</p>
<p>Please find below</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca80608023127328085" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Backpropagate error and store in neurons
def backward_propagate_error(network, expected):
	for i in reversed(range(len(network))):
		layer = network[i]
		for j in range(len(layer)):
			fromNeuron = layer[j]
			error = 0.0
			if i != len(network)-1:                           #This identifies all but the last (output) layer
				for toNeuron in network[i + 1]:
					error += (toNeuron['weights'][j] * toNeuron['delta'])
			else:                                             #This is the last (output) layer
				error = expected[j] - fromNeuron['output']
			fromNeuron['error'] = error
			fromNeuron['delta'] = error * transfer_derivative(fromNeuron['output'])</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca80608023127328085-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca80608023127328085-2">2</div><div class="crayon-num" data-line="crayon-5c0ca80608023127328085-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca80608023127328085-4">4</div><div class="crayon-num" data-line="crayon-5c0ca80608023127328085-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca80608023127328085-6">6</div><div class="crayon-num" data-line="crayon-5c0ca80608023127328085-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca80608023127328085-8">8</div><div class="crayon-num" data-line="crayon-5c0ca80608023127328085-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca80608023127328085-10">10</div><div class="crayon-num" data-line="crayon-5c0ca80608023127328085-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca80608023127328085-12">12</div><div class="crayon-num" data-line="crayon-5c0ca80608023127328085-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca80608023127328085-14">14</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca80608023127328085-1"><span class="crayon-p"># Backpropagate error and store in neurons</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca80608023127328085-2"><span class="crayon-e">def </span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca80608023127328085-3"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">reversed</span><span class="crayon-sy">(</span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca80608023127328085-4"><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca80608023127328085-5"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">layer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca80608023127328085-6"><span class="crayon-h"> </span><span class="crayon-v">fromNeuron</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">layer</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca80608023127328085-7"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca80608023127328085-8"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-h">                           </span><span class="crayon-p">#This identifies all but the last (output) layer</span></div><div class="crayon-line" id="crayon-5c0ca80608023127328085-9"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">toNeuron </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">network</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca80608023127328085-10"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">toNeuron</span><span class="crayon-sy">[</span><span class="crayon-s">'weights'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">toNeuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca80608023127328085-11"><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-o">:</span><span class="crayon-h">                                             </span><span class="crayon-p">#This is the last (output) layer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca80608023127328085-12"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">fromNeuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0ca80608023127328085-13"><span class="crayon-h"> </span><span class="crayon-v">fromNeuron</span><span class="crayon-sy">[</span><span class="crayon-s">'error'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca80608023127328085-14"><span class="crayon-e"> </span><span class="crayon-v">fromNeuron</span><span class="crayon-sy">[</span><span class="crayon-s">'delta'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e ">error *</span><span class="crayon-h"> </span><span class="crayon-e">transfer_derivative</span><span class="crayon-sy">(</span><span class="crayon-v">fromNeuron</span><span class="crayon-sy">[</span><span class="crayon-s">'output'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0011 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to Brian" class="comment-reply-link" href="#comment-449974" onclick='return addComment.moveForm( "comment-449974", "449974", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-450000">
<div class="comment-container" id="li-comment-450000">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 28, 2018 at 6:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-450000" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Cool!</p>
<p>Sorry, I don’t have the capacity to review your code.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-450000" onclick='return addComment.moveForm( "comment-450000", "450000", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-450626">
<div class="comment-container" id="li-comment-450626">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/361f92a100abccd2f1866faa6c809ab4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/361f92a100abccd2f1866faa6c809ab4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Brian</span>
<span class="date">October 4, 2018 at 2:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-450626" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Should not the formula for the error be<br/>
sum_error += sum([0.5*(expected[i]-outputs[i])**2 for i in range(len(expected))])<br/>
as apposed to<br/>
sum_error += sum([(expected[i]-outputs[i])**2 for i in range(len(expected))])<br/>
To correctly back propagate with the derivative?</p>
<div class="reply">
<a aria-label="Reply to Brian" class="comment-reply-link" href="#comment-450626" onclick='return addComment.moveForm( "comment-450626", "450626", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-450649">
<div class="comment-container" id="li-comment-450649">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 4, 2018 at 6:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-450649" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Why is that Brian?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-450649" onclick='return addComment.moveForm( "comment-450649", "450649", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-451146">
<div class="comment-container" id="li-comment-451146">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a92f4c928e3c1aa433ae095f99a27568?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a92f4c928e3c1aa433ae095f99a27568?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">KS</span>
<span class="date">October 10, 2018 at 2:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451146" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can you please tell me how to inplant tanh and ReLu?<br/>
I tried to find examples on the internet, but I couldn’t find good examples.</p>
<p>I understand that these 2 codes need to be changed:</p>
<p># Transfer neuron activation<br/>
def transfer(activation):<br/>
	return 1.0 / (1.0 + exp(-activation))</p>
<p># Calculate the derivative of an neuron output<br/>
def transfer_derivative(output):<br/>
	return output * (1.0 – output)</p>
<p>1. What is the code when using tanh?<br/>
2. What is the code when using ReLu?</p>
<div class="reply">
<a aria-label="Reply to KS" class="comment-reply-link" href="#comment-451146" onclick='return addComment.moveForm( "comment-451146", "451146", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-451181">
<div class="comment-container" id="li-comment-451181">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 10, 2018 at 6:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451181" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion, sorry, I don’t have the capacity to make these changes for you.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-451181" onclick='return addComment.moveForm( "comment-451181", "451181", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-451222">
<div class="comment-container" id="li-comment-451222">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ed0876828fe1921270d73720d1b32095?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ed0876828fe1921270d73720d1b32095?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">moe</span>
<span class="date">October 10, 2018 at 7:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451222" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you so much, 1 – 5 helped me to built my own generic network. Now i have a MLP network which i can easily adjust with a few parameter changes, wouldnt have been so easy with your example.</p>
<div class="reply">
<a aria-label="Reply to moe" class="comment-reply-link" href="#comment-451222" onclick='return addComment.moveForm( "comment-451222", "451222", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-451292">
<div class="comment-container" id="li-comment-451292">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 11, 2018 at 7:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451292" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Well done!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-451292" onclick='return addComment.moveForm( "comment-451292", "451292", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-451271">
<div class="comment-container" id="li-comment-451271">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6e670f522ad802964e2e484f67051451?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6e670f522ad802964e2e484f67051451?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anwar</span>
<span class="date">October 11, 2018 at 3:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451271" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am running the same code that u have provided on python 3.6 and getting these errors please help me:-</p>
<p>—————————————————————————————————————————</p>
<p>IndexError                                Traceback (most recent call last)<br/>
 in ()<br/>
     16 n_epoch = 500<br/>
     17 n_hidden = 5<br/>
—&gt; 18 scores = evaluate_algorithm(dataset, back_propagation, n_folds, l_rate, n_epoch, n_hidden)<br/>
     19 print(‘Scores: %s’ % scores)<br/>
     20 print(‘Mean Accuracy: %.3f%%’ % (sum(scores)/float(len(scores))))</p>
<p> in evaluate_algorithm(dataset, algorithm, n_folds, *args)<br/>
     12             test_set.append(row_copy)<br/>
     13             row_copy[-1] = None<br/>
—&gt; 14         predicted = algorithm(train_set, test_set, *args)<br/>
     15         actual = [row[-1] for row in fold]<br/>
     16         accuracy = accuracy_metric(actual, predicted)</p>
<p> in back_propagation(train, test, l_rate, n_epoch, n_hidden)<br/>
      4     n_outputs = len(set([row[-1] for row in train]))<br/>
      5     network = initialize_network(n_inputs, n_hidden, n_outputs)<br/>
—-&gt; 6     train_network(network, train, l_rate, n_epoch, n_outputs)<br/>
      7     predictions = list()<br/>
      8     for row in test:</p>
<p> in train_network(network, train, l_rate, n_epoch, n_outputs)<br/>
      5             outputs = forward_propagate(network, row)<br/>
      6             expected = [0 for i in range(n_outputs)]<br/>
—-&gt; 7             expected[row[-1]] = 1<br/>
      8             backward_propagate_error(network, expected)<br/>
      9             update_weights(network, row, l_rate)<br/>
IndexError: list assignment index out of range</p>
<div class="reply">
<a aria-label="Reply to Anwar" class="comment-reply-link" href="#comment-451271" onclick='return addComment.moveForm( "comment-451271", "451271", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-451307">
<div class="comment-container" id="li-comment-451307">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 11, 2018 at 8:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451307" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have some suggestions here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-451307" onclick='return addComment.moveForm( "comment-451307", "451307", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-451428">
<div class="comment-container" id="li-comment-451428">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f3c53b087faea28e5e53294b38ba0f47?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f3c53b087faea28e5e53294b38ba0f47?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">KS</span>
<span class="date">October 12, 2018 at 11:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451428" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How to:<br/>
“Regression. Change the network so that there is only one neuron in the output layer and that a real value is predicted.”</p>
<p>How to get 1 output layer?</p>
<div class="reply">
<a aria-label="Reply to KS" class="comment-reply-link" href="#comment-451428" onclick='return addComment.moveForm( "comment-451428", "451428", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-451512">
<div class="comment-container" id="li-comment-451512">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 13, 2018 at 6:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451512" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Coding algorithms from scratch is not for beginners.</p>
<p>I strongly encourage you to use Keras, for example:<br/>
<a href="https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/" rel="nofollow">https://machinelearningmastery.com/regression-tutorial-keras-deep-learning-library-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-451512" onclick='return addComment.moveForm( "comment-451512", "451512", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-451754">
<div class="comment-container" id="li-comment-451754">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7dbaf4305bc8adde504dcf56e6a05050?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7dbaf4305bc8adde504dcf56e6a05050?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jerry</span>
<span class="date">October 16, 2018 at 9:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451754" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ok, just following up. I still don’t get how the backprop is updating:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca80607dd7514617807" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
        for row in train:
            outputs = forward_propagate(network, row, alpha)
            expected = [0 for i in range(n_outputs)]
            expected[row[-1]] = 1
            sum_error += sum([(expected[i]-outputs[i])**2 for i in range(len(expected))])
            backward_propagate_error(network, expected, alpha)
            update_weights(network, row, l_rate)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca80607dd7514617807-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca80607dd7514617807-2">2</div><div class="crayon-num" data-line="crayon-5c0ca80607dd7514617807-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca80607dd7514617807-4">4</div><div class="crayon-num" data-line="crayon-5c0ca80607dd7514617807-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca80607dd7514617807-6">6</div><div class="crayon-num" data-line="crayon-5c0ca80607dd7514617807-7">7</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca80607dd7514617807-1"><span class="crayon-h">        </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca80607dd7514617807-2"><span class="crayon-h">            </span><span class="crayon-v">outputs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward_propagate</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca80607dd7514617807-3"><span class="crayon-h">            </span><span class="crayon-v">expected</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">n_outputs</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca80607dd7514617807-4"><span class="crayon-h">            </span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">row</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5c0ca80607dd7514617807-5"><span class="crayon-h">            </span><span class="crayon-v">sum_error</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-o">-</span><span class="crayon-v">outputs</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">expected</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca80607dd7514617807-6"><span class="crayon-h">            </span><span class="crayon-e">backward_propagate_error</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">expected</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca80607dd7514617807-7"><span class="crayon-h">            </span><span class="crayon-e">update_weights</span><span class="crayon-sy">(</span><span class="crayon-v">network</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_rate</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0008 seconds] -->
<p></p>
<p>1. No return statement or ‘global network’ for backward_propagate_error or update_network to actually incorporate the new weights. </p>
<p>My question, are you sure this uses back-propagation? How are the weights saved and updated for each epoch?</p>
<div class="reply">
<a aria-label="Reply to Jerry" class="comment-reply-link" href="#comment-451754" onclick='return addComment.moveForm( "comment-451754", "451754", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-451767">
<div class="comment-container" id="li-comment-451767">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 16, 2018 at 2:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-451767" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The weights are passed in by reference and modified in place.</p>
<p>Perhaps using Keras would be a better fit Jerry:<br/>
<a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/" rel="nofollow">https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-451767" onclick='return addComment.moveForm( "comment-451767", "451767", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-454335">
<div class="comment-container" id="li-comment-454335">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7dbaf4305bc8adde504dcf56e6a05050?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7dbaf4305bc8adde504dcf56e6a05050?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jerry</span>
<span class="date">November 10, 2018 at 11:53 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454335" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You learn something new everyday! I was always under the impression that values were immutable when passing to a function in Python. </p>
<p><a href="https://stackoverflow.com/questions/986006/how-do-i-pass-a-variable-by-reference" rel="nofollow">https://stackoverflow.com/questions/986006/how-do-i-pass-a-variable-by-reference</a></p>
<p>Thank you Jason! I’m really amazed on how active you are on this site. Just so you know, you and your work are referenced often in my MSDS program. </p>
<p>One area that I think would also be beneficial is some work on hidden node activations and their interpretations. The majority of our work is not so much on the output/accuracy of the NN, but more of visualizing weights, activations, and determining the features that are causing nodes to activate.</p>
<div class="reply">
<a aria-label="Reply to Jerry" class="comment-reply-link" href="#comment-454335" onclick='return addComment.moveForm( "comment-454335", "454335", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-454373">
<div class="comment-container" id="li-comment-454373">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 11, 2018 at 6:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454373" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, happy to help.</p>
<p>Why do you want to view/understand the dynamics of nodes in hidden layers?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-454373" onclick='return addComment.moveForm( "comment-454373", "454373", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-453276">
<div class="comment-container" id="li-comment-453276">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ed0876828fe1921270d73720d1b32095?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ed0876828fe1921270d73720d1b32095?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ben</span>
<span class="date">October 31, 2018 at 9:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-453276" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>i think this is not correct:<br/>
sum_error += sum([(expected[i]-outputs[i])**2 for i in range(len(expected))])</p>
<p>shouldn´t this be:<br/>
sum_error += sum([abs(0.5*(expected[i]-outputs[i])**2) for i in range(len(expected))])</p>
<p>see <a href="https://goo.gl/iqHJf6" rel="nofollow">https://goo.gl/iqHJf6</a> page 233 (5.11).</p>
<div class="reply">
<a aria-label="Reply to ben" class="comment-reply-link" href="#comment-453276" onclick='return addComment.moveForm( "comment-453276", "453276", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-3" id="comment-453308">
<div class="comment-container" id="li-comment-453308">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 1, 2018 at 6:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-453308" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This implementation is based on the book “Neural Smithing”:<br/>
<a href="https://www.amazon.com/Neural-Smithing-Supervised-Feedforward-Artificial/dp/0262527014/ref=as_li_ss_tl?ie=UTF8&amp;linkCode=sl1&amp;tag=inspiredalgor-20&amp;linkId=e3db0b57249093a94ebb073983bc8b4d&amp;language=en_US" rel="nofollow">https://www.amazon.com/Neural-Smithing-Supervised-Feedforward-Artificial/dp/0262527014/ref=as_li_ss_tl?ie=UTF8&amp;linkCode=sl1&amp;tag=inspiredalgor-20&amp;linkId=e3db0b57249093a94ebb073983bc8b4d&amp;language=en_US</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453308" onclick='return addComment.moveForm( "comment-453308", "453308", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-452149">
<div class="comment-container" id="li-comment-452149">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8dac031bfc3405398650e56f521249a6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8dac031bfc3405398650e56f521249a6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ayhan</span>
<span class="date">October 20, 2018 at 1:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-452149" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason, first thnx for the efforts. </p>
<p>Maybe one thing:<br/>
wouldnt it be better (especially for beginners to that topic) to at least use<br/>
something like numpy which would at least let all the matrix calculation look<br/>
a bit more compact (and therefore possible to concentrate on the real topic .. which is<br/>
backprop i would have guessed)?</p>
<p>Ok the title sais ‘implement from scratch’ but I would say at some point getting<br/>
the point towards backprop is maybe more important than being able to say that<br/>
it was implemented from scratch (using nothing but plain python). </p>
<p>Greets</p>
<div class="reply">
<a aria-label="Reply to Ayhan" class="comment-reply-link" href="#comment-452149" onclick='return addComment.moveForm( "comment-452149", "452149", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-452164">
<div class="comment-container" id="li-comment-452164">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 20, 2018 at 5:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-452164" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the feedback.</p>
<p>This example is not intended for writing operational code, for that I would recommend Keras:<br/>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow">https://machinelearningmastery.com/start-here/#deeplearning</a></p>
<p>This tutorial is to teach how to develop a net (training and evaluation) without any dependencies other than the standard lib.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-452164" onclick='return addComment.moveForm( "comment-452164", "452164", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-453576">
<div class="comment-container" id="li-comment-453576">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5f4e5cfcb0dec0bfee4bdf796297eba5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5f4e5cfcb0dec0bfee4bdf796297eba5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vadim</span>
<span class="date">November 3, 2018 at 11:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-453576" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Just Brilliant stuff</p>
<div class="reply">
<a aria-label="Reply to Vadim" class="comment-reply-link" href="#comment-453576" onclick='return addComment.moveForm( "comment-453576", "453576", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-453604">
<div class="comment-container" id="li-comment-453604">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 4, 2018 at 6:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-453604" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453604" onclick='return addComment.moveForm( "comment-453604", "453604", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-454771">
<div class="comment-container" id="li-comment-454771">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a93de98e99fcad50853f112a1f10398d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a93de98e99fcad50853f112a1f10398d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Himanshu</span>
<span class="date">November 14, 2018 at 10:38 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454771" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason<br/>
how i can use forward and backward propagation in real time data. I mean data in which we have multiple field. Fields contains Numerical values , floating values , String Values.<br/>
For an example if i want to use this technique for Titanic data how can i use it.</p>
<p>How can i decide how many hidden layers should be there.<br/>
How can i decide for learning rate.<br/>
How can i decide for what should be the seed value.<br/>
How can i decide for weights for such huge data.</p>
<div class="reply">
<a aria-label="Reply to Himanshu" class="comment-reply-link" href="#comment-454771" onclick='return addComment.moveForm( "comment-454771", "454771", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-454801">
<div class="comment-container" id="li-comment-454801">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 15, 2018 at 5:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454801" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You must use careful experimentation to get answers to each of these questions.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-454801" onclick='return addComment.moveForm( "comment-454801", "454801", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-454867">
<div class="comment-container" id="li-comment-454867">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b7595fa008656daf201ec2d404b6ee9d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b7595fa008656daf201ec2d404b6ee9d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Himanshu</span>
<span class="date">November 15, 2018 at 6:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454867" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason<br/>
I have few more questions on this.</p>
<p>First: why you assigned “activation = weights[-1]” , why not other weights or any random value.<br/>
Second: why you are looping only for two values<br/>
 for i in range(len(weights) – 1) though we have three values.<br/>
Third: Why you have considered only two outputs here though we have four<br/>
output for layer one =.9643898158763548<br/>
output for layer two =.9185258960543243<br/>
output for layer three = .8094918973879515<br/>
output for layer two = .7734292563511262</p>
<p>why you considered only last two values why not first two or any other combination.</p>
<p>Four: here i guess some problem by mistake you have update wrong value<br/>
expected[row[-1]] = 1<br/>
after this line you have updated expected as [1,0] from [0,0]<br/>
and why we in this i have other question why we are updating this value.</p>
<div class="reply">
<a aria-label="Reply to Himanshu" class="comment-reply-link" href="#comment-454867" onclick='return addComment.moveForm( "comment-454867", "454867", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-454925">
<div class="comment-container" id="li-comment-454925">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 16, 2018 at 6:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-454925" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Too many questions for one comment (I’m a simple human), one at a time and can you please reference specific examples/lines of code otherwise I can’t help.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-454925" onclick='return addComment.moveForm( "comment-454925", "454925", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-455251">
<div class="comment-container" id="li-comment-455251">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b09e3a90a7eb03e595bc85bc56ed779d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b09e3a90a7eb03e595bc85bc56ed779d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Karim</span>
<span class="date">November 18, 2018 at 8:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-455251" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason — How can i add more hidden layers? Thankx</p>
<div class="reply">
<a aria-label="Reply to Karim" class="comment-reply-link" href="#comment-455251" onclick='return addComment.moveForm( "comment-455251", "455251", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-455426">
<div class="comment-container" id="li-comment-455426">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 19, 2018 at 6:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-455426" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I recommend using Keras to develop your network:<br/>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow">https://machinelearningmastery.com/start-here/#deeplearning</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-455426" onclick='return addComment.moveForm( "comment-455426", "455426", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-455842">
<div class="comment-container" id="li-comment-455842">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b7595fa008656daf201ec2d404b6ee9d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b7595fa008656daf201ec2d404b6ee9d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Himanshu</span>
<span class="date">November 22, 2018 at 5:24 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-455842" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>How to apply mathematical implementation of gradient descent and logistic regression,classification  in real time data.<br/>
For example if i want use this in survivors of Titanic data how to start with.</p>
<div class="reply">
<a aria-label="Reply to Himanshu" class="comment-reply-link" href="#comment-455842" onclick='return addComment.moveForm( "comment-455842", "455842", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-455884">
<div class="comment-container" id="li-comment-455884">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 23, 2018 at 7:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-455884" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Here’s an example:<br/>
<a href="https://machinelearningmastery.com/implement-logistic-regression-stochastic-gradient-descent-scratch-python/" rel="nofollow">https://machinelearningmastery.com/implement-logistic-regression-stochastic-gradient-descent-scratch-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-455884" onclick='return addComment.moveForm( "comment-455884", "455884", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-457560">
<div class="comment-container" id="li-comment-457560">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/074558898f91bbddfc6289d40f7a07f8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/074558898f91bbddfc6289d40f7a07f8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">John Sald</span>
<span class="date">December 6, 2018 at 2:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-457560" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, could you show me an example of using one of the extensions you mentioned, which can give us a gain in performance?</p>
<p>Such as using matrix operations (in the weights) and vectors (inputs, intermediate signals and outputs)</p>
<div class="reply">
<a aria-label="Reply to John Sald" class="comment-reply-link" href="#comment-457560" onclick='return addComment.moveForm( "comment-457560", "457560", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-457691">
<div class="comment-container" id="li-comment-457691">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 7, 2018 at 5:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/implement-backpropagation-algorithm-scratch-python/#comment-457691" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the suggestion.</p>
<p>If you’re looking to go deeper into neural nets, I recommend using a library like Keras. You can start here:<br/>
<a href="https://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow">https://machinelearningmastery.com/start-here/#deeplearning</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-457691" onclick='return addComment.moveForm( "comment-457691", "457691", "respond", "3349" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/implement-backpropagation-algorithm-scratch-python/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="3349"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="3967914eb1"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="6"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery!</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Jason Brownlee, PhD
<br/>
I write tutorials to help developers (<i>like you</i>) get results with machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-19"> <div class="textwidget"><p></p><center><br/>
<strong>Code Algorithms From Scratch</strong><br/>
No libraries, just simple Python code.
<p><a href="https://machinelearningmastery.com/machine-learning-algorithms-from-scratch/">Click to Get Started Now!</a><br/>
<a href="/machine-learning-algorithms-from-scratch/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/06/MachineLearningAlgorithmsFromScratch-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch"><img alt="How to Develop a Neural Machine Translation System in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/01/How-to-Develop-a-Neural-Machine-Translation-System-in-Keras-150x150.jpg" title="How to Develop a Neural Machine Translation System from Scratch" width="45"/></a> <a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch">How to Develop a Neural Machine Translation System from Scratch</a>
<span class="meta">January 10, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning"><img alt="Difference Between Classification and Regression in Machine Learning" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/Difference-Between-Classification-and-Regression-in-Machine-Learning-150x150.jpg" title="Difference Between Classification and Regression in Machine Learning" width="45"/></a> <a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning">Difference Between Classification and Regression in Machine Learning</a>
<span class="meta">December 11, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem..."><img alt="So, You are Working on a Machine Learning Problem..." class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/So-You-are-Working-on-a-Machine-Learning-Problem...-150x150.jpg" title="So, You are Working on a Machine Learning Problem..." width="45"/></a> <a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem…">So, You are Working on a Machine Learning Problem…</a>
<span class="meta">April 4, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis"><img alt="Plot of the Multichannel Convolutional Neural Network For Text" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-150x150.png" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis" width="45"/></a> <a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis">How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis</a>
<span class="meta">January 12, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras"><img alt="How to Make Classification and Regression Predictions for Deep Learning Models in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/How-to-Make-Classification-and-Regression-Predictions-for-Deep-Learning-Models-in-Keras-150x150.jpg" title="How to Make Predictions with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras">How to Make Predictions with Keras</a>
<span class="meta">April 9, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)"><img alt="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/11-Classical-Time-Series-Forecasting-Methods-in-Python-Cheat-Sheet-150x150.jpg" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)">11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)</a>
<span class="meta">August 6, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras"><img alt="How to Visualize a Deep Learning Neural Network Model in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/How-to-Visualize-a-Deep-Learning-Neural-Network-Model-in-Keras-150x150.jpg" title="How to Visualize a Deep Learning Neural Network Model in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras">How to Visualize a Deep Learning Neural Network Model in Keras</a>
<span class="meta">December 13, 2017</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> <div class="widget_text widget widget_custom_html" id="custom_html-2"><h3>You might also like…</h3><div class="textwidget custom-html-widget"><ul>
<li><a href="/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Install Python for Machine Learning</a></li>
<li><a href="/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python</a></li>
<li><a href="/tutorial-first-neural-network-python-keras/">Your First Neural Network in Python</a></li>
<li><a href="/how-to-run-your-first-classifier-in-weka/">Your First Classifier in Weka</a></li>
<li><a href="/arima-for-time-series-forecasting-with-python/">Your First Time Series Forecasting Project</a></li>
</ul></div></div></aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/disclaimer/">Disclaimer</a> | 
<a href="/terms-of-service/">Terms</a> | 
<a href="/contact/">Contact</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.8" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.0.5" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.8" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.1" type="text/javascript"></script>
</body>
</html>