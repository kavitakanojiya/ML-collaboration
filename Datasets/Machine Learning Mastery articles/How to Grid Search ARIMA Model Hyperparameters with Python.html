<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v9.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>How to Grid Search ARIMA Model Hyperparameters with Python</title>
<link href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="How to Grid Search ARIMA Model Hyperparameters with Python" property="og:title"/>
<meta content="The ARIMA model for time series analysis and forecasting can be tricky to configure. There are 3 parameters that require estimation by iterative trial and error from reviewing diagnostic plots and using 40-year-old heuristic rules. We can automate the process of evaluating a large number of hyperparameters for the ARIMA model by using a grid …" property="og:description"/>
<meta content="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="https://www.facebook.com/jason.brownlee.39" property="article:author"/>
<meta content="Time Series" property="article:section"/>
<meta content="2017-01-17T18:00:50+00:00" property="article:published_time"/>
<meta content="2017-02-21T05:48:13+00:00" property="article:modified_time"/>
<meta content="2017-02-21T05:48:13+00:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/How-to-Grid-Search-ARIMA-Model-Hyperparameters-with-Python.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/How-to-Grid-Search-ARIMA-Model-Hyperparameters-with-Python.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="428" property="og:image:height"/>
<meta content="How to Grid Search ARIMA Model Hyperparameters with Python" property="og:image:alt"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"https:\/\/machinelearningmastery.com\/#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/feed/" rel="alternate" title="Machine Learning Mastery » How to Grid Search ARIMA Model Hyperparameters with Python Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<style media="all" type="text/css">
.wpautoterms-footer{background-color:#ffffff;text-align:center;}
.wpautoterms-footer a{color:#000000;font-family:Arial, sans-serif;font-size:14px;}
.wpautoterms-footer .separator{color:#cccccc;font-family:Arial, sans-serif;font-size:14px;}</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/auto-terms-of-service-and-privacy-policy/css/wpautoterms.css?ver=4.9.8" id="wpautoterms_css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.0.5" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/css/front.css?ver=2.0.20" id="ssb-front-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/ewd-ufaq-styles.css?ver=4.9.8" id="ewd-ufaq-style-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/rrssb-min.css?ver=4.9.8" id="ewd-ufaq-rrssb-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.8" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=2.0.20" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.8" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.8" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=3642" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fgrid-search-arima-hyperparameters-with-python%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fgrid-search-arima-hyperparameters-with-python%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<style media="screen">

        .simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
      margin: ;
    }
         /*inline margin*/
    
  
  
  
  
  
          .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
         margin: ;
     }

          /*margin-digbar*/

  
  
  
  
 
   
   

</style>
<script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#4c89bf; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#4c89bf;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#4c89bf!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#ffffff;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-3642 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/icon-100x100.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-55"> <div class="textwidget"><p>Want help with time series? <a href="https://machinelearningmastery.lpages.co/tsfwp-mini-course/">Take the FREE Mini-Course</a></p>
</div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<input name="post_type" type="hidden" value="post"/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Main Menu</h3><ul class="nav fl" id="main-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503" id="menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Start Here</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501" id="menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506" id="menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508" id="menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (Keras)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511" id="menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509" id="menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515" id="menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">Deep Learning for NLP</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512" id="menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Understand Algorithms</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507" id="menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms (Python)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6513" id="menu-item-6513"><a href="https://machinelearningmastery.com/category/machine-learning-process/">Machine Learning Process</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516" id="menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517" id="menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522" id="menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6518" id="menu-item-6518"><a href="https://machinelearningmastery.com/category/start-machine-learning/">Getting Started</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510" id="menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519" id="menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistical Methods</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6520" id="menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Time Series (introductory)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523" id="menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6514" id="menu-item-6514"><a href="https://machinelearningmastery.com/category/machine-learning-resources/">Resources</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502" id="menu-item-6502"><a href="https://machinelearningmastery.com/products/">Ebooks</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500" id="menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504" id="menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505" id="menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-3642 post type-post status-publish format-standard has-post-thumbnail hentry category-time-series">
<header>
<h1 class="title entry-title">How to Grid Search ARIMA Model Hyperparameters with Python</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2017-01-18T05:00:50+1100">January 18, 2017</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/time-series/" title="View all items in Time Series">Time Series</a></span> </div>
<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-3642 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Grid+Search+ARIMA+Model+Hyperparameters+with+Python&amp;url=https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
<p>The ARIMA model for time series analysis and forecasting can be tricky to configure.</p>
<p>There are 3 parameters that require estimation by iterative trial and error from reviewing diagnostic plots and using 40-year-old heuristic rules.</p>
<p>We can automate the process of evaluating a large number of hyperparameters for the ARIMA model by using a grid search procedure.</p>
<p>In this tutorial, you will discover how to tune the ARIMA model using a grid search of hyperparameters in Python.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>A general procedure that you can use to tune the ARIMA hyperparameters for a rolling one-step forecast.</li>
<li>How to apply ARIMA hyperparameter optimization on a standard univariate time series dataset.</li>
<li>Ideas for extending the procedure for more elaborate and robust models.</li>
</ul>
<p>Let’s get started.</p>
<div class="wp-caption aligncenter" id="attachment_3643" style="width: 650px"><img alt="How to Grid Search ARIMA Model Hyperparameters with Python" class="size-full wp-image-3643" height="428" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/How-to-Grid-Search-ARIMA-Model-Hyperparameters-with-Python.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/How-to-Grid-Search-ARIMA-Model-Hyperparameters-with-Python.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/01/How-to-Grid-Search-ARIMA-Model-Hyperparameters-with-Python-300x201.jpg 300w" width="640"/><p class="wp-caption-text">How to Grid Search ARIMA Model Hyperparameters with Python<br/>Photo by <a href="https://www.flickr.com/photos/avlxyz/3825340087/">Alpha</a>, some rights reserved.</p></div>
<h2>Grid Searching Method</h2>
<p>Diagnostic plots of the time series can be used along with heuristic rules to determine the hyperparameters of the ARIMA model.</p>
<p>These are good in most, but perhaps not all, situations.</p>
<p>We can automate the process of training and evaluating ARIMA models on different combinations of model hyperparameters. In machine learning this is called a grid search or model tuning.</p>
<p>In this tutorial, we will develop a method to grid search ARIMA hyperparameters for a one-step rolling forecast.</p>
<p>The approach is broken down into two parts:</p>
<ol>
<li>Evaluate an ARIMA model.</li>
<li>Evaluate sets of ARIMA parameters.</li>
</ol>
<p>The code in this tutorial makes use of the scikit-learn, Pandas, and the statsmodels Python libraries.</p>
<p></p><div class="woo-sc-hr"></div>
<center>
<h3>Stop learning Time Series Forecasting the <em>slow way</em>!</h3>
<p>Take my free 7-day email course and discover how to get started (with sample code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.leadpages.co/leadbox/14158d173f72a2%3A164f8be4f346dc/5760744339537920/" style="background: #ffce0a; color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.247059) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.498039) 0px 1px 3px inset, rgba(0, 0, 0, 0.498039) 0px 1px 3px;" target="_blank">Start Your FREE Mini-Course Now!</a><script data-config="%7B%7D" data-leadbox="14158d173f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.leadpages.co/leadbox/14158d173f72a2%3A164f8be4f346dc/5760744339537920/" src="https://machinelearningmastery.leadpages.co/leadbox-1487347410.js" type="text/javascript"></script></p>
</center>
<p></p><div class="woo-sc-hr"></div>
<h3>1. Evaluate ARIMA Model</h3>
<p>We can evaluate an ARIMA model by preparing it on a training dataset and evaluating predictions on a test dataset.</p>
<p>This approach involves the following steps:</p>
<ol>
<li>Split the dataset into training and test sets.</li>
<li>Walk the time steps in the test dataset.
<ol>
<li>Train an ARIMA model.</li>
<li>Make a one-step prediction.</li>
<li>Store prediction; get and store actual observation.</li>
</ol>
</li>
<li>Calculate error score for predictions compared to expected values.</li>
</ol>
<p>We can implement this in Python as a new standalone function called <em>evaluate_arima_model()</em> that takes a time series dataset as input as well as a tuple with the <em>p</em>, <em>d</em>, and <em>q</em> parameters for the model to be evaluated.</p>
<p>The dataset is split in two: 66% for the initial training dataset and the remaining 34% for the test dataset.</p>
<p>Each time step of the test set is iterated. Just one iteration provides a model that you could use to make predictions on new data. The iterative approach allows a new ARIMA model to be trained each time step.</p>
<p>A prediction is made each iteration and stored in a list. This is so that at the end of the test set, all predictions can be compared to the list of expected values and an error score calculated. In this case, a mean squared error score is calculated and returned.</p>
<p>The complete function is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9ebc93d66219054422" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# evaluate an ARIMA model for a given order (p,d,q)
def evaluate_arima_model(X, arima_order):
	# prepare training dataset
	train_size = int(len(X) * 0.66)
	train, test = X[0:train_size], X[train_size:]
	history = [x for x in train]
	# make predictions
	predictions = list()
	for t in range(len(test)):
		model = ARIMA(history, order=arima_order)
		model_fit = model.fit(disp=0)
		yhat = model_fit.forecast()[0]
		predictions.append(yhat)
		history.append(test[t])
	# calculate out of sample error
	error = mean_squared_error(test, predictions)
	return error</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9ebc93d66219054422-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d66219054422-2">2</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d66219054422-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d66219054422-4">4</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d66219054422-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d66219054422-6">6</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d66219054422-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d66219054422-8">8</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d66219054422-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d66219054422-10">10</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d66219054422-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d66219054422-12">12</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d66219054422-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d66219054422-14">14</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d66219054422-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d66219054422-16">16</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d66219054422-17">17</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9ebc93d66219054422-1"><span class="crayon-p"># evaluate an ARIMA model for a given order (p,d,q)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d66219054422-2"><span class="crayon-e">def </span><span class="crayon-e">evaluate_arima_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">arima_order</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d66219054422-3"><span class="crayon-h"> </span><span class="crayon-p"># prepare training dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d66219054422-4"><span class="crayon-h"> </span><span class="crayon-v">train_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.66</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d66219054422-5"><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">train_size</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">train_size</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d66219054422-6"><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d66219054422-7"><span class="crayon-h"> </span><span class="crayon-p"># make predictions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d66219054422-8"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d66219054422-9"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">t</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d66219054422-10"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ARIMA</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">order</span><span class="crayon-o">=</span><span class="crayon-v">arima_order</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d66219054422-11"><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">disp</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d66219054422-12"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-sy">.</span><span class="crayon-e">forecast</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d66219054422-13"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d66219054422-14"><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-v">t</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d66219054422-15"><span class="crayon-h"> </span><span class="crayon-p"># calculate out of sample error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d66219054422-16"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d66219054422-17"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">error</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>Now that we know how to evaluate one set of ARIMA hyperparameters, let’s see how we can call this function repeatedly for a grid of parameters to evaluate.</p>
<h3>2. Iterate ARIMA Parameters</h3>
<p>Evaluating a suite of parameters is relatively straightforward.</p>
<p>The user must specify a grid of <em>p</em>, <em>d</em>, and <em>q</em> ARIMA parameters to iterate. A model is created for each parameter and its performance evaluated by calling the <em>evaluate_arima_model()</em> function described in the previous section.</p>
<p>The function must keep track of the lowest error score observed and the configuration that caused it. This can be summarized at the end of the function with a print to standard out.</p>
<p>We can implement this function called <em>evaluate_models()</em> as a series of four loops.</p>
<p>There are two additional considerations. The first is to ensure the input data are floating point values (as opposed to integers or strings), as this can cause the ARIMA procedure to fail.</p>
<p>Second, the statsmodels ARIMA procedure internally uses numerical optimization procedures to find a set of coefficients for the model. These procedures can fail, which in turn can throw an exception. We must catch these exceptions and skip those configurations that cause a problem. This happens more often then you would think.</p>
<p>Additionally, it is recommended that warnings be ignored for this code to avoid a lot of noise from running the procedure. This can be done as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9ebc93d6e966747921" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
import warnings
warnings.filterwarnings("ignore")</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9ebc93d6e966747921-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d6e966747921-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9ebc93d6e966747921-1"><span class="crayon-e">import </span><span class="crayon-e">warnings</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d6e966747921-2"><span class="crayon-v">warnings</span><span class="crayon-sy">.</span><span class="crayon-e">filterwarnings</span><span class="crayon-sy">(</span><span class="crayon-s">"ignore"</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Finally, even with all of these protections, the underlying C and Fortran libraries may still report warnings to standard out, such as:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9ebc93d70727115672" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
** On entry to DLASCL, parameter number 4 had an illegal value</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9ebc93d70727115672-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9ebc93d70727115672-1">** On entry to DLASCL, parameter number 4 had an illegal value</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>These have been removed from the results reported in this tutorial for brevity.</p>
<p>The complete procedure for evaluating a grid of ARIMA hyperparameters is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9ebc93d72494570100" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# evaluate combinations of p, d and q values for an ARIMA model
def evaluate_models(dataset, p_values, d_values, q_values):
	dataset = dataset.astype('float32')
	best_score, best_cfg = float("inf"), None
	for p in p_values:
		for d in d_values:
			for q in q_values:
				order = (p,d,q)
				try:
					mse = evaluate_arima_model(dataset, order)
					if mse &lt; best_score:
						best_score, best_cfg = mse, order
					print('ARIMA%s MSE=%.3f' % (order,mse))
				except:
					continue
	print('Best ARIMA%s MSE=%.3f' % (best_cfg, best_score))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9ebc93d72494570100-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d72494570100-2">2</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d72494570100-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d72494570100-4">4</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d72494570100-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d72494570100-6">6</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d72494570100-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d72494570100-8">8</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d72494570100-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d72494570100-10">10</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d72494570100-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d72494570100-12">12</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d72494570100-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d72494570100-14">14</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d72494570100-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d72494570100-16">16</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9ebc93d72494570100-1"><span class="crayon-p"># evaluate combinations of p, d and q values for an ARIMA model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d72494570100-2"><span class="crayon-e">def </span><span class="crayon-e">evaluate_models</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">q_values</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d72494570100-3"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d72494570100-4"><span class="crayon-h"> </span><span class="crayon-v">best_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">best_cfg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-s">"inf"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d72494570100-5"><span class="crayon-e"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">p</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">p_values</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d72494570100-6"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">d_values</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d72494570100-7"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">q</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">q_values</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d72494570100-8"><span class="crayon-h"> </span><span class="crayon-v">order</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-v">q</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d72494570100-9"><span class="crayon-h"> </span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d72494570100-10"><span class="crayon-h"> </span><span class="crayon-v">mse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_arima_model</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">order</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d72494570100-11"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">mse</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">best_score</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d72494570100-12"><span class="crayon-h"> </span><span class="crayon-v">best_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">best_cfg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mse</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">order</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d72494570100-13"><span class="crayon-e"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'ARIMA%s MSE=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">order</span><span class="crayon-sy">,</span><span class="crayon-v">mse</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d72494570100-14"><span class="crayon-h"> </span><span class="crayon-v">except</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d72494570100-15"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d72494570100-16"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Best ARIMA%s MSE=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">best_cfg</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">best_score</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0010 seconds] -->
<p>Now that we have a procedure to grid search ARIMA hyperparameters, let’s test the procedure on two univariate time series problems.</p>
<p>We will start with the Shampoo Sales dataset.</p>
<h2>Shampoo Sales Case Study</h2>
<p>The Shampoo Sales dataset describes the monthly number of sales of shampoo over a 3-year period.</p>
<p>The units are a sales count and there are 36 observations. The original dataset is credited to Makridakis, Wheelwright, and Hyndman (1998).</p>
<p><a href="https://datamarket.com/data/set/22r0/sales-of-shampoo-over-a-three-year-period">Learn more about the dataset from here</a>.</p>
<p>Download the dataset and place it into your current working directory with the filename “<em>shampoo-sales.csv</em>“.</p>
<p>The timestamps in the time series do not contain an absolute year component. We can use a custom date-parsing function when loading the data and baseline the year from 1900, as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9ebc93d74351998740" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load dataset
def parser(x):
	return datetime.strptime('190'+x, '%Y-%m')
series = read_csv('shampoo-sales.csv', header=0, parse_dates=[0], index_col=0, squeeze=True, date_parser=parser)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9ebc93d74351998740-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d74351998740-2">2</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d74351998740-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d74351998740-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9ebc93d74351998740-1"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d74351998740-2"><span class="crayon-e">def </span><span class="crayon-e">parser</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d74351998740-3"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">datetime</span><span class="crayon-sy">.</span><span class="crayon-e">strptime</span><span class="crayon-sy">(</span><span class="crayon-s">'190'</span><span class="crayon-o">+</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'%Y-%m'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d74351998740-4"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'shampoo-sales.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">parse_dates</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">squeeze</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">date_parser</span><span class="crayon-o">=</span><span class="crayon-v">parser</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>Once loaded, we can specify a site of <em>p</em>, <em>d</em>, and <em>q</em> values to search and pass them to the <em>evaluate_models()</em> function.</p>
<p>We will try a suite of lag values (<em>p</em>) and just a few difference iterations (<em>d</em>) and residual error lag values (<em>q</em>).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9ebc93d78161670965" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# evaluate parameters
p_values = [0, 1, 2, 4, 6, 8, 10]
d_values = range(0, 3)
q_values = range(0, 3)
warnings.filterwarnings("ignore")
evaluate_models(series.values, p_values, d_values, q_values)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9ebc93d78161670965-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d78161670965-2">2</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d78161670965-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d78161670965-4">4</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d78161670965-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d78161670965-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9ebc93d78161670965-1"><span class="crayon-p"># evaluate parameters</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d78161670965-2"><span class="crayon-v">p_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d78161670965-3"><span class="crayon-v">d_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d78161670965-4"><span class="crayon-v">q_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d78161670965-5"><span class="crayon-v">warnings</span><span class="crayon-sy">.</span><span class="crayon-e">filterwarnings</span><span class="crayon-sy">(</span><span class="crayon-s">"ignore"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d78161670965-6"><span class="crayon-e">evaluate_models</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">q_values</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Putting this all together with the generic procedures defined in the previous section, we can grid search ARIMA hyperparameters in the Shampoo Sales dataset.</p>
<p>The complete code example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9ebc93d7a937212012" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
import warnings
from pandas import read_csv
from pandas import datetime
from statsmodels.tsa.arima_model import ARIMA
from sklearn.metrics import mean_squared_error

# evaluate an ARIMA model for a given order (p,d,q)
def evaluate_arima_model(X, arima_order):
	# prepare training dataset
	train_size = int(len(X) * 0.66)
	train, test = X[0:train_size], X[train_size:]
	history = [x for x in train]
	# make predictions
	predictions = list()
	for t in range(len(test)):
		model = ARIMA(history, order=arima_order)
		model_fit = model.fit(disp=0)
		yhat = model_fit.forecast()[0]
		predictions.append(yhat)
		history.append(test[t])
	# calculate out of sample error
	error = mean_squared_error(test, predictions)
	return error

# evaluate combinations of p, d and q values for an ARIMA model
def evaluate_models(dataset, p_values, d_values, q_values):
	dataset = dataset.astype('float32')
	best_score, best_cfg = float("inf"), None
	for p in p_values:
		for d in d_values:
			for q in q_values:
				order = (p,d,q)
				try:
					mse = evaluate_arima_model(dataset, order)
					if mse &lt; best_score:
						best_score, best_cfg = mse, order
					print('ARIMA%s MSE=%.3f' % (order,mse))
				except:
					continue
	print('Best ARIMA%s MSE=%.3f' % (best_cfg, best_score))

# load dataset
def parser(x):
	return datetime.strptime('190'+x, '%Y-%m')
series = read_csv('shampoo-sales.csv', header=0, parse_dates=[0], index_col=0, squeeze=True, date_parser=parser)
# evaluate parameters
p_values = [0, 1, 2, 4, 6, 8, 10]
d_values = range(0, 3)
q_values = range(0, 3)
warnings.filterwarnings("ignore")
evaluate_models(series.values, p_values, d_values, q_values)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-2">2</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-4">4</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-6">6</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-8">8</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-10">10</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-12">12</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-14">14</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-16">16</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-18">18</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-20">20</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-22">22</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-24">24</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-26">26</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-28">28</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-30">30</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-32">32</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-34">34</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-36">36</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-38">38</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-40">40</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-42">42</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-44">44</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-46">46</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-48">48</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7a937212012-50">50</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7a937212012-51">51</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-1"><span class="crayon-e">import </span><span class="crayon-e">warnings</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">read_csv</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-3"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">datetime</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-4"><span class="crayon-e">from </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">tsa</span><span class="crayon-sy">.</span><span class="crayon-e">arima_model </span><span class="crayon-e">import </span><span class="crayon-e">ARIMA</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-5"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-v">mean_squared_error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-6"> </div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-7"><span class="crayon-p"># evaluate an ARIMA model for a given order (p,d,q)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-8"><span class="crayon-e">def </span><span class="crayon-e">evaluate_arima_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">arima_order</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-9"><span class="crayon-h"> </span><span class="crayon-p"># prepare training dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-10"><span class="crayon-h"> </span><span class="crayon-v">train_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.66</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-11"><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">train_size</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">train_size</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-12"><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-13"><span class="crayon-h"> </span><span class="crayon-p"># make predictions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-14"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-15"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">t</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-16"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ARIMA</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">order</span><span class="crayon-o">=</span><span class="crayon-v">arima_order</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-17"><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">disp</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-18"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-sy">.</span><span class="crayon-e">forecast</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-19"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-20"><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-v">t</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-21"><span class="crayon-h"> </span><span class="crayon-p"># calculate out of sample error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-22"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-23"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-24"> </div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-25"><span class="crayon-p"># evaluate combinations of p, d and q values for an ARIMA model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-26"><span class="crayon-e">def </span><span class="crayon-e">evaluate_models</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">q_values</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-27"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-28"><span class="crayon-h"> </span><span class="crayon-v">best_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">best_cfg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-s">"inf"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-29"><span class="crayon-e"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">p</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">p_values</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-30"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">d_values</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-31"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">q</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">q_values</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-32"><span class="crayon-h"> </span><span class="crayon-v">order</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-v">q</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-33"><span class="crayon-h"> </span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-34"><span class="crayon-h"> </span><span class="crayon-v">mse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_arima_model</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">order</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-35"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">mse</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">best_score</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-36"><span class="crayon-h"> </span><span class="crayon-v">best_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">best_cfg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mse</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">order</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-37"><span class="crayon-e"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'ARIMA%s MSE=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">order</span><span class="crayon-sy">,</span><span class="crayon-v">mse</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-38"><span class="crayon-h"> </span><span class="crayon-v">except</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-39"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-40"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Best ARIMA%s MSE=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">best_cfg</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">best_score</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-41"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-42"><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-43"><span class="crayon-e">def </span><span class="crayon-e">parser</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-44"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">datetime</span><span class="crayon-sy">.</span><span class="crayon-e">strptime</span><span class="crayon-sy">(</span><span class="crayon-s">'190'</span><span class="crayon-o">+</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'%Y-%m'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-45"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'shampoo-sales.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">parse_dates</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">squeeze</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">date_parser</span><span class="crayon-o">=</span><span class="crayon-v">parser</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-46"><span class="crayon-p"># evaluate parameters</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-47"><span class="crayon-v">p_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-48"><span class="crayon-v">d_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-49"><span class="crayon-v">q_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7a937212012-50"><span class="crayon-v">warnings</span><span class="crayon-sy">.</span><span class="crayon-e">filterwarnings</span><span class="crayon-sy">(</span><span class="crayon-s">"ignore"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d7a937212012-51"><span class="crayon-e">evaluate_models</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">q_values</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0029 seconds] -->
<p>Running the example prints the ARIMA parameters and MSE for each successful evaluation completed.</p>
<p>The best parameters of ARIMA(4, 2, 1) are reported at the end of the run with a mean squared error of 4,694.873.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9ebc93d7c300820243" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
ARIMA(0, 0, 0) MSE=52425.268
ARIMA(0, 0, 1) MSE=38145.167
ARIMA(0, 0, 2) MSE=23989.567
ARIMA(0, 1, 0) MSE=18003.173
ARIMA(0, 1, 1) MSE=9558.410
ARIMA(0, 2, 0) MSE=67339.808
ARIMA(0, 2, 1) MSE=18323.163
ARIMA(1, 0, 0) MSE=23112.958
ARIMA(1, 1, 0) MSE=7121.373
ARIMA(1, 1, 1) MSE=7003.683
ARIMA(1, 2, 0) MSE=18607.980
ARIMA(2, 1, 0) MSE=5689.932
ARIMA(2, 1, 1) MSE=7759.707
ARIMA(2, 2, 0) MSE=9860.948
ARIMA(4, 1, 0) MSE=6649.594
ARIMA(4, 1, 1) MSE=6796.279
ARIMA(4, 2, 0) MSE=7596.332
ARIMA(4, 2, 1) MSE=4694.873
ARIMA(6, 1, 0) MSE=6810.080
ARIMA(6, 2, 0) MSE=6261.107
ARIMA(8, 0, 0) MSE=7256.028
ARIMA(8, 1, 0) MSE=6579.403
Best ARIMA(4, 2, 1) MSE=4694.873</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9ebc93d7c300820243-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7c300820243-2">2</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7c300820243-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7c300820243-4">4</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7c300820243-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7c300820243-6">6</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7c300820243-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7c300820243-8">8</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7c300820243-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7c300820243-10">10</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7c300820243-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7c300820243-12">12</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7c300820243-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7c300820243-14">14</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7c300820243-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7c300820243-16">16</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7c300820243-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7c300820243-18">18</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7c300820243-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7c300820243-20">20</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7c300820243-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7c300820243-22">22</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d7c300820243-23">23</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9ebc93d7c300820243-1">ARIMA(0, 0, 0) MSE=52425.268</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7c300820243-2">ARIMA(0, 0, 1) MSE=38145.167</div><div class="crayon-line" id="crayon-5c0c9ebc93d7c300820243-3">ARIMA(0, 0, 2) MSE=23989.567</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7c300820243-4">ARIMA(0, 1, 0) MSE=18003.173</div><div class="crayon-line" id="crayon-5c0c9ebc93d7c300820243-5">ARIMA(0, 1, 1) MSE=9558.410</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7c300820243-6">ARIMA(0, 2, 0) MSE=67339.808</div><div class="crayon-line" id="crayon-5c0c9ebc93d7c300820243-7">ARIMA(0, 2, 1) MSE=18323.163</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7c300820243-8">ARIMA(1, 0, 0) MSE=23112.958</div><div class="crayon-line" id="crayon-5c0c9ebc93d7c300820243-9">ARIMA(1, 1, 0) MSE=7121.373</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7c300820243-10">ARIMA(1, 1, 1) MSE=7003.683</div><div class="crayon-line" id="crayon-5c0c9ebc93d7c300820243-11">ARIMA(1, 2, 0) MSE=18607.980</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7c300820243-12">ARIMA(2, 1, 0) MSE=5689.932</div><div class="crayon-line" id="crayon-5c0c9ebc93d7c300820243-13">ARIMA(2, 1, 1) MSE=7759.707</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7c300820243-14">ARIMA(2, 2, 0) MSE=9860.948</div><div class="crayon-line" id="crayon-5c0c9ebc93d7c300820243-15">ARIMA(4, 1, 0) MSE=6649.594</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7c300820243-16">ARIMA(4, 1, 1) MSE=6796.279</div><div class="crayon-line" id="crayon-5c0c9ebc93d7c300820243-17">ARIMA(4, 2, 0) MSE=7596.332</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7c300820243-18">ARIMA(4, 2, 1) MSE=4694.873</div><div class="crayon-line" id="crayon-5c0c9ebc93d7c300820243-19">ARIMA(6, 1, 0) MSE=6810.080</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7c300820243-20">ARIMA(6, 2, 0) MSE=6261.107</div><div class="crayon-line" id="crayon-5c0c9ebc93d7c300820243-21">ARIMA(8, 0, 0) MSE=7256.028</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7c300820243-22">ARIMA(8, 1, 0) MSE=6579.403</div><div class="crayon-line" id="crayon-5c0c9ebc93d7c300820243-23">Best ARIMA(4, 2, 1) MSE=4694.873</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p></p>
<h2>Daily Female Births Case Study</h2>
<p>The Daily Female Births dataset describes the number of daily female births in California in 1959.</p>
<p>The units are a count and there are 365 observations. The source of the dataset is credited to Newton (1988).</p>
<p><a href="https://datamarket.com/data/set/235k/daily-total-female-births-in-california-1959">Learn more about the dataset here</a>.</p>
<p>Download the dataset and place it in your current working directory with the filename “<em>daily-total-female-births.csv</em>“.</p>
<p>This dataset can be easily loaded directly as a Pandas Series.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9ebc93d7e677140011" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load dataset
series = Series.from_csv('daily-total-female-births.csv', header=0)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9ebc93d7e677140011-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d7e677140011-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9ebc93d7e677140011-1"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d7e677140011-2"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Series</span><span class="crayon-sy">.</span><span class="crayon-e">from_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'daily-total-female-births.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>To keep things simple, we will explore the same grid of ARIMA hyperparameters as in the previous section.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9ebc93d80087439704" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# evaluate parameters
p_values = [0, 1, 2, 4, 6, 8, 10]
d_values = range(0, 3)
q_values = range(0, 3)
warnings.filterwarnings("ignore")
evaluate_models(series.values, p_values, d_values, q_values)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9ebc93d80087439704-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d80087439704-2">2</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d80087439704-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d80087439704-4">4</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d80087439704-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d80087439704-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9ebc93d80087439704-1"><span class="crayon-p"># evaluate parameters</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d80087439704-2"><span class="crayon-v">p_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d80087439704-3"><span class="crayon-v">d_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d80087439704-4"><span class="crayon-v">q_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d80087439704-5"><span class="crayon-v">warnings</span><span class="crayon-sy">.</span><span class="crayon-e">filterwarnings</span><span class="crayon-sy">(</span><span class="crayon-s">"ignore"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d80087439704-6"><span class="crayon-e">evaluate_models</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">q_values</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>Putting this all together, we can grid search ARIMA parameters on the Daily Female Births dataset. The complete code listing is provided below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9ebc93d81723497349" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
import warnings
from pandas import Series
from statsmodels.tsa.arima_model import ARIMA
from sklearn.metrics import mean_squared_error

# evaluate an ARIMA model for a given order (p,d,q)
def evaluate_arima_model(X, arima_order):
	# prepare training dataset
	train_size = int(len(X) * 0.66)
	train, test = X[0:train_size], X[train_size:]
	history = [x for x in train]
	# make predictions
	predictions = list()
	for t in range(len(test)):
		model = ARIMA(history, order=arima_order)
		model_fit = model.fit(disp=0)
		yhat = model_fit.forecast()[0]
		predictions.append(yhat)
		history.append(test[t])
	# calculate out of sample error
	error = mean_squared_error(test, predictions)
	return error

# evaluate combinations of p, d and q values for an ARIMA model
def evaluate_models(dataset, p_values, d_values, q_values):
	dataset = dataset.astype('float32')
	best_score, best_cfg = float("inf"), None
	for p in p_values:
		for d in d_values:
			for q in q_values:
				order = (p,d,q)
				try:
					mse = evaluate_arima_model(dataset, order)
					if mse &lt; best_score:
						best_score, best_cfg = mse, order
					print('ARIMA%s MSE=%.3f' % (order,mse))
				except:
					continue
	print('Best ARIMA%s MSE=%.3f' % (best_cfg, best_score))

# load dataset
series = Series.from_csv('daily-total-female-births.csv', header=0)
# evaluate parameters
p_values = [0, 1, 2, 4, 6, 8, 10]
d_values = range(0, 3)
q_values = range(0, 3)
warnings.filterwarnings("ignore")
evaluate_models(series.values, p_values, d_values, q_values)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-2">2</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-4">4</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-6">6</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-8">8</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-10">10</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-12">12</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-14">14</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-16">16</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-18">18</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-20">20</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-22">22</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-24">24</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-26">26</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-28">28</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-30">30</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-32">32</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-34">34</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-36">36</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-38">38</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-40">40</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-42">42</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-44">44</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-46">46</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d81723497349-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d81723497349-48">48</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-1"><span class="crayon-e">import </span><span class="crayon-e">warnings</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-2"><span class="crayon-e">from </span><span class="crayon-e">pandas </span><span class="crayon-e">import </span><span class="crayon-e">Series</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-3"><span class="crayon-e">from </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">tsa</span><span class="crayon-sy">.</span><span class="crayon-e">arima_model </span><span class="crayon-e">import </span><span class="crayon-e">ARIMA</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-4"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-v">mean_squared_error</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-5"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-6"><span class="crayon-p"># evaluate an ARIMA model for a given order (p,d,q)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-7"><span class="crayon-e">def </span><span class="crayon-e">evaluate_arima_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">arima_order</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-8"><span class="crayon-h"> </span><span class="crayon-p"># prepare training dataset</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-9"><span class="crayon-h"> </span><span class="crayon-v">train_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.66</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-10"><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">train_size</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">train_size</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-11"><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-12"><span class="crayon-h"> </span><span class="crayon-p"># make predictions</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-13"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-14"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">t</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-15"><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ARIMA</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">order</span><span class="crayon-o">=</span><span class="crayon-v">arima_order</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-16"><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">disp</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-17"><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-sy">.</span><span class="crayon-e">forecast</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-18"><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-19"><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-v">t</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-20"><span class="crayon-h"> </span><span class="crayon-p"># calculate out of sample error</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-21"><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-22"><span class="crayon-h"> </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">error</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-23"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-24"><span class="crayon-p"># evaluate combinations of p, d and q values for an ARIMA model</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-25"><span class="crayon-e">def </span><span class="crayon-e">evaluate_models</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">q_values</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-26"><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-27"><span class="crayon-h"> </span><span class="crayon-v">best_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">best_cfg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-s">"inf"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">None</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-28"><span class="crayon-e"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">p</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">p_values</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-29"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">d_values</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-30"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">q</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">q_values</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-31"><span class="crayon-h"> </span><span class="crayon-v">order</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-v">d</span><span class="crayon-sy">,</span><span class="crayon-v">q</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-32"><span class="crayon-h"> </span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-33"><span class="crayon-h"> </span><span class="crayon-v">mse</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">evaluate_arima_model</span><span class="crayon-sy">(</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">order</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-34"><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">mse</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">best_score</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-35"><span class="crayon-h"> </span><span class="crayon-v">best_score</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">best_cfg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mse</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">order</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-36"><span class="crayon-e"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'ARIMA%s MSE=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">order</span><span class="crayon-sy">,</span><span class="crayon-v">mse</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-37"><span class="crayon-h"> </span><span class="crayon-v">except</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-38"><span class="crayon-h"> </span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-39"><span class="crayon-h"> </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Best ARIMA%s MSE=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">best_cfg</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">best_score</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-40"> </div><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-41"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-42"><span class="crayon-v">series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Series</span><span class="crayon-sy">.</span><span class="crayon-e">from_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'daily-total-female-births.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-43"><span class="crayon-p"># evaluate parameters</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-44"><span class="crayon-v">p_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-45"><span class="crayon-v">d_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-46"><span class="crayon-v">q_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc93d81723497349-47"><span class="crayon-v">warnings</span><span class="crayon-sy">.</span><span class="crayon-e">filterwarnings</span><span class="crayon-sy">(</span><span class="crayon-s">"ignore"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d81723497349-48"><span class="crayon-e">evaluate_models</span><span class="crayon-sy">(</span><span class="crayon-v">series</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">p_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">d_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">q_values</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0026 seconds] -->
<p>Running the example prints the ARIMA parameters and mean squared error for each configuration successfully evaluated.</p>
<p>The best mean parameters are reported as ARIMA(6, 1, 0) with a mean squared error of 53.187.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9ebc93d83596903945" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
ARIMA(0, 0, 0) MSE=67.063
ARIMA(0, 0, 1) MSE=62.165
ARIMA(0, 0, 2) MSE=60.386
ARIMA(0, 1, 0) MSE=84.038
ARIMA(0, 1, 1) MSE=56.653
ARIMA(0, 1, 2) MSE=55.272
ARIMA(0, 2, 0) MSE=246.414
ARIMA(0, 2, 1) MSE=84.659
ARIMA(1, 0, 0) MSE=60.876
ARIMA(1, 1, 0) MSE=65.928
ARIMA(1, 1, 1) MSE=55.129
ARIMA(1, 1, 2) MSE=55.197
ARIMA(1, 2, 0) MSE=143.755
ARIMA(2, 0, 0) MSE=59.251
ARIMA(2, 1, 0) MSE=59.487
ARIMA(2, 1, 1) MSE=55.013
ARIMA(2, 2, 0) MSE=107.600
ARIMA(4, 0, 0) MSE=59.189
ARIMA(4, 1, 0) MSE=57.428
ARIMA(4, 1, 1) MSE=55.862
ARIMA(4, 2, 0) MSE=80.207
ARIMA(6, 0, 0) MSE=58.773
ARIMA(6, 1, 0) MSE=53.187
ARIMA(6, 1, 1) MSE=57.055
ARIMA(6, 2, 0) MSE=69.753
ARIMA(8, 0, 0) MSE=56.984
ARIMA(8, 1, 0) MSE=57.290
ARIMA(8, 2, 0) MSE=66.034
ARIMA(8, 2, 1) MSE=57.884
ARIMA(10, 0, 0) MSE=57.470
ARIMA(10, 1, 0) MSE=57.359
ARIMA(10, 2, 0) MSE=65.503
ARIMA(10, 2, 1) MSE=57.878
ARIMA(10, 2, 2) MSE=58.309
Best ARIMA(6, 1, 0) MSE=53.187</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9ebc93d83596903945-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d83596903945-2">2</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d83596903945-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d83596903945-4">4</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d83596903945-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d83596903945-6">6</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d83596903945-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d83596903945-8">8</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d83596903945-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d83596903945-10">10</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d83596903945-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d83596903945-12">12</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d83596903945-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d83596903945-14">14</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d83596903945-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d83596903945-16">16</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d83596903945-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d83596903945-18">18</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d83596903945-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d83596903945-20">20</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d83596903945-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d83596903945-22">22</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d83596903945-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d83596903945-24">24</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d83596903945-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d83596903945-26">26</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d83596903945-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d83596903945-28">28</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d83596903945-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d83596903945-30">30</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d83596903945-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d83596903945-32">32</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d83596903945-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc93d83596903945-34">34</div><div class="crayon-num" data-line="crayon-5c0c9ebc93d83596903945-35">35</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9ebc93d83596903945-1">ARIMA(0, 0, 0) MSE=67.063</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d83596903945-2">ARIMA(0, 0, 1) MSE=62.165</div><div class="crayon-line" id="crayon-5c0c9ebc93d83596903945-3">ARIMA(0, 0, 2) MSE=60.386</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d83596903945-4">ARIMA(0, 1, 0) MSE=84.038</div><div class="crayon-line" id="crayon-5c0c9ebc93d83596903945-5">ARIMA(0, 1, 1) MSE=56.653</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d83596903945-6">ARIMA(0, 1, 2) MSE=55.272</div><div class="crayon-line" id="crayon-5c0c9ebc93d83596903945-7">ARIMA(0, 2, 0) MSE=246.414</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d83596903945-8">ARIMA(0, 2, 1) MSE=84.659</div><div class="crayon-line" id="crayon-5c0c9ebc93d83596903945-9">ARIMA(1, 0, 0) MSE=60.876</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d83596903945-10">ARIMA(1, 1, 0) MSE=65.928</div><div class="crayon-line" id="crayon-5c0c9ebc93d83596903945-11">ARIMA(1, 1, 1) MSE=55.129</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d83596903945-12">ARIMA(1, 1, 2) MSE=55.197</div><div class="crayon-line" id="crayon-5c0c9ebc93d83596903945-13">ARIMA(1, 2, 0) MSE=143.755</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d83596903945-14">ARIMA(2, 0, 0) MSE=59.251</div><div class="crayon-line" id="crayon-5c0c9ebc93d83596903945-15">ARIMA(2, 1, 0) MSE=59.487</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d83596903945-16">ARIMA(2, 1, 1) MSE=55.013</div><div class="crayon-line" id="crayon-5c0c9ebc93d83596903945-17">ARIMA(2, 2, 0) MSE=107.600</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d83596903945-18">ARIMA(4, 0, 0) MSE=59.189</div><div class="crayon-line" id="crayon-5c0c9ebc93d83596903945-19">ARIMA(4, 1, 0) MSE=57.428</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d83596903945-20">ARIMA(4, 1, 1) MSE=55.862</div><div class="crayon-line" id="crayon-5c0c9ebc93d83596903945-21">ARIMA(4, 2, 0) MSE=80.207</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d83596903945-22">ARIMA(6, 0, 0) MSE=58.773</div><div class="crayon-line" id="crayon-5c0c9ebc93d83596903945-23">ARIMA(6, 1, 0) MSE=53.187</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d83596903945-24">ARIMA(6, 1, 1) MSE=57.055</div><div class="crayon-line" id="crayon-5c0c9ebc93d83596903945-25">ARIMA(6, 2, 0) MSE=69.753</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d83596903945-26">ARIMA(8, 0, 0) MSE=56.984</div><div class="crayon-line" id="crayon-5c0c9ebc93d83596903945-27">ARIMA(8, 1, 0) MSE=57.290</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d83596903945-28">ARIMA(8, 2, 0) MSE=66.034</div><div class="crayon-line" id="crayon-5c0c9ebc93d83596903945-29">ARIMA(8, 2, 1) MSE=57.884</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d83596903945-30">ARIMA(10, 0, 0) MSE=57.470</div><div class="crayon-line" id="crayon-5c0c9ebc93d83596903945-31">ARIMA(10, 1, 0) MSE=57.359</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d83596903945-32">ARIMA(10, 2, 0) MSE=65.503</div><div class="crayon-line" id="crayon-5c0c9ebc93d83596903945-33">ARIMA(10, 2, 1) MSE=57.878</div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc93d83596903945-34">ARIMA(10, 2, 2) MSE=58.309</div><div class="crayon-line" id="crayon-5c0c9ebc93d83596903945-35">Best ARIMA(6, 1, 0) MSE=53.187</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>Extensions</h2>
<p>The grid search method used in this tutorial is simple and can easily be extended.</p>
<p>This section lists some ideas to extend the approach you may wish to explore.</p>
<ul>
<li><strong>Seed Grid</strong>. The classical diagnostic tools of ACF and PACF plots can still be used with the results used to seed the grid of ARIMA parameters to search.</li>
<li><strong>Alternate Measures</strong>. The search seeks to optimize the out-of-sample mean squared error. This could be changed to another out-of-sample statistic, an in-sample statistic, such as AIC or BIC, or some combination of the two. You can choose a metric that is most meaningful on your project.</li>
<li><strong>Residual Diagnostics</strong>. Statistics can automatically be calculated on the residual forecast errors to provide an additional indication of the quality of the fit. Examples include statistical tests for whether the distribution of residuals is Gaussian and whether there is an autocorrelation in the residuals.</li>
<li><strong>Update Model</strong>. The ARIMA model is created from scratch for each one-step forecast. With careful inspection of the API, it may be possible to update the internal data of the model with new observations rather than recreating it from scratch.</li>
<li><strong>Preconditions</strong>. The ARIMA model can make assumptions about the time series dataset, such as normality and stationarity. These could be checked and a warning raised for a given of a dataset prior to a given model being trained.</li>
</ul>
<h2>Summary</h2>
<p>In this tutorial, you discovered how to grid search the hyperparameters for the ARIMA model in Python.</p>
<p>Specifically, you learned:</p>
<ul>
<li>A procedure that you can use to grid search ARIMA hyperparameters for a one-step rolling forecast.</li>
<li>How to apply ARIMA hyperparameters tuning on standard univariate time series datasets.</li>
<li>Ideas on how to further improve grid searching of ARIMA hyperparameters.</li>
</ul>
<p>Now it’s your turn.</p>
<p>Try this procedure on your favorite time series dataset. What results did you get?<br/>
Report your results in the comments below.</p>
<p>Do you have any questions?<br/>
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="awac-wrapper"><div class="awac widget text-26"> <div class="textwidget"><p></p><center>
<div class="woo-sc-hr"></div>
<h2>Want to Develop Time Series Forecasts with Python?</h2>
<p><a href="/introduction-to-time-series-forecasting-with-python/"><img align="left" alt="Introduction to Time Series Forecasting With Python" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/02/Introduction-to-Time-Series-Forecasting-With-Python-220.png" style="border: 0;"/></a></p>
<h4>Develop Your Own Forecasts in Minutes</h4>
<p>...with just a few lines of python code</p>
<p>Discover how in my new Ebook:<br/>
<a href="/introduction-to-time-series-forecasting-with-python/">Introduction to Time Series Forecasting With Python</a></p>
<p>It covers <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> on topics like:<br/>
<em>Loading data, visualization, modeling, algorithm tuning,</em> and much more...</p>
<h4>Finally Bring Time Series Forecasting to<br/>
Your Own Projects</h4>
<p>Skip the Academics. Just Results.</p>
<p><a href="/introduction-to-time-series-forecasting-with-python/">Click to learn more</a>.</p>
<div class="woo-sc-hr"></div>
<p></p></center>
</div>
</div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-3642 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Grid+Search+ARIMA+Model+Hyperparameters+with+Python&amp;url=https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
</section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/machine-learning-books/" rel="prev"><i class="fa fa-angle-left"></i> Machine Learning Books</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/gentle-introduction-random-walk-times-series-forecasting-python/" rel="next">A Gentle Introduction to the Random Walk for Times Series Forecasting with Python <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">80 Responses to <em>How to Grid Search ARIMA Model Hyperparameters with Python</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-382815">
<div class="comment-container" id="li-comment-382815">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d6c9c132a8e164b6b2f5eb12dc4c859b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d6c9c132a8e164b6b2f5eb12dc4c859b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Gerrit Govaerts</span>
<span class="date">January 18, 2017 at 9:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-382815" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If you are willing to consider an R solution , then I can point you to the function auto.arima in the R package ‘forecast’ : <a href="https://cran.r-project.org/web/packages/forecast/forecast.pdf" rel="nofollow">https://cran.r-project.org/web/packages/forecast/forecast.pdf</a><br/>
This will do all the gridsearch you need without writing a single line of code .<br/>
Now , in general , the use of gridsearch for solving the hyperparameters optimization problem in machine learning models is a poor inefficient choice . It has been proven that random search is faster and Bayesian search is even faster . See this : <a href="https://www.youtube.com/watch?v=cWQDeB9WqvU" rel="nofollow">https://www.youtube.com/watch?v=cWQDeB9WqvU</a>  (lecture by Geoff Hinton) . For Python , there is a package called hyperopt that provides this functionality : <a href="https://github.com/hyperopt/hyperopt" rel="nofollow">https://github.com/hyperopt/hyperopt</a><br/>
An intro to hyperopt is here : <a href="https://www.youtube.com/watch?v=Mp1xnPfE4PY" rel="nofollow">https://www.youtube.com/watch?v=Mp1xnPfE4PY</a></p>
<div class="reply">
<a aria-label="Reply to Gerrit Govaerts" class="comment-reply-link" href="#comment-382815" onclick='return addComment.moveForm( "comment-382815", "382815", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-382897">
<div class="comment-container" id="li-comment-382897">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 19, 2017 at 7:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-382897" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the links Gerrit.</p>
<p>A noted difference is the optimizaiton of an out of sample statistics, i.e. test performance.</p>
<p>Re grid vs random search, the ARIMA grid is small enough that it can be enumerated. When working with small grids with low compute times, random search would be much less efficient.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-382897" onclick='return addComment.moveForm( "comment-382897", "382897", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-385188">
<div class="comment-container" id="li-comment-385188">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/37c73ebdd4aa5387fce50cdf53fb77e3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/37c73ebdd4aa5387fce50cdf53fb77e3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Abdallah</span>
<span class="date">January 31, 2017 at 1:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-385188" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hello I have used the evaluate model function to chose the best configuration, but it skipped those configurations that I expect the best according to the Box-Jenkins Method. what that means? and is there any way to check that configurations?</p>
<div class="reply">
<a aria-label="Reply to Abdallah" class="comment-reply-link" href="#comment-385188" onclick='return addComment.moveForm( "comment-385188", "385188", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-385416">
<div class="comment-container" id="li-comment-385416">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 1, 2017 at 10:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-385416" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question Abdallah, I am frustrated by this as well.</p>
<p>I believe you may be able to tinker with the ARIMA configuration further, such as configuring it use or not use a trend constant.</p>
<p>The issue is caused by instabilities in the linalg and optimization libraries used under the covers.</p>
<p>You could try an alternate implementation (R?), try implementing the method from scratch by hand or perhaps try fitting a linear regression model on a version of the dataset transformed using the same ARIMA operations.</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-385416" onclick='return addComment.moveForm( "comment-385416", "385416", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-386657">
<div class="comment-container" id="li-comment-386657">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6c32b5a05091a2fd8b8ace09837d1eac?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6c32b5a05091a2fd8b8ace09837d1eac?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Andres Kull</span>
<span class="date">February 8, 2017 at 11:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-386657" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You are doing here one-step rolling forecast for tuning ARIMA parameters. Will the resulting model behave best for forecasting the next observation only? Let’s assume that I would like to get the best possible prediction for the period of next 30 observations. Should the parameters tuning be changed for 30 steps rolling forecast in this case?</p>
<div class="reply">
<a aria-label="Reply to Andres Kull" class="comment-reply-link" href="#comment-386657" onclick='return addComment.moveForm( "comment-386657", "386657", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-386716">
<div class="comment-container" id="li-comment-386716">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 9, 2017 at 7:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-386716" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes Andres, spot on. It is critically important to optimize for the outcome you require.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-386716" onclick='return addComment.moveForm( "comment-386716", "386716", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-400387">
<div class="comment-container" id="li-comment-400387">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/34031f4cf8bca19c8f68296b78834084?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/34031f4cf8bca19c8f68296b78834084?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://logiclabsltd.com" rel="external nofollow">Stuart Farmer</a></span>
<span class="date">May 24, 2017 at 1:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-400387" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Amazing stuff here, man. Love it. Keep up the good work!</p>
<div class="reply">
<a aria-label="Reply to Stuart Farmer" class="comment-reply-link" href="#comment-400387" onclick='return addComment.moveForm( "comment-400387", "400387", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-400407">
<div class="comment-container" id="li-comment-400407">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 24, 2017 at 4:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-400407" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for your support Stuart.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-400407" onclick='return addComment.moveForm( "comment-400407", "400407", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-401609">
<div class="comment-container" id="li-comment-401609">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/839f23d813b92e85d6f25cf398ecf104?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/839f23d813b92e85d6f25cf398ecf104?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Arkojyoti</span>
<span class="date">June 6, 2017 at 4:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-401609" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for the post. However, I encountered problems while trying to parse the date column in the Shampoo Sales example. I had downloaded the data from the following link(csv format) and am using Python 3:</p>
<p><a href="https://datamarket.com/data/set/22r0/sales-of-shampoo-over-a-three-year-period#!ds=22r0&amp;display=line" rel="nofollow">https://datamarket.com/data/set/22r0/sales-of-shampoo-over-a-three-year-period#!ds=22r0&amp;display=line</a></p>
<p>I faced 2 problems during parsing:<br/>
1) The format of Month column was “1-Jan”, indicating that we need to specify “%Y-%b” instead of “%Y-%m”<br/>
2) For values &gt;9, that is , 10-Jan, 11-Jan and so on, the parsed date will be rendered invalid. Since it will be in the format : “19010-Jan” and similar</p>
<p>Please find the modified function which worked for me:</p>
<p>def parser(x):<br/>
    #the following code chunk will take care of parsing for two conditions:<br/>
    #1. for dates  10<br/>
    test = int(x.split(‘-‘)[0])<br/>
    #print(test)<br/>
    if(test &lt; 10):<br/>
        return(datetime.strptime("190"+str(x),"%Y-%b"))<br/>
    else:<br/>
        return(datetime.strptime("19"+str(x),"%Y-%b"))<br/>
    series = read_csv('sales-of-shampoo-over-a-three-ye.csv', header=0, parse_dates=[0], index_col=0,<br/>
                  squeeze=True, date_parser=parser)</p>
<p>Please correct me if there is a mistake in the approach. Hope this helps. Thanks again for the article. Have a good day 🙂</p>
<div class="reply">
<a aria-label="Reply to Arkojyoti" class="comment-reply-link" href="#comment-401609" onclick='return addComment.moveForm( "comment-401609", "401609", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401639">
<div class="comment-container" id="li-comment-401639">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 6, 2017 at 10:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-401639" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have tested and confirm that the example works in Python3.</p>
<p>Perhaps confirm that you have the same dataset, that you have removed the footer from the file, and that you have copied the code from the post exactly?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401639" onclick='return addComment.moveForm( "comment-401639", "401639", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-403089">
<div class="comment-container" id="li-comment-403089">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ab114b86e9463e9ffc3431264b55beb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hans</span>
<span class="date">June 20, 2017 at 3:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-403089" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>On my computer the first example script breaks with:</p>
<p>** On entry to DLASCL, parameter number 4 had an illegal value</p>
<p>so I get no best settings.</p>
<p>The second script breaks with “Best ArimaNone MSE=inf”</p>
<p>I have already removed the footer line. Any hints available?</p>
<div class="reply">
<a aria-label="Reply to Hans" class="comment-reply-link" href="#comment-403089" onclick='return addComment.moveForm( "comment-403089", "403089", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-403472">
<div class="comment-container" id="li-comment-403472">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/659126a0695929bc84e5c91d65f259f7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/659126a0695929bc84e5c91d65f259f7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">TaeWoo Kim</span>
<span class="date">June 23, 2017 at 3:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-403472" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason </p>
<p>What is the difference (or benefit) of doing the grid search this way vs. using SARIMAX? (reference: <a href="https://www.digitalocean.com/community/tutorials/a-guide-to-time-series-forecasting-with-arima-in-python-3" rel="nofollow">https://www.digitalocean.com/community/tutorials/a-guide-to-time-series-forecasting-with-arima-in-python-3</a>)</p>
<div class="reply">
<a aria-label="Reply to TaeWoo Kim" class="comment-reply-link" href="#comment-403472" onclick='return addComment.moveForm( "comment-403472", "403472", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-403505">
<div class="comment-container" id="li-comment-403505">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 23, 2017 at 6:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-403505" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have not read that post, but skimming it suggests that are using a for loop just the same as in my tutorial.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-403505" onclick='return addComment.moveForm( "comment-403505", "403505", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-404660">
<div class="comment-container" id="li-comment-404660">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bf947d14cbeac3a84bcc8eb3baeb750e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bf947d14cbeac3a84bcc8eb3baeb750e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Priya Srinivasan</span>
<span class="date">July 4, 2017 at 2:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-404660" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>“Each time step of the test set is iterated. Just one iteration provides a model that you could use to make predictions on new data. The iterative approach allows a new ARIMA model to be trained each time step.”</p>
<p>First of all, thank you for this tutorial ! I am a bit confused about using your iterative approach above. My questions are:</p>
<p>1. Why are you adding the test example to the training set (in history) and retraining the ARIMA model ? This way each subsequent test prediction is trained on the original training set plus an element added from the prior test example.  Is this to improve the test predictions by adding more training data to the model (which now includes original training + test examples )?</p>
<p>2. Using the predict function, can I just train an ARIMA on the training set and use the in-built predict function on the test example set aside ? What are the pitfalls using this approach ?</p>
<p>Thank you again !</p>
<div class="reply">
<a aria-label="Reply to Priya Srinivasan" class="comment-reply-link" href="#comment-404660" onclick='return addComment.moveForm( "comment-404660", "404660", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-404874">
<div class="comment-container" id="li-comment-404874">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 6, 2017 at 10:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-404874" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am using walk-forward validation, learn more here:<br/>
<a href="http://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/" rel="nofollow">http://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/</a></p>
<p>Yes. The walk-forward validation lets you re-fit the model each step, predict does not.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-404874" onclick='return addComment.moveForm( "comment-404874", "404874", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-405828">
<div class="comment-container" id="li-comment-405828">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5377c8bdc7d10baea7db53b348d0fae8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5377c8bdc7d10baea7db53b348d0fae8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sam</span>
<span class="date">July 14, 2017 at 6:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-405828" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What does this error mean – Best ARIMANone RMSE=inf?</p>
<div class="reply">
<a aria-label="Reply to Sam" class="comment-reply-link" href="#comment-405828" onclick='return addComment.moveForm( "comment-405828", "405828", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-405855">
<div class="comment-container" id="li-comment-405855">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 14, 2017 at 8:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-405855" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No good result found Sam. Did you run the code as-is or adapt it to your problem? Perhaps debug the example?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-405855" onclick='return addComment.moveForm( "comment-405855", "405855", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-435723">
<div class="comment-container" id="li-comment-435723">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/758da54c4a77468cdd786fd8f1260948?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/758da54c4a77468cdd786fd8f1260948?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kailash</span>
<span class="date">April 23, 2018 at 10:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-435723" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>First let me thank you for this awsome blog. Coming to my issue, I ran this  code with my own dataset. I’m getting same error.After that I tried with same dataset too.Still getting same error.Please help sir.</p>
<div class="reply">
<a aria-label="Reply to Kailash" class="comment-reply-link" href="#comment-435723" onclick='return addComment.moveForm( "comment-435723", "435723", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-435765">
<div class="comment-container" id="li-comment-435765">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 24, 2018 at 6:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-435765" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<p>What error are you getting with the exact code in the tutorial?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435765" onclick='return addComment.moveForm( "comment-435765", "435765", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-4" id="comment-456165">
<div class="comment-container" id="li-comment-456165">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0c40a03a669d43303291402303caefa6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0c40a03a669d43303291402303caefa6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">jay</span>
<span class="date">November 26, 2018 at 9:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-456165" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi</p>
<p>Were you able to fix the problem?</p>
<div class="reply">
<a aria-label="Reply to jay" class="comment-reply-link" href="#comment-456165" onclick='return addComment.moveForm( "comment-456165", "456165", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-406610">
<div class="comment-container" id="li-comment-406610">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c2f9508572917259dc0cc6d709295df5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c2f9508572917259dc0cc6d709295df5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Marianico</span>
<span class="date">July 20, 2017 at 4:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-406610" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can the amount of input data affect to the forecast? I mean, maybe the oldest lagged data is not quite correlated with the current one. If so, wouldn’t be better to limit the length of history to 500 rows, for instance? How do I find the optimal amount of training data?</p>
<div class="reply">
<a aria-label="Reply to Marianico" class="comment-reply-link" href="#comment-406610" onclick='return addComment.moveForm( "comment-406610", "406610", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-406709">
<div class="comment-container" id="li-comment-406709">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 21, 2017 at 9:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-406709" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It can affect the forecast. I recommend testing the amount of forecast data used. Here’s an example:<br/>
<a href="http://machinelearningmastery.com/sensitivity-analysis-history-size-forecast-skill-arima-python/" rel="nofollow">http://machinelearningmastery.com/sensitivity-analysis-history-size-forecast-skill-arima-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-406709" onclick='return addComment.moveForm( "comment-406709", "406709", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-406771">
<div class="comment-container" id="li-comment-406771">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c2f9508572917259dc0cc6d709295df5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c2f9508572917259dc0cc6d709295df5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Marianico</span>
<span class="date">July 21, 2017 at 9:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-406771" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason, very useful! But now I have another dilemma: should I performance the gridsearch before or after finding the optimal amount of data?</p>
<div class="reply">
<a aria-label="Reply to Marianico" class="comment-reply-link" href="#comment-406771" onclick='return addComment.moveForm( "comment-406771", "406771", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-406831">
<div class="comment-container" id="li-comment-406831">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 22, 2017 at 8:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-406831" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That is a good question. It is also an open question.</p>
<p>A purist might treat the amount of training data as yet another variable to grid search.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-406831" onclick='return addComment.moveForm( "comment-406831", "406831", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-413145">
<div class="comment-container" id="li-comment-413145">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/54ffee25be4cf869bb2f4dd55aa521b8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/54ffee25be4cf869bb2f4dd55aa521b8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Andrew</span>
<span class="date">September 9, 2017 at 3:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-413145" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This model is taking forever to load – is there something I can do to optimize performance?</p>
<div class="reply">
<a aria-label="Reply to Andrew" class="comment-reply-link" href="#comment-413145" onclick='return addComment.moveForm( "comment-413145", "413145", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-413232">
<div class="comment-container" id="li-comment-413232">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 9, 2017 at 11:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-413232" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Remove some data?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-413232" onclick='return addComment.moveForm( "comment-413232", "413232", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-418745">
<div class="comment-container" id="li-comment-418745">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cadf8a01aa12e13c8b3d2ebe9351b0b8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cadf8a01aa12e13c8b3d2ebe9351b0b8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Udi</span>
<span class="date">November 2, 2017 at 8:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-418745" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi.<br/>
I’m trying to fit an ARIMA model to a financial dataset and getting really poor results. The predicted trend vary widely from the real one and relative MSE is an order of magnitude higher than required.  I’m having difficulties in recognizing the source of my problem.<br/>
I have several questions. Please tell me if my questions are too extensive for this discussion:</p>
<p>1. How do you choose the range for the grid search? ACF and PACF graphs hinted that the order of p,q is 0,0, but the relevant models still gave poor results (I’ve used aic as my error score, and the most popular model in my runs is ARIMA(0,0,0)…)</p>
<p>2. Another suspect is my fit-predict procedure. I fitted a model for an X hours period and predicted the next y minutes (repeat ad-infinitum). Surprisingly, using a small x value just gave worse results, not better, although the data is highly volatile.</p>
<p>3. Can you prove that an ARIMA model would be a poor choice for forecasting for a certain dataset? I mean, a dataset which is already stationary (differentiated), so a Dickey-Fuller test yields good results.</p>
<div class="reply">
<a aria-label="Reply to Udi" class="comment-reply-link" href="#comment-418745" onclick='return addComment.moveForm( "comment-418745", "418745", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418789">
<div class="comment-container" id="li-comment-418789">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 2, 2017 at 3:56 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-418789" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Looking at ACF/PACF plots can give you an idea of values to try for q and a:<br/>
<a href="https://machinelearningmastery.com/gentle-introduction-autocorrelation-partial-autocorrelation/" rel="nofollow">https://machinelearningmastery.com/gentle-introduction-autocorrelation-partial-autocorrelation/</a></p>
<p>Your testing procedure sounds like walk-forward validation, which is what I would recommend:<br/>
<a href="https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/</a></p>
<p>Yes, if the results are bad, move on to other algorithms or more data preparation. I’d recommend both to help sniff out opportunities for your data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-418789" onclick='return addComment.moveForm( "comment-418789", "418789", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-418800">
<div class="comment-container" id="li-comment-418800">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cadf8a01aa12e13c8b3d2ebe9351b0b8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cadf8a01aa12e13c8b3d2ebe9351b0b8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Udi</span>
<span class="date">November 2, 2017 at 5:36 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-418800" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for your quick answers!</p>
<p>– I’ve looked at ACF/PACF, and they suggested p=q=0, which is indeed my chosen model according to minimal aic criterion but is still not good enough. Maybe bic/MSE error scores could yield a different result, although I’m not optimistic.</p>
<p>– I haven’t read the other post yet, and I have to admit I haven’t fully realized all the nitty-gritty details of your code here, but I don’t think my algorithm fits walk-forward validation, because I fit a new model each time for a fixed sized group of data points. It’s just the fixed window that moves forward. This is mainly used for statistics sake, not for improvement of the outcome model.</p>
<p>– Are there other useful data preparation procedures besides smoothening?</p>
<div class="reply">
<a aria-label="Reply to Udi" class="comment-reply-link" href="#comment-418800" onclick='return addComment.moveForm( "comment-418800", "418800", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-418832">
<div class="comment-container" id="li-comment-418832">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 3, 2017 at 5:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-418832" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, perhaps you could start here:<br/>
<a href="https://machinelearningmastery.com/start-here/#timeseries" rel="nofollow">https://machinelearningmastery.com/start-here/#timeseries</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-418832" onclick='return addComment.moveForm( "comment-418832", "418832", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-418746">
<div class="comment-container" id="li-comment-418746">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cadf8a01aa12e13c8b3d2ebe9351b0b8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cadf8a01aa12e13c8b3d2ebe9351b0b8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Udi</span>
<span class="date">November 2, 2017 at 8:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-418746" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ah, and the last one (for now…):</p>
<p>4. Could data smoothening procedures improve the performance of an ARIMA model? It seems to me that if the data is naturally volatile any smoothening is bound to mess up the prediction, but this is intuition, not a mathematical proof</p>
<div class="reply">
<a aria-label="Reply to Udi" class="comment-reply-link" href="#comment-418746" onclick='return addComment.moveForm( "comment-418746", "418746", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-418790">
<div class="comment-container" id="li-comment-418790">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 2, 2017 at 3:56 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-418790" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It may help, try it and see – the cost is low.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-418790" onclick='return addComment.moveForm( "comment-418790", "418790", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-422258">
<div class="comment-container" id="li-comment-422258">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/887cae154a551bf7abdc1f3dc07bf408?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/887cae154a551bf7abdc1f3dc07bf408?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Qian</span>
<span class="date">December 6, 2017 at 9:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-422258" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>From the code of “calculate out of sample error” as below, is the best fitted model selected by lowest error of testing set? what can I do if I want to use the MSE and also R-square of training set to find the best fitted model?</p>
<p>(# calculate out of sample error<br/>
error = mean_squared_error(test, predictions)<br/>
return error)</p>
<p>Thank you in advance.</p>
<div class="reply">
<a aria-label="Reply to Qian" class="comment-reply-link" href="#comment-422258" onclick='return addComment.moveForm( "comment-422258", "422258", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-422343">
<div class="comment-container" id="li-comment-422343">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 7, 2017 at 7:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-422343" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good question, I’m not sure the framework can select based on two metrics. I think you can collect multiple metrics then review the array of results to make a selection.</p>
<p>See here:<br/>
<a href="http://scikit-learn.org/stable/modules/grid_search.html#specifying-multiple-metrics-for-evaluation" rel="nofollow">http://scikit-learn.org/stable/modules/grid_search.html#specifying-multiple-metrics-for-evaluation</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-422343" onclick='return addComment.moveForm( "comment-422343", "422343", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-425594">
<div class="comment-container" id="li-comment-425594">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ca475ca7699a958dcf518b88ed8ff5a7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ca475ca7699a958dcf518b88ed8ff5a7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Pratik</span>
<span class="date">January 4, 2018 at 10:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-425594" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I am running hyperparameter search. How to deal situations with like:</p>
<p>ValueError: The computed initial AR coefficients are not stationary<br/>
You should induce stationarity, choose a different model order, or you can<br/>
pass your own start_params.</p>
<p>I have multiple datasets (in like 500s) and it won’t be possible for me analyze them individually. Any suggestions?</p>
<p>Thank you in advance</p>
<div class="reply">
<a aria-label="Reply to Pratik" class="comment-reply-link" href="#comment-425594" onclick='return addComment.moveForm( "comment-425594", "425594", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-425601">
<div class="comment-container" id="li-comment-425601">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 4, 2018 at 3:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-425601" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps try making your time series stationary first:<br/>
<a href="https://machinelearningmastery.com/time-series-data-stationary-python/" rel="nofollow">https://machinelearningmastery.com/time-series-data-stationary-python/</a></p>
<p>Or perhaps add exception handling and ignore this error.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425601" onclick='return addComment.moveForm( "comment-425601", "425601", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-425643">
<div class="comment-container" id="li-comment-425643">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ca475ca7699a958dcf518b88ed8ff5a7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ca475ca7699a958dcf518b88ed8ff5a7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Pratik</span>
<span class="date">January 5, 2018 at 2:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-425643" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sounds good. Thank you, Jason!</p>
<div class="reply">
<a aria-label="Reply to Pratik" class="comment-reply-link" href="#comment-425643" onclick='return addComment.moveForm( "comment-425643", "425643", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-425719">
<div class="comment-container" id="li-comment-425719">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bee19f520c8a0b008c6d1699101fdbb0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bee19f520c8a0b008c6d1699101fdbb0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Siddharth Das</span>
<span class="date">January 5, 2018 at 8:14 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-425719" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What is the best option to choose the ranges of pdq and then pass it on the functions to predict the best pdq results based on the MSE, how to determine the range of pdq we need to pass?</p>
<p>Because if we pass blindly range(0,9), the whole model will take lot of time to find out the best result..</p>
<div class="reply">
<a aria-label="Reply to Siddharth Das" class="comment-reply-link" href="#comment-425719" onclick='return addComment.moveForm( "comment-425719", "425719", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425749">
<div class="comment-container" id="li-comment-425749">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 6, 2018 at 5:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-425749" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can use the ACF and PACF plots to help get an idea of a good range.</p>
<p>See this post:<br/>
<a href="https://machinelearningmastery.com/gentle-introduction-autocorrelation-partial-autocorrelation/" rel="nofollow">https://machinelearningmastery.com/gentle-introduction-autocorrelation-partial-autocorrelation/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425749" onclick='return addComment.moveForm( "comment-425749", "425749", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-430012">
<div class="comment-container" id="li-comment-430012">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/309c9074a7b69327ee091c6f34968f0e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/309c9074a7b69327ee091c6f34968f0e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Charles</span>
<span class="date">February 20, 2018 at 4:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-430012" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you very much Jason for a great article again. </p>
<p>This article(<br/>
<a href="https://www.linkedin.com/pulse/comparison-between-classical-statistical-model-arima-deep-virmani" rel="nofollow">https://www.linkedin.com/pulse/comparison-between-classical-statistical-model-arima-deep-virmani</a>) compared ARIMA with RNN and LSTM on time series forecasting. The results of LSTM is much better than ARIMA (RMSE: 1.02 vs. 4.74). Given that the selecting p, q, d of Arima is not easy, it seems like that using ARIMA on the forecast is wise.</p>
<p>Charles</p>
<div class="reply">
<a aria-label="Reply to Charles" class="comment-reply-link" href="#comment-430012" onclick='return addComment.moveForm( "comment-430012", "430012", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-430098">
<div class="comment-container" id="li-comment-430098">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 21, 2018 at 6:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-430098" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Interesting, thanks for sharing.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430098" onclick='return addComment.moveForm( "comment-430098", "430098", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-430211">
<div class="comment-container" id="li-comment-430211">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/309c9074a7b69327ee091c6f34968f0e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/309c9074a7b69327ee091c6f34968f0e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Charles</span>
<span class="date">February 22, 2018 at 12:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-430211" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Jason, please correct me if I am wrong.</p>
<p>1). The most of time series issues are nonlinear issues. we have to simplify them  to linear issues to apply ARIMA since ARIMA is linear model. This is why the prediction of ARIMA is always quite poor on a time series issue.</p>
<p>2). RNN and LSTM are able to handle nonlinear issues. Of course, its result is better than ARIMA.</p>
<p>3). So, people should avoid ANY linear models for the prediction of time series issues.</p>
<p>I have learned a lot from your articles. Many thanks to you!</p>
<p>lcy1031</p>
<div class="reply">
<a aria-label="Reply to Charles" class="comment-reply-link" href="#comment-430211" onclick='return addComment.moveForm( "comment-430211", "430211", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-430299">
<div class="comment-container" id="li-comment-430299">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 23, 2018 at 11:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-430299" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Mostly. Indeed ARIMA are linear models that capture linear relationships.</p>
<p>The more pre-processing you can do your data to make the relationship is the data simpler/better exposed, the easier modeling will be regardless of the methods used.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430299" onclick='return addComment.moveForm( "comment-430299", "430299", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-430382">
<div class="comment-container" id="li-comment-430382">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/309c9074a7b69327ee091c6f34968f0e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/309c9074a7b69327ee091c6f34968f0e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Charles</span>
<span class="date">February 24, 2018 at 4:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-430382" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Jason for reply.</p>
<p>My concern is that any pre-processing could over simply the issue, and make the prediction not reliable. So far, there is not an approach which can measure whether or not a pre-processing is valid, and could cut the important information out.</p>
<p>By the way, the trend and seasonality are very good features  of a curve which could help the prediction a lot. Using stationary processes to remove them out is wrong. </p>
<p>Thank you again!</p>
<p>Charles</p>
<div class="reply">
<a aria-label="Reply to Charles" class="comment-reply-link" href="#comment-430382" onclick='return addComment.moveForm( "comment-430382", "430382", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-430407">
<div class="comment-container" id="li-comment-430407">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 24, 2018 at 9:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-430407" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The best measure is model skill with and without the treatment to the data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430407" onclick='return addComment.moveForm( "comment-430407", "430407", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-431474">
<div class="comment-container" id="li-comment-431474">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/42717015f0f82e285ee756de9c4871e3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/42717015f0f82e285ee756de9c4871e3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ajay</span>
<span class="date">March 7, 2018 at 8:16 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-431474" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I m getting following error when I run this line<br/>
model = ARIMA(history, order=(4,1,0))<br/>
Error<br/>
TypeError: descriptor ‘__sub__’ requires a ‘datetime.datetime’ object but received a ‘int’</p>
<div class="reply">
<a aria-label="Reply to Ajay" class="comment-reply-link" href="#comment-431474" onclick='return addComment.moveForm( "comment-431474", "431474", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-431538">
<div class="comment-container" id="li-comment-431538">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 8, 2018 at 6:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-431538" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry to hear that. Did you copy the code and data from the tutorial exactly?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-431538" onclick='return addComment.moveForm( "comment-431538", "431538", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-432630">
<div class="comment-container" id="li-comment-432630">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0665aa02c5a39219e5808018139a3ec1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0665aa02c5a39219e5808018139a3ec1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Germán</span>
<span class="date">March 20, 2018 at 2:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-432630" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I was digging into the ‘history’ list update (based on the ‘walk forward validation’), and I see that if you print out the couples ‘predicted VS forecasted’ in the way your code is written, it is actually displaying ‘forecast of the last element added to history’ VS ‘current element test[t]’ just added to ‘history’ but not forcasted yet.</p>
<p>I propose this change, what do you think:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9ebc95b4f941101428" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
def evaluate_arima_model(ts_values, arima_order):
    size = int(len(ts_log.values) * 0.66)
    train, test = ts_log.values[0:size], ts_log.values[size:len(ts_log)]
    history = [x for x in train]
    predictions = list()
    print(train[-1])
    for t in range(len(test)):
        model = ARIMA(history, order=arima_order)
        print('último elemento de history : ', history[-1])
        model_fit = model.fit(disp=-1)
        #I add this step to forecast the last element of the updated 'train set'
        if t &gt; 0:
            output = model_fit.forecast()
            yhat = output[0]     #model_fit.forecast[0] es el elemento predicho con 'forecast'
            predictions.append(yhat)
            print('predicted=%f, expected=%f' % (yhat, history[-1]))
            
        if t == 0:
            predictions.append(history[-1])
        #this step is based on 'Walk Forward Validation': https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/
        history.append(test[t])
        
    error = mean_squared_error(test, predictions)
    print('Test MSE: %.3f' % error)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9ebc95b4f941101428-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95b4f941101428-2">2</div><div class="crayon-num" data-line="crayon-5c0c9ebc95b4f941101428-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95b4f941101428-4">4</div><div class="crayon-num" data-line="crayon-5c0c9ebc95b4f941101428-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95b4f941101428-6">6</div><div class="crayon-num" data-line="crayon-5c0c9ebc95b4f941101428-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95b4f941101428-8">8</div><div class="crayon-num" data-line="crayon-5c0c9ebc95b4f941101428-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95b4f941101428-10">10</div><div class="crayon-num" data-line="crayon-5c0c9ebc95b4f941101428-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95b4f941101428-12">12</div><div class="crayon-num" data-line="crayon-5c0c9ebc95b4f941101428-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95b4f941101428-14">14</div><div class="crayon-num" data-line="crayon-5c0c9ebc95b4f941101428-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95b4f941101428-16">16</div><div class="crayon-num" data-line="crayon-5c0c9ebc95b4f941101428-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95b4f941101428-18">18</div><div class="crayon-num" data-line="crayon-5c0c9ebc95b4f941101428-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95b4f941101428-20">20</div><div class="crayon-num" data-line="crayon-5c0c9ebc95b4f941101428-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95b4f941101428-22">22</div><div class="crayon-num" data-line="crayon-5c0c9ebc95b4f941101428-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95b4f941101428-24">24</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9ebc95b4f941101428-1"><span class="crayon-e">def </span><span class="crayon-e">evaluate_arima_model</span><span class="crayon-sy">(</span><span class="crayon-v">ts_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">arima_order</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95b4f941101428-2"><span class="crayon-h">    </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">ts_log</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.66</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc95b4f941101428-3"><span class="crayon-h">    </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ts_log</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">size</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ts_log</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">[</span><span class="crayon-v">size</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">ts_log</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95b4f941101428-4"><span class="crayon-h">    </span><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9ebc95b4f941101428-5"><span class="crayon-h">    </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95b4f941101428-6"><span class="crayon-h">    </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc95b4f941101428-7"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">t</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95b4f941101428-8"><span class="crayon-h">        </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ARIMA</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">order</span><span class="crayon-o">=</span><span class="crayon-v">arima_order</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc95b4f941101428-9"><span class="crayon-h">        </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'último elemento de history : '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95b4f941101428-10"><span class="crayon-h">        </span><span class="crayon-v">model_fit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">disp</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc95b4f941101428-11"><span class="crayon-h">        </span><span class="crayon-p">#I add this step to forecast the last element of the updated 'train set'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95b4f941101428-12"><span class="crayon-h">        </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9ebc95b4f941101428-13"><span class="crayon-h">            </span><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-sy">.</span><span class="crayon-e">forecast</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95b4f941101428-14"><span class="crayon-h">            </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">output</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h">     </span><span class="crayon-p">#model_fit.forecast[0] es el elemento predicho con 'forecast'</span></div><div class="crayon-line" id="crayon-5c0c9ebc95b4f941101428-15"><span class="crayon-h">            </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95b4f941101428-16"><span class="crayon-h">            </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'predicted=%f, expected=%f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc95b4f941101428-17"><span class="crayon-h">            </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95b4f941101428-18"><span class="crayon-h">        </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0c9ebc95b4f941101428-19"><span class="crayon-h">            </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95b4f941101428-20"><span class="crayon-h">        </span><span class="crayon-p">#this step is based on 'Walk Forward Validation': https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/</span></div><div class="crayon-line" id="crayon-5c0c9ebc95b4f941101428-21"><span class="crayon-h">        </span><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-v">t</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95b4f941101428-22"><span class="crayon-h">        </span></div><div class="crayon-line" id="crayon-5c0c9ebc95b4f941101428-23"><span class="crayon-h">    </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95b4f941101428-24"><span class="crayon-h">    </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test MSE: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0017 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to Germán" class="comment-reply-link" href="#comment-432630" onclick='return addComment.moveForm( "comment-432630", "432630", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-432631">
<div class="comment-container" id="li-comment-432631">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0665aa02c5a39219e5808018139a3ec1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0665aa02c5a39219e5808018139a3ec1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Germán</span>
<span class="date">March 20, 2018 at 2:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-432631" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>* couples ‘predicted VS expected’ I meant 🙂</p>
<div class="reply">
<a aria-label="Reply to Germán" class="comment-reply-link" href="#comment-432631" onclick='return addComment.moveForm( "comment-432631", "432631", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-432671">
<div class="comment-container" id="li-comment-432671">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 20, 2018 at 6:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-432671" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In walk forward validation we want the real ob added to the history (used to fit the model), not the prediction. </p>
<p>Otherwise we will be using a recursive multi-step prediction model (e.g. different from our goal) and skill will be much worse.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-432671" onclick='return addComment.moveForm( "comment-432671", "432671", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-432746">
<div class="comment-container" id="li-comment-432746">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0665aa02c5a39219e5808018139a3ec1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0665aa02c5a39219e5808018139a3ec1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Germán</span>
<span class="date">March 21, 2018 at 3:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-432746" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thanks for your answer but I think you misunderstood what I mean, and I actually did not change what you add to the ‘history’ list.</p>
<p>The change I made (validated running my code with a time series example running fine) is to display the correct pairs ‘predicted VS expected’ (can you checkl my code below in my last entry?)</p>
<div class="reply">
<a aria-label="Reply to Germán" class="comment-reply-link" href="#comment-432746" onclick='return addComment.moveForm( "comment-432746", "432746", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-432632">
<div class="comment-container" id="li-comment-432632">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0665aa02c5a39219e5808018139a3ec1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0665aa02c5a39219e5808018139a3ec1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Germán</span>
<span class="date">March 20, 2018 at 2:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-432632" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry for the typos, below the proposed code:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9ebc95ae0670163555" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from sklearn.metrics import mean_squared_error

def evaluate_arima_model(ts_values, arima_order):
    size = int(len(ts_values) * 0.66)
    train, test = ts_values[0:size], ts_values[size:len(ts_values)]
    history = [x for x in train]
    predictions = list()
    print(train[-1])
    for t in range(len(test)):
        model = ARIMA(history, order=arima_order)
        model_fit = model.fit(disp=-1)
        #I add this step to forecast the last element of the updated 'train set'
        if t &gt; 0:
            output = model_fit.forecast()
            yhat = output[0]     
            predictions.append(yhat)
            print('predicted=%f, expected=%f' % (yhat, history[-1]))
            
        if t == 0:
            predictions.append(history[-1])
        #this step is based on 'Walk Forward Validation': 
        history.append(test[t])
        
    error = mean_squared_error(test, predictions)
    print('Test MSE: %.3f' % error)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9ebc95ae0670163555-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95ae0670163555-2">2</div><div class="crayon-num" data-line="crayon-5c0c9ebc95ae0670163555-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95ae0670163555-4">4</div><div class="crayon-num" data-line="crayon-5c0c9ebc95ae0670163555-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95ae0670163555-6">6</div><div class="crayon-num" data-line="crayon-5c0c9ebc95ae0670163555-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95ae0670163555-8">8</div><div class="crayon-num" data-line="crayon-5c0c9ebc95ae0670163555-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95ae0670163555-10">10</div><div class="crayon-num" data-line="crayon-5c0c9ebc95ae0670163555-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95ae0670163555-12">12</div><div class="crayon-num" data-line="crayon-5c0c9ebc95ae0670163555-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95ae0670163555-14">14</div><div class="crayon-num" data-line="crayon-5c0c9ebc95ae0670163555-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95ae0670163555-16">16</div><div class="crayon-num" data-line="crayon-5c0c9ebc95ae0670163555-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95ae0670163555-18">18</div><div class="crayon-num" data-line="crayon-5c0c9ebc95ae0670163555-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95ae0670163555-20">20</div><div class="crayon-num" data-line="crayon-5c0c9ebc95ae0670163555-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95ae0670163555-22">22</div><div class="crayon-num" data-line="crayon-5c0c9ebc95ae0670163555-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95ae0670163555-24">24</div><div class="crayon-num" data-line="crayon-5c0c9ebc95ae0670163555-25">25</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9ebc95ae0670163555-1"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-e">mean_squared_error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95ae0670163555-2"> </div><div class="crayon-line" id="crayon-5c0c9ebc95ae0670163555-3"><span class="crayon-e">def </span><span class="crayon-e">evaluate_arima_model</span><span class="crayon-sy">(</span><span class="crayon-v">ts_values</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">arima_order</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95ae0670163555-4"><span class="crayon-h">    </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">ts_values</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.66</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc95ae0670163555-5"><span class="crayon-h">    </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ts_values</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">size</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ts_values</span><span class="crayon-sy">[</span><span class="crayon-v">size</span><span class="crayon-o">:</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">ts_values</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95ae0670163555-6"><span class="crayon-h">    </span><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9ebc95ae0670163555-7"><span class="crayon-h">    </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95ae0670163555-8"><span class="crayon-h">    </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc95ae0670163555-9"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">t</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95ae0670163555-10"><span class="crayon-h">        </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ARIMA</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">order</span><span class="crayon-o">=</span><span class="crayon-v">arima_order</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc95ae0670163555-11"><span class="crayon-h">        </span><span class="crayon-v">model_fit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">disp</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95ae0670163555-12"><span class="crayon-h">        </span><span class="crayon-p">#I add this step to forecast the last element of the updated 'train set'</span></div><div class="crayon-line" id="crayon-5c0c9ebc95ae0670163555-13"><span class="crayon-h">        </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95ae0670163555-14"><span class="crayon-h">            </span><span class="crayon-v">output</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-sy">.</span><span class="crayon-e">forecast</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc95ae0670163555-15"><span class="crayon-h">            </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">output</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h">     </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95ae0670163555-16"><span class="crayon-h">            </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc95ae0670163555-17"><span class="crayon-h">            </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'predicted=%f, expected=%f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95ae0670163555-18"><span class="crayon-h">            </span></div><div class="crayon-line" id="crayon-5c0c9ebc95ae0670163555-19"><span class="crayon-h">        </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">t</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95ae0670163555-20"><span class="crayon-h">            </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc95ae0670163555-21"><span class="crayon-h">        </span><span class="crayon-p">#this step is based on 'Walk Forward Validation': </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95ae0670163555-22"><span class="crayon-h">        </span><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-v">t</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc95ae0670163555-23"><span class="crayon-h">        </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95ae0670163555-24"><span class="crayon-h">    </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc95ae0670163555-25"><span class="crayon-h">    </span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test MSE: %.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0016 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to Germán" class="comment-reply-link" href="#comment-432632" onclick='return addComment.moveForm( "comment-432632", "432632", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-432955">
<div class="comment-container" id="li-comment-432955">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/42717015f0f82e285ee756de9c4871e3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/42717015f0f82e285ee756de9c4871e3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ajay Verma</span>
<span class="date">March 23, 2018 at 2:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-432955" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thanks for your wonderful session. I have ticket count from Jan2017 till Jan2018.<br/>
I have applied AREMA model , got the predicted value of test data as below this is till Jan2018, how to forecast for Feb2018 and  Mar2018 which is not in database<br/>
predicted=2440.666667, expected=2593.000000<br/>
predicted=2642.187500, expected=2289.000000<br/>
predicted=2317.411765, expected=2495.000000<br/>
predicted=2533.277778, expected=3062.000000<br/>
predicted=3128.105263, expected=2719.000000<br/>
predicted=2764.650000, expected=3159.000000<br/>
predicted=3223.428571, expected=3510.000000<br/>
predicted=3587.454545, expected=3155.000000<br/>
predicted=3213.652174, expected=2628.000000</p>
<div class="reply">
<a aria-label="Reply to Ajay Verma" class="comment-reply-link" href="#comment-432955" onclick='return addComment.moveForm( "comment-432955", "432955", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-432984">
<div class="comment-container" id="li-comment-432984">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 23, 2018 at 6:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-432984" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This post will show you how to make an out of sample forecast:<br/>
<a href="https://machinelearningmastery.com/make-sample-forecasts-arima-python/" rel="nofollow">https://machinelearningmastery.com/make-sample-forecasts-arima-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-432984" onclick='return addComment.moveForm( "comment-432984", "432984", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-433566">
<div class="comment-container" id="li-comment-433566">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/84ec6aefdbb11d269a220d229def0aa4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/84ec6aefdbb11d269a220d229def0aa4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Adam Dziedzic</span>
<span class="date">March 29, 2018 at 11:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-433566" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thank you for the great content. You wrote: “it may be possible to update the internal data of the model with new observations rather than recreating it from scratch.” I inspected the code: statsmodels/tsa/arima_model.py carefully but have not found how to compute the residuals on the new observations (how to update the model for new observations) without revising the parameters (using the model.fit method). Do you know how to do it? It’s possible in R: <a href="https://stats.stackexchange.com/a/34191/149565" rel="nofollow">https://stats.stackexchange.com/a/34191/149565</a></p>
<div class="reply">
<a aria-label="Reply to Adam Dziedzic" class="comment-reply-link" href="#comment-433566" onclick='return addComment.moveForm( "comment-433566", "433566", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-433583">
<div class="comment-container" id="li-comment-433583">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 29, 2018 at 3:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-433583" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have an example.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-433583" onclick='return addComment.moveForm( "comment-433583", "433583", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-433674">
<div class="comment-container" id="li-comment-433674">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9c950bfe9401623a8d991eaeb2b25afb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9c950bfe9401623a8d991eaeb2b25afb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://people.cs.uchicago.edu/~ady" rel="external nofollow">Adam Dziedzic</a></span>
<span class="date">March 30, 2018 at 8:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-433674" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, thank you for your response. Do you know if it is possible? If so, do you have any hints? For example, I tried to rebuild the model with the new observation added to the history (variable) and reuse as many parameters from the previous model as possible (I created a new class that inherits from ARIMA). The shape of endog (the previous observations) and exog (the error terms) did not agree (and they can be transformed internally in different ways), so I omitted the exog parameter from the previous model and retrained the new model (using fit) with a single iteration. It kind of works but probably there is a better way to do it.</p>
<div class="reply">
<a aria-label="Reply to Adam Dziedzic" class="comment-reply-link" href="#comment-433674" onclick='return addComment.moveForm( "comment-433674", "433674", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-433730">
<div class="comment-container" id="li-comment-433730">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 31, 2018 at 6:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-433730" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It might be easier to write a custom ARIMA with the features you need. There’s not a lot to it and I do find the statsmodels implementations not entirely extensible (as I am sure you’re discovering).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-433730" onclick='return addComment.moveForm( "comment-433730", "433730", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-433981">
<div class="comment-container" id="li-comment-433981">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9c950bfe9401623a8d991eaeb2b25afb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9c950bfe9401623a8d991eaeb2b25afb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://people.cs.uchicago.edu/~ady" rel="external nofollow">Adam Dziedzic</a></span>
<span class="date">April 3, 2018 at 7:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-433981" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Okay, thank you for your answer. I appreciate it.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-440226">
<div class="comment-container" id="li-comment-440226">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/00f6e90b29850b15cc3d3aefc36df0cc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/00f6e90b29850b15cc3d3aefc36df0cc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kate Williams</span>
<span class="date">June 8, 2018 at 10:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-440226" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
for my grid search, all MLE values are returned as 0. Indicating to me that possibly MLE failed to converge. However trying a few p, d and q values by hand, some combinations converge perfectly, but returning an MSE of 0.0 nonetheless.<br/>
Do you have any idea on what might cause this?</p>
<div class="reply">
<a aria-label="Reply to Kate Williams" class="comment-reply-link" href="#comment-440226" onclick='return addComment.moveForm( "comment-440226", "440226", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-440272">
<div class="comment-container" id="li-comment-440272">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 9, 2018 at 6:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-440272" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Or the model has perfect skill. Perhaps the problem us too simple?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-440272" onclick='return addComment.moveForm( "comment-440272", "440272", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-441387">
<div class="comment-container" id="li-comment-441387">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ea0afc8fe0c5423aebaca1750009bace?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ea0afc8fe0c5423aebaca1750009bace?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Saurabh Dhokare</span>
<span class="date">June 20, 2018 at 10:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-441387" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason!!</p>
<p>An extremely helpful post.</p>
<p>I just wanted an estimate of runtime considering I have a 6th gen, i5 processor. It’s been 2 days and the program keeps running and is showing no results. I have read most of he comments on the post and tried to debug the code. I have confirmed that the code is running but it isn’t producing any results.</p>
<p>Your help will be highly appreciated!!<br/>
Thanks 🙂</p>
<div class="reply">
<a aria-label="Reply to Saurabh Dhokare" class="comment-reply-link" href="#comment-441387" onclick='return addComment.moveForm( "comment-441387", "441387", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-441472">
<div class="comment-container" id="li-comment-441472">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 21, 2018 at 6:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-441472" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps add some print() statements to help see progress?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-441472" onclick='return addComment.moveForm( "comment-441472", "441472", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-442464">
<div class="comment-container" id="li-comment-442464">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8cead2a489c074b6ffd297a9a8c85e5b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8cead2a489c074b6ffd297a9a8c85e5b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://decisionstats.com" rel="external nofollow">Ajay</a></span>
<span class="date">July 2, 2018 at 12:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-442464" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi I created some raw code on this here <a href="https://github.com/decisionstats/pythonfordatascience/blob/master/Quarterly%2BTime%2BSeries%2Bof%2Bthe%2BNumber%2Bof%2BAustralian%2BResidents.ipynb" rel="nofollow">https://github.com/decisionstats/pythonfordatascience/blob/master/Quarterly%2BTime%2BSeries%2Bof%2Bthe%2BNumber%2Bof%2BAustralian%2BResidents.ipynb</a></p>
<p>basically the search function was to minimize AIC</p>
<p>how would this compare to gridsearch for MSE minimization</p>
<p>warnings.filterwarnings(“ignore”) # specify to ignore warning messages<br/>
c4=[]<br/>
for param in pdq:<br/>
    for param_seasonal in seasonal_pdq:<br/>
        try:<br/>
            mod = sm.tsa.statespace.SARIMAX(y,<br/>
                                            order=param,<br/>
                                            seasonal_order=param_seasonal,<br/>
                                            enforce_stationarity=False,<br/>
                                            enforce_invertibility=False)</p>
<p>            results = mod.fit()</p>
<p>            print(‘ARIMA{}x{}12 – AIC:{}’.format(param, param_seasonal, results.aic))<br/>
            c4.append(‘ARIMA{}x{}12 – AIC:{}’.format(param, param_seasonal, results.aic))<br/>
        except:<br/>
            continue</p>
<div class="reply">
<a aria-label="Reply to Ajay" class="comment-reply-link" href="#comment-442464" onclick='return addComment.moveForm( "comment-442464", "442464", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-442486">
<div class="comment-container" id="li-comment-442486">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 2, 2018 at 6:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-442486" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442486" onclick='return addComment.moveForm( "comment-442486", "442486", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-450984">
<div class="comment-container" id="li-comment-450984">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d177caa68f0359716a180310e27e8ee3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d177caa68f0359716a180310e27e8ee3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sanjie</span>
<span class="date">October 8, 2018 at 2:35 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-450984" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hello Jason,<br/>
it is a nice article for us to learn ARIMA. But i met one problem when running “Daily Female Births Case Study”. the error is Intel MKL ERROR: Parameter 4 was incorrect on entry to DLASCL.   but when running “Shampoo Sales Case Study”. it is okay.</p>
<p>i got this web link below.<br/>
<a href="https://stackoverflow.com/questions/46669870/keras-with-tensorflow-backend-on-gpu-mkl-error-parameter-4-was-incorrect-on-en" rel="nofollow">https://stackoverflow.com/questions/46669870/keras-with-tensorflow-backend-on-gpu-mkl-error-parameter-4-was-incorrect-on-en</a></p>
<p>my mlk with 2019.0  and 2108.0 in anaconda, the problem is always there.<br/>
i cannot to make mkl down to 11.3.3</p>
<div class="reply">
<a aria-label="Reply to sanjie" class="comment-reply-link" href="#comment-450984" onclick='return addComment.moveForm( "comment-450984", "450984", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-451047">
<div class="comment-container" id="li-comment-451047">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 9, 2018 at 8:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-451047" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I’m not an expert on debugging libraries and workstations.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-451047" onclick='return addComment.moveForm( "comment-451047", "451047", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-455531">
<div class="comment-container" id="li-comment-455531">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/abf00a8c605d92d41ccbab8cbd981fe0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/abf00a8c605d92d41ccbab8cbd981fe0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Galen</span>
<span class="date">November 20, 2018 at 12:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-455531" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is great, but I’m curious:</p>
<p>Here we are predicting, but what about evaluating the model in itself using the AIC, BIC, or other criteria, without doing prediction.</p>
<div class="reply">
<a aria-label="Reply to Galen" class="comment-reply-link" href="#comment-455531" onclick='return addComment.moveForm( "comment-455531", "455531", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-455569">
<div class="comment-container" id="li-comment-455569">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 20, 2018 at 6:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-455569" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have an example.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-455569" onclick='return addComment.moveForm( "comment-455569", "455569", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-455655">
<div class="comment-container" id="li-comment-455655">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0414648653a4147b199d0377ce5e0a6d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0414648653a4147b199d0377ce5e0a6d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hikmet Yavuz</span>
<span class="date">November 20, 2018 at 11:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-455655" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I have a production question for you. </p>
<p>I have micro datasets (10 rows for each dataset) and it is required to have an ARIMA model for each dataset. I have  21060 datasets and i need to create 21060 ARIMA models and i have to perform grid search for each ARIMA model.</p>
<p>I genericized your ARIMA grid search code and ran successfully on my computer. However, i observed that creating 1000 ARIMA models (1000 grid searches) takes approximately 1 hour on my computer. Creating 21060 ARIMA models  (21060 grid searches) will approximately take 21 hours, if i run the code on my computer. </p>
<p>My team leader asked me that can we run your code on spark environment or can we run your code on multi thread mode in order to reduce the execution time ( 21 hours).</p>
<p>What do you suggest me?</p>
<div class="reply">
<a aria-label="Reply to Hikmet Yavuz" class="comment-reply-link" href="#comment-455655" onclick='return addComment.moveForm( "comment-455655", "455655", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-455693">
<div class="comment-container" id="li-comment-455693">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 21, 2018 at 7:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-455693" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can multi-thread it, here is an example:<br/>
<a href="https://machinelearningmastery.com/how-to-grid-search-sarima-model-hyperparameters-for-time-series-forecasting-in-python/" rel="nofollow">https://machinelearningmastery.com/how-to-grid-search-sarima-model-hyperparameters-for-time-series-forecasting-in-python/</a></p>
<p>You can run it on multiple machines to get a near-linear speedup.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-455693" onclick='return addComment.moveForm( "comment-455693", "455693", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-455805">
<div class="comment-container" id="li-comment-455805">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a013e292c71f2ea3d195a09a5d1dca3c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a013e292c71f2ea3d195a09a5d1dca3c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">jay</span>
<span class="date">November 22, 2018 at 7:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-455805" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason</p>
<p>Thanks for the article!<br/>
I ran the same code with the same database. It ran without any error but no result is printed. It prints following:<br/>
Best ARIMANone MSE=inf</p>
<p>any idea?</p>
<div class="reply">
<a aria-label="Reply to jay" class="comment-reply-link" href="#comment-455805" onclick='return addComment.moveForm( "comment-455805", "455805", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-455822">
<div class="comment-container" id="li-comment-455822">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 22, 2018 at 2:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-455822" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have some suggestions here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-455822" onclick='return addComment.moveForm( "comment-455822", "455822", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-456166">
<div class="comment-container" id="li-comment-456166">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0c40a03a669d43303291402303caefa6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0c40a03a669d43303291402303caefa6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">jay</span>
<span class="date">November 26, 2018 at 9:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-456166" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi</p>
<p>I tried everything with the same code and the same data, still I am getting the same result<br/>
i.e  Best ARIMANone MSE=inf</p>
<div class="reply">
<a aria-label="Reply to jay" class="comment-reply-link" href="#comment-456166" onclick='return addComment.moveForm( "comment-456166", "456166", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-456189">
<div class="comment-container" id="li-comment-456189">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 26, 2018 at 2:03 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-456189" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That is odd, are you able to confirm that statsmodels is up to date?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-456189" onclick='return addComment.moveForm( "comment-456189", "456189", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-455962">
<div class="comment-container" id="li-comment-455962">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/24cba730fb5df125c33e2e7f18cf8859?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/24cba730fb5df125c33e2e7f18cf8859?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rima</span>
<span class="date">November 24, 2018 at 4:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-455962" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, I had the same problem.<br/>
I think I found the answer, we should reset the index of the test set in the function “Evaluate_arima_model” since we are applying a for loop with the range of 0 to its length.<br/>
This line of code must be added in the function “Evaluate_arima_model” :     test.reset_index(drop=True,inplace = True)</p>
<p>The function will be then: </p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0c9ebc95766190819329" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
def evaluate_arima_model(X, arima_order):
    # prepare training dataset
    train_size = int(len(X) * 0.66)
    train, test = X[0:train_size], X[train_size:]
    history = [x for x in train]
    test.reset_index(drop=True,inplace = True)
    # make predictions
    predictions = list()
    for t in range(len(test)):
        model = ARIMA(history, order=arima_order)
        model_fit = model.fit(disp=0)
        yhat = model_fit.forecast()[0]
        predictions.append(yhat)
        history.append(test[t])
    # calculate out of sample error
    error = mean_squared_error(test, predictions)
    return error</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0c9ebc95766190819329-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95766190819329-2">2</div><div class="crayon-num" data-line="crayon-5c0c9ebc95766190819329-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95766190819329-4">4</div><div class="crayon-num" data-line="crayon-5c0c9ebc95766190819329-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95766190819329-6">6</div><div class="crayon-num" data-line="crayon-5c0c9ebc95766190819329-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95766190819329-8">8</div><div class="crayon-num" data-line="crayon-5c0c9ebc95766190819329-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95766190819329-10">10</div><div class="crayon-num" data-line="crayon-5c0c9ebc95766190819329-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95766190819329-12">12</div><div class="crayon-num" data-line="crayon-5c0c9ebc95766190819329-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95766190819329-14">14</div><div class="crayon-num" data-line="crayon-5c0c9ebc95766190819329-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0c9ebc95766190819329-16">16</div><div class="crayon-num" data-line="crayon-5c0c9ebc95766190819329-17">17</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0c9ebc95766190819329-1"><span class="crayon-e">def </span><span class="crayon-e">evaluate_arima_model</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">arima_order</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95766190819329-2"><span class="crayon-h">    </span><span class="crayon-p"># prepare training dataset</span></div><div class="crayon-line" id="crayon-5c0c9ebc95766190819329-3"><span class="crayon-h">    </span><span class="crayon-v">train_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.66</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95766190819329-4"><span class="crayon-h">    </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-v">train_size</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">train_size</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9ebc95766190819329-5"><span class="crayon-h">    </span><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95766190819329-6"><span class="crayon-h">    </span><span class="crayon-v">test</span><span class="crayon-sy">.</span><span class="crayon-e">reset_index</span><span class="crayon-sy">(</span><span class="crayon-v">drop</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc95766190819329-7"><span class="crayon-h">    </span><span class="crayon-p"># make predictions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95766190819329-8"><span class="crayon-h">    </span><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc95766190819329-9"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">t</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95766190819329-10"><span class="crayon-h">        </span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ARIMA</span><span class="crayon-sy">(</span><span class="crayon-v">history</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">order</span><span class="crayon-o">=</span><span class="crayon-v">arima_order</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc95766190819329-11"><span class="crayon-h">        </span><span class="crayon-v">model_fit</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">disp</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95766190819329-12"><span class="crayon-h">        </span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model_fit</span><span class="crayon-sy">.</span><span class="crayon-e">forecast</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c0c9ebc95766190819329-13"><span class="crayon-h">        </span><span class="crayon-v">predictions</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">yhat</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95766190819329-14"><span class="crayon-h">        </span><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">[</span><span class="crayon-v">t</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc95766190819329-15"><span class="crayon-h">    </span><span class="crayon-p"># calculate out of sample error</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0c9ebc95766190819329-16"><span class="crayon-h">    </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0c9ebc95766190819329-17"><span class="crayon-h">    </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">error</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0012 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to Rima" class="comment-reply-link" href="#comment-455962" onclick='return addComment.moveForm( "comment-455962", "455962", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-456160">
<div class="comment-container" id="li-comment-456160">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0c40a03a669d43303291402303caefa6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0c40a03a669d43303291402303caefa6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">jay</span>
<span class="date">November 26, 2018 at 8:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-456160" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>did you run it in terminal or in anaconda?</p>
<div class="reply">
<a aria-label="Reply to jay" class="comment-reply-link" href="#comment-456160" onclick='return addComment.moveForm( "comment-456160", "456160", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-456180">
<div class="comment-container" id="li-comment-456180">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 26, 2018 at 1:59 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-456180" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Save to a file and run from the command line. Here’s how:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-run-a-script-from-the-command-line" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-run-a-script-from-the-command-line</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-456180" onclick='return addComment.moveForm( "comment-456180", "456180", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-456292">
<div class="comment-container" id="li-comment-456292">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0c40a03a669d43303291402303caefa6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0c40a03a669d43303291402303caefa6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">jay</span>
<span class="date">November 27, 2018 at 7:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-456292" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi</p>
<p>It ran for me. In the function, instead of ‘series.values’ I used ‘series’ and it gave me the same results as shown in the example!<br/>
How do I print Predictions vs expected table?</p>
<p>thanks!</p>
<div class="reply">
<a aria-label="Reply to jay" class="comment-reply-link" href="#comment-456292" onclick='return addComment.moveForm( "comment-456292", "456292", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-456316">
<div class="comment-container" id="li-comment-456316">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 27, 2018 at 2:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/grid-search-arima-hyperparameters-with-python/#comment-456316" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-456316" onclick='return addComment.moveForm( "comment-456316", "456316", "respond", "3642" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/grid-search-arima-hyperparameters-with-python/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="3642"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="350a8c76e9"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="67"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery!</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Jason Brownlee, PhD
<br/>
I write tutorials to help developers (<i>like you</i>) get results with machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-27"> <div class="textwidget"><p></p><center><br/>
<strong>Time Series Forecasting with Python</strong><br/>
Explore time series data and predict the future.
<p><a href="/introduction-to-time-series-forecasting-with-python/">Click to Get Started Now!</a><br/>
<a href="/introduction-to-time-series-forecasting-with-python/"><img alt="Introduction to Time Series Forecasting With Python" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/02/Introduction-to-Time-Series-Forecasting-With-Python-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch"><img alt="How to Develop a Neural Machine Translation System in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/01/How-to-Develop-a-Neural-Machine-Translation-System-in-Keras-150x150.jpg" title="How to Develop a Neural Machine Translation System from Scratch" width="45"/></a> <a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch">How to Develop a Neural Machine Translation System from Scratch</a>
<span class="meta">January 10, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning"><img alt="Difference Between Classification and Regression in Machine Learning" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/Difference-Between-Classification-and-Regression-in-Machine-Learning-150x150.jpg" title="Difference Between Classification and Regression in Machine Learning" width="45"/></a> <a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning">Difference Between Classification and Regression in Machine Learning</a>
<span class="meta">December 11, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem..."><img alt="So, You are Working on a Machine Learning Problem..." class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/So-You-are-Working-on-a-Machine-Learning-Problem...-150x150.jpg" title="So, You are Working on a Machine Learning Problem..." width="45"/></a> <a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem…">So, You are Working on a Machine Learning Problem…</a>
<span class="meta">April 4, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis"><img alt="Plot of the Multichannel Convolutional Neural Network For Text" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-150x150.png" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis" width="45"/></a> <a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis">How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis</a>
<span class="meta">January 12, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras"><img alt="How to Make Classification and Regression Predictions for Deep Learning Models in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/How-to-Make-Classification-and-Regression-Predictions-for-Deep-Learning-Models-in-Keras-150x150.jpg" title="How to Make Predictions with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras">How to Make Predictions with Keras</a>
<span class="meta">April 9, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)"><img alt="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/11-Classical-Time-Series-Forecasting-Methods-in-Python-Cheat-Sheet-150x150.jpg" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)">11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)</a>
<span class="meta">August 6, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras"><img alt="How to Visualize a Deep Learning Neural Network Model in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/How-to-Visualize-a-Deep-Learning-Neural-Network-Model-in-Keras-150x150.jpg" title="How to Visualize a Deep Learning Neural Network Model in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras">How to Visualize a Deep Learning Neural Network Model in Keras</a>
<span class="meta">December 13, 2017</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> <div class="widget_text widget widget_custom_html" id="custom_html-2"><h3>You might also like…</h3><div class="textwidget custom-html-widget"><ul>
<li><a href="/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Install Python for Machine Learning</a></li>
<li><a href="/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python</a></li>
<li><a href="/tutorial-first-neural-network-python-keras/">Your First Neural Network in Python</a></li>
<li><a href="/how-to-run-your-first-classifier-in-weka/">Your First Classifier in Weka</a></li>
<li><a href="/arima-for-time-series-forecasting-with-python/">Your First Time Series Forecasting Project</a></li>
</ul></div></div></aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/disclaimer/">Disclaimer</a> | 
<a href="/terms-of-service/">Terms</a> | 
<a href="/contact/">Contact</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.8" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.0.5" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.8" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.1" type="text/javascript"></script>
</body>
</html>