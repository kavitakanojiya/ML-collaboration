<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v9.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Image Augmentation for Deep Learning With Keras</title>
<link href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="Image Augmentation for Deep Learning With Keras" property="og:title"/>
<meta content="Data preparation is required when working with neural network and deep learning models. Increasingly data augmentation is also required on more complex object recognition tasks. In this post you will discover how to use data preparation and data augmentation with your image datasets when developing and evaluating deep learning models in Python with Keras. After …" property="og:description"/>
<meta content="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="https://www.facebook.com/jason.brownlee.39" property="article:author"/>
<meta content="Deep Learning" property="article:section"/>
<meta content="2016-06-28T19:00:09+00:00" property="article:published_time"/>
<meta content="2017-03-31T00:33:07+00:00" property="article:modified_time"/>
<meta content="2017-03-31T00:33:07+00:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Example-MNIST-images.png" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Example-MNIST-images.png" property="og:image:secure_url"/>
<meta content="800" property="og:image:width"/>
<meta content="600" property="og:image:height"/>
<meta content="Example MNIST images" property="og:image:alt"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"https:\/\/machinelearningmastery.com\/#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/feed/" rel="alternate" title="Machine Learning Mastery » Image Augmentation for Deep Learning With Keras Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<style media="all" type="text/css">
.wpautoterms-footer{background-color:#ffffff;text-align:center;}
.wpautoterms-footer a{color:#000000;font-family:Arial, sans-serif;font-size:14px;}
.wpautoterms-footer .separator{color:#cccccc;font-family:Arial, sans-serif;font-size:14px;}</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/auto-terms-of-service-and-privacy-policy/css/wpautoterms.css?ver=4.9.8" id="wpautoterms_css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.0.5" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/css/front.css?ver=2.0.20" id="ssb-front-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/ewd-ufaq-styles.css?ver=4.9.8" id="ewd-ufaq-style-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/rrssb-min.css?ver=4.9.8" id="ewd-ufaq-rrssb-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.8" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=2.0.20" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.8" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.8" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=2587" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fimage-augmentation-deep-learning-keras%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fimage-augmentation-deep-learning-keras%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<style media="screen">

        .simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
      margin: ;
    }
         /*inline margin*/
    
  
  
  
  
  
          .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
         margin: ;
     }

          /*margin-digbar*/

  
  
  
  
 
   
   

</style>
<script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#4c89bf; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#4c89bf;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#4c89bf!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#ffffff;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-2587 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/icon-100x100.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-32"> <div class="textwidget"><p>Want help with deep learning? <a href="https://machinelearningmastery.lpages.co/deep-learning-with-python-mini-course/">Take the FREE Mini-Course</a></p>
</div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<input name="post_type" type="hidden" value="post"/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Main Menu</h3><ul class="nav fl" id="main-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503" id="menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Start Here</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501" id="menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506" id="menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6508" id="menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (Keras)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511" id="menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509" id="menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515" id="menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">Deep Learning for NLP</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512" id="menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Understand Algorithms</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507" id="menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms (Python)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6513" id="menu-item-6513"><a href="https://machinelearningmastery.com/category/machine-learning-process/">Machine Learning Process</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516" id="menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517" id="menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522" id="menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6518" id="menu-item-6518"><a href="https://machinelearningmastery.com/category/start-machine-learning/">Getting Started</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510" id="menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519" id="menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistical Methods</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520" id="menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Time Series (introductory)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523" id="menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6514" id="menu-item-6514"><a href="https://machinelearningmastery.com/category/machine-learning-resources/">Resources</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502" id="menu-item-6502"><a href="https://machinelearningmastery.com/products/">Ebooks</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500" id="menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504" id="menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505" id="menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-2587 post type-post status-publish format-standard has-post-thumbnail hentry category-deep-learning">
<header>
<h1 class="title entry-title">Image Augmentation for Deep Learning With Keras</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-06-29T05:00:09+1100">June 29, 2016</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/deep-learning/" title="View all items in Deep Learning">Deep Learning</a></span> </div>
<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-2587 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=Image+Augmentation+for+Deep+Learning+With+Keras&amp;url=https://machinelearningmastery.com/image-augmentation-deep-learning-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/image-augmentation-deep-learning-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/image-augmentation-deep-learning-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/image-augmentation-deep-learning-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
<p>Data preparation is required when working with neural network and deep learning models. Increasingly data augmentation is also required on more complex object recognition tasks.</p>
<p>In this post you will discover how to use data preparation and data augmentation with your image datasets when developing and evaluating deep learning models in Python with Keras.</p>
<p>After reading this post, you will know:</p>
<ul>
<li>About the image augmentation API provide by Keras and how to use it with your models.</li>
<li>How to perform feature standardization.</li>
<li>How to perform ZCA whitening of your images.</li>
<li>How to augment data with random rotations, shifts and flips.</li>
<li>How to save augmented image data to disk.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Update</strong>: The examples in this post were updated for the latest Keras API. The datagen.next() function was removed.</li>
<li><strong>Update Oct/2016</strong>: Updated examples for Keras 1.1.0, TensorFlow 0.10.0 and scikit-learn v0.18.</li>
<li><strong>Update Jan/2017</strong>: Updated examples for Keras 1.2.0 and TensorFlow 0.12.1.</li>
<li><strong>Update Mar/2017</strong>: Updated example for Keras 2.0.2, TensorFlow 1.0.1 and Theano 0.9.0.</li>
</ul>
<h2>Keras Image Augmentation API</h2>
<p>Like the rest of Keras, the image augmentation API is simple and powerful.</p>
<p>Keras provides the <a href="http://keras.io/preprocessing/image/">ImageDataGenerator</a> class that defines the configuration for image data preparation and augmentation. This includes capabilities such as:</p>
<ul>
<li>Sample-wise standardization.</li>
<li>Feature-wise standardization.</li>
<li>ZCA whitening.</li>
<li>Random rotation, shifts, shear and flips.</li>
<li>Dimension reordering.</li>
<li>Save augmented images to disk.</li>
</ul>
<p>An augmented image generator can be created as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6f1b9d97722090300" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
datagen = ImageDataGenerator()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6f1b9d97722090300-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6f1b9d97722090300-1"><span class="crayon-v">datagen</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ImageDataGenerator</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>Rather than performing the operations on your entire image dataset in memory, the API is designed to be iterated by the deep learning model fitting process, creating augmented image data for you just-in-time. This reduces your memory overhead, but adds some additional time cost during model training.</p>
<p>After you have created and configured your <strong>ImageDataGenerator</strong>, you must fit it on your data. This will calculate any statistics required to actually perform the transforms to your image data. You can do this by calling the <strong>fit()</strong> function on the data generator and pass it your training dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6f1b9da1296579963" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
datagen.fit(train)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6f1b9da1296579963-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6f1b9da1296579963-1"><span class="crayon-v">datagen</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The data generator itself is in fact an iterator, returning batches of image samples when requested. We can configure the batch size and prepare the data generator and get batches of images by calling the <strong>flow()</strong> function.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6f1b9da4381660416" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
X_batch, y_batch = datagen.flow(train, train, batch_size=32)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6f1b9da4381660416-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6f1b9da4381660416-1"><span class="crayon-v">X_batch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_batch</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">datagen</span><span class="crayon-sy">.</span><span class="crayon-e">flow</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">32</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Finally we can make use of the data generator. Instead of calling the <strong>fit()</strong> function on our model, we must call the <strong>fit_generator()</strong> function and pass in the data generator and the desired length of an epoch as well as the total number of epochs on which to train.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6f1b9da5446161403" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
fit_generator(datagen, samples_per_epoch=len(train), epochs=100)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6f1b9da5446161403-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6f1b9da5446161403-1"><span class="crayon-e">fit_generator</span><span class="crayon-sy">(</span><span class="crayon-v">datagen</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">samples_per_epoch</span><span class="crayon-o">=</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>You can learn more about the Keras image <a href="http://keras.io/preprocessing/image/">data generator API in the Keras documentation</a>.</p>
<p></p><div class="woo-sc-hr"></div>
<center>
<h3>Need help with Deep Learning in Python?</h3>
<p>Take my free 2-week email course and discover MLPs, CNNs and LSTMs (with code).</p>
<p>Click to sign-up now and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" rel="noopener" style="color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.247059) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.498039) 0px 1px 3px inset, rgba(0, 0, 0, 0.498039) 0px 1px 3px; background: #ffce0a;" target="_blank">Start Your FREE Mini-Course Now!</a> <script data-config="%7B%7D" data-leadbox="142d6e873f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" src="https://machinelearningmastery.leadpages.co/leadbox-1463166699.js" type="text/javascript"></script></p>
</center>
<p></p><div class="woo-sc-hr"></div>
<h2>Point of Comparison for Image Augmentation</h2>
<p>Now that you know how the image augmentation API in Keras works, let’s look at some examples.</p>
<p>We will use the MNIST handwritten digit recognition task in these examples. To begin with, let’s take a look at the first 9 images in the training dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6f1b9da7284548500" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Plot images
from keras.datasets import mnist
from matplotlib import pyplot
# load data
(X_train, y_train), (X_test, y_test) = mnist.load_data()
# create a grid of 3x3 images
for i in range(0, 9):
	pyplot.subplot(330 + 1 + i)
	pyplot.imshow(X_train[i], cmap=pyplot.get_cmap('gray'))
# show the plot
pyplot.show()</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6f1b9da7284548500-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9da7284548500-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9da7284548500-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9da7284548500-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9da7284548500-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9da7284548500-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9da7284548500-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9da7284548500-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9da7284548500-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9da7284548500-10">10</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9da7284548500-11">11</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6f1b9da7284548500-1"><span class="crayon-p"># Plot images</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9da7284548500-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">mnist</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9da7284548500-3"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-v">pyplot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9da7284548500-4"><span class="crayon-p"># load data</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9da7284548500-5"><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9da7284548500-6"><span class="crayon-p"># create a grid of 3x3 images</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9da7284548500-7"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9da7284548500-8"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">330</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9da7284548500-9"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-o">=</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">get_cmap</span><span class="crayon-sy">(</span><span class="crayon-s">'gray'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9da7284548500-10"><span class="crayon-p"># show the plot</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9da7284548500-11"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>Running this example provides the following image that we can use as a point of comparison with the image preparation and augmentation in the examples below.</p>
<div class="wp-caption aligncenter" id="attachment_2588" style="width: 810px"><img alt="Example MNIST images" class="size-full wp-image-2588" height="600" sizes="(max-width: 800px) 100vw, 800px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Example-MNIST-images.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Example-MNIST-images.png 800w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Example-MNIST-images-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Example-MNIST-images-768x576.png 768w" width="800"/><p class="wp-caption-text">Example MNIST images</p></div>
<h2>Feature Standardization</h2>
<p>It is also possible to standardize pixel values across the entire dataset. This is called feature standardization and mirrors the type of standardization often performed for each column in a tabular dataset.</p>
<p>You can perform feature standardization by setting the featurewise_center and featurewise_std_normalization arguments on the ImageDataGenerator class. These are in fact set to True by default and creating an instance of ImageDataGenerator with no arguments will have the same effect.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6f1b9da9805563788" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Standardize images across the dataset, mean=0, stdev=1
from keras.datasets import mnist
from keras.preprocessing.image import ImageDataGenerator
from matplotlib import pyplot
from keras import backend as K
K.set_image_dim_ordering('th')
# load data
(X_train, y_train), (X_test, y_test) = mnist.load_data()
# reshape to be [samples][pixels][width][height]
X_train = X_train.reshape(X_train.shape[0], 1, 28, 28)
X_test = X_test.reshape(X_test.shape[0], 1, 28, 28)
# convert from int to float
X_train = X_train.astype('float32')
X_test = X_test.astype('float32')
# define data preparation
datagen = ImageDataGenerator(featurewise_center=True, featurewise_std_normalization=True)
# fit parameters from data
datagen.fit(X_train)
# configure batch size and retrieve one batch of images
for X_batch, y_batch in datagen.flow(X_train, y_train, batch_size=9):
	# create a grid of 3x3 images
	for i in range(0, 9):
		pyplot.subplot(330 + 1 + i)
		pyplot.imshow(X_batch[i].reshape(28, 28), cmap=pyplot.get_cmap('gray'))
	# show the plot
	pyplot.show()
	break</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6f1b9da9805563788-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9da9805563788-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9da9805563788-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9da9805563788-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9da9805563788-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9da9805563788-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9da9805563788-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9da9805563788-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9da9805563788-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9da9805563788-10">10</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9da9805563788-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9da9805563788-12">12</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9da9805563788-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9da9805563788-14">14</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9da9805563788-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9da9805563788-16">16</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9da9805563788-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9da9805563788-18">18</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9da9805563788-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9da9805563788-20">20</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9da9805563788-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9da9805563788-22">22</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9da9805563788-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9da9805563788-24">24</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9da9805563788-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9da9805563788-26">26</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9da9805563788-27">27</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6f1b9da9805563788-1"><span class="crayon-p"># Standardize images across the dataset, mean=0, stdev=1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9da9805563788-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">mnist</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9da9805563788-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">image </span><span class="crayon-e">import </span><span class="crayon-e">ImageDataGenerator</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9da9805563788-4"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9da9805563788-5"><span class="crayon-e">from </span><span class="crayon-e">keras </span><span class="crayon-e">import </span><span class="crayon-e">backend </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">K</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9da9805563788-6"><span class="crayon-v">K</span><span class="crayon-sy">.</span><span class="crayon-e">set_image_dim_ordering</span><span class="crayon-sy">(</span><span class="crayon-s">'th'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9da9805563788-7"><span class="crayon-p"># load data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9da9805563788-8"><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9da9805563788-9"><span class="crayon-p"># reshape to be [samples][pixels][width][height]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9da9805563788-10"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9da9805563788-11"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9da9805563788-12"><span class="crayon-p"># convert from int to float</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9da9805563788-13"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9da9805563788-14"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9da9805563788-15"><span class="crayon-p"># define data preparation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9da9805563788-16"><span class="crayon-v">datagen</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ImageDataGenerator</span><span class="crayon-sy">(</span><span class="crayon-v">featurewise_center</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">featurewise_std_normalization</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9da9805563788-17"><span class="crayon-p"># fit parameters from data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9da9805563788-18"><span class="crayon-v">datagen</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9da9805563788-19"><span class="crayon-p"># configure batch size and retrieve one batch of images</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9da9805563788-20"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">X_batch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">y_batch </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">datagen</span><span class="crayon-sy">.</span><span class="crayon-e">flow</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">9</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9da9805563788-21"><span class="crayon-h"> </span><span class="crayon-p"># create a grid of 3x3 images</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9da9805563788-22"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9da9805563788-23"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">330</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9da9805563788-24"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">X_batch</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-o">=</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">get_cmap</span><span class="crayon-sy">(</span><span class="crayon-s">'gray'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9da9805563788-25"><span class="crayon-h"> </span><span class="crayon-p"># show the plot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9da9805563788-26"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9da9805563788-27"><span class="crayon-h"> </span><span class="crayon-st">break</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0016 seconds] -->
<p>Running this example you can see that the effect is different, seemingly darkening and lightening different digits.</p>
<div class="wp-caption aligncenter" id="attachment_2590" style="width: 810px"><img alt="Standardized Feature MNIST Images" class="size-full wp-image-2590" height="600" sizes="(max-width: 800px) 100vw, 800px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Standardized-Feature-MNIST-Images.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Standardized-Feature-MNIST-Images.png 800w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Standardized-Feature-MNIST-Images-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Standardized-Feature-MNIST-Images-768x576.png 768w" width="800"/><p class="wp-caption-text">Standardized Feature MNIST Images</p></div>
<h2>ZCA Whitening</h2>
<p>A <a href="https://en.wikipedia.org/wiki/Whitening_transformation">whitening transform</a> of an image is a linear algebra operation that reduces the redundancy in the matrix of pixel images.</p>
<p>Less redundancy in the image is intended to better highlight the structures and features in the image to the learning algorithm.</p>
<p>Typically, image whitening is performed using the Principal Component Analysis (PCA) technique. More recently, an alternative called <a href="http://ufldl.stanford.edu/wiki/index.php/Whitening">ZCA</a> (<a href="http://www.cs.toronto.edu/~kriz/learning-features-2009-TR.pdf">learn more in Appendix A of this tech report</a>) shows better results and results in transformed images that keeps all of the original dimensions and unlike PCA, resulting transformed images still look like their originals.</p>
<p>You can perform a ZCA whitening transform by setting the zca_whitening argument to True.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6f1b9db0672233717" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# ZCA whitening
from keras.datasets import mnist
from keras.preprocessing.image import ImageDataGenerator
from matplotlib import pyplot
from keras import backend as K
K.set_image_dim_ordering('th')
# load data
(X_train, y_train), (X_test, y_test) = mnist.load_data()
# reshape to be [samples][pixels][width][height]
X_train = X_train.reshape(X_train.shape[0], 1, 28, 28)
X_test = X_test.reshape(X_test.shape[0], 1, 28, 28)
# convert from int to float
X_train = X_train.astype('float32')
X_test = X_test.astype('float32')
# define data preparation
datagen = ImageDataGenerator(zca_whitening=True)
# fit parameters from data
datagen.fit(X_train)
# configure batch size and retrieve one batch of images
for X_batch, y_batch in datagen.flow(X_train, y_train, batch_size=9):
	# create a grid of 3x3 images
	for i in range(0, 9):
		pyplot.subplot(330 + 1 + i)
		pyplot.imshow(X_batch[i].reshape(28, 28), cmap=pyplot.get_cmap('gray'))
	# show the plot
	pyplot.show()
	break</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6f1b9db0672233717-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db0672233717-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db0672233717-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db0672233717-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db0672233717-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db0672233717-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db0672233717-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db0672233717-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db0672233717-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db0672233717-10">10</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db0672233717-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db0672233717-12">12</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db0672233717-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db0672233717-14">14</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db0672233717-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db0672233717-16">16</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db0672233717-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db0672233717-18">18</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db0672233717-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db0672233717-20">20</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db0672233717-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db0672233717-22">22</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db0672233717-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db0672233717-24">24</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db0672233717-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db0672233717-26">26</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db0672233717-27">27</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6f1b9db0672233717-1"><span class="crayon-p"># ZCA whitening</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db0672233717-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">mnist</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db0672233717-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">image </span><span class="crayon-e">import </span><span class="crayon-e">ImageDataGenerator</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db0672233717-4"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db0672233717-5"><span class="crayon-e">from </span><span class="crayon-e">keras </span><span class="crayon-e">import </span><span class="crayon-e">backend </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">K</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db0672233717-6"><span class="crayon-v">K</span><span class="crayon-sy">.</span><span class="crayon-e">set_image_dim_ordering</span><span class="crayon-sy">(</span><span class="crayon-s">'th'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db0672233717-7"><span class="crayon-p"># load data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db0672233717-8"><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db0672233717-9"><span class="crayon-p"># reshape to be [samples][pixels][width][height]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db0672233717-10"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db0672233717-11"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db0672233717-12"><span class="crayon-p"># convert from int to float</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db0672233717-13"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db0672233717-14"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db0672233717-15"><span class="crayon-p"># define data preparation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db0672233717-16"><span class="crayon-v">datagen</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ImageDataGenerator</span><span class="crayon-sy">(</span><span class="crayon-v">zca_whitening</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db0672233717-17"><span class="crayon-p"># fit parameters from data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db0672233717-18"><span class="crayon-v">datagen</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db0672233717-19"><span class="crayon-p"># configure batch size and retrieve one batch of images</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db0672233717-20"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">X_batch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">y_batch </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">datagen</span><span class="crayon-sy">.</span><span class="crayon-e">flow</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">9</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db0672233717-21"><span class="crayon-h"> </span><span class="crayon-p"># create a grid of 3x3 images</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db0672233717-22"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db0672233717-23"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">330</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db0672233717-24"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">X_batch</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-o">=</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">get_cmap</span><span class="crayon-sy">(</span><span class="crayon-s">'gray'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db0672233717-25"><span class="crayon-h"> </span><span class="crayon-p"># show the plot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db0672233717-26"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db0672233717-27"><span class="crayon-h"> </span><span class="crayon-st">break</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0015 seconds] -->
<p>Running the example, you can see the same general structure in the images and how the outline of each digit has been highlighted.</p>
<div class="wp-caption aligncenter" id="attachment_2591" style="width: 810px"><img alt="ZCA Whitening MNIST Images" class="size-full wp-image-2591" height="600" sizes="(max-width: 800px) 100vw, 800px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/ZCA-Whitening-MNIST-Images.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/ZCA-Whitening-MNIST-Images.png 800w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/ZCA-Whitening-MNIST-Images-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/ZCA-Whitening-MNIST-Images-768x576.png 768w" width="800"/><p class="wp-caption-text">ZCA Whitening MNIST Images</p></div>
<h2>Random Rotations</h2>
<p>Sometimes images in your sample data may have varying and different rotations in the scene.</p>
<p>You can train your model to better handle rotations of images by artificially and randomly rotating images from your dataset during training.</p>
<p>The example below creates random rotations of the MNIST digits up to 90 degrees by setting the rotation_range argument.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6f1b9db3113850202" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Random Rotations
from keras.datasets import mnist
from keras.preprocessing.image import ImageDataGenerator
from matplotlib import pyplot
from keras import backend as K
K.set_image_dim_ordering('th')
# load data
(X_train, y_train), (X_test, y_test) = mnist.load_data()
# reshape to be [samples][pixels][width][height]
X_train = X_train.reshape(X_train.shape[0], 1, 28, 28)
X_test = X_test.reshape(X_test.shape[0], 1, 28, 28)
# convert from int to float
X_train = X_train.astype('float32')
X_test = X_test.astype('float32')
# define data preparation
datagen = ImageDataGenerator(rotation_range=90)
# fit parameters from data
datagen.fit(X_train)
# configure batch size and retrieve one batch of images
for X_batch, y_batch in datagen.flow(X_train, y_train, batch_size=9):
	# create a grid of 3x3 images
	for i in range(0, 9):
		pyplot.subplot(330 + 1 + i)
		pyplot.imshow(X_batch[i].reshape(28, 28), cmap=pyplot.get_cmap('gray'))
	# show the plot
	pyplot.show()
	break</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6f1b9db3113850202-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db3113850202-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db3113850202-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db3113850202-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db3113850202-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db3113850202-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db3113850202-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db3113850202-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db3113850202-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db3113850202-10">10</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db3113850202-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db3113850202-12">12</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db3113850202-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db3113850202-14">14</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db3113850202-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db3113850202-16">16</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db3113850202-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db3113850202-18">18</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db3113850202-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db3113850202-20">20</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db3113850202-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db3113850202-22">22</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db3113850202-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db3113850202-24">24</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db3113850202-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db3113850202-26">26</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db3113850202-27">27</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6f1b9db3113850202-1"><span class="crayon-p"># Random Rotations</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db3113850202-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">mnist</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db3113850202-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">image </span><span class="crayon-e">import </span><span class="crayon-e">ImageDataGenerator</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db3113850202-4"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db3113850202-5"><span class="crayon-e">from </span><span class="crayon-e">keras </span><span class="crayon-e">import </span><span class="crayon-e">backend </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">K</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db3113850202-6"><span class="crayon-v">K</span><span class="crayon-sy">.</span><span class="crayon-e">set_image_dim_ordering</span><span class="crayon-sy">(</span><span class="crayon-s">'th'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db3113850202-7"><span class="crayon-p"># load data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db3113850202-8"><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db3113850202-9"><span class="crayon-p"># reshape to be [samples][pixels][width][height]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db3113850202-10"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db3113850202-11"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db3113850202-12"><span class="crayon-p"># convert from int to float</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db3113850202-13"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db3113850202-14"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db3113850202-15"><span class="crayon-p"># define data preparation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db3113850202-16"><span class="crayon-v">datagen</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ImageDataGenerator</span><span class="crayon-sy">(</span><span class="crayon-v">rotation_range</span><span class="crayon-o">=</span><span class="crayon-cn">90</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db3113850202-17"><span class="crayon-p"># fit parameters from data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db3113850202-18"><span class="crayon-v">datagen</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db3113850202-19"><span class="crayon-p"># configure batch size and retrieve one batch of images</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db3113850202-20"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">X_batch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">y_batch </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">datagen</span><span class="crayon-sy">.</span><span class="crayon-e">flow</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">9</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db3113850202-21"><span class="crayon-h"> </span><span class="crayon-p"># create a grid of 3x3 images</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db3113850202-22"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db3113850202-23"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">330</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db3113850202-24"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">X_batch</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-o">=</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">get_cmap</span><span class="crayon-sy">(</span><span class="crayon-s">'gray'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db3113850202-25"><span class="crayon-h"> </span><span class="crayon-p"># show the plot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db3113850202-26"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db3113850202-27"><span class="crayon-h"> </span><span class="crayon-st">break</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0027 seconds] -->
<p>Running the example, you can see that images have been rotated left and right up to a limit of 90 degrees. This is not helpful on this problem because the MNIST digits have a normalized orientation, but this transform might be of help when learning from photographs where the objects may have different orientations.</p>
<div class="wp-caption aligncenter" id="attachment_2592" style="width: 810px"><img alt="Random Rotations of MNIST Images" class="size-full wp-image-2592" height="600" sizes="(max-width: 800px) 100vw, 800px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Random-Rotations-of-MNIST-Images.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Random-Rotations-of-MNIST-Images.png 800w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Random-Rotations-of-MNIST-Images-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Random-Rotations-of-MNIST-Images-768x576.png 768w" width="800"/><p class="wp-caption-text">Random Rotations of MNIST Images</p></div>
<h2>Random Shifts</h2>
<p>Objects in your images may not be centered in the frame. They may be off-center in a variety of different ways.</p>
<p>You can train your deep learning network to expect and currently handle off-center objects by artificially creating shifted versions of your training data. Keras supports separate horizontal and vertical random shifting of training data by the width_shift_range and height_shift_range arguments.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6f1b9db5735845971" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Random Shifts
from keras.datasets import mnist
from keras.preprocessing.image import ImageDataGenerator
from matplotlib import pyplot
from keras import backend as K
K.set_image_dim_ordering('th')
# load data
(X_train, y_train), (X_test, y_test) = mnist.load_data()
# reshape to be [samples][pixels][width][height]
X_train = X_train.reshape(X_train.shape[0], 1, 28, 28)
X_test = X_test.reshape(X_test.shape[0], 1, 28, 28)
# convert from int to float
X_train = X_train.astype('float32')
X_test = X_test.astype('float32')
# define data preparation
shift = 0.2
datagen = ImageDataGenerator(width_shift_range=shift, height_shift_range=shift)
# fit parameters from data
datagen.fit(X_train)
# configure batch size and retrieve one batch of images
for X_batch, y_batch in datagen.flow(X_train, y_train, batch_size=9):
	# create a grid of 3x3 images
	for i in range(0, 9):
		pyplot.subplot(330 + 1 + i)
		pyplot.imshow(X_batch[i].reshape(28, 28), cmap=pyplot.get_cmap('gray'))
	# show the plot
	pyplot.show()
	break</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6f1b9db5735845971-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db5735845971-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db5735845971-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db5735845971-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db5735845971-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db5735845971-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db5735845971-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db5735845971-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db5735845971-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db5735845971-10">10</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db5735845971-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db5735845971-12">12</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db5735845971-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db5735845971-14">14</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db5735845971-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db5735845971-16">16</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db5735845971-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db5735845971-18">18</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db5735845971-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db5735845971-20">20</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db5735845971-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db5735845971-22">22</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db5735845971-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db5735845971-24">24</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db5735845971-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db5735845971-26">26</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db5735845971-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db5735845971-28">28</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6f1b9db5735845971-1"><span class="crayon-p"># Random Shifts</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db5735845971-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">mnist</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db5735845971-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">image </span><span class="crayon-e">import </span><span class="crayon-e">ImageDataGenerator</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db5735845971-4"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db5735845971-5"><span class="crayon-e">from </span><span class="crayon-e">keras </span><span class="crayon-e">import </span><span class="crayon-e">backend </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">K</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db5735845971-6"><span class="crayon-v">K</span><span class="crayon-sy">.</span><span class="crayon-e">set_image_dim_ordering</span><span class="crayon-sy">(</span><span class="crayon-s">'th'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db5735845971-7"><span class="crayon-p"># load data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db5735845971-8"><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db5735845971-9"><span class="crayon-p"># reshape to be [samples][pixels][width][height]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db5735845971-10"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db5735845971-11"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db5735845971-12"><span class="crayon-p"># convert from int to float</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db5735845971-13"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db5735845971-14"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db5735845971-15"><span class="crayon-p"># define data preparation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db5735845971-16"><span class="crayon-v">shift</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db5735845971-17"><span class="crayon-v">datagen</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ImageDataGenerator</span><span class="crayon-sy">(</span><span class="crayon-v">width_shift_range</span><span class="crayon-o">=</span><span class="crayon-v">shift</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">height_shift_range</span><span class="crayon-o">=</span><span class="crayon-v">shift</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db5735845971-18"><span class="crayon-p"># fit parameters from data</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db5735845971-19"><span class="crayon-v">datagen</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db5735845971-20"><span class="crayon-p"># configure batch size and retrieve one batch of images</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db5735845971-21"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">X_batch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">y_batch </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">datagen</span><span class="crayon-sy">.</span><span class="crayon-e">flow</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">9</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db5735845971-22"><span class="crayon-h"> </span><span class="crayon-p"># create a grid of 3x3 images</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db5735845971-23"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db5735845971-24"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">330</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db5735845971-25"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">X_batch</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-o">=</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">get_cmap</span><span class="crayon-sy">(</span><span class="crayon-s">'gray'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db5735845971-26"><span class="crayon-h"> </span><span class="crayon-p"># show the plot</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db5735845971-27"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db5735845971-28"><span class="crayon-h"> </span><span class="crayon-st">break</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0030 seconds] -->
<p>Running this example creates shifted versions of the digits. Again, this is not required for MNIST as the handwritten digits are already centered, but you can see how this might be useful on more complex problem domains.</p>
<div class="wp-caption aligncenter" id="attachment_2593" style="width: 810px"><img alt="Random Shifted MNIST Images" class="size-full wp-image-2593" height="600" sizes="(max-width: 800px) 100vw, 800px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Random-Shifted-MNIST-Images.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Random-Shifted-MNIST-Images.png 800w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Random-Shifted-MNIST-Images-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Random-Shifted-MNIST-Images-768x576.png 768w" width="800"/><p class="wp-caption-text">Random Shifted MNIST Images</p></div>
<h2>Random Flips</h2>
<p>Another augmentation to your image data that can improve performance on large and complex problems is to create random flips of images in your training data.</p>
<p>Keras supports random flipping along both the vertical and horizontal axes using the vertical_flip and horizontal_flip arguments.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6f1b9db7146192190" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Random Flips
from keras.datasets import mnist
from keras.preprocessing.image import ImageDataGenerator
from matplotlib import pyplot
from keras import backend as K
K.set_image_dim_ordering('th')
# load data
(X_train, y_train), (X_test, y_test) = mnist.load_data()
# reshape to be [samples][pixels][width][height]
X_train = X_train.reshape(X_train.shape[0], 1, 28, 28)
X_test = X_test.reshape(X_test.shape[0], 1, 28, 28)
# convert from int to float
X_train = X_train.astype('float32')
X_test = X_test.astype('float32')
# define data preparation
datagen = ImageDataGenerator(horizontal_flip=True, vertical_flip=True)
# fit parameters from data
datagen.fit(X_train)
# configure batch size and retrieve one batch of images
for X_batch, y_batch in datagen.flow(X_train, y_train, batch_size=9):
	# create a grid of 3x3 images
	for i in range(0, 9):
		pyplot.subplot(330 + 1 + i)
		pyplot.imshow(X_batch[i].reshape(28, 28), cmap=pyplot.get_cmap('gray'))
	# show the plot
	pyplot.show()
	break</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6f1b9db7146192190-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db7146192190-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db7146192190-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db7146192190-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db7146192190-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db7146192190-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db7146192190-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db7146192190-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db7146192190-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db7146192190-10">10</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db7146192190-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db7146192190-12">12</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db7146192190-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db7146192190-14">14</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db7146192190-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db7146192190-16">16</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db7146192190-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db7146192190-18">18</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db7146192190-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db7146192190-20">20</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db7146192190-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db7146192190-22">22</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db7146192190-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db7146192190-24">24</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db7146192190-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9db7146192190-26">26</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9db7146192190-27">27</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6f1b9db7146192190-1"><span class="crayon-p"># Random Flips</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db7146192190-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">mnist</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db7146192190-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">image </span><span class="crayon-e">import </span><span class="crayon-e">ImageDataGenerator</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db7146192190-4"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db7146192190-5"><span class="crayon-e">from </span><span class="crayon-e">keras </span><span class="crayon-e">import </span><span class="crayon-e">backend </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">K</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db7146192190-6"><span class="crayon-v">K</span><span class="crayon-sy">.</span><span class="crayon-e">set_image_dim_ordering</span><span class="crayon-sy">(</span><span class="crayon-s">'th'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db7146192190-7"><span class="crayon-p"># load data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db7146192190-8"><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db7146192190-9"><span class="crayon-p"># reshape to be [samples][pixels][width][height]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db7146192190-10"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db7146192190-11"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db7146192190-12"><span class="crayon-p"># convert from int to float</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db7146192190-13"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db7146192190-14"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db7146192190-15"><span class="crayon-p"># define data preparation</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db7146192190-16"><span class="crayon-v">datagen</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ImageDataGenerator</span><span class="crayon-sy">(</span><span class="crayon-v">horizontal_flip</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vertical_flip</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db7146192190-17"><span class="crayon-p"># fit parameters from data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db7146192190-18"><span class="crayon-v">datagen</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db7146192190-19"><span class="crayon-p"># configure batch size and retrieve one batch of images</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db7146192190-20"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">X_batch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">y_batch </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">datagen</span><span class="crayon-sy">.</span><span class="crayon-e">flow</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">9</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db7146192190-21"><span class="crayon-h"> </span><span class="crayon-p"># create a grid of 3x3 images</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db7146192190-22"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db7146192190-23"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">330</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db7146192190-24"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">X_batch</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-o">=</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">get_cmap</span><span class="crayon-sy">(</span><span class="crayon-s">'gray'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db7146192190-25"><span class="crayon-h"> </span><span class="crayon-p"># show the plot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9db7146192190-26"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9db7146192190-27"><span class="crayon-h"> </span><span class="crayon-st">break</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0027 seconds] -->
<p>Running this example you can see flipped digits. Flipping digits is not useful as they will always have the correct left and right orientation, but this may be useful for problems with photographs of objects in a scene that can have a varied orientation.</p>
<div class="wp-caption aligncenter" id="attachment_2594" style="width: 810px"><img alt="Randomly Flipped MNIST Images" class="size-full wp-image-2594" height="600" sizes="(max-width: 800px) 100vw, 800px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Randomly-Flipped-MNIST-Images.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Randomly-Flipped-MNIST-Images.png 800w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Randomly-Flipped-MNIST-Images-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Randomly-Flipped-MNIST-Images-768x576.png 768w" width="800"/><p class="wp-caption-text">Randomly Flipped MNIST Images</p></div>
<h2>Saving Augmented Images to File</h2>
<p>The data preparation and augmentation is performed just in time by Keras.</p>
<p>This is efficient in terms of memory, but you may require the exact images used during training. For example, perhaps you would like to use them with a different software package later or only generate them once and use them on multiple different deep learning models or configurations.</p>
<p>Keras allows you to save the images generated during training. The directory, filename prefix and image file type can be specified to the flow() function before training. Then, during training, the generated images will be written to file.</p>
<p>The example below demonstrates this and writes 9 images to a “images” subdirectory with the prefix “aug” and the file type of PNG.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6f1b9dc9470828500" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Save augmented images to file
from keras.datasets import mnist
from keras.preprocessing.image import ImageDataGenerator
from matplotlib import pyplot
import os
from keras import backend as K
K.set_image_dim_ordering('th')
# load data
(X_train, y_train), (X_test, y_test) = mnist.load_data()
# reshape to be [samples][pixels][width][height]
X_train = X_train.reshape(X_train.shape[0], 1, 28, 28)
X_test = X_test.reshape(X_test.shape[0], 1, 28, 28)
# convert from int to float
X_train = X_train.astype('float32')
X_test = X_test.astype('float32')
# define data preparation
datagen = ImageDataGenerator()
# fit parameters from data
datagen.fit(X_train)
# configure batch size and retrieve one batch of images
os.makedirs('images')
for X_batch, y_batch in datagen.flow(X_train, y_train, batch_size=9, save_to_dir='images', save_prefix='aug', save_format='png'):
	# create a grid of 3x3 images
	for i in range(0, 9):
		pyplot.subplot(330 + 1 + i)
		pyplot.imshow(X_batch[i].reshape(28, 28), cmap=pyplot.get_cmap('gray'))
	# show the plot
	pyplot.show()
	break</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6f1b9dc9470828500-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9dc9470828500-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9dc9470828500-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9dc9470828500-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9dc9470828500-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9dc9470828500-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9dc9470828500-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9dc9470828500-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9dc9470828500-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9dc9470828500-10">10</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9dc9470828500-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9dc9470828500-12">12</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9dc9470828500-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9dc9470828500-14">14</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9dc9470828500-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9dc9470828500-16">16</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9dc9470828500-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9dc9470828500-18">18</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9dc9470828500-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9dc9470828500-20">20</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9dc9470828500-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9dc9470828500-22">22</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9dc9470828500-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9dc9470828500-24">24</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9dc9470828500-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9dc9470828500-26">26</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9dc9470828500-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1b9dc9470828500-28">28</div><div class="crayon-num" data-line="crayon-5c0ca6f1b9dc9470828500-29">29</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6f1b9dc9470828500-1"><span class="crayon-p"># Save augmented images to file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9dc9470828500-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">mnist</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9dc9470828500-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">image </span><span class="crayon-e">import </span><span class="crayon-e">ImageDataGenerator</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9dc9470828500-4"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9dc9470828500-5"><span class="crayon-e">import </span><span class="crayon-e">os</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9dc9470828500-6"><span class="crayon-e">from </span><span class="crayon-e">keras </span><span class="crayon-e">import </span><span class="crayon-e">backend </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">K</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9dc9470828500-7"><span class="crayon-v">K</span><span class="crayon-sy">.</span><span class="crayon-e">set_image_dim_ordering</span><span class="crayon-sy">(</span><span class="crayon-s">'th'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9dc9470828500-8"><span class="crayon-p"># load data</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9dc9470828500-9"><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9dc9470828500-10"><span class="crayon-p"># reshape to be [samples][pixels][width][height]</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9dc9470828500-11"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9dc9470828500-12"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9dc9470828500-13"><span class="crayon-p"># convert from int to float</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9dc9470828500-14"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9dc9470828500-15"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9dc9470828500-16"><span class="crayon-p"># define data preparation</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9dc9470828500-17"><span class="crayon-v">datagen</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ImageDataGenerator</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9dc9470828500-18"><span class="crayon-p"># fit parameters from data</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9dc9470828500-19"><span class="crayon-v">datagen</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9dc9470828500-20"><span class="crayon-p"># configure batch size and retrieve one batch of images</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9dc9470828500-21"><span class="crayon-v">os</span><span class="crayon-sy">.</span><span class="crayon-e">makedirs</span><span class="crayon-sy">(</span><span class="crayon-s">'images'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9dc9470828500-22"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">X_batch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">y_batch </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">datagen</span><span class="crayon-sy">.</span><span class="crayon-e">flow</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">save_to_dir</span><span class="crayon-o">=</span><span class="crayon-s">'images'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">save_prefix</span><span class="crayon-o">=</span><span class="crayon-s">'aug'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">save_format</span><span class="crayon-o">=</span><span class="crayon-s">'png'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9dc9470828500-23"><span class="crayon-h"> </span><span class="crayon-p"># create a grid of 3x3 images</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9dc9470828500-24"><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9dc9470828500-25"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">330</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9dc9470828500-26"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">X_batch</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-o">=</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">get_cmap</span><span class="crayon-sy">(</span><span class="crayon-s">'gray'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9dc9470828500-27"><span class="crayon-h"> </span><span class="crayon-p"># show the plot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1b9dc9470828500-28"><span class="crayon-h"> </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1b9dc9470828500-29"><span class="crayon-h"> </span><span class="crayon-st">break</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0026 seconds] -->
<p>Running the example you can see that images are only written when they are generated.</p>
<div class="wp-caption aligncenter" id="attachment_2595" style="width: 553px"><img alt="Augmented MNIST Images Saved To File" class="size-full wp-image-2595" height="342" sizes="(max-width: 543px) 100vw, 543px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Augmented-MNIST-Images-Saved-To-File.png" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Augmented-MNIST-Images-Saved-To-File.png 543w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/Augmented-MNIST-Images-Saved-To-File-300x189.png 300w" width="543"/><p class="wp-caption-text">Augmented MNIST Images Saved To File</p></div>
<h2>Tips For Augmenting Image Data with Keras</h2>
<p>Image data is unique in that you can review the data and transformed copies of the data and quickly get an idea of how the model may be perceive it by your model.</p>
<p>Below are some times for getting the most from image data preparation and augmentation for deep learning.</p>
<ul>
<li><strong>Review Dataset</strong>. Take some time to review your dataset in great detail. Look at the images. Take note of image preparation and augmentations that might benefit the training process of your model, such as the need to handle different shifts, rotations or flips of objects in the scene.</li>
<li><strong>Review Augmentations</strong>. Review sample images after the augmentation has been performed. It is one thing to intellectually know what image transforms you are using, it is a very different thing to look at examples. Review images both with individual augmentations you are using as well as the full set of augmentations you plan to use. You may see ways to simplify or further enhance your model training process.</li>
<li><strong>Evaluate a Suite of Transforms</strong>. Try more than one image data preparation and augmentation scheme. Often you can be surprised by results of a data preparation scheme you did not think would be beneficial.</li>
</ul>
<h2>Summary</h2>
<p>In this post you discovered image data preparation and augmentation.</p>
<p>You discovered a range of techniques that you can use easily in Python with Keras for deep learning models. You learned about:</p>
<ul>
<li>The ImageDataGenerator API in Keras for generating transformed images just in time.</li>
<li>Sample-wise and Feature wise pixel standardization.</li>
<li>The ZCA whitening transform.</li>
<li>Random rotations, shifts and flips of images.</li>
<li>How to save transformed images to file for later reuse.</li>
</ul>
<p>Do you have any questions about image data augmentation or this post? Ask your questions in the comments and I will do my best to answer.</p>
<!-- Shortcoder conditions not met -->
<div class="awac-wrapper"><div class="awac widget text-35"> <div class="textwidget"><div class="woo-sc-hr"></div>
<h2 style="text-align: center;">Frustrated With Your Progress In Deep Learning?</h2>
<p><a href="/deep-learning-with-python/"><img align="left" alt="Deep Learning with Python" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/DeepLearningWithPython-220.png" style="border: 0;"/></a></p>
<h4 style="text-align: center;"> What If You Could Develop A Network in Minutes</h4>
<p style="text-align: center;">…with just a few lines of Python</p>
<p style="text-align: center;">Discover how in my new Ebook: <a href="https://machinelearningmastery.com/deep-learning-with-python/">Deep Learning With Python</a></p>
<p style="text-align: center;">It covers <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> on topics like:<br/>
<em>Multilayer Perceptrons</em>, <em>Convolutional Nets</em> and <em>Recurrent Neural Nets</em>, and more…</p>
<h4 style="text-align: center;">Finally Bring Deep Learning To<br/>
Your Own Projects</h4>
<p style="text-align: center;">Skip the Academics. Just Results.</p>
<p style="text-align: center;"><a href="https://machinelearningmastery.com/deep-learning-with-python/">Click to learn more</a>.</p>
<div class="woo-sc-hr"></div>
</div>
</div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-2587 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=Image+Augmentation+for+Deep+Learning+With+Keras&amp;url=https://machinelearningmastery.com/image-augmentation-deep-learning-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/image-augmentation-deep-learning-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/image-augmentation-deep-learning-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/image-augmentation-deep-learning-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
</section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/standard-machine-learning-datasets-used-practice-weka/" rel="prev"><i class="fa fa-angle-left"></i> Standard Machine Learning Datasets To Practice in Weka</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/better-understand-machine-learning-data-weka/" rel="next">How to Better Understand Your Machine Learning Data in Weka <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">127 Responses to <em>Image Augmentation for Deep Learning With Keras</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-358564">
<div class="comment-container" id="li-comment-358564">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d84bd4e6951b12dd358bfef0d23aba04?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d84bd4e6951b12dd358bfef0d23aba04?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Andy</span>
<span class="date">August 2, 2016 at 7:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-358564" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Interesting tutorial.</p>
<p>I’m working through the step to standardize images across the dataset and run into the following error:</p>
<p>AttributeError                            Traceback (most recent call last)<br/>
 in ()<br/>
     18 datagen.flow(X_train, y_train, batch_size=9)<br/>
     19 # retrieve one batch of images<br/>
—&gt; 20 X_batch, y_batch = datagen.next()<br/>
     21 # create a grid of 3×3 images<br/>
     22 for i in range(0, 9):</p>
<p>AttributeError: ‘ImageDataGenerator’ object has no attribute ‘next’</p>
<p>I have checked the Keras documentation and see no mention of a next attribute. </p>
<p>Perhaps I’m missing something.</p>
<p>Thanks for the great tutorials!</p>
<div class="reply">
<a aria-label="Reply to Andy" class="comment-reply-link" href="#comment-358564" onclick='return addComment.moveForm( "comment-358564", "358564", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-358566">
<div class="comment-container" id="li-comment-358566">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 2, 2016 at 8:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-358566" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yep, the API has changed. See:<br/>
<a href="https://keras.io/preprocessing/image/" rel="nofollow">https://keras.io/preprocessing/image/</a></p>
<p>I will update all of the examples ASAP.</p>
<p>UPDATE: I have updated all examples in this post to use the new API. Let me know if you have any problems at all.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-358566" onclick='return addComment.moveForm( "comment-358566", "358566", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-358683">
<div class="comment-container" id="li-comment-358683">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d84bd4e6951b12dd358bfef0d23aba04?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d84bd4e6951b12dd358bfef0d23aba04?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Andy</span>
<span class="date">August 3, 2016 at 9:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-358683" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Works like a charm! Thanks</p>
<div class="reply">
<a aria-label="Reply to Andy" class="comment-reply-link" href="#comment-358683" onclick='return addComment.moveForm( "comment-358683", "358683", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-358684">
<div class="comment-container" id="li-comment-358684">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 3, 2016 at 9:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-358684" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear it Andy.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-358684" onclick='return addComment.moveForm( "comment-358684", "358684", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-359337">
<div class="comment-container" id="li-comment-359337">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5f7cb57fdc09c24fb953735ce06ea58b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5f7cb57fdc09c24fb953735ce06ea58b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">narayan</span>
<span class="date">August 9, 2016 at 6:38 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-359337" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>for X_batch, y_batch in datagen.flow(X_train, y_train, batch_size=9):<br/>
  File “/usr/local/lib/python2.7/dist-packages/keras/preprocessing/image.py”, line 475, in next<br/>
    x = self.image_data_generator.random_transform(x.astype(‘float32’))<br/>
  File “/usr/local/lib/python2.7/dist-packages/keras/preprocessing/image.py”, line 346, in random_transform<br/>
    fill_mode=self.fill_mode, cval=self.cval)<br/>
  File “/usr/local/lib/python2.7/dist-packages/keras/preprocessing/image.py”, line 109, in apply_transform<br/>
    x = np.stack(channel_images, axis=0)<br/>
AttributeError: ‘module’ object has no attribute ‘stack’</p>
<p>how to solve this error …?</p>
<div class="reply">
<a aria-label="Reply to narayan" class="comment-reply-link" href="#comment-359337" onclick='return addComment.moveForm( "comment-359337", "359337", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-360032">
<div class="comment-container" id="li-comment-360032">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 15, 2016 at 11:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-360032" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have not seen an error like that before. Perhaps there is a problem with your environment?</p>
<p>Consider re-installing Theano and/or Keras.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-360032" onclick='return addComment.moveForm( "comment-360032", "360032", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-361843">
<div class="comment-container" id="li-comment-361843">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5f7cb57fdc09c24fb953735ce06ea58b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5f7cb57fdc09c24fb953735ce06ea58b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">narayan</span>
<span class="date">August 26, 2016 at 9:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-361843" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>i solved this error by updating numpy version ….previously it 1.8.0..now 1.11.1..it means it should be more than 1.9.0</p>
<div class="reply">
<a aria-label="Reply to narayan" class="comment-reply-link" href="#comment-361843" onclick='return addComment.moveForm( "comment-361843", "361843", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-361968">
<div class="comment-container" id="li-comment-361968">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 27, 2016 at 11:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-361968" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great, glad to here it narayan.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-361968" onclick='return addComment.moveForm( "comment-361968", "361968", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-361844">
<div class="comment-container" id="li-comment-361844">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5f7cb57fdc09c24fb953735ce06ea58b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5f7cb57fdc09c24fb953735ce06ea58b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">narayan</span>
<span class="date">August 26, 2016 at 9:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-361844" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Now i have question that how to decide value for this parameter So that i can get good testing accuracy ..i have training dataset with 110 category with 32000 images ..</p>
<p>featurewise_center=False,<br/>
    samplewise_center=False,<br/>
    featurewise_std_normalization=False,<br/>
    samplewise_std_normalization=False,<br/>
    zca_whitening=False,<br/>
    rotation_range=0.,<br/>
    width_shift_range=0.,<br/>
    height_shift_range=0.,<br/>
    shear_range=0.,<br/>
    zoom_range=0.,<br/>
    channel_shift_range=0.,<br/>
    fill_mode=’nearest’,<br/>
    cval=0.,<br/>
    horizontal_flip=False,<br/>
    vertical_flip=False,<br/>
    rescale=None,<br/>
    dim_ordering=K.image_dim_ordering()</p>
<p>Waiting for your positive reply…</p>
<div class="reply">
<a aria-label="Reply to narayan" class="comment-reply-link" href="#comment-361844" onclick='return addComment.moveForm( "comment-361844", "361844", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-361969">
<div class="comment-container" id="li-comment-361969">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 27, 2016 at 11:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-361969" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>My advice is to try a suite of different configurations and see what works best on your problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-361969" onclick='return addComment.moveForm( "comment-361969", "361969", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-369974">
<div class="comment-container" id="li-comment-369974">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/989017ba46090b8638d722c9485a8c40?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/989017ba46090b8638d722c9485a8c40?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Walid Ahmed</span>
<span class="date">November 9, 2016 at 2:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-369974" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks a lot.<br/>
all worked fine except the last code to save images to file, I got the following exception</p>
<p>Walids-MacBook-Pro:DataAugmentation walidahmed$ python augment_save_to_file.py<br/>
Using TensorFlow backend.<br/>
Traceback (most recent call last):<br/>
  File “augment_save_to_file.py”, line 20, in<br/>
    for X_batch, y_batch in datagen.flow(X_train, y_train, batch_size=9, save_to_dir=’images’, save_prefix=’aug’, save_format=’png’):<br/>
  File “/usr/local/lib/python2.7/site-packages/keras/preprocessing/image.py”, line 490, in next<br/>
    img = array_to_img(batch_x[i], self.dim_ordering, scale=True)<br/>
  File “/usr/local/lib/python2.7/site-packages/keras/preprocessing/image.py”, line 140, in array_to_img<br/>
    raise Exception(‘Unsupported channel number: ‘, x.shape[2])<br/>
Exception: (‘Unsupported channel number: ‘, 28)</p>
<p>Any advice?<br/>
thanks again</p>
<div class="reply">
<a aria-label="Reply to Walid Ahmed" class="comment-reply-link" href="#comment-369974" onclick='return addComment.moveForm( "comment-369974", "369974", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-370073">
<div class="comment-container" id="li-comment-370073">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 9, 2016 at 9:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-370073" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Double check your version of Keras is 1.1.0 and TensorFlow is 0.10.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-370073" onclick='return addComment.moveForm( "comment-370073", "370073", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-370317">
<div class="comment-container" id="li-comment-370317">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/490dd82952719cbe02a323388c4ea705?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/490dd82952719cbe02a323388c4ea705?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sudesh</span>
<span class="date">November 11, 2016 at 9:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-370317" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>Thanks a lot for your tutorial. It is helping me in many ways.</p>
<p>I had question on mask image or target Y for training image X<br/>
Can i also transform Y along with X. Helps in the case of training for segmentation</p>
<div class="reply">
<a aria-label="Reply to Sudesh" class="comment-reply-link" href="#comment-370317" onclick='return addComment.moveForm( "comment-370317", "370317", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-370595">
<div class="comment-container" id="li-comment-370595">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/490dd82952719cbe02a323388c4ea705?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/490dd82952719cbe02a323388c4ea705?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sudesh</span>
<span class="date">November 15, 2016 at 5:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-370595" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I managed to do it. </p>
<p>datagen = ImageDataGenerator(shear_range=0.02,dim_ordering=K._image_dim_ordering,rotation_range=5,width_shift_range=0.05, height_shift_range=0.05,zoom_range=0.3,fill_mode=’constant’, cval=0)</p>
<p>for samples in range(0,100):<br/>
    seed = rd.randint(low=10,high=100000)<br/>
    for imags_batch in datagen.flow(imgs_train,batch_size=batch_size,save_to_dir=’augmented’,save_prefix=’aug’,seed=seed,save_format=’tif’):<br/>
        print(‘-‘)<br/>
        break<br/>
    for imgs_mask_batch in datagen.flow(imgs_mask_train, batch_size=batch_size, save_to_dir=’augmented’,seed=seed, save_prefix=’mask_aug’,save_format=’tif’):<br/>
         print(‘|’)<br/>
         break<br/>
    print((samples+1)*batch_size)</p>
<div class="reply">
<a aria-label="Reply to Sudesh" class="comment-reply-link" href="#comment-370595" onclick='return addComment.moveForm( "comment-370595", "370595", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-372792">
<div class="comment-container" id="li-comment-372792">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f99e43cd0ea1c8c9b838f09bf6ad4a92?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f99e43cd0ea1c8c9b838f09bf6ad4a92?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Addie</span>
<span class="date">November 29, 2016 at 6:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-372792" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is great stuff but I wonder if you could provide an example like this with an RGB image with three channels? I am getting some really buggy results personally with this ImageGenerator.</p>
<div class="reply">
<a aria-label="Reply to Addie" class="comment-reply-link" href="#comment-372792" onclick='return addComment.moveForm( "comment-372792", "372792", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-372822">
<div class="comment-container" id="li-comment-372822">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 29, 2016 at 8:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-372822" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great suggestion, thanks Addie.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-372822" onclick='return addComment.moveForm( "comment-372822", "372822", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-377249">
<div class="comment-container" id="li-comment-377249">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e5b1132a19bba619d341ba04f921846c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e5b1132a19bba619d341ba04f921846c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Lucas</span>
<span class="date">December 24, 2016 at 9:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-377249" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I wonder what <code>channel_shift_range</code> is about. The doc says “shift range for each channels”, but what does this actually mean? Is it adding a random value to each channel or doing something else?</p>
<div class="reply">
<a aria-label="Reply to Lucas" class="comment-reply-link" href="#comment-377249" onclick='return addComment.moveForm( "comment-377249", "377249", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-377641">
<div class="comment-container" id="li-comment-377641">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 26, 2016 at 7:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-377641" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have not used this one yet, sorry Lucas.</p>
<p>You could try experimenting with it or dive into the source to see what it’s all about.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-377641" onclick='return addComment.moveForm( "comment-377641", "377641", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-377748">
<div class="comment-container" id="li-comment-377748">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/27f856eb426a2f341bd6a0b35ebe4065?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/27f856eb426a2f341bd6a0b35ebe4065?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Indra</span>
<span class="date">December 26, 2016 at 5:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-377748" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>Thanks for the post. I’ve one question i.e., we do feature standardization in the training set, so while testing, we need those standardized values to apply on testing images ?</p>
<div class="reply">
<a aria-label="Reply to Indra" class="comment-reply-link" href="#comment-377748" onclick='return addComment.moveForm( "comment-377748", "377748", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-377852">
<div class="comment-container" id="li-comment-377852">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 27, 2016 at 5:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-377852" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes Indra, any transforms like standardization performed on the data prior to modeling will also need to be performed on new data when testing or making predictions.</p>
<p>In the case of standardization, we need to keep track of means and standard deviations.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-377852" onclick='return addComment.moveForm( "comment-377852", "377852", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-392264">
<div class="comment-container" id="li-comment-392264">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fe5552c5ba4d2c3d69230b79c40bedb6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fe5552c5ba4d2c3d69230b79c40bedb6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Dan</span>
<span class="date">March 11, 2017 at 11:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-392264" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks again Jason. Why do we subplot 330+1+i? Thanks</p>
<div class="reply">
<a aria-label="Reply to Dan" class="comment-reply-link" href="#comment-392264" onclick='return addComment.moveForm( "comment-392264", "392264", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-392307">
<div class="comment-container" id="li-comment-392307">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 12, 2017 at 8:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-392307" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is matplotlab syntax.</p>
<p>The 33 creates a grid of 3×3 images. The number after that (1-9) indicates the position in that grid to place the next image (left to right, top to bottom ordering).</p>
<p>I hope that helps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-392307" onclick='return addComment.moveForm( "comment-392307", "392307", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-392505">
<div class="comment-container" id="li-comment-392505">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/091105f81e430aacc532dac325386512?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/091105f81e430aacc532dac325386512?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vineeth</span>
<span class="date">March 13, 2017 at 7:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-392505" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How do I save the augmented images into a directory with a class label prefix or even better into a subdirectory of class name?</p>
<div class="reply">
<a aria-label="Reply to Vineeth" class="comment-reply-link" href="#comment-392505" onclick='return addComment.moveForm( "comment-392505", "392505", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-392579">
<div class="comment-container" id="li-comment-392579">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 14, 2017 at 8:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-392579" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question Vineeth,</p>
<p>You can specify any directory and filename prefix you like in the call to flow()</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-392579" onclick='return addComment.moveForm( "comment-392579", "392579", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-393644">
<div class="comment-container" id="li-comment-393644">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4a71cb31cf093ca75d89ac594a2cbc9e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4a71cb31cf093ca75d89ac594a2cbc9e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Richa</span>
<span class="date">March 21, 2017 at 10:45 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-393644" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>can we augment data of a particular class. I mean images of a class which are less, to deal with the class imbalance problem.</p>
<div class="reply">
<a aria-label="Reply to Richa" class="comment-reply-link" href="#comment-393644" onclick='return addComment.moveForm( "comment-393644", "393644", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-393707">
<div class="comment-container" id="li-comment-393707">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 22, 2017 at 8:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-393707" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great idea.</p>
<p>Yes, but you may need to prepare the data for each class separately.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-393707" onclick='return addComment.moveForm( "comment-393707", "393707", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-394228">
<div class="comment-container" id="li-comment-394228">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0d6c45aec57c462cff21823ce99adb1d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0d6c45aec57c462cff21823ce99adb1d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Lebron</span>
<span class="date">March 26, 2017 at 4:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-394228" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>Thanks for your post!</p>
<p>I have a question: Does this apply to image data with RGBXYZ for each pixel?</p>
<p>Each of my input image is of six channels including RGB and XYZ (world coordinate), which was acquired from an organized point cloud by PCL(Point Cloud Library). I am wondering whether there is a correct way to do data augmentation for my images.</p>
<p>I think ImageDataGenerator might be correct only for RGB images? Because when you shift/rotate/flip the RGB image, it means camera movement indeed, and the XYZ coordinates should be changed as well.</p>
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Lebron" class="comment-reply-link" href="#comment-394228" onclick='return addComment.moveForm( "comment-394228", "394228", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-394287">
<div class="comment-container" id="li-comment-394287">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 27, 2017 at 7:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-394287" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Lebron, I believe this specific API is intended for 3d pixel data. You might be able to devise your own similar domain-specific transforms for you own data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-394287" onclick='return addComment.moveForm( "comment-394287", "394287", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-394328">
<div class="comment-container" id="li-comment-394328">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0d6c45aec57c462cff21823ce99adb1d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0d6c45aec57c462cff21823ce99adb1d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Lebron</span>
<span class="date">March 27, 2017 at 3:51 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-394328" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason!</p>
<p>To confirm, do you mean image with RGB only by “3d pixel data”? And if I have more channels, I have to do all the augmentation by myself, rather than using Keras API?</p>
<div class="reply">
<a aria-label="Reply to Lebron" class="comment-reply-link" href="#comment-394328" onclick='return addComment.moveForm( "comment-394328", "394328", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-394404">
<div class="comment-container" id="li-comment-394404">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 28, 2017 at 8:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-394404" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, I believe that to be the case, but I could be wrong.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-394404" onclick='return addComment.moveForm( "comment-394404", "394404", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-396593">
<div class="comment-container" id="li-comment-396593">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/97642f2dfe66783abd8575cb1941658b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/97642f2dfe66783abd8575cb1941658b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Brian</span>
<span class="date">April 16, 2017 at 9:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-396593" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>When I use zoom_range of 0.2 and inspect the output images, it seems to zoom h and v axes independently. However I want to have a small amount of zoom variation while preserving the aspect ratio of the images.</p>
<p>Also, when I specify a rotation_range, the rotated images have aliasing artefacts. Is there any way to specify rotations with antialiasing?</p>
<div class="reply">
<a aria-label="Reply to Brian" class="comment-reply-link" href="#comment-396593" onclick='return addComment.moveForm( "comment-396593", "396593", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-396652">
<div class="comment-container" id="li-comment-396652">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 17, 2017 at 5:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-396652" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m not sure off hand.</p>
<p>Do you think these concerns will affect the skill of the model?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-396652" onclick='return addComment.moveForm( "comment-396652", "396652", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-396889">
<div class="comment-container" id="li-comment-396889">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/97642f2dfe66783abd8575cb1941658b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/97642f2dfe66783abd8575cb1941658b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Brian</span>
<span class="date">April 19, 2017 at 11:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-396889" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason,</p>
<p>Aspect ratio of the image is important in a facial recognition setting. Antialiasing of rotated images I’m not so sure about, but as they are small images (244 x 244) it doesn’t make sense to degrade them further.</p>
<p>I can modify my own copy of the Keras code to maintain the aspect ratio of the zoom and should be able to substitute PIL’s rotation function, which does antialiasing, for the one used in Keras.</p>
<p>Keep up the good work, your writing has really helped me get up to speed with Keras quickly</p>
<div class="reply">
<a aria-label="Reply to Brian" class="comment-reply-link" href="#comment-396889" onclick='return addComment.moveForm( "comment-396889", "396889", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-396981">
<div class="comment-container" id="li-comment-396981">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 20, 2017 at 9:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-396981" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Very nice Brian.</p>
<p>Let me know how you go.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-396981" onclick='return addComment.moveForm( "comment-396981", "396981", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-4" id="comment-397330">
<div class="comment-container" id="li-comment-397330">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8a1990cd597be4601bc3f323df74dbc9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8a1990cd597be4601bc3f323df74dbc9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://www.kaggle.com/joconnor" rel="external nofollow">Joe</a></span>
<span class="date">April 23, 2017 at 4:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-397330" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Brian.</p>
<p>The transformations in ImageGenerator are applied using [scipy.ndimage.interpolation.affine_transform](<a href="https://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.ndimage.interpolation.affine_transform.html" rel="nofollow">https://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.ndimage.interpolation.affine_transform.html</a>), with “order” (the order of spline used for interpolation) set to zero.</p>
<p>Change this to one for linear interpolation or higher for higher orders.</p>
<div class="reply">
<a aria-label="Reply to Joe" class="comment-reply-link" href="#comment-397330" onclick='return addComment.moveForm( "comment-397330", "397330", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-398531">
<div class="comment-container" id="li-comment-398531">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9a7951c3fad75f3cfb03b2a51b6aaed4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9a7951c3fad75f3cfb03b2a51b6aaed4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Wuchi</span>
<span class="date">May 4, 2017 at 5:38 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-398531" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thank you for your post! Very clear!<br/>
I am trying to use ImageDataGenerator now. But if I want to apply feature standardization to unseen data in the future, I need to save the ImageDataGenerator to disk, right? Any suggestion to do it? Thanks a lot.</p>
<div class="reply">
<a aria-label="Reply to Wuchi" class="comment-reply-link" href="#comment-398531" onclick='return addComment.moveForm( "comment-398531", "398531", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-398573">
<div class="comment-container" id="li-comment-398573">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 5, 2017 at 7:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-398573" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That is correct, or you can standardize manually and just save the coefficients used.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-398573" onclick='return addComment.moveForm( "comment-398573", "398573", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-399876">
<div class="comment-container" id="li-comment-399876">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cdf84de7197f271ea88d3630a220a86d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cdf84de7197f271ea88d3630a220a86d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">RogerLo</span>
<span class="date">May 17, 2017 at 2:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-399876" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason</p>
<p>I using Keras 2.x ‘tf’ seeting.<br/>
Why I can’t using<br/>
X_batch, y_batch = datagen.flow(train, train, batch_size=32)<br/>
For example :</p>
<p>from keras.datasets import mnist<br/>
from keras.preprocessing.image import ImageDataGenerator</p>
<p># load data<br/>
(X_train, y_train), (X_test, y_test) = mnist.load_data()<br/>
# reshape to be [samples][pixels][width][height]<br/>
X_train = X_train.reshape(X_train.shape[0],  28, 28,1)<br/>
X_test = X_test.reshape(X_test.shape[0],  28, 28,1)<br/>
# convert from int to float<br/>
X_train = X_train.astype(‘float32’)<br/>
X_test = X_test.astype(‘float32’)<br/>
# define data preparation<br/>
datagen = ImageDataGenerator(featurewise_center=True, featurewise_std_normalization=True)<br/>
# fit parameters from data<br/>
datagen.fit(X_train)<br/>
# configure batch size and retrieve one batch of images<br/>
X_batch, y_batch = datagen.flow(X_train, y_train, batch_size=9)</p>
<p>Can you tell me why?<br/>
Thanks!</p>
<div class="reply">
<a aria-label="Reply to RogerLo" class="comment-reply-link" href="#comment-399876" onclick='return addComment.moveForm( "comment-399876", "399876", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-399927">
<div class="comment-container" id="li-comment-399927">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 18, 2017 at 8:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-399927" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What error do you get exactly?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-399927" onclick='return addComment.moveForm( "comment-399927", "399927", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-400038">
<div class="comment-container" id="li-comment-400038">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cdf84de7197f271ea88d3630a220a86d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cdf84de7197f271ea88d3630a220a86d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">RogerLo</span>
<span class="date">May 19, 2017 at 4:26 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-400038" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Hason</p>
<p>The error message is :<br/>
too many values to unpack (expected 2)</p>
<div class="reply">
<a aria-label="Reply to RogerLo" class="comment-reply-link" href="#comment-400038" onclick='return addComment.moveForm( "comment-400038", "400038", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-400083">
<div class="comment-container" id="li-comment-400083">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 20, 2017 at 5:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-400083" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m sorry I have not seen this error before, I do not have any good suggestions.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-400083" onclick='return addComment.moveForm( "comment-400083", "400083", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-421023">
<div class="comment-container" id="li-comment-421023">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1e8ced31df9006f997fd7004189bb1af?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1e8ced31df9006f997fd7004189bb1af?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">N1k31t4</span>
<span class="date">November 24, 2017 at 7:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-421023" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p># load data<br/>
(X_train, y_train), (X_test, y_test) = mnist.load_data()</p>
<p>I think this should be done without the brackets around the train and test pairs:<br/>
# load data<br/>
X_train, y_train, X_test, y_test = mnist.load_data()</p>
<p>It is returning four things, but you are only accepting the two tuples.</p>
<div class="reply">
<a aria-label="Reply to N1k31t4" class="comment-reply-link" href="#comment-421023" onclick='return addComment.moveForm( "comment-421023", "421023", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-402648">
<div class="comment-container" id="li-comment-402648">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e5bfc444d648ad578b429c6412354620?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e5bfc444d648ad578b429c6412354620?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Fahad</span>
<span class="date">June 16, 2017 at 12:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-402648" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>I have training data of the shape (2000,4,100,100) which means 2000 samples of the size 100×100 with 4 channels and dtype= uint8, stored as ‘.npy’ file. Can I use Image Augmentation technique on such data?</p>
<div class="reply">
<a aria-label="Reply to Fahad" class="comment-reply-link" href="#comment-402648" onclick='return addComment.moveForm( "comment-402648", "402648", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-402700">
<div class="comment-container" id="li-comment-402700">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 16, 2017 at 8:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-402700" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You may, try it and see.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-402700" onclick='return addComment.moveForm( "comment-402700", "402700", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-403568">
<div class="comment-container" id="li-comment-403568">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a3f50c28e0705dffff740257a6f34dea?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a3f50c28e0705dffff740257a6f34dea?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Umberto</span>
<span class="date">June 23, 2017 at 7:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-403568" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Since I used the fit_generator method instead of fit(), I need to use evaluate_generator in order to correctly evaluate the model or not? Is the same for predict_generator? I’m a little confused.</p>
<div class="reply">
<a aria-label="Reply to Umberto" class="comment-reply-link" href="#comment-403568" onclick='return addComment.moveForm( "comment-403568", "403568", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-403704">
<div class="comment-container" id="li-comment-403704">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c72c9302f5a90bd68c6f624f6172ba57?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c72c9302f5a90bd68c6f624f6172ba57?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Matthew Hancock</span>
<span class="date">June 25, 2017 at 1:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-403704" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>I have a quick question about the image augmentation. I am attempting to greatly increase the size of my training data set using data augmentation in order to increase my segmentation accuracy. Does the image generator feed multiple augmentations of the same image to the model or does it just return a single augmented version instead of the original? There seems to be no way to modify the number of augmented images the Image Data Generator actually returns.</p>
<div class="reply">
<a aria-label="Reply to Matthew Hancock" class="comment-reply-link" href="#comment-403704" onclick='return addComment.moveForm( "comment-403704", "403704", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-403705">
<div class="comment-container" id="li-comment-403705">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c72c9302f5a90bd68c6f624f6172ba57?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c72c9302f5a90bd68c6f624f6172ba57?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Matthew Hancock</span>
<span class="date">June 25, 2017 at 1:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-403705" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Never mind, I found my answer in the Keras documentation.</p>
<div class="reply">
<a aria-label="Reply to Matthew Hancock" class="comment-reply-link" href="#comment-403705" onclick='return addComment.moveForm( "comment-403705", "403705", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3" id="comment-403723">
<div class="comment-container" id="li-comment-403723">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 25, 2017 at 6:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-403723" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear it.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-403723" onclick='return addComment.moveForm( "comment-403723", "403723", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-403722">
<div class="comment-container" id="li-comment-403722">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 25, 2017 at 6:02 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-403722" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question. </p>
<p>From the doc: “The data will be looped over (in batches) indefinitely.”<br/>
<a href="https://keras.io/preprocessing/image/" rel="nofollow">https://keras.io/preprocessing/image/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-403722" onclick='return addComment.moveForm( "comment-403722", "403722", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-433098">
<div class="comment-container" id="li-comment-433098">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/67d1b8522c038bb4e3e42812d29ea6d0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/67d1b8522c038bb4e3e42812d29ea6d0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bojan</span>
<span class="date">March 24, 2018 at 8:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-433098" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Also, if for example I have multiple options set in the data augmentation generator. Will it create a lot of different combinations of the data? For example:<br/>
– original data;<br/>
– shifted data;<br/>
– rotated data;<br/>
– noisy data;<br/>
– shifted + rotated data;<br/>
– shifted + noisy data;<br/>
– shifted + rotated + noisy data, etc.</p>
<p>Or will it only create one set of all the transforms created together, i.e:<br/>
– shifted + rotated + noisy data only;</p>
<p>If it is the latter, do you have any advice as to how should we combine different output results? Append them maybe in a list or something?</p>
<p>All the best,<br/>
a very good tutorial</p>
<div class="reply">
<a aria-label="Reply to Bojan" class="comment-reply-link" href="#comment-433098" onclick='return addComment.moveForm( "comment-433098", "433098", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-433146">
<div class="comment-container" id="li-comment-433146">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 25, 2018 at 6:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-433146" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It applies all of the specified transforms in creating the augmented data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-433146" onclick='return addComment.moveForm( "comment-433146", "433146", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-404719">
<div class="comment-container" id="li-comment-404719">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d672f429c18c4736c8bc498e31d039bc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d672f429c18c4736c8bc498e31d039bc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alice</span>
<span class="date">July 4, 2017 at 7:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-404719" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,<br/>
I made the exercice with your book which I find just great!!!<br/>
The problem is: it applies on randomly choosen images instead of doing it on the same ones from the “Point of comparison” sub-chapter. And always different samples.<br/>
How could I solve this?<br/>
I must say I don’t understand how it comes the “i” applies on the pyplot.subplot and on the X-batch[].<br/>
Thank you!!<br/>
Alice</p>
<div class="reply">
<a aria-label="Reply to Alice" class="comment-reply-link" href="#comment-404719" onclick='return addComment.moveForm( "comment-404719", "404719", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-404884">
<div class="comment-container" id="li-comment-404884">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 6, 2017 at 10:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-404884" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Think of the augmented images as randomly modified versions of your training dataset. You have a new dataset with lots of variations of the data you provided. You do not need to tie them back to the original examples.</p>
<p>Or perhaps I misunderstand your question?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-404884" onclick='return addComment.moveForm( "comment-404884", "404884", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-407260">
<div class="comment-container" id="li-comment-407260">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2a846b94b71effb4391d36c92ba6efbc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2a846b94b71effb4391d36c92ba6efbc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nathan</span>
<span class="date">July 25, 2017 at 6:39 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-407260" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I think the problem of Alice is the same as mine, the data that are plotted after each modification are never the same, which is difficult to make a comparison because they change everytime.</p>
<p>For example :<br/>
-the first plot gives me : 5 6 3, 0 1 9, 2 3 1<br/>
– after the ZCA whitening i have : 2 3 8, 3 2 5, 0 1 7</p>
<div class="reply">
<a aria-label="Reply to Nathan" class="comment-reply-link" href="#comment-407260" onclick='return addComment.moveForm( "comment-407260", "407260", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-407315">
<div class="comment-container" id="li-comment-407315">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 26, 2017 at 7:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-407315" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, by design, the augmentation will create different augmented versions of the images each time it is called.</p>
<p>This is what we want, so the model does a better job of generalizing.</p>
<p>What is the problem exactly, could you help me to understand please?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-407315" onclick='return addComment.moveForm( "comment-407315", "407315", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="comment-407277">
<div class="comment-container" id="li-comment-407277">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e102663ad0a218e344a031f4ee84974a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e102663ad0a218e344a031f4ee84974a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Antoine Simon</span>
<span class="date">July 25, 2017 at 10:59 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-407277" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason, </p>
<p>I have the same problem as Alice. I think that what she was saying was that the pictures that she plot after random modifications are never the same</p>
<p>It looks like the 9 pictures that are plotted are chosen randomly everytime.</p>
<p>It would be nice if you could answer me on this problem, </p>
<p>Thank you !</p>
<div class="reply">
<a aria-label="Reply to Antoine Simon" class="comment-reply-link" href="#comment-407277" onclick='return addComment.moveForm( "comment-407277", "407277", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-407323">
<div class="comment-container" id="li-comment-407323">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 26, 2017 at 7:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-407323" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, this is by design. This is exactly what we want from image augmentation.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-407323" onclick='return addComment.moveForm( "comment-407323", "407323", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-4" id="comment-449584">
<div class="comment-container" id="li-comment-449584">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/26c493eff99a2e52530d0c90af54e390?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/26c493eff99a2e52530d0c90af54e390?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.ondrejsv.com" rel="external nofollow">ondrejsv</a></span>
<span class="date">September 22, 2018 at 10:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-449584" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If you want to preserve the order of the original dataset, use the shuffle parameter in the flow method:</p>
<p>…<br/>
for X_batch, y_batch in datagen.flow(X_train, y_train, batch_size=9, shuffle=False):<br/>
…</p>
<div class="reply">
<a aria-label="Reply to ondrejsv" class="comment-reply-link" href="#comment-449584" onclick='return addComment.moveForm( "comment-449584", "449584", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-407192">
<div class="comment-container" id="li-comment-407192">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/39fa4254c0f6a51304072805361d6991?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/39fa4254c0f6a51304072805361d6991?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">john Landler</span>
<span class="date">July 25, 2017 at 5:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-407192" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>When I run the above script, I get this error:<br/>
Using TensorFlow backend.<br/>
C:\Users\sacheu\AppData\Local\Programs\Python\Python35\lib\site-packages\keras\preprocessing\image.py:653: UserWarning: Expected input to be images (as Numpy array) following the data format convention “channels_first” (channels on axis 1), i.e. expected either 1, 3 or 4 channels on axis 1. However, it was passed an array with shape (60000, 1, 28, 28) (1 channels).<br/>
  ‘ (‘ + str(x.shape[self.channel_axis]) + ‘ channels).’)</p>
<p>can you please tell me how to fix it?<br/>
i think i have the latest version of the libraries. And I am using python 3.5.</p>
<p>Thank you.</p>
<div class="reply">
<a aria-label="Reply to john Landler" class="comment-reply-link" href="#comment-407192" onclick='return addComment.moveForm( "comment-407192", "407192", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-407233">
<div class="comment-container" id="li-comment-407233">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 25, 2017 at 9:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-407233" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You could try changing the order of the channels in code or in the Keras configuration file.</p>
<p>For example, in code:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6f1bdad2275143615" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
from keras import backend as K
K.set_image_dim_ordering('th')</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6f1bdad2275143615-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bdad2275143615-2">2</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6f1bdad2275143615-1"><span class="crayon-e">from </span><span class="crayon-e">keras </span><span class="crayon-e">import </span><span class="crayon-e">backend </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">K</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bdad2275143615-2"><span class="crayon-v">K</span><span class="crayon-sy">.</span><span class="crayon-e">set_image_dim_ordering</span><span class="crayon-sy">(</span><span class="crayon-s">'th'</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p>Or if this is the cause, comment it out.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-407233" onclick='return addComment.moveForm( "comment-407233", "407233", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-419641">
<div class="comment-container" id="li-comment-419641">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d2cf877c448f68c5f2afd32730fedf45?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d2cf877c448f68c5f2afd32730fedf45?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tom</span>
<span class="date">November 11, 2017 at 2:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-419641" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have the same problem. Nothing works.</p>
<p>The message is a warning, and I still get the output images, but i.e. Feature Standardization is black and white, not gray scaled. So I suppose it is not working?</p>
<p>When I try to comment it out or change the order from ‘th’ to ‘tf’ – it completely brakes. The message is: … (28 channels)</p>
<p>I am new and any comments are welcome.</p>
<div class="reply">
<a aria-label="Reply to Tom" class="comment-reply-link" href="#comment-419641" onclick='return addComment.moveForm( "comment-419641", "419641", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-419700">
<div class="comment-container" id="li-comment-419700">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 11, 2017 at 9:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-419700" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps double check you have the latest version of Keras installed? 2.0.8 or 2.0.9?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-419700" onclick='return addComment.moveForm( "comment-419700", "419700", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-419904">
<div class="comment-container" id="li-comment-419904">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d2cf877c448f68c5f2afd32730fedf45?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d2cf877c448f68c5f2afd32730fedf45?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tom</span>
<span class="date">November 13, 2017 at 9:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-419904" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>(C:\ProgramData\Anaconda3) C:\ProgramData\Anaconda3\etc\conda\activate.d&gt;set “KERAS_BACKEND=theano”</p>
<p>(C:\ProgramData\Anaconda3) C:\Users\Tom&gt;conda install -c conda-forge keras Fetching package metadata ……………<br/>
Solving package specifications: .</p>
<p># All requested packages already installed.<br/>
# packages in environment at C:\ProgramData\Anaconda3:<br/>
#<br/>
keras                     2.0.6                    py36_0    conda-forge</p>
<p>It looks like it is up to date. But..<br/>
I used this tutorial: <a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" rel="nofollow">https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/</a> and typing:</p>
<p>import keras<br/>
print(‘keras: %s’ % keras.__version__)</p>
<p>gives me:<br/>
Using Theano backend.<br/>
keras: 2.0.6</p>
<p>but according to tutorial it should be:<br/>
Using TensorFlow backend.<br/>
keras: 1.2.1</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-419944">
<div class="comment-container" id="li-comment-419944">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 14, 2017 at 10:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-419944" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can change the backend used by Keras in the ~/.keras/keras.json configuration file.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-5" id="comment-419907">
<div class="comment-container" id="li-comment-419907">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d2cf877c448f68c5f2afd32730fedf45?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d2cf877c448f68c5f2afd32730fedf45?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tom</span>
<span class="date">November 13, 2017 at 9:18 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-419907" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ok, at the moment I can say that:</p>
<p>– Those warning messages are just a warning. They are in each example. I do not know how to make them disappear, but it turns out that they are harmless.</p>
<p>– Example Feature Standardization is black and white, not gray scaled. Maybe there is an error in script? I am to novice to spot it.</p>
<p>– Other examples seems to work correctly despite the warning message. (So I just saw a warning, saw different output, spotted comment with similar problem and just stopped. My bad).</p>
<p>– I can write set “KERAS_BACKEND=tensorflow” to change the backend (I don’t know what does it means, but never mind 🙂 ).</p>
<p>– You are awesome for making those tutorials. Thank You!</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-419947">
<div class="comment-container" id="li-comment-419947">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 14, 2017 at 10:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-419947" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-407661">
<div class="comment-container" id="li-comment-407661">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c69681959277b36864c5c83628815d0e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c69681959277b36864c5c83628815d0e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Xiaojie Zhang</span>
<span class="date">July 28, 2017 at 2:45 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-407661" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, thanks for your share. When I try to use zca-whitening and feature-wised centering on bigger data, I found it’s very very hard to get enough memory to do the fit() function. As the data-set has about 10000 pictures and 224*224 pixels, even generate a flow iterator will use full of my 16GB memory. When try to use fit() for zca-whitening,centering,normalization which the documents said have to use the fit() function, I never success. Will you give some advice for data preparation for bigger data? Thank you very much!</p>
<div class="reply">
<a aria-label="Reply to Xiaojie Zhang" class="comment-reply-link" href="#comment-407661" onclick='return addComment.moveForm( "comment-407661", "407661", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-407740">
<div class="comment-container" id="li-comment-407740">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 29, 2017 at 8:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-407740" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Are you able to use the flow_from_directory instead of loading it all into memory?<br/>
<a href="https://keras.io/preprocessing/image/" rel="nofollow">https://keras.io/preprocessing/image/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-407740" onclick='return addComment.moveForm( "comment-407740", "407740", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-421969">
<div class="comment-container" id="li-comment-421969">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/487645f035e9b2f095acf7510b32ce89?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/487645f035e9b2f095acf7510b32ce89?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Willie Maddox</span>
<span class="date">December 3, 2017 at 2:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-421969" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have the same exact problem with MS-COCO and NUS-WIDE datasets and I have 128GB memory.  The flow_from_directory() requires your data to be in a specific directory structure.</p>
<p>From the Keras v2.1.2 documentation…</p>
<p>directory: path to the target directory. It should contain one subdirectory per class.</p>
<p>MS-COCO and NUS-WIDE are not structured this way natively.</p>
<p>Also, Xiaojie was talking specifically about the fit() function, which is called before the flow (or flow_from_directory) function.</p>
<div class="reply">
<a aria-label="Reply to Willie Maddox" class="comment-reply-link" href="#comment-421969" onclick='return addComment.moveForm( "comment-421969", "421969", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-410363">
<div class="comment-container" id="li-comment-410363">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5791a46852053e4f454635f975cbad0e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5791a46852053e4f454635f975cbad0e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Muneer Ahmad Dedmari</span>
<span class="date">August 20, 2017 at 10:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-410363" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thanks for this nice post. I have a quick question. I have large-dataset which I am loading to model using custom data-generator.  I am using it in model.fit_generator(). Now I want to use data-augmentation. So my question is, how/where can I use keras ImageDataGenerator? Thank you very much.</p>
<div class="reply">
<a aria-label="Reply to Muneer Ahmad Dedmari" class="comment-reply-link" href="#comment-410363" onclick='return addComment.moveForm( "comment-410363", "410363", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-410388">
<div class="comment-container" id="li-comment-410388">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 21, 2017 at 6:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-410388" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I believe this tutorial will help:<br/>
<a href="https://blog.keras.io/building-powerful-image-classification-models-using-very-little-data.html" rel="nofollow">https://blog.keras.io/building-powerful-image-classification-models-using-very-little-data.html</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-410388" onclick='return addComment.moveForm( "comment-410388", "410388", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-414912">
<div class="comment-container" id="li-comment-414912">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/eafdfd56ba4249c22afd26754524b148?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/eafdfd56ba4249c22afd26754524b148?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Steve</span>
<span class="date">September 27, 2017 at 11:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-414912" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi</p>
<p>Shall we run both fit_transform with origin images set and with augmented ones separately ? Or shell we combine them into ơne. On the latter one how do we combine them ?</p>
<p>Thanks.<br/>
Steve</p>
<div class="reply">
<a aria-label="Reply to Steve" class="comment-reply-link" href="#comment-414912" onclick='return addComment.moveForm( "comment-414912", "414912", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-414930">
<div class="comment-container" id="li-comment-414930">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 27, 2017 at 3:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-414930" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Just the augmented images.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-414930" onclick='return addComment.moveForm( "comment-414930", "414930", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-414958">
<div class="comment-container" id="li-comment-414958">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/eafdfd56ba4249c22afd26754524b148?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/eafdfd56ba4249c22afd26754524b148?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Steve</span>
<span class="date">September 28, 2017 at 1:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-414958" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason. Bought all of your ML books, love it ! Would you write one about Transfer Learning deep enough with ImageNet and few other so that we can re-use the pre-trained one for our own purpose ?</p>
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Steve" class="comment-reply-link" href="#comment-414958" onclick='return addComment.moveForm( "comment-414958", "414958", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-414974">
<div class="comment-container" id="li-comment-414974">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 28, 2017 at 5:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-414974" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks again for your support Steve.</p>
<p>Yes, I have a post scheduled on re-using the VGG model. It should appear on the blog soon.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-414974" onclick='return addComment.moveForm( "comment-414974", "414974", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-417667">
<div class="comment-container" id="li-comment-417667">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/36e4c8ef7b1d2ce7a32fcfa4c2d54dfa?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/36e4c8ef7b1d2ce7a32fcfa4c2d54dfa?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Momo</span>
<span class="date">October 24, 2017 at 2:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-417667" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for this great post !<br/>
In the Random Shifts part, can we have control on the file names ?<br/>
Is it possible to save files as:<br/>
‘aug’+original_file_name+’png’ ?</p>
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Momo" class="comment-reply-link" href="#comment-417667" onclick='return addComment.moveForm( "comment-417667", "417667", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-417690">
<div class="comment-container" id="li-comment-417690">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 24, 2017 at 5:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-417690" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, you can control the filenames. Perhaps the API will make it clearer:<br/>
<a href="https://keras.io/preprocessing/image/" rel="nofollow">https://keras.io/preprocessing/image/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-417690" onclick='return addComment.moveForm( "comment-417690", "417690", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-418894">
<div class="comment-container" id="li-comment-418894">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/16b435c3a89805f0caa1f15eff902a53?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/16b435c3a89805f0caa1f15eff902a53?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Abraham Ben</span>
<span class="date">November 3, 2017 at 5:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-418894" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thanks for your tutorial. When I try to use :</p>
<p>pred = model.predict_generator(data_gen.flow_from_directory(“../input/valid_img”, target_size=(input_size, input_size)))</p>
<p>I cannot get the image filename that correspond to the predicted probability. Is there any solutions?</p>
<div class="reply">
<a aria-label="Reply to Abraham Ben" class="comment-reply-link" href="#comment-418894" onclick='return addComment.moveForm( "comment-418894", "418894", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-418947">
<div class="comment-container" id="li-comment-418947">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 4, 2017 at 5:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-418947" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The order of predictions will match the order of files in the directory I would expect.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-418947" onclick='return addComment.moveForm( "comment-418947", "418947", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-418989">
<div class="comment-container" id="li-comment-418989">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/16b435c3a89805f0caa1f15eff902a53?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/16b435c3a89805f0caa1f15eff902a53?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Abraham Ben</span>
<span class="date">November 4, 2017 at 3:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-418989" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have check it, however, this is not the case since I got a pretty low accuracy compared to the val_acc. I found someone solving it by setting the batch_size to 1 when use predict_generator and ImageDataGenerator.flow_from_directory, but this is not what I want.</p>
<div class="reply">
<a aria-label="Reply to Abraham Ben" class="comment-reply-link" href="#comment-418989" onclick='return addComment.moveForm( "comment-418989", "418989", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-420726">
<div class="comment-container" id="li-comment-420726">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/986431b3ea2c5d44499b604d5ea8fdd7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/986431b3ea2c5d44499b604d5ea8fdd7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Masun</span>
<span class="date">November 21, 2017 at 10:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-420726" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Do you have any idea about how we can apply the same idea on signals? I mean signal augmentation for Deep learning? Thank you</p>
<div class="reply">
<a aria-label="Reply to Masun" class="comment-reply-link" href="#comment-420726" onclick='return addComment.moveForm( "comment-420726", "420726", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-420807">
<div class="comment-container" id="li-comment-420807">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 22, 2017 at 10:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-420807" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not off hand. Consider how transforms can be used on your specific data to create new patterns. E.g. even just adding random noise is a good start.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-420807" onclick='return addComment.moveForm( "comment-420807", "420807", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-422120">
<div class="comment-container" id="li-comment-422120">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/020e394245b53c1483115fbd1a2c693b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/020e394245b53c1483115fbd1a2c693b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">smriti</span>
<span class="date">December 4, 2017 at 4:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-422120" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Once the features have been centered, using featurewise_center=True in keras.preprocessing.image.ImageDataGenerator(), How can I retrieve that statistics so that I use it to preprocess the images to be used for prediction/testing during evaluate_generator() etc</p>
<div class="reply">
<a aria-label="Reply to smriti" class="comment-reply-link" href="#comment-422120" onclick='return addComment.moveForm( "comment-422120", "422120", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-422125">
<div class="comment-container" id="li-comment-422125">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 4, 2017 at 4:59 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-422125" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good question, I’m not sure off the cuff, perhaps post to Keras group or slack channel:<br/>
<a href="https://machinelearningmastery.com/get-help-with-keras/" rel="nofollow">https://machinelearningmastery.com/get-help-with-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-422125" onclick='return addComment.moveForm( "comment-422125", "422125", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-425548">
<div class="comment-container" id="li-comment-425548">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c1a7f7b0951c4f386b0112d65412b553?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c1a7f7b0951c4f386b0112d65412b553?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">safae</span>
<span class="date">January 4, 2018 at 12:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-425548" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thank you very much for all the posts you shared, which are a very useful and help a lot.</p>
<p>I would like to ask if do you have an idea about implemented data augmentation algorithms for time series data(such as acceleration, AC voltage, …)</p>
<p>Thank you</p>
<div class="reply">
<a aria-label="Reply to safae" class="comment-reply-link" href="#comment-425548" onclick='return addComment.moveForm( "comment-425548", "425548", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-425581">
<div class="comment-container" id="li-comment-425581">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 4, 2018 at 8:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-425581" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not at this stage, thanks for the suggestion.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425581" onclick='return addComment.moveForm( "comment-425581", "425581", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-427877">
<div class="comment-container" id="li-comment-427877">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6d74b700d6745d6e3f8dfef01c3c1690?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6d74b700d6745d6e3f8dfef01c3c1690?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Dimitris Mallios</span>
<span class="date">January 30, 2018 at 3:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-427877" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, i have a question, suppose we have semantic segmentation task and we want to rotate and flip both the image and the output image labels, how do we apply the transformations? Should i concatenate the image and the labels to a homogeneous array and then apply the appropriate transformations?</p>
<div class="reply">
<a aria-label="Reply to Dimitris Mallios" class="comment-reply-link" href="#comment-427877" onclick='return addComment.moveForm( "comment-427877", "427877", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-427924">
<div class="comment-container" id="li-comment-427924">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 30, 2018 at 9:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-427924" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good question, you might want more control and apply augmentation one pair at a time.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-427924" onclick='return addComment.moveForm( "comment-427924", "427924", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-431760">
<div class="comment-container" id="li-comment-431760">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ce299f85702b3bca78c1c2db0655a5fd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ce299f85702b3bca78c1c2db0655a5fd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Wafa</span>
<span class="date">March 10, 2018 at 10:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-431760" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thank you for your nice post! How can I use augmentation to data that I have on my disk? I see you imported mnist and I could not realize how to change this for my purpose.</p>
<div class="reply">
<a aria-label="Reply to Wafa" class="comment-reply-link" href="#comment-431760" onclick='return addComment.moveForm( "comment-431760", "431760", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-431823">
<div class="comment-container" id="li-comment-431823">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 11, 2018 at 6:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-431823" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can load the data via the augmentation API and use it to make an augmented version of your dataset. This augmentation could be used directly or saved to file.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-431823" onclick='return addComment.moveForm( "comment-431823", "431823", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-432881">
<div class="comment-container" id="li-comment-432881">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/79da4762ef6c7f371788441c78fbf754?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/79da4762ef6c7f371788441c78fbf754?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Steven</span>
<span class="date">March 22, 2018 at 12:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-432881" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi Jason,</p>
<p>Quick question: after the images are augmented, your script saves them into smaller files. What if I want to stitch these augmented files into a single file, similar to the original mnist file so that I can use nmist.load_data() function to load them into, say a CNN engine? Would the following work?</p>
<p>nmist_new = []<br/>
for X_batch, y_batch in datagen.flow(X_train, y_train, batch_size=9):<br/>
	# create a grid of 3×3 images<br/>
	for i in range(0, 9):<br/>
                nmist_new.append(array(X_batch, y_batch))</p>
<p>I am not sure what format should be used.</p>
<div class="reply">
<a aria-label="Reply to Steven" class="comment-reply-link" href="#comment-432881" onclick='return addComment.moveForm( "comment-432881", "432881", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-432896">
<div class="comment-container" id="li-comment-432896">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 22, 2018 at 2:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-432896" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good question, I think some experimentation would be required.</p>
<p>Perhaps use of numpy’s hstack and vstack to create a larger array from the image arrays? </p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-432896" onclick='return addComment.moveForm( "comment-432896", "432896", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-432959">
<div class="comment-container" id="li-comment-432959">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/79da4762ef6c7f371788441c78fbf754?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/79da4762ef6c7f371788441c78fbf754?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Steven</span>
<span class="date">March 23, 2018 at 5:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-432959" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yeah, I think need some tweaks or look into Keras’ mnist_load() function how what the data format is when writing back. This link has the original data format:</p>
<p><a href="http://yann.lecun.com/exdb/mnist/" rel="nofollow">http://yann.lecun.com/exdb/mnist/</a></p>
<p>Scroll down to the bottom for training and test dataset structures. They used some header information for each image. I think hstack and vstack are the way to go, but need to take care of those headers (think should be easy). I am still not sure what those “xxxx” mean. I think the files are just filled by the 28×28 small image data.</p>
<div class="reply">
<a aria-label="Reply to Steven" class="comment-reply-link" href="#comment-432959" onclick='return addComment.moveForm( "comment-432959", "432959", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-432986">
<div class="comment-container" id="li-comment-432986">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 23, 2018 at 6:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-432986" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It might be easier to write your own progressive loading function. A heck of a lot simpler actually.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-432986" onclick='return addComment.moveForm( "comment-432986", "432986", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-434453">
<div class="comment-container" id="li-comment-434453">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0e73549663a9a1d88a5d8a09ab5ac6bc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0e73549663a9a1d88a5d8a09ab5ac6bc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tien</span>
<span class="date">April 8, 2018 at 2:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-434453" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,</p>
<p>I used the code to generator featurewise standardized samples, but did not get the same result as shown in the web.  </p>
<p>Tien</p>
<div class="reply">
<a aria-label="Reply to Tien" class="comment-reply-link" href="#comment-434453" onclick='return addComment.moveForm( "comment-434453", "434453", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-434490">
<div class="comment-container" id="li-comment-434490">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 9, 2018 at 6:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-434490" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How was it different?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-434490" onclick='return addComment.moveForm( "comment-434490", "434490", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-435630">
<div class="comment-container" id="li-comment-435630">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ae06af01d06fd808877dead66198d326?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ae06af01d06fd808877dead66198d326?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">iles</span>
<span class="date">April 22, 2018 at 11:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-435630" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason </p>
<p>i have a dataset of images (jpg not a csv file) and each class of this images is in a folder car in folder with name cat and dog with folder name dog so how can i apply a deep learning model on this data do i need image data generator ?<br/>
thank you</p>
<div class="reply">
<a aria-label="Reply to iles" class="comment-reply-link" href="#comment-435630" onclick='return addComment.moveForm( "comment-435630", "435630", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-435667">
<div class="comment-container" id="li-comment-435667">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 23, 2018 at 6:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-435667" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I think this tutorial will help:<br/>
<a href="https://blog.keras.io/building-powerful-image-classification-models-using-very-little-data.html" rel="nofollow">https://blog.keras.io/building-powerful-image-classification-models-using-very-little-data.html</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435667" onclick='return addComment.moveForm( "comment-435667", "435667", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-436908">
<div class="comment-container" id="li-comment-436908">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b8ed437470d4eb894cd6ad0e1e4c3f01?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b8ed437470d4eb894cd6ad0e1e4c3f01?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kien Nguyen</span>
<span class="date">May 8, 2018 at 1:45 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-436908" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Your blog is awesome. Appreciate it.</p>
<div class="reply">
<a aria-label="Reply to Kien Nguyen" class="comment-reply-link" href="#comment-436908" onclick='return addComment.moveForm( "comment-436908", "436908", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-436924">
<div class="comment-container" id="li-comment-436924">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 8, 2018 at 2:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-436924" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436924" onclick='return addComment.moveForm( "comment-436924", "436924", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-437130">
<div class="comment-container" id="li-comment-437130">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d2443a26c4d4d3c715630449f21bb3da?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d2443a26c4d4d3c715630449f21bb3da?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://NA" rel="external nofollow">maulik</a></span>
<span class="date">May 10, 2018 at 6:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-437130" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason, </p>
<p>I am a bit confused while understanding of “with image augmentation”</p>
<p>Assume:-</p>
<p>Total Training Image:- 10 (#X_train Image)<br/>
ImageDataGenerator(rotation_range=90) #Randomly Rotation </p>
<p>model.fit_generator(datagen.flow(x_train, y_train, batch_size=1),<br/>
                    steps_per_epoch=len(x_train) / 1, epochs=epochs)</p>
<p>Does it mean we are training model of 10 randomly rotated image ?<br/>
or Are we Training model 10 original images +  10 randomly rotated images with fit_generator () ?</p>
<div class="reply">
<a aria-label="Reply to maulik" class="comment-reply-link" href="#comment-437130" onclick='return addComment.moveForm( "comment-437130", "437130", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-437139">
<div class="comment-container" id="li-comment-437139">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d2443a26c4d4d3c715630449f21bb3da?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d2443a26c4d4d3c715630449f21bb3da?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">maulik</span>
<span class="date">May 10, 2018 at 8:24 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-437139" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am assuming , We are training model with 10 randomly rotated image.<br/>
Q.1 Am i correct ?</p>
<p>Here I tried data augmentation on CIFAR10 (color Image, image[10])<br/>
But I am not getting proper output image after augmentation </p>
<p><a href="https://pasteboard.co/HkvZLT1.png" rel="nofollow">https://pasteboard.co/HkvZLT1.png</a> </p>
<p>Here is code:-<br/>
import matplotlib.pyplot as plt<br/>
from keras.preprocessing.image import ImageDataGenerator<br/>
x1=x_train[10:11,:,:,:]<br/>
y1=y_train[10:11,]</p>
<p>datagen = ImageDataGenerator(rotation_range=90)</p>
<p>print (x1.shape)    #Shape (1, 32, 32, 3)<br/>
print (y1.shape)    #Shape (1, 10)<br/>
plt.imshow(x1[0])  #Image 1<br/>
plt.show()</p>
<p>for x_batch,y_batch in datagen.flow(x1,y1, batch_size=1):<br/>
  for i in range(0, 1):<br/>
    plt.imshow(x_batch[i].reshape(32,32,3)) #Image 2<br/>
    plt.show()<br/>
    print (y_batch)<br/>
  break</p>
<p>Jason, Could you please help ?</p>
<p>Thank you</p>
<div class="reply">
<a aria-label="Reply to maulik" class="comment-reply-link" href="#comment-437139" onclick='return addComment.moveForm( "comment-437139", "437139", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-437177">
<div class="comment-container" id="li-comment-437177">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 11, 2018 at 6:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-437177" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>10 randomly modified versions of 10 different images.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437177" onclick='return addComment.moveForm( "comment-437177", "437177", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-437216">
<div class="comment-container" id="li-comment-437216">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d2443a26c4d4d3c715630449f21bb3da?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d2443a26c4d4d3c715630449f21bb3da?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">maulik</span>
<span class="date">May 11, 2018 at 2:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-437216" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Got it. </p>
<p>I Tried to do rotation of 1 image. But when i am doing plt.show(), image is not properly displayed. </p>
<p>Here is image<br/>
<a href="https://pasteboard.co/HkvZLT1.png" rel="nofollow">https://pasteboard.co/HkvZLT1.png</a></p>
<p>Here is code:-<br/>
import matplotlib.pyplot as plt<br/>
from keras.preprocessing.image import ImageDataGenerator<br/>
x1=x_train[10:11,:,:,:]<br/>
y1=y_train[10:11,]</p>
<p>datagen = ImageDataGenerator(rotation_range=90)</p>
<p>print (x1.shape) #Shape (1, 32, 32, 3)<br/>
print (y1.shape) #Shape (1, 10)<br/>
plt.imshow(x1[0]) #Image 1<br/>
plt.show()</p>
<p>for x_batch,y_batch in datagen.flow(x1,y1, batch_size=1):<br/>
for i in range(0, 1):<br/>
plt.imshow(x_batch[i].reshape(32,32,3)) #Image 2<br/>
plt.show()<br/>
print (y_batch)<br/>
break</p>
<p>Thank you Jason</p>
<div class="reply">
<a aria-label="Reply to maulik" class="comment-reply-link" href="#comment-437216" onclick='return addComment.moveForm( "comment-437216", "437216", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-437221">
<div class="comment-container" id="li-comment-437221">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 11, 2018 at 2:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-437221" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t have any good suggestions sorry. Perhaps try posting your code and error on StackOverflow?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437221" onclick='return addComment.moveForm( "comment-437221", "437221", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-442477">
<div class="comment-container" id="li-comment-442477">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7e52bfb62b7bd57ae2f0aedfc0d9d9f0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7e52bfb62b7bd57ae2f0aedfc0d9d9f0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Malek</span>
<span class="date">July 2, 2018 at 5:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-442477" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello. Thanks for the tutorial. It was so helpful. Actually, I have 3 questions:</p>
<p>1. When I use your code, the Mnist images change from one data augmentation method to the other. I mean, it’s performed on different 9 samples of digits each time. Do you know how to solve this problem? Because they need to be the same so that I can compare.</p>
<p>2. The first technique (standardization) doesn’t work for me. I get digits with the same luminosity: no darkening or lightening. Why is that? I just copied and pasted the code.</p>
<p>3. I need to do data augmentation on 3D medical images (DICOM format). Is it possible to do it using the ImageDataGenerator from Keras? Or is there a simple way to do it?</p>
<p>Thanks again.</p>
<div class="reply">
<a aria-label="Reply to Malek" class="comment-reply-link" href="#comment-442477" onclick='return addComment.moveForm( "comment-442477", "442477", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-442489">
<div class="comment-container" id="li-comment-442489">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 2, 2018 at 6:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-442489" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t follow the first question.</p>
<p>Perhaps the code has changed?</p>
<p>Sorry, I don’t know about 3D images.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442489" onclick='return addComment.moveForm( "comment-442489", "442489", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-442720">
<div class="comment-container" id="li-comment-442720">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7776166284a100b753b5c179a3a36443?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7776166284a100b753b5c179a3a36443?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://None" rel="external nofollow">Zara</a></span>
<span class="date">July 5, 2018 at 9:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-442720" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,<br/>
       I want to know that how can I upload an image file in python which contains multiple images that is more than one images in a single file.Thanks for your precious time.</p>
<div class="reply">
<a aria-label="Reply to Zara" class="comment-reply-link" href="#comment-442720" onclick='return addComment.moveForm( "comment-442720", "442720", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-442729">
<div class="comment-container" id="li-comment-442729">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 5, 2018 at 3:09 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-442729" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have a specific example of this.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442729" onclick='return addComment.moveForm( "comment-442729", "442729", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-442822">
<div class="comment-container" id="li-comment-442822">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7776166284a100b753b5c179a3a36443?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7776166284a100b753b5c179a3a36443?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://None" rel="external nofollow">Zara</a></span>
<span class="date">July 6, 2018 at 8:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-442822" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>ok Thanx Sir for your time.</p>
<div class="reply">
<a aria-label="Reply to Zara" class="comment-reply-link" href="#comment-442822" onclick='return addComment.moveForm( "comment-442822", "442822", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-442869">
<div class="comment-container" id="li-comment-442869">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 7, 2018 at 6:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-442869" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442869" onclick='return addComment.moveForm( "comment-442869", "442869", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-442914">
<div class="comment-container" id="li-comment-442914">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ad94902ff0c8036f6e3f60e96046cd18?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ad94902ff0c8036f6e3f60e96046cd18?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Arhe</span>
<span class="date">July 7, 2018 at 8:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-442914" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello.<br/>
I am running the examples in a Jupyter notebook and I don’t get to see the darkening and whitening that we see in this blog in section “Feature Standardization”. In this section, I also see different numbers every time I run it. I have double check the code to see that I am not missing anything.<br/>
Has anybody got the same results here?</p>
<div class="reply">
<a aria-label="Reply to Arhe" class="comment-reply-link" href="#comment-442914" onclick='return addComment.moveForm( "comment-442914", "442914", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-442941">
<div class="comment-container" id="li-comment-442941">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 8, 2018 at 6:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-442941" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps the API has changed?</p>
<p>Perhaps results are diffrent when running from the command line, as I would recommend?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442941" onclick='return addComment.moveForm( "comment-442941", "442941", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-443908">
<div class="comment-container" id="li-comment-443908">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b9f46bb9cee6c4c33a0fa152a21b50a1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b9f46bb9cee6c4c33a0fa152a21b50a1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Franz Götz-Hahn</span>
<span class="date">July 19, 2018 at 7:41 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-443908" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason!</p>
<p>Thanks for all your tutorials, you are doing great work bringing concepts forward to people wanting to learn!</p>
<p>I have a question with respect to data wrangling. I have always written my own small scripts that handle data loading. But what I’d actually like to do is prepare the data in a similar way to how for example the MNIST or CIFAR datasets are stored for Keras. I have read up on the format of the files etc, but I wonder, someone else must’ve written some code that does this for their own data, and surely they would’ve made it public. I’ve searched everywhere and can’t find it.</p>
<p>Basically, what I am looking for is a script that takes data in some structure (say data/train and data/validation subfolders) and prepares it in pickled batches like MNIST and CIFAR come, so that it can be easily shared and reused.</p>
<p>Do you have any leads for this?</p>
<div class="reply">
<a aria-label="Reply to Franz Götz-Hahn" class="comment-reply-link" href="#comment-443908" onclick='return addComment.moveForm( "comment-443908", "443908", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-443936">
<div class="comment-container" id="li-comment-443936">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 20, 2018 at 5:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-443936" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice idea. </p>
<p>Not that I’m aware. I would expect you’ll have to code something custom for this.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443936" onclick='return addComment.moveForm( "comment-443936", "443936", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-446072">
<div class="comment-container" id="li-comment-446072">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ee19e098347777f37ed6ae06ea908aee?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ee19e098347777f37ed6ae06ea908aee?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">JJ Goldman</span>
<span class="date">August 14, 2018 at 4:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-446072" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Little update :<br/>
According to the doc (<a href="https://keras.io/preprocessing/image/#imagedatagenerator-class" rel="nofollow">https://keras.io/preprocessing/image/#imagedatagenerator-class</a>),<br/>
featurewise_center and featurewise_std_normalization are set False by default.</p>
<div class="reply">
<a aria-label="Reply to JJ Goldman" class="comment-reply-link" href="#comment-446072" onclick='return addComment.moveForm( "comment-446072", "446072", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-446119">
<div class="comment-container" id="li-comment-446119">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 15, 2018 at 5:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-446119" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, perhaps the API has changed.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-446119" onclick='return addComment.moveForm( "comment-446119", "446119", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-449706">
<div class="comment-container" id="li-comment-449706">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c7ffd26b3f3d213963fc44687dbc9d72?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c7ffd26b3f3d213963fc44687dbc9d72?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Manohar</span>
<span class="date">September 25, 2018 at 1:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-449706" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>HI Jason,<br/>
How to rotate an image with exactly 90 degree. ImageDataGenerator produces images which randomly rotated. I want the images rotated exactly 90 degree. How to do that</p>
<div class="reply">
<a aria-label="Reply to Manohar" class="comment-reply-link" href="#comment-449706" onclick='return addComment.moveForm( "comment-449706", "449706", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-449732">
<div class="comment-container" id="li-comment-449732">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 25, 2018 at 6:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-449732" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps write code to pre-rotate and save the rotated images?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-449732" onclick='return addComment.moveForm( "comment-449732", "449732", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-452834">
<div class="comment-container" id="li-comment-452834">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c56af80b38811019d308e4f95390e434?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c56af80b38811019d308e4f95390e434?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mario Gtz</span>
<span class="date">October 27, 2018 at 4:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-452834" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, I’m working on a classificator just for learn. I’m using sequence class to generate batches on my data and use multiprocessing function to training the model. </p>
<p>My problem is: ¿how can I fit this generator of augmentations and the generator that I’ve been created?. I mean this augmentation generator  could be trained by:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6f1bd284874237407" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
history = model.fit_generator(train_datagen.flow(x_train,y_train),
                              steps_per_epoch = 2000 // batch_size,
                              epochs = 100,
                              validation_data = test_datagen.flow(x_train, y_train),
                              validation_steps = 800 // batch_size,
                              use_multiprocessing = True,
                              workers = 16,
                              max_queue_size = 32,
                              callbacks = [checkpoint])</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6f1bd284874237407-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd284874237407-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd284874237407-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd284874237407-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd284874237407-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd284874237407-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd284874237407-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd284874237407-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd284874237407-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6f1bd284874237407-1"><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit_generator</span><span class="crayon-sy">(</span><span class="crayon-v">train_datagen</span><span class="crayon-sy">.</span><span class="crayon-e">flow</span><span class="crayon-sy">(</span><span class="crayon-v">x_train</span><span class="crayon-sy">,</span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd284874237407-2"><span class="crayon-h">                              </span><span class="crayon-v">steps_per_epoch</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2000</span><span class="crayon-h"> </span><span class="crayon-c">// batch_size,</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd284874237407-3"><span class="crayon-h">                              </span><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd284874237407-4"><span class="crayon-h">                              </span><span class="crayon-v">validation_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">test_datagen</span><span class="crayon-sy">.</span><span class="crayon-e">flow</span><span class="crayon-sy">(</span><span class="crayon-v">x_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd284874237407-5"><span class="crayon-h">                              </span><span class="crayon-v">validation_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">800</span><span class="crayon-h"> </span><span class="crayon-c">// batch_size,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd284874237407-6"><span class="crayon-h">                              </span><span class="crayon-v">use_multiprocessing</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd284874237407-7"><span class="crayon-h">                              </span><span class="crayon-v">workers</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd284874237407-8"><span class="crayon-h">                              </span><span class="crayon-v">max_queue_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd284874237407-9"><span class="crayon-h">                              </span><span class="crayon-v">callbacks</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">checkpoint</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>And my generator of batches:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6f1bd288087825354" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
history = model.fit_generator(generator=batch_train,
                              steps_per_epoch = 2000 // batch_size,
                              epochs = 100,
                              validation_data = batch_test,
                              validation_steps = 800 // batch_size,
                              use_multiprocessing = True,
                              workers = 16,
                              max_queue_size = 32,
                              callbacks = [checkpoint])</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6f1bd288087825354-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd288087825354-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd288087825354-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd288087825354-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd288087825354-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd288087825354-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd288087825354-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd288087825354-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd288087825354-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6f1bd288087825354-1"><span class="crayon-v">history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit_generator</span><span class="crayon-sy">(</span><span class="crayon-v">generator</span><span class="crayon-o">=</span><span class="crayon-v">batch_train</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd288087825354-2"><span class="crayon-h">                              </span><span class="crayon-v">steps_per_epoch</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2000</span><span class="crayon-h"> </span><span class="crayon-c">// batch_size,</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd288087825354-3"><span class="crayon-h">                              </span><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd288087825354-4"><span class="crayon-h">                              </span><span class="crayon-v">validation_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">batch_test</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd288087825354-5"><span class="crayon-h">                              </span><span class="crayon-v">validation_steps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">800</span><span class="crayon-h"> </span><span class="crayon-c">// batch_size,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd288087825354-6"><span class="crayon-h">                              </span><span class="crayon-v">use_multiprocessing</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd288087825354-7"><span class="crayon-h">                              </span><span class="crayon-v">workers</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd288087825354-8"><span class="crayon-h">                              </span><span class="crayon-v">max_queue_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd288087825354-9"><span class="crayon-h">                              </span><span class="crayon-v">callbacks</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">checkpoint</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0010 seconds] -->
<p></p>
<p>Can I mix this, doing something like:</p>
<p>history = model.fit_generator(train_datagen.flow(batcg_train)….</p>
<p>Thank You</p>
<div class="reply">
<a aria-label="Reply to Mario Gtz" class="comment-reply-link" href="#comment-452834" onclick='return addComment.moveForm( "comment-452834", "452834", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-452849">
<div class="comment-container" id="li-comment-452849">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 27, 2018 at 6:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-452849" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have an example of using a generator in this post that might provide a useful guide:<br/>
<a href="https://machinelearningmastery.com/develop-a-deep-learning-caption-generation-model-in-python/" rel="nofollow">https://machinelearningmastery.com/develop-a-deep-learning-caption-generation-model-in-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-452849" onclick='return addComment.moveForm( "comment-452849", "452849", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-455288">
<div class="comment-container" id="li-comment-455288">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d60223d2636f5f79afff713e4d64edca?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d60223d2636f5f79afff713e4d64edca?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://duliqiang.me" rel="external nofollow">duliqiang</a></span>
<span class="date">November 18, 2018 at 2:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-455288" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason, thanks for this great tutorial.</p>
<p> Here I have a question for you, when I’m trying your example of feature standardization in my local computer, I see no changes related to darkening or lightening, the resulting images seems same. I cannot figure out why. By the way, in order to just compare the first 9 images, we must set shuffle to False when we use flow() function to get batches.</p>
<p>Here are code:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0ca6f1bd1fb015818876" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
```python
# Standardize images across the dataset, mean=0, stdev=1
from keras.datasets import mnist
from keras.preprocessing.image import ImageDataGenerator
from matplotlib import pyplot
from keras import backend as K
K.set_image_dim_ordering('th')

# load data
(X_train, y_train), (X_test, y_test) = mnist.load_data()

# reshape to be [samples][pixels][width][height]
X_train = X_train.reshape(X_train.shape[0], 1, 28, 28)
X_test = X_test.reshape(X_test.shape[0], 1, 28, 28)

# convert from int to float
X_train = X_train.astype('float32')
X_test = X_test.astype('float32')

# define data preparation
datagen = ImageDataGenerator(
    featurewise_center=True,
    featurewise_std_normalization=True)

# fit parameters from data
datagen.fit(X_train)

# configure batch size and retrieve one batch of images
for X_batch, y_batch in datagen.flow(X_train, y_train, batch_size=9, shuffle=False):
    # create a grid of 3x3 images
    for i in range(0, 9):
        pyplot.subplot(330 + 1 + i)
        pyplot.imshow(X_batch[i].reshape(28, 28), cmap=pyplot.get_cmap('gray'))
    # show the plot
    pyplot.show()
    break

```</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0ca6f1bd1fb015818876-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd1fb015818876-2">2</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd1fb015818876-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd1fb015818876-4">4</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd1fb015818876-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd1fb015818876-6">6</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd1fb015818876-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd1fb015818876-8">8</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd1fb015818876-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd1fb015818876-10">10</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd1fb015818876-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd1fb015818876-12">12</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd1fb015818876-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd1fb015818876-14">14</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd1fb015818876-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd1fb015818876-16">16</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd1fb015818876-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd1fb015818876-18">18</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd1fb015818876-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd1fb015818876-20">20</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd1fb015818876-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd1fb015818876-22">22</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd1fb015818876-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd1fb015818876-24">24</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd1fb015818876-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd1fb015818876-26">26</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd1fb015818876-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd1fb015818876-28">28</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd1fb015818876-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd1fb015818876-30">30</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd1fb015818876-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd1fb015818876-32">32</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd1fb015818876-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd1fb015818876-34">34</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd1fb015818876-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd1fb015818876-36">36</div><div class="crayon-num" data-line="crayon-5c0ca6f1bd1fb015818876-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0ca6f1bd1fb015818876-38">38</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0ca6f1bd1fb015818876-1"><span class="crayon-sy">`</span><span class="crayon-sy">`</span><span class="crayon-sy">`</span><span class="crayon-v">python</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd1fb015818876-2"><span class="crayon-p"># Standardize images across the dataset, mean=0, stdev=1</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd1fb015818876-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">mnist</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd1fb015818876-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">image </span><span class="crayon-e">import </span><span class="crayon-e">ImageDataGenerator</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd1fb015818876-5"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd1fb015818876-6"><span class="crayon-e">from </span><span class="crayon-e">keras </span><span class="crayon-e">import </span><span class="crayon-e">backend </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">K</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd1fb015818876-7"><span class="crayon-v">K</span><span class="crayon-sy">.</span><span class="crayon-e">set_image_dim_ordering</span><span class="crayon-sy">(</span><span class="crayon-s">'th'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd1fb015818876-8"> </div><div class="crayon-line" id="crayon-5c0ca6f1bd1fb015818876-9"><span class="crayon-p"># load data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd1fb015818876-10"><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd1fb015818876-11"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd1fb015818876-12"><span class="crayon-p"># reshape to be [samples][pixels][width][height]</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd1fb015818876-13"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd1fb015818876-14"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd1fb015818876-15"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd1fb015818876-16"><span class="crayon-p"># convert from int to float</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd1fb015818876-17"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd1fb015818876-18"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd1fb015818876-19"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd1fb015818876-20"><span class="crayon-p"># define data preparation</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd1fb015818876-21"><span class="crayon-v">datagen</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ImageDataGenerator</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd1fb015818876-22"><span class="crayon-h">    </span><span class="crayon-v">featurewise_center</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd1fb015818876-23"><span class="crayon-h">    </span><span class="crayon-v">featurewise_std_normalization</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd1fb015818876-24"> </div><div class="crayon-line" id="crayon-5c0ca6f1bd1fb015818876-25"><span class="crayon-p"># fit parameters from data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd1fb015818876-26"><span class="crayon-v">datagen</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd1fb015818876-27"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd1fb015818876-28"><span class="crayon-p"># configure batch size and retrieve one batch of images</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd1fb015818876-29"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">X_batch</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">y_batch </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">datagen</span><span class="crayon-sy">.</span><span class="crayon-e">flow</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shuffle</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd1fb015818876-30"><span class="crayon-h">    </span><span class="crayon-p"># create a grid of 3x3 images</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd1fb015818876-31"><span class="crayon-h">    </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd1fb015818876-32"><span class="crayon-h">        </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">330</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd1fb015818876-33"><span class="crayon-h">        </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">X_batch</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-o">=</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">get_cmap</span><span class="crayon-sy">(</span><span class="crayon-s">'gray'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd1fb015818876-34"><span class="crayon-h">    </span><span class="crayon-p"># show the plot</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd1fb015818876-35"><span class="crayon-h">    </span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd1fb015818876-36"><span class="crayon-h">    </span><span class="crayon-st">break</span></div><div class="crayon-line" id="crayon-5c0ca6f1bd1fb015818876-37"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0ca6f1bd1fb015818876-38"><span class="crayon-sy">`</span><span class="crayon-sy">`</span><span class="crayon-sy">`</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0030 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to duliqiang" class="comment-reply-link" href="#comment-455288" onclick='return addComment.moveForm( "comment-455288", "455288", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-455430">
<div class="comment-container" id="li-comment-455430">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 19, 2018 at 6:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-455430" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps the API has changed?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-455430" onclick='return addComment.moveForm( "comment-455430", "455430", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-455642">
<div class="comment-container" id="li-comment-455642">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/79bce0583c57af8e37309f4a0b8310da?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/79bce0583c57af8e37309f4a0b8310da?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Benjamin</span>
<span class="date">November 20, 2018 at 9:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-455642" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I have a question:<br/>
why do you convert the data to float before further working with it.<br/>
Is this necessary and will it lead to wrong results when obmitted?</p>
<p>Thank you</p>
<div class="reply">
<a aria-label="Reply to Benjamin" class="comment-reply-link" href="#comment-455642" onclick='return addComment.moveForm( "comment-455642", "455642", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-455692">
<div class="comment-container" id="li-comment-455692">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 21, 2018 at 7:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-455692" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I believed it was required at the time.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-455692" onclick='return addComment.moveForm( "comment-455692", "455692", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-456499">
<div class="comment-container" id="li-comment-456499">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/254ee96a0d46bdd61f8705256332a583?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/254ee96a0d46bdd61f8705256332a583?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Luc</span>
<span class="date">November 29, 2018 at 2:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-456499" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason !<br/>
Nice post as always !<br/>
I think I missed something, I looked at previous replies but I didnt find a clear answer to my question, so let me ask it, sorry if you already answered to it.</p>
<p>When you use the fit_generator() method, the model is trained only with the transformed images? It is not trained with original images + transformed image, right?</p>
<p>ImageGenerator allows to generate transformed data to augment the dataset.<br/>
But what is the point of training the model only with the transformed images and not with original images PLUS the transformed images? </p>
<p>I feel that the point of augmenting is to augment 😀 so if our dataset is not bigger after, it is not augmented.</p>
<p>What am I missing here? If keras implemented it this way, it maybe good to train only with transformed images, but why? I thought that the whole point of this was to increase the number of images to train with.</p>
<p>Is it possible, with the same methods, to generate mutiple type of transformed images (rotation, translation and whitening for exemple) and train the model with all transformed images and also with original images?</p>
<p>That would make more sense and that would really be augmentation of the original dataset.</p>
<div class="reply">
<a aria-label="Reply to Luc" class="comment-reply-link" href="#comment-456499" onclick='return addComment.moveForm( "comment-456499", "456499", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-456543">
<div class="comment-container" id="li-comment-456543">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 29, 2018 at 7:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/image-augmentation-deep-learning-keras/#comment-456543" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It is only trained on the augmented images. The set of augmented images covers un-augmented images – it has expanded the training dataset.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-456543" onclick='return addComment.moveForm( "comment-456543", "456543", "respond", "2587" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/image-augmentation-deep-learning-keras/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="2587"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="6ad4840ff8"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="195"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery!</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Jason Brownlee, PhD
<br/>
I write tutorials to help developers (<i>like you</i>) get results with machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-6"> <div class="textwidget"><p></p><center><br/>
<strong>Deep Learning with Python</strong><br/>
No math, just tutorials and working code.
<p><a href="/deep-learning-with-python/">Click to Get Started Now!</a><br/>
<a href="/deep-learning-with-python/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/05/DeepLearningWithPython-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch"><img alt="How to Develop a Neural Machine Translation System in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/01/How-to-Develop-a-Neural-Machine-Translation-System-in-Keras-150x150.jpg" title="How to Develop a Neural Machine Translation System from Scratch" width="45"/></a> <a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch">How to Develop a Neural Machine Translation System from Scratch</a>
<span class="meta">January 10, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning"><img alt="Difference Between Classification and Regression in Machine Learning" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/Difference-Between-Classification-and-Regression-in-Machine-Learning-150x150.jpg" title="Difference Between Classification and Regression in Machine Learning" width="45"/></a> <a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning">Difference Between Classification and Regression in Machine Learning</a>
<span class="meta">December 11, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem..."><img alt="So, You are Working on a Machine Learning Problem..." class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/So-You-are-Working-on-a-Machine-Learning-Problem...-150x150.jpg" title="So, You are Working on a Machine Learning Problem..." width="45"/></a> <a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem…">So, You are Working on a Machine Learning Problem…</a>
<span class="meta">April 4, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis"><img alt="Plot of the Multichannel Convolutional Neural Network For Text" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-150x150.png" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis" width="45"/></a> <a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis">How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis</a>
<span class="meta">January 12, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras"><img alt="How to Make Classification and Regression Predictions for Deep Learning Models in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/How-to-Make-Classification-and-Regression-Predictions-for-Deep-Learning-Models-in-Keras-150x150.jpg" title="How to Make Predictions with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras">How to Make Predictions with Keras</a>
<span class="meta">April 9, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)"><img alt="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/11-Classical-Time-Series-Forecasting-Methods-in-Python-Cheat-Sheet-150x150.jpg" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)">11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)</a>
<span class="meta">August 6, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras"><img alt="How to Visualize a Deep Learning Neural Network Model in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/How-to-Visualize-a-Deep-Learning-Neural-Network-Model-in-Keras-150x150.jpg" title="How to Visualize a Deep Learning Neural Network Model in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras">How to Visualize a Deep Learning Neural Network Model in Keras</a>
<span class="meta">December 13, 2017</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> <div class="widget_text widget widget_custom_html" id="custom_html-2"><h3>You might also like…</h3><div class="textwidget custom-html-widget"><ul>
<li><a href="/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Install Python for Machine Learning</a></li>
<li><a href="/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python</a></li>
<li><a href="/tutorial-first-neural-network-python-keras/">Your First Neural Network in Python</a></li>
<li><a href="/how-to-run-your-first-classifier-in-weka/">Your First Classifier in Weka</a></li>
<li><a href="/arima-for-time-series-forecasting-with-python/">Your First Time Series Forecasting Project</a></li>
</ul></div></div></aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/disclaimer/">Disclaimer</a> | 
<a href="/terms-of-service/">Terms</a> | 
<a href="/contact/">Contact</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.8" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.0.5" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.8" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.1" type="text/javascript"></script>
<script type="text/javascript">		var ssb_admin_ajax = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
		var ssb_post_id = 2587 ;
		var ssb_post_url = 'https://machinelearningmastery.com/image-augmentation-deep-learning-keras/';
		var ssb_alternate_post_url = 'http://machinelearningmastery.com/image-augmentation-deep-learning-keras/';
		jQuery( document ).ready(function(){
		var is_ssb_used = jQuery('.simplesocialbuttons');
		if( is_ssb_used ) {

			var data = {
			'action': 'ssb_fetch_data',
			'postID': ssb_post_id
		};
			jQuery.post(ssb_admin_ajax, data, function(data, textStatus, xhr) {
				var array = JSON.parse(data);

				jQuery.each( array, function( index, value ){

					if( index == 'total' ){
						jQuery('.ssb_'+ index +'_counter').html(value + '<span>Shares</span>');
					}else{
						jQuery('.ssb_'+ index +'_counter').html(value);
					}
				});

			});
		}
		})

		document.addEventListener("DOMContentLoaded", function() {
			var if_ssb_exist = document.getElementsByClassName( "simplesocialbuttons" ).length > 0;
			if (if_ssb_exist) {
				ssbPlugin.fetchFacebookShares();
			}
		});;
		</script></body>
</html>