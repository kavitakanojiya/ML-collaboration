<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="utf-8"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<link href="https://machinelearningmastery.com/xmlrpc.php" rel="pingback"/>
<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport"/>
<!-- This site is optimized with the Yoast SEO plugin v9.2.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</title>
<link href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" rel="canonical"/>
<link href="https://plus.google.com/u/0/b/117073416089354242117/+MachinelearningmasteryHome/" rel="publisher"/>
<meta content="en_US" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" property="og:title"/>
<meta content="Sequence classification is a predictive modeling problem where you have some sequence of inputs over space or time and the task is to predict a category for the sequence. What makes this problem difficult is that the sequences can vary in length, be comprised of a very large vocabulary of input symbols and may require …" property="og:description"/>
<meta content="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" property="og:url"/>
<meta content="Machine Learning Mastery" property="og:site_name"/>
<meta content="https://www.facebook.com/Machine-Learning-Mastery-1429846323896563/" property="article:publisher"/>
<meta content="https://www.facebook.com/jason.brownlee.39" property="article:author"/>
<meta content="Deep Learning for Natural Language Processing" property="article:section"/>
<meta content="2016-07-25T19:00:29+00:00" property="article:published_time"/>
<meta content="2018-05-06T23:56:13+00:00" property="article:modified_time"/>
<meta content="2018-05-06T23:56:13+00:00" property="og:updated_time"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras.jpg" property="og:image"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras.jpg" property="og:image:secure_url"/>
<meta content="640" property="og:image:width"/>
<meta content="426" property="og:image:height"/>
<meta content="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" property="og:image:alt"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"Organization","url":"https:\/\/machinelearningmastery.com\/","sameAs":["https:\/\/www.facebook.com\/Machine-Learning-Mastery-1429846323896563\/","https:\/\/www.linkedin.com\/in\/jasonbrownlee","https:\/\/plus.google.com\/u\/0\/b\/117073416089354242117\/+MachinelearningmasteryHome\/","https:\/\/twitter.com\/TeachTheMachine"],"@id":"https:\/\/machinelearningmastery.com\/#organization","name":"Machine Learning Mastery","logo":"https:\/\/machinelearningmastery.com\/wp-content\/uploads\/2016\/09\/cropped-icon.png"}</script>
<!-- / Yoast SEO plugin. -->
<link href="//s.w.org" rel="dns-prefetch"/>
<link href="https://feeds.feedburner.com/MachineLearningMastery" rel="alternate" title="Machine Learning Mastery » Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/comments/feed/" rel="alternate" title="Machine Learning Mastery » Comments Feed" type="application/rss+xml"/>
<link href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/feed/" rel="alternate" title="Machine Learning Mastery » Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras Comments Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<style media="all" type="text/css">
.wpautoterms-footer{background-color:#ffffff;text-align:center;}
.wpautoterms-footer a{color:#000000;font-family:Arial, sans-serif;font-size:14px;}
.wpautoterms-footer .separator{color:#cccccc;font-family:Arial, sans-serif;font-size:14px;}</style>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta" id="crayon-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta" id="crayon-theme-classic-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta" id="crayon-font-monaco-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/auto-terms-of-service-and-privacy-policy/css/wpautoterms.css?ver=4.9.8" id="wpautoterms_css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.0.5" id="contact-form-7-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/css/front.css?ver=2.0.20" id="ssb-front-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/ewd-ufaq-styles.css?ver=4.9.8" id="ewd-ufaq-style-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/ultimate-faqs/css/rrssb-min.css?ver=4.9.8" id="ewd-ufaq-rrssb-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/integrations/testimonials/css/testimonials.css?ver=4.9.8" id="woo-testimonials-css-css" media="all" rel="stylesheet" type="text/css"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/style.css?ver=5.9.21" id="theme-stylesheet-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery.js?ver=1.12.4" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/simple-social-buttons/assets/js/front.js?ver=2.0.20" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/third-party.min.js?ver=4.9.8" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/modernizr.min.js?ver=2.6.2" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/includes/js/general.min.js?ver=4.9.8" type="text/javascript"></script>
<link href="https://machinelearningmastery.com/wp-json/" rel="https://api.w.org/"/>
<link href="https://machinelearningmastery.com/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="https://machinelearningmastery.com/?p=2938" rel="shortlink"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fsequence-classification-lstm-recurrent-neural-networks-python-keras%2F" rel="alternate" type="application/json+oembed"/>
<link href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fsequence-classification-lstm-recurrent-neural-networks-python-keras%2F&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<style media="screen">

        .simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
      margin: ;
    }
         /*inline margin*/
    
  
  
  
  
  
          .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
         margin: ;
     }

          /*margin-digbar*/

  
  
  
  
 
   
   

</style>
<script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#4c89bf; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#4c89bf;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#4c89bf!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#ffffff;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>
<!-- Woo Shortcodes CSS -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/functions/css/shortcodes.css" rel="stylesheet" type="text/css"/>
<!-- Custom Stylesheet -->
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/custom.css" rel="stylesheet" type="text/css"/>
<!-- Theme version -->
<meta content="Canvas 5.9.21" name="generator"/>
<meta content="WooFramework 6.2.9" name="generator"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" rel="icon" sizes="32x32"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" rel="icon" sizes="192x192"/>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png" rel="apple-touch-icon-precomposed"/>
<meta content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png" name="msapplication-TileImage"/>
</head>
<body class="post-template-default single single-post postid-2938 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">
<div id="inner-wrapper">
<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>
<header class="col-full" id="header">
<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img alt="Machine Learning Mastery" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/icon-100x100.png"/></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
<div class="header-widget">
<div class="widget widget_text" id="text-44"> <div class="textwidget"><p>Want help with deep learning for text? <a href="https://machinelearningmastery.lpages.co/dlfnlp-mini-course/">Take the FREE Mini-Course</a></p>
</div>
</div><div class="widget widget_search" id="search-3"><div class="search_main">
<form action="https://machinelearningmastery.com/" class="searchform" method="get">
<input class="field s" name="s" onblur="if (this.value == '') {this.value = 'Search...';}" onfocus="if (this.value == 'Search...') {this.value = '';}" type="text" value="Search..."/>
<input name="post_type" type="hidden" value="post"/>
<button class="fa fa-search submit" name="submit" type="submit" value="Search"></button>
</form>
<div class="fix"></div>
</div></div> </div>
</header>
<nav class="col-full" id="navigation" role="navigation">
<section class="menus">
<a class="nav-home" href="https://machinelearningmastery.com"><span>Home</span></a>
<h3>Main Menu</h3><ul class="nav fl" id="main-nav"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503" id="menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Start Here</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501" id="menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506" id="menu-item-6506"><a href="#">Topics</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508" id="menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (Keras)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511" id="menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509" id="menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6515" id="menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">Deep Learning for NLP</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512" id="menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Understand Algorithms</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507" id="menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms (Python)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6513" id="menu-item-6513"><a href="https://machinelearningmastery.com/category/machine-learning-process/">Machine Learning Process</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516" id="menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517" id="menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522" id="menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6518" id="menu-item-6518"><a href="https://machinelearningmastery.com/category/start-machine-learning/">Getting Started</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510" id="menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519" id="menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistical Methods</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520" id="menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Time Series (introductory)</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523" id="menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6514" id="menu-item-6514"><a href="https://machinelearningmastery.com/category/machine-learning-resources/">Resources</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502" id="menu-item-6502"><a href="https://machinelearningmastery.com/products/">Ebooks</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500" id="menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504" id="menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505" id="menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul> <div class="side-nav">
</div><!-- /#side-nav -->
</section><!-- /.menus -->
<a class="nav-close" href="#top"><span>Return to Content</span></a>
</nav>
<!-- #content Starts -->
<div class="col-full" id="content">
<div id="main-sidebar-container">
<!-- #main Starts -->
<section id="main">
<article class="post-2938 post type-post status-publish format-standard has-post-thumbnail hentry category-natural-language-processing">
<header>
<h1 class="title entry-title">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</h1> </header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" rel="author" title="Posts by Jason Brownlee">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-07-26T05:00:29+1100">July 26, 2016</abbr> <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/natural-language-processing/" title="View all items in Deep Learning for Natural Language Processing">Deep Learning for Natural Language Processing</a></span> </div>
<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-2938 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=Sequence+Classification+with+LSTM+Recurrent+Neural+Networks+in+Python+with+Keras&amp;url=https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
<p>Sequence classification is a predictive modeling problem where you have some sequence of inputs over space or time and the task is to predict a category for the sequence.</p>
<p>What makes this problem difficult is that the sequences can vary in length, be comprised of a very large vocabulary of input symbols and may require the model to learn the long-term context or dependencies between symbols in the input sequence.</p>
<p>In this post, you will discover how you can develop LSTM recurrent neural network models for sequence classification problems in Python using the Keras deep learning library.</p>
<p>After reading this post you will know:</p>
<ul>
<li>How to develop an LSTM model for a sequence classification problem.</li>
<li>How to reduce overfitting in your LSTM models through the use of dropout.</li>
<li>How to combine LSTM models with Convolutional Neural Networks that excel at learning spatial relationships.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Oct/2016</strong>: Updated examples for Keras 1.1.0 andTensorFlow 0.10.0.</li>
<li><strong>Update Mar/2017</strong>: Updated example for Keras 2.0.2, TensorFlow 1.0.1 and Theano 0.9.0.</li>
<li><strong>Update May/2018</strong>: Updated code to use the most recent Keras API, thanks jeremy rutman.</li>
</ul>
<div class="wp-caption aligncenter" id="attachment_2939" style="width: 650px"><img alt="Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras" class="size-full wp-image-2939" height="426" sizes="(max-width: 640px) 100vw, 640px" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras.jpg" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/07/Sequence-Classification-with-LSTM-Recurrent-Neural-Networks-in-Python-with-Keras-300x200.jpg 300w" width="640"/><p class="wp-caption-text">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras<br/>Photo by <a href="https://www.flickr.com/photos/photophilde/4875287879/">photophilde</a>, some rights reserved.</p></div>
<h2>Problem Description</h2>
<p>The problem that we will use to demonstrate sequence learning in this tutorial is the <a href="http://ai.stanford.edu/~amaas/data/sentiment/">IMDB movie review sentiment classification problem</a>. Each movie review is a variable sequence of words and the sentiment of each movie review must be classified.</p>
<p>The Large Movie Review Dataset (often referred to as the IMDB dataset) contains 25,000 highly-polar movie reviews (good or bad) for training and the same amount again for testing. The problem is to determine whether a given movie review has a positive or negative sentiment.</p>
<p>The data was collected by <a href="http://ai.stanford.edu/~amaas/papers/wvSent_acl2011.pdf">Stanford researchers and was used in a 2011 paper</a> where a split of 50-50 of the data was used for training and test. An accuracy of 88.89% was achieved.</p>
<p>Keras provides access to the IMDB dataset built-in. The <strong>imdb.load_data()</strong> function allows you to load the dataset in a format that is ready for use in neural network and deep learning models.</p>
<p>The words have been replaced by integers that indicate the ordered frequency of each word in the dataset. The sentences in each review are therefore comprised of a sequence of integers.</p>
<h3>Word Embedding</h3>
<p>We will map each movie review into a real vector domain, a popular technique when working with text called word embedding. This is a technique where words are encoded as real-valued vectors in a high dimensional space, where the similarity between words in terms of meaning translates to closeness in the vector space.</p>
<p>Keras provides a convenient way to convert positive integer representations of words into a word embedding by an Embedding layer.</p>
<p>We will map each word onto a 32 length real valued vector. We will also limit the total number of words that we are interested in modeling to the 5000 most frequent words, and zero out the rest. Finally, the sequence length (number of words) in each review varies, so we will constrain each review to be 500 words, truncating long reviews and pad the shorter reviews with zero values.</p>
<p>Now that we have defined our problem and how the data will be prepared and modeled, we are ready to develop an LSTM model to classify the sentiment of movie reviews.</p>
<div class="woo-sc-hr"></div>
<center>
<h3>Need help with LSTMs for Sequence Prediction?</h3>
<p>Take my free 7-day email course and discover 6 different LSTM architectures (with code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.lpages.co/leadbox/1403a9373f72a2%3A164f8be4f346dc/5754903989321728/" rel="noopener" style="background: #ffce0a; color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.25) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.5) 0px 1px 3px inset, rgba(0, 0, 0, 0.5) 0px 1px 3px;" target="_blank">Start Your FREE Mini-Course Now!</a><script data-config="%7B%7D" data-leadbox="1403a9373f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.lpages.co/leadbox/1403a9373f72a2%3A164f8be4f346dc/5754903989321728/" src="https://machinelearningmastery.lpages.co/leadbox-1500400021.js" type="text/javascript"></script></p>
</center>
<div class="woo-sc-hr"></div>
<h2>Simple LSTM for Sequence Classification</h2>
<p>We can quickly develop a small LSTM for the IMDB problem and achieve good accuracy.</p>
<p>Let’s start off by importing the classes and functions required for this model and initializing the random number generator to a constant value to ensure we can easily reproduce the results.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7d4554836596492" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
import numpy
from keras.datasets import imdb
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
from keras.layers.embeddings import Embedding
from keras.preprocessing import sequence
# fix random seed for reproducibility
numpy.random.seed(7)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7d4554836596492-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4554836596492-2">2</div><div class="crayon-num" data-line="crayon-5c0caac7d4554836596492-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4554836596492-4">4</div><div class="crayon-num" data-line="crayon-5c0caac7d4554836596492-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4554836596492-6">6</div><div class="crayon-num" data-line="crayon-5c0caac7d4554836596492-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4554836596492-8">8</div><div class="crayon-num" data-line="crayon-5c0caac7d4554836596492-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7d4554836596492-1"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4554836596492-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">imdb</span></div><div class="crayon-line" id="crayon-5c0caac7d4554836596492-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4554836596492-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line" id="crayon-5c0caac7d4554836596492-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4554836596492-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">embeddings </span><span class="crayon-e">import </span><span class="crayon-e">Embedding</span></div><div class="crayon-line" id="crayon-5c0caac7d4554836596492-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-v">sequence</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4554836596492-8"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line" id="crayon-5c0caac7d4554836596492-9"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>We need to load the IMDB dataset. We are constraining the dataset to the top 5,000 words. We also split the dataset into train (50%) and test (50%) sets.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7d455e022609064" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# load the dataset but only keep the top n words, zero the rest
top_words = 5000
(X_train, y_train), (X_test, y_test) = imdb.load_data(num_words=top_words)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7d455e022609064-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d455e022609064-2">2</div><div class="crayon-num" data-line="crayon-5c0caac7d455e022609064-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7d455e022609064-1"><span class="crayon-p"># load the dataset but only keep the top n words, zero the rest</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d455e022609064-2"><span class="crayon-v">top_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span></div><div class="crayon-line" id="crayon-5c0caac7d455e022609064-3"><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">imdb</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-v">num_words</span><span class="crayon-o">=</span><span class="crayon-v">top_words</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Next, we need to truncate and pad the input sequences so that they are all the same length for modeling. The model will learn the zero values carry no information so indeed the sequences are not the same length in terms of content, but same length vectors is required to perform the computation in Keras.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7d4560743414901" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# truncate and pad input sequences
max_review_length = 500
X_train = sequence.pad_sequences(X_train, maxlen=max_review_length)
X_test = sequence.pad_sequences(X_test, maxlen=max_review_length)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7d4560743414901-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4560743414901-2">2</div><div class="crayon-num" data-line="crayon-5c0caac7d4560743414901-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4560743414901-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7d4560743414901-1"><span class="crayon-p"># truncate and pad input sequences</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4560743414901-2"><span class="crayon-v">max_review_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">500</span></div><div class="crayon-line" id="crayon-5c0caac7d4560743414901-3"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">.</span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4560743414901-4"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">.</span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>We can now define, compile and fit our LSTM model.</p>
<p>The first layer is the Embedded layer that uses 32 length vectors to represent each word. The next layer is the LSTM layer with 100 memory units (smart neurons). Finally, because this is a classification problem we use a Dense output layer with a single neuron and a sigmoid activation function to make 0 or 1 predictions for the two classes (good and bad) in the problem.</p>
<p>Because it is a binary classification problem, log loss is used as the loss function (<strong>binary_crossentropy</strong> in Keras). The efficient ADAM optimization algorithm is used. The model is fit for only 2 epochs because it quickly overfits the problem. A large batch size of 64 reviews is used to space out weight updates.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7d4562449903355" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# create the model
embedding_vecor_length = 32
model = Sequential()
model.add(Embedding(top_words, embedding_vecor_length, input_length=max_review_length))
model.add(LSTM(100))
model.add(Dense(1, activation='sigmoid'))
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
print(model.summary())
model.fit(X_train, y_train, validation_data=(X_test, y_test), epochs=3, batch_size=64)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7d4562449903355-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4562449903355-2">2</div><div class="crayon-num" data-line="crayon-5c0caac7d4562449903355-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4562449903355-4">4</div><div class="crayon-num" data-line="crayon-5c0caac7d4562449903355-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4562449903355-6">6</div><div class="crayon-num" data-line="crayon-5c0caac7d4562449903355-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4562449903355-8">8</div><div class="crayon-num" data-line="crayon-5c0caac7d4562449903355-9">9</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7d4562449903355-1"><span class="crayon-p"># create the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4562449903355-2"><span class="crayon-v">embedding_vecor_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">32</span></div><div class="crayon-line" id="crayon-5c0caac7d4562449903355-3"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4562449903355-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">top_words</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">embedding_vecor_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4562449903355-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4562449903355-6"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4562449903355-7"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4562449903355-8"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4562449903355-9"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">validation_data</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">64</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>Once fit, we estimate the performance of the model on unseen reviews.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7d4564705871417" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# Final evaluation of the model
scores = model.evaluate(X_test, y_test, verbose=0)
print("Accuracy: %.2f%%" % (scores[1]*100))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7d4564705871417-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4564705871417-2">2</div><div class="crayon-num" data-line="crayon-5c0caac7d4564705871417-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7d4564705871417-1"><span class="crayon-p"># Final evaluation of the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4564705871417-2"><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4564705871417-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Accuracy: %.2f%%"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>For completeness, here is the full code listing for this LSTM network on the IMDB dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7d4565428725149" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# LSTM for sequence classification in the IMDB dataset
import numpy
from keras.datasets import imdb
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
from keras.layers.embeddings import Embedding
from keras.preprocessing import sequence
# fix random seed for reproducibility
numpy.random.seed(7)
# load the dataset but only keep the top n words, zero the rest
top_words = 5000
(X_train, y_train), (X_test, y_test) = imdb.load_data(num_words=top_words)
# truncate and pad input sequences
max_review_length = 500
X_train = sequence.pad_sequences(X_train, maxlen=max_review_length)
X_test = sequence.pad_sequences(X_test, maxlen=max_review_length)
# create the model
embedding_vecor_length = 32
model = Sequential()
model.add(Embedding(top_words, embedding_vecor_length, input_length=max_review_length))
model.add(LSTM(100))
model.add(Dense(1, activation='sigmoid'))
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
print(model.summary())
model.fit(X_train, y_train, epochs=3, batch_size=64)
# Final evaluation of the model
scores = model.evaluate(X_test, y_test, verbose=0)
print("Accuracy: %.2f%%" % (scores[1]*100))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7d4565428725149-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4565428725149-2">2</div><div class="crayon-num" data-line="crayon-5c0caac7d4565428725149-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4565428725149-4">4</div><div class="crayon-num" data-line="crayon-5c0caac7d4565428725149-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4565428725149-6">6</div><div class="crayon-num" data-line="crayon-5c0caac7d4565428725149-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4565428725149-8">8</div><div class="crayon-num" data-line="crayon-5c0caac7d4565428725149-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4565428725149-10">10</div><div class="crayon-num" data-line="crayon-5c0caac7d4565428725149-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4565428725149-12">12</div><div class="crayon-num" data-line="crayon-5c0caac7d4565428725149-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4565428725149-14">14</div><div class="crayon-num" data-line="crayon-5c0caac7d4565428725149-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4565428725149-16">16</div><div class="crayon-num" data-line="crayon-5c0caac7d4565428725149-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4565428725149-18">18</div><div class="crayon-num" data-line="crayon-5c0caac7d4565428725149-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4565428725149-20">20</div><div class="crayon-num" data-line="crayon-5c0caac7d4565428725149-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4565428725149-22">22</div><div class="crayon-num" data-line="crayon-5c0caac7d4565428725149-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4565428725149-24">24</div><div class="crayon-num" data-line="crayon-5c0caac7d4565428725149-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4565428725149-26">26</div><div class="crayon-num" data-line="crayon-5c0caac7d4565428725149-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4565428725149-28">28</div><div class="crayon-num" data-line="crayon-5c0caac7d4565428725149-29">29</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7d4565428725149-1"><span class="crayon-p"># LSTM for sequence classification in the IMDB dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4565428725149-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5c0caac7d4565428725149-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">imdb</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4565428725149-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5c0caac7d4565428725149-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4565428725149-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5c0caac7d4565428725149-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">embeddings </span><span class="crayon-e">import </span><span class="crayon-e">Embedding</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4565428725149-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-v">sequence</span></div><div class="crayon-line" id="crayon-5c0caac7d4565428725149-9"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4565428725149-10"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4565428725149-11"><span class="crayon-p"># load the dataset but only keep the top n words, zero the rest</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4565428725149-12"><span class="crayon-v">top_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span></div><div class="crayon-line" id="crayon-5c0caac7d4565428725149-13"><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">imdb</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-v">num_words</span><span class="crayon-o">=</span><span class="crayon-v">top_words</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4565428725149-14"><span class="crayon-p"># truncate and pad input sequences</span></div><div class="crayon-line" id="crayon-5c0caac7d4565428725149-15"><span class="crayon-v">max_review_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">500</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4565428725149-16"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">.</span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4565428725149-17"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">.</span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4565428725149-18"><span class="crayon-p"># create the model</span></div><div class="crayon-line" id="crayon-5c0caac7d4565428725149-19"><span class="crayon-v">embedding_vecor_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">32</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4565428725149-20"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4565428725149-21"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">top_words</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">embedding_vecor_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4565428725149-22"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4565428725149-23"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4565428725149-24"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4565428725149-25"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4565428725149-26"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">64</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4565428725149-27"><span class="crayon-p"># Final evaluation of the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4565428725149-28"><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4565428725149-29"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Accuracy: %.2f%%"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0016 seconds] -->
<p>Running this example produces the following output.</p>
<p>Note, if you are using a TensorFlow backend, you may see some warning messages related to “PoolAllocator”, that you can ignore for now.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7d4567460046775" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Epoch 1/3
16750/16750 [==============================] - 107s - loss: 0.5570 - acc: 0.7149
Epoch 2/3
16750/16750 [==============================] - 107s - loss: 0.3530 - acc: 0.8577
Epoch 3/3
16750/16750 [==============================] - 107s - loss: 0.2559 - acc: 0.9019
Accuracy: 86.79%</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7d4567460046775-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4567460046775-2">2</div><div class="crayon-num" data-line="crayon-5c0caac7d4567460046775-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4567460046775-4">4</div><div class="crayon-num" data-line="crayon-5c0caac7d4567460046775-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4567460046775-6">6</div><div class="crayon-num" data-line="crayon-5c0caac7d4567460046775-7">7</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7d4567460046775-1">Epoch 1/3</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4567460046775-2">16750/16750 [==============================] - 107s - loss: 0.5570 - acc: 0.7149</div><div class="crayon-line" id="crayon-5c0caac7d4567460046775-3">Epoch 2/3</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4567460046775-4">16750/16750 [==============================] - 107s - loss: 0.3530 - acc: 0.8577</div><div class="crayon-line" id="crayon-5c0caac7d4567460046775-5">Epoch 3/3</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4567460046775-6">16750/16750 [==============================] - 107s - loss: 0.2559 - acc: 0.9019</div><div class="crayon-line" id="crayon-5c0caac7d4567460046775-7">Accuracy: 86.79%</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>You can see that this simple LSTM with little tuning achieves near state-of-the-art results on the IMDB problem. Importantly, this is a template that you can use to apply LSTM networks to your own sequence classification problems.</p>
<p>Now, let’s look at some extensions of this simple model that you may also want to bring to your own problems.</p>
<h2>LSTM For Sequence Classification With Dropout</h2>
<p>Recurrent Neural networks like LSTM generally have the problem of overfitting.</p>
<p>Dropout can be applied between layers using the Dropout Keras layer. We can do this easily by adding new Dropout layers between the Embedding and LSTM layers and the LSTM and Dense output layers. For example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7d4569971171840" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
model = Sequential()
model.add(Embedding(top_words, embedding_vecor_length, input_length=max_review_length))
model.add(Dropout(0.2))
model.add(LSTM(100))
model.add(Dropout(0.2))
model.add(Dense(1, activation='sigmoid'))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7d4569971171840-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4569971171840-2">2</div><div class="crayon-num" data-line="crayon-5c0caac7d4569971171840-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4569971171840-4">4</div><div class="crayon-num" data-line="crayon-5c0caac7d4569971171840-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4569971171840-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7d4569971171840-1"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4569971171840-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">top_words</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">embedding_vecor_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4569971171840-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4569971171840-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4569971171840-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4569971171840-6"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>The full code listing example above with the addition of Dropout layers is as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7d4576589310428" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# LSTM with Dropout for sequence classification in the IMDB dataset
import numpy
from keras.datasets import imdb
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
from keras.layers import Dropout
from keras.layers.embeddings import Embedding
from keras.preprocessing import sequence
# fix random seed for reproducibility
numpy.random.seed(7)
# load the dataset but only keep the top n words, zero the rest
top_words = 5000
(X_train, y_train), (X_test, y_test) = imdb.load_data(num_words=top_words)
# truncate and pad input sequences
max_review_length = 500
X_train = sequence.pad_sequences(X_train, maxlen=max_review_length)
X_test = sequence.pad_sequences(X_test, maxlen=max_review_length)
# create the model
embedding_vecor_length = 32
model = Sequential()
model.add(Embedding(top_words, embedding_vecor_length, input_length=max_review_length))
model.add(Dropout(0.2))
model.add(LSTM(100))
model.add(Dropout(0.2))
model.add(Dense(1, activation='sigmoid'))
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
print(model.summary())
model.fit(X_train, y_train, epochs=3, batch_size=64)
# Final evaluation of the model
scores = model.evaluate(X_test, y_test, verbose=0)
print("Accuracy: %.2f%%" % (scores[1]*100))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7d4576589310428-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4576589310428-2">2</div><div class="crayon-num" data-line="crayon-5c0caac7d4576589310428-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4576589310428-4">4</div><div class="crayon-num" data-line="crayon-5c0caac7d4576589310428-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4576589310428-6">6</div><div class="crayon-num" data-line="crayon-5c0caac7d4576589310428-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4576589310428-8">8</div><div class="crayon-num" data-line="crayon-5c0caac7d4576589310428-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4576589310428-10">10</div><div class="crayon-num" data-line="crayon-5c0caac7d4576589310428-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4576589310428-12">12</div><div class="crayon-num" data-line="crayon-5c0caac7d4576589310428-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4576589310428-14">14</div><div class="crayon-num" data-line="crayon-5c0caac7d4576589310428-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4576589310428-16">16</div><div class="crayon-num" data-line="crayon-5c0caac7d4576589310428-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4576589310428-18">18</div><div class="crayon-num" data-line="crayon-5c0caac7d4576589310428-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4576589310428-20">20</div><div class="crayon-num" data-line="crayon-5c0caac7d4576589310428-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4576589310428-22">22</div><div class="crayon-num" data-line="crayon-5c0caac7d4576589310428-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4576589310428-24">24</div><div class="crayon-num" data-line="crayon-5c0caac7d4576589310428-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4576589310428-26">26</div><div class="crayon-num" data-line="crayon-5c0caac7d4576589310428-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4576589310428-28">28</div><div class="crayon-num" data-line="crayon-5c0caac7d4576589310428-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4576589310428-30">30</div><div class="crayon-num" data-line="crayon-5c0caac7d4576589310428-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4576589310428-32">32</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7d4576589310428-1"><span class="crayon-p"># LSTM with Dropout for sequence classification in the IMDB dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4576589310428-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5c0caac7d4576589310428-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">imdb</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4576589310428-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5c0caac7d4576589310428-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4576589310428-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5c0caac7d4576589310428-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dropout</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4576589310428-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">embeddings </span><span class="crayon-e">import </span><span class="crayon-e">Embedding</span></div><div class="crayon-line" id="crayon-5c0caac7d4576589310428-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-v">sequence</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4576589310428-10"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line" id="crayon-5c0caac7d4576589310428-11"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4576589310428-12"><span class="crayon-p"># load the dataset but only keep the top n words, zero the rest</span></div><div class="crayon-line" id="crayon-5c0caac7d4576589310428-13"><span class="crayon-v">top_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4576589310428-14"><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">imdb</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-v">num_words</span><span class="crayon-o">=</span><span class="crayon-v">top_words</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4576589310428-15"><span class="crayon-p"># truncate and pad input sequences</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4576589310428-16"><span class="crayon-v">max_review_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">500</span></div><div class="crayon-line" id="crayon-5c0caac7d4576589310428-17"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">.</span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4576589310428-18"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">.</span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4576589310428-19"><span class="crayon-p"># create the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4576589310428-20"><span class="crayon-v">embedding_vecor_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">32</span></div><div class="crayon-line" id="crayon-5c0caac7d4576589310428-21"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4576589310428-22"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">top_words</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">embedding_vecor_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4576589310428-23"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4576589310428-24"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4576589310428-25"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4576589310428-26"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4576589310428-27"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4576589310428-28"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4576589310428-29"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">64</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4576589310428-30"><span class="crayon-p"># Final evaluation of the model</span></div><div class="crayon-line" id="crayon-5c0caac7d4576589310428-31"><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4576589310428-32"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Accuracy: %.2f%%"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0018 seconds] -->
<p>Running this example provides the following output.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7d4579780676280" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Epoch 1/3
16750/16750 [==============================] - 108s - loss: 0.5802 - acc: 0.6898
Epoch 2/3
16750/16750 [==============================] - 108s - loss: 0.4112 - acc: 0.8232
Epoch 3/3
16750/16750 [==============================] - 108s - loss: 0.3825 - acc: 0.8365
Accuracy: 85.56%</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7d4579780676280-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4579780676280-2">2</div><div class="crayon-num" data-line="crayon-5c0caac7d4579780676280-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4579780676280-4">4</div><div class="crayon-num" data-line="crayon-5c0caac7d4579780676280-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4579780676280-6">6</div><div class="crayon-num" data-line="crayon-5c0caac7d4579780676280-7">7</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7d4579780676280-1">Epoch 1/3</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4579780676280-2">16750/16750 [==============================] - 108s - loss: 0.5802 - acc: 0.6898</div><div class="crayon-line" id="crayon-5c0caac7d4579780676280-3">Epoch 2/3</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4579780676280-4">16750/16750 [==============================] - 108s - loss: 0.4112 - acc: 0.8232</div><div class="crayon-line" id="crayon-5c0caac7d4579780676280-5">Epoch 3/3</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4579780676280-6">16750/16750 [==============================] - 108s - loss: 0.3825 - acc: 0.8365</div><div class="crayon-line" id="crayon-5c0caac7d4579780676280-7">Accuracy: 85.56%</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can see dropout having the desired impact on training with a slightly slower trend in convergence and in this case a lower final accuracy. The model could probably use a few more epochs of training and may achieve a higher skill (try it an see).</p>
<p>Alternately, dropout can be applied to the input and recurrent connections of the memory units with the LSTM precisely and separately.</p>
<p>Keras provides this capability with parameters on the LSTM layer, the <strong>dropout</strong> for configuring the input dropout and <strong>recurrent_dropout</strong> for configuring the recurrent dropout. For example, we can modify the first example to add dropout to the input and recurrent connections as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7d457a728746136" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
model = Sequential()
model.add(Embedding(top_words, embedding_vecor_length, input_length=max_review_length))
model.add(LSTM(100, dropout=0.2, recurrent_dropout=0.2))
model.add(Dense(1, activation='sigmoid'))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7d457a728746136-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d457a728746136-2">2</div><div class="crayon-num" data-line="crayon-5c0caac7d457a728746136-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d457a728746136-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7d457a728746136-1"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d457a728746136-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">top_words</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">embedding_vecor_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d457a728746136-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropout</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">recurrent_dropout</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d457a728746136-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>The full code listing with more precise LSTM dropout is listed below for completeness.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7d4580933673714" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# LSTM with dropout for sequence classification in the IMDB dataset
import numpy
from keras.datasets import imdb
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
from keras.layers.embeddings import Embedding
from keras.preprocessing import sequence
# fix random seed for reproducibility
numpy.random.seed(7)
# load the dataset but only keep the top n words, zero the rest
top_words = 5000
(X_train, y_train), (X_test, y_test) = imdb.load_data(num_words=top_words)
# truncate and pad input sequences
max_review_length = 500
X_train = sequence.pad_sequences(X_train, maxlen=max_review_length)
X_test = sequence.pad_sequences(X_test, maxlen=max_review_length)
# create the model
embedding_vecor_length = 32
model = Sequential()
model.add(Embedding(top_words, embedding_vecor_length, input_length=max_review_length))
model.add(LSTM(100, dropout=0.2, recurrent_dropout=0.2))
model.add(Dense(1, activation='sigmoid'))
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
print(model.summary())
model.fit(X_train, y_train, epochs=3, batch_size=64)
# Final evaluation of the model
scores = model.evaluate(X_test, y_test, verbose=0)
print("Accuracy: %.2f%%" % (scores[1]*100))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7d4580933673714-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4580933673714-2">2</div><div class="crayon-num" data-line="crayon-5c0caac7d4580933673714-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4580933673714-4">4</div><div class="crayon-num" data-line="crayon-5c0caac7d4580933673714-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4580933673714-6">6</div><div class="crayon-num" data-line="crayon-5c0caac7d4580933673714-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4580933673714-8">8</div><div class="crayon-num" data-line="crayon-5c0caac7d4580933673714-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4580933673714-10">10</div><div class="crayon-num" data-line="crayon-5c0caac7d4580933673714-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4580933673714-12">12</div><div class="crayon-num" data-line="crayon-5c0caac7d4580933673714-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4580933673714-14">14</div><div class="crayon-num" data-line="crayon-5c0caac7d4580933673714-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4580933673714-16">16</div><div class="crayon-num" data-line="crayon-5c0caac7d4580933673714-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4580933673714-18">18</div><div class="crayon-num" data-line="crayon-5c0caac7d4580933673714-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4580933673714-20">20</div><div class="crayon-num" data-line="crayon-5c0caac7d4580933673714-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4580933673714-22">22</div><div class="crayon-num" data-line="crayon-5c0caac7d4580933673714-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4580933673714-24">24</div><div class="crayon-num" data-line="crayon-5c0caac7d4580933673714-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4580933673714-26">26</div><div class="crayon-num" data-line="crayon-5c0caac7d4580933673714-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4580933673714-28">28</div><div class="crayon-num" data-line="crayon-5c0caac7d4580933673714-29">29</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7d4580933673714-1"><span class="crayon-p"># LSTM with dropout for sequence classification in the IMDB dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4580933673714-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5c0caac7d4580933673714-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">imdb</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4580933673714-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5c0caac7d4580933673714-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4580933673714-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5c0caac7d4580933673714-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">embeddings </span><span class="crayon-e">import </span><span class="crayon-e">Embedding</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4580933673714-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-v">sequence</span></div><div class="crayon-line" id="crayon-5c0caac7d4580933673714-9"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4580933673714-10"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4580933673714-11"><span class="crayon-p"># load the dataset but only keep the top n words, zero the rest</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4580933673714-12"><span class="crayon-v">top_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span></div><div class="crayon-line" id="crayon-5c0caac7d4580933673714-13"><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">imdb</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-v">num_words</span><span class="crayon-o">=</span><span class="crayon-v">top_words</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4580933673714-14"><span class="crayon-p"># truncate and pad input sequences</span></div><div class="crayon-line" id="crayon-5c0caac7d4580933673714-15"><span class="crayon-v">max_review_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">500</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4580933673714-16"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">.</span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4580933673714-17"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">.</span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4580933673714-18"><span class="crayon-p"># create the model</span></div><div class="crayon-line" id="crayon-5c0caac7d4580933673714-19"><span class="crayon-v">embedding_vecor_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">32</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4580933673714-20"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4580933673714-21"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">top_words</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">embedding_vecor_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4580933673714-22"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropout</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">recurrent_dropout</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4580933673714-23"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4580933673714-24"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4580933673714-25"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4580933673714-26"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">64</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4580933673714-27"><span class="crayon-p"># Final evaluation of the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4580933673714-28"><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4580933673714-29"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Accuracy: %.2f%%"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0017 seconds] -->
<p>Running this example provides the following output.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7d4582162065998" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Epoch 1/3
16750/16750 [==============================] - 112s - loss: 0.6623 - acc: 0.5935
Epoch 2/3
16750/16750 [==============================] - 113s - loss: 0.5159 - acc: 0.7484
Epoch 3/3
16750/16750 [==============================] - 113s - loss: 0.4502 - acc: 0.7981
Accuracy: 82.82%</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7d4582162065998-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4582162065998-2">2</div><div class="crayon-num" data-line="crayon-5c0caac7d4582162065998-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4582162065998-4">4</div><div class="crayon-num" data-line="crayon-5c0caac7d4582162065998-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4582162065998-6">6</div><div class="crayon-num" data-line="crayon-5c0caac7d4582162065998-7">7</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7d4582162065998-1">Epoch 1/3</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4582162065998-2">16750/16750 [==============================] - 112s - loss: 0.6623 - acc: 0.5935</div><div class="crayon-line" id="crayon-5c0caac7d4582162065998-3">Epoch 2/3</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4582162065998-4">16750/16750 [==============================] - 113s - loss: 0.5159 - acc: 0.7484</div><div class="crayon-line" id="crayon-5c0caac7d4582162065998-5">Epoch 3/3</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4582162065998-6">16750/16750 [==============================] - 113s - loss: 0.4502 - acc: 0.7981</div><div class="crayon-line" id="crayon-5c0caac7d4582162065998-7">Accuracy: 82.82%</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can see that the LSTM specific dropout has a more pronounced effect on the convergence of the network than the layer-wise dropout. As above, the number of epochs was kept constant and could be increased to see if the skill of the model can be further lifted.</p>
<p>Dropout is a powerful technique for combating overfitting in your LSTM models and it is a good idea to try both methods, but you may bet better results with the gate-specific dropout provided in Keras.</p>
<h2>LSTM and Convolutional Neural Network For Sequence Classification</h2>
<p>Convolutional neural networks excel at learning the spatial structure in input data.</p>
<p>The IMDB review data does have a one-dimensional spatial structure in the sequence of words in reviews and the CNN may be able to pick out invariant features for good and bad sentiment. This learned spatial features may then be learned as sequences by an LSTM layer.</p>
<p>We can easily add a one-dimensional CNN and max pooling layers after the Embedding layer which then feed the consolidated features to the LSTM. We can use a smallish set of 32 features with a small filter length of 3. The pooling layer can use the standard length of 2 to halve the feature map size.</p>
<p>For example, we would create the model as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7d4584506121790" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
model = Sequential()
model.add(Embedding(top_words, embedding_vecor_length, input_length=max_review_length))
model.add(Conv1D(filters=32, kernel_size=3, padding='same', activation='relu'))
model.add(MaxPooling1D(pool_size=2))
model.add(LSTM(100))
model.add(Dense(1, activation='sigmoid'))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7d4584506121790-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4584506121790-2">2</div><div class="crayon-num" data-line="crayon-5c0caac7d4584506121790-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4584506121790-4">4</div><div class="crayon-num" data-line="crayon-5c0caac7d4584506121790-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d4584506121790-6">6</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7d4584506121790-1"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4584506121790-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">top_words</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">embedding_vecor_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4584506121790-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv1D</span><span class="crayon-sy">(</span><span class="crayon-v">filters</span><span class="crayon-o">=</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4584506121790-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling1D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d4584506121790-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d4584506121790-6"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>The full code listing with a CNN and LSTM layers is listed below for completeness.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7d458a944613193" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# LSTM and CNN for sequence classification in the IMDB dataset
import numpy
from keras.datasets import imdb
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
from keras.layers.convolutional import Conv1D
from keras.layers.convolutional import MaxPooling1D
from keras.layers.embeddings import Embedding
from keras.preprocessing import sequence
# fix random seed for reproducibility
numpy.random.seed(7)
# load the dataset but only keep the top n words, zero the rest
top_words = 5000
(X_train, y_train), (X_test, y_test) = imdb.load_data(num_words=top_words)
# truncate and pad input sequences
max_review_length = 500
X_train = sequence.pad_sequences(X_train, maxlen=max_review_length)
X_test = sequence.pad_sequences(X_test, maxlen=max_review_length)
# create the model
embedding_vecor_length = 32
model = Sequential()
model.add(Embedding(top_words, embedding_vecor_length, input_length=max_review_length))
model.add(Conv1D(filters=32, kernel_size=3, padding='same', activation='relu'))
model.add(MaxPooling1D(pool_size=2))
model.add(LSTM(100))
model.add(Dense(1, activation='sigmoid'))
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
print(model.summary())
model.fit(X_train, y_train, epochs=3, batch_size=64)
# Final evaluation of the model
scores = model.evaluate(X_test, y_test, verbose=0)
print("Accuracy: %.2f%%" % (scores[1]*100))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7d458a944613193-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d458a944613193-2">2</div><div class="crayon-num" data-line="crayon-5c0caac7d458a944613193-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d458a944613193-4">4</div><div class="crayon-num" data-line="crayon-5c0caac7d458a944613193-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d458a944613193-6">6</div><div class="crayon-num" data-line="crayon-5c0caac7d458a944613193-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d458a944613193-8">8</div><div class="crayon-num" data-line="crayon-5c0caac7d458a944613193-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d458a944613193-10">10</div><div class="crayon-num" data-line="crayon-5c0caac7d458a944613193-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d458a944613193-12">12</div><div class="crayon-num" data-line="crayon-5c0caac7d458a944613193-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d458a944613193-14">14</div><div class="crayon-num" data-line="crayon-5c0caac7d458a944613193-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d458a944613193-16">16</div><div class="crayon-num" data-line="crayon-5c0caac7d458a944613193-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d458a944613193-18">18</div><div class="crayon-num" data-line="crayon-5c0caac7d458a944613193-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d458a944613193-20">20</div><div class="crayon-num" data-line="crayon-5c0caac7d458a944613193-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d458a944613193-22">22</div><div class="crayon-num" data-line="crayon-5c0caac7d458a944613193-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d458a944613193-24">24</div><div class="crayon-num" data-line="crayon-5c0caac7d458a944613193-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d458a944613193-26">26</div><div class="crayon-num" data-line="crayon-5c0caac7d458a944613193-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d458a944613193-28">28</div><div class="crayon-num" data-line="crayon-5c0caac7d458a944613193-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d458a944613193-30">30</div><div class="crayon-num" data-line="crayon-5c0caac7d458a944613193-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d458a944613193-32">32</div><div class="crayon-num" data-line="crayon-5c0caac7d458a944613193-33">33</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7d458a944613193-1"><span class="crayon-p"># LSTM and CNN for sequence classification in the IMDB dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d458a944613193-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5c0caac7d458a944613193-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">datasets </span><span class="crayon-e">import </span><span class="crayon-e">imdb</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d458a944613193-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5c0caac7d458a944613193-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d458a944613193-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">LSTM</span></div><div class="crayon-line" id="crayon-5c0caac7d458a944613193-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">convolutional </span><span class="crayon-e">import </span><span class="crayon-e">Conv1D</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d458a944613193-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">convolutional </span><span class="crayon-e">import </span><span class="crayon-e">MaxPooling1D</span></div><div class="crayon-line" id="crayon-5c0caac7d458a944613193-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">embeddings </span><span class="crayon-e">import </span><span class="crayon-e">Embedding</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d458a944613193-10"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-v">sequence</span></div><div class="crayon-line" id="crayon-5c0caac7d458a944613193-11"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d458a944613193-12"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d458a944613193-13"><span class="crayon-p"># load the dataset but only keep the top n words, zero the rest</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d458a944613193-14"><span class="crayon-v">top_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span></div><div class="crayon-line" id="crayon-5c0caac7d458a944613193-15"><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">imdb</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-v">num_words</span><span class="crayon-o">=</span><span class="crayon-v">top_words</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d458a944613193-16"><span class="crayon-p"># truncate and pad input sequences</span></div><div class="crayon-line" id="crayon-5c0caac7d458a944613193-17"><span class="crayon-v">max_review_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">500</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d458a944613193-18"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">.</span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d458a944613193-19"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sequence</span><span class="crayon-sy">.</span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d458a944613193-20"><span class="crayon-p"># create the model</span></div><div class="crayon-line" id="crayon-5c0caac7d458a944613193-21"><span class="crayon-v">embedding_vecor_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">32</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d458a944613193-22"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d458a944613193-23"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">top_words</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">embedding_vecor_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d458a944613193-24"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv1D</span><span class="crayon-sy">(</span><span class="crayon-v">filters</span><span class="crayon-o">=</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d458a944613193-25"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling1D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d458a944613193-26"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d458a944613193-27"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d458a944613193-28"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d458a944613193-29"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d458a944613193-30"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">64</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d458a944613193-31"><span class="crayon-p"># Final evaluation of the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d458a944613193-32"><span class="crayon-v">scores</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7d458a944613193-33"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Accuracy: %.2f%%"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">scores</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0020 seconds] -->
<p>Running this example provides the following output.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7d458d869365117" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
Epoch 1/3
16750/16750 [==============================] - 58s - loss: 0.5186 - acc: 0.7263
Epoch 2/3
16750/16750 [==============================] - 58s - loss: 0.2946 - acc: 0.8825
Epoch 3/3
16750/16750 [==============================] - 58s - loss: 0.2291 - acc: 0.9126
Accuracy: 86.36%</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7d458d869365117-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d458d869365117-2">2</div><div class="crayon-num" data-line="crayon-5c0caac7d458d869365117-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d458d869365117-4">4</div><div class="crayon-num" data-line="crayon-5c0caac7d458d869365117-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7d458d869365117-6">6</div><div class="crayon-num" data-line="crayon-5c0caac7d458d869365117-7">7</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7d458d869365117-1">Epoch 1/3</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d458d869365117-2">16750/16750 [==============================] - 58s - loss: 0.5186 - acc: 0.7263</div><div class="crayon-line" id="crayon-5c0caac7d458d869365117-3">Epoch 2/3</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d458d869365117-4">16750/16750 [==============================] - 58s - loss: 0.2946 - acc: 0.8825</div><div class="crayon-line" id="crayon-5c0caac7d458d869365117-5">Epoch 3/3</div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7d458d869365117-6">16750/16750 [==============================] - 58s - loss: 0.2291 - acc: 0.9126</div><div class="crayon-line" id="crayon-5c0caac7d458d869365117-7">Accuracy: 86.36%</div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can see that we achieve similar results to the first example although with less weights and faster training time.</p>
<p>I would expect that even better results could be achieved if this example was further extended to use dropout.</p>
<h2>Resources</h2>
<p>Below are some resources if you are interested in diving deeper into sequence prediction or this specific example.</p>
<ul>
<li><a href="http://deeplearning.net/tutorial/lstm.html">Theano tutorial for LSTMs applied to the IMDB dataset</a></li>
<li>Keras code example for using an <a href="https://github.com/fchollet/keras/blob/master/examples/imdb_lstm.py">LSTM and CNN</a> with <a href="https://github.com/fchollet/keras/blob/master/examples/imdb_cnn_lstm.py">LSTM on the IMDB dataset</a>.</li>
<li><a class="easyazon-link" href="http://www.amazon.com/dp/3642247962?tag=inspiredalgor-20">Supervised Sequence Labelling with Recurrent Neural Networks</a>, 2012 book by Alex Graves (<a href="https://www.cs.toronto.edu/~graves/preprint.pdf">and PDF preprint</a>).</li>
</ul>
<h2>Summary</h2>
<p>In this post you discovered how to develop LSTM network models for sequence classification predictive modeling problems.</p>
<p>Specifically, you learned:</p>
<ul>
<li>How to develop a simple single layer LSTM model for the IMDB movie review sentiment classification problem.</li>
<li>How to extend your LSTM model with layer-wise and LSTM-specific dropout to reduce overfitting.</li>
<li>How to combine the spatial structure learning properties of a Convolutional Neural Network with the sequence learning of an LSTM.</li>
</ul>
<p>Do you have any questions about sequence classification with LSTMs or about this post? Ask your questions in the comments and I will do my best to answer.</p>
<div class="awac-wrapper"><div class="awac widget text-42"> <div class="textwidget"><p></p><center><br/>
<div class="woo-sc-hr"></div>
<h2>Develop Deep Learning models for Text Data Today!</h2>
<p><a href="/deep-learning-for-nlp/"><img align="left" alt="Deep Learning for Natural Language Processing" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/11/DLFNLP-Cover-220.png" style="border: 0;"/></a></p>
<h4>Develop Your Own Text models in Minutes</h4>
<p>…with just a few lines of python code</p>
<p>Discover how in my new Ebook:<br/>
<a href="/deep-learning-for-nlp/">Deep Learning for Natural Language Processing</a></p>
<p>It provides <strong>self-study tutorials</strong> on topics like:<br/>
<em>Bag-of-Words, Word Embedding, Language Models, Caption Generation, Text Translation</em> and much more…</p>
<h4>Finally Bring Deep Learning to your Natural Language Processing Projects</h4>
<p>Skip the Academics. Just Results.</p>
<p><a href="/deep-learning-for-nlp/">Click to learn more</a>.<br/>
</p><div class="woo-sc-hr"></div><br/>
</center>
</div>
</div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-2938 post simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=Sequence+Classification+with+LSTM+Recurrent+Neural+Networks+in+Python+with+Keras&amp;url=https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" rel="nofollow">
<span class="icon"><svg viewbox="0 0 72 72" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h72v72H0z" fill="none"></path><path class="icon" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z" fill="#fff"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
<button class="ssb_fbshare-icon" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;" target="_blank">
<span class="icon"><svg class="_1pbq" color="#ffffff" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z" fill="#ffffff" fill-rule="evenodd"></path></svg></span>
<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"> <svg enable-background="new -301.4 387.5 15 14.1" height="14.1px" id="Layer_1" version="1.1" viewbox="-301.4 387.5 15 14.1" width="15px" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"> <g id="XMLID_398_"> <path d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z" fill="#FFFFFF" id="XMLID_399_"></path> <path d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z" fill="#FFFFFF" id="XMLID_400_"></path> <path d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z" fill="#FFFFFF" id="XMLID_401_"></path> </g> </svg> </span>
<span class="simplesocialtxt">Share</span> </button>
<button class="ssb_gplus-icon" data-href="https://plus.google.com/share?url=https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
<span class="icon"><svg class="ozWidgetRioButtonSvg_ ozWidgetRioButtonPlusOne_" height="18px" preserveaspectratio="xMidYMid meet" version="1.1" viewbox="-10 -6 60 36" width="30px" xmlns="http://www.w3.org/2000/svg"><path d="M30 7h-3v4h-4v3h4v4h3v-4h4v-3h-4V7z"></path><path d="M11 9.9v4h5.4C16 16.3 14 18 11 18c-3.3 0-5.9-2.8-5.9-6S7.7 6 11 6c1.5 0 2.8.5 3.8 1.5l2.9-2.9C15.9 3 13.7 2 11 2 5.5 2 1 6.5 1 12s4.5 10 10 10c5.8 0 9.6-4.1 9.6-9.8 0-.7-.1-1.5-.2-2.2H11z"></path></svg></span>
<span class="simplesocialtxt">Google Plus </span></button>
</div>
</section><!-- /.entry -->
<div class="fix"></div>
<aside id="post-author">
<div class="profile-image"><img alt="" class="avatar avatar-80 photo" height="80" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" width="80"/></div>
<div class="profile-content">
<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span> </a>
</div><!--#profile-link-->
</div>
<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
<div class="post-entries">
<div class="nav-prev fl"><a href="https://machinelearningmastery.com/use-classification-machine-learning-algorithms-weka/" rel="prev"><i class="fa fa-angle-left"></i> How To Use Classification Machine Learning Algorithms in Weka</a></div>
<div class="nav-next fr"><a href="https://machinelearningmastery.com/use-ensemble-machine-learning-algorithms-weka/" rel="next">How to Use Ensemble Machine Learning Algorithms in Weka <i class="fa fa-angle-right"></i></a></div>
<div class="fix"></div>
</div>
<div id="comments"> <h3 id="comments-title">471 Responses to <em>Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</em></h3>
<ol class="commentlist">
<li class="comment even thread-even depth-1" id="comment-358300">
<div class="comment-container" id="li-comment-358300">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c451248e578fd6a3ffffed35589cd285?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c451248e578fd6a3ffffed35589cd285?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Atlant</span>
<span class="date">July 29, 2016 at 7:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-358300" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It’s geat!</p>
<div class="reply">
<a aria-label="Reply to Atlant" class="comment-reply-link" href="#comment-358300" onclick='return addComment.moveForm( "comment-358300", "358300", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-360044">
<div class="comment-container" id="li-comment-360044">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 15, 2016 at 12:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-360044" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Atlant.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-360044" onclick='return addComment.moveForm( "comment-360044", "360044", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-358383">
<div class="comment-container" id="li-comment-358383">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/19a9144d7660313bc88120f5a2453479?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/19a9144d7660313bc88120f5a2453479?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sahil</span>
<span class="date">July 30, 2016 at 9:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-358383" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,</p>
<p>Congrats brother, for continuous great and easy to adapt/understanding lessons. I am just curious to know unsupervised and reinforced neural nets, any tutorials you have?</p>
<p>Regards,<br/>
Sahil</p>
<div class="reply">
<a aria-label="Reply to Sahil" class="comment-reply-link" href="#comment-358383" onclick='return addComment.moveForm( "comment-358383", "358383", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-358415">
<div class="comment-container" id="li-comment-358415">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 31, 2016 at 7:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-358415" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Sahil.</p>
<p>Sorry, no tutorials on unsupervised learning or reinforcement learning with neural nets just yet. Soon though.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-358415" onclick='return addComment.moveForm( "comment-358415", "358415", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-358457">
<div class="comment-container" id="li-comment-358457">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ffa50b2ca24453993f3a1aaefc6db603?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ffa50b2ca24453993f3a1aaefc6db603?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Søren Pallesen</span>
<span class="date">August 1, 2016 at 1:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-358457" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, great stuff you are publishing here thanks.</p>
<p>Would this network architecture work for predicting profitability of a stock based time series data of the stock price.</p>
<p>For example with data samples of daily stock prices and trading volumes with 5 minute intervals from 9.30am to 1pm paired with YES or NO to the stockprice increasing by more than 0.5% the rest of the trading day?</p>
<p>Each trading day is one sample and th3 entire data set woule for example the last 1000 trading days.</p>
<p>If this network architecture is not suitable what other would you suggest testing our?</p>
<p>Again thanks for this super resdource.</p>
<div class="reply">
<a aria-label="Reply to Søren Pallesen" class="comment-reply-link" href="#comment-358457" onclick='return addComment.moveForm( "comment-358457", "358457", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-358467">
<div class="comment-container" id="li-comment-358467">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 1, 2016 at 6:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-358467" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Søren.</p>
<p>Sure, it would be worth trying, but I am not an expert on the stock market.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-358467" onclick='return addComment.moveForm( "comment-358467", "358467", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-359730">
<div class="comment-container" id="li-comment-359730">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7e9703ec9f4e1abae82171831b6c18fc?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7e9703ec9f4e1abae82171831b6c18fc?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Naufal</span>
<span class="date">August 12, 2016 at 2:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-359730" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>So, the end result of this tutorial is a model. Could you give me an example how to use this model to predict a new review, especially using new vocabularies that don’t present in training data? Many thanks..</p>
<div class="reply">
<a aria-label="Reply to Naufal" class="comment-reply-link" href="#comment-359730" onclick='return addComment.moveForm( "comment-359730", "359730", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-360046">
<div class="comment-container" id="li-comment-360046">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 15, 2016 at 12:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-360046" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t have an example Naufal, but the new example would have to encode words using the same integers and embed the integers into the same word mapping.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-360046" onclick='return addComment.moveForm( "comment-360046", "360046", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-392501">
<div class="comment-container" id="li-comment-392501">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0f3e51a33d58b7e2af3eb177ec697d10?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0f3e51a33d58b7e2af3eb177ec697d10?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Faraaz Mohammed</span>
<span class="date">March 13, 2017 at 7:21 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-392501" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason for excellent article.<br/>
to predict i did below things, please correct i am did wrong. you said to embed..i didnt get that. how to do that.</p>
<p>text = numpy.array([‘this is excellent sentence’])<br/>
#print(text.shape)<br/>
tk = keras.preprocessing.text.Tokenizer( nb_words=2000, lower=True,split=” “)<br/>
tk.fit_on_texts(text)<br/>
prediction = model.predict(numpy.array(tk.texts_to_sequences(text)))<br/>
print(prediction)</p>
<div class="reply">
<a aria-label="Reply to Faraaz Mohammed" class="comment-reply-link" href="#comment-392501" onclick='return addComment.moveForm( "comment-392501", "392501", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-4" id="comment-392515">
<div class="comment-container" id="li-comment-392515">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0f3e51a33d58b7e2af3eb177ec697d10?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0f3e51a33d58b7e2af3eb177ec697d10?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Faraaz Mohammed</span>
<span class="date">March 13, 2017 at 9:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-392515" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason for excellent article.<br/>
to predict i did below things, please correct i am did wrong. you said to embed..i didnt get that. how to do that.</p>
<p>text = numpy.array([‘this is excellent sentence’])<br/>
#print(text.shape)<br/>
tk = keras.preprocessing.text.Tokenizer( nb_words=2000, lower=True,split=” “)<br/>
tk.fit_on_texts(text)<br/>
prediction = model.predict(sequence.pad_sequences(tk.texts_to_sequences(text),maxlen=max_review_length))<br/>
print(prediction)</p>
<div class="reply">
<a aria-label="Reply to Faraaz Mohammed" class="comment-reply-link" href="#comment-392515" onclick='return addComment.moveForm( "comment-392515", "392515", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-431695">
<div class="comment-container" id="li-comment-431695">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a482d1905113864f05be99e0bfc40493?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a482d1905113864f05be99e0bfc40493?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Gopichand</span>
<span class="date">March 9, 2018 at 9:51 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-431695" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can use below code to predict sentiment of new reviews..</p>
<p>However, it will simply skip words out of its vocabulary..<br/>
Also, you can try increasing “top_words” value before training so that u can cover more number of words.</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7da9bc968750573" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
vec=imdb.get_word_index()
def get_senti(sent):
    x=[]
    try:
        for i in sent.split():
            if vec[i]  0.5 else "Negative"])

get_senti("i like that movie")</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7da9bc968750573-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7da9bc968750573-2">2</div><div class="crayon-num" data-line="crayon-5c0caac7da9bc968750573-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7da9bc968750573-4">4</div><div class="crayon-num" data-line="crayon-5c0caac7da9bc968750573-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7da9bc968750573-6">6</div><div class="crayon-num" data-line="crayon-5c0caac7da9bc968750573-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7da9bc968750573-8">8</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7da9bc968750573-1"><span class="crayon-v">vec</span><span class="crayon-o">=</span><span class="crayon-v">imdb</span><span class="crayon-sy">.</span><span class="crayon-e">get_word_index</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7da9bc968750573-2"><span class="crayon-e">def </span><span class="crayon-e">get_senti</span><span class="crayon-sy">(</span><span class="crayon-v">sent</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caac7da9bc968750573-3"><span class="crayon-h">    </span><span class="crayon-v">x</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7da9bc968750573-4"><span class="crayon-h">    </span><span class="crayon-st">try</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5c0caac7da9bc968750573-5"><span class="crayon-h">        </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">sent</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7da9bc968750573-6"><span class="crayon-h">            </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">vec</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h">  </span><span class="crayon-cn">0.5</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-s">"Negative"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7da9bc968750573-7"> </div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7da9bc968750573-8"><span class="crayon-e">get_senti</span><span class="crayon-sy">(</span><span class="crayon-s">"i like that movie"</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-431740">
<div class="comment-container" id="li-comment-431740">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 10, 2018 at 6:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-431740" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for sharing!</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-392577">
<div class="comment-container" id="li-comment-392577">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 14, 2017 at 8:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-392577" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Embed refers to the word embedding layer:<br/>
<a href="https://keras.io/layers/embeddings/" rel="nofollow">https://keras.io/layers/embeddings/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-392577" onclick='return addComment.moveForm( "comment-392577", "392577", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-432570">
<div class="comment-container" id="li-comment-432570">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c44683f6cdb1a687103d94e449db4f19?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c44683f6cdb1a687103d94e449db4f19?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://datasciencebasicsblog.wordpress.com" rel="external nofollow">Aviral Goyal</a></span>
<span class="date">March 19, 2018 at 8:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-432570" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>def conv_to_proper_format(sentence):<br/>
    &gt;&gt;sentence=text.text_to_word_sequence(sentence,filters=’!”#$%&amp;()*+,-./:;?@[\\]^_`{|}~\t\n’,lower=True,split=” “)<br/>
    &gt;&gt;sentence=numpy.array([word_index[word] if word in word_index else 0 for word in sentence])#Encoding into sequence of integers<br/>
    &gt;&gt;sentence[sentence&gt;5000]=2<br/>
    &gt;&gt;L=500-len(sentence)<br/>
    &gt;&gt;sentence=numpy.pad(sentence, (L,0), ‘constant’)<br/>
    &gt;&gt;sentence=sentence.reshape(1,-1)<br/>
    &gt;&gt;return sentence<br/>
Use this function on ur review to convert into proper format and then model.predict(review1) will give u answer.</p>
<div class="reply">
<a aria-label="Reply to Aviral Goyal" class="comment-reply-link" href="#comment-432570" onclick='return addComment.moveForm( "comment-432570", "432570", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-361342">
<div class="comment-container" id="li-comment-361342">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cf774b0d316833ed45c5cc1463ee7634?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cf774b0d316833ed45c5cc1463ee7634?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Joey</span>
<span class="date">August 24, 2016 at 6:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-361342" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason! Great tutorials!</p>
<p>When I attempt this tutorial, I get the error message from imdb.load_data :</p>
<p>    TypeError: load_data() got an unexpected keyword argument ‘test_split’ </p>
<p>I tried copying and pasting the entire source code but this line still had the same error.</p>
<p>Can you think of any underlying reason that this is not executing for me?</p>
<div class="reply">
<a aria-label="Reply to Joey" class="comment-reply-link" href="#comment-361342" onclick='return addComment.moveForm( "comment-361342", "361342", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-361359">
<div class="comment-container" id="li-comment-361359">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 24, 2016 at 8:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-361359" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry to hear that Joey. It looks like a change with Keras v1.0.7. </p>
<p>I get the same error if I run with version 1.0.7. I can see the API doco still refers to the test_split argument here: <a href="https://keras.io/datasets/#imdb-movie-reviews-sentiment-classification" rel="nofollow">https://keras.io/datasets/#imdb-movie-reviews-sentiment-classification</a></p>
<p>I can see that the argument was removed from the function here:<br/>
<a href="https://github.com/fchollet/keras/blob/master/keras/datasets/imdb.py" rel="nofollow">https://github.com/fchollet/keras/blob/master/keras/datasets/imdb.py</a></p>
<p>Option 1) You can remove the argument from the function to use the default test 50/50 split.</p>
<p>Option 2) You can downgrade Keras to version 1.0.6:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7dd565876772112" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
sudo pip install --upgrade --no-deps keras==1.0.6</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7dd565876772112-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7dd565876772112-1"><span class="crayon-e">sudo </span><span class="crayon-e">pip </span><span class="crayon-v">install</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-v">upgrade</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-v">no</span><span class="crayon-o">-</span><span class="crayon-e">deps </span><span class="crayon-v">keras</span><span class="crayon-o">==</span><span class="crayon-cn">1.0.6</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p>Remember you can check your Keras version on the command line with:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7dd56a273906515" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
python -c "import keras; print keras.__version__"</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7dd56a273906515-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7dd56a273906515-1"><span class="crayon-v">python</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-s">"import keras; print keras.__version__"</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<p>I will look at updating the example to be compatible with the latest Keras.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-361359" onclick='return addComment.moveForm( "comment-361359", "361359", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-361493">
<div class="comment-container" id="li-comment-361493">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cf774b0d316833ed45c5cc1463ee7634?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cf774b0d316833ed45c5cc1463ee7634?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Joey</span>
<span class="date">August 25, 2016 at 4:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-361493" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I got it working! Thanks so much for all of the help Jason!</p>
<div class="reply">
<a aria-label="Reply to Joey" class="comment-reply-link" href="#comment-361493" onclick='return addComment.moveForm( "comment-361493", "361493", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-361502">
<div class="comment-container" id="li-comment-361502">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 25, 2016 at 5:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-361502" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear it Joey.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-361502" onclick='return addComment.moveForm( "comment-361502", "361502", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-366529">
<div class="comment-container" id="li-comment-366529">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 7, 2016 at 2:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-366529" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have updated the examples in the post to match Keras 1.1.0 and TensorFlow 0.10.0.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-362405">
<div class="comment-container" id="li-comment-362405">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2aa424179ff953a75e6b5a77c10c2488?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2aa424179ff953a75e6b5a77c10c2488?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chong Wang</span>
<span class="date">August 29, 2016 at 11:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-362405" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason.</p>
<p>A quick question:<br/>
Based on my understanding, padding zero in front is like labeling ‘START’. Otherwise it is like labeling ‘END’. How should I decide ‘pre’ padding or ‘post’ padding? Does it matter?</p>
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Chong Wang" class="comment-reply-link" href="#comment-362405" onclick='return addComment.moveForm( "comment-362405", "362405", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-362628">
<div class="comment-container" id="li-comment-362628">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 30, 2016 at 8:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-362628" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t think I understand the question, sorry Chong. </p>
<p>Consider trying both padding approaches on your problem and see what works best.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-362628" onclick='return addComment.moveForm( "comment-362628", "362628", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-366383">
<div class="comment-container" id="li-comment-366383">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2aa424179ff953a75e6b5a77c10c2488?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2aa424179ff953a75e6b5a77c10c2488?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chong Wang</span>
<span class="date">October 6, 2016 at 7:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-366383" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason.</p>
<p>Thanks for your reply.</p>
<p>I have another quick question in section “LSTM For Sequence Classification With Dropout”.</p>
<p>model.add(Embedding(top_words, embedding_vector_length, input_length=max_review_length, dropout=0.2))<br/>
model.add(Dropout(0.2))<br/>
…</p>
<p>Here I see two dropout layers. The second one is easy to understand: For each time step, It just randomly deactivates 20% numbers in the output embedding vector. </p>
<p>The first one confuses me: Does it do dropout on the input? For each time step, the input of the embedding layers should be only one index of the top words. In other words, the input is one single number. How can we dropout it?  (Or do you mean drop the input indices of 20% time steps?)</p>
<div class="reply">
<a aria-label="Reply to Chong Wang" class="comment-reply-link" href="#comment-366383" onclick='return addComment.moveForm( "comment-366383", "366383", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-366402">
<div class="comment-container" id="li-comment-366402">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 6, 2016 at 9:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-366402" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question, I believe it drops out weights from the input nodes from the embedded layer to the hidden layer.</p>
<p>You can learn more about dropout here:<br/>
<a href="http://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/" rel="nofollow">http://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-366402" onclick='return addComment.moveForm( "comment-366402", "366402", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-381667">
<div class="comment-container" id="li-comment-381667">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6a06e15b5e3c4f3a91169045d6c4ad94?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6a06e15b5e3c4f3a91169045d6c4ad94?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kuow</span>
<span class="date">January 12, 2017 at 4:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-381667" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can the dropout applied in the Embedding layer be thought of as randomly removing a word in a sentence and forcing the classification not to rely on any word?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-381803">
<div class="comment-container" id="li-comment-381803">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 13, 2017 at 9:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-381803" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t see why not – off the cuff.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-362750">
<div class="comment-container" id="li-comment-362750">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/535b6620ff85df40d458b89023cba26b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/535b6620ff85df40d458b89023cba26b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Harish</span>
<span class="date">August 30, 2016 at 8:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-362750" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason</p>
<p>Thanks for providing such easy explanations for these complex topics.</p>
<p>In this tutorial, Embedding layer is used as the input layer as the data is a sequence of words.</p>
<p>I am working on a problem where I have a sequence of images  as an example and a particular label is assigned to each example. The number of images in the sequence will vary from example to example. I have the following questions:<br/>
1)  Can I use a LSTM layer as an input layer?</p>
<p>2) If the input layer is a LSTM layer, is there still a need to specify the max_len (which is constraint mentioning the maximum number of images an example can have)</p>
<p>Thanks in advance.</p>
<div class="reply">
<a aria-label="Reply to Harish" class="comment-reply-link" href="#comment-362750" onclick='return addComment.moveForm( "comment-362750", "362750", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-362849">
<div class="comment-container" id="li-comment-362849">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 31, 2016 at 9:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-362849" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Interesting problem Harish.</p>
<p>I would caution you to consider a suite of different ways of representing this problem, then try a few to see what works.</p>
<p>My gut suggests using CNNs on the front end for the image data and then an LSTM in the middle and some dense layers on the backend for transforming the representation into a prediction. </p>
<p>I hope that helps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-362849" onclick='return addComment.moveForm( "comment-362849", "362849", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-362894">
<div class="comment-container" id="li-comment-362894">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/535b6620ff85df40d458b89023cba26b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/535b6620ff85df40d458b89023cba26b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Harish</span>
<span class="date">August 31, 2016 at 3:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-362894" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks you very much Jason.</p>
<p>Can you please let me know how to deal with sequences of different length without padding in this problem. If padding is required, how to choose the max. length for padding the sequence of images.</p>
<div class="reply">
<a aria-label="Reply to Harish" class="comment-reply-link" href="#comment-362894" onclick='return addComment.moveForm( "comment-362894", "362894", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-363018">
<div class="comment-container" id="li-comment-363018">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 1, 2016 at 7:56 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-363018" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Padding is required for sequences of variable length.</p>
<p>Choose a max length based on all the data you have available to evaluate.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-363018" onclick='return addComment.moveForm( "comment-363018", "363018", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-363112">
<div class="comment-container" id="li-comment-363112">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/535b6620ff85df40d458b89023cba26b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/535b6620ff85df40d458b89023cba26b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Harish</span>
<span class="date">September 1, 2016 at 5:12 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-363112" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for your time and suggestion Jason.</p>
<p>Can you please explain what masking the input layer means and how can it be used to handle padding in keras.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="comment-363682">
<div class="comment-container" id="li-comment-363682">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cde15d1d86cabfbff6bf06fc5ec2ebd4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cde15d1d86cabfbff6bf06fc5ec2ebd4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sreekar Reddy</span>
<span class="date">September 5, 2016 at 10:37 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-363682" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Harish,<br/>
I am working on a similar problem and would like to know if you continued on this problem? What worked and what did not?</p>
<p>Thanks in advance</p>
<div class="reply">
<a aria-label="Reply to Sreekar Reddy" class="comment-reply-link" href="#comment-363682" onclick='return addComment.moveForm( "comment-363682", "363682", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-363002">
<div class="comment-container" id="li-comment-363002">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b1cb6c154fabe47331018f0c1dfe98e2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b1cb6c154fabe47331018f0c1dfe98e2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Gciniwe</span>
<span class="date">September 1, 2016 at 6:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-363002" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for this tutorial. It’s so helpful! I would like to adapt this to my own problem. I’m working on a problem where I have a sequence of acoustic samples. The sequences vary in length, and I know the identity of the individual/entity producing the signal in each sequence. Since these sequences have a temporal element to them, (each sequence is a series in time and sequences belonging to the same individual are also linked temporally), I thought LSTM would be the way to go.<br/>
According to my understanding, the Embedding layer in this tutorial works to add an extra dimension to the dataset since the LSTM layer takes in 3D input data.</p>
<p>My question is is it advisable to use LSTM layer as a first layer in my problem, seeing that Embedding wouldn’t work with my non-integer acoustic samples? I know that in order to use LSTM as my first layer, I have to somehow reshape my data in a meaningful way so that it meets the requirements of the inputs of LSTM layer. I’ve already padded my sequences so my dataset is currently a 2D tensor. Padding with zeros however was not ideal because some of the original acoustic sample values are zero, representing a zero-pressure level. So I’ve manually padded using a different number. </p>
<p>I’m planning to use a stack of LSTM layers and a Dense layer at the end of my Sequential model. </p>
<p>P.s. I’m new to Keras. I’d appreciate any advice you can give.</p>
<p>Thank you</p>
<div class="reply">
<a aria-label="Reply to Gciniwe" class="comment-reply-link" href="#comment-363002" onclick='return addComment.moveForm( "comment-363002", "363002", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-363021">
<div class="comment-container" id="li-comment-363021">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 1, 2016 at 8:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-363021" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad it was useful Gciniwe.</p>
<p>Great question and hard to answer. I would caution you to review some literature for audio-based applications of LSTMs and CNNs and see what representations were used. The examples I’ve seen have been (sadly) trivial.</p>
<p>Try LSTM as the first layer, but also experiment with CNN (1D) then LSTM for additional opportunities to pull out structure. Perhaps also try Dense then LSTM. I would use one or more Dense on the output layers.</p>
<p>Good luck, I’m very interested to hear what you come up with.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-363021" onclick='return addComment.moveForm( "comment-363021", "363021", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-363096">
<div class="comment-container" id="li-comment-363096">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/535b6620ff85df40d458b89023cba26b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/535b6620ff85df40d458b89023cba26b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Harish</span>
<span class="date">September 1, 2016 at 4:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-363096" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Gciniwe</p>
<p>Its interesting to see that I am also working on a similar problem. I work on speech and image processing. I have a small doubt. Please may I know how did you choose the padding values. Because in images also, we will have zeros and unable to understand how to do padding. </p>
<p>Thanks in advance</p>
<div class="reply">
<a aria-label="Reply to Harish" class="comment-reply-link" href="#comment-363096" onclick='return addComment.moveForm( "comment-363096", "363096", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-364992">
<div class="comment-container" id="li-comment-364992">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f1c6da7afe795d6f26e9eaeba6f5a0dd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f1c6da7afe795d6f26e9eaeba6f5a0dd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">nick</span>
<span class="date">September 20, 2016 at 2:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-364992" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>When i run the above code , i am getting the following error<br/>
:MemoryError: alloc failed<br/>
Apply node that caused the error: Alloc(TensorConstant{(1L, 1L, 1L) of 0.0}, TensorConstant{24}, Elemwise{Composite{((i0 * i1) // i2)}}[(0, 0)].0, TensorConstant{280})<br/>
Toposort index: 145<br/>
Inputs types: [TensorType(float32, (True, True, True)), TensorType(int64, scalar), TensorType(int64, scalar), TensorType(int64, scalar)]<br/>
Inputs shapes: [(1L, 1L, 1L), (), (), ()]<br/>
Inputs strides: [(4L, 4L, 4L), (), (), ()]<br/>
Inputs values: [array([[[ 0.]]], dtype=float32), array(24L, dtype=int64), array(-450L, dtype=int64), array(280L, dtype=int64)]<br/>
Outputs clients: [[IncSubtensor{Inc;:int64:}(Alloc.0, Subtensor{::int64}.0, Constant{24}), IncSubtensor{InplaceInc;int64::}(Alloc.0, IncSubtensor{Inc;:int64:}.0, Constant{0}), forall_inplace,cpu,grad_of_scan_fn}(TensorConstant{24}, Elemwise{tanh}.0, Subtensor{int64:int64:int64}.0, Alloc.0, Elemwise{Composite{(i0 – sqr(i1))}}.0, Subtensor{int64:int64:int64}.0, Subtensor{int64:int64:int64}.0,<br/>
any idea why? i am using theano 0.8.2 and keras 1.0.8</p>
<div class="reply">
<a aria-label="Reply to nick" class="comment-reply-link" href="#comment-364992" onclick='return addComment.moveForm( "comment-364992", "364992", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-365033">
<div class="comment-container" id="li-comment-365033">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 20, 2016 at 8:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-365033" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m sorry to hear that Nick, I’ve not seen this error.</p>
<p>Perhaps try the Theano backend and see if that makes any difference?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-365033" onclick='return addComment.moveForm( "comment-365033", "365033", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-370129">
<div class="comment-container" id="li-comment-370129">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d4a4b346ea44c6cb3c40bc8b6a466759?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d4a4b346ea44c6cb3c40bc8b6a466759?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shristi Baral</span>
<span class="date">November 9, 2016 at 9:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370129" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I got the same problem and I have no clue how to solve it..</p>
<div class="reply">
<a aria-label="Reply to Shristi Baral" class="comment-reply-link" href="#comment-370129" onclick='return addComment.moveForm( "comment-370129", "370129", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-366110">
<div class="comment-container" id="li-comment-366110">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3f8d88b95adea11e00797b7d6ff6459e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3f8d88b95adea11e00797b7d6ff6459e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Deepak</span>
<span class="date">October 3, 2016 at 2:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-366110" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I have one question. Can I use RNN LSTM for Time Series Sales Analysis. I have only one input every day sales of last one year. so total data points is around 278 and I want to predict for next 6 months. Will this much data points is sufficient for using RNN techniques.. and also can you please explain what is difference between LSTM and GRU and where to USE LSTM or GRU</p>
<div class="reply">
<a aria-label="Reply to Deepak" class="comment-reply-link" href="#comment-366110" onclick='return addComment.moveForm( "comment-366110", "366110", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-366120">
<div class="comment-container" id="li-comment-366120">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 3, 2016 at 5:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-366120" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Deepak, My advice would be to try LSTM on your problem and see. </p>
<p>You may be better served using simpler statistical methods to forecast 60 months of sales data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-366120" onclick='return addComment.moveForm( "comment-366120", "366120", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-367068">
<div class="comment-container" id="li-comment-367068">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/01b09081999159e0bbfc52b207af8dcd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/01b09081999159e0bbfc52b207af8dcd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Corne Prinsloo</span>
<span class="date">October 13, 2016 at 5:59 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-367068" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, this is great. Thanks!  </p>
<p>I would also love to see some unsupervised learning to know how it works and what the applications are.</p>
<div class="reply">
<a aria-label="Reply to Corne Prinsloo" class="comment-reply-link" href="#comment-367068" onclick='return addComment.moveForm( "comment-367068", "367068", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-367113">
<div class="comment-container" id="li-comment-367113">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 14, 2016 at 8:59 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-367113" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Corne,</p>
<p>I tend not to write tutorials on unsupervised techniques (other than feature selection) as I do not find methods like clustering useful in practice on predictive modeling problems.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-367113" onclick='return addComment.moveForm( "comment-367113", "367113", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-367097">
<div class="comment-container" id="li-comment-367097">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/621772e26db2c5756b425fc5a55c5670?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/621772e26db2c5756b425fc5a55c5670?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://none" rel="external nofollow">Jeff Wu</a></span>
<span class="date">October 14, 2016 at 5:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-367097" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for writing this tutorial.  It’s very helpful. Why do LSTMs not require normalization of their features’ values?</p>
<div class="reply">
<a aria-label="Reply to Jeff Wu" class="comment-reply-link" href="#comment-367097" onclick='return addComment.moveForm( "comment-367097", "367097", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-367118">
<div class="comment-container" id="li-comment-367118">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 14, 2016 at 9:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-367118" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jeff, great question.</p>
<p>Often you can get better performance with neural networks when the data is scaled to the range of the transfer function. In this case we use a sigmoid within the LSTMs so we find we get better performance by normalizing input data to the range 0-1.</p>
<p>I hope that helps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-367118" onclick='return addComment.moveForm( "comment-367118", "367118", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-405070">
<div class="comment-container" id="li-comment-405070">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1fb261732f0bcb1a475cf3ad4dcf5251?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1fb261732f0bcb1a475cf3ad4dcf5251?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Yuri</span>
<span class="date">July 8, 2017 at 5:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-405070" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thanks for a great tutorial!</p>
<p>I am trying to normalize the data, basically dividing each element in X by the largest value (in this case 5000), since X is in range [0, 5000]. And I get much worse performance. Any idea why? Thanks!</p>
<div class="reply">
<a aria-label="Reply to Yuri" class="comment-reply-link" href="#comment-405070" onclick='return addComment.moveForm( "comment-405070", "405070", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-405256">
<div class="comment-container" id="li-comment-405256">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 9, 2017 at 10:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-405256" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No. Try other scaling methods.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-405256" onclick='return addComment.moveForm( "comment-405256", "405256", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-367513">
<div class="comment-container" id="li-comment-367513">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/982fe9edec4382849efdc3cca9679a7a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/982fe9edec4382849efdc3cca9679a7a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Lau MingFei</span>
<span class="date">October 19, 2016 at 10:21 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-367513" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, Jason! Your tutorial is very helpful. But I still have a question about using dropouts in the LSTM cells. What is the difference of the actual effects of droupout_W and dropout_U? Should I just set them the same value in most cases? Could you recommend any paper related to this topic? Thank you very much!</p>
<div class="reply">
<a aria-label="Reply to Lau MingFei" class="comment-reply-link" href="#comment-367513" onclick='return addComment.moveForm( "comment-367513", "367513", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-367556">
<div class="comment-container" id="li-comment-367556">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 20, 2016 at 8:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-367556" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would refer you to the API Lau:<br/>
<a href="https://keras.io/layers/recurrent/#lstm" rel="nofollow">https://keras.io/layers/recurrent/#lstm</a></p>
<blockquote><p>
dropout_W: float between 0 and 1. Fraction of the input units to drop for input gates.<br/>
dropout_U: float between 0 and 1. Fraction of the input units to drop for recurrent connections.
</p></blockquote>
<p>Generally, I recommend testing different values and see what works. In practice setting them to the same values might be a good starting point.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-367556" onclick='return addComment.moveForm( "comment-367556", "367556", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-368078">
<div class="comment-container" id="li-comment-368078">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/cf630658f07dfb0e6981a9b4ea1bc240?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/cf630658f07dfb0e6981a9b4ea1bc240?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jeff</span>
<span class="date">October 24, 2016 at 10:16 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-368078" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello,<br/>
thanks for the nice article. I have a question about the data encoding: “The words have been replaced by integers that indicate the ordered frequency of each word in the dataset”.</p>
<p>What exactly does ordered frequency mean? For instance, is the most frequent word encoded as 0 or 4999 in the end?</p>
<div class="reply">
<a aria-label="Reply to Jeff" class="comment-reply-link" href="#comment-368078" onclick='return addComment.moveForm( "comment-368078", "368078", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-368136">
<div class="comment-container" id="li-comment-368136">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 25, 2016 at 8:23 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-368136" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question Jeff.</p>
<p>I believe the most frequent word is 1.</p>
<p>I believe 0 was left for use as padding or when we want to trip low frequency words.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-368136" onclick='return addComment.moveForm( "comment-368136", "368136", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-368087">
<div class="comment-container" id="li-comment-368087">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5fcf52929ef5f44e868b3a8339673b8e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5fcf52929ef5f44e868b3a8339673b8e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mazen</span>
<span class="date">October 25, 2016 at 12:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-368087" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for your very useful posts.<br/>
I have a question.<br/>
In the last example (CNN&amp;LSTM), It’s clear that we gained a faster training time, but how can we know that CNN is suitable here for this problem as a prior layer to LSTM. What does the spatial structure here mean? So, If I understand how to decide whether a dataset X has a spatial structure, then will this be a suitable clue to suggest a prior CNN to LSTM layer in a sequence-based problem?</p>
<p>Thanks,<br/>
Mazen</p>
<div class="reply">
<a aria-label="Reply to Mazen" class="comment-reply-link" href="#comment-368087" onclick='return addComment.moveForm( "comment-368087", "368087", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-368141">
<div class="comment-container" id="li-comment-368141">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 25, 2016 at 8:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-368141" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Mazen, </p>
<p>The spatial structure is the order of words. To the CNN, they are just a sequence of numbers, but we know that that sequence has structure – the words (numbers used to represent words) and their order matter.</p>
<p>Model selection is hard. Often you want to pick the model that has the mix of the best performance and lowest complexity (easy to understand, maintain, retrain, use in production).</p>
<p>Yes, if a problem has some spatial structure (image, text, etc.) try a method that preserves that structure, like a CNN.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-368141" onclick='return addComment.moveForm( "comment-368141", "368141", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-369832">
<div class="comment-container" id="li-comment-369832">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6a7dc21d6e59d7d548db2fee85029c41?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6a7dc21d6e59d7d548db2fee85029c41?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Eduardo</span>
<span class="date">November 8, 2016 at 3:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-369832" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, great post!</p>
<p>I have been trying to use your experiment to classify text that come from several blogs for gender classification. However, I am getting a low accuracy close to 50%. Do you have any suggestions in terms of how I could pre-process my data to fit in the model? Each blog text has approximately 6000 words and i am doing some research know to see what I can do in terms of pre-processing to apply to your model.</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Eduardo" class="comment-reply-link" href="#comment-369832" onclick='return addComment.moveForm( "comment-369832", "369832", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-369871">
<div class="comment-container" id="li-comment-369871">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 8, 2016 at 9:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-369871" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Wow, cool project Eduardo.</p>
<p>I wonder if you can cut the problem back to just the first sentence or first paragraph of the post.</p>
<p>I wonder if you can use a good word embedding.</p>
<p>I also wonder if you can use a CNN instead od LSTM to make the classification – or at least compare CNN alone to CNN + LSTM and double done on what works best.</p>
<p>Generally, here is a ton of advice for improving performance on deep learning problems:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-369871" onclick='return addComment.moveForm( "comment-369871", "369871", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-370297">
<div class="comment-container" id="li-comment-370297">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c291bd2c978cb2bff3973a224958c9c2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c291bd2c978cb2bff3973a224958c9c2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Emma</span>
<span class="date">November 11, 2016 at 4:24 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370297" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thank you for your time for this very helpful tutorial.<br/>
I was wondering if you would have considered to randomly shuffle the data prior to each epoch of training?</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Emma" class="comment-reply-link" href="#comment-370297" onclick='return addComment.moveForm( "comment-370297", "370297", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-370338">
<div class="comment-container" id="li-comment-370338">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 12, 2016 at 7:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370338" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Emma,</p>
<p>Great question. The data is automatically shuffled prior to each epoch by the fit() function. </p>
<p>See more about the shuffle argument to the fit() function here:<br/>
<a href="https://keras.io/models/sequential/" rel="nofollow">https://keras.io/models/sequential/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-370338" onclick='return addComment.moveForm( "comment-370338", "370338", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-370303">
<div class="comment-container" id="li-comment-370303">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/be8394a7b0453e1355d17d9b34aacc2d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/be8394a7b0453e1355d17d9b34aacc2d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shashank</span>
<span class="date">November 11, 2016 at 4:51 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370303" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Can you please show how to convert all the words to integers so that they are ready to be feed into keras models?</p>
<p>Here in IMDB they are directly working on integers but I have a problem where I have got many rows of text and I have to classify them(multiclass problem).</p>
<p>Also in LSTM+CNN i am getting an error:</p>
<p>ERROR (theano.gof.opt): Optimization failure due to: local_abstractconv_check<br/>
ERROR (theano.gof.opt): node: AbstractConv2d{border_mode=’half’, subsample=(1, 1), filter_flip=True, imshp=(None, None, None, None), kshp=(None, None, None, None)}(DimShuffle{0,2,1,x}.0, DimShuffle{3,2,0,1}.0)<br/>
ERROR (theano.gof.opt): TRACEBACK:<br/>
ERROR (theano.gof.opt): Traceback (most recent call last):<br/>
  File “C:\Anaconda2\lib\site-packages\theano\gof\opt.py”, line 1772, in process_node<br/>
    replacements = lopt.transform(node)<br/>
  File “C:\Anaconda2\lib\site-packages\theano\tensor\nnet\opt.py”, line 402, in local_abstractconv_check<br/>
    node.op.__class__.__name__)<br/>
AssertionError: AbstractConv2d Theano optimization failed: there is no implementation available supporting the requested options. Did you exclude both “conv_dnn” and “conv_gemm” from the optimizer? If on GPU, is cuDNN available and does the GPU support it? If on CPU, do you have a BLAS library installed Theano can link against?</p>
<p>I am running keras in windows with Theano backend and CPU only.</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Shashank" class="comment-reply-link" href="#comment-370303" onclick='return addComment.moveForm( "comment-370303", "370303", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-370481">
<div class="comment-container" id="li-comment-370481">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2629bec5c4a20fe1d23123ef5215e05b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2629bec5c4a20fe1d23123ef5215e05b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Thang Le</span>
<span class="date">November 14, 2016 at 4:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370481" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Can you tell me how the IMDB database contains its data please? Text or vector?</p>
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Thang Le" class="comment-reply-link" href="#comment-370481" onclick='return addComment.moveForm( "comment-370481", "370481", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-370505">
<div class="comment-container" id="li-comment-370505">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 14, 2016 at 7:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370505" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Thang Le, the IMDB dataset was originally text.</p>
<p>The words were converted to integers (one int for each word), and we model the data as fixed-length vectors of integers. Because we work with fixed-length vectors, we must truncate and/or pad the data to this fixed length.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-370505" onclick='return addComment.moveForm( "comment-370505", "370505", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-370525">
<div class="comment-container" id="li-comment-370525">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2629bec5c4a20fe1d23123ef5215e05b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2629bec5c4a20fe1d23123ef5215e05b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Le Thang</span>
<span class="date">November 14, 2016 at 2:03 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370525" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Jason!</p>
<p>So when we call (X_train, y_train), (X_test, y_test) = imdb.load_data(), X_train[i] will be vector. And if it is vector then how can I convert my text data to vector to use in this?</p>
<div class="reply">
<a aria-label="Reply to Le Thang" class="comment-reply-link" href="#comment-370525" onclick='return addComment.moveForm( "comment-370525", "370525", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-370602">
<div class="comment-container" id="li-comment-370602">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 15, 2016 at 7:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370602" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Le Thang, great question.</p>
<p>You can convert each character to an integer. Then each input will be a vector of integers. You can then use an Embedding layer to convert your vectors of integers to real-valued vectors in a projected space.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-370602" onclick='return addComment.moveForm( "comment-370602", "370602", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-370545">
<div class="comment-container" id="li-comment-370545">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fbc4dcae60fbfd39a835ef191a803fc3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fbc4dcae60fbfd39a835ef191a803fc3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Quan Xiu</span>
<span class="date">November 14, 2016 at 6:36 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370545" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>As I understand, X_train is a variable sequence of words in movie review for input then what does Y_train stand for?</p>
<p>Thank you!</p>
<div class="reply">
<a aria-label="Reply to Quan Xiu" class="comment-reply-link" href="#comment-370545" onclick='return addComment.moveForm( "comment-370545", "370545", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-370607">
<div class="comment-container" id="li-comment-370607">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 15, 2016 at 7:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370607" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Quan Xiu, Y is the output variables and Y_train are the output variables for the training dataset.</p>
<p>For this dataset, the output values are movie sentiment values (positive or negative sentiment).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-370607" onclick='return addComment.moveForm( "comment-370607", "370607", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-370640">
<div class="comment-container" id="li-comment-370640">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fbc4dcae60fbfd39a835ef191a803fc3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fbc4dcae60fbfd39a835ef191a803fc3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Quan Xiu</span>
<span class="date">November 15, 2016 at 2:38 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370640" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Jason,</p>
<p>So when we take X_test as input, the output will be compared to y_test to compute the accuracy, right?</p>
<div class="reply">
<a aria-label="Reply to Quan Xiu" class="comment-reply-link" href="#comment-370640" onclick='return addComment.moveForm( "comment-370640", "370640", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-370781">
<div class="comment-container" id="li-comment-370781">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 16, 2016 at 9:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-370781" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes Quan Xiu, the predictions made by the model are compared to y_test.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-370781" onclick='return addComment.moveForm( "comment-370781", "370781", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-371552">
<div class="comment-container" id="li-comment-371552">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e7961f91f22a935b85c0d81ab33b52f6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e7961f91f22a935b85c0d81ab33b52f6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Herbert Kruitbosch</span>
<span class="date">November 22, 2016 at 7:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-371552" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The performance of this LSTM-network is lower than TFIDF + Logistic Regression:</p>
<p><a href="https://gist.github.com/prinsherbert/92313f15fc814d6eed1e36ab4df1f92d" rel="nofollow">https://gist.github.com/prinsherbert/92313f15fc814d6eed1e36ab4df1f92d</a></p>
<p>Are you sure the hidden state’s aren’t just counting words in a very expensive manor?</p>
<div class="reply">
<a aria-label="Reply to Herbert Kruitbosch" class="comment-reply-link" href="#comment-371552" onclick='return addComment.moveForm( "comment-371552", "371552", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-371686">
<div class="comment-container" id="li-comment-371686">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 23, 2016 at 8:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-371686" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It’s true that this example is not tuned for optimal performance Herbert.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-371686" onclick='return addComment.moveForm( "comment-371686", "371686", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-371815">
<div class="comment-container" id="li-comment-371815">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e7961f91f22a935b85c0d81ab33b52f6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e7961f91f22a935b85c0d81ab33b52f6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Herbert Kruitbosch</span>
<span class="date">November 23, 2016 at 8:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-371815" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This leaves a rather important question, does it actually learn more complicated features than word-counts? And do LSTM’s do so in general? Obviously there is literature out there on this topic, but I think your post is somewhat misleading w.r.t. power of LSTM’s. It would be great to see an example where an LSTM outperforms a TFIDF, and give an idea about the type and size of the data that you need. (Thank you for the quick reply though 🙂 )</p>
<p>LSTM’s are only neat if they actually remember contextual things, not if they just fit simple models and take a long time to do so.</p>
<div class="reply">
<a aria-label="Reply to Herbert Kruitbosch" class="comment-reply-link" href="#comment-371815" onclick='return addComment.moveForm( "comment-371815", "371815", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-371935">
<div class="comment-container" id="li-comment-371935">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 24, 2016 at 10:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-371935" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I agree Herbert. </p>
<p>LSTMs are hard to use. Initially, I wanted to share how to get up and running with the technique. I aim to come back to this example and test new configurations to get more/most from the method.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-371935" onclick='return addComment.moveForm( "comment-371935", "371935", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-374239">
<div class="comment-container" id="li-comment-374239">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e7961f91f22a935b85c0d81ab33b52f6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e7961f91f22a935b85c0d81ab33b52f6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Herbert Kruitbosch</span>
<span class="date">December 8, 2016 at 12:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-374239" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That would be great! It would also be nice to get an idea about the size of data needed for good performance (and of course, there are thousands of other open questions :))</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-371623">
<div class="comment-container" id="li-comment-371623">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2f79a55b3f7328b801912e7a9321ac14?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2f79a55b3f7328b801912e7a9321ac14?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Huy Huynh</span>
<span class="date">November 23, 2016 at 4:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-371623" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Many thank your post, Jason. It’s helpful</p>
<p>I have some short questions. First, I feel nervous when chose hyperparameter for the model such as  length vectors (32), a number of Embedding unit (500), a number of LSTM unit(100), most frequent words(5000). It depends on dataset, doesn’t it? How can we choose parameter?</p>
<p>Second, I have dataset about news daily for predicting the movement of price stock market. But, each news seems more  words than each comment imdb dataset. Average each news about 2000 words, can you recommend me how I can choose approximate hyperparameter.</p>
<p>Thank you, (P/s sorry about my English if have any mistake)</p>
<div class="reply">
<a aria-label="Reply to Huy Huynh" class="comment-reply-link" href="#comment-371623" onclick='return addComment.moveForm( "comment-371623", "371623", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-371697">
<div class="comment-container" id="li-comment-371697">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 23, 2016 at 9:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-371697" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Huy,</p>
<p>We have to choose something. It is good practice to grid search over each of these parameters and select for best performance and model robustness.</p>
<p>Perhaps you can work with the top n most common words only.<br/>
Perhaps you can use a projection or embedding of the article.<br/>
Perhaps you can use some classical NLP methods on the text first.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-371697" onclick='return addComment.moveForm( "comment-371697", "371697", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-371875">
<div class="comment-container" id="li-comment-371875">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2f79a55b3f7328b801912e7a9321ac14?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2f79a55b3f7328b801912e7a9321ac14?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Huy Huynh</span>
<span class="date">November 24, 2016 at 3:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-371875" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for your quick response,</p>
<p> I am a newbie in Deep Learning, It seems really difficult to choose relevant parameters.</p>
<div class="reply">
<a aria-label="Reply to Huy Huynh" class="comment-reply-link" href="#comment-371875" onclick='return addComment.moveForm( "comment-371875", "371875", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-371625">
<div class="comment-container" id="li-comment-371625">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2f79a55b3f7328b801912e7a9321ac14?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2f79a55b3f7328b801912e7a9321ac14?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Huy Huynh</span>
<span class="date">November 23, 2016 at 4:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-371625" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>According to my understanding, When training, the number of epoch often more than 100 to evaluate supervised machine learning result. But, In your example or Keras sample, It’s only between 3-15 epochs. Can you explain about that?<br/>
Thanks,</p>
<div class="reply">
<a aria-label="Reply to Huy Huynh" class="comment-reply-link" href="#comment-371625" onclick='return addComment.moveForm( "comment-371625", "371625", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-371698">
<div class="comment-container" id="li-comment-371698">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 23, 2016 at 9:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-371698" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Epochs can vary from algorithm and problem. There are no rules Huy, let results guide everything.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-371698" onclick='return addComment.moveForm( "comment-371698", "371698", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-371877">
<div class="comment-container" id="li-comment-371877">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2f79a55b3f7328b801912e7a9321ac14?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2f79a55b3f7328b801912e7a9321ac14?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Huy Huynh</span>
<span class="date">November 24, 2016 at 3:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-371877" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>So, How we can choose the relevant number of epochs?</p>
<div class="reply">
<a aria-label="Reply to Huy Huynh" class="comment-reply-link" href="#comment-371877" onclick='return addComment.moveForm( "comment-371877", "371877", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-371937">
<div class="comment-container" id="li-comment-371937">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 24, 2016 at 10:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-371937" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Trial and error on your problem, and carefully watch the learning rate on your training and validation datasets.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-371937" onclick='return addComment.moveForm( "comment-371937", "371937", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-372597">
<div class="comment-container" id="li-comment-372597">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/ffa50b2ca24453993f3a1aaefc6db603?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/ffa50b2ca24453993f3a1aaefc6db603?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Søren Pallesen</span>
<span class="date">November 27, 2016 at 8:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-372597" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Im looking for benchmarks of LSTM networks on Keras with known/public datasets. </p>
<p>Could you share what hardware configuration the examples in this post was run on (GPU/CPU/RAM etc)?</p>
<p>Thx</p>
<div class="reply">
<a aria-label="Reply to Søren Pallesen" class="comment-reply-link" href="#comment-372597" onclick='return addComment.moveForm( "comment-372597", "372597", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-372665">
<div class="comment-container" id="li-comment-372665">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 28, 2016 at 8:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-372665" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I used AWS with the g2.2xlarge configuration.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-372665" onclick='return addComment.moveForm( "comment-372665", "372665", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-373026">
<div class="comment-container" id="li-comment-373026">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/857eeb2bd390e04728d61d045c05a73b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/857eeb2bd390e04728d61d045c05a73b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mike</span>
<span class="date">November 30, 2016 at 11:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-373026" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Is it possible in Keras to obtain the classifier output as each word propagates through the network?</p>
<div class="reply">
<a aria-label="Reply to Mike" class="comment-reply-link" href="#comment-373026" onclick='return addComment.moveForm( "comment-373026", "373026", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-373151">
<div class="comment-container" id="li-comment-373151">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 1, 2016 at 7:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-373151" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Mike, you can make one prediction at a time. </p>
<p>Not sure about seeing how the weights propagate through – I have not done this myself with Keras.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-373151" onclick='return addComment.moveForm( "comment-373151", "373151", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-374418">
<div class="comment-container" id="li-comment-374418">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f69ab52145bfc499bd9d60d69b6b1ffe?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f69ab52145bfc499bd9d60d69b6b1ffe?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">lim</span>
<span class="date">December 9, 2016 at 4:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-374418" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>What are some of the changes you have to make in your binary classification model to work for the multi-label classification?</p>
<div class="reply">
<a aria-label="Reply to lim" class="comment-reply-link" href="#comment-374418" onclick='return addComment.moveForm( "comment-374418", "374418", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-2" id="comment-374470">
<div class="comment-container" id="li-comment-374470">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f69ab52145bfc499bd9d60d69b6b1ffe?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f69ab52145bfc499bd9d60d69b6b1ffe?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">lim</span>
<span class="date">December 9, 2016 at 11:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-374470" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>also instead of a given input data such as imdb in number digit format, what steps do you take to process your raw text format dataset to make it compatible like imdb?</p>
<div class="reply">
<a aria-label="Reply to lim" class="comment-reply-link" href="#comment-374470" onclick='return addComment.moveForm( "comment-374470", "374470", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-374455">
<div class="comment-container" id="li-comment-374455">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3af77b049a18bd38b8c485e5115b81e0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3af77b049a18bd38b8c485e5115b81e0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Hossein</span>
<span class="date">December 9, 2016 at 9:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-374455" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great Job Jason. </p>
<p>I liked it very much…<br/>
I would really appreciate it if you tell me how we can do Sequence Clustering with LSTM Recurrent Neural Networks (Unsupervised learning task).</p>
<div class="reply">
<a aria-label="Reply to Hossein" class="comment-reply-link" href="#comment-374455" onclick='return addComment.moveForm( "comment-374455", "374455", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-374609">
<div class="comment-container" id="li-comment-374609">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 10, 2016 at 8:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-374609" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I have not used LSTMs for clustering. I don’t have good advice for you.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-374609" onclick='return addComment.moveForm( "comment-374609", "374609", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-374691">
<div class="comment-container" id="li-comment-374691">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/54e962919a62bf94429f737adfda72fe?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/54e962919a62bf94429f737adfda72fe?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ryan</span>
<span class="date">December 10, 2016 at 8:56 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-374691" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Your book is really helpful for me. I have a question about time sequence classifier. Let’s say, I have 8 classes of time sequence data, each class has 200 training data and 50 validation data, how can I estimate the classification accuracy based on all the 50 validation data per class (sth. like log-maximum likelihood) using scikit-learn package or sth. else? It would be very appreciated that you could give me some advice. Thanks a lot in advance.</p>
<p>Best regards,<br/>
Ryan</p>
<div class="reply">
<a aria-label="Reply to ryan" class="comment-reply-link" href="#comment-374691" onclick='return addComment.moveForm( "comment-374691", "374691", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-374749">
<div class="comment-container" id="li-comment-374749">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 11, 2016 at 5:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-374749" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Ryan, this list of classification measures supported by sklearn might help as a start:<br/>
<a href="http://scikit-learn.org/stable/modules/classes.html#classification-metrics" rel="nofollow">http://scikit-learn.org/stable/modules/classes.html#classification-metrics</a></p>
<p>Logloss is a very useful measure for evaluating the performance of learning algorithms on multi-class classification problems:<br/>
<a href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.log_loss.html#sklearn.metrics.log_loss" rel="nofollow">http://scikit-learn.org/stable/modules/generated/sklearn.metrics.log_loss.html#sklearn.metrics.log_loss</a></p>
<p>I hope that helps as a start.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-374749" onclick='return addComment.moveForm( "comment-374749", "374749", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-374764">
<div class="comment-container" id="li-comment-374764">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/54e962919a62bf94429f737adfda72fe?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/54e962919a62bf94429f737adfda72fe?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ryan</span>
<span class="date">December 11, 2016 at 8:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-374764" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, Thank you so much. I will try this logloss.</p>
<div class="reply">
<a aria-label="Reply to ryan" class="comment-reply-link" href="#comment-374764" onclick='return addComment.moveForm( "comment-374764", "374764", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-374872">
<div class="comment-container" id="li-comment-374872">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 12, 2016 at 6:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-374872" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Let me know how you go.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-374872" onclick='return addComment.moveForm( "comment-374872", "374872", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-374934">
<div class="comment-container" id="li-comment-374934">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/be8394a7b0453e1355d17d9b34aacc2d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/be8394a7b0453e1355d17d9b34aacc2d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shashank</span>
<span class="date">December 12, 2016 at 5:09 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-374934" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Which approach is better Bags of words or word embedding for converting text to integer for correct and better classification?</p>
<p>I am a little confused in this.</p>
<p>Thanks in advance</p>
<div class="reply">
<a aria-label="Reply to Shashank" class="comment-reply-link" href="#comment-374934" onclick='return addComment.moveForm( "comment-374934", "374934", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-375010">
<div class="comment-container" id="li-comment-375010">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 13, 2016 at 8:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-375010" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Shashank, embeddings are popular at the moment. I would suggest both and see what representation works best for you.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-375010" onclick='return addComment.moveForm( "comment-375010", "375010", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-375874">
<div class="comment-container" id="li-comment-375874">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2ea625db98ee53bac98c62037983099f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2ea625db98ee53bac98c62037983099f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mango</span>
<span class="date">December 19, 2016 at 1:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-375874" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thank you for your tutorials, I find them very clear and useful, but I have a little question when I try to use it to another problem setting..</p>
<p>as is pointed out in your post, words are embedding as vectors, and we feed a sequence of vectors to the model, to do classification.. as you mentioned cnn to deal with the implicit spatial relation inside the word vector(hope I got it right), so I have two questions related to this operation:</p>
<p>1. Is the Embedding layer specific to word, that said, keras has its own vocabulary and similarity definition to treat our feeded word sequence?</p>
<p>2. What if I have a sequence of 2d matrix, something like an image, how should I transform them to meet the required input shape to the CNN layer or directly the LSTM layer? For example, combined with your tutorial for the time series data, I got an trainX of size (5000, 5, 14, 13), where 5000 is the length of my samples, and 5 is the look_back (or time_step), while I have a matrix instead of a single value here, but I think I should use my specific Embedding technique here so I could pass a matrix instead of a vector before an CNN or a LSTM layer….</p>
<p>Sorry if my question is not described well, but my intention is really to get the temporal-spatial connection lie in my data… so I want to feed into my model with a sequence of matrix as one sample.. and the output will be one matrix..</p>
<p>thank you for your patience!!</p>
<div class="reply">
<a aria-label="Reply to Mango" class="comment-reply-link" href="#comment-375874" onclick='return addComment.moveForm( "comment-375874", "375874", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-376096">
<div class="comment-container" id="li-comment-376096">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2d078dab70121c6249559fa73fc88c85?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2d078dab70121c6249559fa73fc88c85?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Banbhrani</span>
<span class="date">December 19, 2016 at 7:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-376096" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>33202176/33213513 [============================&gt;.] – ETA: 0s   19800064/33213513 [================&gt;………….] – ETA: 207s – ETA: 194s____________________________________________________________________________________________________<br/>
Layer (type)                     Output Shape          Param #     Connected to<br/>
====================================================================================================<br/>
embedding_1 (Embedding)          (None, 500, 32)       160000      embedding_input_1[0][0]<br/>
____________________________________________________________________________________________________<br/>
lstm_1 (LSTM)                    (None, 100)           53200       embedding_1[0][0]<br/>
____________________________________________________________________________________________________<br/>
dense_1 (Dense)                  (None, 1)             101         lstm_1[0][0]<br/>
====================================================================================================<br/>
Total params: 213301<br/>
____________________________________________________________________________________________________<br/>
None<br/>
Epoch 1/3</p>
<p>Kernel died, restarting</p>
<div class="reply">
<a aria-label="Reply to Banbhrani" class="comment-reply-link" href="#comment-376096" onclick='return addComment.moveForm( "comment-376096", "376096", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-381320">
<div class="comment-container" id="li-comment-381320">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/db981cdf6f8c6ad8efc2a82af54341c1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/db981cdf6f8c6ad8efc2a82af54341c1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Eka</span>
<span class="date">January 10, 2017 at 12:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-381320" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thanks for the nice article. Because IMDb data is very large I tried to replace it with spam dataset. What kind of changes should I make in the original code to run it. I have asked this question in stack-overflow but sofar no answer. <a href="http://stackoverflow.com/questions/41322243/how-to-use-keras-rnn-for-text-classification-in-a-dataset" rel="nofollow">http://stackoverflow.com/questions/41322243/how-to-use-keras-rnn-for-text-classification-in-a-dataset</a> ?</p>
<p>Any help?</p>
<div class="reply">
<a aria-label="Reply to Eka" class="comment-reply-link" href="#comment-381320" onclick='return addComment.moveForm( "comment-381320", "381320", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-381420">
<div class="comment-container" id="li-comment-381420">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 11, 2017 at 9:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-381420" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great idea!</p>
<p>I would suggest you encode each word as a unique integer. Then you can start using it as an input for the Embedding layer.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-381420" onclick='return addComment.moveForm( "comment-381420", "381420", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-381403">
<div class="comment-container" id="li-comment-381403">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/38650c7f5b3ec63b38698947dae56b57?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/38650c7f5b3ec63b38698947dae56b57?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">AKSHAY</span>
<span class="date">January 11, 2017 at 6:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-381403" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for the post. It is really helpful. Do I need to configure for the tensorflow to make use of GPU when I run this code or does it automatically select GPU if its available?</p>
<div class="reply">
<a aria-label="Reply to AKSHAY" class="comment-reply-link" href="#comment-381403" onclick='return addComment.moveForm( "comment-381403", "381403", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-381427">
<div class="comment-container" id="li-comment-381427">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 11, 2017 at 9:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-381427" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>These examples are small and run fast on the CPU, no GPU is required.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-381427" onclick='return addComment.moveForm( "comment-381427", "381427", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-381445">
<div class="comment-container" id="li-comment-381445">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/38650c7f5b3ec63b38698947dae56b57?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/38650c7f5b3ec63b38698947dae56b57?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">AKSHAY</span>
<span class="date">January 11, 2017 at 12:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-381445" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I tried it on CPU and it worked fine. I plan to replicate the process and expand your method for a different use case. Its high dimensional compared to this. Do you have a tutorial on making use of GPU as well? Can I implement the same code in gpu or is the format all different?</p>
<div class="reply">
<a aria-label="Reply to AKSHAY" class="comment-reply-link" href="#comment-381445" onclick='return addComment.moveForm( "comment-381445", "381445", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-381592">
<div class="comment-container" id="li-comment-381592">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 12, 2017 at 9:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-381592" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Same code, use of the backend is controlled by the Theano or TensorFlow backend that you’re using.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-381592" onclick='return addComment.moveForm( "comment-381592", "381592", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-381552">
<div class="comment-container" id="li-comment-381552">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/851f009dd4de5daa0c94ec6cd970ac06?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/851f009dd4de5daa0c94ec6cd970ac06?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Stan</span>
<span class="date">January 12, 2017 at 4:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-381552" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason,</p>
<p>Thanks for the interesting tutorial! Do you have any thoughts on how the LSTM trained to classify sequences could then be turned around to generate new ones? I.e. now that it “knows” what a positive review sounds like, could it be used to generate new and novel positive reviews? (ignore possible nefarious uses for such a setup 🙂 )</p>
<p>There are several interesting examples of LSTMs being trained to learn sequences to generate new ones… however, they have no concept of classification, or understanding what a “good” vs “bad” sequence is, like yours does. So, I’m essentially interested in merging the two approaches — train an LSTM with a number of “good” and “bad” sequences, and then have it generate new “good” ones.</p>
<p>Any thoughts or pointers would be very welcome!</p>
<div class="reply">
<a aria-label="Reply to Stan" class="comment-reply-link" href="#comment-381552" onclick='return addComment.moveForm( "comment-381552", "381552", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-381600">
<div class="comment-container" id="li-comment-381600">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 12, 2017 at 9:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-381600" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have not explored this myself. I don’t have any offhand quips, it requires careful thought I think.</p>
<p>This post might help with the other side of the coin, the generation of text:<br/>
<a href="http://machinelearningmastery.com/text-generation-lstm-recurrent-neural-networks-python-keras/" rel="nofollow">http://machinelearningmastery.com/text-generation-lstm-recurrent-neural-networks-python-keras/</a></p>
<p>I would love to hear how you get on.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-381600" onclick='return addComment.moveForm( "comment-381600", "381600", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-381746">
<div class="comment-container" id="li-comment-381746">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/851f009dd4de5daa0c94ec6cd970ac06?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/851f009dd4de5daa0c94ec6cd970ac06?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Stan</span>
<span class="date">January 13, 2017 at 1:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-381746" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, if you do come up with any crazy ideas, please let me know :).</p>
<p>One pedestrian approach I’m thinking off is having the classifier used to simply “weed out” the undesired inputs, and then feed only desired ones into a new LSTM which can then be used to generate more sequences like those, using the approach like the one in your other post.</p>
<p>That doesn’t seem ideal, as it feels like I’m throwing away some of the knowledge about what makes an undesired sequence undesired… But, on the other hand, I have more freedom in selecting the classifier algorithm.</p>
<div class="reply">
<a aria-label="Reply to Stan" class="comment-reply-link" href="#comment-381746" onclick='return addComment.moveForm( "comment-381746", "381746", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-384456">
<div class="comment-container" id="li-comment-384456">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/df98197d62849c803bfe23ff61477e6a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/df98197d62849c803bfe23ff61477e6a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Albert</span>
<span class="date">January 27, 2017 at 9:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-384456" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for this tutorial.</p>
<p>Regarding the variable length problem, though other people have asked about it, I have a further question.</p>
<p>If I have a dataset with high deviation of length, say, some text has 10 words, some has 100000 words. Therefore, if I just choose 1000 as my maxlen, I lost a lot of information.</p>
<p>If I choose 100000 as the maxlen, I consume too much computational power.</p>
<p>Is there a another way of dealing with that? (Without padding or truncating)</p>
<p>Also, can you write a tutorial about how to use word2vec pretrained embedding with RNN?</p>
<p>Not word2vec itself, but how to use the result of word2vec.</p>
<p>The counting based word representation lost too much semantic information.</p>
<div class="reply">
<a aria-label="Reply to Albert" class="comment-reply-link" href="#comment-384456" onclick='return addComment.moveForm( "comment-384456", "384456", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-384509">
<div class="comment-container" id="li-comment-384509">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 27, 2017 at 12:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-384509" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great questions Albert.</p>
<p>I don’t have a good off-the-cuff answer for you re long sequences. It requires further research.</p>
<p>Keen to tackle the suggested tutorial using word2vc representations.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-384509" onclick='return addComment.moveForm( "comment-384509", "384509", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-384813">
<div class="comment-container" id="li-comment-384813">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9a7b9d511f1d9cc5b9437af5e8ad8d14?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9a7b9d511f1d9cc5b9437af5e8ad8d14?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Charles</span>
<span class="date">January 29, 2017 at 4:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-384813" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I only have biology background, but I can reproduced the results. Great.</p>
<div class="reply">
<a aria-label="Reply to Charles" class="comment-reply-link" href="#comment-384813" onclick='return addComment.moveForm( "comment-384813", "384813", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-385385">
<div class="comment-container" id="li-comment-385385">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 1, 2017 at 10:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-385385" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear it Charles.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-385385" onclick='return addComment.moveForm( "comment-385385", "385385", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-385346">
<div class="comment-container" id="li-comment-385346">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/78c2091c14057cdb27809c6da60b4280?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/78c2091c14057cdb27809c6da60b4280?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jax</span>
<span class="date">February 1, 2017 at 6:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-385346" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, i noted you mentioned updated examples for Tensorflow 0.10.0. I can only see Keras codes, am i missing something?</p>
<p>Thanks.</p>
<div class="reply">
<a aria-label="Reply to Jax" class="comment-reply-link" href="#comment-385346" onclick='return addComment.moveForm( "comment-385346", "385346", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-385427">
<div class="comment-container" id="li-comment-385427">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 1, 2017 at 10:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-385427" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jax,</p>
<p>Keras runs on top of Theano and TensorFlow. One or the other are required to use Keras.</p>
<p>I was leaving a note that the example was tested on an updated version of Keras using an updated version of the TensorFlow backend.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-385427" onclick='return addComment.moveForm( "comment-385427", "385427", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-387627">
<div class="comment-container" id="li-comment-387627">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7acc22a63aea1741a2cb2bfe0c01607c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7acc22a63aea1741a2cb2bfe0c01607c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kakaio</span>
<span class="date">February 13, 2017 at 8:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-387627" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am not sure I understand how recurrence and sequence work here.<br/>
I would expect you’d feed a sequence of one-hot vectors for each review, where each one-hot vector represents one word. This way, you would not need a maximum length for the review (nor padding), and I could see how you’d use recurrence one word at a time.<br/>
But I understand you’re feeding the whole review in one go, so it looks like e feedforward.<br/>
Can you explain that?</p>
<div class="reply">
<a aria-label="Reply to Kakaio" class="comment-reply-link" href="#comment-387627" onclick='return addComment.moveForm( "comment-387627", "387627", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-387642">
<div class="comment-container" id="li-comment-387642">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 13, 2017 at 9:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-387642" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Kakaio,</p>
<p>Yes, indeed we are feeding one review at a time. It is the input structured we’d use for a MLP.</p>
<p>Internally, consider the LSTM network as building up state on the sequence of words in the review and from that sequence learning the appropriate sentiment.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-387642" onclick='return addComment.moveForm( "comment-387642", "387642", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-387644">
<div class="comment-container" id="li-comment-387644">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7acc22a63aea1741a2cb2bfe0c01607c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7acc22a63aea1741a2cb2bfe0c01607c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kakaop</span>
<span class="date">February 13, 2017 at 9:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-387644" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>how is the LSTM building up state one the sequence of words leveraging recurrence? you’re feeding the LSTM all the sequence at the same time, there’re no time steps.</p>
<div class="reply">
<a aria-label="Reply to Kakaop" class="comment-reply-link" href="#comment-387644" onclick='return addComment.moveForm( "comment-387644", "387644", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-387645">
<div class="comment-container" id="li-comment-387645">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 13, 2017 at 9:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-387645" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Kakaop, quite right. The example does not leverage recurrence.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-387645" onclick='return addComment.moveForm( "comment-387645", "387645", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-390795">
<div class="comment-container" id="li-comment-390795">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a6632f4cb6c59d006bef98ef15208ec2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a6632f4cb6c59d006bef98ef15208ec2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sweta</span>
<span class="date">March 1, 2017 at 8:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-390795" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>From this tutorial how can I predict the test values and how to write to a file? Are these predicted values generate in the encoded format?</p>
<div class="reply">
<a aria-label="Reply to Sweta" class="comment-reply-link" href="#comment-390795" onclick='return addComment.moveForm( "comment-390795", "390795", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-390885">
<div class="comment-container" id="li-comment-390885">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c0aa3f8750834c630cdf6805f7c51f32?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c0aa3f8750834c630cdf6805f7c51f32?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bruce Ho</span>
<span class="date">March 2, 2017 at 9:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-390885" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Guys, this is a very clear and useful article, and thanks for the Keras code. But I can’t seem to find any sample code for running the trained model to make a prediction. It is not in imdb.py, that just does the evaluation. Does any one have some sample code for prediction to show?</p>
<div class="reply">
<a aria-label="Reply to Bruce Ho" class="comment-reply-link" href="#comment-390885" onclick='return addComment.moveForm( "comment-390885", "390885", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-391013">
<div class="comment-container" id="li-comment-391013">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 3, 2017 at 7:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-391013" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Bruce,</p>
<p>You can fit the model on all of the training data, than forecast for new inputs using:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7dc9de697722196" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
y = model.predict(X)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7dc9de697722196-1">1</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7dc9de697722196-1"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-391013" onclick='return addComment.moveForm( "comment-391013", "391013", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-391068">
<div class="comment-container" id="li-comment-391068">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c0aa3f8750834c630cdf6805f7c51f32?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c0aa3f8750834c630cdf6805f7c51f32?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bruce Ho</span>
<span class="date">March 3, 2017 at 4:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-391068" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That’s not the hard part. However, I may have figured out what I need to know. That is take the result returned by model.predict and take the last item in the array as the classifications. Any one disagrees?</p>
<div class="reply">
<a aria-label="Reply to Bruce Ho" class="comment-reply-link" href="#comment-391068" onclick='return addComment.moveForm( "comment-391068", "391068", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-393066">
<div class="comment-container" id="li-comment-393066">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/219d8df803b9377c7026529a7c6e54fa?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/219d8df803b9377c7026529a7c6e54fa?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">JUNETAE KIM</span>
<span class="date">March 17, 2017 at 10:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-393066" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, it’s the awesome tutorial.  </p>
<p>I have a question regarding your model. </p>
<p>I am new to RNN, so the question would be stupid. </p>
<p>Inputting word embedding layer is crucial in your setting – sequence classification rather than prediction of the next word??</p>
<div class="reply">
<a aria-label="Reply to JUNETAE KIM" class="comment-reply-link" href="#comment-393066" onclick='return addComment.moveForm( "comment-393066", "393066", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-393121">
<div class="comment-container" id="li-comment-393121">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 18, 2017 at 7:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-393121" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Generally, a word embedding (or similar projection) is a good representation for NLP problems.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-393121" onclick='return addComment.moveForm( "comment-393121", "393121", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-393940">
<div class="comment-container" id="li-comment-393940">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/123b6dfc2d9dd9ce31452a80a7cc7035?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/123b6dfc2d9dd9ce31452a80a7cc7035?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">DanielHa</span>
<span class="date">March 24, 2017 at 2:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-393940" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
great tutorial. Really helped me alot.</p>
<p>I’ve noticed that in the first part you called fit() on the model with “validation_data=(X_test, y_test)”. This isn’t in the final code summary. So I wondered if that’s just a mistake or if you forgot it later on.</p>
<p>But then again it seems wrong to me to use the test data set for validation. What are your thoughts on this?</p>
<div class="reply">
<a aria-label="Reply to DanielHa" class="comment-reply-link" href="#comment-393940" onclick='return addComment.moveForm( "comment-393940", "393940", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-393978">
<div class="comment-container" id="li-comment-393978">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 24, 2017 at 8:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-393978" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The model does not use the test data at this point, it is just evaluated on it. It helps to get an idea of how well the model is doing.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-393978" onclick='return addComment.moveForm( "comment-393978", "393978", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-394034">
<div class="comment-container" id="li-comment-394034">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/567f511351a57eb671beb3783aa0801e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/567f511351a57eb671beb3783aa0801e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Liam</span>
<span class="date">March 24, 2017 at 6:25 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394034" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What happen if the code uses LSTM with 100 units and sentence length is 200. Does that mean only the first 100 words in the sentence act as inputs, and the last 100 words will be ignored?</p>
<div class="reply">
<a aria-label="Reply to Liam" class="comment-reply-link" href="#comment-394034" onclick='return addComment.moveForm( "comment-394034", "394034", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-394099">
<div class="comment-container" id="li-comment-394099">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 25, 2017 at 7:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394099" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, the number of units in the hidden layer and the length of sequences are different configuration parameters. </p>
<p>You can have 1 unit with 2K sequence length if you like, the model just won’t learn it.</p>
<p>I hope that helps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-394099" onclick='return addComment.moveForm( "comment-394099", "394099", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-394477">
<div class="comment-container" id="li-comment-394477">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/123b6dfc2d9dd9ce31452a80a7cc7035?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/123b6dfc2d9dd9ce31452a80a7cc7035?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Danielha</span>
<span class="date">March 28, 2017 at 7:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394477" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
in the last part the LSTM layer returns a sequence, right? And after that the dense layer only takes one parameter. How does the dense layer know that it should take the last parameter? Or does it even take the last parameter?</p>
<div class="reply">
<a aria-label="Reply to Danielha" class="comment-reply-link" href="#comment-394477" onclick='return addComment.moveForm( "comment-394477", "394477", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-394556">
<div class="comment-container" id="li-comment-394556">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 29, 2017 at 9:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394556" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, in this case each LSTM unit is not returning a sequence, just a single value.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-394556" onclick='return addComment.moveForm( "comment-394556", "394556", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-394485">
<div class="comment-container" id="li-comment-394485">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7fe880fc00c371c9a3e10a8728e868ce?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7fe880fc00c371c9a3e10a8728e868ce?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://sites.google.com/view/prashanth-r" rel="external nofollow">Prashanth R</a></span>
<span class="date">March 28, 2017 at 9:25 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394485" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Very interesting and useful article. Thank you for writing such useful articles. I have had the privilege of going through your other articles which are very useful. </p>
<p>Just wanted to ask, how do we encode a new test data to make same format as required for the program. There is no dictionary involved i guess for the conversion. So how can we go about for this conversion? For instance, consider a sample sentence “Very interesting article on sequence classification”. What will be encoded numeric representation?<br/>
Thanks in advance</p>
<div class="reply">
<a aria-label="Reply to Prashanth R" class="comment-reply-link" href="#comment-394485" onclick='return addComment.moveForm( "comment-394485", "394485", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-394558">
<div class="comment-container" id="li-comment-394558">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 29, 2017 at 9:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394558" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question.</p>
<p>You can encode the chars as integers (integer encode), then encode the integers as boolean vectors (one hot encode).</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-394558" onclick='return addComment.moveForm( "comment-394558", "394558", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-401059">
<div class="comment-container" id="li-comment-401059">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/80706160bd88c664c8b7ad40c7423e60?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/80706160bd88c664c8b7ad40c7423e60?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Manish Sihag</span>
<span class="date">June 1, 2017 at 11:13 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-401059" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great article Jason. I wanted to continue the question Prashanth asked, how to pre-process the user input. If we use CountVectorizer() sure, it will convert it in the required form but then words will not be same as before. Even a single new word will create extra element. Can you please explain, how to pre-process the user input such that it resembles with the trained model. Thanks in advance.</p>
<div class="reply">
<a aria-label="Reply to Manish Sihag" class="comment-reply-link" href="#comment-401059" onclick='return addComment.moveForm( "comment-401059", "401059", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-401236">
<div class="comment-container" id="li-comment-401236">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 1:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-401236" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can allocate an alphabet of 1M words, all integers from 1 to 1M, then use that encoding for any words you see.</p>
<p>The idea is to have a buffer in your encoding scheme.</p>
<p>Also, if you drop all low-frequency words, this will give you more buffer. Often 25K words is more than enough.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401236" onclick='return addComment.moveForm( "comment-401236", "401236", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-401456">
<div class="comment-container" id="li-comment-401456">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/80706160bd88c664c8b7ad40c7423e60?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/80706160bd88c664c8b7ad40c7423e60?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Manish Sihag</span>
<span class="date">June 4, 2017 at 4:56 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-401456" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Your answer honestly cleared many doubts. Thanks a lot for the quick reply. I have an idea now about, what to do.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-401517">
<div class="comment-container" id="li-comment-401517">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 5, 2017 at 7:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-401517" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad to hear that Manish.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-394629">
<div class="comment-container" id="li-comment-394629">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">trangtruong</span>
<span class="date">March 29, 2017 at 7:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394629" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have dataset just a vector feature like [1, 0,5,1,1,2,1] -&gt; y just 0,1 binary or category like 0,1,2,3. I want to use LSTM to classify binary or category, how can i do it guys, i just add LSTM with Dense, but LSTM need input 3 dimension but Dense just 2 dimension. I know i need time sequence, i try to find out more but can’t get nothing. Can u explain and tell me how. pls, Thank you so much</p>
<div class="reply">
<a aria-label="Reply to trangtruong" class="comment-reply-link" href="#comment-394629" onclick='return addComment.moveForm( "comment-394629", "394629", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-394699">
<div class="comment-container" id="li-comment-394699">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 30, 2017 at 8:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394699" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You may want to consider a seq2seq structure with an encoder for the input sequence and a decoder for the output sequence.</p>
<p>Something like:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7dc7d0893359059" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
# encoder
model.add(LSTM(3, ...))
# mapping
model.add(RepeatVector(2))
# decoder
model.add(LSTM(2, return_sequences=True))
model.add(Dense(2))</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7dc7d0893359059-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7dc7d0893359059-2">2</div><div class="crayon-num" data-line="crayon-5c0caac7dc7d0893359059-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7dc7d0893359059-4">4</div><div class="crayon-num" data-line="crayon-5c0caac7dc7d0893359059-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7dc7d0893359059-6">6</div><div class="crayon-num" data-line="crayon-5c0caac7dc7d0893359059-7">7</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7dc7d0893359059-1"><span class="crayon-p"># encoder</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7dc7d0893359059-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7dc7d0893359059-3"><span class="crayon-p"># mapping</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7dc7d0893359059-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">RepeatVector</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7dc7d0893359059-5"><span class="crayon-p"># decoder</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7dc7d0893359059-6"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7dc7d0893359059-7"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>
<p>I have a tutorial on this scheduled.</p>
<p>I hope that helps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-394699" onclick='return addComment.moveForm( "comment-394699", "394699", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-394755">
<div class="comment-container" id="li-comment-394755">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">trangtruong</span>
<span class="date">March 30, 2017 at 5:51 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394755" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thanks you, i will try to find out, then response you.</p>
<div class="reply">
<a aria-label="Reply to trangtruong" class="comment-reply-link" href="#comment-394755" onclick='return addComment.moveForm( "comment-394755", "394755", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-394833">
<div class="comment-container" id="li-comment-394833">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 31, 2017 at 5:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394833" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-394833" onclick='return addComment.moveForm( "comment-394833", "394833", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="comment-394757">
<div class="comment-container" id="li-comment-394757">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">trangtruong</span>
<span class="date">March 30, 2017 at 6:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394757" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ay, i have 1 question in another your post  about why i use function evaluate model.evaluate(x_test, y_test) to get accuracy score of model after train with train dataset , but its return result &gt;1 in some case, i don’t know why, it make me can’t beleive in this function. Can you explain for me why?</p>
<div class="reply">
<a aria-label="Reply to trangtruong" class="comment-reply-link" href="#comment-394757" onclick='return addComment.moveForm( "comment-394757", "394757", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-394834">
<div class="comment-container" id="li-comment-394834">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 31, 2017 at 5:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394834" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry I don’t understand your question, perhaps you can rephrase it?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-394834" onclick='return addComment.moveForm( "comment-394834", "394834", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-394884">
<div class="comment-container" id="li-comment-394884">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">trangtruong</span>
<span class="date">March 31, 2017 at 12:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394884" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I don’t know the result return by function evaluate &gt;1, but i thinks it should just from 0 -&gt; 1  ( model.evaluate(x_test,y_test) with model i had trained it before with train dataset)</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even depth-3" id="comment-394781">
<div class="comment-container" id="li-comment-394781">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">trangtruong</span>
<span class="date">March 30, 2017 at 9:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394781" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, Can you explain your code step by step Jason, i have follow tutorial : <a href="https://blog.keras.io/building-autoencoders-in-keras.html" rel="nofollow">https://blog.keras.io/building-autoencoders-in-keras.html</a> but i have some confused to understand. :(.</p>
<div class="reply">
<a aria-label="Reply to trangtruong" class="comment-reply-link" href="#comment-394781" onclick='return addComment.moveForm( "comment-394781", "394781", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-394842">
<div class="comment-container" id="li-comment-394842">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 31, 2017 at 5:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-394842" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>If you have questions about that post, I would recommend contacting the author.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-394842" onclick='return addComment.moveForm( "comment-394842", "394842", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-395525">
<div class="comment-container" id="li-comment-395525">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/04dffb6f90d485a8a7204c43b4e9a24b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/04dffb6f90d485a8a7204c43b4e9a24b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Mazhar Ali</span>
<span class="date">April 6, 2017 at 7:36 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-395525" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Dear Joson<br/>
I am new to deep learning and intends to work on keras or tensorflow for corpus analysis. May you help me or send me basic tutorials<br/>
regards<br/>
Mazhar Ali</p>
<div class="reply">
<a aria-label="Reply to Mazhar Ali" class="comment-reply-link" href="#comment-395525" onclick='return addComment.moveForm( "comment-395525", "395525", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-395791">
<div class="comment-container" id="li-comment-395791">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 9, 2017 at 2:38 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-395791" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I only have tutorials for Keras:<br/>
<a href="http://machinelearningmastery.com/start-here/#deeplearning" rel="nofollow">http://machinelearningmastery.com/start-here/#deeplearning</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-395791" onclick='return addComment.moveForm( "comment-395791", "395791", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-395550">
<div class="comment-container" id="li-comment-395550">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9924ec5166c8d804ec025d92d3db01c7?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9924ec5166c8d804ec025d92d3db01c7?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ady</span>
<span class="date">April 7, 2017 at 12:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-395550" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for your friendly explanation.<br/>
I bought a lot of help from your books. </p>
<p>Are you willing to add examples of fit_generator and batch normalization to the IMDB LSTM example? </p>
<p>I was told to use the fit_generator function to process large amounts of data.<br/>
If there is an example, it will be very helpful to book buyers.</p>
<div class="reply">
<a aria-label="Reply to Ady" class="comment-reply-link" href="#comment-395550" onclick='return addComment.moveForm( "comment-395550", "395550", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-395803">
<div class="comment-container" id="li-comment-395803">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 9, 2017 at 2:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-395803" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would like to add this kind of example in the future. Thanks for the suggestion.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-395803" onclick='return addComment.moveForm( "comment-395803", "395803", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-395642">
<div class="comment-container" id="li-comment-395642">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3e7670f99caf88a98f45853147678fee?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3e7670f99caf88a98f45853147678fee?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Fernando López</span>
<span class="date">April 8, 2017 at 4:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-395642" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason</p>
<p>I would like to know where I can read more about dropout and recurrent_dropout. Do you know some paper or something to explore it?</p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Fernando López" class="comment-reply-link" href="#comment-395642" onclick='return addComment.moveForm( "comment-395642", "395642", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-395821">
<div class="comment-container" id="li-comment-395821">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 9, 2017 at 2:56 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-395821" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have a tutorial on dropout here:<br/>
<a href="http://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/" rel="nofollow">http://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/</a></p>
<p>I have a post on recurrent dropout scheduled for the blog soon.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-395821" onclick='return addComment.moveForm( "comment-395821", "395821", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-396361">
<div class="comment-container" id="li-comment-396361">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d57ffba71bc818b2102fa81b36980ab6?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d57ffba71bc818b2102fa81b36980ab6?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Donato Tiano</span>
<span class="date">April 14, 2017 at 1:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-396361" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I’ve a problem with the shape of my dataset</p>
<p>x_train = numpy.random.random((100, 3))<br/>
y_train = uti.to_categorical(numpy.random.randint(10, size=(100, 1)), num_classes=10)<br/>
model = Sequential()<br/>
model.add(Conv1D(2,2,activation=’relu’,input_shape=x_train.shape))<br/>
model.compile(loss=’binary_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])<br/>
model.fit(x_train,y_train, epochs=150)</p>
<p>I have tried to create random a dataset, and pass at CNN with 1D, but I don’t know why, the Conv1D accepts my shape (I think that put automaticly the value None), but the fit doesn’t accept (I think becaus the Conv1D have accepted 3 dimension). I have this error:</p>
<p>ValueError: Error when checking model input: expected conv1d_1_input to have 3 dimensions, but got array with shape (100, 3)</p>
<div class="reply">
<a aria-label="Reply to Donato Tiano" class="comment-reply-link" href="#comment-396361" onclick='return addComment.moveForm( "comment-396361", "396361", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-396393">
<div class="comment-container" id="li-comment-396393">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 14, 2017 at 8:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-396393" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Your input data must be 3d, even if one or two of those dimensions have a width of 1.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-396393" onclick='return addComment.moveForm( "comment-396393", "396393", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-396608">
<div class="comment-container" id="li-comment-396608">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c664064305c64148b04e757ed0e0020e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c664064305c64148b04e757ed0e0020e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Len</span>
<span class="date">April 16, 2017 at 1:24 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-396608" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>Thanks for an awesome article!</p>
<p>I wanted to ask for some suggestions on training my data set. The data I have are 1d measurements taken at a time with a binary label for each instance. </p>
<p>Thanks to your blogs I successfully have built a LSTM and it does a great job at classifying the dominant class. The main issue is that the proportion of 0s to 1s is very high. There are about .03 the number of 1s as there are 0s. For the most part, the 1s occur when there are high values of these measurements. So, I figured I could get a LSTM model to make better predictions if a model could see the last “p” measurements. Intuitively, it would recognize an abnormal increase in the measurement and associate that behavior with a output of 1. </p>
<p>Knowing some of this basic basckground could you suggest a structure that may<br/>
1.) help exploit the structure of abnormally high measurement with outputs of 1<br/>
2.) help with the low exposure to 1 instances</p>
<p>Thanks for any help or references!</p>
<p>cheers!</p>
<div class="reply">
<a aria-label="Reply to Len" class="comment-reply-link" href="#comment-396608" onclick='return addComment.moveForm( "comment-396608", "396608", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-396654">
<div class="comment-container" id="li-comment-396654">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 17, 2017 at 5:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-396654" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Len,</p>
<p>Perhaps you can use some of the resampling methods used for imbalanced datasets:<br/>
<a href="http://machinelearningmastery.com/tactics-to-combat-imbalanced-classes-in-your-machine-learning-dataset/" rel="nofollow">http://machinelearningmastery.com/tactics-to-combat-imbalanced-classes-in-your-machine-learning-dataset/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-396654" onclick='return addComment.moveForm( "comment-396654", "396654", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-397498">
<div class="comment-container" id="li-comment-397498">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c9bef4a21610718405510937ec085411?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c9bef4a21610718405510937ec085411?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">m91</span>
<span class="date">April 25, 2017 at 1:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-397498" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, that’s a great tutorial!<br/>
Just wondering: as you are paddin with zeros, why aren’t you setting the Embedding layer flag mask_zero to True?<br/>
Without doing that, the padded symbols will influence the computation of the cost function, isn’t it?</p>
<div class="reply">
<a aria-label="Reply to m91" class="comment-reply-link" href="#comment-397498" onclick='return addComment.moveForm( "comment-397498", "397498", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-397530">
<div class="comment-container" id="li-comment-397530">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 25, 2017 at 7:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-397530" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That is a good suggestion. Perhaps that flag did not exist when I write the example.</p>
<p>If you see a benefit, let me know.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-397530" onclick='return addComment.moveForm( "comment-397530", "397530", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-397755">
<div class="comment-container" id="li-comment-397755">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5aa22094225696627fdb1f29ed751694?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5aa22094225696627fdb1f29ed751694?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://www.linkedin.com/in/saurabh-nair-31a13877/" rel="external nofollow">Saurabh Nair</a></span>
<span class="date">April 27, 2017 at 11:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-397755" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Great tutorial! Helped a lot.<br/>
I’ve got a theoretical question though. Is sequence classification just based on the last state of the LSTM or do you have to take the dense layer for all the hidden units(100 LSTM in this case). Is sequence classification possible just based on the last state? Most of the implementations I see, there is dense and a softmax to classify the sequence.</p>
<div class="reply">
<a aria-label="Reply to Saurabh Nair" class="comment-reply-link" href="#comment-397755" onclick='return addComment.moveForm( "comment-397755", "397755", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-397835">
<div class="comment-container" id="li-comment-397835">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 28, 2017 at 7:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-397835" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>We do need the dense layer to interpret what the LSTMs have learned.</p>
<p>The LSTMs are modeling the problem as a function of the input time steps and of the internal state.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-397835" onclick='return addComment.moveForm( "comment-397835", "397835", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-397759">
<div class="comment-container" id="li-comment-397759">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">nguyennguyen</span>
<span class="date">April 27, 2017 at 12:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-397759" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Can you tell me about time_step in LSTM?, with example or something to easy understand. If   my data have 2 dimension, [[1,2]…[1,3]] ouput: [1,…0], so with keras, LSTM layer need 3 dimension, so i just can reshape input data to 3 dimension with time_step =1, can train it like this?, with time_step&gt; 1 is it better, i want to know mean of time_step in LSTM, thank you so much for read my question.</p>
<div class="reply">
<a aria-label="Reply to nguyennguyen" class="comment-reply-link" href="#comment-397759" onclick='return addComment.moveForm( "comment-397759", "397759", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-397837">
<div class="comment-container" id="li-comment-397837">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 28, 2017 at 7:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-397837" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can, but it is better to provide the sequence information in the time step.</p>
<p>The LSTM is developing a function of observations over prior time steps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-397837" onclick='return addComment.moveForm( "comment-397837", "397837", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-398626">
<div class="comment-container" id="li-comment-398626">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/39da563bc91cc9c97d737f218376c64e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/39da563bc91cc9c97d737f218376c64e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Carlos de Sá</span>
<span class="date">May 5, 2017 at 2:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-398626" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
First of ali, thank you for your great explanation.<br/>
I am considering setting up an aws g2.2xlarge instance according to  your explanation in another post . Would you have  some benchmark (ex: time of 1 epoch of one of the above examples) so that I can compre with my current hardware?</p>
<div class="reply">
<a aria-label="Reply to Carlos de Sá" class="comment-reply-link" href="#comment-398626" onclick='return addComment.moveForm( "comment-398626", "398626", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-398731">
<div class="comment-container" id="li-comment-398731">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 6, 2017 at 7:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-398731" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have any execution time benchmarks.</p>
<p>I generally see great benefit from large AWS instances in terms getting access to a lot more memory (larger datasets) when using LSTMs. </p>
<p> I see a lot more benefit running CNNs on GPUs than LSTMs on GPUs.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-398731" onclick='return addComment.moveForm( "comment-398731", "398731", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-398638">
<div class="comment-container" id="li-comment-398638">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f29dc041e5417e3773f616e479af736e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f29dc041e5417e3773f616e479af736e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Iris L</span>
<span class="date">May 5, 2017 at 4:41 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-398638" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I am also curious in the problem of padding. I think pad_sequence is the way to obtain fixed length of sequences. However, instead of padding zeros, can we actually scale the data?</p>
<p>Then, the problem is 1) if scaling sequences will distort the meaning of sentences given that sentences are represented as sequences and 2) how to choose a good scale factor. </p>
<p>Thank you.</p>
<div class="reply">
<a aria-label="Reply to Iris L" class="comment-reply-link" href="#comment-398638" onclick='return addComment.moveForm( "comment-398638", "398638", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-398733">
<div class="comment-container" id="li-comment-398733">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 6, 2017 at 7:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-398733" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question.</p>
<p>Generally, a good way to reduce the length of sequences of words is first remove the low frequency words, then truncate the sequence to a desired length or pad out to the length.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-398733" onclick='return addComment.moveForm( "comment-398733", "398733", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-399517">
<div class="comment-container" id="li-comment-399517">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6cc0059e7264ec1a65e56a360de273ea?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6cc0059e7264ec1a65e56a360de273ea?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chao</span>
<span class="date">May 13, 2017 at 2:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-399517" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>For using LSTM, why we still need to scale the input sequence to the fixed size? Why not build some model like seq2seq just multi-input to one-output</p>
<div class="reply">
<a aria-label="Reply to Chao" class="comment-reply-link" href="#comment-399517" onclick='return addComment.moveForm( "comment-399517", "399517", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-399536">
<div class="comment-container" id="li-comment-399536">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 13, 2017 at 6:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-399536" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Even with seq2seq, you must vectorize your input data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-399536" onclick='return addComment.moveForm( "comment-399536", "399536", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-399519">
<div class="comment-container" id="li-comment-399519">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6cc0059e7264ec1a65e56a360de273ea?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6cc0059e7264ec1a65e56a360de273ea?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Chao</span>
<span class="date">May 13, 2017 at 2:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-399519" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I saw the data loaded from IMDB, which has already be encoded as numbers.<br/>
Why do we need another Embedding layer to encoding?</p>
<p>(X_train, y_train), (X_test, y_test) = imdb.load_data(num_words=top_words)<br/>
print X_train[1]<br/>
The output is<br/>
[1, 194, 1153, 194, 2, 78, 228, 5, 6, 1463, 4369,…</p>
<div class="reply">
<a aria-label="Reply to Chao" class="comment-reply-link" href="#comment-399519" onclick='return addComment.moveForm( "comment-399519", "399519", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-399537">
<div class="comment-container" id="li-comment-399537">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 13, 2017 at 6:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-399537" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The embedding is a more expressive representation which results in better performance.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-399537" onclick='return addComment.moveForm( "comment-399537", "399537", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-399907">
<div class="comment-container" id="li-comment-399907">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4870ea09325f0cde83c4973d3d33d7b5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4870ea09325f0cde83c4973d3d33d7b5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Amir</span>
<span class="date">May 18, 2017 at 1:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-399907" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason for your article and answering comments also. Can I use this approach to solve my issue described in this stack-overflow question? Please take a look at that.</p>
<p><a href="http://stackoverflow.com/questions/43987060/pattern-recognition-or-named-entity-recognition-for-information-extraction-in-nl/43991328#43991328" rel="nofollow">http://stackoverflow.com/questions/43987060/pattern-recognition-or-named-entity-recognition-for-information-extraction-in-nl/43991328#43991328</a></p>
<div class="reply">
<a aria-label="Reply to Amir" class="comment-reply-link" href="#comment-399907" onclick='return addComment.moveForm( "comment-399907", "399907", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-399936">
<div class="comment-container" id="li-comment-399936">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 18, 2017 at 8:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-399936" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps, I would recommend finding some existing research to template a solution.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-399936" onclick='return addComment.moveForm( "comment-399936", "399936", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-400058">
<div class="comment-container" id="li-comment-400058">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9ff1bc71820228d52c4398f24bc8cacb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9ff1bc71820228d52c4398f24bc8cacb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vijay</span>
<span class="date">May 19, 2017 at 10:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-400058" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason for your article. I have implemented a CNN followed by LSTM neural network model in keras for sentence classification. But after 1 or 2 epoch my training accuracy and validation accuracy stuck to some number and do not change. Like it has stuck in some local minima or some other reason. What should i do to resolve this problem. If i use only CNN in my model then both training and validation accuracy converges to good accuracy. Can you help me in this. I couldn’t identify the problem.</p>
<p>Here is the training and validation accuracy.</p>
<p>Epoch 1/20<br/>
1472/1500 [============================&gt;.] -8s – loss: 0.5327 – acc: 0.8516 – val_loss: 0.3925 – val_acc: 0.8460<br/>
Epoch 2/20<br/>
1500/1500 [==============================] – 10s – loss: 0.3733 – acc: 0.8531 – val_loss: 0.3755 – val_acc: 0.8460<br/>
Epoch 3/20<br/>
1500/1500 [==============================] – 8s – loss: 0.3695 – acc: 0.8529 – val_loss: 0.3764 – val_acc: 0.8460<br/>
Epoch 4/20<br/>
1500/1500 [==============================] – 8s – loss: 0.3700 – acc: 0.8531 – val_loss: 0.3752 – val_acc: 0.8460<br/>
Epoch 5/20<br/>
1500/1500 [==============================] – 8s – loss: 0.3706 – acc: 0.8528 – val_loss: 0.3763 – val_acc: 0.8460<br/>
Epoch 6/20<br/>
1500/1500 [==============================] – 8s – loss: 0.3703 – acc: 0.8528 – val_loss: 0.3760 – val_acc: 0.8460<br/>
Epoch 7/20<br/>
1500/1500 [==============================] – 8s – loss: 0.3700 – acc: 0.8528 – val_loss: 0.3764 – val_acc: 0.8460<br/>
Epoch 8/20<br/>
1500/1500 [==============================] – 8s – loss: 0.3697 – acc: 0.8531 – val_loss: 0.3752 – val_acc: 0.8460<br/>
Epoch 9/20<br/>
1500/1500 [==============================] – 8s – loss: 0.3708 – acc: 0.8530 – val_loss: 0.3758 – val_acc: 0.8460<br/>
Epoch 10/20<br/>
1500/1500 [==============================] – 8s – loss: 0.3703 – acc: 0.8527 – val_loss: 0.3760 – val_acc: 0.8460<br/>
Epoch 11/20<br/>
1500/1500 [==============================] – 8s – loss: 0.3698 – acc: 0.8531 – val_loss: 0.3753 – val_acc: 0.8460<br/>
Epoch 12/20<br/>
1500/1500 [==============================] – 8s – loss: 0.3699 – acc: 0.8531 – val_loss: 0.3758 – val_acc: 0.8460<br/>
Epoch 13/20<br/>
1500/1500 [==============================] – 8s – loss: 0.3698 – acc: 0.8531 – val_loss: 0.3753 – val_acc: 0.8460<br/>
Epoch 14/20<br/>
1500/1500 [==============================] – 10s – loss: 0.3700 – acc: 0.8533 – val_loss: 0.3769 – val_acc: 0.8460<br/>
Epoch 15/20<br/>
1500/1500 [==============================] – 9s – loss: 0.3704 – acc: 0.8532 – val_loss: 0.3768 – val_acc: 0.8460<br/>
Epoch 16/20<br/>
1500/1500 [==============================] – 8s – loss: 0.3699 – acc: 0.8531 – val_loss: 0.3756 – val_acc: 0.8460<br/>
Epoch 17/20<br/>
1500/1500 [==============================] – 8s – loss: 0.3699 – acc: 0.8531 – val_loss: 0.3753 – val_acc: 0.8460<br/>
Epoch 18/20<br/>
1500/1500 [==============================] – 8s – loss: 0.3696 – acc: 0.8531 – val_loss: 0.3753 – val_acc: 0.8460<br/>
Epoch 19/20<br/>
1500/1500 [==============================] – 8s – loss: 0.3696 – acc: 0.8531 – val_loss: 0.3757 – val_acc: 0.8460<br/>
Epoch 20/20<br/>
1500/1500 [==============================] – 8s – loss: 0.3701 – acc: 0.8531 – val_loss: 0.3754 – val_acc: 0.8460</p>
<div class="reply">
<a aria-label="Reply to vijay" class="comment-reply-link" href="#comment-400058" onclick='return addComment.moveForm( "comment-400058", "400058", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-400093">
<div class="comment-container" id="li-comment-400093">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 20, 2017 at 5:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-400093" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I provide a list of ideas here to help you improve the performance on your deep learning projects:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-400093" onclick='return addComment.moveForm( "comment-400093", "400093", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-400219">
<div class="comment-container" id="li-comment-400219">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f9fa0cd1080b9eb9185092106a1d2e36?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f9fa0cd1080b9eb9185092106a1d2e36?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Libardo</span>
<span class="date">May 22, 2017 at 2:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-400219" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason, thaks for yor great post.<br/>
I am beginner with DL.<br/>
If I need to include some behavioral features to this analysis, let say: age, genre, zipcode, time (DD:HH), season (spring/summer/autumn/winter)… could you give me some hints to implement that?</p>
<p>TIA</p>
<div class="reply">
<a aria-label="Reply to Libardo" class="comment-reply-link" href="#comment-400219" onclick='return addComment.moveForm( "comment-400219", "400219", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-400238">
<div class="comment-container" id="li-comment-400238">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 22, 2017 at 7:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-400238" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Each would be a different feature on the input data. </p>
<p>Remember, input data must be structured [samples, timesteps, features].</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-400238" onclick='return addComment.moveForm( "comment-400238", "400238", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-422214">
<div class="comment-container" id="li-comment-422214">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/923c53f79c5a525ccf4e3dff48836b87?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/923c53f79c5a525ccf4e3dff48836b87?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Usama Kaleem</span>
<span class="date">December 5, 2017 at 8:55 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-422214" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>My data is of shape (8000,30) and i need to use 30 timesteps.<br/>
I do<br/>
model.add(LSTM(200, input_shape=(timesteps,train.shape[1])))</p>
<p>but when i run the code it give me and error<br/>
ValueError: Error when checking input: expected lstm_20_input to have 3 dimensions, but got array with shape (8000, 30)<br/>
How to change the shape of the training data in the format you mentioned<br/>
Remember, input data must be structured [samples, timesteps, features]. (8000,30,30)</p>
<div class="reply">
<a aria-label="Reply to Usama Kaleem" class="comment-reply-link" href="#comment-422214" onclick='return addComment.moveForm( "comment-422214", "422214", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-422244">
<div class="comment-container" id="li-comment-422244">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 6, 2017 at 9:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-422244" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This post will help you with the shape of your data for LSTMs:<br/>
<a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" rel="nofollow">https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-422244" onclick='return addComment.moveForm( "comment-422244", "422244", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-400732">
<div class="comment-container" id="li-comment-400732">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e53875e4916062c8c993c5de3a9bdf19?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e53875e4916062c8c993c5de3a9bdf19?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kadir Habib</span>
<span class="date">May 29, 2017 at 2:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-400732" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
How can I use my own data, instead of IMDB for training?</p>
<p>Thanks<br/>
Kadir</p>
<div class="reply">
<a aria-label="Reply to Kadir Habib" class="comment-reply-link" href="#comment-400732" onclick='return addComment.moveForm( "comment-400732", "400732", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401177">
<div class="comment-container" id="li-comment-401177">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 12:20 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-401177" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You will need to encode the text data as integers.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401177" onclick='return addComment.moveForm( "comment-401177", "401177", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-400768">
<div class="comment-container" id="li-comment-400768">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7d687a8bdfae4f925dceed221e82b028?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7d687a8bdfae4f925dceed221e82b028?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kunal chakraborty</span>
<span class="date">May 29, 2017 at 10:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-400768" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Dr.Jason,</p>
<p>I am very thankful for your blog-posts. They are undoubtedly one of the best on the internet.<br/>
I have one doubt though. Why did you use the validation dataset as x_test and y_test in the very first example that you described. I just find it a little bit confusing.</p>
<p>Thanks in advance</p>
<div class="reply">
<a aria-label="Reply to Kunal chakraborty" class="comment-reply-link" href="#comment-400768" onclick='return addComment.moveForm( "comment-400768", "400768", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401187">
<div class="comment-container" id="li-comment-401187">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 12:27 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-401187" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks.</p>
<p>I did it to give an idea of skill of the model as it was being fit. You do not need to do this.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401187" onclick='return addComment.moveForm( "comment-401187", "401187", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-400904">
<div class="comment-container" id="li-comment-400904">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e9102dab9c84e3792323e876d0be805b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e9102dab9c84e3792323e876d0be805b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://solutionhacker.com" rel="external nofollow">ray</a></span>
<span class="date">May 31, 2017 at 2:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-400904" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>i added dropout on CNN+RNN like you said and it gives me 87.65% accuracy. I still not clear the purpose of combining both as i thought CNN is for 2D+ input like image or video. But anyway, your tutorial gives me a great starting point to dive into RNN. Many thanks!</p>
<div class="reply">
<a aria-label="Reply to ray" class="comment-reply-link" href="#comment-400904" onclick='return addComment.moveForm( "comment-400904", "400904", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401213">
<div class="comment-container" id="li-comment-401213">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 2, 2017 at 12:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-401213" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear it.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401213" onclick='return addComment.moveForm( "comment-401213", "401213", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-401358">
<div class="comment-container" id="li-comment-401358">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5c201783007b89f7b98f68a874fe70b1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5c201783007b89f7b98f68a874fe70b1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Fred</span>
<span class="date">June 3, 2017 at 8:21 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-401358" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the post.</p>
<p>If I am understanding right, after the embedding layer EACH SAMPLE (each review) in the training data is transformed into a 32 by 500 matrix. When taking an analogy from audio spectrogram, it is a 32-dim spectrum with 500 time frames long.</p>
<p>With the equivalence or analogy above, I can perform audio waveform classification with audio raw spectrogram as the input and class labels (whatever it is, might be audio quality good or bad) in exact the same code in this post (except the embedding layer). Is it correct?</p>
<p>Furthermore, I am wondering about why should the length of the input be the same, i.e. 500 in the post. If I am doing in the context of online training, in which a single sample is fed into the model at a time (batch size is 1), there should be no concern about varying length of samples right? That is, each sample (of varying length without padding) and its target are used to train the model one after another, and there is no worry about the varying length. Is it just the issue of implementation in Keras, or in theory the input length of each sample should be the same?</p>
<div class="reply">
<a aria-label="Reply to Fred" class="comment-reply-link" href="#comment-401358" onclick='return addComment.moveForm( "comment-401358", "401358", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-401409">
<div class="comment-container" id="li-comment-401409">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 4, 2017 at 7:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-401409" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Fred,</p>
<p>Yes, try it.</p>
<p>The vectorized input requires all inputs to have the same length (for efficiencies in the backend libraries). You use zero-padding (and even masking) to meet this requirement.</p>
<p>The size parameters are fixed in the definition of the network I believe. You could do tricks from batch to batch re-defining+compiling your network as you go, but that would not be efficient.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401409" onclick='return addComment.moveForm( "comment-401409", "401409", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-401422">
<div class="comment-container" id="li-comment-401422">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5c201783007b89f7b98f68a874fe70b1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5c201783007b89f7b98f68a874fe70b1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Fred</span>
<span class="date">June 4, 2017 at 11:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-401422" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for your reply, I will try it.</p>
<p>I was just wondering if the RNN or LSTM in theory requires every input to be in a same length.<br/>
As far as I know, one of the superiorities of RNN over DNN is that it accepts varying-length input. </p>
<p>It doesn’t bother me If the requirement is for efficiency issue in Keras, and the zero’s (if zero-padding is used) is regarded to carry zero information. In the audio spectrogram case, would you recommend zero-padding the raw waveform (one-D) or spectrogram (two-D)? With the analogy to your post, the choice would be the former though.</p>
<div class="reply">
<a aria-label="Reply to Fred" class="comment-reply-link" href="#comment-401422" onclick='return addComment.moveForm( "comment-401422", "401422", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-401515">
<div class="comment-container" id="li-comment-401515">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 5, 2017 at 7:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-401515" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Fred,</p>
<p>Padding is not required by LSTMs in theory, it is only a limitation of efficient implementations that require vectorized inputs. </p>
<p>A fair tradeoff for most applications perhaps.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-401515" onclick='return addComment.moveForm( "comment-401515", "401515", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-403093">
<div class="comment-container" id="li-comment-403093">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/594938c71a5c9cdd872da23a6edc3857?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/594938c71a5c9cdd872da23a6edc3857?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">adit agrawal</span>
<span class="date">June 20, 2017 at 3:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-403093" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Is there a way in RNN (keras implementation) to control for the attention of the LSTM.<br/>
I have a dataset where 100 time series inputs are fed as sequence. I want the LSTM to give more importance to the last 10 time series inputs.<br/>
Can it be done?</p>
<p>Thanks in advance.</p>
<div class="reply">
<a aria-label="Reply to adit agrawal" class="comment-reply-link" href="#comment-403093" onclick='return addComment.moveForm( "comment-403093", "403093", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-403133">
<div class="comment-container" id="li-comment-403133">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 20, 2017 at 6:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-403133" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, but you must code a custom layer to do the attention.</p>
<p>I hope to cover attention models for LSTMs soon.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-403133" onclick='return addComment.moveForm( "comment-403133", "403133", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-403426">
<div class="comment-container" id="li-comment-403426">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1c79976ca30b944667ead8df59a63009?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1c79976ca30b944667ead8df59a63009?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vivz</span>
<span class="date">June 22, 2017 at 4:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-403426" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
After building and saving the model I want to use it for a prediction on new texts but I don’t know how to preprocess the plain text in order to use them for predictions. I have searched about it and find this way:<br/>
text = np.array([‘this is a random sentence’])<br/>
tk = keras.preprocessing.text.Tokenizer( nb_words=2000, lower=True,split=” “)<br/>
predictions = loaded_model.predict(np.array(tk.fit_on_texts(text)))</p>
<p>but this is not working for me and showing this error:<br/>
ValueError: Error when checking : expected embedding_1_input to have 2 dimensions, but got array with shape ()</p>
<p>Can You please tell me the proper way to preprocess the text. Any help is greatly appreciated.<br/>
Thanks</p>
<div class="reply">
<a aria-label="Reply to vivz" class="comment-reply-link" href="#comment-403426" onclick='return addComment.moveForm( "comment-403426", "403426", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-403495">
<div class="comment-container" id="li-comment-403495">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 23, 2017 at 6:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-403495" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Generally, you need to integer encode the words.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-403495" onclick='return addComment.moveForm( "comment-403495", "403495", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-403569">
<div class="comment-container" id="li-comment-403569">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1c79976ca30b944667ead8df59a63009?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1c79976ca30b944667ead8df59a63009?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vivz</span>
<span class="date">June 23, 2017 at 7:11 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-403569" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the reply<br/>
I converted my string like this:<br/>
text = ‘It is a good movie to watch’<br/>
import keras.preprocessing.text<br/>
text = keras.preprocessing.text.one_hot(text, 5000, lower=True, split=” “)<br/>
text = [text]<br/>
text = sequence.pad_sequences(text, 500)<br/>
predictions = loaded_model.predict(text)</p>
<p>But got the output as: [[ 0.10996077]]<br/>
Shouldn’t it be close to 1?<br/>
Many Thanks</p>
<div class="reply">
<a aria-label="Reply to vivz" class="comment-reply-link" href="#comment-403569" onclick='return addComment.moveForm( "comment-403569", "403569", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-403647">
<div class="comment-container" id="li-comment-403647">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 24, 2017 at 8:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-403647" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t follow. Why do you expect te output to be 1? What are you predicting?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-403647" onclick='return addComment.moveForm( "comment-403647", "403647", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-5" id="comment-403878">
<div class="comment-container" id="li-comment-403878">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1c79976ca30b944667ead8df59a63009?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1c79976ca30b944667ead8df59a63009?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vivek Vishnoi</span>
<span class="date">June 26, 2017 at 9:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-403878" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What I interpret is that 1 is the label for positive sentiment and since I am using a positive statement to predict I am expecting output to be 1.<br/>
I had made a mistake in the last comment by using model.predict() to get class labels, the correct way to get the label is model.predict_classes() but still, it’s not giving proper class labels.<br/>
So my question is whether I made a mistake in converting text into one-hot vector or is it the right way to do it.<br/>
Many Thanks</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5" id="comment-403940">
<div class="comment-container" id="li-comment-403940">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 27, 2017 at 8:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-403940" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>As long as you are consistent in data preparation and in interpretation at the other end, then you should be fine.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-404242">
<div class="comment-container" id="li-comment-404242">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4b6dc97f485d7721e4d3b31929a2ca62?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4b6dc97f485d7721e4d3b31929a2ca62?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">sk</span>
<span class="date">June 29, 2017 at 4:30 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-404242" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can you do a tutorial for preprocessing text dataset and then passing them as input using word embeddings? Thanks!</p>
<div class="reply">
<a aria-label="Reply to sk" class="comment-reply-link" href="#comment-404242" onclick='return addComment.moveForm( "comment-404242", "404242", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-404302">
<div class="comment-container" id="li-comment-404302">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 30, 2017 at 8:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-404302" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great suggestion. It is high on my list!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-404302" onclick='return addComment.moveForm( "comment-404302", "404302", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-404361">
<div class="comment-container" id="li-comment-404361">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6354b4cf65c74a90b4a6984a9b0cc396?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6354b4cf65c74a90b4a6984a9b0cc396?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">tanmay</span>
<span class="date">June 30, 2017 at 9:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-404361" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can we use sequence labelling problem over continous variable. I have datasets of customer paying their debt within due date, buffer period and beyond buffer period. Basis on this I want to score the customer from good to bad. Is it posible using sequence labelling.</p>
<div class="reply">
<a aria-label="Reply to tanmay" class="comment-reply-link" href="#comment-404361" onclick='return addComment.moveForm( "comment-404361", "404361", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-404415">
<div class="comment-container" id="li-comment-404415">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 1, 2017 at 6:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-404415" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps, I’m not sure I understand your dataset. Can you give a one-case example?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-404415" onclick='return addComment.moveForm( "comment-404415", "404415", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-404676">
<div class="comment-container" id="li-comment-404676">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8b601a43c4c6a2b59576fec138f18959?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8b601a43c4c6a2b59576fec138f18959?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Karthik Suresh</span>
<span class="date">July 4, 2017 at 7:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-404676" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, great tutorial! </p>
<p>I have data as follows</p>
<p>Text 	   Alpha-Numeric 	     Label<br/>
“foo”	        A1034            	         A<br/>
“bar”   	A1234        	         B</p>
<p>I have already mapped an LSTM model from Text column to label column. However, I need to add the Alpha-numeric Column with the Text as an additional feature to my LSTM model. How can I do that in Keras?</p>
<div class="reply">
<a aria-label="Reply to Karthik Suresh" class="comment-reply-link" href="#comment-404676" onclick='return addComment.moveForm( "comment-404676", "404676", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-404876">
<div class="comment-container" id="li-comment-404876">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 6, 2017 at 10:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-404876" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Consider a one hot encoding.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-404876" onclick='return addComment.moveForm( "comment-404876", "404876", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-404743">
<div class="comment-container" id="li-comment-404743">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1906836624053a3ea7d8d995cc58940b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1906836624053a3ea7d8d995cc58940b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sajad</span>
<span class="date">July 5, 2017 at 12:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-404743" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi, it was really great and I am happy that this tutorial was my first practical project in LSTM. I need to have f-measures, False Positives and AUC instead of “accuracy” in your code. Do you have any idea how to get them? </p>
<p>Thank you in advance.<br/>
Sajad,</p>
<div class="reply">
<a aria-label="Reply to Sajad" class="comment-reply-link" href="#comment-404743" onclick='return addComment.moveForm( "comment-404743", "404743", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-404894">
<div class="comment-container" id="li-comment-404894">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 6, 2017 at 10:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-404894" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can make predictions, then use the array of predictions and expected value to calculate these scores using sklearn:<br/>
<a href="http://scikit-learn.org/stable/modules/classes.html#sklearn-metrics-metrics" rel="nofollow">http://scikit-learn.org/stable/modules/classes.html#sklearn-metrics-metrics</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-404894" onclick='return addComment.moveForm( "comment-404894", "404894", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-405362">
<div class="comment-container" id="li-comment-405362">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/11387f8dbbbf7cd60dfcb314b6aa39b4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/11387f8dbbbf7cd60dfcb314b6aa39b4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Reihaneh</span>
<span class="date">July 10, 2017 at 10:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-405362" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have a question about built-in embedding layer in Keras.<br/>
I have done word embedding with word2vec model which is working based on the semantic similarity of the words–those in the same context are more similar.  I am wondering whether Keras embedding layer is also following the w2v model or it has its own algorithm to map the words into vectors?<br/>
Based on what semantics it map the words to vectors?</p>
<div class="reply">
<a aria-label="Reply to Reihaneh" class="comment-reply-link" href="#comment-405362" onclick='return addComment.moveForm( "comment-405362", "405362", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-405472">
<div class="comment-container" id="li-comment-405472">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 11, 2017 at 10:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-405472" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great question, there’s a bit more on it here:<br/>
<a href="https://keras.io/layers/embeddings/" rel="nofollow">https://keras.io/layers/embeddings/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-405472" onclick='return addComment.moveForm( "comment-405472", "405472", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-405563">
<div class="comment-container" id="li-comment-405563">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/11387f8dbbbf7cd60dfcb314b6aa39b4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/11387f8dbbbf7cd60dfcb314b6aa39b4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Reihaneh</span>
<span class="date">July 12, 2017 at 3:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-405563" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason!<br/>
I went through most of the documentations about this but none of them mention about the semantic behind this biult-in word embedding process.</p>
<p>I would like to know it because right now I keep thinking that the process inside this method is possibly causing the low accuracy! </p>
<p>Please keep me posted if you find anything about it.</p>
<div class="reply">
<a aria-label="Reply to Reihaneh" class="comment-reply-link" href="#comment-405563" onclick='return addComment.moveForm( "comment-405563", "405563", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-405608">
<div class="comment-container" id="li-comment-405608">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 12, 2017 at 9:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-405608" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend reading the code here:<br/>
<a href="https://github.com/fchollet/keras/blob/master/keras/layers/embeddings.py#L11" rel="nofollow">https://github.com/fchollet/keras/blob/master/keras/layers/embeddings.py#L11</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-405608" onclick='return addComment.moveForm( "comment-405608", "405608", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-405499">
<div class="comment-container" id="li-comment-405499">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e4ebfc52ba9013da1768bc730037d966?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e4ebfc52ba9013da1768bc730037d966?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">William Wong</span>
<span class="date">July 11, 2017 at 12:03 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-405499" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Excellent article.  I am trying to use CNN to model time series data and feed into LSTM for supervised learning.  I have a 2d matrix with columns representing previous n-time steps and rows representing the different price levels each time steps visited:<br/>
Price   Bar0   Bar1   Bar2   Bar3   Bar4   Bar5  …<br/>
0         0          0         1        1         0        0<br/>
1         1          0         1        1         0        1<br/>
2         1          1         1        1         1        1<br/>
3         1          1         0        1         1        0<br/>
4         0          0         0        0         1        0<br/>
…<br/>
this matrix will represent, price data of:<br/>
       High    Low<br/>
Bar0    3       1<br/>
Bar1    3       2<br/>
Bar2    2       0<br/>
Bar3    3       0<br/>
Bar4    4       2<br/>
Bar5    2       1</p>
<p>Could you tell me how to adapt your 1-d CNN to 2-d CNN?</p>
<div class="reply">
<a aria-label="Reply to William Wong" class="comment-reply-link" href="#comment-405499" onclick='return addComment.moveForm( "comment-405499", "405499", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-405505">
<div class="comment-container" id="li-comment-405505">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">truongtrang</span>
<span class="date">July 11, 2017 at 12:56 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-405505" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hi Jason,<br/>
Great post for me.<br/>
But I want to ask you about: length vector in Embedded layer, you said “the first layer is the Embedded layer that uses 32 length vectors to represent each word” , why you choose 32 instead of another number like 64 or 128, Can you give me some best practice, or reason for your choose.<br/>
Thanks you so much.</p>
<div class="reply">
<a aria-label="Reply to truongtrang" class="comment-reply-link" href="#comment-405505" onclick='return addComment.moveForm( "comment-405505", "405505", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-405591">
<div class="comment-container" id="li-comment-405591">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 12, 2017 at 9:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-405591" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Trial and error. You could experiment with other representations and see what works best for your problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-405591" onclick='return addComment.moveForm( "comment-405591", "405591", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-405623">
<div class="comment-container" id="li-comment-405623">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dbc112a220b4c0d6f974b07f7e032ff9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">truongtrang</span>
<span class="date">July 12, 2017 at 11:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-405623" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason.</p>
<div class="reply">
<a aria-label="Reply to truongtrang" class="comment-reply-link" href="#comment-405623" onclick='return addComment.moveForm( "comment-405623", "405623", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-405715">
<div class="comment-container" id="li-comment-405715">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 13, 2017 at 9:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-405715" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You’re welcome.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-405715" onclick='return addComment.moveForm( "comment-405715", "405715", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-406405">
<div class="comment-container" id="li-comment-406405">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fd033c5cbf5be2d582e8a01aed939d98?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fd033c5cbf5be2d582e8a01aed939d98?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tursun</span>
<span class="date">July 19, 2017 at 3:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-406405" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>@Jason,<br/>
“Sequence classification is a predictive modeling problem where you have some sequence of inputs over space or time and the task is to predict a category for the sequence.”<br/>
this is inspiring. I am thinking about to use sequence classification to IRIS dataset.<br/>
Do you think it works ?</p>
<div class="reply">
<a aria-label="Reply to Tursun" class="comment-reply-link" href="#comment-406405" onclick='return addComment.moveForm( "comment-406405", "406405", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-406446">
<div class="comment-container" id="li-comment-406446">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 19, 2017 at 8:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-406446" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The iris flowers dataset is not a sequence classification problem. It is just a classification problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-406446" onclick='return addComment.moveForm( "comment-406446", "406446", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-406505">
<div class="comment-container" id="li-comment-406505">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fd033c5cbf5be2d582e8a01aed939d98?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fd033c5cbf5be2d582e8a01aed939d98?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tursun</span>
<span class="date">July 19, 2017 at 6:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-406505" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>@Jason,<br/>
Do you mean that:<br/>
I can not use LSTM for IRIS classification? I am working on IRIS like dataset. So I m exploring all possible classifiers. You have one here in your website. Besides,<br/>
I have tried RBM in SKLearn, it did not work as my inputs are not binary inputs like MNIST dataset (even after SKLearn’s  preprocessing.binarizer() function). I think they were wrong to say that RBM In SKLearn works for data in range of [0,1], it only works for 0 and 1.<br/>
(by the way I send you my code to  for reference)</p>
<p>I also have tried probablistic neural net (PNN), which yields only 78% accuracy, low and no way to increase layers of PNN as it is single layer net (from Neupy).<br/>
Now I came to RNN, but you said that.</p>
<div class="reply">
<a aria-label="Reply to Tursun" class="comment-reply-link" href="#comment-406505" onclick='return addComment.moveForm( "comment-406505", "406505", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-406549">
<div class="comment-container" id="li-comment-406549">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 20, 2017 at 6:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-406549" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, the iris dataset is not a sequence classification problem and the LSTM would be a bad fit.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-406549" onclick='return addComment.moveForm( "comment-406549", "406549", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-406599">
<div class="comment-container" id="li-comment-406599">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fd033c5cbf5be2d582e8a01aed939d98?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fd033c5cbf5be2d582e8a01aed939d98?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tursun</span>
<span class="date">July 20, 2017 at 2:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-406599" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>@Jason,<br/>
What would you suggest ? I need your expert advice.<br/>
I tried RBM in sklearn, it did not work.<br/>
You said ,RNN would not work for it.<br/>
I think, CNN clearly does not work for it.<br/>
Do DBN and VAE left?</p>
<p>I wish to classify IRIS in 3 different ways. I did one only.</p>
<div class="reply">
<a aria-label="Reply to Tursun" class="comment-reply-link" href="#comment-406599" onclick='return addComment.moveForm( "comment-406599", "406599", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-406708">
<div class="comment-container" id="li-comment-406708">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 21, 2017 at 9:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-406708" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Consider SVM, CART, and kNN.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-406708" onclick='return addComment.moveForm( "comment-406708", "406708", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-407133">
<div class="comment-container" id="li-comment-407133">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fd033c5cbf5be2d582e8a01aed939d98?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fd033c5cbf5be2d582e8a01aed939d98?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tursun</span>
<span class="date">July 24, 2017 at 3:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-407133" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>@Jason,<br/>
Thank you. I’ve already tried kNN and SVM . There were good, gave good results.<br/>
I have a feeling that Deep Learning methods yields even better results to my dataset. Do you have other suggessions in Deep Learning! this is my dataset:<br/>
<a href="https://www.dropbox.com/s/4xsshq7nnlhd31h/P7_all_Data.csv?dl=0" rel="nofollow">https://www.dropbox.com/s/4xsshq7nnlhd31h/P7_all_Data.csv?dl=0</a></p>
<div class="reply">
<a aria-label="Reply to Tursun" class="comment-reply-link" href="#comment-407133" onclick='return addComment.moveForm( "comment-407133", "407133", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-407216">
<div class="comment-container" id="li-comment-407216">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 25, 2017 at 9:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-407216" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You could try a multilayer perceptron neural network.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-407216" onclick='return addComment.moveForm( "comment-407216", "407216", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-407282">
<div class="comment-container" id="li-comment-407282">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/fd033c5cbf5be2d582e8a01aed939d98?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/fd033c5cbf5be2d582e8a01aed939d98?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">tursun</span>
<span class="date">July 25, 2017 at 11:38 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-407282" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason,<br/>
I did try multi-layer perceptron. Result was good.<br/>
I want to use deep neural net of more than 3 layers.<br/>
What do you think about convolutional neural network?<br/>
I originally think it is impossible. But, now thinking about it again.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-407327">
<div class="comment-container" id="li-comment-407327">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 26, 2017 at 7:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-407327" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can do what you wish. CNNs are designed for spatial input and the iris flower dataset does not have a spatial input.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-407681">
<div class="comment-container" id="li-comment-407681">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/30c7447a3dfe064028290dcad6c3c011?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/30c7447a3dfe064028290dcad6c3c011?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Zachary</span>
<span class="date">July 28, 2017 at 6:21 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-407681" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, I want ask what is the use of Dropout, It makes the accuracy lower, so does this mean the dropout is bad for machine learning? thank you!</p>
<div class="reply">
<a aria-label="Reply to Zachary" class="comment-reply-link" href="#comment-407681" onclick='return addComment.moveForm( "comment-407681", "407681", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-407751">
<div class="comment-container" id="li-comment-407751">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 29, 2017 at 8:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-407751" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dropout can improve the performance of the model on some problems.</p>
<p>See this post on dropout:<br/>
<a href="http://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/" rel="nofollow">http://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-407751" onclick='return addComment.moveForm( "comment-407751", "407751", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-408163">
<div class="comment-container" id="li-comment-408163">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dd2ee02eb3032a6d7c292b1e87e8c1fe?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dd2ee02eb3032a6d7c292b1e87e8c1fe?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Daniel</span>
<span class="date">August 1, 2017 at 10:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-408163" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason! Great Post 🙂 Really helped me in my internship this summer. I just wanted to get your thoughts on a couple things.</p>
<p>1. I’ve trained with about 400k documents in total and I’m getting an accuracy of ~98%. I always get vary when my model does ‘too’ well. Is that a fair cause-effect due to the enormous dataset ?</p>
<p>2. When I think of CNN’ing+max_pooling word vectors(Glove), I think of the operation basically meshing the word vectors for 3 words(possibly forming like a phrase representation).Am I right in my thought process ?</p>
<p>3. I’m still a little unclear on what the LSTM learns. I understand its not a typical seq-2-seq problem, so what do those 100 LSTM units hold ? </p>
<p>Thanks so much again for the great tutorial! 🙂</p>
<div class="reply">
<a aria-label="Reply to Daniel" class="comment-reply-link" href="#comment-408163" onclick='return addComment.moveForm( "comment-408163", "408163", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-408222">
<div class="comment-container" id="li-comment-408222">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 2, 2017 at 7:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-408222" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’m glad to hear that Daniel.</p>
<p>Maybe you want to test the model on a hold out set to see if the model skill is real or overfit.</p>
<p>Something like that, pooling does good nonlinear things that may not relate back to word vectors/words cleanly.</p>
<p>They hold a function of input and prior items in the input sequence. It’s complex for sure.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-408222" onclick='return addComment.moveForm( "comment-408222", "408222", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-408844">
<div class="comment-container" id="li-comment-408844">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9bdc28bf0aa0ca6f80233c0c66f5cc97?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9bdc28bf0aa0ca6f80233c0c66f5cc97?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Amr</span>
<span class="date">August 7, 2017 at 7:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-408844" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,</p>
<p>I wonder how 100 neurons in the LSTM layer would be able to accept the 500 vectors/words? I thought that the size of the LSTM layer should be equivalent to the length of the input sequence!</p>
<div class="reply">
<a aria-label="Reply to Amr" class="comment-reply-link" href="#comment-408844" onclick='return addComment.moveForm( "comment-408844", "408844", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-408900">
<div class="comment-container" id="li-comment-408900">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 8, 2017 at 7:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-408900" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good question, no the layers do not need to have the same number of units.</p>
<p>For example, If I had a vector of length 5 as input to a single neuron, then the neuron would have 5 weights, one for each element. We do not need 5 neurons for the 5 input elements (although we could), these concerns are separate and decoupled.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-408900" onclick='return addComment.moveForm( "comment-408900", "408900", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-408924">
<div class="comment-container" id="li-comment-408924">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9bdc28bf0aa0ca6f80233c0c66f5cc97?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9bdc28bf0aa0ca6f80233c0c66f5cc97?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Amr</span>
<span class="date">August 8, 2017 at 9:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-408924" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for your reply.<br/>
But here we have already each input as a vector not a scalar! would that mean in this case that each neuron will receive 5 vectors each of them 32 dimensional? so each neuron will have 5*32=160 weights? and if so, what is the advantage of that over having every neuron process only one word/vector?</p>
<div class="reply">
<a aria-label="Reply to Amr" class="comment-reply-link" href="#comment-408924" onclick='return addComment.moveForm( "comment-408924", "408924", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-408954">
<div class="comment-container" id="li-comment-408954">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 8, 2017 at 5:09 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-408954" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>For an MLP, word vectors are concatenated as you say and each neuron gets a lot of inputs.</p>
<p>LSTMs, on the other hand, treat each word as one input in a sequence and process them one at a time.</p>
<p>The idea is called “distributed representation” where all neurons get all inputs and they selectively learn different parts to focus on. </p>
<p>This is key to neural networks.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-408954" onclick='return addComment.moveForm( "comment-408954", "408954", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-409409">
<div class="comment-container" id="li-comment-409409">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1906836624053a3ea7d8d995cc58940b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1906836624053a3ea7d8d995cc58940b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sajad</span>
<span class="date">August 12, 2017 at 6:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-409409" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
consider we have 500 sequences with 100 elements in each sequence.<br/>
if we do the embedding in a 32 dimensions vector, we will have a 100*32 matrix for each sequence.<br/>
Now assume we are using only a layer of LSTM(20) in our project. I am a bit confused in practice:</p>
<p>I know that We have a hidden layer with 20 LSTM units in parallel. I want to know how Keras gives a sequence to the model. Does it give the same 32 dimension vectors to all LSTM units at a time in order and an iteration finishes at time [t+100]? (this way I think all units give the same (copy)  value after training, and it is equivalent to having only on unit), OR it gives 32dim vectors 20 by 20 to the the model in order and iteration ends at time [t+5]?</p>
<p>Thank you in advance,<br/>
Sajad</p>
<div class="reply">
<a aria-label="Reply to Sajad" class="comment-reply-link" href="#comment-409409" onclick='return addComment.moveForm( "comment-409409", "409409", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-409464">
<div class="comment-container" id="li-comment-409464">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 13, 2017 at 9:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-409464" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good question.</p>
<p>So, the 100 time steps are passed as input to the model with 500 samples and 1 feature, something like [500, 100, 1]. </p>
<p>The Embedding will transform each time step into a 32 dimensional vector. </p>
<p>The LSTM will process the sequence one time step at a time, so one 32-dimensional embedding at a time. </p>
<p>Each memory cell will get the whole input. They all have a go at modeling the problem. An error propagated from deeper layers will encourage the hidden LSTM layer to learn the input sequence in a specific way, e.g. classify the sequence. Each cell will learn something slightly different.</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-409464" onclick='return addComment.moveForm( "comment-409464", "409464", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-409599">
<div class="comment-container" id="li-comment-409599">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1906836624053a3ea7d8d995cc58940b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1906836624053a3ea7d8d995cc58940b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sajad</span>
<span class="date">August 15, 2017 at 12:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-409599" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for your clear answer.</p>
<p>1) I am working on malware detection using LSTM, so I have malware activities in a sequence. As another question, I want to know more about Embedding layer in Keras. In my project I have to convert elements into integer numbers to feed Embedding layer of Keras. I guess Embedding is a frozen neural network layer to convert elements of a sequence to a vector in a way that relations between different elements are meaningful, Right?  I would like to know if there is any logical issue of using Embedding in my project.</p>
<p>2) Do you know any references (book, paper, website etc.) for Embedding in Keras (academic/non-academic)? I need to draw a figure describing Embedding training network.</p>
<p>Thank you for your patience,</p>
<p>Sajad</p>
<div class="reply">
<a aria-label="Reply to Sajad" class="comment-reply-link" href="#comment-409599" onclick='return addComment.moveForm( "comment-409599", "409599", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-409636">
<div class="comment-container" id="li-comment-409636">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 15, 2017 at 6:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-409636" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The Embedding has weights that are leared when you fit the model.</p>
<p>You can use pre-trained weights from a word2vec or glove run if you like. Learning custom weights for your task is often better.</p>
<p>I have a few posts scheduled on how the learned embedding layer works, that should be out next month. For now, this might be a good place for you to start:<br/>
<a href="https://en.wikipedia.org/wiki/Word_embedding" rel="nofollow">https://en.wikipedia.org/wiki/Word_embedding</a></p>
<p>The Keras Embedding layer are just weights – vectors learned for each word in the input vocab. Very simple to describe.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-409636" onclick='return addComment.moveForm( "comment-409636", "409636", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-409719">
<div class="comment-container" id="li-comment-409719">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1906836624053a3ea7d8d995cc58940b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1906836624053a3ea7d8d995cc58940b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sajad</span>
<span class="date">August 15, 2017 at 11:16 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-409719" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Jason.<br/>
That’s great, I am waiting for your posts on embedding.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-409756">
<div class="comment-container" id="li-comment-409756">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 16, 2017 at 6:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-409756" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Sajad.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-409724">
<div class="comment-container" id="li-comment-409724">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c7b425d7fbf2b07b8c44c46e66ccc079?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c7b425d7fbf2b07b8c44c46e66ccc079?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Saho</span>
<span class="date">August 16, 2017 at 12:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-409724" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason, this post was great for me.<br/>
As a question I would like to know how to set the number of LSTM units in the hidden layer?</p>
<p>Is there any relationships between the number of samples (sequences) and the number of hidden units? </p>
<p>I have 400 sequences with 5000 element in each. How many LSTM units should I use? I know that I should test model with different number of hidden units but I am looking for an upperbound and lowerbound for number hidden units.</p>
<p>saho,</p>
<div class="reply">
<a aria-label="Reply to Saho" class="comment-reply-link" href="#comment-409724" onclick='return addComment.moveForm( "comment-409724", "409724", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-409759">
<div class="comment-container" id="li-comment-409759">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 16, 2017 at 6:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-409759" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>There is no analytical way to configure a neural network. I recommend trial and error, grid search, random search or copy configurations from other models.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-409759" onclick='return addComment.moveForm( "comment-409759", "409759", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-410101">
<div class="comment-container" id="li-comment-410101">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/31d9820d11de056cde81c4533dbfbc9a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/31d9820d11de056cde81c4533dbfbc9a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Maddy</span>
<span class="date">August 18, 2017 at 5:17 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-410101" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>great work ! what if i want to apply this code on simple sentence sequence classification. how can we do that? how we are going to  manipulate the data<br/>
.</p>
<p>thank you</p>
<div class="reply">
<a aria-label="Reply to Maddy" class="comment-reply-link" href="#comment-410101" onclick='return addComment.moveForm( "comment-410101", "410101", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-410172">
<div class="comment-container" id="li-comment-410172">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 19, 2017 at 5:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-410172" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure.</p>
<p>I would recommend spending time cleaning the data, then integer encode it ready for the model. I recommend an embedding layer on the front of the model.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-410172" onclick='return addComment.moveForm( "comment-410172", "410172", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-410588">
<div class="comment-container" id="li-comment-410588">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/aaeb7816fcfec86563e7b400932cb71f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/aaeb7816fcfec86563e7b400932cb71f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Maddy</span>
<span class="date">August 22, 2017 at 8:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-410588" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thank you … how can i replace imdb data with my own data that is composed of simple sentences? and how can i change the program accordingly?</p>
<div class="reply">
<a aria-label="Reply to Maddy" class="comment-reply-link" href="#comment-410588" onclick='return addComment.moveForm( "comment-410588", "410588", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-410656">
<div class="comment-container" id="li-comment-410656">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 23, 2017 at 6:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-410656" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Load the text data, clean the text data, then encode your words as integers.</p>
<p>See the Keras Tokenizer as a start:<br/>
<a href="https://keras.io/preprocessing/text/#tokenizer" rel="nofollow">https://keras.io/preprocessing/text/#tokenizer</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-410656" onclick='return addComment.moveForm( "comment-410656", "410656", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-410898">
<div class="comment-container" id="li-comment-410898">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0a6c98eeeda9a8d8c5d0b4b4f973f603?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0a6c98eeeda9a8d8c5d0b4b4f973f603?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://-" rel="external nofollow">Irati</a></span>
<span class="date">August 24, 2017 at 5:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-410898" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason! First thanks for your amazing web!</p>
<p>And now comes the question: In my case I am trying to solve a task classification problem. Each task is described by 57 time series with 74 time steps each. For the training phase I do have 100 task examples of 10 different classes.</p>
<p>This way, I have created a [100,74,57] input and a [100,1] output with the label for each task. </p>
<p>This is, I have a multivariate time series to multilabel classification problem. </p>
<p>What type of learning structure would you suggest? I am aware that I may need to collect/generate more data but I am new both in python and deep learning and I am having some trouble creating a small running example for multivariate ts -&gt; multilabel classification.</p>
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Irati" class="comment-reply-link" href="#comment-410898" onclick='return addComment.moveForm( "comment-410898", "410898", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-410986">
<div class="comment-container" id="li-comment-410986">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 25, 2017 at 6:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-410986" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>For multi-class classification, you will need a one hot encoding of your output variable so the dimensions will be [100,10] and then use a softmax activation function in the output layer to predict the outcome probability across all 10 classes.</p>
<p>For the specific model, try MLPs with sliding window, then maybe some RNNs like LSTMs to see if they can do better.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-410986" onclick='return addComment.moveForm( "comment-410986", "410986", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-411080">
<div class="comment-container" id="li-comment-411080">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f40067945bead7bb1fc08b4c7efbbdc4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f40067945bead7bb1fc08b4c7efbbdc4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Cloud</span>
<span class="date">August 25, 2017 at 4:49 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-411080" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for your tutorial. My problem is classfication a packet (is captured everytime with many features) whether normal or abnormal. I would like to adapt LSTM to my own problem. My data are matrixes: X_train(4000,41), Y_train(4000,1), X_test(1000,41), Y_test(1000,1) – Y is label. One of 41 feature is time, others are input variables. I think, I have to extract time feature from 41 features, is it correct. Is this process in Keras?<br/>
First, I am confusing how to reshape my data in a meaningful way so that it meets the requirements of the inputs of LSTM layer. I expect my data like this:<br/>
x_train.shape = (4000,1,41) #simple, I set time step=1, later it will be changed &gt; 1 to classify from many packets in time step<br/>
y_train.shape = (4000,1,1)<br/>
How to transform my data to structure above?<br/>
Second, I think, the Embedding layer is not suitable to my problems, is it right?. My model is built:<br/>
model = Sequential()<br/>
model.add(LSTM(64, input_dim=41, input_length=41) # ex, 64 LSTM unints<br/>
model.add(Dense(1, activation=’sigmoid’))<br/>
model.compile(loss=’binary_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])<br/>
model.fit(X_train, Y_train, epochs=20, batch_size=100)<br/>
I’m new to LSTM, Can you give any advice for my problem. Thank you very much</p>
<div class="reply">
<a aria-label="Reply to Cloud" class="comment-reply-link" href="#comment-411080" onclick='return addComment.moveForm( "comment-411080", "411080", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-411164">
<div class="comment-container" id="li-comment-411164">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 26, 2017 at 6:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-411164" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It sounds like you have 40K time steps, these would then need to be split into sub-sequences of 100 samples of 400 time steps.</p>
<p>You would then have input like: [100, 400, 41].<br/>
The input shape would be (400, 41).</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-411164" onclick='return addComment.moveForm( "comment-411164", "411164", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-411324">
<div class="comment-container" id="li-comment-411324">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f40067945bead7bb1fc08b4c7efbbdc4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f40067945bead7bb1fc08b4c7efbbdc4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Cloud</span>
<span class="date">August 27, 2017 at 12:02 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-411324" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason. That means batch_size=100. Right? I can have my first layer like this:<br/>
model.add(LSTM(64, input_dim=41, input_length=400) #hidden 1: 64<br/>
Or:<br/>
model.add(LSTM(64, batch_input_shape=(100, 1, 41), stateful=True))<br/>
Which one is correct? How to set time_step in the first code line.<br/>
Can you help me fix that?. Many thanks</p>
<div class="reply">
<a aria-label="Reply to Cloud" class="comment-reply-link" href="#comment-411324" onclick='return addComment.moveForm( "comment-411324", "411324", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-411426">
<div class="comment-container" id="li-comment-411426">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 28, 2017 at 6:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-411426" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can set the shape of your data in terms of time steps (x) and features (y) like this:</p>
<p>input_shape=(x, y)</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-411426" onclick='return addComment.moveForm( "comment-411426", "411426", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-412037">
<div class="comment-container" id="li-comment-412037">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f40067945bead7bb1fc08b4c7efbbdc4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f40067945bead7bb1fc08b4c7efbbdc4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Cloud</span>
<span class="date">September 1, 2017 at 1:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-412037" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for your enthusiasm,</p>
<p>I try to build model with my data that I follow your comments, but I get errors:<br/>
timesteps=2<br/>
train_x=np.array([train_x[i:i+timesteps] for i in range(len(train_x)-timesteps)]) #train_x.shape=(119998, 2, 41)<br/>
train_y=np.array([train_y[i:i+timesteps] for i in range(len(train_y)-timesteps)]) #train_y.shape=(119998, 2, 1)</p>
<p>input_dim=41 #features<br/>
#1.define the network<br/>
model=Sequential()<br/>
model.add(LSTM(100,input_shape=(timesteps,input_dim)))<br/>
model.add(Dense(1,activation=’sigmoid’))<br/>
#2. compile the network<br/>
model.compile(loss=’binary_crossentropy’,optimizer=’adam’,metrics=[‘accuracy’])<br/>
#3. fit the model<br/>
model.fit(train_x,train_y, epochs=100, batch_size=10,)</p>
<p>Error:<br/>
 File “test_data.py”, line 53, in<br/>
    model.fit(train_x,train_y, nb_epoch=100, batch_size=10,)<br/>
  File “/home/keras/models.py”, line 870, in fit<br/>
    initial_epoch=initial_epoch)<br/>
  File “/home/keras/engine/training.py”, line 1435, in fit<br/>
    batch_size=batch_size)<br/>
  File “/home/keras/engine/training.py”, line 1315, in _standardize_user_data<br/>
    exception_prefix=’target’)<br/>
  File “/home/engine/training.py”, line 127, in _standardize_input_data<br/>
    str(array.shape))<br/>
ValueError: Error when checking target: expected dense_1 to have 2 dimensions, but got array with shape (119998, 2, 1)<br/>
May be I have problem with ouput shape? how can I fix?<br/>
Thank you</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-412046">
<div class="comment-container" id="li-comment-412046">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 1, 2017 at 3:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-412046" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The output of your network expects 1 feature. Reshape y to be (119998, 1).</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-5" id="comment-412043">
<div class="comment-container" id="li-comment-412043">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f40067945bead7bb1fc08b4c7efbbdc4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f40067945bead7bb1fc08b4c7efbbdc4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Cloud</span>
<span class="date">September 1, 2017 at 3:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-412043" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
I replaced my output shape to:<br/>
train_y=np.array(train_y[:119998) #train_y.shape=(119998, 1)</p>
<p>Finally, it works!</p>
<p>I have more question, Do Keras support for implementation on GPU?</p>
<p>Thanks</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-412047">
<div class="comment-container" id="li-comment-412047">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 1, 2017 at 3:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-412047" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Glad to hear that.</p>
<p>Keras runs on top of Theano and TensorFlow. These underlying math libraries provide support for GPUs.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-5" id="comment-413671">
<div class="comment-container" id="li-comment-413671">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f40067945bead7bb1fc08b4c7efbbdc4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f40067945bead7bb1fc08b4c7efbbdc4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">cloudy</span>
<span class="date">September 13, 2017 at 4:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-413671" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason.</p>
<p>I think that maybe I was wrong when preparing input data to LSTM.<br/>
I have input and label like this: train_x(4000,41) and train_y(4000,1)<br/>
Before, I used:<br/>
timesteps=2<br/>
train_x=np.array([train_x[i:i+timesteps] for i in range(len(train_x)-timesteps)]) #train_x.shape=(119998, 2, 41)<br/>
train_y=np.array(train_y[:119998) #train_y.shape=(119998, 1)</p>
<p>===&gt; It is wrong because rows are overlapped and train_y maybe taken wrong</p>
<p> Now, I correct like this:<br/>
train_x = reshape(int(train_x.shape[0]/timesteps), timesteps, train_x.shape[1])</p>
<p>In my data, each instance has multiple features so I want to keep features as it is, means multiple features in the same time.<br/>
Help me correct my misunderstand about input data<br/>
train_y = reshape(int(train_y.shape[0]/timesteps), train_y.shape[1]) # error: IndexError: tuple index out of range ???<br/>
And I concern the time feature is or is not included in input data (because I read a post: <a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" rel="nofollow">https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/</a>).<br/>
I read many your articles in machinelearningmastery.com, so I maybe confused</p>
<p>Many thanks</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-413871">
<div class="comment-container" id="li-comment-413871">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 15, 2017 at 11:58 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-413871" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I’m not sure I follow your sequence prediction problem.</p>
<p>Can you give me a small example, e.g. one sample?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="comment-413920">
<div class="comment-container" id="li-comment-413920">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f40067945bead7bb1fc08b4c7efbbdc4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f40067945bead7bb1fc08b4c7efbbdc4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">cloudy</span>
<span class="date">September 15, 2017 at 2:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-413920" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>My data has n packets, each packet has many features f (one of them is time), example:<br/>
          f1 f2 f3 … label<br/>
pkt1   2  3  3	    0<br/>
pkt2   1  3  5	    1<br/>
pkt3   2  3  2	    1<br/>
pkt4   5  3  1	    0<br/>
pkt5   5  3  2	   1<br/>
….<br/>
ex: timesteps=2, each subsequence has 2 rows. After shape, like these:<br/>
[[[2  3  3  0]<br/>
  [3  5  1  1]]<br/>
 [[3  5  1  1]<br/>
  [2  3  2  1]]<br/>
….              ]<br/>
or: separate:<br/>
[[[2  3  3  0]<br/>
  [3  5  1  1]]<br/>
 [[2  3  2  1]<br/>
  [5  3  1  0]]<br/>
…                ]<br/>
When split label from that input data. I see if timesteps=1, label will match to every rows, easy to get. But if timesteps &gt;1, which label will be taken for matching to each subsequence (on 1st row or 2nd row).<br/>
Can you help me clear that confusion? (2 questions: overlap or separate? and get label)<br/>
Many thanks</p>
<div class="reply">
<a aria-label="Reply to cloudy" class="comment-reply-link" href="#comment-413920" onclick='return addComment.moveForm( "comment-413920", "413920", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-413989">
<div class="comment-container" id="li-comment-413989">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 16, 2017 at 8:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-413989" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps this post will help you prepare your data:<br/>
<a href="https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/" rel="nofollow">https://machinelearningmastery.com/convert-time-series-supervised-learning-problem-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-413989" onclick='return addComment.moveForm( "comment-413989", "413989", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-414168">
<div class="comment-container" id="li-comment-414168">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f40067945bead7bb1fc08b4c7efbbdc4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f40067945bead7bb1fc08b4c7efbbdc4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">cloudy</span>
<span class="date">September 18, 2017 at 9:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-414168" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason.<br/>
I know that post. That  means preparing data for prediction model and classification model is the same?</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-414232">
<div class="comment-container" id="li-comment-414232">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 19, 2017 at 7:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-414232" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The approach will help with preparing sequence data in general, not just time series.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-5" id="comment-414368">
<div class="comment-container" id="li-comment-414368">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f40067945bead7bb1fc08b4c7efbbdc4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f40067945bead7bb1fc08b4c7efbbdc4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">cloudy</span>
<span class="date">September 20, 2017 at 6:11 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-414368" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason<br/>
After considering carefully about preparing data for LSTM in Keras. I realise that term “feature” doesn’t mean its original meaning (also know as attributes, fields in dataset),  actually it is the number of columns after converting multivariate Time Series into supervised learning data. It is based on real features and look_back, calculated as real_feature multiplied by look_back. Am i right?<br/>
I followed <a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" rel="nofollow">https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/</a><br/>
.<br/>
Thanks Jason and machinelearningmastery.com</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-414408">
<div class="comment-container" id="li-comment-414408">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 21, 2017 at 5:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-414408" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>In time series, parallel series would be “features” and lag observations for one series would be time steps for the LSTM.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-411364">
<div class="comment-container" id="li-comment-411364">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3fc47c62333c4a9d182ec13b4d290292?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3fc47c62333c4a9d182ec13b4d290292?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Irfan</span>
<span class="date">August 27, 2017 at 5:47 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-411364" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, nice article. I have one question though. what changes I have to make to do multi-class classification instead of binary classification?</p>
<div class="reply">
<a aria-label="Reply to Irfan" class="comment-reply-link" href="#comment-411364" onclick='return addComment.moveForm( "comment-411364", "411364", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-411428">
<div class="comment-container" id="li-comment-411428">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 28, 2017 at 6:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-411428" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good question.</p>
<p>Change the output layer to have one neuron per class, change the activation function to be softmax on the output layer and change the loss function to be categorical_crossentropy.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-411428" onclick='return addComment.moveForm( "comment-411428", "411428", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-411814">
<div class="comment-container" id="li-comment-411814">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3fc47c62333c4a9d182ec13b4d290292?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3fc47c62333c4a9d182ec13b4d290292?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Irfan</span>
<span class="date">August 31, 2017 at 1:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-411814" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for nice reply. One last question, can I use negative values for LSTM and CNN? I have some data, one of the column has both positive and negative values. How to handle this? Thanks in advance.</p>
<div class="reply">
<a aria-label="Reply to Irfan" class="comment-reply-link" href="#comment-411814" onclick='return addComment.moveForm( "comment-411814", "411814", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-411848">
<div class="comment-container" id="li-comment-411848">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 31, 2017 at 6:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-411848" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes.</p>
<p>Generally, I would encourage you to rescale data to the range 0-1 prior to passing it to an LSTM layer.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-411848" onclick='return addComment.moveForm( "comment-411848", "411848", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-411816">
<div class="comment-container" id="li-comment-411816">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/23d59b2cbbc013795b7a44b5d984d554?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/23d59b2cbbc013795b7a44b5d984d554?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Marco Cheung</span>
<span class="date">August 31, 2017 at 2:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-411816" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>It seems that I encounter a problem with the line “model.add(LSTM(100))” (OS: MAC)</p>
<p>Here is the TypeError: Expected int32, got  of type ‘Variable’ instead.</p>
<p>Thank you very much !!!!!!!</p>
<div class="reply">
<a aria-label="Reply to Marco Cheung" class="comment-reply-link" href="#comment-411816" onclick='return addComment.moveForm( "comment-411816", "411816", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-411849">
<div class="comment-container" id="li-comment-411849">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 31, 2017 at 6:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-411849" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>That is a strange error, are you sure it is on that line? It does not make sense.</p>
<p>Perhaps ensure you have copied all of the lines and that you have the correct spacing/indenting?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-411849" onclick='return addComment.moveForm( "comment-411849", "411849", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-411905">
<div class="comment-container" id="li-comment-411905">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/935edc2d12c651a944e1cb72f17a37cd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/935edc2d12c651a944e1cb72f17a37cd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sarada Okazaki</span>
<span class="date">August 31, 2017 at 4:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-411905" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thanks for your post. it’s really helpful. </p>
<p>I have some questions, hope you help out.<br/>
1. I’m trying to classify intents for a data set containing comments from user. There are several intents corresponding to comments. But the language in my case is not English. So I understand that I have to build the data set to be similar to imdb’s one. But how can I do it. Do you have any instruction/guidelines to build data set like that. </p>
<p>2. Aside from data set, I think that I also have to build embedding vector for my own language. How can I do that. </p>
<p>Thank you in advanced. Hope to hearing from you soon.</p>
<div class="reply">
<a aria-label="Reply to Sarada Okazaki" class="comment-reply-link" href="#comment-411905" onclick='return addComment.moveForm( "comment-411905", "411905", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-411988">
<div class="comment-container" id="li-comment-411988">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 1, 2017 at 6:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-411988" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I should have some posts on this soon.</p>
<p>Generally, you need to clean the data (punctuation, case, vocab), then integer encode it for use with a word embedding. See Keras’ Tokenizer class as a good start.</p>
<p>The Embedding layer will learn the weights for your data. You can try to train a word2vec model and use the pre-trained weights to get better performance, but I’d recommend starting with a learned embedding layer as a first step.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-411988" onclick='return addComment.moveForm( "comment-411988", "411988", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-412763">
<div class="comment-container" id="li-comment-412763">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/095516c465a3b0be8bd1fb4a2ec3a921?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/095516c465a3b0be8bd1fb4a2ec3a921?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex</span>
<span class="date">September 5, 2017 at 11:25 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-412763" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, Jason,<br/>
Thank you for the great post.</p>
<p>Google has it’s NLP API: <a href="https://cloud.google.com/natural-language/docs/basics" rel="nofollow">https://cloud.google.com/natural-language/docs/basics</a></p>
<p>You could admit that they give us a polarity of sentiment in the range of (-1, 1). The call it “score”.</p>
<p>Maybe you have a quick idea about how to do the same output using Keras while sentiment analysis?<br/>
As I understand this is not a classifier problem anymore. Any thoughts?</p>
<div class="reply">
<a aria-label="Reply to Alex" class="comment-reply-link" href="#comment-412763" onclick='return addComment.moveForm( "comment-412763", "412763", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-412955">
<div class="comment-container" id="li-comment-412955">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 7, 2017 at 12:46 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-412955" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure, I have a few posts scheduled on this topic for later in the month/next month.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-412955" onclick='return addComment.moveForm( "comment-412955", "412955", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-413293">
<div class="comment-container" id="li-comment-413293">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0887e35e7a67e720228622e204567c49?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0887e35e7a67e720228622e204567c49?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Don</span>
<span class="date">September 10, 2017 at 2:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-413293" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Oops, I sent my reply to the wrong post. Sorry. I fixed it.</p>
<div class="reply">
<a aria-label="Reply to Don" class="comment-reply-link" href="#comment-413293" onclick='return addComment.moveForm( "comment-413293", "413293", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-413378">
<div class="comment-container" id="li-comment-413378">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1906836624053a3ea7d8d995cc58940b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1906836624053a3ea7d8d995cc58940b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sajad</span>
<span class="date">September 11, 2017 at 12:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-413378" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>thank you for your nice work in this website.</p>
<p>My question: In what cases RNN works better than LSTM? I know that LSTM is originated from RNN and attempts to eliminate the problem of vanishing gradient in RNN.. BUT in my case I am using malware behavioral sequence and I got this chart for TPR and FPR: <a href="https://imgur.com/fnYxGwK" rel="nofollow">https://imgur.com/fnYxGwK</a> , the figures show TPR and FPR for different number of units in hidden layer.</p>
<p>Do you know why RNN works better in my project?</p>
<div class="reply">
<a aria-label="Reply to Sajad" class="comment-reply-link" href="#comment-413378" onclick='return addComment.moveForm( "comment-413378", "413378", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-413433">
<div class="comment-container" id="li-comment-413433">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 11, 2017 at 12:08 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-413433" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>An LSTM is a type of RNN.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-413433" onclick='return addComment.moveForm( "comment-413433", "413433", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-413492">
<div class="comment-container" id="li-comment-413492">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7315f5e714b31e4395ab12b65425d364?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7315f5e714b31e4395ab12b65425d364?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rishi</span>
<span class="date">September 11, 2017 at 11:40 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-413492" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>First off, great tutorial.  Love the overall content that you provide.  </p>
<p>I am working through a categorical classification task that involves evaluating a feature that can go as long as 27500 words.  My problem is that there are other features that I need to feed into my RNN-LSTM as well. I had thought about combining the long text feature and the other features into one files – features separated by columns of course  but I don’t think that will work?  Instead, I was think to separate the long text feature into its own file and run that independently through the RNN and then take the other features  Can you give me some pointers on how I can go about designed the layers for this challenge I’m facing?</p>
<div class="reply">
<a aria-label="Reply to Rishi" class="comment-reply-link" href="#comment-413492" onclick='return addComment.moveForm( "comment-413492", "413492", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-413636">
<div class="comment-container" id="li-comment-413636">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 13, 2017 at 12:24 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-413636" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You will need to split up your sequence into subsequences of 200-400 time steps max.</p>
<p>I give ideas here:<br/>
<a href="https://machinelearningmastery.com/handle-long-sequences-long-short-term-memory-recurrent-neural-networks/" rel="nofollow">https://machinelearningmastery.com/handle-long-sequences-long-short-term-memory-recurrent-neural-networks/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-413636" onclick='return addComment.moveForm( "comment-413636", "413636", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-414100">
<div class="comment-container" id="li-comment-414100">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9487ea81590db89325b4c7162eb2a4f2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9487ea81590db89325b4c7162eb2a4f2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Lin Li</span>
<span class="date">September 17, 2017 at 1:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-414100" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,Dr. Jason Brownlee. Thanks for your amazing web. I’m a start-learner on deep learning. I copy your code and run it, and I encounter a problem when loading imdb dataset. The messages are as follows:</p>
<p>Traceback (most recent call last):<br/>
  File “F:\Study\0-MyProject\Test\SimpleLSTM.py”, line 13, in<br/>
    (X_train, y_train),(X_test, y_test) = imdb.load_data(num_words = top_words)<br/>
  File “C:\Users\llfor\AppData\Local\Programs\Python\Python35\lib\site-packages\keras\datasets\imdb.py”, line 51, in load_data<br/>
    path = get_file(path, origin=’https://s3.amazonaws.com/text-datasets/imdb.npz’)<br/>
  File “C:\Users\llfor\AppData\Local\Programs\Python\Python35\lib\site-packages\keras\utils\data_utils.py”, line 220, in get_file<br/>
    urlretrieve(origin, fpath, dl_progress)<br/>
  File “C:\Users\llfor\AppData\Local\Programs\Python\Python35\lib\urllib\request.py”, line 217, in urlretrieve<br/>
    block = fp.read(bs)<br/>
  File “C:\Users\llfor\AppData\Local\Programs\Python\Python35\lib\http\client.py”, line 448, in read<br/>
    n = self.readinto(b)<br/>
  File “C:\Users\llfor\AppData\Local\Programs\Python\Python35\lib\http\client.py”, line 488, in readinto<br/>
    n = self.fp.readinto(b)<br/>
  File “C:\Users\llfor\AppData\Local\Programs\Python\Python35\lib\socket.py”, line 575, in readinto<br/>
    return self._sock.recv_into(b)<br/>
  File “C:\Users\llfor\AppData\Local\Programs\Python\Python35\lib\ssl.py”, line 929, in recv_into<br/>
    return self.read(nbytes, buffer)<br/>
  File “C:\Users\llfor\AppData\Local\Programs\Python\Python35\lib\ssl.py”, line 791, in read<br/>
    return self._sslobj.read(len, buffer)<br/>
  File “C:\Users\llfor\AppData\Local\Programs\Python\Python35\lib\ssl.py”, line 575, in read<br/>
    v = self._sslobj.read(len, buffer)<br/>
TimeoutError: [WinError 10060] 由于连接方在一段时间后没有正确答复或连接的主机没有反应，连接尝试失败。</p>
<p>Besides, sometimes it just said “fetch failure on <a href="https://s3.amazonaws.com/text-datasets/imdb.npz" rel="nofollow">https://s3.amazonaws.com/text-datasets/imdb.npz</a>“.<br/>
Is it because imdb data source is not available or network is instability?<br/>
Actually I have manually downloaded the data from <a href="https://s3.amazonaws.com/text-datasets/imdb.npz" rel="nofollow">https://s3.amazonaws.com/text-datasets/imdb.npz</a>.<br/>
So if I cannot load the data online, how can I deal with the data I’ve downloaded manually to use it?<br/>
I’ve try another code to load data: (X_train, y_train),(X_test, y_test) = imdb.load_data(path = “imdb_full.pkl”), and it’s not work neither.<br/>
I’m looking forward to your reply. Thanks again!</p>
<div class="reply">
<a aria-label="Reply to Lin Li" class="comment-reply-link" href="#comment-414100" onclick='return addComment.moveForm( "comment-414100", "414100", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-414151">
<div class="comment-container" id="li-comment-414151">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 18, 2017 at 5:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-414151" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Looks like you might be having an internet connection issue.</p>
<p>Try deleting the half downloaded file in ~/.keras/datasets/ (if present) and try again.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-414151" onclick='return addComment.moveForm( "comment-414151", "414151", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-414375">
<div class="comment-container" id="li-comment-414375">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9487ea81590db89325b4c7162eb2a4f2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9487ea81590db89325b4c7162eb2a4f2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Lin Li</span>
<span class="date">September 20, 2017 at 11:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-414375" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for your reply. Now I can load the dataset. I still have two questions and need your help:<br/>
(1) You mentioned that we can “reproduce the results” by using the code “numpy.random.seed(7)”, but I still got different accuracies every time. Is that right that how I understood the code “numpy.random.seed(7)”?<br/>
(2) The results I have got are always about 50.6%, which is lower than yours. Why is there so big gap?<br/>
Thank you, and I’m looking forward to your reply~</p>
<div class="reply">
<a aria-label="Reply to Lin Li" class="comment-reply-link" href="#comment-414375" onclick='return addComment.moveForm( "comment-414375", "414375", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-414410">
<div class="comment-container" id="li-comment-414410">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 21, 2017 at 5:39 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-414410" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps this post will help with reproducibility:<br/>
<a href="https://machinelearningmastery.com/reproducible-results-neural-networks-keras/" rel="nofollow">https://machinelearningmastery.com/reproducible-results-neural-networks-keras/</a></p>
<p>Sorry to hear that, generally neural networks are stochastic, the best way to evaluate them is this process:<br/>
<a href="https://machinelearningmastery.com/evaluate-skill-deep-learning-models/" rel="nofollow">https://machinelearningmastery.com/evaluate-skill-deep-learning-models/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-414410" onclick='return addComment.moveForm( "comment-414410", "414410", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-414448">
<div class="comment-container" id="li-comment-414448">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a5fcbc9ca1140ea434bb446970e1ee13?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a5fcbc9ca1140ea434bb446970e1ee13?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sara</span>
<span class="date">September 21, 2017 at 6:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-414448" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason, </p>
<p>This is an amazing post. I’m very new to nnets and now I have a question.<br/>
I do not understand the why you have picked LSTM and RNN for this semantic analysis. to be clear I don’t understand where the sequential part that allow us to use RNN and LSTM.<br/>
I’m wondering if you could explain this.<br/>
I also want to know if we can use LSTM for entity extraction (NLP) and where is a good data set to train our model.</p>
<div class="reply">
<a aria-label="Reply to Sara" class="comment-reply-link" href="#comment-414448" onclick='return addComment.moveForm( "comment-414448", "414448", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-414485">
<div class="comment-container" id="li-comment-414485">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 22, 2017 at 5:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-414485" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure, check out this post on sequence prediction<br/>
<a href="https://machinelearningmastery.com/sequence-prediction/" rel="nofollow">https://machinelearningmastery.com/sequence-prediction/</a></p>
<p>Also check this post on the promise of RNNs:<br/>
<a href="https://machinelearningmastery.com/promise-recurrent-neural-networks-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/promise-recurrent-neural-networks-time-series-forecasting/</a></p>
<p>I’m sure LSTMs can be used for entity extraction, I do not have an example. My advice would be to search google scholar.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-414485" onclick='return addComment.moveForm( "comment-414485", "414485", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-414697">
<div class="comment-container" id="li-comment-414697">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7315f5e714b31e4395ab12b65425d364?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7315f5e714b31e4395ab12b65425d364?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">max</span>
<span class="date">September 24, 2017 at 9:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-414697" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Would Feature Scaling help in this case as well?  As the reviews are tokenized, the values can go from low to high depending the max number of words used.</p>
<div class="reply">
<a aria-label="Reply to max" class="comment-reply-link" href="#comment-414697" onclick='return addComment.moveForm( "comment-414697", "414697", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-414746">
<div class="comment-container" id="li-comment-414746">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 25, 2017 at 5:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-414746" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-414746" onclick='return addComment.moveForm( "comment-414746", "414746", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-414816">
<div class="comment-container" id="li-comment-414816">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/77dcfed9f77e9ee8f14dd0c39d1a208a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/77dcfed9f77e9ee8f14dd0c39d1a208a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ziqi</span>
<span class="date">September 26, 2017 at 6:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-414816" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for sharing both the model and the code also your enthusiasm in answering all the questions. I built my model for sentence classification based on your cnn+lstm one and it is working well. I am relatively new to neural nets and hence I am trying to learn to interpret how different layer interact, specifically, what is the data shape like. So, given the example above, suppose our dataset has 1000 movie reviews, using a batch size of 64, for each batch, please correct me:</p>
<p>embedding layer: OUTPUT – 64 (sample size) x 500 (words) x 32 (features per word)<br/>
conv1d: INPUT – as above; OUTPUT – for *each word*, 32 feature maps x (32/3) features, where 3 is kernel size.<br/>
maxpooling1d: INPUT – as above; OUTPUT – for *each word*, and for *each feature map*, a 32/3/2 feature vector<br/>
lstm: INPUT –  this is where I struggle to understand… 64 is the sample size, 500 is the steps, so should be 64 x 500 x FEATURES, but is FEATURES=32/3/2, or 32 x (32/3/2) where the first 32 is the feature maps from conv1d?<br/>
OUTPUT – for *each sample*, a 100-dim feature vector</p>
<div class="reply">
<a aria-label="Reply to Ziqi" class="comment-reply-link" href="#comment-414816" onclick='return addComment.moveForm( "comment-414816", "414816", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-414841">
<div class="comment-container" id="li-comment-414841">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 26, 2017 at 2:58 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-414841" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sounds good.</p>
<p>I would encourage you to try a suite of models on your problem to see what works best.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-414841" onclick='return addComment.moveForm( "comment-414841", "414841", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-415014">
<div class="comment-container" id="li-comment-415014">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/260b898ad067e41fc9ebb36d38ee0930?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/260b898ad067e41fc9ebb36d38ee0930?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Oshin Patwa</span>
<span class="date">September 28, 2017 at 7:36 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-415014" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, read your blog found it really help full however could you please guide me to a code sample as to how exactly hot encode my text for training, I have 20,000 reviews to train.<br/>
Or can i just using hashing technique where every word is signifying an integer?<br/>
So something like ;<br/>
I find the store good.<br/>
I find good.</p>
<p>Is represented as ;<br/>
1 2 3 4 5<br/>
1 2 5</p>
<p>As representing every character with an integer would be exhaustive i think!<br/>
And then i can probably run the further steps for padding e.t.c?<br/>
In this case how will i predict new sentences having some new words?<br/>
(which makes me re think should i assign every character to an integer) if so could you please show me a sample?</p>
<div class="reply">
<a aria-label="Reply to Oshin Patwa" class="comment-reply-link" href="#comment-415014" onclick='return addComment.moveForm( "comment-415014", "415014", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415041">
<div class="comment-container" id="li-comment-415041">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 29, 2017 at 5:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-415041" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I recommend using an integer encoding for text. </p>
<p>Further, you can count the occurrence of each word, and reduce the size of the vocabulary to only the most frequent words.</p>
<p>I will have posts on how to do this on the blog soon.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-415041" onclick='return addComment.moveForm( "comment-415041", "415041", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-415124">
<div class="comment-container" id="li-comment-415124">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/236a49e0b91ead97e45054264dd38e80?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/236a49e0b91ead97e45054264dd38e80?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Trialcritic</span>
<span class="date">September 30, 2017 at 2:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-415124" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I tried to create a model for text summarization in seq2seq with keras. Did not work well. The prediction shows the top words by frequency. I tried blacklisting the top words in english (‘a’, ‘an’, ‘the’ etc). The results were still not good. Some said that in 2016 that keras was not good for text summarization then. Wonder what is missing.</p>
<div class="reply">
<a aria-label="Reply to Trialcritic" class="comment-reply-link" href="#comment-415124" onclick='return addComment.moveForm( "comment-415124", "415124", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415170">
<div class="comment-container" id="li-comment-415170">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 30, 2017 at 7:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-415170" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It is a hard problems that requires at least 1M examples and a large model.</p>
<p>I have a tutorial on text summarization scheduled for around Christmas.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-415170" onclick='return addComment.moveForm( "comment-415170", "415170", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-415335">
<div class="comment-container" id="li-comment-415335">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7c8460bc85f0bdaa6278488d56b20510?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7c8460bc85f0bdaa6278488d56b20510?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ASAD</span>
<span class="date">October 2, 2017 at 3:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-415335" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello sir i am asad. i want to know how to load data set which is in .text file and text data of movie review. then how i can use it in recurrent neural network?<br/>
 please tell me the complete procedure. remember data i have is locally in my computer</p>
<div class="reply">
<a aria-label="Reply to ASAD" class="comment-reply-link" href="#comment-415335" onclick='return addComment.moveForm( "comment-415335", "415335", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415368">
<div class="comment-container" id="li-comment-415368">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 3, 2017 at 5:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-415368" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This post will show you how to encode the text for use with an LSTM:<br/>
<a href="https://machinelearningmastery.com/prepare-text-data-deep-learning-keras/" rel="nofollow">https://machinelearningmastery.com/prepare-text-data-deep-learning-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-415368" onclick='return addComment.moveForm( "comment-415368", "415368", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-415640">
<div class="comment-container" id="li-comment-415640">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/dad074fbc941e8f007a67797c65a72e9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/dad074fbc941e8f007a67797c65a72e9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Gili</span>
<span class="date">October 5, 2017 at 2:43 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-415640" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>Thanks for the post. I just applied this approach in our use case which is quite similar to movie review sentiment classification. The accuracy of the model is very good ~94%.</p>
<p>BUT</p>
<p>I replaced all the frequency with random numbers and to my surprise the accuracy is still very good. (~94). The labels are the same as well.</p>
<p>Do you have any idea about this?<br/>
Thanks,</p>
<div class="reply">
<a aria-label="Reply to Gili" class="comment-reply-link" href="#comment-415640" onclick='return addComment.moveForm( "comment-415640", "415640", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415657">
<div class="comment-container" id="li-comment-415657">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 5, 2017 at 5:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-415657" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>What do you mean exactly, I don’t follow what you changed?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-415657" onclick='return addComment.moveForm( "comment-415657", "415657", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-415760">
<div class="comment-container" id="li-comment-415760">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/be304c559bff531e29c7ebaea1aec57e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/be304c559bff531e29c7ebaea1aec57e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Argie</span>
<span class="date">October 6, 2017 at 3:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-415760" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hey Jason,</p>
<p>amazing work and so up to date. </p>
<p>I would like to ask you, do you think this sequence classification model could be used to predict a category for a really large sequence of numbers, instead of words ??</p>
<div class="reply">
<a aria-label="Reply to Argie" class="comment-reply-link" href="#comment-415760" onclick='return addComment.moveForm( "comment-415760", "415760", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-415772">
<div class="comment-container" id="li-comment-415772">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 6, 2017 at 5:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-415772" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes. Although, for very long sequences (&gt;400 time steps) you may need to split them up into subsequences to fit your model.</p>
<p>See this post:<br/>
<a href="https://machinelearningmastery.com/handle-long-sequences-long-short-term-memory-recurrent-neural-networks/" rel="nofollow">https://machinelearningmastery.com/handle-long-sequences-long-short-term-memory-recurrent-neural-networks/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-415772" onclick='return addComment.moveForm( "comment-415772", "415772", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-415784">
<div class="comment-container" id="li-comment-415784">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/be304c559bff531e29c7ebaea1aec57e?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/be304c559bff531e29c7ebaea1aec57e?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Argie</span>
<span class="date">October 6, 2017 at 7:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-415784" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks a lot, I’ll give it a try !</p>
<div class="reply">
<a aria-label="Reply to Argie" class="comment-reply-link" href="#comment-415784" onclick='return addComment.moveForm( "comment-415784", "415784", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-415824">
<div class="comment-container" id="li-comment-415824">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/657b2a6d4fb4cc7d3397c928c4f0f27d?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/657b2a6d4fb4cc7d3397c928c4f0f27d?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Emily</span>
<span class="date">October 6, 2017 at 2:10 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-415824" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I’m really puzzled. I seem to be the only one who can’t run the code you provided.<br/>
I’m using python 2.7, Keras-2.0.8, Tensorflow-0.12. I got an error at the line<br/>
model.add(LSTM(100)).</p>
<p>TypeError: expected int32, got list containing Tensors of type’_Message’ instead.</p>
<p>Can you please let me know which python, keras, tensorflow versions you’re using?</p>
<p>Thank you!</p>
<div class="reply">
<a aria-label="Reply to Emily" class="comment-reply-link" href="#comment-415824" onclick='return addComment.moveForm( "comment-415824", "415824", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-415880">
<div class="comment-container" id="li-comment-415880">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 7, 2017 at 5:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-415880" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It looks like you need to upgrade your version of TensorFlow to at least 1.3 or better.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-415880" onclick='return addComment.moveForm( "comment-415880", "415880", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-416125">
<div class="comment-container" id="li-comment-416125">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6280aa5b0826f5cfc8745aad894b9486?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6280aa5b0826f5cfc8745aad894b9486?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">nas</span>
<span class="date">October 9, 2017 at 10:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-416125" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi jason,</p>
<p>I would like to let you know that I have written my first ML code following your step by step ML project. I am using a nonlinear dataset(nsl-kdd). My dataset is in CSV format. I want to model and train my dataset using lstm.<br/>
For MNIST dataset I have a code,</p>
<p>import tensorflow as tf<br/>
from tensorflow.examples.tutorials.mnist import input_data<br/>
from tensorflow.python.ops import rnn, rnn_cell<br/>
mnist = input_data.read_data_sets(“/tmp/data/”, one_hot = True)</p>
<p>hm_epochs = 3<br/>
n_classes = 10<br/>
batch_size = 128<br/>
chunk_size = 28<br/>
n_chunks = 28<br/>
rnn_size = 128</p>
<p>My question is according to my dataset how I can define the chunk size, number of chunks, and rnn size as new variables for my dataset.<br/>
As I am very much new so really confuse how I can model and train my dataset to find accuracy using lstm.  I want to use LSTM as a classifier. I don’t know my questions to you is correct or not.<br/>
I really appreciate your help.</p>
<div class="reply">
<a aria-label="Reply to nas" class="comment-reply-link" href="#comment-416125" onclick='return addComment.moveForm( "comment-416125", "416125", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-416178">
<div class="comment-container" id="li-comment-416178">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 10, 2017 at 7:45 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-416178" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I don’t have examples of working with tensorflow directly. I cannot give you good advice.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-416178" onclick='return addComment.moveForm( "comment-416178", "416178", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-416253">
<div class="comment-container" id="li-comment-416253">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/915cae986938189d008b8322a0da043a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/915cae986938189d008b8322a0da043a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nandini</span>
<span class="date">October 10, 2017 at 9:41 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-416253" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>is it possible to written same code for Simple neural networks for text processing?<br/>
is it that best way to use keras for text processing or otherwise any other libraries are present to implement Neural networks for text processing.?</p>
<div class="reply">
<a aria-label="Reply to Nandini" class="comment-reply-link" href="#comment-416253" onclick='return addComment.moveForm( "comment-416253", "416253", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-416296">
<div class="comment-container" id="li-comment-416296">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 11, 2017 at 7:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-416296" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, perhaps start with this post to prepare your text data:<br/>
<a href="https://machinelearningmastery.com/prepare-text-data-deep-learning-keras/" rel="nofollow">https://machinelearningmastery.com/prepare-text-data-deep-learning-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-416296" onclick='return addComment.moveForm( "comment-416296", "416296", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-416505">
<div class="comment-container" id="li-comment-416505">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b992c74eb342ad5941030b09800144d8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b992c74eb342ad5941030b09800144d8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Vaibhav</span>
<span class="date">October 13, 2017 at 8:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-416505" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>This post and the comments have helped me immensely. Thanks!  I am question regarding this sentence –<br/>
“The IMDB review data does have a one-dimensional spatial structure in the sequence of words in reviews and the CNN may be able to pick out invariant features for good and bad sentiment. This learned spatial features may then be learned as sequences by an LSTM layer.”</p>
<p>I am not able to visualize how CNN will process words. Also, Could u please throw some light on spatial structure for words?</p>
<div class="reply">
<a aria-label="Reply to Vaibhav" class="comment-reply-link" href="#comment-416505" onclick='return addComment.moveForm( "comment-416505", "416505", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-416528">
<div class="comment-container" id="li-comment-416528">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 13, 2017 at 2:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-416528" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Words are ordered in a sentence or paragraph, this is the spatial structure.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-416528" onclick='return addComment.moveForm( "comment-416528", "416528", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-416545">
<div class="comment-container" id="li-comment-416545">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/915cae986938189d008b8322a0da043a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/915cae986938189d008b8322a0da043a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nandini</span>
<span class="date">October 13, 2017 at 4:21 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-416545" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>For sequence to sequence mining ,which neural networks is better for good performance?</p>
<div class="reply">
<a aria-label="Reply to Nandini" class="comment-reply-link" href="#comment-416545" onclick='return addComment.moveForm( "comment-416545", "416545", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-416612">
<div class="comment-container" id="li-comment-416612">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 14, 2017 at 5:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-416612" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>LSTMs.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-416612" onclick='return addComment.moveForm( "comment-416612", "416612", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-416927">
<div class="comment-container" id="li-comment-416927">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/915cae986938189d008b8322a0da043a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/915cae986938189d008b8322a0da043a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">nandini</span>
<span class="date">October 16, 2017 at 10:29 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-416927" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>i have the read about sequence to sequence learning in neural networks,we need to LSTMS layers for it,first one is for input sequence and second is for output sequnce,here we have to send our input sequnce vector in a reverse order to LSTM layers.</p>
<p>what my doubt ,is LSTM layer will take the input in a reverse order or we have to give input in reverse order</p>
<div class="reply">
<a aria-label="Reply to nandini" class="comment-reply-link" href="#comment-416927" onclick='return addComment.moveForm( "comment-416927", "416927", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-416980">
<div class="comment-container" id="li-comment-416980">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 17, 2017 at 5:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-416980" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, you can reverse the order with the go_backwards argument to the LSTM layer:<br/>
<a href="https://keras.io/layers/recurrent/#lstm" rel="nofollow">https://keras.io/layers/recurrent/#lstm</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-416980" onclick='return addComment.moveForm( "comment-416980", "416980", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-417020">
<div class="comment-container" id="li-comment-417020">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/915cae986938189d008b8322a0da043a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/915cae986938189d008b8322a0da043a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">nandini</span>
<span class="date">October 17, 2017 at 4:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-417020" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>For sequence to sequence  regression model ,output node i have to give one or i have to give maximum variable length of output vectors,.<br/>
finally we will get output  vectors,how we have to convert to this output vectors to text ,is there any method is available in Keras ,like in embedding layer we are doing strings to vectors conversion,like vectors to integers conversion.</p>
<div class="reply">
<a aria-label="Reply to nandini" class="comment-reply-link" href="#comment-417020" onclick='return addComment.moveForm( "comment-417020", "417020", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-417054">
<div class="comment-container" id="li-comment-417054">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 18, 2017 at 5:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-417054" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>To output text, you use a softmax to output the prob of each char or word, then take the argmax to get an integer and map the integer back to a value in your vocabulary.</p>
<p>I will have examples of how to do this on the blog soon.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-417054" onclick='return addComment.moveForm( "comment-417054", "417054", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-417027">
<div class="comment-container" id="li-comment-417027">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6617b43bc3ee16544f6612a7f024d1c1?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6617b43bc3ee16544f6612a7f024d1c1?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ambika</span>
<span class="date">October 17, 2017 at 7:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-417027" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>problem statement: my model should be generate the script file according to given instrctions using sequence to sequence modelling using keras..</p>
<p>examples:input: take two intergers from console,add two integers,print the addition of two integers on console.<br/>
output: like python script file for above input instructions.</p>
<p>Please give me any point of contact for this problem,how can i go further to solve this problem.</p>
<div class="reply">
<a aria-label="Reply to ambika" class="comment-reply-link" href="#comment-417027" onclick='return addComment.moveForm( "comment-417027", "417027", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-417057">
<div class="comment-container" id="li-comment-417057">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 18, 2017 at 5:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-417057" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Here is an example:<br/>
<a href="https://machinelearningmastery.com/learn-add-numbers-seq2seq-recurrent-neural-networks/" rel="nofollow">https://machinelearningmastery.com/learn-add-numbers-seq2seq-recurrent-neural-networks/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-417057" onclick='return addComment.moveForm( "comment-417057", "417057", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-417635">
<div class="comment-container" id="li-comment-417635">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/915cae986938189d008b8322a0da043a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/915cae986938189d008b8322a0da043a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">nandini</span>
<span class="date">October 23, 2017 at 8:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-417635" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Is it possible to use machine learning to translate natural language into a programming language, say, C, PHP, or Python? please suggsest me any libraries available to do this task.</p>
<div class="reply">
<a aria-label="Reply to nandini" class="comment-reply-link" href="#comment-417635" onclick='return addComment.moveForm( "comment-417635", "417635", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-417682">
<div class="comment-container" id="li-comment-417682">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 24, 2017 at 5:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-417682" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps.</p>
<p>You could look into using LSTMs as text generator for sequence to sequence learning. Start here:<br/>
<a href="https://machinelearningmastery.com/start-here/#lstm" rel="nofollow">https://machinelearningmastery.com/start-here/#lstm</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-417682" onclick='return addComment.moveForm( "comment-417682", "417682", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-419354">
<div class="comment-container" id="li-comment-419354">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1bbd965bae23cdb34f6574ce793ba90f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1bbd965bae23cdb34f6574ce793ba90f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tamir Bennatan</span>
<span class="date">November 8, 2017 at 9:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-419354" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dr. Brownlee,  I can’t tell you how much I value the content on your site! So accessible, to the point, and enriching. You’re changing the world. Thank you.</p>
<div class="reply">
<a aria-label="Reply to Tamir Bennatan" class="comment-reply-link" href="#comment-419354" onclick='return addComment.moveForm( "comment-419354", "419354", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-419478">
<div class="comment-container" id="li-comment-419478">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 9, 2017 at 9:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-419478" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Tamir!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-419478" onclick='return addComment.moveForm( "comment-419478", "419478", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-420009">
<div class="comment-container" id="li-comment-420009">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e5292d1bfd6063043cc39d8e9aa29a3c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e5292d1bfd6063043cc39d8e9aa29a3c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://martinenko.com" rel="external nofollow">glorsh66</a></span>
<span class="date">November 15, 2017 at 2:38 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-420009" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great tutorial!<br/>
But how can i use this network to classify several different classes? For instance 14 classes.</p>
<p>Am i correct – that i just need to change – model.add(Dense(1, activation=’sigmoid’))<br/>
to model.add(Dense(13, activation=’sigmoid’))</p>
<p>or i need use Conv2D?</p>
<p>And how can i transform my text data  to word embedding (such as IMDB uses).</p>
<div class="reply">
<a aria-label="Reply to glorsh66" class="comment-reply-link" href="#comment-420009" onclick='return addComment.moveForm( "comment-420009", "420009", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-420045">
<div class="comment-container" id="li-comment-420045">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 15, 2017 at 9:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-420045" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>To change the example to work for a multi-class classification problem, change the output layer to have one neuron per class, and use the categorical_crossentropy loss function.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-420045" onclick='return addComment.moveForm( "comment-420045", "420045", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-420573">
<div class="comment-container" id="li-comment-420573">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e5292d1bfd6063043cc39d8e9aa29a3c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e5292d1bfd6063043cc39d8e9aa29a3c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://martinenko.com" rel="external nofollow">glorsh66</a></span>
<span class="date">November 19, 2017 at 7:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-420573" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for your great example!</p>
<p>I got some troubles with overfitting my model –<br/>
For the training i am using, text data in Russian language (language essentially doesn’t matter,because text contains a lot of special professional terms, and sadly to employ existing word2vec won’t be an option.)</p>
<p>I have such parameters of training data – Maximum lengths of an article – 969 words Size of vocabulary – 53886 Amount of labels – 12 (sadly they are distributed quite unevenly, for instance i have first label – and have around 5000 examples of this, and second contains only 1500 examples.)</p>
<p>Amount of training data set – Only 9876 entries. I’ts the biggest problem, because sadly i can’t increase size of the training set by any means (only way out to wait another year☻, but even it will only make twice the size of training date, and even double amount is’not enough)</p>
<p>Here is my code –</p>
<p>x, x_test, y, y_test = train_test_split(x_, y_, test_size=0.1)<br/>
x_train, x_dev, y_train, y_dev = train_test_split(x, y, test_size=0.1)</p>
<p>embedding_vecor_length = 100</p>
<p>model = Sequential()<br/>
model.add(Embedding(top_words, embedding_vecor_length, input_length=max_review_length))<br/>
model.add(Conv1D(filters=32, kernel_size=3, padding=’same’, activation=’relu’))<br/>
model.add(MaxPooling1D(pool_size=2))<br/>
model.add(keras.layers.Dropout(0.3))<br/>
model.add(Conv1D(filters=32, kernel_size=4, padding=’same’, activation=’relu’))<br/>
model.add(MaxPooling1D(pool_size=2))<br/>
model.add(keras.layers.Dropout(0.3))<br/>
model.add(Conv1D(filters=32, kernel_size=5, padding=’same’, activation=’relu’))<br/>
model.add(MaxPooling1D(pool_size=2))<br/>
model.add(keras.layers.Dropout(0.3))<br/>
model.add(Conv1D(filters=32, kernel_size=7, padding=’same’, activation=’relu’))<br/>
model.add(MaxPooling1D(pool_size=2))<br/>
model.add(keras.layers.Dropout(0.3))<br/>
model.add(Conv1D(filters=32, kernel_size=9, padding=’same’, activation=’relu’))<br/>
model.add(MaxPooling1D(pool_size=2))<br/>
model.add(keras.layers.Dropout(0.3))<br/>
model.add(Conv1D(filters=32, kernel_size=12, padding=’same’, activation=’relu’))<br/>
model.add(MaxPooling1D(pool_size=2))<br/>
model.add(keras.layers.Dropout(0.3))<br/>
model.add(Conv1D(filters=32, kernel_size=15, padding=’same’, activation=’relu’))<br/>
model.add(MaxPooling1D(pool_size=2))<br/>
model.add(keras.layers.Dropout(0.3))<br/>
model.add(LSTM(200,dropout=0.3, recurrent_dropout=0.3))<br/>
model.add(Dense(labels_count, activation=’softmax’))<br/>
model.compile(loss=’categorical_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])</p>
<p>print(model.summary())</p>
<p>model.fit(x_train, y_train, epochs=25, batch_size=30)<br/>
scores = model.evaluate(x_, y_)<br/>
I tried different parameters and it gets really high accuracy in training (up to 98%) But i really performs badly on test set. Maximum that i managed to achieve was around 74%, usual result something around 64% And the best result was achieved with small embedding_vecor_length and small batch_size.</p>
<p>I know – that my test set is only 10 percent of training test, and overall data-set is the biggest problem, but i want to find a way around this problem.</p>
<p>So my questions are – 1) Is it correctly builded model for text classification purpose? (it works) Do i need to use simultaneous convolution an merge results instead? I just don’t get how the text information doesn’t get lost in the process of convolution with different filter sized (like in my example) Can you explain hot the convolution works with text data? There are mainly articles about image recognition..</p>
<p>2)i obliviously got a problem with overfitting my model. How can i make the performance better? I have already added Dropout layers. What can i do next?</p>
<p>3)May be i need something different? I mean pure RNN without convolution?</p>
<div class="reply">
<a aria-label="Reply to glorsh66" class="comment-reply-link" href="#comment-420573" onclick='return addComment.moveForm( "comment-420573", "420573", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-420639">
<div class="comment-container" id="li-comment-420639">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 20, 2017 at 10:15 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-420639" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps try using cross-validation to get a more robust estimate of model skill.</p>
<p>Perhaps explore simpler CNN based approaches, here is a good start:<br/>
<a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/" rel="nofollow">https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/</a></p>
<p>Perhaps explore general deep learning tuning methods:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<p>I hope that helps as a start.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-420639" onclick='return addComment.moveForm( "comment-420639", "420639", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-420714">
<div class="comment-container" id="li-comment-420714">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/6450c53d94f5796797321d34cb571707?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/6450c53d94f5796797321d34cb571707?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alex</span>
<span class="date">November 21, 2017 at 6:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-420714" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How would you do sequence classification if there were no words involved? For example, I want to classify a sequence that looks like [0, 0, 0.4, 0.5, 0.9, 0, 0.4] either to be a 0 or a 1, but I don’t know what format to get my data in to feed into an LSTM.</p>
<div class="reply">
<a aria-label="Reply to Alex" class="comment-reply-link" href="#comment-420714" onclick='return addComment.moveForm( "comment-420714", "420714", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-420803">
<div class="comment-container" id="li-comment-420803">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 22, 2017 at 10:44 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-420803" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps start here Alex:<br/>
<a href="https://machinelearningmastery.com/start-here/#lstm" rel="nofollow">https://machinelearningmastery.com/start-here/#lstm</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-420803" onclick='return addComment.moveForm( "comment-420803", "420803", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-420723">
<div class="comment-container" id="li-comment-420723">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5789ddd0a76af869ed4079213d68c9b4?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Thabet</span>
<span class="date">November 21, 2017 at 9:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-420723" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>What if we need to classify a sequence of numbers, is this example applicable and do i need the embedding layer? and can you refer to an example that you have on the blog or on other places so i can understand more? Thanks</p>
<div class="reply">
<a aria-label="Reply to Thabet" class="comment-reply-link" href="#comment-420723" onclick='return addComment.moveForm( "comment-420723", "420723", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-420806">
<div class="comment-container" id="li-comment-420806">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 22, 2017 at 10:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-420806" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>An embedding layer would not be required.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-420806" onclick='return addComment.moveForm( "comment-420806", "420806", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-420741">
<div class="comment-container" id="li-comment-420741">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d8f7d0435c3b2258d0f0bffd7c2398b8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d8f7d0435c3b2258d0f0bffd7c2398b8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kasun Karunarathna</span>
<span class="date">November 21, 2017 at 4:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-420741" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi.</p>
<p>Nice tutorial buddy. Please can you show how to use this LSTM network with a Binary classification problem (like your tutorial on neural networks – prima indian diabetics).</p>
<p>Please can you help me..</p>
<div class="reply">
<a aria-label="Reply to Kasun Karunarathna" class="comment-reply-link" href="#comment-420741" onclick='return addComment.moveForm( "comment-420741", "420741", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-420814">
<div class="comment-container" id="li-comment-420814">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 22, 2017 at 11:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-420814" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It would not be a fit for that dataset as there is no sequence information.</p>
<p>You can get started with LSTMs here:<br/>
<a href="https://machinelearningmastery.com/start-here/#lstm" rel="nofollow">https://machinelearningmastery.com/start-here/#lstm</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-420814" onclick='return addComment.moveForm( "comment-420814", "420814", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-420840">
<div class="comment-container" id="li-comment-420840">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d8f7d0435c3b2258d0f0bffd7c2398b8?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d8f7d0435c3b2258d0f0bffd7c2398b8?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kasun Karunarathna</span>
<span class="date">November 22, 2017 at 2:57 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-420840" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Jason</p>
<div class="reply">
<a aria-label="Reply to Kasun Karunarathna" class="comment-reply-link" href="#comment-420840" onclick='return addComment.moveForm( "comment-420840", "420840", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-421126">
<div class="comment-container" id="li-comment-421126">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7ecb4fc8079caf5d6f70ed372efc6ad2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7ecb4fc8079caf5d6f70ed372efc6ad2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">pirate_shady</span>
<span class="date">November 25, 2017 at 7:53 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-421126" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>I tried sequence classification, but I am not able to add LSTM layer on top of embedded layer.<br/>
Did you faced a similar issue ?<br/>
Here is the problem that I am facing : <a href="https://stackoverflow.com/questions/47464256/unable-to-add-lstm-layer-on-top-of-embedded-layer-on-gpu-keras-with-tensorflow" rel="nofollow">https://stackoverflow.com/questions/47464256/unable-to-add-lstm-layer-on-top-of-embedded-layer-on-gpu-keras-with-tensorflow</a></p>
<div class="reply">
<a aria-label="Reply to pirate_shady" class="comment-reply-link" href="#comment-421126" onclick='return addComment.moveForm( "comment-421126", "421126", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-421147">
<div class="comment-container" id="li-comment-421147">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 25, 2017 at 10:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-421147" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Here’s an example with the functional API:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7db05d744704386" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
	# embedding
	inputs2 = Input(shape=(max_length,))
	emb2 = Embedding(vocab_size, 50, mask_zero=True)(inputs2)
	emb3 = LSTM(256, return_sequences=True)(emb2)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7db05d744704386-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7db05d744704386-2">2</div><div class="crayon-num" data-line="crayon-5c0caac7db05d744704386-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7db05d744704386-4">4</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7db05d744704386-1"><span class="crayon-h"> </span><span class="crayon-p"># embedding</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7db05d744704386-2"><span class="crayon-h"> </span><span class="crayon-v">inputs2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Input</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-v">max_length</span><span class="crayon-sy">,</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7db05d744704386-3"><span class="crayon-h"> </span><span class="crayon-v">emb2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mask_zero</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">inputs2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7db05d744704386-4"><span class="crayon-h"> </span><span class="crayon-v">emb3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">256</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">(</span><span class="crayon-v">emb2</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0005 seconds] -->
<p></p>
<p>Taken from here:<br/>
<a href="https://machinelearningmastery.com/develop-a-caption-generation-model-in-keras/" rel="nofollow">https://machinelearningmastery.com/develop-a-caption-generation-model-in-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-421147" onclick='return addComment.moveForm( "comment-421147", "421147", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-422141">
<div class="comment-container" id="li-comment-422141">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/bc3bbea5fe1980f72cadc898375d526f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bc3bbea5fe1980f72cadc898375d526f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Michael</span>
<span class="date">December 4, 2017 at 7:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-422141" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>Thanks for the tutorial. Can you clarify however, when you say:<br/>
“We can see that we achieve similar results to the first example although with less weights and faster training time.”</p>
<p>When you mean less weights, what are you referring to exactly? cause when you run model.summary the model with Convolution layer has 216k parameters vs. 213k parameters in the original model, technically there are more parameters to train. </p>
<p>Do you mean to say that with the convolution + pooling layers the input into the LTSM layer is from 250 hidden layer nodes vs 500 in the original model? I’m guessing the LTSM layer is harder to train which leads to the reduced fitting time?</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Michael" class="comment-reply-link" href="#comment-422141" onclick='return addComment.moveForm( "comment-422141", "422141", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-423145">
<div class="comment-container" id="li-comment-423145">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7afbfd9b1458aa9f80bba1bbf4dd3435?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7afbfd9b1458aa9f80bba1bbf4dd3435?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">saleh</span>
<span class="date">December 15, 2017 at 5:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-423145" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi<br/>
I tried text classification. I have data sets of tweets and I have to train a model to determine the writer was happy or  sad. I used your “Simple LSTM for Sequence Classification” code . but the thing is that I want to know before using your code what should I  replace with words .<br/>
previously I used    ” sequences = tokenizer.texts_to_sequences(tweets_dict[“train”])”   to convert text to vector and after that I used your code . Is it correct?</p>
<div class="reply">
<a aria-label="Reply to saleh" class="comment-reply-link" href="#comment-423145" onclick='return addComment.moveForm( "comment-423145", "423145", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-423166">
<div class="comment-container" id="li-comment-423166">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 15, 2017 at 5:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-423166" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>See this example:<br/>
<a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/" rel="nofollow">https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-423166" onclick='return addComment.moveForm( "comment-423166", "423166", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-423365">
<div class="comment-container" id="li-comment-423365">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/70d1a27c20d77d35af1b638ddab25dea?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/70d1a27c20d77d35af1b638ddab25dea?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://zuratex.net/" rel="external nofollow">Zuratex Testosterone</a></span>
<span class="date">December 16, 2017 at 7:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-423365" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Real informative and fantastic anatomical structure of subject matter,<br/>
now that’s user friendly (:.</p>
<div class="reply">
<a aria-label="Reply to Zuratex Testosterone" class="comment-reply-link" href="#comment-423365" onclick='return addComment.moveForm( "comment-423365", "423365", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-423397">
<div class="comment-container" id="li-comment-423397">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 16, 2017 at 9:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-423397" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks!</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-423397" onclick='return addComment.moveForm( "comment-423397", "423397", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-423957">
<div class="comment-container" id="li-comment-423957">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/f16ebf04384e8a1cf57acbf79af74cda?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f16ebf04384e8a1cf57acbf79af74cda?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://zuratexmaleenhancement.com/" rel="external nofollow">Zuratex Complex</a></span>
<span class="date">December 19, 2017 at 7:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-423957" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Do you mind if I quote a few of your posts as long as I provide<br/>
credit and sources back to your website? My blog site is in the exact same area of interest as yours and my users would really benefit<br/>
from a lot of the information you provide here.<br/>
Please let me know if this okay with you. Many thanks!</p>
<div class="reply">
<a aria-label="Reply to Zuratex Complex" class="comment-reply-link" href="#comment-423957" onclick='return addComment.moveForm( "comment-423957", "423957", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-424046">
<div class="comment-container" id="li-comment-424046">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 20, 2017 at 5:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-424046" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure, as long as you do not copy posts verbatim (e.g. just small quotes) and you credit the source clearly.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-424046" onclick='return addComment.moveForm( "comment-424046", "424046", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-424331">
<div class="comment-container" id="li-comment-424331">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d8f3dec6f1b5a78b42cb9be11268cf0b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d8f3dec6f1b5a78b42cb9be11268cf0b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aayush Sinha</span>
<span class="date">December 21, 2017 at 9:41 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-424331" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Very nice article. Can you tell me how to make single prediction ? Like for a given text we have to make prediction.</p>
<p>e.g. “Very nice movie”  as single input to give “positive” output.</p>
<div class="reply">
<a aria-label="Reply to Aayush Sinha" class="comment-reply-link" href="#comment-424331" onclick='return addComment.moveForm( "comment-424331", "424331", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-424373">
<div class="comment-container" id="li-comment-424373">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 22, 2017 at 5:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-424373" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, see this post:<br/>
<a href="https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/" rel="nofollow">https://machinelearningmastery.com/make-predictions-long-short-term-memory-models-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-424373" onclick='return addComment.moveForm( "comment-424373", "424373", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-424493">
<div class="comment-container" id="li-comment-424493">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5598a7d1ae0bb9003bed9dc9b1e99325?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5598a7d1ae0bb9003bed9dc9b1e99325?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Eduardo Andrade</span>
<span class="date">December 23, 2017 at 5:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-424493" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>In my problem I have made an one hot encoding with a vector size of 256 for each sample (10000 samples). The embedding layer is necessary? What I have done as the first layer:</p>
<p>model.add(LSTM(256, input_shape=(10000, 256), activation = ‘relu’))</p>
<p>You did model.add(LSTM(100)) too. It has any relation with the embedding_vecor_length? It has to be greater than embedding_vecor_length = 32? I am using 256 but without any idea. Thank you.</p>
<div class="reply">
<a aria-label="Reply to Eduardo Andrade" class="comment-reply-link" href="#comment-424493" onclick='return addComment.moveForm( "comment-424493", "424493", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-424614">
<div class="comment-container" id="li-comment-424614">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 24, 2017 at 4:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-424614" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps try your model with and without the embedding to see how it impacts model skill.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-424614" onclick='return addComment.moveForm( "comment-424614", "424614", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-424794">
<div class="comment-container" id="li-comment-424794">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b5c0da1b04c7e05757ab2173ab0f2eaf?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b5c0da1b04c7e05757ab2173ab0f2eaf?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">chanchal suman</span>
<span class="date">December 26, 2017 at 6:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-424794" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you sir, for providing the very nice tutorial. I am working on sequence classification. My data set contains 41 features, each of them are float and Y is  5 class .<br/>
Q.1 Do i need embedding ?<br/>
Q.2 I have normalized the data , so do i need top_words ?<br/>
Q.3 What could be embedding vector length?<br/>
Q.4 What could be the maximum review length ?<br/>
Q.5 All example contains 41 features, do i need padding ?<br/>
I am not very clear about the embedding layer. Your suggestions would be great for me.</p>
<div class="reply">
<a aria-label="Reply to chanchal suman" class="comment-reply-link" href="#comment-424794" onclick='return addComment.moveForm( "comment-424794", "424794", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-424820">
<div class="comment-container" id="li-comment-424820">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 27, 2017 at 5:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-424820" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Too many questions for one comment!</p>
<p>Generally, I cannot tell you what will work best for your problem, you must experiment to discover what works best. See this post:<br/>
<a href="https://machinelearningmastery.com/applied-machine-learning-as-a-search-problem/" rel="nofollow">https://machinelearningmastery.com/applied-machine-learning-as-a-search-problem/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-424820" onclick='return addComment.moveForm( "comment-424820", "424820", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="comment-446171">
<div class="comment-container" id="li-comment-446171">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9b6fd95adbb699a85521b484c07d15b2?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9b6fd95adbb699a85521b484c07d15b2?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Kwon</span>
<span class="date">August 16, 2018 at 12:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-446171" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello, suman , I got same situation just like you<br/>
My data set have 8 features and 100,000 obs, I have to classify these sequence data<br/>
into 4 different class. </p>
<p>But I have no idea with embedding ‘Vector Length’, ‘Maximum review length ‘ etc.</p>
<p>If you fixed your problem, could you tell me how you solved ? </p>
<p>Any comments or advices would be appreciated .</p>
<div class="reply">
<a aria-label="Reply to Kwon" class="comment-reply-link" href="#comment-446171" onclick='return addComment.moveForm( "comment-446171", "446171", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-3" id="comment-446199">
<div class="comment-container" id="li-comment-446199">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 16, 2018 at 6:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-446199" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Here are some approaches for working with very long sequences:<br/>
<a href="https://machinelearningmastery.com/handle-long-sequences-long-short-term-memory-recurrent-neural-networks/" rel="nofollow">https://machinelearningmastery.com/handle-long-sequences-long-short-term-memory-recurrent-neural-networks/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-446199" onclick='return addComment.moveForm( "comment-446199", "446199", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-424994">
<div class="comment-container" id="li-comment-424994">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c351e6f40a282d86c96fc329db6495a9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c351e6f40a282d86c96fc329db6495a9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Aparup Khatua</span>
<span class="date">December 28, 2017 at 1:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-424994" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have one small doubt. You are using the IMDB data set. If i want to use a different data set then how to pre-process the data set for preparing the word integer matrix to execute the following: </p>
<p># load the dataset but only keep the top n words, zero the rest<br/>
top_words = 5000<br/>
(X_train, y_train), (X_test, y_test) = imdb.load_data(num_words=top_words)<br/>
# truncate and pad input sequences<br/>
max_review_length = 500<br/>
X_train = sequence.pad_sequences(X_train, maxlen=max_review_length)<br/>
X_test = sequence.pad_sequences(X_test, maxlen=max_review_length)</p>
<p>My data (two columns in .csv format: tweet and CLASS/manual annotation) looks like this: </p>
<p>president obama says the us needs to do more to help stop the ebola outbreak from becoming a global crisis actdont talk	RISK<br/>
i was upset and angry that thomasericduncan lied about his exposure to ebola and put us all at risk for catching this deadly disease	RISK<br/>
ebola is transmitted through blood and saliva so i better stop punching my haters so hard and smooching all these gorgeous b	TRANSMISSION<br/>
he got the best treatment availablebetter than liberia and i am still not convinced he didnt know he had ebolarace card again	TREATMENT<br/>
obama and cdc said they will fight ebola in africa news today ebola deaths rise sharply when exactly will they fight it tcot	TREATMENT<br/>
fuck this is really tough dont know if i have the mind and guts to deal with death and ebola every day of work	RISK<br/>
something more serious needs to be done about this ebola shit the airport and the town he was in needs to be quarantined im sick of being	PREVENTION<br/>
if you have ebola symptoms or know someone who does please hug and kiss mr obama show him respect he appreciates tcot 	SYMPTOM<br/>
u can only get it if u have frequent contact with bodily fluids of someone who has ebola and is showing symptoms 	TRANSMISSION</p>
<div class="reply">
<a aria-label="Reply to Aparup Khatua" class="comment-reply-link" href="#comment-424994" onclick='return addComment.moveForm( "comment-424994", "424994", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-425012">
<div class="comment-container" id="li-comment-425012">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">December 28, 2017 at 5:25 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-425012" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>See an example here:<br/>
<a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/" rel="nofollow">https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-425012" onclick='return addComment.moveForm( "comment-425012", "425012", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-426419">
<div class="comment-container" id="li-comment-426419">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d8213eff740d25c82cad3ce642cebd29?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d8213eff740d25c82cad3ce642cebd29?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">anupam</span>
<span class="date">January 13, 2018 at 4:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-426419" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, I would like to know after building a model using ML or DL how to use that model which can automatically classify the untagged corpus? is there any example?</p>
<p>Regards</p>
<div class="reply">
<a aria-label="Reply to anupam" class="comment-reply-link" href="#comment-426419" onclick='return addComment.moveForm( "comment-426419", "426419", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426475">
<div class="comment-container" id="li-comment-426475">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 14, 2018 at 6:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-426475" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, learn more about a final model here:<br/>
<a href="https://machinelearningmastery.com/train-final-machine-learning-model/" rel="nofollow">https://machinelearningmastery.com/train-final-machine-learning-model/</a></p>
<p>Learn how to save and load a DL model here:<br/>
<a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/" rel="nofollow">https://machinelearningmastery.com/save-load-keras-deep-learning-models/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426475" onclick='return addComment.moveForm( "comment-426475", "426475", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-426845">
<div class="comment-container" id="li-comment-426845">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2eaa68abfab70e67c11126cf63a435a0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2eaa68abfab70e67c11126cf63a435a0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">AbuBakr</span>
<span class="date">January 18, 2018 at 11:51 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-426845" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thank you for your great effort,</p>
<p>I am trying to use Keras LSTM, but I dont know the data format.</p>
<p>I have an FAQ list, the questions are considered samples and the answers are considered classes. So how can I use the lstm classifier for this dataset.</p>
<p>thanks in advance</p>
<div class="reply">
<a aria-label="Reply to AbuBakr" class="comment-reply-link" href="#comment-426845" onclick='return addComment.moveForm( "comment-426845", "426845", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426879">
<div class="comment-container" id="li-comment-426879">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 19, 2018 at 6:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-426879" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>See this post:<br/>
<a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" rel="nofollow">https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426879" onclick='return addComment.moveForm( "comment-426879", "426879", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-426856">
<div class="comment-container" id="li-comment-426856">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b00022d1bdaf856d3f2f8894e44c7d31?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b00022d1bdaf856d3f2f8894e44c7d31?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ray</span>
<span class="date">January 19, 2018 at 1:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-426856" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I have a classification problem that has two types of input. </p>
<p>The first input is the sequence of online activities, which I can use the above mentioned models to deal with.<br/>
The second input is a vector of the time difference (minute) between each activity and last activity. In this case, I want my model consider the time impact of the decision as well.</p>
<p>My question is what is the best way to merge the second input to the above models?<br/>
What I have done is use a LSTM layer on the second input as well and merge the output with the above one. But it seems not right, because the second input is continuous value rather than the discrete index.</p>
<p>So what kind of layer should I use to apply on these real value vectors?</p>
<div class="reply">
<a aria-label="Reply to Ray" class="comment-reply-link" href="#comment-426856" onclick='return addComment.moveForm( "comment-426856", "426856", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426888">
<div class="comment-container" id="li-comment-426888">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 19, 2018 at 6:34 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-426888" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps try a suite of models and see what works best.</p>
<p>Perhaps a multi-headed model might be a good approach.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426888" onclick='return addComment.moveForm( "comment-426888", "426888", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-426862">
<div class="comment-container" id="li-comment-426862">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b00022d1bdaf856d3f2f8894e44c7d31?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b00022d1bdaf856d3f2f8894e44c7d31?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://google" rel="external nofollow">Ray</a></span>
<span class="date">January 19, 2018 at 2:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-426862" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>How to take two types of inputs in this model?<br/>
One is a sequence of online activities, the second input is the time different between each activity and last activity.<br/>
Should I use a multimodal layer to merge them?<br/>
Should I process the second input with LSTM layer as well? (It seems not right as the element of this vector is the continuous value)</p>
<p>Cheers,</p>
<p>R</p>
<div class="reply">
<a aria-label="Reply to Ray" class="comment-reply-link" href="#comment-426862" onclick='return addComment.moveForm( "comment-426862", "426862", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-426891">
<div class="comment-container" id="li-comment-426891">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 19, 2018 at 6:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-426891" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>See this post for examples:<br/>
<a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/" rel="nofollow">https://machinelearningmastery.com/keras-functional-api-deep-learning/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-426891" onclick='return addComment.moveForm( "comment-426891", "426891", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-427409">
<div class="comment-container" id="li-comment-427409">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b00022d1bdaf856d3f2f8894e44c7d31?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b00022d1bdaf856d3f2f8894e44c7d31?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ray Li</span>
<span class="date">January 24, 2018 at 8:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-427409" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for your response. I understand how to merge two layers, but my question is, in which layer shall I merge the online activities with their recency scores? </p>
<p>For example I can apply a lstm layer on the online activities, and then concatenate the output of lstm layer (the last hidden state output) with the sequence of their recency scores. But it doesn’t make sense.</p>
<p>Or I can multiply the embedding output with the sequence of their recency scores, then put the output into the lstm layer. But I don’t know whether this right or not.</p>
<p>Would please give me some suggestion?</p>
<p>Thanks,</p>
<p>Ray</p>
<div class="reply">
<a aria-label="Reply to Ray Li" class="comment-reply-link" href="#comment-427409" onclick='return addComment.moveForm( "comment-427409", "427409", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-427444">
<div class="comment-container" id="li-comment-427444">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 24, 2018 at 10:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-427444" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>My intuitions might lead you down a false path. Perhaps try a few designs and see what works best for your specific problem.</p>
<p>There is more art than science in this at the moment.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-427444" onclick='return addComment.moveForm( "comment-427444", "427444", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-427661">
<div class="comment-container" id="li-comment-427661">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b00022d1bdaf856d3f2f8894e44c7d31?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b00022d1bdaf856d3f2f8894e44c7d31?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ray</span>
<span class="date">January 27, 2018 at 1:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-427661" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Fair enough. But thanks a lot. I will use this as the excuse when I have to talk with my professor about progress 😀</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-427760">
<div class="comment-container" id="li-comment-427760">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4918971f980bacfbaec2baf9b192e754?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4918971f980bacfbaec2baf9b192e754?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ismael</span>
<span class="date">January 28, 2018 at 6:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-427760" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>I can implemented a LSTM to generate labels from videos? for example use youtube2text?</p>
<p>thanks</p>
<div class="reply">
<a aria-label="Reply to Ismael" class="comment-reply-link" href="#comment-427760" onclick='return addComment.moveForm( "comment-427760", "427760", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-427782">
<div class="comment-container" id="li-comment-427782">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">January 28, 2018 at 8:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-427782" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-427782" onclick='return addComment.moveForm( "comment-427782", "427782", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-428121">
<div class="comment-container" id="li-comment-428121">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b89a3e0f2b16ab024fa46a6e0b5177c5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b89a3e0f2b16ab024fa46a6e0b5177c5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shayan</span>
<span class="date">February 1, 2018 at 6:04 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-428121" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can I use this to for Lip Reading? I’m thinking of classifying a sequence of frames to a particular word. Like the entire video will be classified as hello, how, etc.</p>
<p>Can you tell me how to go about it?</p>
<div class="reply">
<a aria-label="Reply to Shayan" class="comment-reply-link" href="#comment-428121" onclick='return addComment.moveForm( "comment-428121", "428121", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-428172">
<div class="comment-container" id="li-comment-428172">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 2, 2018 at 8:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-428172" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sounds great. Sorry, I don’t have any examples of lip reading models.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-428172" onclick='return addComment.moveForm( "comment-428172", "428172", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-428390">
<div class="comment-container" id="li-comment-428390">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/20471356ad7cb30e57ead81e035595b9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/20471356ad7cb30e57ead81e035595b9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://www.shatterline.com" rel="external nofollow">auro tripathy</a></span>
<span class="date">February 5, 2018 at 5:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-428390" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason: Your teaching skills far exceed many ‘big’ teaching names.</p>
<p>As an experiment, I added one line to the model in your “simple” LSTM example. </p>
<p>       model.layers[0].trainable = True  # to train (back-prop) thru the embedding layer</p>
<p>While the trainable parameter count went up significantly (from 53,301 to 1,660,501), the accuracy did not change.</p>
<p>Would like your thoughts on the experiment.</p>
<div class="reply">
<a aria-label="Reply to auro tripathy" class="comment-reply-link" href="#comment-428390" onclick='return addComment.moveForm( "comment-428390", "428390", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-428411">
<div class="comment-container" id="li-comment-428411">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 5, 2018 at 7:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-428411" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The layer is trainable by default. The assignment should have had no effect. I’m surprised.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-428411" onclick='return addComment.moveForm( "comment-428411", "428411", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-428816">
<div class="comment-container" id="li-comment-428816">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5dbecd4e3335d98d76e6ce8bc63dd674?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5dbecd4e3335d98d76e6ce8bc63dd674?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://plus.google.com/+%E9%92%9F%E9%92%9F" rel="external nofollow">Clock ZHONG</a></span>
<span class="date">February 9, 2018 at 2:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-428816" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason,<br/>
Thanks for you excellent explanation.<br/>
I’ve done some modification on your codes in oder to get higher accuracy on the test data, finally, I could get accuracy 88.60% on test dataset.<br/>
My question is, besides what I’ve done on changing thoese hyper parameters (just like a blind man touching an elephant), what else we could to do improve the prediction accuracy on the test data? Or how to conquer the overfitting to get higher prediction accuray on test data? I found it’s very easy to get higher prediction accuracy on training data, but it’s astonishingly hard to make the same result happen on the test dataset(or validation dataset). The codes I modified  is as following if anyone else need them as reference:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7dabd1609878563" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
.......
# create the model
embedding_vecor_length = 32
model = Sequential()
model.add(Embedding(top_words, embedding_vecor_length, input_length=max_review_length))
model.add(Dropout(0.4))
model.add(Conv1D(filters=16, kernel_size=6, padding='same', activation='relu'))
model.add(MaxPooling1D(pool_size=4))
model.add(Dropout(0.4))
model.add(Conv1D(filters=8, kernel_size=5, padding='same', activation='relu'))
model.add(MaxPooling1D(pool_size=4))
model.add(Dropout(0.4))
#model.add(Conv1D(filters=4, kernel_size=2, padding='same', activation='relu'))
#model.add(MaxPooling1D(pool_size=2))
#model.add(Dropout(0.4))

#model.add(Conv1D(filters=16, kernel_size=3, padding='same', activation='relu'))
#model.add(Dropout(0.2))
#model.add(MaxPooling1D(pool_size=2))
#model.add(Dropout(0.2))
#model.add(LSTM(100))
model.add(LSTM(120, dropout=0.4, recurrent_dropout=0.3))
#model.add(Dropout(0.4))

#model.add(Dropout(0.2))
model.add(Dense(1, activation='sigmoid'))
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
print(model.summary())
.......</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7dabd1609878563-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7dabd1609878563-2">2</div><div class="crayon-num" data-line="crayon-5c0caac7dabd1609878563-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7dabd1609878563-4">4</div><div class="crayon-num" data-line="crayon-5c0caac7dabd1609878563-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7dabd1609878563-6">6</div><div class="crayon-num" data-line="crayon-5c0caac7dabd1609878563-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7dabd1609878563-8">8</div><div class="crayon-num" data-line="crayon-5c0caac7dabd1609878563-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7dabd1609878563-10">10</div><div class="crayon-num" data-line="crayon-5c0caac7dabd1609878563-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7dabd1609878563-12">12</div><div class="crayon-num" data-line="crayon-5c0caac7dabd1609878563-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7dabd1609878563-14">14</div><div class="crayon-num" data-line="crayon-5c0caac7dabd1609878563-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7dabd1609878563-16">16</div><div class="crayon-num" data-line="crayon-5c0caac7dabd1609878563-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7dabd1609878563-18">18</div><div class="crayon-num" data-line="crayon-5c0caac7dabd1609878563-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7dabd1609878563-20">20</div><div class="crayon-num" data-line="crayon-5c0caac7dabd1609878563-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7dabd1609878563-22">22</div><div class="crayon-num" data-line="crayon-5c0caac7dabd1609878563-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7dabd1609878563-24">24</div><div class="crayon-num" data-line="crayon-5c0caac7dabd1609878563-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7dabd1609878563-26">26</div><div class="crayon-num" data-line="crayon-5c0caac7dabd1609878563-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7dabd1609878563-28">28</div><div class="crayon-num" data-line="crayon-5c0caac7dabd1609878563-29">29</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7dabd1609878563-1"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7dabd1609878563-2"><span class="crayon-p"># create the model</span></div><div class="crayon-line" id="crayon-5c0caac7dabd1609878563-3"><span class="crayon-v">embedding_vecor_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">32</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7dabd1609878563-4"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7dabd1609878563-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">top_words</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">embedding_vecor_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_review_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7dabd1609878563-6"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.4</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7dabd1609878563-7"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv1D</span><span class="crayon-sy">(</span><span class="crayon-v">filters</span><span class="crayon-o">=</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7dabd1609878563-8"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling1D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7dabd1609878563-9"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.4</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7dabd1609878563-10"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv1D</span><span class="crayon-sy">(</span><span class="crayon-v">filters</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'same'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7dabd1609878563-11"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling1D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7dabd1609878563-12"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.4</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7dabd1609878563-13"><span class="crayon-p">#model.add(Conv1D(filters=4, kernel_size=2, padding='same', activation='relu'))</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7dabd1609878563-14"><span class="crayon-p">#model.add(MaxPooling1D(pool_size=2))</span></div><div class="crayon-line" id="crayon-5c0caac7dabd1609878563-15"><span class="crayon-p">#model.add(Dropout(0.4))</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7dabd1609878563-16"> </div><div class="crayon-line" id="crayon-5c0caac7dabd1609878563-17"><span class="crayon-p">#model.add(Conv1D(filters=16, kernel_size=3, padding='same', activation='relu'))</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7dabd1609878563-18"><span class="crayon-p">#model.add(Dropout(0.2))</span></div><div class="crayon-line" id="crayon-5c0caac7dabd1609878563-19"><span class="crayon-p">#model.add(MaxPooling1D(pool_size=2))</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7dabd1609878563-20"><span class="crayon-p">#model.add(Dropout(0.2))</span></div><div class="crayon-line" id="crayon-5c0caac7dabd1609878563-21"><span class="crayon-p">#model.add(LSTM(100))</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7dabd1609878563-22"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-cn">120</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropout</span><span class="crayon-o">=</span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">recurrent_dropout</span><span class="crayon-o">=</span><span class="crayon-cn">0.3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7dabd1609878563-23"><span class="crayon-p">#model.add(Dropout(0.4))</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7dabd1609878563-24"> </div><div class="crayon-line" id="crayon-5c0caac7dabd1609878563-25"><span class="crayon-p">#model.add(Dropout(0.2))</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7dabd1609878563-26"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7dabd1609878563-27"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7dabd1609878563-28"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7dabd1609878563-29"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0015 seconds] -->
<p></p>
<p>Thanks!</p>
<p>Clock ZHONG</p>
<div class="reply">
<a aria-label="Reply to Clock ZHONG" class="comment-reply-link" href="#comment-428816" onclick='return addComment.moveForm( "comment-428816", "428816", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-428848">
<div class="comment-container" id="li-comment-428848">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 9, 2018 at 9:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-428848" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Well done, here are some more ideas:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-428848" onclick='return addComment.moveForm( "comment-428848", "428848", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-428939">
<div class="comment-container" id="li-comment-428939">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5dbecd4e3335d98d76e6ce8bc63dd674?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5dbecd4e3335d98d76e6ce8bc63dd674?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="https://plus.google.com/+%E9%92%9F%E9%92%9F" rel="external nofollow">Clock ZHONG</a></span>
<span class="date">February 10, 2018 at 4:05 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-428939" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, Jason, that article you wrote, I already carefully read it half year ago. It’s also perfect, but I still feel we have no a clear guide on how to impove the prediction accuracy on test dataset.<br/>
We always say:<br/>
1. more training and testing data could get better performance, but it’s not always.<br/>
2. more deeper layers in the neural network could get better performance, but it’s still not always;<br/>
3. Fine tune hyper parameters could get better performance, yes ,it is, but let alone the time comsumption, this kind of work could only imporve the performance very very little (according to my experience.)<br/>
4. Try more other architecture neural network algorithms. Yes, sometimes this could work, but soon we’ll get to the upper-limit again. and face the same problem at once: how to impove it then?.<br/>
Conquering overfitting is really an interesting but difficult work in neural network, I feel we could find some better working ways to fix this problem in the future.<br/>
I still appreciate your articles and reply. Have a happy weekend.</p>
<p>Thanks </p>
<p>Clock ZHONG</p>
<div class="reply">
<a aria-label="Reply to Clock ZHONG" class="comment-reply-link" href="#comment-428939" onclick='return addComment.moveForm( "comment-428939", "428939", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-428970">
<div class="comment-container" id="li-comment-428970">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 10, 2018 at 9:00 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-428970" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, it is hard and empirical. That is the nature of the job. </p>
<p>There are no clear answers and no one can tell you how to get the best result for a given dataset. You must discover it.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-428970" onclick='return addComment.moveForm( "comment-428970", "428970", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-428881">
<div class="comment-container" id="li-comment-428881">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4ec06604b4b9704f02ba854e94ce3d6b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4ec06604b4b9704f02ba854e94ce3d6b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shabnam</span>
<span class="date">February 9, 2018 at 5:41 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-428881" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks a lot Jason for your great post. I have difficulty of understanding how LSTM can remember  long-term dependencies. Or maybe, I misunderstood the meaning of “remembering dependencies”. Does it remember different parts within a specific training data or among different training data?</p>
<p>For example, if we have 100 training data, does it learn from 81st data by remembering previous training data?</p>
<p>Thanks a lot for your time and help in advance,</p>
<div class="reply">
<a aria-label="Reply to Shabnam" class="comment-reply-link" href="#comment-428881" onclick='return addComment.moveForm( "comment-428881", "428881", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-428959">
<div class="comment-container" id="li-comment-428959">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 10, 2018 at 8:52 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-428959" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have an example that makes it clear here:<br/>
<a href="https://machinelearningmastery.com/memory-in-a-long-short-term-memory-network/" rel="nofollow">https://machinelearningmastery.com/memory-in-a-long-short-term-memory-network/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-428959" onclick='return addComment.moveForm( "comment-428959", "428959", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-429297">
<div class="comment-container" id="li-comment-429297">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4ec06604b4b9704f02ba854e94ce3d6b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4ec06604b4b9704f02ba854e94ce3d6b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shabnam</span>
<span class="date">February 13, 2018 at 1:06 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-429297" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I’ll read it, thanks a lot.</p>
<div class="reply">
<a aria-label="Reply to Shabnam" class="comment-reply-link" href="#comment-429297" onclick='return addComment.moveForm( "comment-429297", "429297", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-430484">
<div class="comment-container" id="li-comment-430484">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8fdf778e80079c918642020d7b110d46?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8fdf778e80079c918642020d7b110d46?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Morty</span>
<span class="date">February 25, 2018 at 7:25 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-430484" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Jason:<br/>
    Great article! It helps me a lot.<br/>
    However, I don’t understand why dropout is considered to play a positive role while reducing the accuracy rate.</p>
<div class="reply">
<a aria-label="Reply to Morty" class="comment-reply-link" href="#comment-430484" onclick='return addComment.moveForm( "comment-430484", "430484", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-430503">
<div class="comment-container" id="li-comment-430503">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 26, 2018 at 6:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-430503" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It can help in general, this this post we are demonstrating how to implement it.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430503" onclick='return addComment.moveForm( "comment-430503", "430503", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-430574">
<div class="comment-container" id="li-comment-430574">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/135b3a0805b2867b3dee0cb246273cb5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/135b3a0805b2867b3dee0cb246273cb5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vishnu</span>
<span class="date">February 27, 2018 at 3:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-430574" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>hello,<br/>
Thanks for the article.could you provide an idea on how to apply LSTM for handwriten images recognition.I have a dataset of handwriten alphabets as images of size 50*50.<br/>
It would also be helpful if i could know how Lstm helps handwriten text recognition<br/>
Thank you,</p>
<div class="reply">
<a aria-label="Reply to vishnu" class="comment-reply-link" href="#comment-430574" onclick='return addComment.moveForm( "comment-430574", "430574", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-430604">
<div class="comment-container" id="li-comment-430604">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 27, 2018 at 6:37 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-430604" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure, see this post:<br/>
<a href="https://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/" rel="nofollow">https://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430604" onclick='return addComment.moveForm( "comment-430604", "430604", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-430613">
<div class="comment-container" id="li-comment-430613">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/135b3a0805b2867b3dee0cb246273cb5?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/135b3a0805b2867b3dee0cb246273cb5?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">vishnu</span>
<span class="date">February 27, 2018 at 10:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-430613" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for the help<br/>
 1.The code uses convolutional neural network.what changes should I make to use recurrent neural network(LSTM).<br/>
2.How to load custom datatset of images for training and testing instead of mnist data set.</p>
<div class="reply">
<a aria-label="Reply to vishnu" class="comment-reply-link" href="#comment-430613" onclick='return addComment.moveForm( "comment-430613", "430613", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-430627">
<div class="comment-container" id="li-comment-430627">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">February 27, 2018 at 2:56 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-430627" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>LSTM could be used for a sequence of images, but a CNN would still be used on the front end.</p>
<p>See this post for a CNN LSTM:<br/>
<a href="https://machinelearningmastery.com/cnn-long-short-term-memory-networks/" rel="nofollow">https://machinelearningmastery.com/cnn-long-short-term-memory-networks/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430627" onclick='return addComment.moveForm( "comment-430627", "430627", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-430713">
<div class="comment-container" id="li-comment-430713">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/07536d1ab8039b3a9ad5f7863d30e74b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/07536d1ab8039b3a9ad5f7863d30e74b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Soumaya</span>
<span class="date">February 28, 2018 at 4:34 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-430713" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you for this great work! Can we apply it for french language?</p>
<div class="reply">
<a aria-label="Reply to Soumaya" class="comment-reply-link" href="#comment-430713" onclick='return addComment.moveForm( "comment-430713", "430713", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-430782">
<div class="comment-container" id="li-comment-430782">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 1, 2018 at 6:08 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-430782" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-430782" onclick='return addComment.moveForm( "comment-430782", "430782", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-432196">
<div class="comment-container" id="li-comment-432196">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d2e1d1aafec651ed1cfb0c51c9c9b5b3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d2e1d1aafec651ed1cfb0c51c9c9b5b3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Johannes</span>
<span class="date">March 15, 2018 at 10:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-432196" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,<br/>
great article. I have a rather fundamental question. As I understand it, each sample is here a sequence of the lenght of “max_review_length”. However, if I have a one dimensional sequence, each sample is part of the sequence. My question is basically, how to tell the algorithm which dimension the sequence takes place. </p>
<p>Here, we feed in samples which are not part of the sequence themselves but they contain the sequence. But in other use cases it seems like we feed in samples in a sequence, and the samples themselves form the sequence. And we can even feed in a sequence of multiple dimensions, like multiple paralell time series, which is only a sequence in the first dimension.  </p>
<p>I am a bit confused about this, in my mind the algorithm should only recognize the sequence along one dimension, would be great if you could clarify. </p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Johannes" class="comment-reply-link" href="#comment-432196" onclick='return addComment.moveForm( "comment-432196", "432196", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-432219">
<div class="comment-container" id="li-comment-432219">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 15, 2018 at 2:48 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-432219" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Not sure I follow.</p>
<p>Perhaps this post will make inputs to the LSTM more clear:<br/>
<a href="https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/" rel="nofollow">https://machinelearningmastery.com/reshape-input-data-long-short-term-memory-networks-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-432219" onclick='return addComment.moveForm( "comment-432219", "432219", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-432243">
<div class="comment-container" id="li-comment-432243">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d2e1d1aafec651ed1cfb0c51c9c9b5b3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d2e1d1aafec651ed1cfb0c51c9c9b5b3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Johannes</span>
<span class="date">March 15, 2018 at 7:32 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-432243" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ok, I will try to clarify. Say we have a sequence of 5 values. We can pass the sequence in one by one, shape (5,1,1) or all 5 points in one go (1,5,1) as a vector of lenght 5. However, are both of these considered a sequence?</p>
<p>In my mind, the first one is a sequence of 5, while the second is 5 parallel sequences of lenght 1. This is relevant because in the example of sentiment, we have N samples of lenght “max_lenght”, ie shape (N, max_lenght, 1). Or maybe (N, max_lenght, embedding_dim) if we use embeddings.  </p>
<p>If the sequence is in the first  dimension, ie that of  N, then LSTM doesnt make sence because there should be no sequential relationship between different reviews. </p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Johannes" class="comment-reply-link" href="#comment-432243" onclick='return addComment.moveForm( "comment-432243", "432243", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-432295">
<div class="comment-container" id="li-comment-432295">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 16, 2018 at 6:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-432295" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, the first is 5 sequence the second is 1 sequence. Regardless, LSTMs process only one time step of data as input at a time.</p>
<p>One batch is comprised of 1 or more sequences (samples, first dimension).</p>
<p>Weight updates occur at the end of each batch at which time internal state is cleared. This means, there is knowledge across sequences. Or can be if that is desired.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-432295" onclick='return addComment.moveForm( "comment-432295", "432295", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-5" id="comment-432313">
<div class="comment-container" id="li-comment-432313">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/d2e1d1aafec651ed1cfb0c51c9c9b5b3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/d2e1d1aafec651ed1cfb0c51c9c9b5b3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Johannes</span>
<span class="date">March 16, 2018 at 7:24 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-432313" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Ok, I get it. Thanks for clarifying. Keep up the good work.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor even depth-5" id="comment-432333">
<div class="comment-container" id="li-comment-432333">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 16, 2018 at 2:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-432333" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No problem.</p>
<div class="reply">
</div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-432213">
<div class="comment-container" id="li-comment-432213">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d042163bbc498cbf5deaea84cda447b?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d042163bbc498cbf5deaea84cda447b?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Case</span>
<span class="date">March 15, 2018 at 2:43 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-432213" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I just start learning ML and trying some sample projects on keras. This post is a really good example to follow.</p>
<p>I have a question about the classification problem. Right now, I am trying a two-class sequence classification problem. I followed this tutorial to build a model with loss function as binary cross entropy. Then I change the output layer to have 2 units, change the loss function to categorical cross entropy and change the y_training to one hot encoding. I expect these two methods give me the same accuracy but actually, the categorical one seems to be more accurate. Do you have any idea of why this happens? From my understanding, binary cross entropy is the same with 2-class categorical cross entropy so these two methods should give me the same result.</p>
<p>Another problem. I read another post on your website and change the input layer to LSTM. Then I truncate the training data. I use the full training data to do validation. The truncated training data gives me a higher accuracy when validating than the model using the full training data. I use binary cross entropy method here. This is not what I expect. I am also wondering how to decide the type of the input layer?</p>
<p>I really appreciate it if you could spend any time answering my question.</p>
<div class="reply">
<a aria-label="Reply to Case" class="comment-reply-link" href="#comment-432213" onclick='return addComment.moveForm( "comment-432213", "432213", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-432227">
<div class="comment-container" id="li-comment-432227">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 15, 2018 at 2:53 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-432227" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It might allow the model to be more expressive (e.g. more weights in the calculation of the output).</p>
<p>Not sure I understand the second question, perhaps you can give a very short example?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-432227" onclick='return addComment.moveForm( "comment-432227", "432227", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-432609">
<div class="comment-container" id="li-comment-432609">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/695fb6fb8c31fc6f5193f58c249c37ff?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/695fb6fb8c31fc6f5193f58c249c37ff?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sardarkhan</span>
<span class="date">March 19, 2018 at 9:25 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-432609" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Would this model is good for predicting that user has perfom this activity or not.? because i want to develope a model that predict that user has performed this activity or not.i want to train the model on user activity like jumping and test whether the user jumping or not.can this model help me out or do you have any code for this.?thanks seeking for help.regards sardar khan.</p>
<div class="reply">
<a aria-label="Reply to Sardarkhan" class="comment-reply-link" href="#comment-432609" onclick='return addComment.moveForm( "comment-432609", "432609", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-432661">
<div class="comment-container" id="li-comment-432661">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 20, 2018 at 6:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-432661" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps try it and see.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-432661" onclick='return addComment.moveForm( "comment-432661", "432661", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-432707">
<div class="comment-container" id="li-comment-432707">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/695fb6fb8c31fc6f5193f58c249c37ff?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/695fb6fb8c31fc6f5193f58c249c37ff?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sardar</span>
<span class="date">March 20, 2018 at 3:36 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-432707" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Can you give me an example of this.</p>
<div class="reply">
<a aria-label="Reply to Sardar" class="comment-reply-link" href="#comment-432707" onclick='return addComment.moveForm( "comment-432707", "432707", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-432755">
<div class="comment-container" id="li-comment-432755">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 21, 2018 at 6:30 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-432755" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry, I do not have a worked example of your problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-432755" onclick='return addComment.moveForm( "comment-432755", "432755", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-433013">
<div class="comment-container" id="li-comment-433013">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2dea0e37ff847187146c5f9f15fd4e7a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2dea0e37ff847187146c5f9f15fd4e7a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ashwin</span>
<span class="date">March 23, 2018 at 2:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-433013" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am not able to clearly understand how exactly is binary classification happening here? The following is the questions that I am trying to figure out:</p>
<p>For classification, is the final output by the final word in LSTM being given to the single neuron dense layer ? If so, in another one of your post related to “Text generation using LSTM” you seem to be creating an output dense layer with number of neurons equal to the number of words in the  vocabulary. But in case of text generation you need the output such that a given memory unit predict the next appropriate word. Then how is a dense layer exactly being connected to the LSTM layer and how exactly is it working(since the LSTM layer seems to give only the final output of final word)?? Please help me both these question</p>
<div class="reply">
<a aria-label="Reply to Ashwin" class="comment-reply-link" href="#comment-433013" onclick='return addComment.moveForm( "comment-433013", "433013", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-2" id="comment-433018">
<div class="comment-container" id="li-comment-433018">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/89f16b3e5552385668dd3828acd8be79?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/89f16b3e5552385668dd3828acd8be79?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ankita</span>
<span class="date">March 23, 2018 at 4:41 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-433018" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes Jason, this is a question that even I am troubled with. Can you please explain how the dense layer is “CONNECTED” with the LSTM layer in these two different situtations(“Sequence classification” and “Text generation”). </p>
<p>Thank you in advance</p>
<p>Ankita</p>
<div class="reply">
<a aria-label="Reply to Ankita" class="comment-reply-link" href="#comment-433018" onclick='return addComment.moveForm( "comment-433018", "433018", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-433059">
<div class="comment-container" id="li-comment-433059">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 24, 2018 at 6:20 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-433059" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This example is classifying sequences of words as a sentiment good/bad.</p>
<p>It is different from generating text (outputting a sequence of words).</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-433059" onclick='return addComment.moveForm( "comment-433059", "433059", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-433125">
<div class="comment-container" id="li-comment-433125">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2dea0e37ff847187146c5f9f15fd4e7a?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2dea0e37ff847187146c5f9f15fd4e7a?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ashwin</span>
<span class="date">March 25, 2018 at 12:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-433125" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thank you Jason for your reply.</p>
<p>But can you explain how exactly the connection between the LSTM layer and the dense layer differs in both the situations ??</p>
<div class="reply">
<a aria-label="Reply to Ashwin" class="comment-reply-link" href="#comment-433125" onclick='return addComment.moveForm( "comment-433125", "433125", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-433153">
<div class="comment-container" id="li-comment-433153">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">March 25, 2018 at 6:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-433153" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>How do you mean exactly?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-433153" onclick='return addComment.moveForm( "comment-433153", "433153", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-434252">
<div class="comment-container" id="li-comment-434252">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2e2b73d6fda36688a4adf480b23f0aed?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2e2b73d6fda36688a4adf480b23f0aed?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">ahmed</span>
<span class="date">April 6, 2018 at 4:29 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-434252" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi ..<br/>
nice work .. but how could we enter single review and get its prediction ?</p>
<div class="reply">
<a aria-label="Reply to ahmed" class="comment-reply-link" href="#comment-434252" onclick='return addComment.moveForm( "comment-434252", "434252", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-434275">
<div class="comment-container" id="li-comment-434275">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 6, 2018 at 6:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-434275" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You must prepare the single input as you would any training data.</p>
<p>Here’s some pseudocode that will help:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->
<div class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" id="crayon-5c0caac7da605910040007" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="" style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;" wrap="soft">
review = ...
encoded_review = encode(...)
yhat = model.predict(encoded_review)</textarea></div>
<div class="crayon-main" style="">
<table class="crayon-table">
<tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c0caac7da605910040007-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c0caac7da605910040007-2">2</div><div class="crayon-num" data-line="crayon-5c0caac7da605910040007-3">3</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c0caac7da605910040007-1"><span class="crayon-v">review</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c0caac7da605910040007-2"><span class="crayon-v">encoded_review</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">encode</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c0caac7da605910040007-3"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_review</span><span class="crayon-sy">)</span></div></div></td>
</tr>
</table>
</div>
</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-434275" onclick='return addComment.moveForm( "comment-434275", "434275", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-434538">
<div class="comment-container" id="li-comment-434538">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/04288bdc2269f1abe6e3e8c97b18e027?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/04288bdc2269f1abe6e3e8c97b18e027?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Adrian</span>
<span class="date">April 9, 2018 at 7:33 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-434538" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Thanks for the great post. I’m trying to implement a classifier like yours, but training on different data (logfiles) with another input shape. I got several lines of data, each with 9 features, each padded to a MAX_FEATURE_LEN. This works fine for LSTM layers, but as soon as i add the Embedding or the Dense layer, i get an error like: <code>Error when checking target: expected dense_1 to have 2 dimensions, but got array with shape (2000, 9, 256)</code></p>
<p>My current model:<br/>
<code><br/>
    features = 9<br/>
    MAX_FEATURE_LEN = 256<br/>
    model = Sequential()<br/>
    model.add(Embedding(file_len(TRAIN_PATH), features, input_length=MAX_FEATURE_LEN))<br/>
    model.add(Dropout(0.2))<br/>
    model.add(LSTM(100, return_sequences=True))<br/>
    model.add(Dropout(0.2))<br/>
    model.add(Dense(1, activation='sigmoid'))<br/>
    model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy']) </code></p>
<p>I’ve tried several things and it works for LSTMs, so i don’t get what distinguishes them from Dense layers input_shape-wise</p>
<p>Thank you in advance<br/>
Adrian</p>
<div class="reply">
<a aria-label="Reply to Adrian" class="comment-reply-link" href="#comment-434538" onclick='return addComment.moveForm( "comment-434538", "434538", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-434596">
<div class="comment-container" id="li-comment-434596">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 10, 2018 at 6:18 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-434596" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps take a step back and skill up on LSTMs for NLP:<br/>
<a href="https://machinelearningmastery.com/start-here/#nlp" rel="nofollow">https://machinelearningmastery.com/start-here/#nlp</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-434596" onclick='return addComment.moveForm( "comment-434596", "434596", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-435421">
<div class="comment-container" id="li-comment-435421">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/9e62621901cda50829a7b4b85fc9083c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/9e62621901cda50829a7b4b85fc9083c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">SchwarzLin</span>
<span class="date">April 19, 2018 at 12:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-435421" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Great post and a very readable guide on LSTM-CNN using Keras.<br/>
Recently I’m working on a binary classification task which takes real numbers data from multi sensors. I was inspired by your post and wonder if it is possible that I arrange these data into a image-like matrix, which each row is a vector from one sensor and several rows for data from different sensors and then using  model like LSTM or CNN or LSTM+CNN from your post to classify the data.<br/>
Do you think it is feasible for model to learn or ? Thanks for your post again~</p>
<div class="reply">
<a aria-label="Reply to SchwarzLin" class="comment-reply-link" href="#comment-435421" onclick='return addComment.moveForm( "comment-435421", "435421", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-435433">
<div class="comment-container" id="li-comment-435433">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 19, 2018 at 2:50 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-435433" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps multiple 1-d CNNs would make more sense?</p>
<p>I would recommend trying it rather than thinking too much about whether it is feasible, e.g. Keras is so easy that you could prototype it in a few minutes.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435433" onclick='return addComment.moveForm( "comment-435433", "435433", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-435657">
<div class="comment-container" id="li-comment-435657">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1a747aadfc3d4bb67abd6a31b39fd096?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1a747aadfc3d4bb67abd6a31b39fd096?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sachin</span>
<span class="date">April 23, 2018 at 2:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-435657" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice tutorial, Jason. It got me started with using LSTMs in Keras!<br/>
Are there any thumb rules for how many LSTM units to use for a classification problem? Does the length of the input sequence have any bearing number on this number?</p>
<div class="reply">
<a aria-label="Reply to Sachin" class="comment-reply-link" href="#comment-435657" onclick='return addComment.moveForm( "comment-435657", "435657", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-435676">
<div class="comment-container" id="li-comment-435676">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">April 23, 2018 at 6:19 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-435676" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Good question.</p>
<p>No good heuristics for configuring the number of units or layers. No relationship between input length and number of units in the hidden layer.</p>
<p>I recommend careful and systematic experimentation to see what works best for your specific dataset.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-435676" onclick='return addComment.moveForm( "comment-435676", "435676", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-436248">
<div class="comment-container" id="li-comment-436248">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5bd846e085c1f9700973dce3003f9e10?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5bd846e085c1f9700973dce3003f9e10?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://rutmans.org/jeremy" rel="external nofollow">jeremy rutman</a></span>
<span class="date">April 29, 2018 at 7:21 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-436248" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>nb_words has been replaced by num_words</p>
<div class="reply">
<a aria-label="Reply to jeremy rutman" class="comment-reply-link" href="#comment-436248" onclick='return addComment.moveForm( "comment-436248", "436248", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-436799">
<div class="comment-container" id="li-comment-436799">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 7, 2018 at 9:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-436799" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, fixed.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436799" onclick='return addComment.moveForm( "comment-436799", "436799", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-436249">
<div class="comment-container" id="li-comment-436249">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/5bd846e085c1f9700973dce3003f9e10?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5bd846e085c1f9700973dce3003f9e10?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://rutmans.org/jeremy" rel="external nofollow">jeremy rutman</a></span>
<span class="date">April 29, 2018 at 7:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-436249" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>also nb_epoch was replaced by epochs</p>
<div class="reply">
<a aria-label="Reply to jeremy rutman" class="comment-reply-link" href="#comment-436249" onclick='return addComment.moveForm( "comment-436249", "436249", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-436800">
<div class="comment-container" id="li-comment-436800">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 7, 2018 at 9:55 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-436800" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks, fixed.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436800" onclick='return addComment.moveForm( "comment-436800", "436800", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-436928">
<div class="comment-container" id="li-comment-436928">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/22d3ad46cffc6a3af804bf14d784da33?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/22d3ad46cffc6a3af804bf14d784da33?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">amul</span>
<span class="date">May 8, 2018 at 4:01 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-436928" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Rookie Query:Can this model predict certain pattern of the sequence like x,x^2,x^3,sin(x),etc all the combination of these sequene?</p>
<div class="reply">
<a aria-label="Reply to amul" class="comment-reply-link" href="#comment-436928" onclick='return addComment.moveForm( "comment-436928", "436928", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-436977">
<div class="comment-container" id="li-comment-436977">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 9, 2018 at 6:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-436977" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>A model could perhaps be trained to learn those sequences.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-436977" onclick='return addComment.moveForm( "comment-436977", "436977", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-437701">
<div class="comment-container" id="li-comment-437701">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7776166284a100b753b5c179a3a36443?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7776166284a100b753b5c179a3a36443?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://None" rel="external nofollow">Anam</a></span>
<span class="date">May 17, 2018 at 12:57 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-437701" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,<br/>
   Kindly can you help me in how to “upload my own dataset in keras” because I want to work on my own dataset.  Thanks for your time.</p>
<div class="reply">
<a aria-label="Reply to Anam" class="comment-reply-link" href="#comment-437701" onclick='return addComment.moveForm( "comment-437701", "437701", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-437732">
<div class="comment-container" id="li-comment-437732">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 17, 2018 at 6:35 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-437732" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This post will show you how to load your own CSV data into Python:<br/>
<a href="http://machinelearningmastery.com/load-machine-learning-data-python/" rel="nofollow">http://machinelearningmastery.com/load-machine-learning-data-python/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437732" onclick='return addComment.moveForm( "comment-437732", "437732", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-437810">
<div class="comment-container" id="li-comment-437810">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7776166284a100b753b5c179a3a36443?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7776166284a100b753b5c179a3a36443?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://None" rel="external nofollow">Anam</a></span>
<span class="date">May 18, 2018 at 1:14 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-437810" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,<br/>
     The keras contain predefined datasets like “imdb”,”cifar” etc.I want to know can I include my own dataset into keras dataset.</p>
<div class="reply">
<a aria-label="Reply to Anam" class="comment-reply-link" href="#comment-437810" onclick='return addComment.moveForm( "comment-437810", "437810", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-437835">
<div class="comment-container" id="li-comment-437835">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 18, 2018 at 6:26 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-437835" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can load your data into numpy arrays and start using it with Keras.</p>
<p>I have many examples of this on the blog for CSV data and text data.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437835" onclick='return addComment.moveForm( "comment-437835", "437835", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-437916">
<div class="comment-container" id="li-comment-437916">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/809e4ace1ec27aac4c7d3bce0632c993?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/809e4ace1ec27aac4c7d3bce0632c993?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Yuheng</span>
<span class="date">May 19, 2018 at 6:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-437916" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I am a bit confused of how the LSTM is trained.<br/>
What is the input to the LSTM at each timestamp, is it the whole review (a 500 x 32 matrix?) or a word ( 32 dimension vector)?<br/>
What does a LSTM do in each epoch?<br/>
And how is the 100 neurons in the LSTM used? Can we use only 1 neuron for the job since it is recurrent?</p>
<p>Many thanks!</p>
<div class="reply">
<a aria-label="Reply to Yuheng" class="comment-reply-link" href="#comment-437916" onclick='return addComment.moveForm( "comment-437916", "437916", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-437936">
<div class="comment-container" id="li-comment-437936">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">May 19, 2018 at 7:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-437936" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The LSTM takes a training dataset of samples comprised of time steps and features or [samples, timesteps, features]</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-437936" onclick='return addComment.moveForm( "comment-437936", "437936", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-440197">
<div class="comment-container" id="li-comment-440197">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/07279f4e09341189e650f01cb82c863c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/07279f4e09341189e650f01cb82c863c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Namrata</span>
<span class="date">June 8, 2018 at 3:22 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-440197" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have the same doubt.. can you please elaborate?</p>
<div class="reply">
<a aria-label="Reply to Namrata" class="comment-reply-link" href="#comment-440197" onclick='return addComment.moveForm( "comment-440197", "440197", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4" id="comment-440263">
<div class="comment-container" id="li-comment-440263">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 9, 2018 at 6:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-440263" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can learn more about how to prepare data for LSTMs here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-440263" onclick='return addComment.moveForm( "comment-440263", "440263", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-440121">
<div class="comment-container" id="li-comment-440121">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/952b8267dc81a734117283d8d41b0f1f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/952b8267dc81a734117283d8d41b0f1f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">chhavvi</span>
<span class="date">June 8, 2018 at 1:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-440121" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>i have a data set of 25000 length and i choose top 2500 length and consider it as x_train but i am confused with embedding layer:argument – vocab size should be what .. if i choose 2500 then remaining vocab are not including in this and giving the error<br/>
”<br/>
InvalidArgumentError: indices[23,2433] = 80188 is not in [0, 80000)<br/>
	 [[Node: embedding_59/embedding_lookup = GatherV2[Taxis=DT_INT32, Tindices=DT_INT32, Tparams=DT_FLOAT, _class=[“loc:@training_42/Adam/Assign_2″], _device=”/job:localhost/replica:0/task:0/device:CPU:0″](embedding_59/embeddings/read, embedding_59/Cast, training_42/Adam/gradients/embedding_59/embedding_lookup_grad/concat/axis)]]”</p>
<p>and<br/>
cannot download the data by this code line :<br/>
(X_train, y_train), (X_test, y_test) = imdb.load_data(num_words=top_words)<br/>
error showing name or service is not known .<br/>
please help asap</p>
<div class="reply">
<a aria-label="Reply to chhavvi" class="comment-reply-link" href="#comment-440121" onclick='return addComment.moveForm( "comment-440121", "440121", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-440163">
<div class="comment-container" id="li-comment-440163">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 8, 2018 at 6:16 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-440163" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps try posting your code and error to stackoverflow?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-440163" onclick='return addComment.moveForm( "comment-440163", "440163", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-440199">
<div class="comment-container" id="li-comment-440199">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/07279f4e09341189e650f01cb82c863c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/07279f4e09341189e650f01cb82c863c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Namrata</span>
<span class="date">June 8, 2018 at 3:54 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-440199" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, </p>
<p>I have 32 sentence blocks of 500 words each to pass to an LSTM after using a pretrained word2vec model to get embeddings of 400 words each. How can I achieve this so that the 32 features are learnt simultaneously?  </p>
<p>Thanks!<br/>
Namrata</p>
<div class="reply">
<a aria-label="Reply to Namrata" class="comment-reply-link" href="#comment-440199" onclick='return addComment.moveForm( "comment-440199", "440199", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-440262">
<div class="comment-container" id="li-comment-440262">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 9, 2018 at 6:47 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-440262" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The number of units in the first hidden layer is unrelated to the size of your data.</p>
<p>You can learn more about how to prepare data for LSTMs here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-prepare-my-data-for-an-lstm</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-440262" onclick='return addComment.moveForm( "comment-440262", "440262", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="comment-441532">
<div class="comment-container" id="li-comment-441532">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a7b9fd9f454e2f726caabadeefeb9bfd?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a7b9fd9f454e2f726caabadeefeb9bfd?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ehsan</span>
<span class="date">June 21, 2018 at 4:07 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-441532" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>In pad_sequences, dtype of output is int32 by default. Shouldn’t we change it to float32 if we are feeding in word vectors?</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Ehsan" class="comment-reply-link" href="#comment-441532" onclick='return addComment.moveForm( "comment-441532", "441532", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-441543">
<div class="comment-container" id="li-comment-441543">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 21, 2018 at 4:59 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-441543" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>No, feeding the int mapping of words to the mapping is what we want, unless I misunderstand your question.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-441543" onclick='return addComment.moveForm( "comment-441543", "441543", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-442151">
<div class="comment-container" id="li-comment-442151">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/046e0f684f43d58756803014ad4e510c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/046e0f684f43d58756803014ad4e510c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">mohamed tarek</span>
<span class="date">June 27, 2018 at 1:36 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-442151" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>after finishing the model testing it gave an 84% accuracy<br/>
however when i tried to predict sentences using this code :<br/>
   text = ‘It is a bad movie to watch’<br/>
   text = preprocessing.text.one_hot(text, 5000, lower=True, split=’ ‘)<br/>
   text = [text]<br/>
   text = preprocessing.sequence.pad_sequences(text, 500)<br/>
   predictions = model.predict(text)<br/>
   print(predictions)</p>
<p>the result was  0.90528411<br/>
and when i change the sentence to ‘It is really a good movie to watch’<br/>
the prediction was 0.88954359</p>
<p>so is there`s a problem with code of prediction or i missed up the training</p>
<div class="reply">
<a aria-label="Reply to mohamed tarek" class="comment-reply-link" href="#comment-442151" onclick='return addComment.moveForm( "comment-442151", "442151", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2" id="comment-442152">
<div class="comment-container" id="li-comment-442152">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">June 27, 2018 at 1:42 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-442152" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It is important that the new text is prepared in the same way as the text used to fit the model. </p>
<p>We don’t have information on how the imdb dataset was prepared. </p>
<p>I’d recommend this tutorial instead:<br/>
<a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/" rel="nofollow">https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442152" onclick='return addComment.moveForm( "comment-442152", "442152", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment even depth-3" id="comment-442476">
<div class="comment-container" id="li-comment-442476">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/046e0f684f43d58756803014ad4e510c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/046e0f684f43d58756803014ad4e510c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">mohamed tarek</span>
<span class="date">July 2, 2018 at 5:10 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-442476" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>thank you for replying and thank you for those great tutorials they are really useful and informative  it really helped me a lot</p>
<div class="reply">
<a aria-label="Reply to mohamed tarek" class="comment-reply-link" href="#comment-442476" onclick='return addComment.moveForm( "comment-442476", "442476", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-442637">
<div class="comment-container" id="li-comment-442637">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/88cbebfc8da7414cac30dc47d9dfc576?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/88cbebfc8da7414cac30dc47d9dfc576?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Matt</span>
<span class="date">July 4, 2018 at 3:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-442637" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,<br/>
Great work and splendid efforts! Really appreciate.</p>
<p>I am interested in sequence classification to analyse malwares using rnn-lstm and Tensorflow. While there are a couple of sources, I always find your blogs very readable and easily comprehensible. Hence, request you to come up with a blog on ‘Sequence Classification using RNN-LSTM in Tensorflow.’</p>
<div class="reply">
<a aria-label="Reply to Matt" class="comment-reply-link" href="#comment-442637" onclick='return addComment.moveForm( "comment-442637", "442637", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-442693">
<div class="comment-container" id="li-comment-442693">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 5, 2018 at 7:36 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-442693" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks Matt.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-442693" onclick='return addComment.moveForm( "comment-442693", "442693", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-443131">
<div class="comment-container" id="li-comment-443131">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/b547d669b07df1f296903da2752d0adb?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/b547d669b07df1f296903da2752d0adb?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://none" rel="external nofollow">Anam Habib</a></span>
<span class="date">July 10, 2018 at 3:45 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-443131" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,<br/>
  I want to know that in deep learning( RNNLSTM) models what should be the difference  between training and testing accuracy in order to develop a good fit model.</p>
<p> and kindly tell me that my model is a good fit or not.</p>
<p>In [10]: model.fit(X_train, Y_train, epochs = 7, batch_size=batch_size, verbose = 2)<br/>
In [11]: score,acc = model.evaluate(X_test, Y_test, verbose = 2, batch_size = batch_size)<br/>
print(“score: %.2f” % (score))<br/>
print(“acc: %.2f” % (acc))<br/>
Epoch 1/7<br/>
1109s – loss: 0.6918 – acc: 0.5056<br/>
Epoch 2/7<br/>
971s – loss: 0.6269 – acc: 0.7041<br/>
Epoch 3/7<br/>
693s – loss: 0.3696 – acc: 0.8639<br/>
Epoch 4/7<br/>
594s – loss: 0.1743 – acc: 0.9388<br/>
Epoch 5/7<br/>
534s – loss: 0.0699 – acc: 0.9800<br/>
Epoch 6/7<br/>
473s – loss: 0.0276 – acc: 0.9950<br/>
Epoch 7/7<br/>
472s – loss: 0.0148 – acc: 0.9963<br/>
Out[10]:<br/>
score: 0.62<br/>
acc: 0.82</p>
<p>Thanx for your help.</p>
<div class="reply">
<a aria-label="Reply to Anam Habib" class="comment-reply-link" href="#comment-443131" onclick='return addComment.moveForm( "comment-443131", "443131", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-443169">
<div class="comment-container" id="li-comment-443169">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 11, 2018 at 5:51 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-443169" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I explain how to determine if a model is a good fit or not here:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/how-to-know-if-a-model-has-good-performance" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-to-know-if-a-model-has-good-performance</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443169" onclick='return addComment.moveForm( "comment-443169", "443169", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-443274">
<div class="comment-container" id="li-comment-443274">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7776166284a100b753b5c179a3a36443?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7776166284a100b753b5c179a3a36443?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://None" rel="external nofollow">Anam</a></span>
<span class="date">July 12, 2018 at 9:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-443274" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason,<br/>
  I have a query that this accuracy </p>
<p># Final evaluation of the model<br/>
scores = model.evaluate(X_test, y_test, verbose=0)<br/>
print(“Accuracy: %.2f%%” % (scores[1]*100))</p>
<p>is the predicted accuracy of the model?</p>
<div class="reply">
<a aria-label="Reply to Anam" class="comment-reply-link" href="#comment-443274" onclick='return addComment.moveForm( "comment-443274", "443274", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-443286">
<div class="comment-container" id="li-comment-443286">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 12, 2018 at 3:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-443286" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-443286" onclick='return addComment.moveForm( "comment-443286", "443286", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-444423">
<div class="comment-container" id="li-comment-444423">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c6fae4d6e2489295abd513baa5638175?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c6fae4d6e2489295abd513baa5638175?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tejaswini</span>
<span class="date">July 26, 2018 at 10:13 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-444423" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>HI Jason,</p>
<p>Thanks for the tutorial it was really helpful.</p>
<p>I have question,for example I am dealing in total with 500 messages.These messages are grouped into certain patterns.some times 6 messages make one pattern A.And some times next 3 messages make one Pattern B.I need to classify the patterns in that  500 messages.</p>
<p>I trained model with LSTM given input shape of pattern containing highest number of messages and padded other patterns.I used sliding  window concept  and used multi label classification.</p>
<p>While testing  when i give a file with 150 messages,During sliding the window ,some time non of the patterns may occur in that window but lstm model is classifying it as some known pattern.So how to overcome this issue.</p>
<p>Thanks in advance.</p>
<div class="reply">
<a aria-label="Reply to Tejaswini" class="comment-reply-link" href="#comment-444423" onclick='return addComment.moveForm( "comment-444423", "444423", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-444435">
<div class="comment-container" id="li-comment-444435">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 26, 2018 at 2:23 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-444435" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps you can have a “no pattern” output for those cases and train the model on them?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444435" onclick='return addComment.moveForm( "comment-444435", "444435", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-444444">
<div class="comment-container" id="li-comment-444444">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c6fae4d6e2489295abd513baa5638175?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c6fae4d6e2489295abd513baa5638175?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Tejaswini</span>
<span class="date">July 26, 2018 at 3:31 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-444444" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Appreciate your reply Jason . There are so many unknown patterns when compared to known patterns if i have to train with unknown class too.So it is facing class imbalance problem and always giving output as unknown class.</p>
<div class="reply">
<a aria-label="Reply to Tejaswini" class="comment-reply-link" href="#comment-444444" onclick='return addComment.moveForm( "comment-444444", "444444", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-444487">
<div class="comment-container" id="li-comment-444487">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 27, 2018 at 5:46 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-444487" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>We only train the model on data where we know the output.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444487" onclick='return addComment.moveForm( "comment-444487", "444487", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-444624">
<div class="comment-container" id="li-comment-444624">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7afdbf27831b1b2e2b92be84eb9d321c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7afdbf27831b1b2e2b92be84eb9d321c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">jorge</span>
<span class="date">July 28, 2018 at 2:05 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-444624" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason</p>
<p>Thanks for the tutorial do you have other example of tutorial that use Convolution lstm on time series dataset?</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to jorge" class="comment-reply-link" href="#comment-444624" onclick='return addComment.moveForm( "comment-444624", "444624", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-444659">
<div class="comment-container" id="li-comment-444659">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">July 29, 2018 at 6:06 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-444659" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I have a number of posts scheduled. Until then, perhaps this will help:<br/>
<a href="https://machinelearningmastery.com/cnn-long-short-term-memory-networks/" rel="nofollow">https://machinelearningmastery.com/cnn-long-short-term-memory-networks/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-444659" onclick='return addComment.moveForm( "comment-444659", "444659", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-445460">
<div class="comment-container" id="li-comment-445460">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/2cffb4227cd8d0e8cb07aa31ae296410?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/2cffb4227cd8d0e8cb07aa31ae296410?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Raja</span>
<span class="date">August 7, 2018 at 6:56 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-445460" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice explanation!<br/>
How do I construct a vocabulary just as like as imdb dataset format.<br/>
Can you give some form of pseudo code?</p>
<p>Thanks</p>
<div class="reply">
<a aria-label="Reply to Raja" class="comment-reply-link" href="#comment-445460" onclick='return addComment.moveForm( "comment-445460", "445460", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-445512">
<div class="comment-container" id="li-comment-445512">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 8, 2018 at 6:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-445512" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps this will help:<br/>
<a href="https://machinelearningmastery.com/prepare-text-data-deep-learning-keras/" rel="nofollow">https://machinelearningmastery.com/prepare-text-data-deep-learning-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-445512" onclick='return addComment.moveForm( "comment-445512", "445512", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-446484">
<div class="comment-container" id="li-comment-446484">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7776166284a100b753b5c179a3a36443?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7776166284a100b753b5c179a3a36443?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Anam</span>
<span class="date">August 19, 2018 at 8:19 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-446484" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Sir,<br/>
      I want to know that what are the parameters or factors of the CNN model that allows the CNN+LSTM architecture to produces an accuracy of 86.36%.In other words, factors affecting the accuracy of the model when using the CNN model. Thanks…</p>
<div class="reply">
<a aria-label="Reply to Anam" class="comment-reply-link" href="#comment-446484" onclick='return addComment.moveForm( "comment-446484", "446484", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-446504">
<div class="comment-container" id="li-comment-446504">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 20, 2018 at 6:33 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-446504" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Many many things, this may help:<br/>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-446504" onclick='return addComment.moveForm( "comment-446504", "446504", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-446886">
<div class="comment-container" id="li-comment-446886">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0c53ff9f0b209424b648fd3a918eda63?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0c53ff9f0b209424b648fd3a918eda63?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rashid</span>
<span class="date">August 25, 2018 at 2:22 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-446886" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Dear Jason<br/>
First thanks a lot for your effort. I just start learning different algorithms and your post helps me a lot.<br/>
I follow your LSTM post where I tried  y_pred = model.predict(X_test) .<br/>
But it gives me continuous vale rather 0 or 1. Where do i need to change for binary output. Thanks</p>
<p>I wish you a happy time.<br/>
Best<br/>
Rashid</p>
<div class="reply">
<a aria-label="Reply to Rashid" class="comment-reply-link" href="#comment-446886" onclick='return addComment.moveForm( "comment-446886", "446886", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-446899">
<div class="comment-container" id="li-comment-446899">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 25, 2018 at 5:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-446899" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps your model is configured to predict a continuous value?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-446899" onclick='return addComment.moveForm( "comment-446899", "446899", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-446914">
<div class="comment-container" id="li-comment-446914">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/0c53ff9f0b209424b648fd3a918eda63?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0c53ff9f0b209424b648fd3a918eda63?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Rashid</span>
<span class="date">August 25, 2018 at 9:09 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-446914" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks for your reply. Yeah I think so. I just copy and paste your code as well as the data you also used. I’m just learning. I didn’t change anything of your code. Could you give me the idea where I have to change for binary result.</p>
<div class="reply">
<a aria-label="Reply to Rashid" class="comment-reply-link" href="#comment-446914" onclick='return addComment.moveForm( "comment-446914", "446914", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-446973">
<div class="comment-container" id="li-comment-446973">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 26, 2018 at 6:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-446973" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure, this will help:<br/>
<a href="https://machinelearningmastery.com/faq/single-faq/how-can-i-change-a-neural-network-from-regression-to-classification" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-can-i-change-a-neural-network-from-regression-to-classification</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-446973" onclick='return addComment.moveForm( "comment-446973", "446973", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-446902">
<div class="comment-container" id="li-comment-446902">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/7c6e0c3788fe93237a5b80da199a9c24?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7c6e0c3788fe93237a5b80da199a9c24?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">hugh</span>
<span class="date">August 25, 2018 at 6:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-446902" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sorry Im new to NN but can I use this to identify if a sentence is lewd or non-lewd (gut says yes) just need confirmation</p>
<div class="reply">
<a aria-label="Reply to hugh" class="comment-reply-link" href="#comment-446902" onclick='return addComment.moveForm( "comment-446902", "446902", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-446969">
<div class="comment-container" id="li-comment-446969">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 26, 2018 at 6:17 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-446969" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Start by collecting a dataset with sentences where you know their label.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-446969" onclick='return addComment.moveForm( "comment-446969", "446969", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-447131">
<div class="comment-container" id="li-comment-447131">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/c56a8ea888753f8b17f8aecc5e74c733?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/c56a8ea888753f8b17f8aecc5e74c733?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Pickler</span>
<span class="date">August 28, 2018 at 6:52 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-447131" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Awesome content, thanks for sharing! </p>
<p>Should this be used for, let’s say, classifying weather patterns of historical data (not for prediction; e.g. classified as ‘rain’ based on a labeled training set etc.) due to the sequential nature of such data, or would you think simpler support vector classification methods can still model sequential data to an extent?</p>
<div class="reply">
<a aria-label="Reply to Pickler" class="comment-reply-link" href="#comment-447131" onclick='return addComment.moveForm( "comment-447131", "447131", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-447177">
<div class="comment-container" id="li-comment-447177">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">August 29, 2018 at 8:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-447177" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I recommend testing a suite of methods in order to discover what works best for your specific problem.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-447177" onclick='return addComment.moveForm( "comment-447177", "447177", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-447526">
<div class="comment-container" id="li-comment-447526">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/00a25438ce2ddc220fd9de3bc40c5c10?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/00a25438ce2ddc220fd9de3bc40c5c10?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nicola</span>
<span class="date">September 2, 2018 at 1:54 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-447526" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, thanks for the great article! I am not too sure I understand why we need the embedding layer? What if we simple feed the network with the original matrix (padded):</p>
<p>[0 0 0 … 12 33 421]<br/>
[0 0 0 … 1 654 211]</p>
<p>Why does the embedding help?</p>
<div class="reply">
<a aria-label="Reply to Nicola" class="comment-reply-link" href="#comment-447526" onclick='return addComment.moveForm( "comment-447526", "447526", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-447546">
<div class="comment-container" id="li-comment-447546">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 2, 2018 at 5:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-447546" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>You can learn more about the benefit of embedding layers here:<br/>
<a href="https://machinelearningmastery.com/what-are-word-embeddings/" rel="nofollow">https://machinelearningmastery.com/what-are-word-embeddings/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-447546" onclick='return addComment.moveForm( "comment-447546", "447546", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-447838">
<div class="comment-container" id="li-comment-447838">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/00a25438ce2ddc220fd9de3bc40c5c10?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/00a25438ce2ddc220fd9de3bc40c5c10?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Nicola</span>
<span class="date">September 5, 2018 at 1:32 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-447838" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks! Actually, it would make no sense to feed the original matrix, where from what I understand, the order of the words matters. If we use another approach, such as CountVectorizer (from sci-kit learn), can we avoid the embedding layer and directly starts with the LSTM layer?</p>
<div class="reply">
<a aria-label="Reply to Nicola" class="comment-reply-link" href="#comment-447838" onclick='return addComment.moveForm( "comment-447838", "447838", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-447882">
<div class="comment-container" id="li-comment-447882">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 5, 2018 at 6:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-447882" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Sure, you can feed sequences of integers (tokenized words) directly to the LSTM.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-447882" onclick='return addComment.moveForm( "comment-447882", "447882", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-447629">
<div class="comment-container" id="li-comment-447629">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e067278cca91d37b03be0515b8fd7584?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e067278cca91d37b03be0515b8fd7584?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ishay</span>
<span class="date">September 3, 2018 at 8:41 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-447629" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I have learned a lot from the post.<br/>
Regarding the LSTM layer, I am having hard time understanding the dimensionality of input vs output. I read a lot about the unit layers and how they work and I understand the math, but on the higher level I am getting confused.</p>
<p>The input for the LSTM is 500 by 32 after embedding. What exactly is the output of each LSTM unit, if we receive an output of a vector in size of n units (100)?<br/>
I had the wrong impression earlier that each unit produce a vector of 32 in this case, and then you end up with a matrix of 32 by 100.</p>
<p>Can you ease explain the LSTM dynamics that generates this output?</p>
<div class="reply">
<a aria-label="Reply to Ishay" class="comment-reply-link" href="#comment-447629" onclick='return addComment.moveForm( "comment-447629", "447629", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-447666">
<div class="comment-container" id="li-comment-447666">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 3, 2018 at 1:36 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-447666" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>An LSTM takes a sequence as input and produces a single value as output.</p>
<p>If you have a layer of 100 nodes, each will receive the entire sequence as input and output one value, therefore a vector of length 100.</p>
<p>Does that help?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-447666" onclick='return addComment.moveForm( "comment-447666", "447666", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment odd alt depth-3" id="comment-447668">
<div class="comment-container" id="li-comment-447668">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e067278cca91d37b03be0515b8fd7584?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e067278cca91d37b03be0515b8fd7584?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Ishay</span>
<span class="date">September 3, 2018 at 3:45 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-447668" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi,</p>
<p>Thanks for the quick reply 🙂</p>
<p>In many places I see that the nodes output a vector (usually called h(t)). This is what I don’t understand.</p>
<div class="reply">
<a aria-label="Reply to Ishay" class="comment-reply-link" href="#comment-447668" onclick='return addComment.moveForm( "comment-447668", "447668", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-4" id="comment-447738">
<div class="comment-container" id="li-comment-447738">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 4, 2018 at 6:03 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-447738" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, LSTMs output a vector with one value for each node at the end of the sequence. The refer to this as h or hidden state.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-447738" onclick='return addComment.moveForm( "comment-447738", "447738", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-449128">
<div class="comment-container" id="li-comment-449128">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/8c37cf4c08b9875be1a769af267923ea?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/8c37cf4c08b9875be1a769af267923ea?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Alberto</span>
<span class="date">September 17, 2018 at 8:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-449128" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello,<br/>
thanks again for your blog. I am guessing why you are using binary crossentropy. Is it not supossed that this dataset is laballed with star reviews from 1 to 10?<br/>
Any post of a text classsifier using categorical crossentropy?<br/>
Thanks a lot.<br/>
Kind regards</p>
<div class="reply">
<a aria-label="Reply to Alberto" class="comment-reply-link" href="#comment-449128" onclick='return addComment.moveForm( "comment-449128", "449128", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-449175">
<div class="comment-container" id="li-comment-449175">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 18, 2018 at 6:12 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-449175" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, I’m sure I have a few. It only suitable for multi-class classification, for example:<br/>
<a href="https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/" rel="nofollow">https://machinelearningmastery.com/multi-class-classification-tutorial-keras-deep-learning-library/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-449175" onclick='return addComment.moveForm( "comment-449175", "449175", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-449268">
<div class="comment-container" id="li-comment-449268">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/395be5a75f0a77b9c13a8b8811360874?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/395be5a75f0a77b9c13a8b8811360874?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Dan</span>
<span class="date">September 19, 2018 at 12:50 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-449268" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason! Can you explain why you have not used you Series to Supervised function here? I thought for all sequential problems you need to convert to that format, or is that only for time series, i.e. weather prediction?</p>
<div class="reply">
<a aria-label="Reply to Dan" class="comment-reply-link" href="#comment-449268" onclick='return addComment.moveForm( "comment-449268", "449268", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-449295">
<div class="comment-container" id="li-comment-449295">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">September 19, 2018 at 6:21 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-449295" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>This is a text classification problem where the data was already prepared.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-449295" onclick='return addComment.moveForm( "comment-449295", "449295", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-451217">
<div class="comment-container" id="li-comment-451217">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1efe77f6bd5a36cf6398dd5cf70f7866?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1efe77f6bd5a36cf6398dd5cf70f7866?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Guru</span>
<span class="date">October 10, 2018 at 5:15 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-451217" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I was working on same kind data set where I converted my text data to vectors using Bag of words . Can I use same model??</p>
<div class="reply">
<a aria-label="Reply to Guru" class="comment-reply-link" href="#comment-451217" onclick='return addComment.moveForm( "comment-451217", "451217", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-451289">
<div class="comment-container" id="li-comment-451289">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 11, 2018 at 7:49 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-451289" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps try it and see?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-451289" onclick='return addComment.moveForm( "comment-451289", "451289", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-453178">
<div class="comment-container" id="li-comment-453178">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/973e8242b01ffdf792717d64af63b4ba?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/973e8242b01ffdf792717d64af63b4ba?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">pablo</span>
<span class="date">October 31, 2018 at 5:04 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-453178" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Nice tutorial! Does the embedding preserve the order of the words?<br/>
so the sentence “don’t I like bikes” will not be the same as “I don’t like bikes”.</p>
<div class="reply">
<a aria-label="Reply to pablo" class="comment-reply-link" href="#comment-453178" onclick='return addComment.moveForm( "comment-453178", "453178", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-453208">
<div class="comment-container" id="li-comment-453208">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">October 31, 2018 at 6:31 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-453208" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>The nature of the embedding can capture the similarity between “bike” and “bikes”, if your training data contains usage of both.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453208" onclick='return addComment.moveForm( "comment-453208", "453208", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-453927">
<div class="comment-container" id="li-comment-453927">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/4e7687090278d32912ea8126691dac9f?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4e7687090278d32912ea8126691dac9f?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">LSTM_newbie</span>
<span class="date">November 7, 2018 at 7:01 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-453927" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>nice post! I’m still a little confused about using metrics=[“accuracy”] though and wondering if you could help. Suppose we have an LSTM with prediction problem being single-label multi-class, several time steps, and each LSTM layer has return_sequences=True. Then the “predictions” are one class for each time step, i.e. each prediction is a list where len(list) = len(time_steps). In this case, what does “accuracy” mean? Is it the binary accuracy of getting *each* time step prediction *entirely* correct? For example, if the true label is [1, 3, 2, 1] and the predicted label is [1, 3, 2, 2] would the error be equal to 1 since the prediction is not exactly equal to the true label?</p>
<div class="reply">
<a aria-label="Reply to LSTM_newbie" class="comment-reply-link" href="#comment-453927" onclick='return addComment.moveForm( "comment-453927", "453927", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-453963">
<div class="comment-container" id="li-comment-453963">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 7, 2018 at 2:44 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-453963" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>It would be accuracy for each output timestep which might not be appropriate. You might want to manually evaluate the performance of the predictions.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-453963" onclick='return addComment.moveForm( "comment-453963", "453963", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-453989">
<div class="comment-container" id="li-comment-453989">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/a225dde9f44058b7a3a227628eb1c2ab?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a225dde9f44058b7a3a227628eb1c2ab?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Jean-Baptiste</span>
<span class="date">November 7, 2018 at 9:41 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-453989" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hello Jason,<br/>
Thank you for this tutorial.<br/>
I am trying to use the trained network to predict the sentiment of one imdv review.<br/>
so I tried<br/>
prediction = model.predict(x_test[0])<br/>
I was expecting to get len(prediction) = 1<br/>
but I get len(prediction) = 80<br/>
80 is the maxlen used to pad the input sequence.</p>
<p>So I am confused.<br/>
I would greatly appreciate some insight on this.<br/>
Thank you very much Jason</p>
<div class="reply">
<a aria-label="Reply to Jean-Baptiste" class="comment-reply-link" href="#comment-453989" onclick='return addComment.moveForm( "comment-453989", "453989", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-454020">
<div class="comment-container" id="li-comment-454020">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 8, 2018 at 6:07 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-454020" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I think the shape of the one sample was not what the model expected. Perhaps reshape it?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-454020" onclick='return addComment.moveForm( "comment-454020", "454020", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-454129">
<div class="comment-container" id="li-comment-454129">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/75015945fbe48b9a70c8d515dcc32dd9?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/75015945fbe48b9a70c8d515dcc32dd9?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Igor</span>
<span class="date">November 9, 2018 at 7:28 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-454129" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi<br/>
I’m trying to obtain pure CNN model, but seems, lack of expertise beats me. Using your blog I’ve constructed model like this:</p>
<p>top_words = 5000<br/>
max_review_length = 500<br/>
embedding_vecor_length = 32<br/>
model = Sequential()<br/>
model.add(Embedding(top_words, embedding_vecor_length, input_length=max_review_length))<br/>
model.add(Conv1D(filters=32, kernel_size=3, padding=’same’, activation=’relu’))<br/>
model.add(MaxPooling1D(pool_size=2))<br/>
model.add(Flatten())<br/>
#model.add(Dense(32, activation=’relu’))<br/>
model.add(Dense(1, activation=’softmax’))<br/>
model.compile(loss=’binary_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])<br/>
model.fit(X_train, y_train, epochs=3, batch_size=64)</p>
<p>But I’m getting 50% accuracy:<br/>
25000/25000 [==============================] – 5s 190us/step – loss: 7.9712 – acc: 0.5000<br/>
Accuracy: 50.00%</p>
<p>Please direct me, and show my errors.<br/>
With respect,<br/>
Igor</p>
<div class="reply">
<a aria-label="Reply to Igor" class="comment-reply-link" href="#comment-454129" onclick='return addComment.moveForm( "comment-454129", "454129", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-454157">
<div class="comment-container" id="li-comment-454157">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 9, 2018 at 2:00 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-454157" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Perhaps the model requires tuning to the problem?</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-454157" onclick='return addComment.moveForm( "comment-454157", "454157", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-454819">
<div class="comment-container" id="li-comment-454819">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3b63a65798542a760e09654f93c8b81c?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3b63a65798542a760e09654f93c8b81c?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Bahar</span>
<span class="date">November 15, 2018 at 7:11 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-454819" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Thanks. It was very helpful.</p>
<p>Just a question:</p>
<p>As far as I know, the validation set should be differ from the test set.<br/>
But in: model.fit(X_train, y_train, validation_data=(X_test, y_test), epochs=3, batch_size=64)<br/>
It seems you showed the test set as validation set!</p>
<p>Would you please explain?</p>
<div class="reply">
<a aria-label="Reply to Bahar" class="comment-reply-link" href="#comment-454819" onclick='return addComment.moveForm( "comment-454819", "454819", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-454839">
<div class="comment-container" id="li-comment-454839">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 15, 2018 at 11:27 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-454839" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Yes, I reused the test set to keep the example simple.</p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-454839" onclick='return addComment.moveForm( "comment-454839", "454839", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-455387">
<div class="comment-container" id="li-comment-455387">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/3e325ceb694fc423efee69e0d80feaa0?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/3e325ceb694fc423efee69e0d80feaa0?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Sridhar Srinivasan</span>
<span class="date">November 19, 2018 at 2:42 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-455387" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason,</p>
<p>I have a dataset which has time(Unix timestamp) and few device level features to predict a specific status of the device, can I use these features directly to make a prediction using LSTM, or is there an alternative way to weigh time?</p>
<div class="reply">
<a aria-label="Reply to Sridhar Srinivasan" class="comment-reply-link" href="#comment-455387" onclick='return addComment.moveForm( "comment-455387", "455387", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-455440">
<div class="comment-container" id="li-comment-455440">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 19, 2018 at 6:48 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-455440" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I would recommend getting familiar with time series forecasting here first:<br/>
<a href="https://machinelearningmastery.com/start-here/#timeseries" rel="nofollow">https://machinelearningmastery.com/start-here/#timeseries</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-455440" onclick='return addComment.moveForm( "comment-455440", "455440", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="comment-456475">
<div class="comment-container" id="li-comment-456475">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/e58ec9b87f8dbf247f50bcdfec5258b3?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e58ec9b87f8dbf247f50bcdfec5258b3?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name">Shreyas</span>
<span class="date">November 28, 2018 at 9:28 pm</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-456475" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>Hi Jason, can you please post a picture of the network ?</p>
<div class="reply">
<a aria-label="Reply to Shreyas" class="comment-reply-link" href="#comment-456475" onclick='return addComment.moveForm( "comment-456475", "456475", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
<ul class="children">
<li class="comment byuser comment-author-jasonb bypostauthor even depth-2" id="comment-456533">
<div class="comment-container" id="li-comment-456533">
<div class="avatar"><img alt="" class="avatar avatar-40 photo" height="40" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" width="40"/></div>
<div class="comment-head">
<span class="name"><a class="url" href="http://MachineLearningMastery.com" rel="external nofollow">Jason Brownlee</a></span>
<span class="date">November 29, 2018 at 7:40 am</span>
<span class="perma"><a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/#comment-456533" title="Direct link to this comment">#</a></span>
<span class="edit"></span>
</div><!-- /.comment-head -->
<div class="comment-entry">
<p>I explain how to create a plot of a network here:<br/>
<a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" rel="nofollow">https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/</a></p>
<div class="reply">
<a aria-label="Reply to Jason Brownlee" class="comment-reply-link" href="#comment-456533" onclick='return addComment.moveForm( "comment-456533", "456533", "respond", "2938" )' rel="nofollow">Reply</a> </div><!-- /.reply -->
</div><!-- /comment-entry -->
</div><!-- /.comment-container -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ol>
</div> <div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title">Leave a Reply <small><a href="/sequence-classification-lstm-recurrent-neural-networks-python-keras/#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">Click here to cancel reply.</a></small></h3> <form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" class="comment-form" id="commentform" method="post">
<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea cols="50" id="comment" maxlength="65525" name="comment" required="required" rows="10" tabindex="4"></textarea></p><p class="comment-form-author"><input aria-required="true" class="txt" id="author" name="author" size="30" tabindex="1" type="text" value=""/><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input aria-required="true" class="txt" id="email" name="email" size="30" tabindex="2" type="text" value=""/><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input class="txt" id="url" name="url" size="30" tabindex="3" type="text" value=""/><label for="url">Website</label></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="Submit Comment"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="2938"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="9a91b03317"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="58"/></p> </form>
</div><!-- #respond -->
</section><!-- /#main -->
<aside id="sidebar">
<div class="widget widget_woo_blogauthorinfo" id="woo_blogauthorinfo-2"><h3>Welcome to Machine Learning Mastery!</h3><span class="left"><img alt="" class="avatar avatar-100 photo" height="100" src="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=100&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" width="100"/></span>
<p>Hi, I'm Jason Brownlee, PhD
<br/>
I write tutorials to help developers (<i>like you</i>) get results with machine learning.</p>
<p><a href="/about">Read More</a></p>
<div class="fix"></div>
</div><div class="widget widget_text" id="text-43"> <div class="textwidget"><p></p><center><br/>
<strong>Deep Learning for NLP</strong><br/>
Develop deep learning models for text data.
<p><a href="/deep-learning-for-nlp/">Click to Get Started Now!</a><br/>
<a href="/deep-learning-for-nlp/"><img src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/11/DLFNLP-Cover-220.png"/></a><br/>
</p></center>
</div>
</div>
<div class="widget widget_woo_tabs" id="woo_tabs-2"> <div id="tabs">
<ul class="wooTabs">
<li class="popular"><a href="#tab-pop">Popular</a></li> </ul>
<div class="clear"></div>
<div class="boxes box inside">
<ul class="list" id="tab-pop">
<li>
<a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch"><img alt="How to Develop a Neural Machine Translation System in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/01/How-to-Develop-a-Neural-Machine-Translation-System-in-Keras-150x150.jpg" title="How to Develop a Neural Machine Translation System from Scratch" width="45"/></a> <a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" title="How to Develop a Neural Machine Translation System from Scratch">How to Develop a Neural Machine Translation System from Scratch</a>
<span class="meta">January 10, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning"><img alt="Difference Between Classification and Regression in Machine Learning" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/Difference-Between-Classification-and-Regression-in-Machine-Learning-150x150.jpg" title="Difference Between Classification and Regression in Machine Learning" width="45"/></a> <a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" title="Difference Between Classification and Regression in Machine Learning">Difference Between Classification and Regression in Machine Learning</a>
<span class="meta">December 11, 2017</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem..."><img alt="So, You are Working on a Machine Learning Problem..." class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/So-You-are-Working-on-a-Machine-Learning-Problem...-150x150.jpg" title="So, You are Working on a Machine Learning Problem..." width="45"/></a> <a href="https://machinelearningmastery.com/working-machine-learning-problem/" title="So, You are Working on a Machine Learning Problem…">So, You are Working on a Machine Learning Problem…</a>
<span class="meta">April 4, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis"><img alt="Plot of the Multichannel Convolutional Neural Network For Text" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/10/Plot-of-the-Multichannel-Convolutional-Neural-Network-For-Text-150x150.png" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis" width="45"/></a> <a href="https://machinelearningmastery.com/develop-n-gram-multichannel-convolutional-neural-network-sentiment-analysis/" title="How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis">How to Develop an N-gram Multichannel Convolutional Neural Network for Sentiment Analysis</a>
<span class="meta">January 12, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras"><img alt="How to Make Classification and Regression Predictions for Deep Learning Models in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/04/How-to-Make-Classification-and-Regression-Predictions-for-Deep-Learning-Models-in-Keras-150x150.jpg" title="How to Make Predictions with Keras" width="45"/></a> <a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" title="How to Make Predictions with Keras">How to Make Predictions with Keras</a>
<span class="meta">April 9, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)"><img alt="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/11-Classical-Time-Series-Forecasting-Methods-in-Python-Cheat-Sheet-150x150.jpg" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" width="45"/></a> <a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)">11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)</a>
<span class="meta">August 6, 2018</span>
<div class="fix"></div>
</li>
<li>
<a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras"><img alt="How to Visualize a Deep Learning Neural Network Model in Keras" class="thumbnail wp-post-image" height="45" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2017/12/How-to-Visualize-a-Deep-Learning-Neural-Network-Model-in-Keras-150x150.jpg" title="How to Visualize a Deep Learning Neural Network Model in Keras" width="45"/></a> <a href="https://machinelearningmastery.com/visualize-deep-learning-neural-network-model-keras/" title="How to Visualize a Deep Learning Neural Network Model in Keras">How to Visualize a Deep Learning Neural Network Model in Keras</a>
<span class="meta">December 13, 2017</span>
<div class="fix"></div>
</li>
</ul>
</div><!-- /.boxes -->
</div><!-- /wooTabs -->
</div> <div class="widget_text widget widget_custom_html" id="custom_html-2"><h3>You might also like…</h3><div class="textwidget custom-html-widget"><ul>
<li><a href="/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Install Python for Machine Learning</a></li>
<li><a href="/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python</a></li>
<li><a href="/tutorial-first-neural-network-python-keras/">Your First Neural Network in Python</a></li>
<li><a href="/how-to-run-your-first-classifier-in-weka/">Your First Classifier in Weka</a></li>
<li><a href="/arima-for-time-series-forecasting-with-python/">Your First Time Series Forecasting Project</a></li>
</ul></div></div></aside><!-- /#sidebar -->
</div><!-- /#main-sidebar-container -->
</div><!-- /#content -->
<footer class="col-full" id="footer">
<div class="col-left" id="copyright">
<p>© 2018 Machine Learning Mastery. All Rights Reserved. </p> </div>
<div class="col-right" id="credit">
<p></p><p>
<a href="/privacy/">Privacy</a> | 
<a href="/disclaimer/">Disclaimer</a> | 
<a href="/terms-of-service/">Terms</a> | 
<a href="/contact/">Contact</a>
</p> </div>
</footer>
</div><!-- /#inner-wrapper -->
</div><!-- /#wrapper -->
<div class="fix"></div><!--/.fix-->
<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/comment-reply.min.js?ver=4.9.8" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.0.5" type="text/javascript"></script>
<script src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/js/wp-embed.min.js?ver=4.9.8" type="text/javascript"></script>
<script async="async" src="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/akismet/_inc/form.js?ver=4.1" type="text/javascript"></script>
</body>
</html>